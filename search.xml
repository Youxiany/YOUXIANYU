<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>ç¼–ç¨‹æ€æƒ³3.1</title>
      <link href="/2026/01/30/%E7%BC%96%E7%A8%8B%E6%80%9D%E6%83%B3/%E5%8D%95%E4%B8%80%E8%81%8C%E8%B4%A3%E5%8E%9F%E5%88%99/"/>
      <url>/2026/01/30/%E7%BC%96%E7%A8%8B%E6%80%9D%E6%83%B3/%E5%8D%95%E4%B8%80%E8%81%8C%E8%B4%A3%E5%8E%9F%E5%88%99/</url>
      
        <content type="html"><![CDATA[<h1 id="å•ä¸€èŒè´£åŸåˆ™ï¼ˆSingle-Responsibility-Principle-SRPï¼‰"><a href="#å•ä¸€èŒè´£åŸåˆ™ï¼ˆSingle-Responsibility-Principle-SRPï¼‰" class="headerlink" title="å•ä¸€èŒè´£åŸåˆ™ï¼ˆSingle Responsibility Principle, SRPï¼‰"></a>å•ä¸€èŒè´£åŸåˆ™ï¼ˆSingle Responsibility Principle, SRPï¼‰</h1><p><b>ä»€ä¹ˆæ˜¯å•ä¸€èŒè´£åŸåˆ™</b></p><blockquote><p>ä¸€ä¸ªç±»åªè´Ÿè´£ä¸€ä»¶äº‹æƒ…<br>ä¸€ä¸ªæ¨¡å—çš„æ‰€æœ‰åŠŸèƒ½éƒ½åº”è¯¥é«˜åº¦ç›¸å…³ã€å›´ç»•åŒä¸€èŒè´£<br>å½“éœ€æ±‚å˜æ›´æ—¶ï¼Œåº”åªå½±å“åˆ°ä¸€ä¸ªç±»ï¼Œè€Œä¸æ˜¯åŒæ—¶å½±å“å¤šä¸ªä¸ç›¸å…³åŠŸèƒ½çš„ç±»</p></blockquote><p><b>ä¸ºä»€ä¹ˆè¦éµå®ˆSRP</b></p><ol><li>é™ä½è€¦åˆ</li></ol><p>å½“ä¸€ä¸ªç±»æ‰¿æ‹…å¤šç§èŒè´£æ—¶ï¼Œä¸€ä¸ªèŒè´£çš„å˜åŒ–å¯èƒ½ä¼šå½±å“åˆ°å…¶ä»–èŒè´£ã€‚</p><ol start="2"><li>æé«˜å¯ç»´æŠ¤æ€§</li></ol><p>å˜æ›´å½±å“é¢æ›´å°ï¼Œç»´æŠ¤æ›´è½»æ¾ã€‚</p><ol start="3"><li>æé«˜å¯æµ‹è¯•æ€§</li></ol><p>å•ä¸€èŒè´£çš„ç±»æ›´å®¹æ˜“ç¼–å†™å•å…ƒæµ‹è¯•ã€‚</p><ol start="4"><li>å¢å¼ºå¯è¯»æ€§</li></ol><p>ç»“æ„æ›´æ¸…æ™°ï¼Œè®©åˆ«äººä¸€çœ¼å°±çŸ¥é“è¿™ä¸ªç±»çš„ç›®çš„ã€‚</p><p>ç¤ºä¾‹</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TelPhone</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Dial</span>(<span class="params"><span class="built_in">string</span> phoneNumber</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;ç»™ &quot;</span> + phoneNumber+<span class="string">&quot; æ‰“ç”µè¯&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">HangUp</span>(<span class="params"><span class="built_in">string</span> phoneNumber</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;æŒ‚æ–­ &quot;</span> + phoneNumber+<span class="string">&quot; çš„ç”µè¯&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SendMessage</span>(<span class="params"><span class="built_in">string</span> phoneNumber, <span class="built_in">string</span> message</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;ç»™ &quot;</span> + phoneNumber + <span class="string">&quot; å‘é€æ¶ˆæ¯: &quot;</span> + message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ReceiveMessage</span>(<span class="params"><span class="built_in">string</span> phoneNumber, <span class="built_in">string</span> message</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(phoneNumber + <span class="string">&quot; æ”¶åˆ°æ¶ˆæ¯: &quot;</span> + message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å˜åŒ–ä¸€ï¼šå†…éƒ¨çš„å˜åŒ–ï¼Œå¦‚æœTelPhoneå†…éƒ¨çš„æ–¹æ³•ï¼Œä»»æ„ä¹‹ä¸€ï¼Œå‘ç”Ÿäº†æ”¹å˜ï¼Œé‚£ä¼šéœ€è¦ä¿®æ”¹TelPhoneï¼Œä¸ç¬¦åˆå•ä¸€èŒè´£åŸåˆ™<br>å˜åŒ–äºŒï¼šå¤–éƒ¨çš„å˜åŒ–ï¼Œå¦‚æœTelPhoneè¦æ·»åŠ æ–°çš„æ–¹æ³•ï¼Œä¹Ÿéœ€è¦ä¿®æ”¹TelPhone</p></blockquote><p><b>åªæœ‰æ·»åŠ çš„æ—¶å€™æ‰ä¼šè§¦å‘è¿™ä¸ªç±»çš„æ”¹å˜ï¼Œå…¶ä»–çš„ä¿®æ”¹éƒ½ä¸è¦è§¦å‘è¿™ä¸ªç±»çš„æ”¹å˜</b></p><p>ä¼˜åŒ–ï¼š</p><blockquote><p>ç»™æ¯ä¸ªæ–¹æ³•ï¼Œéƒ½æç‚¼æˆä¸€ä¸ªæ¥å£ï¼ŒæŠ½è±¡æˆä¸€ç§èƒ½åŠ›ï¼Œç„¶ååˆ†åˆ«é‹ç±»ï¼Œå»å®ç°æ¥å£ï¼Œæœ€ç»ˆåœ¨TelPhoneä¸­ï¼Œåªè¿›è¡Œè°ƒç”¨ã€‚</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span>  <span class="title">IDidl</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Dial</span>(<span class="params"><span class="built_in">string</span> phoneNumber</span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IHangUp</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">HangUp</span>(<span class="params"><span class="built_in">string</span> phoneNumber</span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">ISendMessage</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">SendMessage</span>(<span class="params"><span class="built_in">string</span> phoneNumber, <span class="built_in">string</span> message</span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IReceiveMessage</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ReceiveMessage</span>(<span class="params"><span class="built_in">string</span> phoneNumber, <span class="built_in">string</span> message</span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Dialclass</span> : <span class="title">IDidl</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Dial</span>(<span class="params"><span class="built_in">string</span> phoneNumber</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;ç»™ &quot;</span> + phoneNumber + <span class="string">&quot; æ‰“ç”µè¯&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">HangUpclass</span> : <span class="title">IHangUp</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">HangUp</span>(<span class="params"><span class="built_in">string</span> phoneNumber</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;æŒ‚æ–­ &quot;</span> + phoneNumber + <span class="string">&quot; çš„ç”µè¯&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">SendMessageclass</span> : <span class="title">ISendMessage</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SendMessage</span>(<span class="params"><span class="built_in">string</span> phoneNumber, <span class="built_in">string</span> message</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;ç»™ &quot;</span> + phoneNumber + <span class="string">&quot; å‘é€æ¶ˆæ¯: &quot;</span> + message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ReceiveMessageclass</span> : <span class="title">IReceiveMessage</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ReceiveMessage</span>(<span class="params"><span class="built_in">string</span> phoneNumber, <span class="built_in">string</span> message</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(phoneNumber + <span class="string">&quot; æ”¶åˆ°æ¶ˆæ¯: &quot;</span> + message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TelPhone</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> IDidl _dial;</span><br><span class="line">    <span class="keyword">private</span> IHangUp _hangUp;</span><br><span class="line">    <span class="keyword">private</span> ISendMessage _sendMessage;</span><br><span class="line">    <span class="keyword">private</span> IReceiveMessage _receiveMessage;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TelPhone</span>(<span class="params">IDidl dial, IHangUp hangUp, ISendMessage sendMessage, IReceiveMessage receiveMessage</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _dial = dial;</span><br><span class="line">        _hangUp = hangUp;</span><br><span class="line">        _sendMessage = sendMessage;</span><br><span class="line">        _receiveMessage = receiveMessage;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Dial</span>(<span class="params"><span class="built_in">string</span> phoneNumber</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _dial.Dial(phoneNumber);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">HangUp</span>(<span class="params"><span class="built_in">string</span> phoneNumber</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _hangUp.HangUp(phoneNumber);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SendMessage</span>(<span class="params"><span class="built_in">string</span> phoneNumber, <span class="built_in">string</span> message</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _sendMessage.SendMessage(phoneNumber, message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ReceiveMessage</span>(<span class="params"><span class="built_in">string</span> phoneNumber, <span class="built_in">string</span> message</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _receiveMessage.ReceiveMessage(phoneNumber, message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å¼€æ”¾å°é—­åŸåˆ™"><a href="#å¼€æ”¾å°é—­åŸåˆ™" class="headerlink" title="å¼€æ”¾å°é—­åŸåˆ™"></a>å¼€æ”¾å°é—­åŸåˆ™</h1><p><b>ä»€ä¹ˆæ˜¯å¼€æ”¾å°é—­åŸåˆ™</b></p><blockquote><p>å½“éœ€æ±‚å˜æ›´æ—¶ï¼Œåº”è¯¥ é€šè¿‡æ‰©å±•æ–°ä»£ç  æ¥åº”å¯¹<br>è€Œä¸æ˜¯ä¿®æ”¹å·²ç¨³å®šä¸Šçº¿çš„æ—§ä»£ç </p></blockquote><p><b>ä¸ºä»€ä¹ˆéœ€è¦ OCP</b></p><ol><li>å‡å°‘é£é™©</li></ol><p>æ”¹æ—§ä»£ç å®¹æ˜“å¼•å…¥ Bugã€‚æ‰©å±•æ–°ä»£ç æ›´å®‰å…¨ã€‚</p><ol start="2"><li>æé«˜å¯ç»´æŠ¤æ€§</li></ol><p>é¿å…åœ¨æ ¸å¿ƒæµç¨‹ä¸­ä¸åœåŠ  if-elseã€switch-caseã€‚</p><ol start="3"><li>æé«˜å¯æ‰©å±•æ€§</li></ol><p>æ–°å¢éœ€æ±‚åªéœ€è¦æ–°å¢ç±»æˆ–ç­–ç•¥ï¼Œè€Œä¸æ˜¯åŠ¨æ—§é€»è¾‘ã€‚</p><p>ç¤ºä¾‹ï¼š</p><p>å¯¹è±¡1ï¼šç”¨æˆ·ï¼šå±æ€§ï¼šè®°å½•ä¸åŒç±»å‹çš„ç”¨æˆ·ï¼ˆå­˜é’±ã€å–é’±ã€è½¬è´¦ï¼‰<br>å¯¹è±¡2ï¼šé“¶è¡ŒæŸœå‘˜ï¼šå¸®åŠ©æˆ‘ä»¬ç”¨æˆ·å¤„ç†ä¸åŒçš„éœ€æ±‚<br>å¯¹è±¡3ï¼šé“¶è¡Œä¸šåŠ¡ç³»ç»Ÿï¼šå¤„ç†å­˜é’±ã€å–é’±ã€è½¬è´¦ç­‰éœ€æ±‚çš„æ“ä½œç³»ç»Ÿ</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Bank</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Bankclas</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        BankClient client = <span class="keyword">new</span> BankClient();</span><br><span class="line">        client.BankType = <span class="string">&quot;å­˜æ¬¾&quot;</span>;</span><br><span class="line">        BankStuff stuff = <span class="keyword">new</span> BankStuff(<span class="keyword">new</span> BankProcess());</span><br><span class="line">        stuff.HandleProcess(client);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">BankClient</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span>? BankType&#123;<span class="keyword">get</span>;<span class="keyword">set</span>;&#125; </span><br><span class="line">&#125;   </span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">BankStuff</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> BankProcess _bankProcess;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BankStuff</span>(<span class="params">BankProcess bankProcess</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _bankProcess = bankProcess;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">HandleProcess</span>(<span class="params">BankClient client</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">switch</span> (client.BankType)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;å­˜æ¬¾&quot;</span>:</span><br><span class="line">                _bankProcess.Deposit();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;å–æ¬¾&quot;</span>:</span><br><span class="line">                _bankProcess.Withdraw();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&quot;è½¬è´¦&quot;</span>:</span><br><span class="line">                _bankProcess.Transfer();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="literal">default</span>:</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;æ— æ•ˆçš„æ“ä½œ&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;   </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">BankProcess</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//å­˜æ¬¾</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Deposit</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;å­˜æ¬¾&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å–æ¬¾</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Withdraw</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;å–æ¬¾&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//è½¬è´¦</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Transfer</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;è½¬è´¦&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ­¤ä»£ç å¹¶æ²¡æœ‰å®ç°å•ä¸€åŸåˆ™ï¼Œä¸”å¼€æ”¾å°é—­åŸåˆ™ï¼Œåªå¼€æ”¾å¹¶æ²¡æœ‰å°é—­ï¼ˆä¸€ä¸ªè½¯ä»¶å®ä½“åº”è¯¥å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­ã€‚å³è½¯ä»¶å®ä½“åº”å°½é‡åœ¨ä¸ä¿®æ”¹åŸæœ‰ä»£ç çš„æƒ…å†µä¸‹è¿›è¡Œæ‰©å±•ï¼‰</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Bank</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Bankclas</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        IBankClient client = <span class="keyword">new</span> TransferClient();</span><br><span class="line">        BankStuff ctx = <span class="keyword">new</span> BankStuff();</span><br><span class="line">        ctx.HandleProcess(client);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">BankClient</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span>? BankType&#123;<span class="keyword">get</span>;<span class="keyword">set</span>;&#125; </span><br><span class="line">&#125;   </span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">BankStuff</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> IBankProcess? _bankprocess;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">HandleProcess</span>(<span class="params">IBankClient client</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _bankprocess = client.GetBankProcess();</span><br><span class="line">        _bankprocess.BankProcess();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»¥ä¸Šæ˜¯Bank.csçš„æ¥å£å®šä¹‰ï¼Œä¸‹é¢æ˜¯BankClient.csçš„å®ç°</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IBankClient</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function">IBankProcess <span class="title">GetBankProcess</span>()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">DepositClient</span> : <span class="title">IBankClient</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> IBankProcess <span class="title">GetBankProcess</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Deposit();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">WithdrawClient</span> : <span class="title">IBankClient</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> IBankProcess <span class="title">GetBankProcess</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Withdraw();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TransferClient</span> : <span class="title">IBankClient</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> IBankProcess <span class="title">GetBankProcess</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Transfer();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»¥ä¸Šæ˜¯Bank.csçš„å®ç°ï¼Œä¸‹é¢æ˜¯BankClient.csçš„å®ç°</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IBankProcess</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">BankProcess</span>()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Deposit</span> : <span class="title">IBankProcess</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">BankProcess</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;å­˜æ¬¾&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Withdraw</span> : <span class="title">IBankProcess</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">BankProcess</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;å–æ¬¾&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Transfer</span> : <span class="title">IBankProcess</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">BankProcess</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;è½¬è´¦&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ä¾èµ–å€’ç½®åŸåˆ™"><a href="#ä¾èµ–å€’ç½®åŸåˆ™" class="headerlink" title="ä¾èµ–å€’ç½®åŸåˆ™"></a>ä¾èµ–å€’ç½®åŸåˆ™</h1><p><b>ä»€ä¹ˆæ˜¯ä¾èµ–å€’ç½®åŸåˆ™</b></p><blockquote><p>é«˜å±‚æ¨¡(è°ƒç”¨è€…)å—ä¸åº”è¯¥ä¾èµ–äºåº•å±‚æ¨¡å—ï¼ˆè¢«è°ƒç”¨è€…ï¼‰ã€‚ä¸¤ä¸ªéƒ½åº”è¯¥ä¾èµ–äºæŠ½è±¡ã€‚<br>æŠ½åƒä¸åº”è¯¥ä¾èµ–äºç»†èŠ‚ï¼Œç»†èŠ‚å› è¯¥ä¾èµ–äºæŠ½è±¡<br>ä¾èµ–å€’ç½®åŸåˆ™çš„æœ¬è´¨å°±æ˜¯é€šè¿‡æŠ½è±¡ï¼ˆæ¥å£æˆ–æŠ½è±¡ç±»ï¼‰ä½¿ä¸ªæ ¼ç±»æˆ–æ¨¡å—çš„å®ç°å½¼æ­¤ç‹¬ç«‹ï¼Œäº’ä¸å½±å“ï¼Œå®ç°æ¨¡å—é—´çš„æ¾è€¦åˆã€‚</p></blockquote><h2 id="å…³äºä¾èµ–"><a href="#å…³äºä¾èµ–" class="headerlink" title="å…³äºä¾èµ–"></a>å…³äºä¾èµ–</h2><ol><li>ä¸€ä¸ªä¼˜ç§€çš„é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ï¼Œæ ¸å¿ƒçš„åŸåˆ™ä¹‹ä¸€å°±æ˜¯å°†å˜åŒ–å°è£…ï¼Œä½¿å¾—å˜åŒ–éƒ¨åˆ†å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå…¶ä»–éƒ¨åˆ†ï¼Œä¸å—å½±å“ã€‚</li><li>ä¸ºäº†å®ç°è¿™ä¸ªç›®çš„ï¼Œéœ€è¦ä½¿ç”¨é¢å‘æ¥å£ç¼–ç¨‹ï¼Œä½¿ç”¨åï¼Œå®¢æˆ·ç±»ï¼Œä¸å†ç›´æ¥ä¾èµ–æœåŠ¡ç±»ï¼Œè€Œæ˜¯ä¾èµ–ä¸€ä¸ªæŠ½è±¡çš„æ¥å£ï¼Œè¿™æ ·ï¼Œå®¢æˆ·ç«¯å°±ä¸èƒ½åœ¨å†…éƒ¨ç›´æ¥å®ä¾‹åŒ–æœåŠ¡ç±»ã€‚</li><li>ä½†æ˜¯å®¢æˆ·ç±»åœ¨è¿è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œåˆéœ€è¦å…·ä½“çš„æœåŠ¡ç±»æ¥æä¾›æœåŠ¡ï¼Œå› ä¸ºæ¥å£æ˜¯ä¸èƒ½å®ä¾‹åŒ–çš„ï¼Œå°±äº§ç”Ÿäº†ä¸€ä¸ªçŸ›ç›¾ï¼šå®¢æˆ·ç±»ä¸å…è®¸å®ä¾‹åŒ–æœåŠ¡ç±»ï¼Œä½†æ˜¯å®¢æˆ·ç±»åˆéœ€è¦æœåŠ¡ç±»çš„æœåŠ¡ã€‚</li><li>ä¸ºäº†è§£å†³è¿™ä¸ªçŸ›ç›¾ï¼Œæˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œæ—¢ï¼šå®¢æˆ·ç±»å®šä¹‰ä¸€ä¸ªæ³¨å…¥ç‚¹ï¼Œç”¨äºæœåŠ¡ç±»çš„æ³¨å…¥ï¼Œè€Œå®¢æˆ·ç±»çš„å®¢æˆ·ç±»ï¼ˆProgramç±»ï¼‰è´Ÿè´£æ ¹æ®æƒ…å†µï¼Œå®ä¾‹åŒ–æœåŠ¡ç±»ï¼Œæ³¨å…¥åˆ°å®¢æˆ·ç±»ä¸­ï¼Œä»è€Œè§£å†³äº†è¿™ä¸ªçŸ›ç›¾ã€‚</li></ol><h2 id="ä¾èµ–å…³ç³»å¦‚ä½•ä¼ é€’ï¼Ÿï¼ˆä¾èµ–æ³¨å…¥ï¼‰"><a href="#ä¾èµ–å…³ç³»å¦‚ä½•ä¼ é€’ï¼Ÿï¼ˆä¾èµ–æ³¨å…¥ï¼‰" class="headerlink" title="ä¾èµ–å…³ç³»å¦‚ä½•ä¼ é€’ï¼Ÿï¼ˆä¾èµ–æ³¨å…¥ï¼‰"></a>ä¾èµ–å…³ç³»å¦‚ä½•ä¼ é€’ï¼Ÿï¼ˆä¾èµ–æ³¨å…¥ï¼‰</h2><blockquote><p>é€šè¿‡æ¥å£ä¼ é€’ï¼ˆæ¥å£æ³¨å…¥ï¼‰<br>é€šè¿‡æ„é€ æ–¹æ³•ä¼ é€’<br>é€šè¿‡å±æ€§çš„Setæ–¹æ³•ä¼ é€’</p></blockquote><p>é€šè¿‡æ¥å£ä¼ é€’ï¼ˆæ¥å£æ³¨å…¥ Interface Injectionï¼‰<br>1ï¸âƒ£ æ€æƒ³</p><p>ä¾èµ–ä¸æ˜¯é€šè¿‡æ„é€ å™¨æˆ–å±æ€§ä¼ </p><p>è€Œæ˜¯é€šè¿‡ ä¸€ä¸ªä¸“é—¨çš„æ³¨å…¥æ¥å£ æ¥å®Œæˆ</p><p>2ï¸âƒ£ ç»“æ„ç¤ºæ„</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Client</span><br><span class="line">  â†“</span><br><span class="line">å®ç° Inject æ¥å£</span><br><span class="line">  â†“</span><br><span class="line">å®¹å™¨è°ƒç”¨æ¥å£æ–¹æ³•</span><br></pre></td></tr></table></figure><p>3ï¸âƒ£ ç¤ºä¾‹</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">ILogger</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Log</span>(<span class="params"><span class="built_in">string</span> message</span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨å…¥æ¥å£</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">ILoggerInjectable</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">InjectLogger</span>(<span class="params">ILogger logger</span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">OrderService</span> : <span class="title">ILoggerInjectable</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> ILogger _logger;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">InjectLogger</span>(<span class="params">ILogger logger</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _logger = logger;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®¹å™¨æˆ–è°ƒç”¨æ–¹ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> service = <span class="keyword">new</span> OrderService();</span><br><span class="line">service.InjectLogger(<span class="keyword">new</span> ConsoleLogger());</span><br></pre></td></tr></table></figure><p>4ï¸âƒ£ ä¼˜ç¼ºç‚¹</p><p>âœ… ä¼˜ç‚¹</p><p>ä¾èµ–æ³¨å…¥è¿‡ç¨‹æ˜¾å¼ã€æ¸…æ™°</p><p>é€‚åˆéœ€è¦å¼ºåˆ¶æ³¨å…¥çš„åœºæ™¯</p><p>âŒ ç¼ºç‚¹</p><p>ä¾µå…¥æ€§å¼ºï¼ˆä¸šåŠ¡ç±»å¿…é¡»å®ç°æ³¨å…¥æ¥å£ï¼‰</p><p>å®é™…é¡¹ç›®ä¸­ å¾ˆå°‘ä½¿ç”¨</p><p>ğŸ‘‰ ç°ä»£ DI æ¡†æ¶åŸºæœ¬ä¸ç”¨è¿™ç§æ–¹å¼</p><p>ä¸‰ã€é€šè¿‡æ„é€ æ–¹æ³•ä¼ é€’ï¼ˆæ„é€ å‡½æ•°æ³¨å…¥ï¼‰âœ…ã€æœ€æ¨èã€‘<br>1ï¸âƒ£ æ€æƒ³</p><p>ä¾èµ–åœ¨å¯¹è±¡åˆ›å»ºæ—¶å°±å¿…é¡»å­˜åœ¨</p><p>æ²¡æœ‰ä¾èµ–ï¼Œå¯¹è±¡å°±ä¸åˆæ³•</p><p>2ï¸âƒ£ ç¤ºä¾‹</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">OrderService</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> ILogger _logger;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">OrderService</span>(<span class="params">ILogger logger</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _logger = logger;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®¹å™¨ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">services.AddTransient&lt;OrderService&gt;();</span><br></pre></td></tr></table></figure><p>DI å®¹å™¨ä¼šè‡ªåŠ¨ï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ILogger â†’ ConsoleLogger</span><br><span class="line">        â†“</span><br><span class="line">OrderService(logger)</span><br></pre></td></tr></table></figure><p>3ï¸âƒ£ ä¼˜ç‚¹ï¼ˆéå¸¸é‡è¦ï¼‰</p><p>âœ… ä¾èµ–ä¸å¯ä¸ºç©ºï¼ˆå¼ºçº¦æŸï¼‰<br>âœ… å¯¹è±¡ä¸€åˆ›å»ºå°±å¤„äºâ€œå®Œæ•´çŠ¶æ€â€<br>âœ… å¤©ç„¶æ”¯æŒ ä¸å¯å˜è®¾è®¡ï¼ˆreadonlyï¼‰<br>âœ… æœ€ç¬¦åˆ å•ä¸€èŒè´£åŸåˆ™ + ä¾èµ–å€’ç½®åŸåˆ™</p><p>âŒ ç¼ºç‚¹</p><p>æ„é€ å‡½æ•°å‚æ•°å¯èƒ½å˜å¤šï¼ˆä½†è¿™æ˜¯â€œè®¾è®¡é—®é¢˜æš´éœ²â€ï¼Œä¸æ˜¯åäº‹ï¼‰</p><p>ğŸ‘‰ 95% çš„åœºæ™¯ï¼šé¦–é€‰æ„é€ å‡½æ•°æ³¨å…¥</p><p>å››ã€é€šè¿‡å±æ€§çš„ Set æ–¹æ³•ä¼ é€’ï¼ˆSetter æ³¨å…¥ï¼‰<br>1ï¸âƒ£ æ€æƒ³</p><p>å¯¹è±¡å¯ä»¥å…ˆåˆ›å»º</p><p>ä¾èµ–åœ¨ä¹‹åé€šè¿‡å±æ€§æˆ–æ–¹æ³•è®¾ç½®</p><p>2ï¸âƒ£ ç¤ºä¾‹</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">OrderService</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> ILogger Logger &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">CreateOrder</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Logger?.Log(<span class="string">&quot;Create order&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3ï¸âƒ£ ä¼˜ç¼ºç‚¹</p><p>âœ… ä¼˜ç‚¹</p><p>é€‚åˆ å¯é€‰ä¾èµ–</p><p>æ„é€ å‡½æ•°ä¿æŒç®€æ´</p><p>âŒ ç¼ºç‚¹</p><p>ä¾èµ–å¯èƒ½ä¸º null</p><p>å¯¹è±¡å¯èƒ½å¤„äºâ€œåŠåˆå§‹åŒ–çŠ¶æ€â€</p><p>ä¸åˆ©äºå¹¶å‘å’Œä¸å˜æ€§è®¾è®¡</p><h1 id="é‡Œæ°æ›¿æ¢åŸåˆ™"><a href="#é‡Œæ°æ›¿æ¢åŸåˆ™" class="headerlink" title="é‡Œæ°æ›¿æ¢åŸåˆ™"></a>é‡Œæ°æ›¿æ¢åŸåˆ™</h1><p>é‡Œæ°æ›¿æ¢åŸåˆ™çš„æœ¬è´¨ä¸æ˜¯â€œè¯­æ³•ç»§æ‰¿â€ï¼Œè€Œæ˜¯â€œè¡Œä¸ºå¥‘çº¦ç»§æ‰¿â€ã€‚<br>ä¸€æ—¦å­ç±»æ”¹å˜äº†çˆ¶ç±»å¯¹å¤–çš„è¡Œä¸ºæ‰¿è¯ºï¼Œç»§æ‰¿å°±æ˜¯é”™è¯¯è®¾è®¡ã€‚</p><h1 id="æ¥å£éš”ç¦»åŸåˆ™"><a href="#æ¥å£éš”ç¦»åŸåˆ™" class="headerlink" title="æ¥å£éš”ç¦»åŸåˆ™"></a>æ¥å£éš”ç¦»åŸåˆ™</h1><p>å®¢æˆ·ç«¯ä¸åº”è¯¥è¢«è¿«ä¾èµ–å®ƒä¸éœ€è¦çš„æ–¹æ³•ã€‚</p><blockquote><p>æ¥å£è¦å°è€Œä¸“ä¸€ï¼Œè€Œä¸æ˜¯å¤§è€Œå…¨</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IWorkable</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Work</span>()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IEatable</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Eat</span>()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">ISleepable</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Sleep</span>()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®ç°ç±»æŒ‰éœ€å®ç°</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">HumanWorker</span> : <span class="title">IWorkable</span>, <span class="title">IEatable</span>, <span class="title">ISleepable</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Work</span>()</span> &#123; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Eat</span>()</span> &#123; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Sleep</span>()</span> &#123; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">RobotWorker</span> : <span class="title">IWorkable</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Work</span>()</span> &#123; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ¥å£åˆ†ç¦»åŸåˆ™è¦æ±‚æˆ‘ä»¬ç”¨â€œå¤šä¸ªå°æ¥å£â€<br>ä»£æ›¿â€œä¸€ä¸ªå¤§æ¥å£â€ï¼Œ<br>è®©æ¯ä¸ªå®¢æˆ·ç«¯åªä¾èµ–å®ƒçœŸæ­£éœ€è¦çš„èƒ½åŠ›ã€‚</p></blockquote><h1 id="è¿ªç±³ç‰¹åŸåˆ™"><a href="#è¿ªç±³ç‰¹åŸåˆ™" class="headerlink" title="è¿ªç±³ç‰¹åŸåˆ™"></a>è¿ªç±³ç‰¹åŸåˆ™</h1><p>è¿ªç±³ç‰¹åŸåˆ™ï¼ˆLaw of Demeterï¼ŒLoDï¼‰ï¼Œä¹Ÿå«æœ€å°‘çŸ¥è¯†åŸåˆ™ï¼Œä¸€å¥è¯ç‰ˆæ˜¯ï¼š</p><p>ä¸€ä¸ªå¯¹è±¡åº”è¯¥å°½é‡å°‘åœ°äº†è§£å…¶ä»–å¯¹è±¡ã€‚</p><ol><li>ä»€ä¹ˆæ˜¯â€œç›´æ¥æœ‹å‹â€ï¼Ÿ</li></ol><p>å¯¹ä¸€ä¸ªå¯¹è±¡ A æ¥è¯´ï¼Œä¸‹é¢è¿™äº›ç®—å®ƒçš„â€œæœ‹å‹â€ï¼š</p><p>è‡ªèº«ï¼ˆthisï¼‰</p><p>ä½œä¸ºå‚æ•°ä¼ è¿›æ¥çš„å¯¹è±¡</p><p>è‡ªå·±åˆ›å»ºçš„å¯¹è±¡</p><p>è‡ªå·±çš„æˆå‘˜å˜é‡</p><p>å…¶ä»–é€šè¿‡â€œé“¾å¼è°ƒç”¨â€æ‹¿åˆ°çš„å¯¹è±¡ï¼Œéƒ½ä¸æ˜¯æœ‹å‹ã€‚</p><ol start="2"><li>ç»å…¸åä¾‹ï¼ˆè¿åè¿ªç±³ç‰¹åŸåˆ™ï¼‰<br>order.GetCustomer().GetAddress().GetCity();</li></ol><p>é—®é¢˜åœ¨å“ªï¼Ÿ</p><p>order æœ¬æ¥åªè¯¥å…³å¿ƒ Customer</p><p>å´ä¸€è·¯æ‘¸åˆ° Addressã€City</p><p>è€¦åˆé“¾å¤ªé•¿ï¼Œä¸€æ”¹å°±å´©</p><p>Order çŸ¥é“å¾—å¤ªå¤šäº†ã€‚</p><ol start="3"><li>ç¬¦åˆè¿ªç±³ç‰¹åŸåˆ™çš„å†™æ³•<br>æŠŠâ€œç»†èŠ‚â€è—èµ·æ¥</li></ol><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">order.GetCustomerCity();</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Order</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> Customer _customer;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">GetCustomerCity</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> _customer.GetCity();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¼˜ç‚¹ï¼š</p><p>è°ƒç”¨æ–¹ä¸å…³å¿ƒå†…éƒ¨ç»“æ„</p><p>Customer &#x2F; Address æ€ä¹ˆæ”¹ï¼Œå¯¹å¤–éƒ¨å½±å“æœ€å°</p><p>å¯ç»´æŠ¤æ€§æ˜æ˜¾æå‡ </p><ol start="4"><li>å’Œå…¶ä»–åŸåˆ™çš„å…³ç³»ï¼ˆå¾ˆé‡è¦ï¼‰<br> å•ä¸€èŒè´£åŸåˆ™ï¼ˆSRPï¼‰</li></ol><p>èŒè´£æ¸…æ™° â†’ ä¸å®¹æ˜“â€œçŸ¥é“å¤ªå¤šâ€</p><p>SRP æ˜¯åŸºç¡€ï¼ŒLoD æ˜¯ç»“æœ</p><p> æ¥å£éš”ç¦»åŸåˆ™ï¼ˆISPï¼‰</p><p>æ¥å£å°è€Œç²¾ â†’ è‡ªç„¶åªæš´éœ²å¿…è¦ä¿¡æ¯</p><p>ISP èƒ½å¸®åŠ©å®ç° LoD</p><p> ä¾èµ–å€’ç½®åŸåˆ™ï¼ˆDIPï¼‰</p><p>ä¾èµ–æŠ½è±¡è€Œéç»†èŠ‚</p><p>é™ä½â€œè®¤è¯†çš„äººâ€çš„å¤æ‚åº¦</p><ol start="5"><li>åœ¨å®é™…å¼€å‘ä¸­çš„å…¸å‹åº”ç”¨<br>1ï¸Service è°ƒç”¨ Service</li></ol><p>ä¸è¦ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a.B.C.D.DoSomething();</span><br></pre></td></tr></table></figure><p>æ¨èï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a.DoSomething();</span><br></pre></td></tr></table></figure><p>DTO &#x2F; Entity è®¾è®¡</p><p>ä¸è¦åˆ°å¤„æš´éœ²å¯¹è±¡å†…éƒ¨ç»“æ„</p><p>ç”¨è¡Œä¸ºæ–¹æ³•ä»£æ›¿â€œè£¸ Getterâ€</p><p>.NET &#x2F; ä¾èµ–æ³¨å…¥ åœºæ™¯ï¼ˆç»“åˆä½ å¸¸ç”¨çš„ç‚¹ï¼‰</p><p>ä½ åœ¨åš Reflection &#x2F; æ¨¡å—åŠ è½½ &#x2F; æ’ä»¶ç³»ç»Ÿ æ—¶å°¤å…¶é‡è¦ï¼š</p><p>æ’ä»¶ç›´æ¥æ“ä½œå®¿ä¸»å†…éƒ¨å¯¹è±¡</p><p>æ’ä»¶åªä¾èµ– å®¿ä¸»æš´éœ²çš„æœ€å°æ¥å£</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IPluginContext</span></span><br><span class="line">&#123;</span><br><span class="line">    ILogger Logger &#123; <span class="keyword">get</span>; &#125;</span><br><span class="line">    IConfiguration Config &#123; <span class="keyword">get</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ’ä»¶ ä¸éœ€è¦çŸ¥é“å®¿ä¸»åˆ°åº•æœ‰å¤šå°‘æœåŠ¡ã€‚</p><h1 id="åˆæˆå¤ç”¨åŸåˆ™"><a href="#åˆæˆå¤ç”¨åŸåˆ™" class="headerlink" title="åˆæˆå¤ç”¨åŸåˆ™"></a>åˆæˆå¤ç”¨åŸåˆ™</h1><ol><li>åˆæˆå¤ç”¨åŸåˆ™ï¼ˆComposite Reuse Principleï¼ŒCRPï¼‰<br>ä¸€å¥è¯å…ˆè®°ä½</li></ol><p>ä¼˜å…ˆä½¿ç”¨â€œç»„åˆ &#x2F; èšåˆâ€ï¼Œè€Œä¸æ˜¯â€œç»§æ‰¿â€æ¥å®ç°å¤ç”¨ã€‚</p><p>å†ç‹ ä¸€ç‚¹çš„ç‰ˆæœ¬æ˜¯ï¼š</p><p>èƒ½ä¸ç”¨ç»§æ‰¿ï¼Œå°±åˆ«ç”¨ç»§æ‰¿ã€‚</p><p>ç»§æ‰¿ä¸€å¤šï¼Œå°±ä¼šå‡ºç°ï¼š<br>ç±»å±‚æ¬¡çˆ†ç‚¸<br>çˆ¶ç±»ä¸€æ”¹ï¼Œå­ç±»å…¨å‘˜å—ä¼¤<br>å­ç±»è¢«è¿«ç»§æ‰¿ä¸éœ€è¦çš„è¡Œä¸º<br>å¼ºè€¦åˆï¼Œä¸çµæ´»</p><ol start="2"><li>ä»€ä¹ˆæ˜¯â€œåˆæˆ &#x2F; èšåˆâ€ï¼Ÿ</li></ol><p>ç»„åˆï¼ˆCompositionï¼‰</p><p>å¼ºæ‹¥æœ‰å…³ç³»</p><p>ç”Ÿå‘½å‘¨æœŸä¸€è‡´</p><p>å…¸å‹ï¼šæˆå‘˜å˜é‡</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">OrderService</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> ILogger _logger;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>èšåˆï¼ˆAggregationï¼‰</p><p>å¼±æ‹¥æœ‰å…³ç³»</p><p>ç”Ÿå‘½å‘¨æœŸå¯ç‹¬ç«‹</p><p>å¸¸è§ï¼šæ„é€ å™¨ &#x2F; å‚æ•°ä¼ å…¥</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">OrderService</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">OrderService</span>(<span class="params">ILogger logger</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _logger = logger;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>CRP è¯´çš„å°±æ˜¯ï¼šç”¨è¿™ä¸¤ç§æ–¹å¼å¤ç”¨è¡Œä¸ºï¼Œè€Œä¸æ˜¯ç»§æ‰¿ã€‚</p><ol start="3"><li>ç»å…¸å¯¹æ¯”ï¼šç»§æ‰¿ vs ç»„åˆ</li></ol><p>ç»§æ‰¿å¼å¤ç”¨ï¼ˆä¸æ¨èï¼‰</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">CacheService</span> : <span class="title">RedisClient</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Save</span>(<span class="params"><span class="built_in">string</span> key, <span class="built_in">string</span> <span class="keyword">value</span></span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Set(key, <span class="keyword">value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é—®é¢˜ï¼š</p><p>CacheService è¢«ç»‘æ­»åœ¨ RedisClient</p><p>æ¢æˆ Memory &#x2F; DistributedCache æˆæœ¬å·¨å¤§</p><p>æµ‹è¯•ä¹Ÿå¾ˆç—›è‹¦</p><p>åˆæˆå¤ç”¨ï¼ˆæ¨èï¼‰</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">CacheService</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> ICacheClient _client;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CacheService</span>(<span class="params">ICacheClient client</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _client = client;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Save</span>(<span class="params"><span class="built_in">string</span> key, <span class="built_in">string</span> <span class="keyword">value</span></span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _client.Set(key, <span class="keyword">value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¼˜ç‚¹ï¼š</p><p>ä½è€¦åˆ</p><p>æ˜“æ‰©å±•</p><p>å®Œç¾é€‚é… ä¾èµ–æ³¨å…¥</p><ol start="4"><li>å’Œå…¶ä»–è®¾è®¡åŸåˆ™çš„å…³ç³»ï¼ˆä½“ç³»æ„Ÿï¼‰<br>é‡Œæ°æ›¿æ¢åŸåˆ™ï¼ˆLSPï¼‰</li></ol><p>ç»§æ‰¿å¿…é¡»æ»¡è¶³ LSP</p><p>CRPï¼šé‚£æˆ‘å¹²è„†å°‘ç”¨ç»§æ‰¿ </p><p>ä¾èµ–å€’ç½®åŸåˆ™ï¼ˆDIPï¼‰</p><p>ç»„åˆ + æ¥å£ &#x3D; DIP çš„å¤©ç„¶æ­æ¡£</p><p>å¼€é—­åŸåˆ™ï¼ˆOCPï¼‰</p><p>æ–°åŠŸèƒ½ â†’ æ–°ç»„åˆå¯¹è±¡</p><p>ä¸æ”¹åŸæœ‰ç±»</p><ol start="5"><li>åœ¨ .NET &#x2F; æ’ä»¶ &#x2F; æ¨¡å—åŒ–åœºæ™¯ä¸‹çš„ä»·å€¼ï¼ˆç»“åˆä½ çš„èƒŒæ™¯ï¼‰</li></ol><p>ä½ ä¹‹å‰æåˆ° Reflection + æ¨¡å—åŠ è½½ &#x2F; æ’ä»¶å¼•å¯¼å™¨ï¼ŒCRP åœ¨è¿™é‡Œéå¸¸å…³é”® </p><p>é”™è¯¯æ–¹å¼</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">MyPlugin</span> : <span class="title">HostApplication</span></span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ’ä»¶ï¼š</p><p>å¼ºä¾èµ–å®¿ä¸»</p><p>å®¿ä¸»ä¸€å‡çº§ï¼Œæ’ä»¶å…¨æŒ‚</p><p>æ­£ç¡®æ–¹å¼ï¼ˆåˆæˆå¤ç”¨ï¼‰</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">MyPlugin</span> : <span class="title">IPlugin</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> IPluginContext _context;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyPlugin</span>(<span class="params">IPluginContext context</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _context = context;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ’ä»¶åªâ€œç»„åˆâ€å®¿ä¸»èƒ½åŠ›ï¼š</p><p>æ—¥å¿—</p><p>é…ç½®</p><p>äº‹ä»¶æ€»çº¿</p><p>æ’ä»¶å¤ç”¨çš„æ˜¯â€œèƒ½åŠ›â€ï¼Œä¸æ˜¯â€œç±»å±‚æ¬¡â€ã€‚</p><ol start="6"><li>ä»€ä¹ˆæ—¶å€™â€œå¯ä»¥â€ç”¨ç»§æ‰¿ï¼Ÿ</li></ol><p>CRP â‰  ç¦æ­¢ç»§æ‰¿ï¼Œåªæ˜¯ æ…ç”¨ï¼š</p><p>å¯ä»¥ç»§æ‰¿çš„åœºæ™¯ï¼š</p><p>is-a å…³ç³»éå¸¸æ˜ç¡®</p><p>çˆ¶ç±»éå¸¸ç¨³å®š</p><p>å­ç±»ç¡®å®éœ€è¦çˆ¶ç±»å…¨éƒ¨è¡Œä¸º</p>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ASP.NET Core </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¼–ç¨‹æ€æƒ³2.1</title>
      <link href="/2025/12/07/%E7%BC%96%E7%A8%8B%E6%80%9D%E6%83%B3/%E9%AB%98%E5%86%85%E8%81%9A%EF%BC%8C%E4%BD%8E%E8%80%A6%E5%90%88/"/>
      <url>/2025/12/07/%E7%BC%96%E7%A8%8B%E6%80%9D%E6%83%B3/%E9%AB%98%E5%86%85%E8%81%9A%EF%BC%8C%E4%BD%8E%E8%80%A6%E5%90%88/</url>
      
        <content type="html"><![CDATA[<h1 id="é«˜å†…èš"><a href="#é«˜å†…èš" class="headerlink" title="é«˜å†…èš"></a>é«˜å†…èš</h1><blockquote><p>é«˜å†…èšï¼šæ¨¡å—å†…éƒ¨å…ƒç´ å…·æœ‰ç›¸åŒç‰¹ç‚¹çš„ç›¸ä¼¼ç¨‹åº¦ã€‚<br>é«˜å†…èšæä¾›äº†æ›´å¥½çš„ç¨‹åºå¯é æ€§ã€å¯è¯»æ€§ã€‚</p></blockquote><h2 id="æ¨¡å—"><a href="#æ¨¡å—" class="headerlink" title="æ¨¡å—:"></a>æ¨¡å—:</h2><ol><li><p>ä»€ä¹ˆæ˜¯æ¨¡å—å‘¢ï¼Ÿ</p><blockquote><p>å°åˆ°ä¸€ä¸ªæ–¹æ³•ã€ä¸€ä¸ªæ¥å£ã€ä¸€ä¸ªç±»ï¼Œå¤§åˆ°ä¸€ä¸ªä¸šåŠ¡ï¼Œä¸€ä¸ªåŠŸèƒ½ã€‚</p></blockquote></li><li><p>æ¨¡å—çš„å››è¦ç´ ï¼š</p><blockquote><p>æ¥å£:æ¨¡å—çš„è¾“å…¥å’Œè¾“å‡ºã€‚<br>åŠŸèƒ½ï¼šæ¨¡å—å®ç°äº†ä»€ä¹ˆåŠŸèƒ½ã€‚<br>é€»è¾‘ï¼šæ¨¡å—å†…éƒ¨å¦‚ä½•å®ç°è¦æ±‚çš„åŠŸèƒ½ï¼Œä»¥åŠæ‰€éœ€è¦çš„æ•°æ®ã€‚<br>çŠ¶æ€ï¼šæŒ‡æ¨¡å—è°ƒç”¨ä¸è¢«è°ƒç”¨çš„å…³ç³»ã€‚</p></blockquote></li><li><p>è€Œé«˜å†…èšå°±æ˜¯æŒ‡æ¨¡å—å†…çš„ç›¸ä¼¼ç¨‹åº¦</p></li></ol><p>ä¸¾ä¾‹ï¼š</p><p>æ¨¡å—ä¸­æœ‰ï¼š<br>Class:æ–°é—»ç®¡ç† Method:æ–°é—»æŸ¥çœ‹ã€æ–°é—»æ›´æ–°ã€æ–°é—»åˆ é™¤<br>Class:ç”¨æˆ·ç®¡ç† Method:è®¾ç½®ç”¨æˆ·åã€è®¾ç½®å¯†ç ã€ç”¨æˆ·æ³¨å†Œã€ç”¨æˆ·åˆ é™¤</p><p>è¿™ä¸¤ä¸ªä¾‹å­å°±æ˜¯é«˜å†…èšï¼Œæ–°é—»ç±»ä¸­æä¾›çš„æ–¹æ³•ã€å…ƒç´ éƒ½è·Ÿæ–°é—»æœ‰å…³ï¼Œè¿™å°±æ˜¯å…·æœ‰ç›¸åŒç‰¹ç‚¹çš„ç›¸ä¼¼ç¨‹åº¦ç¬¦åˆé«˜å†…èšçš„æ ‡å‡†ã€‚</p><p>ä½å†…èšï¼š</p><p>Class:æ–°é—»ç®¡ç† Method:æ–°é—»æŸ¥çœ‹ã€æ–°é—»æ›´æ–°ã€æ–°é—»åˆ é™¤,ç”¨æˆ·æ³¨å†Œ</p><ol start="4"><li>ä½å†…èšä¼šç»™æˆ‘ä»¬å¸¦æ¥ä»€ä¹ˆé—®é¢˜ï¼Ÿ</li></ol><blockquote><p>ä½è€¦åˆï¼šèƒ½ä¸å¼•ç”¨ç»ä¸å¼•ç”¨ï¼Œå®å¯é—´æ¥å¼•ç”¨<br>ç‰µä¸€å‘è€ŒåŠ¨å…¨èº«</p></blockquote><h1 id="ä½è€¦åˆ"><a href="#ä½è€¦åˆ" class="headerlink" title="ä½è€¦åˆ"></a>ä½è€¦åˆ</h1><blockquote><p>æŒ‡çš„æ˜¯æ¨¡å—ä¹‹é—´çš„ä¾èµ–ç¨‹åº¦ã€‚<br>ä½è€¦åˆæä¾›äº†æ›´å¥½çš„ç¨‹åºå¯æ‰©å±•æ€§å’Œå¯å¤ç”¨æ€§ã€‚</p></blockquote><p>ä¸¾ä¾‹ï¼š</p><p>ä¸»æ¿&amp;æ˜¾å¡<br>æ˜¾å¡ä¸ä¾èµ–äºæŸä¸€æ¬¾ä¸»æ¿  ä½è€¦åˆ<br>æ˜¾å¡å¿…é¡»ä¾èµ–è«ä¸€æ¬¾ä¸»æ¿  é«˜è€¦åˆ</p><p>ç”·&amp;å¥³<br>æ‹çˆ±å‰ï¼Œç”·å’Œå¥³äº’ç›¸ä¸ä¾èµ–  ä½è€¦åˆ<br>æ‹çˆ±åï¼Œç”·å’Œå¥³ç›¸äº’ä¾èµ–    é«˜è€¦åˆ</p><p>å†æ¯”å¦‚ï¼š</p><p><img src="/img%5C%E7%BC%96%E7%A8%8B%E6%80%9D%E6%83%B3%5C4.png"></p><p>è¿™ä¹Ÿæ˜¯ä½è€¦åˆï¼Œç”µæºæ’åº§ç­‰ï¼Œæ²¡æœ‰å›ºå®šå¿…é¡»æ’ä»€ä¹ˆç‰Œå­çš„æ’å£ï¼Œéšæœºåº”å˜ï¼Œè¿™å°±æ˜¯ä½è€¦åˆã€‚</p>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ASP.NET Core </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¼–ç¨‹æ€æƒ³1.1</title>
      <link href="/2025/12/06/%E7%BC%96%E7%A8%8B%E6%80%9D%E6%83%B3/%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3/"/>
      <url>/2025/12/06/%E7%BC%96%E7%A8%8B%E6%80%9D%E6%83%B3/%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3/</url>
      
        <content type="html"><![CDATA[<h1 id="å¯è½åœ°ï¼Œå¯å¤–æ˜¾"><a href="#å¯è½åœ°ï¼Œå¯å¤–æ˜¾" class="headerlink" title="å¯è½åœ°ï¼Œå¯å¤–æ˜¾"></a>å¯è½åœ°ï¼Œå¯å¤–æ˜¾</h1><p>å¯è½åœ°ï¼šæ˜¯æˆ‘ä»¬æ‰€å­¦çš„ç¼–ç¨‹æ€æƒ³å¯ä»¥ç›´æ¥è¿ç”¨åˆ°æ—¥å¸¸ä»£ç å½“ä¸­çš„</p><p>å¯å¤–æ˜¾ï¼šä»£ç æ˜¯å¦ä½¿ç”¨ç¼–ç¨‹æ€æƒ³</p><blockquote><p>ç¼–ç¨‹æ€æƒ³ï¼šèƒ½å¤Ÿä½¿æˆ‘ä»¬çš„ä»£ç ï¼Œå»<b>æ‰¿è½½</b>é¡¹ç›®ä¸­<b>å¾ˆå¤æ‚çš„ä¸šåŠ¡é€»è¾‘</b>ï¼Œå¹¶ä¸”ä½¿æˆ‘çš„ä»£ç çœ‹èµ·æ¥éå¸¸çš„ç®€æ´æ˜“æ‡‚ï¼Œå¹¶ä¸”<b>æ˜“äºæ‰©å±•</b>ã€‚</p></blockquote><p>æ‰¿è½½ã€ä¸šåŠ¡é€»è¾‘ã€æ˜“äºæ‰©å±•ï¼Œè¿™ä¸‰ä¸ªä½¿æ ¸å¿ƒç›®æ ‡</p><h2 id="é¦–å…ˆæ‰¿è½½ã€ä¸šåŠ¡é€»è¾‘ï¼Œä»£ç åŸºäºä½¿ç”¨ç¼–ç¨‹æ€æƒ³çš„ä»£ç ï¼Œæ‰èƒ½å¤Ÿæ‰¿è½½å¾ˆå¤æ‚çš„ä¸šåŠ¡é€»è¾‘ã€‚"><a href="#é¦–å…ˆæ‰¿è½½ã€ä¸šåŠ¡é€»è¾‘ï¼Œä»£ç åŸºäºä½¿ç”¨ç¼–ç¨‹æ€æƒ³çš„ä»£ç ï¼Œæ‰èƒ½å¤Ÿæ‰¿è½½å¾ˆå¤æ‚çš„ä¸šåŠ¡é€»è¾‘ã€‚" class="headerlink" title="é¦–å…ˆæ‰¿è½½ã€ä¸šåŠ¡é€»è¾‘ï¼Œä»£ç åŸºäºä½¿ç”¨ç¼–ç¨‹æ€æƒ³çš„ä»£ç ï¼Œæ‰èƒ½å¤Ÿæ‰¿è½½å¾ˆå¤æ‚çš„ä¸šåŠ¡é€»è¾‘ã€‚"></a>é¦–å…ˆæ‰¿è½½ã€ä¸šåŠ¡é€»è¾‘ï¼Œä»£ç åŸºäºä½¿ç”¨ç¼–ç¨‹æ€æƒ³çš„ä»£ç ï¼Œæ‰èƒ½å¤Ÿæ‰¿è½½å¾ˆå¤æ‚çš„ä¸šåŠ¡é€»è¾‘ã€‚</h2><p>ä¸¾ä¾‹ï¼š</p><p><b>æ·˜å®</b></p><p>æ·˜å®å¯åˆ†ä¸ºä¸¤å¤§ç±»ï¼šå•†å®¶å–è´§ï¼Œä¹°å®¶ä¹°è´§ã€‚</p><p>è¿™ä¸¤å¤§ç±»åˆå¯ä»¥åˆ†ä¸ºè‹¥å¹²ä¸ªå°ç±»ï¼Œè€Œè‹¥å¹²ä¸ªå°ç±»æœ‰ç”±è‹¥å¹²ä¸ªå…¶ä»–çš„ç±»ç»„æˆã€‚</p><p><img src="/img%5C%E7%BC%96%E7%A8%8B%E6%80%9D%E6%83%B3%5C1.png"></p><p>è€Œæ‰€è°“çš„ä¸šä½™é€»è¾‘å°±æ˜¯æˆ‘ä»¬çš„ç”¨æˆ·å®ç°æˆ–å®Œæˆä¸€ä¸ªåŠŸèƒ½çš„æœ€ç®€å•ã€æœ€å°çš„é—­ç¯çš„ã€‚</p><blockquote><p>ä¸šåŠ¡é€»è¾‘ç”±ï¼šæµç¨‹ç¯èŠ‚ï¼Œäººæœºäº¤äº’ï¼Œæ•°æ®äº¤äº’</p></blockquote><p>è€ŒæµåŠ¨ç¯èŠ‚å†³å®šä»€ä¹ˆæ—¶å€™éœ€è¦äººæœºäº¤äº’ã€ä»€ä¹ˆæ—¶å€™éœ€è¦æ•°æ®äº¤äº’ã€‚<br>äººæœºäº¤äº’äº§å‡ºâ€œå‘½ä»¤&#x2F;æ„å›¾â€,å‡ºå‘ç¯èŠ‚å…¶è¿ç§»ï¼›æ•°æ®äº¤äº’è¿”å›â€œäº‹å®&#x2F;äº‹ä»¶â€ï¼Œåé¦ˆç»™æµç¨‹å†³å®šåç»­åˆ†æ”¯ã€‚</p><p>ä¸¾ä¾‹ï¼šè®¢å•ç³»ç»Ÿ</p><p>è®¢å•ç³»ç»Ÿï¼šç”¨æˆ·è´­ä¹°å•†å“ç”Ÿäº§<b>è®¢å•ç”Ÿæˆ</b>åœ¨è¿›è¡Œæ”¯ä»˜ç”Ÿäº§<b>æ”¯ä»˜è®¢å•</b>æ”¯ä»˜å®Œ<b>å•†å®¶å‘è´§</b>ç”¨æˆ·æ”¶åˆ°ç”Ÿäº§<b>ç¡®è®¤æ”¶è´§</b>åœ¨<b>äº¤æ˜“å®Œæˆ</b></p><p><img src="/img%5C%E7%BC%96%E7%A8%8B%E6%80%9D%E6%83%B3%5C2.png"></p><p>è¿™è¿˜ä¸å¤Ÿï¼Œæ¯”å¦‚è®¢å•ç”Ÿäº§ç³»ç»Ÿä¸‹è¿˜æœ‰ä¸šåŠ¡é€»è¾‘ã€‚</p><p><img src="/img%5C%E7%BC%96%E7%A8%8B%E6%80%9D%E6%83%B3%5C3.png"></p><p>è€Œè¿™å…ˆéƒ½è¿ç”¨åˆ°äº†ä¸šåŠ¡é€»è¾‘çš„æµç¨‹ç¯èŠ‚ï¼Œäººæœºäº¤äº’ï¼Œæ•°æ®äº¤äº’ã€‚</p><p><b>è®¢å•ç”Ÿæˆä¸šåŠ¡é€»è¾‘è¦å…ˆç¡®è®¤æµç¨‹ç¯èŠ‚ï¼š</b></p><h3 id="1ï¸-ç”¨æˆ·é€‰æ‹©å•†å“ã€å¡«å†™æ•°é‡"><a href="#1ï¸-ç”¨æˆ·é€‰æ‹©å•†å“ã€å¡«å†™æ•°é‡" class="headerlink" title="1ï¸ ç”¨æˆ·é€‰æ‹©å•†å“ã€å¡«å†™æ•°é‡"></a>1ï¸ ç”¨æˆ·é€‰æ‹©å•†å“ã€å¡«å†™æ•°é‡</h3><p>æäº¤è®¢å•è¯·æ±‚</p><p>è¿›å…¥è®¢å•åˆ›å»ºæµç¨‹</p><h3 id="2ï¸-å•†å“ä¿¡æ¯æ ¡éªŒ"><a href="#2ï¸-å•†å“ä¿¡æ¯æ ¡éªŒ" class="headerlink" title="2ï¸ å•†å“ä¿¡æ¯æ ¡éªŒ"></a>2ï¸ å•†å“ä¿¡æ¯æ ¡éªŒ</h3><p>æŸ¥è¯¢å•†å“æ˜¯å¦å­˜åœ¨</p><p>æŸ¥è¯¢å•†å“å½“å‰ä»·æ ¼</p><p>æŸ¥è¯¢å•†å“æ˜¯å¦å‚ä¸æ´»åŠ¨</p><p>æ£€æŸ¥å•†å“æ˜¯å¦å…è®¸è´­ä¹°ï¼ˆä¸Šä¸‹æ¶çŠ¶æ€ï¼‰</p><h3 id="3ï¸-ä¼˜æƒ ä¿¡æ¯å¤„ç†"><a href="#3ï¸-ä¼˜æƒ ä¿¡æ¯å¤„ç†" class="headerlink" title="3ï¸ ä¼˜æƒ ä¿¡æ¯å¤„ç†"></a>3ï¸ ä¼˜æƒ ä¿¡æ¯å¤„ç†</h3><p>æŸ¥è¯¢ç”¨æˆ·å¯ç”¨ä¼˜æƒ åˆ¸</p><p>æ£€æŸ¥æ»¡å‡ã€é™æ—¶æŠ˜æ‰£ç­‰æ´»åŠ¨</p><p>è®¡ç®—å¯ç”¨ä¼˜æƒ é‡‘é¢</p><p>æ ¡éªŒä¼˜æƒ åˆ¸ä½¿ç”¨è§„åˆ™ï¼ˆæœ‰æ•ˆæœŸã€é™è´­ã€æ˜¯å¦å†²çªç­‰ï¼‰</p><h3 id="4ï¸-ä¼šå‘˜æƒç›Šè®¡ç®—"><a href="#4ï¸-ä¼šå‘˜æƒç›Šè®¡ç®—" class="headerlink" title="4ï¸ ä¼šå‘˜æƒç›Šè®¡ç®—"></a>4ï¸ ä¼šå‘˜æƒç›Šè®¡ç®—</h3><p>æŸ¥è¯¢ä¼šå‘˜ç­‰çº§</p><p>è®¡ç®—ä¼šå‘˜ä¸“å±æŠ˜æ‰£</p><p>åˆ¤æ–­æ˜¯å¦å¯äº«å—ç§¯åˆ†æŠµæ‰£</p><p>åº”ç”¨ä¼šå‘˜ä»·ã€åŒ…é‚®èµ„æ ¼ç­‰</p><h3 id="5ï¸-åº“å­˜å‡å°‘ï¼ˆåº“å­˜é¢„æ‰£ï¼‰"><a href="#5ï¸-åº“å­˜å‡å°‘ï¼ˆåº“å­˜é¢„æ‰£ï¼‰" class="headerlink" title="5ï¸ åº“å­˜å‡å°‘ï¼ˆåº“å­˜é¢„æ‰£ï¼‰"></a>5ï¸ åº“å­˜å‡å°‘ï¼ˆåº“å­˜é¢„æ‰£ï¼‰</h3><p>æ ¡éªŒåº“å­˜æ˜¯å¦è¶³å¤Ÿ</p><p>æ‰£å‡å•†å“åº“å­˜ï¼ˆé¢„æ‰£æˆ–æœ€ç»ˆæ‰£å‡ï¼‰</p><p>è‹¥åº“å­˜ä¸è¶³åˆ™è®¢å•åˆ›å»ºå¤±è´¥</p><h3 id="6ï¸-è¿è´¹è®¡ç®—"><a href="#6ï¸-è¿è´¹è®¡ç®—" class="headerlink" title="6ï¸ è¿è´¹è®¡ç®—"></a>6ï¸ è¿è´¹è®¡ç®—</h3><p>æ ¹æ®æ”¶è´§åœ°å€è®¡ç®—è¿è´¹</p><p>åŒ¹é…å¿«é€’æ–¹å¼è§„åˆ™</p><p>åˆ¤æ–­æ˜¯å¦ç¬¦åˆåŒ…é‚®æ¡ä»¶</p><p>è®¡ç®—æœ€ç»ˆè¿è´¹é‡‘é¢</p><h3 id="7ï¸-ç”Ÿæˆè®¢å•"><a href="#7ï¸-ç”Ÿæˆè®¢å•" class="headerlink" title="7ï¸ ç”Ÿæˆè®¢å•"></a>7ï¸ ç”Ÿæˆè®¢å•</h3><p>æ±‡æ€»å•†å“é‡‘é¢ã€ä¼˜æƒ é‡‘é¢ã€ä¼šå‘˜æŠ˜æ‰£ã€è¿è´¹</p><p>å¾—åˆ°æœ€ç»ˆåº”ä»˜é‡‘é¢</p><p>å†™å…¥è®¢å•æ•°æ®åº“ï¼ˆè®¢å•å·ã€ç”¨æˆ·ä¿¡æ¯ã€å•†å“æ¸…å•ç­‰ï¼‰</p><p>è¿”å›è®¢å•ç¡®è®¤ä¿¡æ¯</p><h2 id="æœ€åå¹¶ä¸”ä½¿æˆ‘çš„ä»£ç çœ‹èµ·æ¥éå¸¸çš„ç®€æ´æ˜“æ‡‚ï¼Œå¹¶ä¸”æ˜“äºæ‰©å±•ã€‚"><a href="#æœ€åå¹¶ä¸”ä½¿æˆ‘çš„ä»£ç çœ‹èµ·æ¥éå¸¸çš„ç®€æ´æ˜“æ‡‚ï¼Œå¹¶ä¸”æ˜“äºæ‰©å±•ã€‚" class="headerlink" title="æœ€åå¹¶ä¸”ä½¿æˆ‘çš„ä»£ç çœ‹èµ·æ¥éå¸¸çš„ç®€æ´æ˜“æ‡‚ï¼Œå¹¶ä¸”æ˜“äºæ‰©å±•ã€‚"></a>æœ€åå¹¶ä¸”ä½¿æˆ‘çš„ä»£ç çœ‹èµ·æ¥éå¸¸çš„ç®€æ´æ˜“æ‡‚ï¼Œå¹¶ä¸”æ˜“äºæ‰©å±•ã€‚</h2><p>å°±æ˜¯ä¾¿äºéœ€æ±‚çš„æ”¹å˜</p><p>å¯åˆ†ä¸ºä¸¤ç§ï¼šæ·»åŠ æ–°äº§å“åŠŸèƒ½ï¼Œå¯¹äº§å“åŸåŠŸèƒ½è¿›è¡Œä¸šåŠ¡ä¿®æ”¹</p><blockquote><p>åªæ·»åŠ æ–°ä»£ç ï¼Œä¸ä¿®æ”¹æºä»£ç &#x2F;åœ¨ä¿®æ”¹åŸåŠŸèƒ½çš„åŸºç¡€ä¸Šï¼Œä¸å½±å“ä»¥å…¶åŠŸèƒ½çš„æ‰§è¡Œ</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ASP.NET Core </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ­å»ºè®¤è¯æœåŠ¡</title>
      <link href="/2025/11/17/asp.net%20core/%E5%AD%A6%E8%8B%B1%E8%AF%AD%E7%BD%91%E7%AB%99%E9%A1%B9%E7%9B%AE/%E8%AE%A4%E8%AF%81%E6%9C%8D%E5%8A%A1/"/>
      <url>/2025/11/17/asp.net%20core/%E5%AD%A6%E8%8B%B1%E8%AF%AD%E7%BD%91%E7%AB%99%E9%A1%B9%E7%9B%AE/%E8%AE%A4%E8%AF%81%E6%9C%8D%E5%8A%A1/</url>
      
        <content type="html"><![CDATA[<blockquote><p>è®¤è¯æœåŠ¡ç”¨æ¥éªŒè¯ç”¨æˆ·ç™»å½•å¹¶é¢å‘JWTï¼Œä¹Ÿæä¾›ç”¨æˆ·ç®¡ç†ç­‰APIã€‚è®¤è¯æœåŠ¡çš„å®ç°ä»£ç éƒ½åŸºäºAuthenticationä¸Authorizationã€‚</p></blockquote><h1 id="å¼€å‘è®¤è¯æœåŠ¡çš„é¢†åŸŸå±‚"><a href="#å¼€å‘è®¤è¯æœåŠ¡çš„é¢†åŸŸå±‚" class="headerlink" title="å¼€å‘è®¤è¯æœåŠ¡çš„é¢†åŸŸå±‚"></a>å¼€å‘è®¤è¯æœåŠ¡çš„é¢†åŸŸå±‚</h1><p>IdentityService.Domainæ˜¯è®¤è¯æœåŠ¡çš„é¢†åŸŸå±‚é¡¹ç›®ã€‚ASP.NET Coreçš„æ ‡è¯†æ¡†æ¶ä¸­å·²ç»æä¾›äº†IdentityRoleã€IdentityUserç­‰åŸºç¡€çš„å®ä½“ç±»ï¼Œæˆ‘ä»¬åªè¦ç¼–å†™å®ƒä»¬çš„å­ç±»ï¼Œç„¶åæ ¹æ®éœ€è¦å†æ·»åŠ è‡ªå®šä¹‰çš„å±æ€§å³å¯ã€‚</p><p>é¦–å…ˆåˆ›å»ºRoleå’ŒUserç±»è¿›è¡Œç¼–å†™</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">IdentityService.Domain.Entities</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> è¡¨ç¤ºç³»ç»Ÿä¸­çš„è§’è‰²å®ä½“ï¼Œç»§æ‰¿è‡ª ASP.NET Core Identity çš„ IdentityRoleï¼Œä¸»é”®ç±»å‹ä¸º Guidã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Role</span> : <span class="title">IdentityRole</span>&lt;<span class="title">Guid</span>&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ„é€ å‡½æ•°ã€‚åˆ›å»ºè§’è‰²å®ä¾‹æ—¶è‡ªåŠ¨ç”Ÿæˆå”¯ä¸€çš„ Guid ä½œä¸ºè§’è‰²çš„ä¸»é”® Idã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Role</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// ä¸ºè§’è‰²åˆ†é…ä¸€ä¸ªæ–°çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆGuidï¼‰ï¼Œç¡®ä¿æ¯ä¸ªè§’è‰²çš„ Id å”¯ä¸€ã€‚</span></span><br><span class="line">            <span class="keyword">this</span>.Id = Guid.NewGuid();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">IdentityService.Domain.Entities</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ç”¨æˆ·å®ä½“ï¼Œç»§æ‰¿è‡ª ASP.NET Core Identity çš„æ³›å‹ç”¨æˆ·ç±»ï¼Œ</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> å¹¶å®ç°äº†åˆ›å»ºæ—¶é—´ã€åˆ é™¤æ—¶é—´å’Œè½¯åˆ é™¤ç›¸å…³æ¥å£ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">User</span> : <span class="title">IdentityUser</span>&lt;<span class="title">Guid</span>&gt;, <span class="title">IHasCreationTime</span>, <span class="title">IHasDeletionTime</span>, <span class="title">ISoftDelete</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ç”¨æˆ·çš„åˆ›å»ºæ—¶é—´ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> DateTime CreationTime &#123; <span class="keyword">get</span>; <span class="keyword">init</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ç”¨æˆ·è¢«åˆ é™¤çš„æ—¶é—´ï¼ˆå¦‚æœå·²åˆ é™¤ï¼Œå¦åˆ™ä¸º nullï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> DateTime? DeletionTime &#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ç”¨æˆ·æ˜¯å¦å·²è¢«è½¯åˆ é™¤ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">bool</span> IsDeleted &#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> åˆ›å»ºç”¨æˆ·å®ä¾‹æ—¶ï¼ŒæŒ‡å®šç”¨æˆ·åï¼Œå¹¶è‡ªåŠ¨ç”Ÿæˆå”¯ä¸€ Id å’Œåˆ›å»ºæ—¶é—´ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;userName&quot;&gt;</span>ç”¨æˆ·å<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">User</span>(<span class="params"><span class="built_in">string</span> userName</span>) : <span class="title">base</span>(<span class="params">userName</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Id = Guid.NewGuid();</span><br><span class="line">            CreationTime = DateTime.Now;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ‰§è¡Œè½¯åˆ é™¤æ“ä½œï¼Œå°†ç”¨æˆ·æ ‡è®°ä¸ºå·²åˆ é™¤ï¼Œå¹¶è®°å½•åˆ é™¤æ—¶é—´ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SoftDelete</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.IsDeleted = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">this</span>.DeletionTime = DateTime.Now;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨æ ¹æ®æ‰‹æœºå·åŠ çŸ­ä¿¡éªŒè¯ç è¿›è¡Œç™»å½•çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å®ç°å‘é€çŸ­ä¿¡çš„åŠŸèƒ½ï¼Œè€ŒçŸ­ä¿¡éªŒè¯ç å‘é€æœåŠ¡çš„æä¾›å•†ä¹Ÿæ¯”è¾ƒå¤šï¼Œä¸ºäº†å±è”½ä¸åŒæä¾›å•†çš„ä»£ç ï¼Œæˆ‘ä»¬å¼€å‘äº†ä¸€ä¸ªé˜²è…å±‚æ¥å£ISmsSenderã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">IdentityService.Domain</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> çŸ­ä¿¡å‘é€æœåŠ¡æ¥å£ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">ISmsSender</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å¼‚æ­¥å‘é€çŸ­ä¿¡ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;phoneNum&quot;&gt;</span>æ¥æ”¶çŸ­ä¿¡çš„æ‰‹æœºå·ç ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;args&quot;&gt;</span>çŸ­ä¿¡å†…å®¹å‚æ•°ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>è¡¨ç¤ºå¼‚æ­¥æ“ä½œçš„ä»»åŠ¡ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Task <span class="title">SendAsync</span>(<span class="params"><span class="built_in">string</span> phoneNum, <span class="keyword">params</span> <span class="built_in">string</span>[] args</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å®šä¹‰ä»“å‚¨æ¥å£IIdRepositoryï¼Œè¿™ä¸ªæ¥å£æä¾›äº†å¾ˆå¤šæ–¹æ³•ï¼Œæ¯”å¦‚ï¼šæ ¹æ®Idè·å–ç”¨æˆ·ï¼Œé‡ç½®å¯†ç ï¼Œåˆ é™¤å¯†ç ç­‰ç­‰ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">IdentityService.Domain</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ç”¨æˆ·èº«ä»½ä»“å‚¨æ¥å£ï¼Œå®šä¹‰äº†ç”¨æˆ·ç›¸å…³çš„æŸ¥æ‰¾ã€åˆ›å»ºã€ä¿®æ”¹ã€è§’è‰²ç®¡ç†ç­‰æ“ä½œã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ä¸»è¦ç”¨äºå¯¹ç”¨æˆ·å®ä½“çš„æŒä¹…åŒ–æ“ä½œå’Œèº«ä»½éªŒè¯ç›¸å…³åŠŸèƒ½ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IIdRepository</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ ¹æ®ç”¨æˆ·å”¯ä¸€æ ‡è¯†æŸ¥æ‰¾ç”¨æˆ·ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>ç”¨æˆ·çš„å”¯ä¸€æ ‡è¯†ï¼ˆGUIDï¼‰ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>æ‰¾åˆ°çš„ç”¨æˆ·å¯¹è±¡æˆ– nullã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        Task&lt;User?&gt; FindByIdAsync(Guid id);</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ ¹æ®ç”¨æˆ·åæŸ¥æ‰¾ç”¨æˆ·ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;userName&quot;&gt;</span>ç”¨æˆ·åã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>æ‰¾åˆ°çš„ç”¨æˆ·å¯¹è±¡æˆ– nullã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        Task&lt;User?&gt; FindByNameAsync(<span class="built_in">string</span> userName);</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ ¹æ®æ‰‹æœºå·æŸ¥æ‰¾ç”¨æˆ·ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;phoneNum&quot;&gt;</span>æ‰‹æœºå·ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>æ‰¾åˆ°çš„ç”¨æˆ·å¯¹è±¡æˆ– nullã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        Task&lt;User?&gt; FindByPhoneNumberAsync(<span class="built_in">string</span> phoneNum);  </span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> åˆ›å»ºæ–°ç”¨æˆ·å¹¶è®¾ç½®å¯†ç ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;user&quot;&gt;</span>ç”¨æˆ·å¯¹è±¡ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;password&quot;&gt;</span>ç”¨æˆ·å¯†ç ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>åˆ›å»ºç»“æœã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function">Task&lt;IdentityResult&gt; <span class="title">CreateAsync</span>(<span class="params">User user, <span class="built_in">string</span> password</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> è®°å½•ç”¨æˆ·ç™»å½•å¤±è´¥ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;user&quot;&gt;</span>ç”¨æˆ·å¯¹è±¡ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>æ“ä½œç»“æœã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function">Task&lt;IdentityResult&gt; <span class="title">AccessFaailedAsync</span>(<span class="params">User user</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ç”Ÿæˆæ›´æ¢æ‰‹æœºå·çš„éªŒè¯ç ä»¤ç‰Œã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;user&quot;&gt;</span>ç”¨æˆ·å¯¹è±¡ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;phoneNumber&quot;&gt;</span>æ–°æ‰‹æœºå·ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>éªŒè¯ç ä»¤ç‰Œå­—ç¬¦ä¸²ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function">Task&lt;<span class="built_in">string</span>&gt; <span class="title">GenerateChangePhoneNumberTokenAsync</span>(<span class="params">User user, <span class="built_in">string</span> phoneNumber</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ä½¿ç”¨éªŒè¯ç ä»¤ç‰Œæ›´æ¢ç”¨æˆ·æ‰‹æœºå·ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;userId&quot;&gt;</span>ç”¨æˆ·å”¯ä¸€æ ‡è¯†ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;phoneNum&quot;&gt;</span>æ–°æ‰‹æœºå·ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;token&quot;&gt;</span>éªŒè¯ç ä»¤ç‰Œã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>æ›´æ¢ç»“æœã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function">Task&lt;SignInResult&gt; <span class="title">ChangePasswordAsync</span>(<span class="params">Guid userId, <span class="built_in">string</span> phoneNum, <span class="built_in">string</span> token</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ä¿®æ”¹ç”¨æˆ·å¯†ç ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;userId&quot;&gt;</span>ç”¨æˆ·å”¯ä¸€æ ‡è¯†ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;password&quot;&gt;</span>æ–°å¯†ç ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>ä¿®æ”¹ç»“æœã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function">Task&lt;IdentityResult&gt; <span class="title">ChangePasswordAsync</span>(<span class="params">Guid userId, <span class="built_in">string</span> password</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> è·å–ç”¨æˆ·æ‰€å±çš„æ‰€æœ‰è§’è‰²ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;user&quot;&gt;</span>ç”¨æˆ·å¯¹è±¡ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>è§’è‰²åç§°åˆ—è¡¨ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        Task&lt;IList&lt;<span class="built_in">string</span>&gt;&gt; GetRolesAsync(User user);</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å°†ç”¨æˆ·æ·»åŠ åˆ°æŒ‡å®šè§’è‰²ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;user&quot;&gt;</span>ç”¨æˆ·å¯¹è±¡ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;role&quot;&gt;</span>è§’è‰²åç§°ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>æ·»åŠ ç»“æœã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function">Task&lt;IdentityResult&gt; <span class="title">AddToRoleAsync</span>(<span class="params">User user, <span class="built_in">string</span> role</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ£€æŸ¥ç”¨æˆ·ç™»å½•ä¿¡æ¯æ˜¯å¦æ­£ç¡®ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;user&quot;&gt;</span>ç”¨æˆ·å¯¹è±¡ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;password&quot;&gt;</span>å¯†ç ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;lockoutOnFailure&quot;&gt;</span>ç™»å½•å¤±è´¥æ˜¯å¦é”å®šè´¦æˆ·ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>ç™»å½•æ£€æŸ¥ç»“æœã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Task&lt;SignInResult&gt; <span class="title">CheckForSignInAsync</span>(<span class="params">User user, <span class="built_in">string</span> password, <span class="built_in">bool</span> lockoutOnFailure</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ç¡®è®¤ç”¨æˆ·æ‰‹æœºå·å·²éªŒè¯ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>ç”¨æˆ·å”¯ä¸€æ ‡è¯†ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>å¼‚æ­¥æ“ä½œã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Task <span class="title">ConfirmPhoneNumberAsync</span>(<span class="params">Guid id</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ›´æ–°ç”¨æˆ·æ‰‹æœºå·ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>ç”¨æˆ·å”¯ä¸€æ ‡è¯†ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;phoneNum&quot;&gt;</span>æ–°æ‰‹æœºå·ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>å¼‚æ­¥æ“ä½œã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Task <span class="title">UpdatePhoneNumberAsync</span>(<span class="params">Guid id, <span class="built_in">string</span> phoneNum</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> åˆ é™¤ç”¨æˆ·ï¼ˆè½¯åˆ é™¤ï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>ç”¨æˆ·å”¯ä¸€æ ‡è¯†ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>åˆ é™¤ç»“æœã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Task&lt;IdentityResult&gt; <span class="title">RemoveUserAsync</span>(<span class="params">Guid id</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ·»åŠ ç®¡ç†å‘˜ç”¨æˆ·ï¼Œå¹¶è¿”å›åˆ›å»ºç»“æœã€ç”¨æˆ·å¯¹è±¡å’Œåˆå§‹å¯†ç ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;userName&quot;&gt;</span>ç”¨æˆ·åã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;phoneNum&quot;&gt;</span>æ‰‹æœºå·ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>åˆ›å»ºç»“æœã€ç”¨æˆ·å¯¹è±¡å’Œåˆå§‹å¯†ç ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> Task&lt;(IdentityResult, User?, <span class="built_in">string</span>? password)&gt; AddAdminUserAsync(<span class="built_in">string</span> userName, <span class="built_in">string</span> phoneNum);</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> é‡ç½®ç”¨æˆ·å¯†ç ï¼Œå¹¶è¿”å›æ“ä½œç»“æœã€ç”¨æˆ·å¯¹è±¡å’Œæ–°å¯†ç ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>ç”¨æˆ·å”¯ä¸€æ ‡è¯†ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>é‡ç½®ç»“æœã€ç”¨æˆ·å¯¹è±¡å’Œæ–°å¯†ç ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> Task&lt;(IdentityResult, User?, <span class="built_in">string</span>? password)&gt; ResetPasswordAsync(Guid id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åï¼Œæˆ‘ä»¬å¼€å‘è®¤è¯é¢†åŸŸæœåŠ¡IdDomainServiceã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">IdentityService.Domain</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> èº«ä»½é¢†åŸŸæœåŠ¡ï¼Œè´Ÿè´£ç”¨æˆ·ç™»å½•ã€èº«ä»½æ ¡éªŒã€ä»¤ç‰Œç”Ÿæˆç­‰æ ¸å¿ƒèº«ä»½ç›¸å…³ä¸šåŠ¡é€»è¾‘ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">IdDomainService</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> IIdRepository repository; <span class="comment">// ç”¨æˆ·æ•°æ®ä»“å‚¨æ¥å£</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> ITokenService tokenService; <span class="comment">// JWT ä»¤ç‰ŒæœåŠ¡</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> IOptions&lt;JWTOptions&gt; optJWT; <span class="comment">// JWT é…ç½®é€‰é¡¹</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ„é€ å‡½æ•°ï¼Œæ³¨å…¥ç”¨æˆ·ä»“å‚¨ã€ä»¤ç‰ŒæœåŠ¡å’ŒJWTé…ç½®ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">IdDomainService</span>(<span class="params">IIdRepository repository,ITokenService tokenService,IOptions&lt;JWTOptions&gt; optJWT</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.repository = repository;</span><br><span class="line">            <span class="keyword">this</span>.tokenService = tokenService;</span><br><span class="line">            <span class="keyword">this</span>.optJWT = optJWT;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ ¡éªŒç”¨æˆ·åå’Œå¯†ç æ˜¯å¦æ­£ç¡®ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;userName&quot;&gt;</span>ç”¨æˆ·å<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;password&quot;&gt;</span>å¯†ç <span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>ç™»å½•ç»“æœ<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">async</span> Task&lt;SignInResult&gt; <span class="title">CheckUserNameAndPwdAsync</span>(<span class="params"><span class="built_in">string</span> userName,<span class="built_in">string</span> password</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> user = <span class="keyword">await</span> repository.FindByNameAsync(userName);</span><br><span class="line">            <span class="keyword">if</span> (user == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// ç”¨æˆ·ä¸å­˜åœ¨</span></span><br><span class="line">                <span class="keyword">return</span> SignInResult.Failed;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// æ ¡éªŒå¯†ç </span></span><br><span class="line">            <span class="keyword">var</span> result= <span class="keyword">await</span> repository.CheckForSignInAsync(user, password,<span class="literal">true</span>);</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ ¡éªŒæ‰‹æœºå·å’Œå¯†ç æ˜¯å¦æ­£ç¡®ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;phoneNum&quot;&gt;</span>æ‰‹æœºå·<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;password&quot;&gt;</span>å¯†ç <span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>ç™»å½•ç»“æœ<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">async</span> Task&lt;SignInResult&gt; <span class="title">CheckPhoneNumAndPwdAsync</span>(<span class="params"><span class="built_in">string</span> phoneNum,<span class="built_in">string</span> password</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> user = <span class="keyword">await</span> repository.FindByPhoneNumberAsync(phoneNum);</span><br><span class="line">            <span class="keyword">if</span>(user == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// ç”¨æˆ·ä¸å­˜åœ¨</span></span><br><span class="line">                <span class="keyword">return</span> SignInResult.Failed;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// æ ¡éªŒå¯†ç </span></span><br><span class="line">            <span class="keyword">var</span> result=<span class="keyword">await</span> repository.CheckForSignInAsync(user, password,<span class="literal">true</span>);</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> é€šè¿‡æ‰‹æœºå·å’Œå¯†ç ç™»å½•ï¼ŒæˆåŠŸåˆ™è¿”å›JWTä»¤ç‰Œã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;phoneNum&quot;&gt;</span>æ‰‹æœºå·<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;password&quot;&gt;</span>å¯†ç <span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>ç™»å½•ç»“æœå’Œä»¤ç‰Œ<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">async</span> Task&lt;(SignInResult Result, <span class="built_in">string</span>? Token)&gt; LoginByPhoneAndPwdAsync(<span class="built_in">string</span> phoneNum, <span class="built_in">string</span> password)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> checkResult = <span class="keyword">await</span> CheckPhoneNumAndPwdAsync(phoneNum, password);</span><br><span class="line">            <span class="keyword">if</span> (checkResult.Succeeded)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// ç™»å½•æˆåŠŸï¼Œç”Ÿæˆä»¤ç‰Œ</span></span><br><span class="line">                <span class="keyword">var</span> user = <span class="keyword">await</span> repository.FindByPhoneNumberAsync(phoneNum);</span><br><span class="line">                <span class="built_in">string</span> token = <span class="keyword">await</span> BuildTokenAsync(user);</span><br><span class="line">                <span class="keyword">return</span> (SignInResult.Success,token);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// ç™»å½•å¤±è´¥</span></span><br><span class="line">                <span class="keyword">return</span> (checkResult, <span class="literal">null</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> é€šè¿‡ç”¨æˆ·åå’Œå¯†ç ç™»å½•ï¼ŒæˆåŠŸåˆ™è¿”å›JWTä»¤ç‰Œã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;userName&quot;&gt;</span>ç”¨æˆ·å<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;password&quot;&gt;</span>å¯†ç <span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>ç™»å½•ç»“æœå’Œä»¤ç‰Œ<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">async</span> Task&lt;(SignInResult Result,<span class="built_in">string</span>? Token)&gt;  LoginByUserNameAndPwdAsync(<span class="built_in">string</span> userName,<span class="built_in">string</span> password)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> checkResult=<span class="keyword">await</span> CheckUserNameAndPwdAsync(userName,password);</span><br><span class="line">            <span class="keyword">if</span> (checkResult.Succeeded)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// ç™»å½•æˆåŠŸï¼Œç”Ÿæˆä»¤ç‰Œ</span></span><br><span class="line">                <span class="keyword">var</span> user=<span class="keyword">await</span> repository.FindByNameAsync(userName);</span><br><span class="line">                <span class="built_in">string</span> token=<span class="keyword">await</span> BuildTokenAsync(user);</span><br><span class="line">                <span class="keyword">return</span> (SignInResult.Success, token);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// ç™»å½•å¤±è´¥</span></span><br><span class="line">                <span class="keyword">return</span> (checkResult, <span class="literal">null</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ„å»ºJWTä»¤ç‰Œï¼ŒåŒ…å«ç”¨æˆ·Idå’Œè§’è‰²ç­‰å£°æ˜ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;user&quot;&gt;</span>ç”¨æˆ·å®ä½“<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>JWTä»¤ç‰Œå­—ç¬¦ä¸²<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">async</span> Task&lt;<span class="built_in">string</span>&gt; <span class="title">BuildTokenAsync</span>(<span class="params">User user</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> roles=<span class="keyword">await</span> repository.GetRolesAsync(user);</span><br><span class="line">            List&lt;Claim&gt; claims = <span class="keyword">new</span> List&lt;Claim&gt;();</span><br><span class="line">            <span class="comment">// æ·»åŠ ç”¨æˆ·å”¯ä¸€æ ‡è¯†</span></span><br><span class="line">            claims.Add(<span class="keyword">new</span> Claim(ClaimTypes.NameIdentifier,user.Id.ToString()));</span><br><span class="line">            <span class="comment">// æ·»åŠ ç”¨æˆ·è§’è‰²</span></span><br><span class="line">            <span class="keyword">foreach</span>(<span class="built_in">string</span> role <span class="keyword">in</span> roles)</span><br><span class="line">            &#123;</span><br><span class="line">                claims.Add(<span class="keyword">new</span> Claim(ClaimTypes.Role, role));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// è°ƒç”¨ä»¤ç‰ŒæœåŠ¡ç”ŸæˆJWT</span></span><br><span class="line">            <span class="keyword">return</span> tokenService.BuildToken(claims, optJWT.Value);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>LoginByUserNameAndPwdAsyncæ–¹æ³•æ ¹æ®ç”¨æˆ·åã€å¯†ç è¿›è¡Œç™»å½•ã€‚è¿™ä¸ªæ–¹æ³•éœ€è¦è¿”å›æ˜¯å¦æ‰§è¡ŒæˆåŠŸå’Œç™»å½•æˆåŠŸåç”Ÿæˆçš„JWTä¸¤ä¸ªå€¼ã€‚</p><h1 id="å¼€å‘è®¤è¯æœåŠ¡çš„åŸºç¡€è®¾æ–½å±‚"><a href="#å¼€å‘è®¤è¯æœåŠ¡çš„åŸºç¡€è®¾æ–½å±‚" class="headerlink" title="å¼€å‘è®¤è¯æœåŠ¡çš„åŸºç¡€è®¾æ–½å±‚"></a>å¼€å‘è®¤è¯æœåŠ¡çš„åŸºç¡€è®¾æ–½å±‚</h1><p>è®¤è¯æœåŠ¡çš„åŸºç¡€è®¾æ–½å±‚é¡¹ç›®IdentityService.Infrastructureï¼Œæä¾›æ¨¡æ¿é€šè¿‡æ‰‹æœºå·è¿›è¡ŒçŸ­ä¿¡å‘é€ï¼Œæ–¹ä¾¿å¼€å‘ï¼Œæˆ‘ä»¬ç”¨æ—¥å¿—è¾“å‡ºæ¥æ¨¡æ‹ŸçŸ­ä¿¡å‘é€ã€‚<br>å¼€å‘ä¸€ä¸ªMockSmsSenderç±»ï¼Œå®ƒç”¨æ—¥å¿—è¾“å‡ºæ¥æ¨¡æ‹ŸçŸ­ä¿¡å‘é€ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">IdentityService.Infrastructure.Services</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æ¨¡æ‹Ÿé‚®ä»¶å‘é€æœåŠ¡ï¼Œå®ç° IEmailSender æ¥å£ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> è¯¥å®ç°ä»…ç”¨äºå¼€å‘æˆ–æµ‹è¯•ç¯å¢ƒï¼Œä¸å®é™…å‘é€é‚®ä»¶ï¼Œè€Œæ˜¯è®°å½•æ—¥å¿—ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MockEmailSender</span> : <span class="title">IEmailSender</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> ILogger&lt;MockEmailSender&gt; logger;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ„é€ å‡½æ•°ï¼Œæ³¨å…¥æ—¥å¿—è®°å½•å™¨ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;logger&quot;&gt;</span>æ—¥å¿—è®°å½•å™¨å®ä¾‹<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">MockEmailSender</span>(<span class="params">ILogger&lt;MockEmailSender&gt; logger</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.logger = logger;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ¨¡æ‹Ÿå‘é€é‚®ä»¶ï¼Œå°†é‚®ä»¶å†…å®¹å†™å…¥æ—¥å¿—ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;toEmail&quot;&gt;</span>æ”¶ä»¶äººé‚®ç®±<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;subject&quot;&gt;</span>é‚®ä»¶ä¸»é¢˜<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;body&quot;&gt;</span>é‚®ä»¶æ­£æ–‡<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>å·²å®Œæˆçš„ä»»åŠ¡<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Task <span class="title">SendAsync</span>(<span class="params"><span class="built_in">string</span> toEmail, <span class="built_in">string</span> subject, <span class="built_in">string</span> body</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            logger.LogInformation(<span class="string">&quot;Send Email to &#123;0&#125;,title:&#123;1&#125;,body:&#123;2&#125;&quot;</span>, toEmail, subject, body);</span><br><span class="line">            <span class="keyword">return</span> Task.CompletedTask;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">IdentityService.Infrastructure.Services</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æ¨¡æ‹ŸçŸ­ä¿¡å‘é€æœåŠ¡ï¼Œå®ç° <span class="doctag">&lt;see cref=&quot;ISmsSender&quot;/&gt;</span> æ¥å£ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ç”¨äºå¼€å‘æˆ–æµ‹è¯•ç¯å¢ƒï¼Œè®°å½•çŸ­ä¿¡å†…å®¹è€Œä¸å®é™…å‘é€ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MockSmsSender</span> : <span class="title">ISmsSender</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> ILogger&lt;MockSmsSender&gt; logger;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ„é€ å‡½æ•°ï¼Œæ³¨å…¥æ—¥å¿—è®°å½•å™¨ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;logger&quot;&gt;</span>æ—¥å¿—è®°å½•å™¨ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">MockSmsSender</span>(<span class="params">ILogger&lt;MockSmsSender&gt; logger</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.logger = logger;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ¨¡æ‹Ÿå¼‚æ­¥å‘é€çŸ­ä¿¡ï¼Œå°†çŸ­ä¿¡å†…å®¹å†™å…¥æ—¥å¿—ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;phoneNum&quot;&gt;</span>æ¥æ”¶çŸ­ä¿¡çš„æ‰‹æœºå·ç ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;args&quot;&gt;</span>çŸ­ä¿¡å†…å®¹å‚æ•°ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>è¡¨ç¤ºå¼‚æ­¥æ“ä½œçš„å·²å®Œæˆä»»åŠ¡ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Task <span class="title">SendAsync</span>(<span class="params"><span class="built_in">string</span> phoneNum, <span class="keyword">params</span> <span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            logger.LogInformation(<span class="string">&quot;Send SMS to &#123;0&#125;,args:&#123;1&#125;&quot;</span>, phoneNum, <span class="built_in">string</span>.Join(<span class="string">&quot;,&quot;</span>, args));</span><br><span class="line">            <span class="keyword">return</span> Task.CompletedTask;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨IdDbContextç±»ä¸­çš„EnableSoftDeletionGlobalFilter()æ‰©å±•æ–¹æ³•ï¼Œè¿›è¡Œå…¨å±€è½¯åˆ é™¤è¿‡æ»¤ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">IdentityService.Infrastructure</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> è¡¨ç¤ºåº”ç”¨ç¨‹åºçš„ Identity æ•°æ®åº“ä¸Šä¸‹æ–‡ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ç»§æ‰¿è‡ª <span class="doctag">&lt;see cref=&quot;IdentityDbContext&#123;TUser,TRole,TKey&#125;&quot;/&gt;</span>, å¹¶å°†ç”¨æˆ·ç±»å‹è®¾ä¸º <span class="doctag">&lt;see cref=&quot;User&quot;/&gt;</span>,</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> è§’è‰²ç±»å‹è®¾ä¸º <span class="doctag">&lt;see cref=&quot;Role&quot;/&gt;</span>, ä¸»é”®ç±»å‹ä¸º <span class="doctag">&lt;see cref=&quot;Guid&quot;/&gt;</span>ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">IdDbContext</span> : <span class="title">IdentityDbContext</span>&lt;<span class="title">User</span>, <span class="title">Role</span>, <span class="title">Guid</span>&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ä½¿ç”¨æŒ‡å®šçš„ DbContextOptions æ„é€ ä¸€ä¸ªæ–°çš„ <span class="doctag">&lt;see cref=&quot;IdDbContext&quot;/&gt;</span> å®ä¾‹ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;options&quot;&gt;</span>ç”¨äºé…ç½®ä¸Šä¸‹æ–‡è¡Œä¸ºï¼ˆè¿æ¥å­—ç¬¦ä¸²ã€æä¾›ç¨‹åºã€æ—¥å¿—ç­‰ï¼‰çš„é€‰é¡¹ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">IdDbContext</span>(<span class="params">DbContextOptions&lt;IdDbContext&gt; options</span>) : <span class="title">base</span>(<span class="params">options</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> åœ¨ EF Core æ„å»ºæ¨¡å‹æ—¶è°ƒç”¨ï¼Œå…è®¸é…ç½®å®ä½“æ˜ å°„ã€çº¦æŸå’Œç´¢å¼•ç­‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> é‡å†™æœ¬æ–¹æ³•ä»¥åœ¨æ¨¡å‹åˆ›å»ºæœŸé—´æ‰§è¡Œè‡ªå®šä¹‰é…ç½®ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;modelBuilder&quot;&gt;</span>ç”¨äºæ„å»º EF Core æ¨¡å‹çš„ <span class="doctag">&lt;see cref=&quot;ModelBuilder&quot;/&gt;</span> å®ä¾‹ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ‰§è¡Œæ­¥éª¤ï¼š</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 1. è°ƒç”¨ <span class="doctag">&lt;c&gt;</span>base.OnModelCreating(modelBuilder)<span class="doctag">&lt;/c&gt;</span> ä»¥ç¡®ä¿ ASP.NET Core Identity çš„é»˜è®¤æ˜ å°„è¢«åº”ç”¨ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 2. è°ƒç”¨ <span class="doctag">&lt;c&gt;</span>modelBuilder.ApplyConfigurationsFromAssembly(this.GetType().Assembly)<span class="doctag">&lt;/c&gt;</span>ï¼Œ</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>    ä»å½“å‰ç¨‹åºé›†æ‰«æå¹¶åº”ç”¨æ‰€æœ‰å®ç°äº† IEntityTypeConfiguration çš„ç±»å‹ï¼Œ</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>    ä½¿å®ä½“çš„ Fluent API é…ç½®é›†ä¸­ã€å¯ç»´æŠ¤ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> 3. è°ƒç”¨æ‰©å±•æ–¹æ³• <span class="doctag">&lt;c&gt;</span>EnableSoftDeletionGlobalFilter()<span class="doctag">&lt;/c&gt;</span>ï¼Œ</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>    ä¸ºå®ç°è½¯åˆ é™¤æ¥å£ï¼ˆä¾‹å¦‚ <span class="doctag">&lt;c&gt;</span>ISoftDelete<span class="doctag">&lt;/c&gt;</span>ï¼‰çš„å®ä½“æ·»åŠ å…¨å±€æŸ¥è¯¢è¿‡æ»¤å™¨ï¼Œ</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>    ä»¥ä¾¿åœ¨é»˜è®¤æŸ¥è¯¢ä¸­æ’é™¤è¢«æ ‡è®°ä¸ºå·²åˆ é™¤çš„è®°å½•ï¼ˆè½¯åˆ é™¤ï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnModelCreating</span>(<span class="params">ModelBuilder modelBuilder</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// ä¿è¯ Identity çš„é»˜è®¤é…ç½®å…ˆè¢«åº”ç”¨</span></span><br><span class="line">            <span class="keyword">base</span>.OnModelCreating(modelBuilder);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ‰«æå¹¶åº”ç”¨å½“å‰ç¨‹åºé›†ä¸­çš„æ‰€æœ‰å®ä½“é…ç½®ï¼ˆIEntityTypeConfiguration å®ç°ï¼‰</span></span><br><span class="line">            modelBuilder.ApplyConfigurationsFromAssembly(<span class="keyword">this</span>.GetType().Assembly);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å¯ç”¨è½¯åˆ é™¤å…¨å±€è¿‡æ»¤å™¨ï¼šå¯¹å®ç° ISoftDelete çš„å®ä½“è‡ªåŠ¨æ·»åŠ  IsDeleted == false çš„è¿‡æ»¤é€»è¾‘</span></span><br><span class="line">            modelBuilder.EnableSoftDeletionGlobalFilter();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">YU.Infrastructure.EFCore</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> EF Core ç›¸å…³æ‰©å±•æ–¹æ³•é›†åˆã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">EFCoreExtensions</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ä¸ºå®ç° <span class="doctag">&lt;see cref=&quot;ISoftDelete&quot;/&gt;</span> çš„å®ä½“å¯ç”¨å…¨å±€è½¯åˆ é™¤è¿‡æ»¤å™¨ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ä¼šä¸ºæ¯ä¸ªå®ç° <span class="doctag">&lt;see cref=&quot;ISoftDelete&quot;/&gt;</span> çš„å®ä½“è‡ªåŠ¨æ·»åŠ ä¸€ä¸ªæŸ¥è¯¢è¿‡æ»¤å™¨ï¼Œè¿‡æ»¤æ¡ä»¶ä¸º <span class="doctag">&lt;c&gt;</span>IsDeleted == false<span class="doctag">&lt;/c&gt;</span>ï¼Œ</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ä»è€Œåœ¨é»˜è®¤æŸ¥è¯¢ä¸­æ’é™¤å·²è½¯åˆ é™¤çš„è®°å½•ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;modelBuilder&quot;&gt;</span>è¦é…ç½®çš„ <span class="doctag">&lt;see cref=&quot;ModelBuilder&quot;/&gt;</span> å®ä¾‹ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> - è¯¥æ–¹æ³•åœ¨åº”ç”¨å¯åŠ¨æ—¶ï¼ˆé€šå¸¸åœ¨ DbContext çš„ OnModelCreating ä¸­ï¼‰è°ƒç”¨ä¸€æ¬¡å³å¯ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> - å¯¹äºæœªæ‰¾åˆ°åä¸º &quot;IsDeleted&quot; çš„å±æ€§æˆ–å…¶ PropertyInfo ä¸º null çš„å®ä½“ç±»å‹ï¼Œæ–¹æ³•ä¼šè·³è¿‡è¯¥å®ä½“ä»¥ä¿è¯å¥å£®æ€§ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/remarks&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">EnableSoftDeletionGlobalFilter</span>(<span class="params"><span class="keyword">this</span> ModelBuilder modelBuilder</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// è·å–æ‰€æœ‰å®ä½“ç±»å‹ï¼Œç­›é€‰å‡ºå®ç° ISoftDelete çš„ç±»å‹</span></span><br><span class="line">            <span class="keyword">var</span> entityTypesHasSoftDeletion = modelBuilder.Model.GetEntityTypes()</span><br><span class="line">                .Where(e =&gt; e.ClrType.IsAssignableTo(<span class="keyword">typeof</span>(ISoftDelete)));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> entityType <span class="keyword">in</span> entityTypesHasSoftDeletion)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// å°è¯•æŸ¥æ‰¾åä¸º IsDeleted çš„å±æ€§å…ƒæ•°æ®</span></span><br><span class="line">                <span class="keyword">var</span> isDeletedProperty = entityType.FindProperty(<span class="keyword">nameof</span>(ISoftDelete.IsDeleted));</span><br><span class="line"></span><br><span class="line">                <span class="comment">// é˜²å¾¡æ€§æ£€æŸ¥ï¼šç¡®ä¿æ‰¾åˆ°äº†å±æ€§å¹¶ä¸”æœ‰å¯ç”¨çš„ PropertyInfo</span></span><br><span class="line">                <span class="keyword">if</span> (isDeletedProperty?.PropertyInfo == <span class="literal">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">// å¦‚æœæ²¡æœ‰æ‰¾åˆ°å±æ€§ä¿¡æ¯ï¼Œè·³è¿‡è¯¥å®ä½“ç±»å‹</span></span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// åˆ›å»ºä¸€ä¸ªå‚æ•°è¡¨è¾¾å¼ï¼Œä»£è¡¨æŸ¥è¯¢ä¸­çš„å®ä½“å®ä¾‹ï¼š (TEntity p) =&gt; ...</span></span><br><span class="line">                <span class="keyword">var</span> parameter = Expression.Parameter(entityType.ClrType, <span class="string">&quot;p&quot;</span>);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// ç”Ÿæˆå¯¹å±æ€§çš„è®¿é—®è¡¨è¾¾å¼ï¼š p.IsDeleted</span></span><br><span class="line">                <span class="keyword">var</span> propertyAccess = Expression.Property(parameter, isDeletedProperty.PropertyInfo);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// ç”Ÿæˆè¿‡æ»¤æ¡ä»¶ï¼š !p.IsDeleted ï¼ˆå³ IsDeleted == falseï¼‰</span></span><br><span class="line">                <span class="keyword">var</span> notDeletedExpression = Expression.Not(propertyAccess);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// å°†æ¡ä»¶å°è£…ä¸º LambdaExpressionï¼š p =&gt; !p.IsDeleted</span></span><br><span class="line">                <span class="keyword">var</span> filter = Expression.Lambda(notDeletedExpression, parameter);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// å°† LambdaExpression è®¾ç½®ä¸ºè¯¥å®ä½“çš„å…¨å±€æŸ¥è¯¢è¿‡æ»¤å™¨</span></span><br><span class="line">                entityType.SetQueryFilter(filter);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> è·å–æŒ‡å®šå®ä½“ç±»å‹çš„æŸ¥è¯¢é›†ï¼Œä½¿ç”¨ <span class="doctag">&lt;see cref=&quot;AsNoTracking&quot;/&gt;</span> ä»¥ç¦ç”¨ EF Core çš„è·Ÿè¸ªï¼ˆåªè¯»åœºæ™¯æ¨èï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;typeparam name=&quot;T&quot;&gt;</span>å®ä½“ç±»å‹ï¼Œå¿…é¡»ä¸ºç±»å¹¶å®ç° <span class="doctag">&lt;see cref=&quot;IEntity&quot;/&gt;</span>ã€‚<span class="doctag">&lt;/typeparam&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;ctx&quot;&gt;</span>å½“å‰çš„ <span class="doctag">&lt;see cref=&quot;DbContext&quot;/&gt;</span> å®ä¾‹ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>è¿”å›ä¸€ä¸ªæ— è·Ÿè¸ªçš„ <span class="doctag">&lt;see cref=&quot;IQueryable&#123;T&#125;&quot;/&gt;</span> ç”¨äºæŸ¥è¯¢ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="title">IQueryable</span>&lt;<span class="title">T</span>&gt; <span class="title">Query</span>&lt;<span class="title">T</span>&gt;(<span class="params"><span class="keyword">this</span> DbContext ctx</span>) <span class="keyword">where</span> T : <span class="keyword">class</span>, IEntity</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// è¿”å› DbSet å¹¶ç¦ç”¨æ›´æ”¹è·Ÿè¸ªï¼Œé€‚åˆåªè¯»æŸ¥è¯¢ä»¥å‡å°‘æ€§èƒ½å¼€é”€</span></span><br><span class="line">            <span class="keyword">return</span> ctx.Set&lt;T&gt;().AsNoTracking();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>IdReppsitoryæ˜¯å®ç°ä»“å‚¨æ¥å£çš„ç±»ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">IdentityService.Infrastructure</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> `IdRepository` å®ç° `IIdRepository`ï¼Œå°è£… `IdUserManager` ä¸ `RoleManager<span class="doctag">&lt;Role&gt;</span>` çš„å¸¸ç”¨æ“ä½œã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ç±»ä¸­çš„æ–¹æ³•ä»¥æ¸…æ™°çš„å¼‚å¸¸å’Œè¿”å›å€¼å¤„ç†ä¸ºç›®æ ‡ï¼Œä¾¿äºè°ƒç”¨è€…ç†è§£ä¸ä½¿ç”¨ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">IdRepository</span> : <span class="title">IIdRepository</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> IdUserManager userManager;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> RoleManager&lt;Role&gt; roleManager;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> ILogger&lt;IdRepository&gt; logger;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> é€šè¿‡ä¾èµ–æ³¨å…¥æ„é€ ä»“å‚¨å®ä¾‹ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">IdRepository</span>(<span class="params">IdUserManager userManager, RoleManager&lt;Role&gt; roleManager, ILogger&lt;IdRepository&gt; logger</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.userManager = userManager ?? <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="keyword">nameof</span>(userManager));</span><br><span class="line">            <span class="keyword">this</span>.roleManager = roleManager ?? <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="keyword">nameof</span>(roleManager));</span><br><span class="line">            <span class="keyword">this</span>.logger = logger ?? <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="keyword">nameof</span>(logger));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å°†ä¸€æ¬¡ç™»å½•å¤±è´¥è®¡å…¥ç”¨æˆ·å¤±è´¥æ¬¡æ•°ï¼ˆå¯èƒ½è§¦å‘é”å®šï¼‰ï¼Œå§”æ‰˜åˆ° `IdUserManager`ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Task&lt;IdentityResult&gt; <span class="title">AccessFailedAsync</span>(<span class="params">User user</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (user == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="keyword">nameof</span>(user));</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.userManager.AccessFailedAsync(user);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å¿«é€Ÿæ„å»ºä¸€ä¸ªåŒ…å«å•æ¡é”™è¯¯æè¿°çš„å¤±è´¥ `IdentityResult`ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ç”¨äºè¿”å›è‡ªå®šä¹‰é”™è¯¯åœºæ™¯ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> IdentityResult <span class="title">ErrorResult</span>(<span class="params"><span class="built_in">string</span> msg</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            IdentityError idError = <span class="keyword">new</span> IdentityError &#123; Description = msg ?? <span class="built_in">string</span>.Empty &#125;;</span><br><span class="line">            <span class="keyword">return</span> IdentityResult.Failed(idError);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ ¹æ®å½“å‰ Identity å¯†ç ç­–ç•¥ç”Ÿæˆä¸€ä¸ªéšæœºå¯†ç ï¼Œå°½é‡æ»¡è¶³ç­–ç•¥ä¸­çš„å„ç§è¦æ±‚ï¼ˆæ•°å­—/å¤§å°å†™/ç‰¹æ®Šå­—ç¬¦ï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> è¯´æ˜ï¼šä½¿ç”¨ `RandomNumberGenerator` æ¥è·å¾—æ›´å¥½çš„éšæœºæ€§ï¼ˆæ¯” `Random` æ›´å®‰å…¨ï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="built_in">string</span> <span class="title">GeneratePassword</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> options = userManager.Options.Password;</span><br><span class="line">            <span class="built_in">int</span> requiredLength = Math.Max(<span class="number">1</span>, options.RequiredLength);</span><br><span class="line">            <span class="built_in">bool</span> requireNonAlphanumeric = options.RequireNonAlphanumeric;</span><br><span class="line">            <span class="built_in">bool</span> requireDigit = options.RequireDigit;</span><br><span class="line">            <span class="built_in">bool</span> requireLower = options.RequireLowercase;</span><br><span class="line">            <span class="built_in">bool</span> requireUpper = options.RequireUppercase;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å¸¸ç”¨å­—ç¬¦é›†</span></span><br><span class="line">            <span class="keyword">const</span> <span class="built_in">string</span> digits = <span class="string">&quot;0123456789&quot;</span>;</span><br><span class="line">            <span class="keyword">const</span> <span class="built_in">string</span> lowers = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span>;</span><br><span class="line">            <span class="keyword">const</span> <span class="built_in">string</span> uppers = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span>;</span><br><span class="line">            <span class="keyword">const</span> <span class="built_in">string</span> specials = <span class="string">&quot;!@#$%^&amp;*()-_=+[]&#123;&#125;;:,.&lt;&gt;/?&quot;</span>;</span><br><span class="line"></span><br><span class="line">            StringBuilder sb = <span class="keyword">new</span> StringBuilder(requiredLength + <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// è¾…åŠ©å‡½æ•°ï¼šä»ç»™å®šå­—ç¬¦é›†ä¸­éšæœºå–ä¸€ä¸ªå­—ç¬¦</span></span><br><span class="line">            <span class="function"><span class="keyword">static</span> <span class="built_in">char</span> <span class="title">GetRandomChar</span>(<span class="params"><span class="built_in">string</span> charset</span>)</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">var</span> buffer = <span class="keyword">new</span> <span class="built_in">byte</span>[<span class="number">4</span>];</span><br><span class="line">                RandomNumberGenerator.Fill(buffer);</span><br><span class="line">                <span class="built_in">uint</span> idx = BitConverter.ToUInt32(buffer, <span class="number">0</span>);</span><br><span class="line">                <span class="keyword">return</span> charset[(<span class="built_in">int</span>)(idx % (<span class="built_in">uint</span>)charset.Length)];</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å…ˆå¡«å……åˆ°æœ€ä½é•¿åº¦ï¼Œå­—ç¬¦æ¥æºæ··åˆè€ƒè™‘</span></span><br><span class="line">            <span class="built_in">string</span> allChars = digits + lowers + uppers + (specials);</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; requiredLength; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                sb.Append(GetRandomChar(allChars));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ£€æŸ¥æ˜¯å¦æ»¡è¶³å„ç±»éœ€æ±‚ï¼Œå¦‚æœæ²¡æœ‰åˆ™è¿½åŠ ç›¸åº”å­—ç¬¦</span></span><br><span class="line">            <span class="keyword">if</span> (requireDigit &amp;&amp; !sb.ToString().Any(<span class="built_in">char</span>.IsDigit))</span><br><span class="line">                sb.Append(GetRandomChar(digits));</span><br><span class="line">            <span class="keyword">if</span> (requireLower &amp;&amp; !sb.ToString().Any(<span class="built_in">char</span>.IsLower))</span><br><span class="line">                sb.Append(GetRandomChar(lowers));</span><br><span class="line">            <span class="keyword">if</span> (requireUpper &amp;&amp; !sb.ToString().Any(<span class="built_in">char</span>.IsUpper))</span><br><span class="line">                sb.Append(GetRandomChar(uppers));</span><br><span class="line">            <span class="keyword">if</span> (requireNonAlphanumeric &amp;&amp; !sb.ToString().Any(ch =&gt; !<span class="built_in">char</span>.IsLetterOrDigit(ch)))</span><br><span class="line">                sb.Append(GetRandomChar(specials));</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æœ€ç»ˆç»“æœ</span></span><br><span class="line">            <span class="keyword">return</span> sb.ToString();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å°†ç”¨æˆ·åŠ å…¥æŒ‡å®šè§’è‰²ï¼›è‹¥è§’è‰²ä¸å­˜åœ¨åˆ™å…ˆåˆ›å»ºè§’è‰²ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æˆåŠŸè¿”å› Successï¼Œå¦åˆ™è¿”å›å¤±è´¥çš„ IdentityResultï¼ˆåŒ…å«é”™è¯¯ä¿¡æ¯ï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;IdentityResult&gt; <span class="title">AddToRoleAsync</span>(<span class="params">User user, <span class="built_in">string</span> roleName</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (user == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="keyword">nameof</span>(user));</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrWhiteSpace(roleName)) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;roleName ä¸èƒ½ä¸ºç©º&quot;</span>, <span class="keyword">nameof</span>(roleName));</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å¦‚æœè§’è‰²ä¸å­˜åœ¨åˆ™å°è¯•åˆ›å»º</span></span><br><span class="line">            <span class="keyword">if</span> (!<span class="keyword">await</span> roleManager.RoleExistsAsync(roleName))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">var</span> role = <span class="keyword">new</span> Role &#123; Name = roleName &#125;;</span><br><span class="line">                <span class="keyword">var</span> createResult = <span class="keyword">await</span> roleManager.CreateAsync(role);</span><br><span class="line">                <span class="keyword">if</span> (!createResult.Succeeded)</span><br><span class="line">                &#123;</span><br><span class="line">                    logger.LogWarning(<span class="string">&quot;åˆ›å»ºè§’è‰² &#123;Role&#125; å¤±è´¥ï¼š&#123;Errors&#125;&quot;</span>, roleName, <span class="built_in">string</span>.Join(<span class="string">&quot;, &quot;</span>, createResult.Errors.Select(e =&gt; e.Description)));</span><br><span class="line">                    <span class="keyword">return</span> createResult;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å°†ç”¨æˆ·æ·»åŠ åˆ°è§’è‰²</span></span><br><span class="line">            <span class="keyword">var</span> addResult = <span class="keyword">await</span> userManager.AddToRoleAsync(user, roleName);</span><br><span class="line">            <span class="keyword">if</span> (!addResult.Succeeded)</span><br><span class="line">            &#123;</span><br><span class="line">                logger.LogWarning(<span class="string">&quot;å°†ç”¨æˆ· &#123;UserId&#125; åŠ å…¥è§’è‰² &#123;Role&#125; å¤±è´¥ï¼š&#123;Errors&#125;&quot;</span>, user?.Id, roleName, <span class="built_in">string</span>.Join(<span class="string">&quot;, &quot;</span>, addResult.Errors.Select(e =&gt; e.Description)));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> addResult;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ·»åŠ ä¸€ä¸ªç®¡ç†å‘˜è´¦å·ï¼ˆå¿«é€Ÿåˆå§‹åŒ–ç”¨ï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> - è‹¥ç”¨æˆ·åæˆ–æ‰‹æœºå·å·²å­˜åœ¨åˆ™ç›´æ¥è¿”å›é”™è¯¯ç»“æœã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> - åˆ›å»ºç”¨æˆ·å¹¶ç”Ÿæˆåˆå§‹å¯†ç ï¼Œç„¶åæŠŠç”¨æˆ·æ”¾å…¥ &quot;Admin&quot; è§’è‰²ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> è¿”å›ä¸‰å…ƒç»„ï¼š(æ“ä½œç»“æœ, åˆ›å»ºçš„ User å¯¹è±¡ æˆ– null, åˆå§‹å¯†ç  æˆ– null)ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">async</span> Task&lt;(IdentityResult, User?, <span class="built_in">string</span>? password)&gt; AddAdminUserAsync(<span class="built_in">string</span> userName, <span class="built_in">string</span> phoneNum)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrWhiteSpace(userName)) <span class="keyword">return</span> (ErrorResult(<span class="string">&quot;ç”¨æˆ·åä¸èƒ½ä¸ºç©º&quot;</span>), <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrWhiteSpace(phoneNum)) <span class="keyword">return</span> (ErrorResult(<span class="string">&quot;æ‰‹æœºå·ä¸èƒ½ä¸ºç©º&quot;</span>), <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">await</span> FindByNameAsync(userName) != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> (ErrorResult(<span class="string">$&quot;å·²ç»å­˜åœ¨ç”¨æˆ·å <span class="subst">&#123;userName&#125;</span>&quot;</span>), <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">await</span> FindByPhoneNumberAsync(phoneNum) != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> (ErrorResult(<span class="string">$&quot;å·²ç»å­˜åœ¨æ‰‹æœºå· <span class="subst">&#123;phoneNum&#125;</span>&quot;</span>), <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            User user = <span class="keyword">new</span> User(userName)</span><br><span class="line">            &#123;</span><br><span class="line">                PhoneNumber = phoneNum,</span><br><span class="line">                PhoneNumberConfirmed = <span class="literal">true</span></span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="built_in">string</span> password = GeneratePassword();</span><br><span class="line">            <span class="keyword">var</span> createResult = <span class="keyword">await</span> CreateAsync(user, password);</span><br><span class="line">            <span class="keyword">if</span> (!createResult.Succeeded)</span><br><span class="line">            &#123;</span><br><span class="line">                logger.LogWarning(<span class="string">&quot;åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·å¤±è´¥ï¼š&#123;Errors&#125;&quot;</span>, <span class="built_in">string</span>.Join(<span class="string">&quot;, &quot;</span>, createResult.Errors.Select(e =&gt; e.Description)));</span><br><span class="line">                <span class="keyword">return</span> (createResult, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> roleResult = <span class="keyword">await</span> AddToRoleAsync(user, <span class="string">&quot;Admin&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (!roleResult.Succeeded)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// å¦‚æœåŠ å…¥è§’è‰²å¤±è´¥ï¼Œè¿”å›å¤±è´¥å¹¶å°†ç”¨æˆ·ä½œä¸º nullï¼ˆä»¥ä¾¿è°ƒç”¨è€…æ„ŸçŸ¥æœªå®Œå…¨åˆå§‹åŒ–ï¼‰</span></span><br><span class="line">                logger.LogWarning(<span class="string">&quot;å°†ç®¡ç†å‘˜ç”¨æˆ·åŠ å…¥ Admin è§’è‰²å¤±è´¥ï¼š&#123;Errors&#125;&quot;</span>, <span class="built_in">string</span>.Join(<span class="string">&quot;, &quot;</span>, roleResult.Errors.Select(e =&gt; e.Description)));</span><br><span class="line">                <span class="keyword">return</span> (roleResult, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> (IdentityResult.Success, user, password);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ä½¿ç”¨éªŒè¯ç ä»¤ç‰Œæ›´æ¢ç”¨æˆ·æ‰‹æœºå·å¹¶ç¡®è®¤æ‰‹æœºå·ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> - æ‰¾ä¸åˆ°ç”¨æˆ·æŠ›å‡º ArgumentExceptionï¼ˆè°ƒç”¨æ–¹åº”è¯¥ä¿è¯ä¼ å…¥åˆæ³• idï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> - è‹¥æ›´æ¢å¤±è´¥ï¼Œè®°å½•ä¸€æ¬¡ç™»å½•å¤±è´¥å¹¶è¿”å› SignInResult.Failedã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> - å¦‚æœæˆåŠŸï¼Œåˆ™è®¾ç½® PhoneNumberConfirmed å¹¶è¿”å› SignInResult.Successã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;SignInResult&gt; <span class="title">ChangePhoneNumAsync</span>(<span class="params">Guid userId, <span class="built_in">string</span> phoneNum, <span class="built_in">string</span> token</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> user = <span class="keyword">await</span> userManager.FindByIdAsync(userId.ToString());</span><br><span class="line">            <span class="keyword">if</span> (user == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">$&quot;ç”¨æˆ· <span class="subst">&#123;userId&#125;</span> ä¸å­˜åœ¨&quot;</span>, <span class="keyword">nameof</span>(userId));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> changeResult = <span class="keyword">await</span> userManager.ChangePhoneNumberAsync(user, phoneNum, token);</span><br><span class="line">            <span class="keyword">if</span> (!changeResult.Succeeded)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// å¢åŠ ä¸€æ¬¡å¤±è´¥è®¡æ•°ï¼Œè®°å½•æ—¥å¿—å¹¶è¿”å›å¤±è´¥</span></span><br><span class="line">                <span class="keyword">await</span> <span class="keyword">this</span>.userManager.AccessFailedAsync(user);</span><br><span class="line">                <span class="built_in">string</span> errMsg = changeResult.Errors.Any() ? <span class="built_in">string</span>.Join(<span class="string">&quot;; &quot;</span>, changeResult.Errors.Select(e =&gt; e.Description)) : <span class="string">&quot;æœªçŸ¥é”™è¯¯&quot;</span>;</span><br><span class="line">                <span class="keyword">this</span>.logger.LogWarning(<span class="string">&quot;ç”¨æˆ· &#123;UserId&#125; æ›´æ¢æ‰‹æœºå·åˆ° &#123;PhoneNum&#125; å¤±è´¥ï¼š&#123;Error&#125;&quot;</span>, userId, phoneNum, errMsg);</span><br><span class="line">                <span class="keyword">return</span> SignInResult.Failed;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æˆåŠŸåˆ™ç¡®è®¤æ‰‹æœºå·ï¼ˆæ ‡è®° PhoneNumberConfirmed å¹¶ä¿å­˜ï¼‰</span></span><br><span class="line">            <span class="keyword">await</span> ConfirmPhoneNumberAsync(userId);</span><br><span class="line">            <span class="keyword">return</span> SignInResult.Success;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ç›´æ¥ä¸ºç”¨æˆ·è®¾ç½®æ–°å¯†ç ï¼ˆé€šè¿‡ç”Ÿæˆé‡ç½®ä»¤ç‰Œå¹¶è°ƒç”¨ ResetPasswordAsyncï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> - ç®€å•æ£€æŸ¥å¯†ç é•¿åº¦ï¼ˆå°äº 6 è§†ä¸ºæ— æ•ˆå¹¶è¿”å›é”™è¯¯ç»“æœï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> - è‹¥ç”¨æˆ·ä¸å­˜åœ¨æˆ–é‡ç½®å¤±è´¥ï¼Œè¿”å›å¯¹åº”çš„ IdentityResultã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;IdentityResult&gt; <span class="title">ChangePasswordAsync</span>(<span class="params">Guid userId, <span class="built_in">string</span> password</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (password == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="keyword">nameof</span>(password));</span><br><span class="line">            <span class="keyword">if</span> (password.Length &lt; <span class="number">6</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">var</span> err = <span class="keyword">new</span> IdentityError &#123; Code = <span class="string">&quot;PasswordInvalid&quot;</span>, Description = <span class="string">&quot;å¯†ç é•¿åº¦ä¸èƒ½å°‘äº6ä½&quot;</span> &#125;;</span><br><span class="line">                <span class="keyword">return</span> IdentityResult.Failed(err);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> user = <span class="keyword">await</span> userManager.FindByIdAsync(userId.ToString());</span><br><span class="line">            <span class="keyword">if</span> (user == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> ErrorResult(<span class="string">$&quot;ç”¨æˆ· <span class="subst">&#123;userId&#125;</span> ä¸å­˜åœ¨&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> token = <span class="keyword">await</span> userManager.GeneratePasswordResetTokenAsync(user);</span><br><span class="line">            <span class="keyword">var</span> resetResult = <span class="keyword">await</span> userManager.ResetPasswordAsync(user, token, password);</span><br><span class="line">            <span class="keyword">if</span> (!resetResult.Succeeded)</span><br><span class="line">            &#123;</span><br><span class="line">                logger.LogWarning(<span class="string">&quot;ä¸ºç”¨æˆ· &#123;UserId&#125; æ›´æ”¹å¯†ç å¤±è´¥ï¼š&#123;Errors&#125;&quot;</span>, userId, <span class="built_in">string</span>.Join(<span class="string">&quot;, &quot;</span>, resetResult.Errors.Select(e =&gt; e.Description)));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> resetResult;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ£€æŸ¥ç»™å®šç”¨æˆ·å’Œå¯†ç æ˜¯å¦èƒ½å¤Ÿç™»å½•ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> - è‹¥ç”¨æˆ·è¢«é”å®šï¼Œè¿”å› LockedOutã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> - å¯†ç æ ¡éªŒé€šè¿‡è¿”å› Successã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> - å¦åˆ™è§† lockoutOnFailure å†³å®šæ˜¯å¦å°†å¤±è´¥è®¡å…¥é”å®šç­–ç•¥ï¼ˆå¹¶åœ¨ AccessFailed å¤±è´¥æ—¶æŠ›å‡ºå¼‚å¸¸ï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;SignInResult&gt; <span class="title">CheckForSignInAsync</span>(<span class="params">User user, <span class="built_in">string</span> password, <span class="built_in">bool</span> lockoutOnFailure</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (user == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="keyword">nameof</span>(user));</span><br><span class="line">            <span class="keyword">if</span> (password == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="keyword">nameof</span>(password));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">await</span> userManager.IsLockedOutAsync(user))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> SignInResult.LockedOut;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="built_in">bool</span> passwordOk = <span class="keyword">await</span> userManager.CheckPasswordAsync(user, password);</span><br><span class="line">            <span class="keyword">if</span> (passwordOk)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> SignInResult.Success;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (lockoutOnFailure)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">var</span> r = <span class="keyword">await</span> AccessFailedAsync(user);</span><br><span class="line">                <span class="keyword">if</span> (!r.Succeeded)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">// AccessFailedAsync å¤±è´¥é€šå¸¸æ˜¯å­˜å‚¨å±‚é—®é¢˜ï¼Œæˆ‘ä»¬æŠŠå®ƒæš´éœ²ä¸ºå¼‚å¸¸ä»¥ä¾¿ä¸Šå±‚æ•è·ä¸è°ƒæŸ¥</span></span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> ApplicationException(<span class="string">&quot;è°ƒç”¨ AccessFailedAsync å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç”¨æˆ·å­˜å‚¨æˆ–æ•°æ®åº“è¿æ¥ã€‚&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> SignInResult.Failed;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å°†æŒ‡å®šç”¨æˆ·çš„æ‰‹æœºå·æ ‡è®°ä¸ºå·²ç¡®è®¤ï¼ˆPhoneNumberConfirmed = trueï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> è‹¥æ‰¾ä¸åˆ°ç”¨æˆ·æŠ›å‡º ApplicationExceptionï¼ˆè¿™æ˜¯åŸå®ç°çš„è¡Œä¸ºï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">ConfirmPhoneNumberAsync</span>(<span class="params">Guid id</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> user = <span class="keyword">await</span> userManager.Users.FirstOrDefaultAsync(u =&gt; u.Id == id);</span><br><span class="line">            <span class="keyword">if</span> (user == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ApplicationException(<span class="string">$&quot;ç”¨æˆ· <span class="subst">&#123;id&#125;</span> ä¸å­˜åœ¨&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            user.PhoneNumberConfirmed = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">await</span> userManager.UpdateAsync(user);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> åˆ›å»ºç”¨æˆ·å¹¶è®¾ç½®å¯†ç ï¼ˆç›´æ¥å§”æ‰˜ç»™ `userManager.CreateAsync`ï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Task&lt;IdentityResult&gt; <span class="title">CreateAsync</span>(<span class="params">User user, <span class="built_in">string</span> password</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (user == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="keyword">nameof</span>(user));</span><br><span class="line">            <span class="keyword">if</span> (password == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="keyword">nameof</span>(password));</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.userManager.CreateAsync(user, password);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ ¹æ®ç”¨æˆ· Id æŸ¥æ‰¾ç”¨æˆ·ï¼ˆè¿”å›å¯èƒ½ä¸º nullï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> Task&lt;User?&gt; FindByIdAsync(Guid userId)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> userManager.FindByIdAsync(userId.ToString());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ ¹æ®ç”¨æˆ·åæŸ¥æ‰¾ç”¨æˆ·ï¼ˆè¿”å›å¯èƒ½ä¸º nullï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> Task&lt;User?&gt; FindByNameAsync(<span class="built_in">string</span> userName)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> userManager.FindByNameAsync(userName);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ ¹æ®æ‰‹æœºå·æŸ¥æ‰¾ç”¨æˆ·ï¼ˆè¿”å›å¯èƒ½ä¸º nullï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ä½¿ç”¨ `userManager.Users` ä»¥ä¾¿åœ¨åº•å±‚æ•°æ®åº“ä¸Šæ‰§è¡Œé«˜æ•ˆæŸ¥è¯¢ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> Task&lt;User?&gt; FindByPhoneNumberAsync(<span class="built_in">string</span> phoneNum)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> userManager.Users.FirstOrDefaultAsync(u =&gt; u.PhoneNumber == phoneNum);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ç”Ÿæˆç”¨äºæ›´æ¢æ‰‹æœºå·çš„éªŒè¯ç ä»¤ç‰Œï¼ˆå§”æ‰˜ç»™ `userManager`ï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Task&lt;<span class="built_in">string</span>&gt; <span class="title">GenerateChangePhoneNumberTokenAsync</span>(<span class="params">User user, <span class="built_in">string</span> phoneNumber</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (user == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="keyword">nameof</span>(user));</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.userManager.GenerateChangePhoneNumberTokenAsync(user, phoneNumber);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> è·å–ç”¨æˆ·æ‰€å±çš„æ‰€æœ‰è§’è‰²åç§°ï¼ˆå§”æ‰˜åˆ° `userManager`ï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> Task&lt;IList&lt;<span class="built_in">string</span>&gt;&gt; GetRolesAsync(User user)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (user == <span class="literal">null</span>) <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentNullException(<span class="keyword">nameof</span>(user));</span><br><span class="line">            <span class="keyword">return</span> userManager.GetRolesAsync(user);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å¯¹ç”¨æˆ·åšè½¯åˆ é™¤ï¼š</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> - ç§»é™¤æ‰€æœ‰å¤–éƒ¨ç™»å½•ä¿¡æ¯ï¼ˆå¦‚ social loginsï¼‰</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> - è°ƒç”¨ç”¨æˆ·å®ä½“çš„ `SoftDelete()` æ ‡è®°ä¸ºå·²åˆ é™¤</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> - ä¿å­˜æ›´æ–°åˆ°å­˜å‚¨</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> è¿”å› `IdentityResult` è¡¨ç¤ºæ“ä½œæˆåŠŸæˆ–å¤±è´¥ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;IdentityResult&gt; <span class="title">RemoveUserAsync</span>(<span class="params">Guid id</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> user = <span class="keyword">await</span> FindByIdAsync(id);</span><br><span class="line">            <span class="keyword">if</span> (user == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// å¦‚æœç”¨æˆ·ä¸å­˜åœ¨ï¼Œä½œä¸ºä¸€ç§åˆç†çš„æƒ¯ä¾‹è¿”å›æˆåŠŸæˆ–å¤±è´¥å–å†³äºéœ€æ±‚ã€‚</span></span><br><span class="line">                <span class="comment">// è¿™é‡Œè¿”å›å¤±è´¥å¹¶è¯´æ˜ç”¨æˆ·ä¸å­˜åœ¨ã€‚</span></span><br><span class="line">                <span class="keyword">return</span> ErrorResult(<span class="string">$&quot;ç”¨æˆ· <span class="subst">&#123;id&#125;</span> ä¸å­˜åœ¨&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// è®¿é—®åº•å±‚çš„ç™»å½•ä¿¡æ¯å­˜å‚¨æ¥å£</span></span><br><span class="line">            <span class="keyword">var</span> userLoginStore = userManager.UserLoginStore;</span><br><span class="line">            <span class="keyword">var</span> ct = CancellationToken.None;</span><br><span class="line">            <span class="keyword">var</span> logins = <span class="keyword">await</span> userLoginStore.GetLoginsAsync(user, ct);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// ç§»é™¤æ¯ä¸ªå¤–éƒ¨ç™»å½•è®°å½•</span></span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> login <span class="keyword">in</span> logins)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">await</span> userLoginStore.RemoveLoginAsync(user, login.LoginProvider, login.ProviderKey, ct);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ ‡è®°è½¯åˆ é™¤å¹¶ä¿å­˜</span></span><br><span class="line">            user.SoftDelete();</span><br><span class="line">            <span class="keyword">var</span> result = <span class="keyword">await</span> userManager.UpdateAsync(user);</span><br><span class="line">            <span class="keyword">if</span> (!result.Succeeded)</span><br><span class="line">            &#123;</span><br><span class="line">                logger.LogWarning(<span class="string">&quot;è½¯åˆ é™¤ç”¨æˆ· &#123;UserId&#125; å¤±è´¥ï¼š&#123;Errors&#125;&quot;</span>, id, <span class="built_in">string</span>.Join(<span class="string">&quot;, &quot;</span>, result.Errors.Select(e =&gt; e.Description)));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ä¸ºæŒ‡å®šç”¨æˆ·é‡ç½®å¯†ç å¹¶è¿”å›æ–°å¯†ç ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> è¿”å›ä¸‰å…ƒç»„ (IdentityResult, User? , password?)ï¼š</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> - è‹¥ç”¨æˆ·ä¸å­˜åœ¨åˆ™è¿”å›å¤±è´¥ç»“æœä¸ nullã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> - è‹¥é‡ç½®æˆåŠŸåˆ™è¿”å› Successã€ç”¨æˆ·å®ä¾‹ä¸æ–°å¯†ç ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">async</span> Task&lt;(IdentityResult, User?, <span class="built_in">string</span>? password)&gt; ResetPasswordAsync(Guid id)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> user = <span class="keyword">await</span> FindByIdAsync(id);</span><br><span class="line">            <span class="keyword">if</span> (user == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> (ErrorResult(<span class="string">$&quot;ç”¨æˆ· <span class="subst">&#123;id&#125;</span> ä¸å­˜åœ¨&quot;</span>), <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="built_in">string</span> password = GeneratePassword();</span><br><span class="line">            <span class="built_in">string</span> token = <span class="keyword">await</span> userManager.GeneratePasswordResetTokenAsync(user);</span><br><span class="line">            <span class="keyword">var</span> result = <span class="keyword">await</span> userManager.ResetPasswordAsync(user, token, password);</span><br><span class="line">            <span class="keyword">if</span> (!result.Succeeded)</span><br><span class="line">            &#123;</span><br><span class="line">                logger.LogWarning(<span class="string">&quot;é‡ç½®ç”¨æˆ· &#123;UserId&#125; å¯†ç å¤±è´¥ï¼š&#123;Errors&#125;&quot;</span>, id, <span class="built_in">string</span>.Join(<span class="string">&quot;, &quot;</span>, result.Errors.Select(e =&gt; e.Description)));</span><br><span class="line">                <span class="keyword">return</span> (result, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> (IdentityResult.Success, user, password);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ç›´æ¥æ›´æ–°ç”¨æˆ·çš„æ‰‹æœºå·å­—æ®µï¼ˆä¸èµ°éªŒè¯ç æµç¨‹ï¼‰ï¼Œå¹¶ä¿å­˜æ›´æ”¹ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> è‹¥ç”¨æˆ·ä¸å­˜åœ¨æŠ›å‡º ArgumentExceptionã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">UpdatePhoneNumberAsync</span>(<span class="params">Guid id, <span class="built_in">string</span> phoneNum</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> user = <span class="keyword">await</span> userManager.Users.FirstOrDefaultAsync(u =&gt; u.Id == id);</span><br><span class="line">            <span class="keyword">if</span> (user == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">$&quot;ç”¨æˆ· <span class="subst">&#123;id&#125;</span> ä¸å­˜åœ¨&quot;</span>, <span class="keyword">nameof</span>(id));</span><br><span class="line">            &#125;</span><br><span class="line">            user.PhoneNumber = phoneNum;</span><br><span class="line">            <span class="keyword">await</span> userManager.UpdateAsync(user);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">IdentityService.Domain</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    è®¡åˆ’ï¼ˆä¼ªä»£ç ï¼‰ï¼š</span></span><br><span class="line"><span class="comment">    - ä¸º IdentityHelper ç±»æ·»åŠ æ³¨é‡Šï¼Œè¯´æ˜ç”¨é€”ï¼šå¯¹æ¥è‡ª Identity çš„é”™è¯¯é›†åˆè¿›è¡Œæ±‡æ€»ä¸ºå¯è¯»å­—ç¬¦ä¸²ã€‚</span></span><br><span class="line"><span class="comment">    - ä¸º SumErrors æ‰©å±•æ–¹æ³•æ·»åŠ è¯¦ç»†æ³¨é‡Šï¼Œè¯´æ˜å‚æ•°ã€è¿”å›å€¼ã€è¡Œä¸ºï¼ˆå¦‚ä½•å¤„ç† nullã€æ ¼å¼åŒ–è§„åˆ™ï¼‰ã€‚</span></span><br><span class="line"><span class="comment">    - åœ¨æ–¹æ³•å†…éƒ¨ä¿ç•™ç°æœ‰å®ç°ï¼šå°†æ¯ä¸ª IdentityError æ ¼å¼åŒ–ä¸º &quot;code=&#123;Code&#125;,message=&#123;Description&#125; &quot;ï¼Œå¹¶ç”¨æ¢è¡Œç¬¦è¿æ¥ã€‚</span></span><br><span class="line"><span class="comment">    - ä¸ºæé«˜å¥å£®æ€§ï¼šå½“è¾“å…¥ä¸º null æ—¶è¿”å›ç©ºå­—ç¬¦ä¸²ï¼›å½“é›†åˆä¸ºç©ºæ—¶è¿”å›ç©ºå­—ç¬¦ä¸²ã€‚</span></span><br><span class="line"><span class="comment">    - ä¿æŒæ–¹æ³•ä¸ºæ‰©å±•æ–¹æ³•ï¼Œä¾¿äºåœ¨ IEnumerable&lt;IdentityError&gt; ä¸Šç›´æ¥è°ƒç”¨ã€‚</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æä¾›ä¸ ASP.NET Core Identity é”™è¯¯å¤„ç†ç›¸å…³çš„è¾…åŠ©æ–¹æ³•ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">IdentityHelper</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å°† <span class="doctag">&lt;see cref=&quot;IdentityError&quot;/&gt;</span> çš„é›†åˆæ±‡æ€»ä¸ºå•ä¸ªå¯è¯»å­—ç¬¦ä¸²ï¼Œä¾¿äºæ—¥å¿—è®°å½•æˆ–è°ƒè¯•ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;errors&quot;&gt;</span>è¦æ±‡æ€»çš„é”™è¯¯é›†åˆã€‚å…è®¸ä¸º <span class="doctag">&lt;c&gt;</span>null<span class="doctag">&lt;/c&gt;</span>ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å¦‚æœ <span class="doctag">&lt;paramref name=&quot;errors&quot;/&gt;</span> ä¸º <span class="doctag">&lt;c&gt;</span>null<span class="doctag">&lt;/c&gt;</span> æˆ–ä¸ºç©ºé›†åˆï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸²ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å¦åˆ™è¿”å›æ¯ä¸ªé”™è¯¯çš„è¡Œè¡¨ç¤ºï¼Œæ¯è¡Œæ ¼å¼ä¸º &quot;code=&#123;Code&#125;,message=&#123;Description&#125; &quot;ï¼Œè¡Œä¸è¡Œä¹‹é—´ç”¨æ¢è¡Œç¬¦åˆ†éš”ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;example&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> var summary = errors.SumErrors();</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> // å¯èƒ½çš„è¾“å‡ºç¤ºä¾‹ï¼š</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> // code=DuplicateUserName,message=Username &#x27;alice&#x27; is already taken </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> // code=PasswordTooShort,message=Passwords must be at least 6 characters. </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/example&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">SumErrors</span>(<span class="params"><span class="keyword">this</span> IEnumerable&lt;IdentityError&gt; errors</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// å¤„ç† null å®‰å…¨ï¼šå¦‚æœ errors ä¸º nullï¼Œè¿”å›ç©ºå­—ç¬¦ä¸²ï¼Œé¿å…è°ƒç”¨æ–¹æŠ›å‡º NullReferenceExceptionã€‚</span></span><br><span class="line">            <span class="keyword">if</span> (errors <span class="keyword">is</span> <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">string</span>.Empty;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å°†æ¯ä¸ªé”™è¯¯æ ¼å¼åŒ–ä¸ºæŒ‡å®šçš„æ–‡æœ¬è¡¨ç¤ºï¼Œå¹¶ä½¿ç”¨æ¢è¡Œç¬¦è¿æ¥ã€‚</span></span><br><span class="line">            <span class="keyword">var</span> strs = errors.Select(e =&gt; <span class="string">$&quot;code=<span class="subst">&#123;e.Code&#125;</span>,message=<span class="subst">&#123;e.Description&#125;</span> &quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">string</span>.Join(<span class="string">&quot;\n&quot;</span>, strs);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å¼€å‘è®¤è¯æœåŠ¡çš„åº”ç”¨æœåŠ¡å±‚"><a href="#å¼€å‘è®¤è¯æœåŠ¡çš„åº”ç”¨æœåŠ¡å±‚" class="headerlink" title="å¼€å‘è®¤è¯æœåŠ¡çš„åº”ç”¨æœåŠ¡å±‚"></a>å¼€å‘è®¤è¯æœåŠ¡çš„åº”ç”¨æœåŠ¡å±‚</h1><p>IdentitySevice.WebAPIæ˜¯è®¤è¯æœåŠ¡çš„åº”ç”¨æœåŠ¡é¡¹ç›®ã€‚ASP.NET Coreçš„é¡¹ç›®ä½¿ç”¨FluentValidationæ¥å®ç°è¯·æ±‚æ•°æ®çš„éªŒè¯ã€‚ä¸ºäº†æ–¹ä¾¿ç®¡ç†ï¼Œæˆ‘ä»¬æŠŠè¯·æ±‚å‚æ•°ç±»å‹å’Œå®ƒçš„æ•°æ®éªŒè¯ç±»å†™åˆ°äº†åŒä¸€ä¸ªC#æ–‡ä»¶ä¸­ï¼Œè¿™æ ·ç®¡ç†èµ·æ¥æ›´åŠ æ–¹ä¾¿ï¼Œæˆ‘ä»¬åœ¨æŸ¥çœ‹è¯·æ±‚å‚æ•°ç±»çš„æ—¶å€™ï¼Œä¸€çœ¼å°±èƒ½çœ‹åˆ°æ•°æ®æ ¡éªŒç±»çš„ä»£ç ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">IdentityService.WebAPI.Controllers.Login</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ç™»å½•ç›¸å…³æ§åˆ¶å™¨ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> è¿™ä¸ªæ§åˆ¶å™¨è´Ÿè´£ï¼š</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> - åˆå§‹åŒ–é»˜è®¤ç®¡ç†å‘˜ï¼ˆCreateWorldï¼‰</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> - è·å–å½“å‰ç™»å½•ç”¨æˆ·ä¿¡æ¯ï¼ˆGetUserInfoï¼‰</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> - ä½¿ç”¨æ‰‹æœºå·æˆ–ç”¨æˆ·å+å¯†ç ç™»å½•å¹¶è¿”å› JWTï¼ˆLoginByPhoneAndPwd / LoginByUserNameAndPwdï¼‰</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> - ç”¨æˆ·ä¿®æ”¹è‡ªå·±å¯†ç ï¼ˆChangeMyPasswordï¼‰</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> </span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æ³¨é‡Šå°½é‡ç”¨é€šä¿—æ˜“æ‡‚çš„ä¸­æ–‡è§£é‡Šæ¯ä¸€æ­¥çš„æ„å›¾ï¼Œä¾¿äºç»´æŠ¤è€…å¿«é€Ÿç†è§£é€»è¾‘ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    [<span class="meta">Route(<span class="string">&quot;[controller]/[action]&quot;</span>)</span>]</span><br><span class="line">    [<span class="meta">ApiController</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">LoginController</span> : <span class="title">ControllerBase</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> IIdRepository repository;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> IdDomainService idService;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ„é€ å‡½æ•°ï¼Œæ³¨å…¥èº«ä»½ä»“å‚¨å’Œé¢†åŸŸæœåŠ¡ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> - repository: ç”¨äºè¯»å†™ç”¨æˆ·ã€è§’è‰²ã€å¯†ç ç­‰ä¿¡æ¯çš„ä»“å‚¨æ¥å£</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> - idService: åŒ…å«ç™»å½•æ ¡éªŒå’Œç”Ÿæˆ JWT ç­‰é¢†åŸŸé€»è¾‘çš„æœåŠ¡</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">LoginController</span>(<span class="params">IdDomainService idService, IIdRepository repository</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.idService = idService;</span><br><span class="line">            <span class="keyword">this</span>.repository = repository;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> åˆå§‹åŒ–ç³»ç»Ÿçš„ç®¡ç†å‘˜è´¦æˆ·ï¼ˆä»…åœ¨æœªåˆå§‹åŒ–æ—¶å…è®¸æ‰§è¡Œï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> åœºæ™¯ï¼šé¦–æ¬¡éƒ¨ç½²æ—¶è°ƒç”¨ï¼Œåˆ›å»ºç”¨æˆ·åä¸º &quot;admin&quot; çš„ç”¨æˆ·å¹¶è®¾ç½®åˆå§‹å¯†ç åŠè§’è‰²ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> è¿”å›ï¼š</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> - 409 Conflictï¼šå¦‚æœå·²ç»å­˜åœ¨åä¸º &quot;admin&quot; çš„ç”¨æˆ·ï¼ˆè¯´æ˜å·²åˆå§‹åŒ–ï¼‰</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> - 200 OKï¼šåˆå§‹åŒ–æˆåŠŸ</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ³¨æ„ï¼šæ­¤æ¥å£é€šå¸¸åªåœ¨éƒ¨ç½²æˆ–è°ƒè¯•æ—¶ä½¿ç”¨ï¼Œä¸åº”åœ¨ç”Ÿäº§ç¯å¢ƒéšæ„æš´éœ²ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        [<span class="meta">HttpPost</span>]</span><br><span class="line">        [<span class="meta">AllowAnonymous</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;ActionResult&gt; <span class="title">CreateWorld</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// æ£€æŸ¥æ˜¯å¦å·²ç»æœ‰ admin ç”¨æˆ·ï¼Œé¿å…é‡å¤åˆå§‹åŒ–</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">await</span> repository.FindByNameAsync(<span class="string">&quot;admin&quot;</span>) != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// è¿”å›å†²çªçŠ¶æ€ç å¹¶è¯´æ˜åŸå› ï¼ˆä¸­æ–‡æç¤ºï¼‰</span></span><br><span class="line">                <span class="keyword">return</span> StatusCode((<span class="built_in">int</span>)HttpStatusCode.Conflict, <span class="string">&quot;å·²ç»åˆå§‹åŒ–è¿‡äº†&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// åˆ›å»ºä¸€ä¸ªæ–°çš„ User å®ä¾‹ï¼Œç”¨æˆ·åä¸º &quot;admin&quot;</span></span><br><span class="line">            User user = <span class="keyword">new</span> User(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// ä½¿ç”¨ä»“å‚¨åˆ›å»ºç”¨æˆ·å¹¶è®¾ç½®åˆå§‹å¯†ç  &quot;123456&quot;</span></span><br><span class="line">            <span class="keyword">var</span> r = <span class="keyword">await</span> repository.CreateAsync(user, <span class="string">&quot;123456&quot;</span>);</span><br><span class="line">            Debug.Assert(r.Succeeded); <span class="comment">// æ–­è¨€åˆ›å»ºæˆåŠŸï¼ˆä»…åœ¨è°ƒè¯•æœŸé—´æœ‰æ•ˆï¼‰</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// ç”Ÿæˆç”¨äºæ›´æ¢æ‰‹æœºå·çš„ä»¤ç‰Œå¹¶æŠŠæ‰‹æœºå·è®¾ç½®ä¸º &quot;zjc123456&quot;</span></span><br><span class="line">            <span class="keyword">var</span> token = <span class="keyword">await</span> repository.GenerateChangePhoneNumberTokenAsync(user, <span class="string">&quot;zjc123456&quot;</span>);</span><br><span class="line">            <span class="keyword">var</span> cr = <span class="keyword">await</span> repository.ChangePhoneNumAsync(user.Id, <span class="string">&quot;zjc123456&quot;</span>, token);</span><br><span class="line">            Debug.Assert(cr.Succeeded); <span class="comment">// æ–­è¨€æ‰‹æœºå·è®¾ç½®æˆåŠŸ</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// å°†ç”¨æˆ·æ·»åŠ åˆ°ä¸¤ä¸ªè§’è‰²ï¼šUser å’Œ Admin</span></span><br><span class="line">            r = <span class="keyword">await</span> repository.AddToRoleAsync(user, <span class="string">&quot;User&quot;</span>);</span><br><span class="line">            Debug.Assert(r.Succeeded);</span><br><span class="line">            r = <span class="keyword">await</span> repository.AddToRoleAsync(user, <span class="string">&quot;Admin&quot;</span>);</span><br><span class="line">            Debug.Assert(r.Succeeded);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> Ok();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> è·å–å½“å‰ç™»å½•ç”¨æˆ·çš„åŸºç¡€ä¿¡æ¯ï¼ˆéœ€è¦æˆæƒï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> è¿”å›ç”¨æˆ· Idã€æ‰‹æœºå·å’Œåˆ›å»ºæ—¶é—´ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ç»†èŠ‚ï¼š</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> - ä» JWT çš„å£°æ˜ä¸­è¯»å– NameIdentifierï¼ˆç”¨æˆ· Idï¼‰</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> - ä½¿ç”¨ä»“å‚¨æŸ¥æ‰¾ç”¨æˆ·å®ä½“å¹¶è¿”å›å¿…è¦ä¿¡æ¯</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> - è‹¥æ‰¾ä¸åˆ°ç”¨æˆ·åˆ™è¿”å› 404</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        [<span class="meta">HttpGet</span>]</span><br><span class="line">        [<span class="meta">Authorize</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">async</span> Task&lt;ActionResult&lt;UserResponse&gt;&gt; GetUserInfo()</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// ä»å½“å‰ä¸Šä¸‹æ–‡çš„ User å£°æ˜ä¸­å–å‡ºç”¨æˆ· Idï¼ˆNameIdentifierï¼‰</span></span><br><span class="line">            <span class="built_in">string</span> userId = <span class="keyword">this</span>.User.FindFirstValue(ClaimTypes.NameIdentifier)!;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// è§£æä¸º Guid å¹¶ä»ä»“å‚¨åŠ è½½ç”¨æˆ·å®ä½“</span></span><br><span class="line">            <span class="keyword">var</span> user = <span class="keyword">await</span> repository.FindByIdAsync(Guid.Parse(userId));</span><br><span class="line">            <span class="keyword">if</span> (user == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// ç”¨æˆ·ä¸å­˜åœ¨åˆ™è¿”å› 404</span></span><br><span class="line">                <span class="keyword">return</span> NotFound();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// è¿”å›ç”¨æˆ·å“åº”å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å« Idã€æ‰‹æœºå·å’Œåˆ›å»ºæ—¶é—´</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> UserResponse(user.Id, user.PhoneNumber!, user.CreationTime);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ä½¿ç”¨æ‰‹æœºå· + å¯†ç ç™»å½•ï¼ŒæˆåŠŸåˆ™è¿”å› JWT å­—ç¬¦ä¸²ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> - è¾“å…¥å‚æ•°ï¼šLoginByPhoneAndPwdRequestï¼ŒåŒ…å« PhoneNum å’Œ Password</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> - è¿”å›ï¼š</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>   - 200 + tokenï¼šç™»å½•æˆåŠŸå¹¶è¿”å›ä»¤ç‰Œ</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>   - 423 Lockedï¼šè´¦å·è¢«é”å®š</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>   - 400 BadRequestï¼šç™»å½•å¤±è´¥ï¼ˆä¾‹å¦‚å¯†ç é”™è¯¯ï¼‰</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        [<span class="meta">AllowAnonymous</span>]</span><br><span class="line">        [<span class="meta">HttpPost</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">async</span> Task&lt;ActionResult&lt;<span class="built_in">string</span>?&gt;&gt; LoginByPhoneAndPwd(LoginByPhoneAndPwdRequest req)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// è°ƒç”¨é¢†åŸŸæœåŠ¡è¿›è¡Œç™»å½•æ ¡éªŒå¹¶å°è¯•ç”Ÿæˆ token</span></span><br><span class="line">            (<span class="keyword">var</span> checkResult, <span class="built_in">string</span>? token) = <span class="keyword">await</span> idService.LoginByPhoneAndPwdAsync(req.PhoneNum, req.Password);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (checkResult.Succeeded)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// ç™»å½•æˆåŠŸï¼Œè¿”å› tokenï¼ˆé€šå¸¸æ˜¯ JWTï¼‰</span></span><br><span class="line">                <span class="keyword">return</span> token;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (checkResult.IsLockedOut)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// è´¦å·è¢«é”å®šï¼Œè¿”å› 423ï¼ˆLockedï¼‰</span></span><br><span class="line">                <span class="keyword">return</span> StatusCode((<span class="built_in">int</span>)HttpStatusCode.Locked, <span class="string">&quot;æ­¤è´¦å·å·²ç»é”å®š&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// å…¶å®ƒå¤±è´¥æƒ…å†µï¼ˆå¦‚å¯†ç é”™è¯¯ã€ç”¨æˆ·ä¸å­˜åœ¨ç­‰ï¼‰</span></span><br><span class="line">                <span class="built_in">string</span> msg = <span class="string">&quot;ç™»å½•å¤±è´¥ï¼Œ&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> StatusCode((<span class="built_in">int</span>)HttpStatusCode.BadRequest, msg);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ä½¿ç”¨ç”¨æˆ·å + å¯†ç ç™»å½•ï¼ŒæˆåŠŸåˆ™è¿”å› JWT å­—ç¬¦ä¸²ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> - è¾“å…¥å‚æ•°ï¼šLoginByUserNameAndPwdRequestï¼ŒåŒ…å« UserName å’Œ Password</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> - è¿”å›ï¼š</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>   - 200 + tokenï¼šç™»å½•æˆåŠŸ</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>   - 423 Lockedï¼šç”¨æˆ·è¢«é”å®š</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>   - 400 BadRequestï¼šç™»å½•å¤±è´¥å¹¶è¿”å›é”™è¯¯ä¿¡æ¯</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        [<span class="meta">AllowAnonymous</span>]</span><br><span class="line">        [<span class="meta">HttpPost</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">async</span> Task&lt;ActionResult&lt;<span class="built_in">string</span>&gt;&gt; LoginByUserNameAndPwd(LoginByUserNameAndPwdRequest req)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// è°ƒç”¨é¢†åŸŸæœåŠ¡è¿›è¡Œç”¨æˆ·å/å¯†ç æ ¡éªŒå¹¶è¿”å›ç™»å½•ç»“æœä¸ token</span></span><br><span class="line">            (<span class="keyword">var</span> checkResult, <span class="keyword">var</span> token) = <span class="keyword">await</span> idService.LoginByUserNameAndPwdAsync(req.UserName, req.Password);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (checkResult.Succeeded)</span><br><span class="line">                <span class="comment">// ç™»å½•æˆåŠŸï¼Œè¿”å› tokenï¼ˆæ³¨æ„ï¼štoken å¯èƒ½ä¸ºç©ºæ—¶ç”¨ &#x27;!&#x27; è¡¨ç¤ºæˆ‘ä»¬ç¡®ä¿¡éç©ºï¼‰</span></span><br><span class="line">                <span class="keyword">return</span> token!;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (checkResult.IsLockedOut)</span><br><span class="line">                <span class="comment">// è¢«é”å®šæ—¶è¿”å› 423</span></span><br><span class="line">                <span class="keyword">return</span> StatusCode((<span class="built_in">int</span>)HttpStatusCode.Locked, <span class="string">&quot;ç”¨æˆ·å·²ç»è¢«é”å®š&quot;</span>);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// å…¶å®ƒå¤±è´¥æƒ…å†µï¼Œä½¿ç”¨ checkResult çš„ä¿¡æ¯æ„å»ºé”™è¯¯æç¤ºè¿”å› 400</span></span><br><span class="line">                <span class="built_in">string</span> msg = checkResult.ToString();</span><br><span class="line">                <span class="keyword">return</span> BadRequest(<span class="string">&quot;ç™»å½•å¤±è´¥&quot;</span> + msg);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å½“å‰å·²ç™»å½•ç”¨æˆ·ä¿®æ”¹è‡ªå·±çš„å¯†ç ï¼ˆéœ€è¦æˆæƒï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> - è¾“å…¥å‚æ•°ï¼šChangeMyPasswordRequestï¼ŒåŒ…å«æ–°çš„ Password</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> - è¿”å›ï¼š</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>   - 200 OKï¼šä¿®æ”¹æˆåŠŸ</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>   - 400 BadRequestï¼šä¿®æ”¹å¤±è´¥å¹¶è¿”å›é”™è¯¯ä¿¡æ¯ï¼ˆæŠŠ IdentityResult é”™è¯¯åˆå¹¶ä¸ºå­—ç¬¦ä¸²ï¼‰</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> è¯´æ˜ï¼š</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> - ä»å½“å‰çš„ JWT ä¸­è¯»å–ç”¨æˆ· Idï¼Œè°ƒç”¨ä»“å‚¨çš„ ChangePasswordAsync æ‰§è¡Œä¿®æ”¹</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> - ChangePasswordAsync çš„å®ç°åº”å¤„ç†æ—§å¯†ç æ ¡éªŒæˆ–ç›´æ¥é‡ç½®ï¼Œå–å†³äºä»“å‚¨å®ç°ç»†èŠ‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        [<span class="meta">HttpPost</span>]</span><br><span class="line">        [<span class="meta">Authorize</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;ActionResult&gt; <span class="title">ChangeMyPassword</span>(<span class="params">ChangeMyPasswordRequest req</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// ä»å£°æ˜ä¸­è·å–ç”¨æˆ· Id å¹¶è§£æä¸º Guid</span></span><br><span class="line">            Guid userId = Guid.Parse(<span class="keyword">this</span>.User.FindFirstValue(ClaimTypes.NameIdentifier));</span><br><span class="line"></span><br><span class="line">            <span class="comment">// è°ƒç”¨ä»“å‚¨ä¿®æ”¹å¯†ç ï¼ˆä»“å‚¨è´Ÿè´£å®é™…çš„å¯†ç ç­–ç•¥æ ¡éªŒï¼‰</span></span><br><span class="line">            <span class="keyword">var</span> resetPwdResult = <span class="keyword">await</span> repository.ChangePasswordAsync(userId, req.Password);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (resetPwdResult.Succeeded)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// ä¿®æ”¹æˆåŠŸ</span></span><br><span class="line">                <span class="keyword">return</span> Ok();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// å°† IdentityResult ä¸­çš„é”™è¯¯ä¿¡æ¯åˆå¹¶æˆä¸€ä¸ªå‹å¥½å­—ç¬¦ä¸²å¹¶è¿”å› 400</span></span><br><span class="line">                <span class="keyword">return</span> BadRequest(resetPwdResult.Errors.SumErrors());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ASP.NET Core </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ­å»ºæ–‡ä»¶æœåŠ¡</title>
      <link href="/2025/09/13/asp.net%20core/%E5%AD%A6%E8%8B%B1%E8%AF%AD%E7%BD%91%E7%AB%99%E9%A1%B9%E7%9B%AE/%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1/"/>
      <url>/2025/09/13/asp.net%20core/%E5%AD%A6%E8%8B%B1%E8%AF%AD%E7%BD%91%E7%AB%99%E9%A1%B9%E7%9B%AE/%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1/</url>
      
        <content type="html"><![CDATA[<blockquote><p>æ–‡ä»¶æœåŠ¡ç”¨æ¥å°†ç”¨æˆ·ä¸Šä¼ çš„éŸ³é¢‘æ–‡ä»¶ä¸Šä¼ åˆ°æ–‡ä»¶æœåŠ¡å™¨å’Œå¤‡ä»½æœåŠ¡å™¨ã€‚ä¸ºäº†æé«˜å¤„ç†é€Ÿåº¦å’Œé¿å…æ–‡ä»¶é‡å¤ä¸Šä¼ ï¼Œå½“ç”¨æˆ·ä¸Šä¼ æœåŠ¡å™¨ä¸­å·²ç»å­˜åœ¨çš„æ–‡ä»¶æ—¶ï¼Œæ–‡ä»¶æœåŠ¡å™¨ä¼šç›´æ¥æŠŠä¹‹å‰çš„æ–‡ä»¶è¿”å›ç»™ä¸Šä¼ è€…ã€‚</p></blockquote><h1 id="å¼€å‘æ–‡ä»¶æœåŠ¡çš„é¢†åŸŸå±‚"><a href="#å¼€å‘æ–‡ä»¶æœåŠ¡çš„é¢†åŸŸå±‚" class="headerlink" title="å¼€å‘æ–‡ä»¶æœåŠ¡çš„é¢†åŸŸå±‚"></a>å¼€å‘æ–‡ä»¶æœåŠ¡çš„é¢†åŸŸå±‚</h1><p>FileService.Domainæ˜¯æ–‡ä»¶æœåŠ¡çš„é¢†åŸŸå±‚é¡¹ç›®ã€‚æ–‡ä»¶æœåŠ¡ä¸­åªæœ‰ä¸€ä¸ªé¢†åŸŸæ¨¡å‹â€œä¸Šä¼ é¡¹â€ï¼ˆUploadedItemï¼‰,æ¯ä¸€æ¬¡ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶å°±æ˜¯ä¸€ä¸ªâ€œä¸Šä¼ é¡¹â€ã€‚UploadedItemå®ä½“ç±»ä¸­å®šä¹‰äº†å¦‚ä¸‹å‡ ä¸ªä¸»è¦çš„å±æ€§ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> è¡¨ç¤ºå·²ä¸Šä¼ çš„æ–‡ä»¶é¡¹ï¼ŒåŒ…å«æ–‡ä»¶çš„åŸºæœ¬ä¿¡æ¯å’Œå¤‡ä»½ã€è¿œç¨‹è®¿é—®åœ°å€ã€‚</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">record</span> <span class="title">Uploadedltem</span> : <span class="title">BaseEntity</span>, <span class="title">IHasCreationTime</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æ–‡ä»¶ä¸Šä¼ çš„æ—¶é—´ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> DateTime CreationTime &#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æ–‡ä»¶çš„å¤§å°ï¼ˆå­—èŠ‚æ•°ï¼‰ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> FileSizeInBytes &#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æ–‡ä»¶åã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> FileName &#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æ–‡ä»¶çš„SHA256å“ˆå¸Œå€¼ï¼Œç”¨äºæ ¡éªŒæ–‡ä»¶å®Œæ•´æ€§ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> FileSHA256Hash &#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æ–‡ä»¶çš„å¤‡ä»½åœ°å€ï¼ˆURIï¼‰ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> Uri BackupUri &#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æ–‡ä»¶çš„è¿œç¨‹è®¿é—®åœ°å€ï¼ˆURIï¼‰ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> Uri RemoteUrl &#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> åˆ›å»ºä¸€ä¸ªæ–°çš„å·²ä¸Šä¼ æ–‡ä»¶é¡¹ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;id&quot;&gt;</span>æ–‡ä»¶é¡¹çš„å”¯ä¸€æ ‡è¯†ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;fileSizeInBytes&quot;&gt;</span>æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;fileName&quot;&gt;</span>æ–‡ä»¶åã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;fileSHA256Hash&quot;&gt;</span>æ–‡ä»¶SHA256å“ˆå¸Œå€¼ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;backupUri&quot;&gt;</span>å¤‡ä»½åœ°å€ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;remoteUrl&quot;&gt;</span>è¿œç¨‹è®¿é—®åœ°å€ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>æ–°åˆ›å»ºçš„ <span class="doctag">&lt;see cref=&quot;Uploadedltem&quot;/&gt;</span> å®ä¾‹ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Uploadedltem <span class="title">Create</span>(<span class="params">Guid id, <span class="built_in">long</span> fileSizeInBytes, <span class="built_in">string</span> fileName, <span class="built_in">string</span> fileSHA256Hash, Uri backupUri, Uri remoteUrl</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Uploadedltem item = <span class="keyword">new</span> Uploadedltem</span><br><span class="line">        &#123;</span><br><span class="line">            Id = id,</span><br><span class="line">            FileSizeInBytes = fileSizeInBytes,</span><br><span class="line">            FileName = fileName,</span><br><span class="line">            FileSHA256Hash = fileSHA256Hash,</span><br><span class="line">            BackupUri = backupUri,</span><br><span class="line">            RemoteUrl = remoteUrl,</span><br><span class="line">            CreationTime = DateTime.Now</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span> item;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»§æ‰¿çš„ç±»ä¸æ¥å£</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// BaseEntity æ˜¯æ‰€æœ‰é¢†åŸŸå®ä½“çš„åŸºç¡€ç±»ï¼ŒåŒ…å«é¢†åŸŸäº‹ä»¶çš„ç®¡ç†åŠŸèƒ½ã€‚</span></span><br><span class="line"><span class="comment">// é¢†åŸŸäº‹ä»¶ç”¨äºåœ¨ä¸šåŠ¡å‘ç”Ÿå˜åŒ–æ—¶é€šçŸ¥å…¶ä»–éƒ¨åˆ†è¿›è¡Œå“åº”ã€‚</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">record</span> <span class="title">BaseEntity</span> : <span class="title">IEntity</span>, <span class="title">IDomainEvents</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// domainEvents ç”¨äºå­˜å‚¨å½“å‰å®ä½“äº§ç”Ÿçš„æ‰€æœ‰é¢†åŸŸäº‹ä»¶ã€‚</span></span><br><span class="line">    <span class="comment">// [NotMapped] è¡¨ç¤ºè¯¥å­—æ®µä¸ä¼šè¢«æ˜ å°„åˆ°æ•°æ®åº“è¡¨ä¸­ã€‚</span></span><br><span class="line">    [<span class="meta">NotMapped</span>]</span><br><span class="line">    <span class="keyword">private</span> List&lt;INotification&gt; domainEvents = <span class="keyword">new</span> List&lt;INotification&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Id æ˜¯å®ä½“çš„å”¯ä¸€æ ‡è¯†ï¼Œæ¯ä¸ªå®ä½“åˆ›å»ºæ—¶è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªæ–°çš„ Guidã€‚</span></span><br><span class="line">    <span class="keyword">public</span> Guid Id &#123; <span class="keyword">get</span>; <span class="keyword">protected</span> <span class="keyword">set</span>; &#125; = Guid.NewGuid();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ·»åŠ ä¸€ä¸ªé¢†åŸŸäº‹ä»¶åˆ°é›†åˆä¸­ã€‚</span></span><br><span class="line">    <span class="comment">// é¢†åŸŸäº‹ä»¶å¯ä»¥ç”¨äºé€šçŸ¥å¤–éƒ¨ç³»ç»Ÿæˆ–å…¶ä»–ä¸šåŠ¡é€»è¾‘ã€‚</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AddDomainEvent</span>(<span class="params">INotification eventItem</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        domainEvents.Add(eventItem);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœé›†åˆä¸­æ²¡æœ‰è¯¥äº‹ä»¶ï¼Œåˆ™æ·»åŠ å®ƒï¼Œé¿å…é‡å¤æ·»åŠ ç›¸åŒäº‹ä»¶ã€‚</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AddDomainEventIfAbsent</span>(<span class="params">INotification eventItem</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!domainEvents.Contains(eventItem))</span><br><span class="line">        &#123;</span><br><span class="line">            domainEvents.Add(eventItem);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¸…ç©ºæ‰€æœ‰å·²æ³¨å†Œçš„é¢†åŸŸäº‹ä»¶ï¼Œé€šå¸¸åœ¨äº‹ä»¶å¤„ç†å®Œæˆåè°ƒç”¨ã€‚</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ClearDomainEvents</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        domainEvents.Clear();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–å½“å‰å®ä½“ä¸Šæ‰€æœ‰å·²æ³¨å†Œçš„é¢†åŸŸäº‹ä»¶ã€‚</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> IEnumerable&lt;INotification&gt; <span class="title">GetDomainEvents</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> domainEvents;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> å®šä¹‰é¢†åŸŸäº‹ä»¶é›†åˆçš„æ¥å£ã€‚</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> è¯¥æ¥å£ç”¨äºèšåˆæ ¹æˆ–å®ä½“ä¸­ç®¡ç†é¢†åŸŸäº‹ä»¶çš„æ·»åŠ ã€å»é‡ã€è·å–å’Œæ¸…ç†æ“ä½œã€‚</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> é¢†åŸŸäº‹ä»¶ç”¨äºåœ¨é¢†åŸŸæ¨¡å‹å†…éƒ¨æˆ–å¤–éƒ¨ä¼ æ’­é‡è¦çš„ä¸šåŠ¡çŠ¶æ€å˜åŒ–ã€‚</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IDomainEvents</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> è·å–å½“å‰å·²æ³¨å†Œçš„æ‰€æœ‰é¢†åŸŸäº‹ä»¶ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>é¢†åŸŸäº‹ä»¶çš„åªè¯»é›†åˆã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function">IEnumerable&lt;INotification&gt; <span class="title">GetDomainEvents</span>()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æ·»åŠ ä¸€ä¸ªæ–°çš„é¢†åŸŸäº‹ä»¶åˆ°é›†åˆä¸­ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;eventItem&quot;&gt;</span>è¦æ·»åŠ çš„é¢†åŸŸäº‹ä»¶ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">AddDomainEvent</span>(<span class="params">INotification eventItem</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> å¦‚æœé›†åˆä¸­ä¸å­˜åœ¨è¯¥äº‹ä»¶ï¼Œåˆ™æ·»åŠ ä¸€ä¸ªæ–°çš„é¢†åŸŸäº‹ä»¶ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ç”¨äºé¿å…é‡å¤æ·»åŠ ç›¸åŒçš„äº‹ä»¶ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;eventItem&quot;&gt;</span>è¦æ·»åŠ çš„é¢†åŸŸäº‹ä»¶ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">AddDomainEventIfAbsent</span>(<span class="params">INotification eventItem</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æ¸…ç©ºå½“å‰æ‰€æœ‰å·²æ³¨å†Œçš„é¢†åŸŸäº‹ä»¶ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ClearDomainEvents</span>()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”¨æˆ·ä¸Šä¼ çš„æ–‡ä»¶ä¼šè¿›ä¸€æ­¥è¢«ä¿å­˜åˆ°å¤‡ä»½æœåŠ¡å™¨åŠäº‘å­˜å‚¨æœåŠ¡å™¨ï¼Œå› ä¸ºä¸åŒçš„å­˜å‚¨æœåŠ¡å™¨çš„å®ç°çš„å·®åˆ«æ¯”è¾ƒå¤§ï¼Œè€Œä¸”æˆ‘ä»¬ä¹Ÿå¯èƒ½ä¼šåˆ‡æ¢ä½¿ç”¨ä¸åŒçš„å­˜å‚¨æœåŠ¡å™¨ï¼Œæ‰€ä»¥ä¸ºäº†å±è”½è¿™äº›å­˜å‚¨æœåŠ¡å™¨çš„å·®å¼‚ï¼Œå®šä¹‰äº†ä¸€ä¸ªé˜²è…å±‚æ¥å£IStorageClientã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> å­˜å‚¨å®¢æˆ·ç«¯æ¥å£ï¼Œå®šä¹‰å­˜å‚¨ç±»å‹åŠä¿å­˜æ–‡ä»¶çš„æ–¹æ³•ã€‚</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IStorageClient</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> è·å–å­˜å‚¨ç±»å‹ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    StorageType StorageType &#123; <span class="keyword">get</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> å¼‚æ­¥ä¿å­˜æ–‡ä»¶å†…å®¹åˆ°æŒ‡å®šå­˜å‚¨ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;key&quot;&gt;</span>æ–‡ä»¶çš„å”¯ä¸€æ ‡è¯†é”®ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;content&quot;&gt;</span>æ–‡ä»¶å†…å®¹æµã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;cancellationToken&quot;&gt;</span>å–æ¶ˆæ“ä½œçš„ä»¤ç‰Œã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>è¿”å›æ–‡ä»¶çš„è®¿é—® Uriã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function">Task&lt;Uri&gt; <span class="title">SaveAsync</span>(<span class="params"><span class="built_in">string</span> key, Stream content, CancellationToken cancellationToken</span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>IStorageClientå’ŒStorageTypeå±æ€§æ˜¯æšä¸¾ç±»å‹ï¼Œç”¨æ¥è¡¨ç¤ºå­˜å‚¨æœåŠ¡å™¨ç­‰ç±»å‹ï¼Œæœ‰Publicã€Backupä¸¤ä¸ªå¯é€‰å€¼ï¼Œåˆ†åˆ«ä»£è¡¨ä¾›å…¬ä¼—è®¿é—®çš„å­˜å‚¨æœåŠ¡å™¨å’Œä¾›å†…ç½‘å¤‡ä»½ç”¨çš„å­˜å‚¨æœåŠ¡å™¨ï¼›<br>SaveAsyncæ–¹æ³•ç”¨æ¥æŠŠcontentå‚æ•°æ‰€ä»£è¡¨çš„æ–‡ä»¶å†…å®¹ä¿å­˜åˆ°å­˜å‚¨æœåŠ¡å™¨ä¸­ï¼Œkeyå‚æ•°çš„å€¼ä¸€èˆ¬ä¸ºæ–‡ä»¶åœ¨æœåŠ¡å™¨ç«¯çš„ä¿å­˜è·¯å¾„ï¼ŒSaveAsyncçš„è¿”å›å€¼ä¸ºä¿å­˜çš„æ–‡ä»¶çš„å…¨è·¯å¾„ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> å­˜å‚¨ç±»å‹æšä¸¾ï¼Œå®šä¹‰æ–‡ä»¶å­˜å‚¨çš„ç±»åˆ«ã€‚</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="built_in">enum</span> StorageType</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> å…¬å…±å­˜å‚¨ç±»å‹ï¼Œé€šå¸¸ç”¨äºæ™®é€šæ–‡ä»¶è®¿é—®ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    Public,</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> å¤‡ä»½å­˜å‚¨ç±»å‹ï¼Œé€šå¸¸ç”¨äºæ–‡ä»¶å¤‡ä»½ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    Backup,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ï¼Œå®šä¹‰ä¸€ä¸ªä»“å‚¨æ¥å£IFSRepository.</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IFSRepository</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æŸ¥æ‰¾å·²ç»ä¸Šä¼ çš„ç›¸åŒå¤§å°ä»¥åŠæ•£åˆ—å€¼çš„æ–‡ä»¶è®°å½•</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;fileSize&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sha256Hash&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    Task&lt;UploadedItem?&gt; FindFileAsync(<span class="built_in">long</span> fileSize, <span class="built_in">string</span> sha256Hash);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>IFSRepositoryæ¥å£çš„FindFileAsyncæ–¹æ³•ç”¨æ¥æŸ¥æ‰¾æ–‡ä»¶å¤§å°ä¸ºfileSizeå¹¶ä¸”æ–‡ä»¶çš„å“ˆå¸Œå€¼ä¸ºsha256Hashçš„ä¸Šä¼ è®°å½•ã€‚</p><p>æœ€åï¼Œå¼€å‘æ–‡ä»¶æœåŠ¡çš„é¢†åŸŸæœåŠ¡FSDomainService.</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">FileSevice.Domain</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">FSDomainService</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// æ–‡ä»¶ä»“å‚¨æ¥å£ï¼Œç”¨äºæŸ¥æ‰¾å’Œç®¡ç†æ–‡ä»¶è®°å½•</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> IFSRepository repository;</span><br><span class="line">        <span class="comment">// å¤‡ä»½å­˜å‚¨å®¢æˆ·ç«¯ï¼Œç”¨äºä¿å­˜æ–‡ä»¶åˆ°å¤‡ä»½å­˜å‚¨</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> IStorageClient backupStorage;</span><br><span class="line">        <span class="comment">// è¿œç¨‹å­˜å‚¨å®¢æˆ·ç«¯ï¼Œç”¨äºä¿å­˜æ–‡ä»¶åˆ°å…¬å…±å­˜å‚¨</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> IStorageClient remoteStorage;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ„é€ å‡½æ•°ï¼Œåˆå§‹åŒ–ä»“å‚¨å’Œå­˜å‚¨å®¢æˆ·ç«¯</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">FSDomainService</span>(<span class="params">IFSRepository repository, IEnumerable&lt;IStorageClient&gt; storageClients</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// èµ‹å€¼æ–‡ä»¶ä»“å‚¨æ¥å£</span></span><br><span class="line">            <span class="keyword">this</span>.repository = repository;</span><br><span class="line">            <span class="comment">// è·å–å¤‡ä»½å­˜å‚¨å®¢æˆ·ç«¯ï¼ˆæ ¹æ®å­˜å‚¨ç±»å‹ç­›é€‰ï¼‰</span></span><br><span class="line">            <span class="keyword">this</span>.backupStorage = storageClients.First(c =&gt; c.StorageType == StorageType.Backup);</span><br><span class="line">            <span class="comment">// è·å–è¿œç¨‹å­˜å‚¨å®¢æˆ·ç«¯ï¼ˆæ ¹æ®å­˜å‚¨ç±»å‹ç­›é€‰ï¼‰</span></span><br><span class="line">            <span class="keyword">this</span>.remoteStorage = storageClients.First(c =&gt; c.StorageType == StorageType.Public);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¼‚æ­¥ä¸Šä¼ æ–‡ä»¶æ–¹æ³•</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;UploadedItem&gt; <span class="title">UploadAsync</span>(<span class="params">Stream stream, <span class="built_in">string</span> fileName, CancellationToken cancellationToken</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// è®¡ç®—æ–‡ä»¶æµçš„SHA256å“ˆå¸Œå€¼</span></span><br><span class="line">            <span class="built_in">string</span> hash = HashHelper.ComputeSha256Hash(stream);</span><br><span class="line">            <span class="comment">// è·å–æ–‡ä»¶æµçš„é•¿åº¦ï¼ˆå­—èŠ‚æ•°ï¼‰</span></span><br><span class="line">            <span class="built_in">long</span> fileSize = stream.Length;</span><br><span class="line">            <span class="comment">// è·å–å½“å‰æ—¥æœŸ</span></span><br><span class="line">            DateTime today = DateTime.Today;</span><br><span class="line">            <span class="comment">// æ„é€ æ–‡ä»¶å­˜å‚¨çš„å”¯ä¸€é”®ï¼ˆåŒ…å«æ—¥æœŸã€å“ˆå¸Œå’Œæ–‡ä»¶åï¼‰</span></span><br><span class="line">            <span class="built_in">string</span> key = <span class="string">$&quot;<span class="subst">&#123;today.Year&#125;</span>/<span class="subst">&#123;today.Month&#125;</span>/<span class="subst">&#123;today.Day&#125;</span>/<span class="subst">&#123;hash&#125;</span>/<span class="subst">&#123;fileName&#125;</span>&quot;</span>;</span><br><span class="line">            <span class="comment">// æŸ¥è¯¢æ˜¯å¦å·²å­˜åœ¨ç›¸åŒå¤§å°å’Œå“ˆå¸Œçš„æ–‡ä»¶</span></span><br><span class="line">            <span class="keyword">var</span> oldUploadedItem = <span class="keyword">await</span> repository.FindFileAsync(fileSize, hash);</span><br><span class="line">            <span class="comment">// å¦‚æœå·²å­˜åœ¨åˆ™ç›´æ¥è¿”å›æ—§çš„æ–‡ä»¶é¡¹</span></span><br><span class="line">            <span class="keyword">if</span> (oldUploadedItem != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> oldUploadedItem;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// ä¿å­˜æ–‡ä»¶åˆ°å¤‡ä»½å­˜å‚¨ï¼Œå¹¶è·å–å¤‡ä»½åœ°å€</span></span><br><span class="line">            Uri backupUrl = <span class="keyword">await</span> backupStorage.SaveAsync(key, stream, cancellationToken);</span><br><span class="line">            <span class="comment">// é‡ç½®æµä½ç½®ï¼Œç¡®ä¿ä¸‹æ¬¡è¯»å–ä»å¤´å¼€å§‹</span></span><br><span class="line">            stream.Position = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">// ä¿å­˜æ–‡ä»¶åˆ°è¿œç¨‹å­˜å‚¨ï¼Œå¹¶è·å–è¿œç¨‹è®¿é—®åœ°å€</span></span><br><span class="line">            Uri remoteUrl = <span class="keyword">await</span> remoteStorage.SaveAsync(key, stream, cancellationToken);</span><br><span class="line">            <span class="comment">// å†æ¬¡é‡ç½®æµä½ç½®</span></span><br><span class="line">            stream.Position = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">// ç”Ÿæˆæ–°çš„å”¯ä¸€æ ‡è¯†</span></span><br><span class="line">            Guid id = Guid.NewGuid();</span><br><span class="line">            <span class="comment">// åˆ›å»ºå¹¶è¿”å›æ–°çš„å·²ä¸Šä¼ æ–‡ä»¶é¡¹</span></span><br><span class="line">            <span class="keyword">return</span> UploadedItem.Create(id, fileSize, fileName, hash, backupUrl, remoteUrl);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­æä¾›äº†è‡ªå®šä¹‰å¸¸ç”¨çš„å“ˆå¸Œè®¡ç®—æ–¹æ³•</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">YU.Commons</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æä¾›å¸¸ç”¨çš„å“ˆå¸Œè®¡ç®—æ–¹æ³•ï¼ˆSHA256ã€MD5ï¼‰ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">HashHelper</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å°†å­—èŠ‚æ•°ç»„è½¬æ¢ä¸ºåå…­è¿›åˆ¶å­—ç¬¦ä¸²ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;bytes&quot;&gt;</span>è¦è½¬æ¢çš„å­—èŠ‚æ•°ç»„ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>åå…­è¿›åˆ¶å­—ç¬¦ä¸²ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ToHashString</span>(<span class="params"><span class="built_in">byte</span>[] bytes</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            StringBuilder builder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; bytes.Length; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                builder.Append(bytes[i].ToString(<span class="string">&quot;x2&quot;</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> builder.ToString();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> è®¡ç®—æµçš„ SHA256 å“ˆå¸Œå€¼ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;stream&quot;&gt;</span>è¾“å…¥æµã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>SHA256 å“ˆå¸Œå­—ç¬¦ä¸²ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ComputeSha256Hash</span>(<span class="params">Stream stream</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">using</span> (SHA256 sha256Hash = SHA256.Create())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">byte</span>[] bytes = sha256Hash.ComputeHash(stream);</span><br><span class="line">                <span class="keyword">return</span> ToHashString(bytes);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> è®¡ç®—å­—ç¬¦ä¸²çš„ SHA256 å“ˆå¸Œå€¼ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;input&quot;&gt;</span>è¾“å…¥å­—ç¬¦ä¸²ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>SHA256 å“ˆå¸Œå­—ç¬¦ä¸²ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ComputeSha256Hash</span>(<span class="params"><span class="built_in">string</span> input</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">using</span> (SHA256 sha256Hash = SHA256.Create())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">byte</span>[] bytes = sha256Hash.ComputeHash(Encoding.UTF8.GetBytes(input));</span><br><span class="line">                <span class="keyword">return</span> ToHashString(bytes);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> è®¡ç®—å­—ç¬¦ä¸²çš„ MD5 å“ˆå¸Œå€¼ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;input&quot;&gt;</span>è¾“å…¥å­—ç¬¦ä¸²ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>MD5 å“ˆå¸Œå­—ç¬¦ä¸²ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ComputeMd5Hash</span>(<span class="params"><span class="built_in">string</span> input</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">using</span> (MD5 md5Hash = MD5.Create())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">byte</span>[] bytes = md5Hash.ComputeHash(Encoding.UTF8.GetBytes(input));</span><br><span class="line">                <span class="keyword">return</span> ToHashString(bytes);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> è®¡ç®—æµçš„ MD5 å“ˆå¸Œå€¼ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;input&quot;&gt;</span>è¾“å…¥æµã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>MD5 å“ˆå¸Œå­—ç¬¦ä¸²ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ComputeMd5Hash</span>(<span class="params">Stream input</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">using</span> (MD5 md5Hash = MD5.Create())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">byte</span>[] bytes = md5Hash.ComputeHash(input);</span><br><span class="line">                <span class="keyword">return</span> ToHashString(bytes);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å¼€å‘æ–‡ä»¶æœåŠ¡çš„åŸºç¡€è®¾æ–½å±‚"><a href="#å¼€å‘æ–‡ä»¶æœåŠ¡çš„åŸºç¡€è®¾æ–½å±‚" class="headerlink" title="å¼€å‘æ–‡ä»¶æœåŠ¡çš„åŸºç¡€è®¾æ–½å±‚"></a>å¼€å‘æ–‡ä»¶æœåŠ¡çš„åŸºç¡€è®¾æ–½å±‚</h1><p>UploadedItemå®ä½“ç±»é‡‡ç”¨Guidç±»å‹çš„ä¸»é”®ï¼ŒGuidç±»å‹çš„ä¸»é”®æœ‰å¾ˆå¤šä¼˜ç‚¹ï¼Œä½†æ˜¯ä¹Ÿæœ‰èšé›†ç´¢å¼•é€ æˆçš„æ•°æ®æ’å…¥æ—¶çš„æ€§èƒ½é—®é¢˜ï¼Œæˆ‘ä»¬é‡‡ç”¨çš„æ˜¯SQLServeræ•°æ®åº“ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å–æ¶ˆIdä¸»é”®çš„èšé›†ç´¢å¼•ï¼›ç”±äºæˆ‘ä»¬æ¯æ¬¡ä¸Šä¼ éƒ½è¦æŒ‰ç…§æ–‡ä»¶çš„å¤§å°å’Œå“ˆå¸Œå€¼æ¥æŸ¥æ‰¾å†å²è®°å½•ï¼Œå› æ­¤æˆ‘ä»¬è®¾ç½®FileSHA256Hashå’ŒFileSizeBytesç»„æˆå¤åˆç´¢å¼•ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// UploadedItemConfig ç”¨äºé…ç½® UploadedItem å®ä½“åœ¨æ•°æ®åº“ä¸­çš„æ˜ å°„æ–¹å¼ã€‚</span></span><br><span class="line"><span class="keyword">class</span> <span class="title">UploadedItemConfig</span> : <span class="title">IEntityTypeConfiguration</span>&lt;<span class="title">UploadedItem</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Configure æ–¹æ³•å®šä¹‰äº† UploadedItem å®ä½“çš„å…·ä½“æ˜ å°„è§„åˆ™ã€‚</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">EntityTypeBuilder&lt;UploadedItem&gt; builder</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// è®¾ç½®è¡¨åä¸º T_FS_UploadedItemsã€‚</span></span><br><span class="line">        builder.ToTable(<span class="string">&quot;T_FS_UploadedItems&quot;</span>);</span><br><span class="line">        <span class="comment">// è®¾ç½®ä¸»é”®ä¸º Idï¼Œå¹¶ä¸”ä¸ä½¿ç”¨èšé›†ç´¢å¼•ã€‚</span></span><br><span class="line">        builder.HasKey(e =&gt; e.Id).IsClustered(<span class="literal">false</span>);</span><br><span class="line">        <span class="comment">// é…ç½® FileName å­—æ®µä¸º Unicode å­—ç¬¦ä¸²ï¼Œæœ€å¤§é•¿åº¦ 1024ã€‚</span></span><br><span class="line">        builder.Property(e =&gt; e.FileName).IsUnicode().HasMaxLength(<span class="number">1024</span>);</span><br><span class="line">        <span class="comment">// é…ç½® FileSHA256Hash å­—æ®µä¸ºé Unicode å­—ç¬¦ä¸²ï¼Œæœ€å¤§é•¿åº¦ 64ã€‚</span></span><br><span class="line">        builder.Property(e =&gt; e.FileSHA256Hash).IsUnicode(<span class="literal">false</span>).HasMaxLength(<span class="number">64</span>);</span><br><span class="line">        <span class="comment">// ä¸º FileSHA256Hash å’Œ FileSizeInBytes åˆ›å»ºè”åˆç´¢å¼•ï¼ŒåŠ å¿«æŸ¥è¯¢é€Ÿåº¦ã€‚</span></span><br><span class="line">        builder.HasIndex(e =&gt; <span class="keyword">new</span> &#123; e.FileSHA256Hash, e.FileSizeInBytes &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨IStorageClientæ¥å£çš„å®ç°ç±»MockCloudStorageClientï¼Œä»–ä¼šæŠŠæ–‡ä»¶æœåŠ¡å™¨å½“æˆä¸€ä¸ªäº‘å­˜å‚¨æœåŠ¡å™¨ã€‚å½“ç„¶è¿™ä»…ä¾›å¼€å‘ã€æ¼”ç¤ºé˜¶æ®µä½¿ç”¨ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä¸€å®šç”¨ä¸“é—¨çš„äº‘å­˜å‚¨æœåŠ¡å™¨æ¥ä»£æ›¿ã€‚</p><!-- é€šè¿‡ SMB åè®®æŒ‚è½½/æ˜ å°„åˆ°æœ¬åœ°æ“ä½œç³»ç»Ÿï¼Œç„¶åç¨‹åºç…§å¸¸ç”¨ æ ‡å‡†çš„æ–‡ä»¶ APIï¼ˆå¦‚ FileStreamã€File.Openã€File.ReadAllTextã€Directory.GetFiles ç­‰ï¼‰å»è®¿é—®ï¼Œå°±åƒæ“ä½œæœ¬åœ°ç£ç›˜ä¸€æ ·ã€‚<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> SMB å­˜å‚¨å®¢æˆ·ç«¯ï¼Œå®ç°æ–‡ä»¶çš„ä¿å­˜åŠŸèƒ½ã€‚</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">class</span> <span class="title">SMBStorageClient</span> : <span class="title">IStorageClient</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> SMB å­˜å‚¨é…ç½®é€‰é¡¹ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">private</span> IOptionsSnapshot&lt;SMBStorageOptions&gt; options;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æ„é€ æ–¹æ³•ï¼Œæ³¨å…¥ SMB å­˜å‚¨é…ç½®ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;options&quot;&gt;</span>SMB å­˜å‚¨é…ç½®å¿«ç…§ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SMBStorageClient</span>(<span class="params">IOptionsSnapshot&lt;SMBStorageOptions&gt; options</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.options = options;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> è·å–å­˜å‚¨ç±»å‹ï¼Œè¿™é‡Œä¸ºå¤‡ä»½ç±»å‹ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> StorageType StorageType =&gt; StorageType.Backup;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> å¼‚æ­¥ä¿å­˜æ–‡ä»¶åˆ° SMB å­˜å‚¨ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;key&quot;&gt;</span>æ–‡ä»¶çš„å”¯ä¸€æ ‡è¯†ï¼ˆä¸èƒ½ä»¥ / å¼€å¤´ï¼‰ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;content&quot;&gt;</span>æ–‡ä»¶å†…å®¹æµã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;cancellationToken&quot;&gt;</span>å–æ¶ˆæ“ä½œçš„ä»¤ç‰Œã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>è¿”å›æ–‡ä»¶çš„æœ¬åœ°è®¿é—® Uriã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;exception cref=&quot;ArgumentException&quot;&gt;</span>å½“ key ä»¥ / å¼€å¤´æ—¶æŠ›å‡ºå¼‚å¸¸ã€‚<span class="doctag">&lt;/exception&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;Uri&gt; <span class="title">SaveAsync</span>(<span class="params"><span class="built_in">string</span> key, Stream content, CancellationToken cancellationToken = <span class="literal">default</span></span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// æ£€æŸ¥ key æ˜¯å¦ä»¥ / å¼€å¤´ï¼Œé˜²æ­¢è·¯å¾„é”™è¯¯</span></span><br><span class="line">        <span class="keyword">if</span> (key.StartsWith(<span class="string">&quot;/&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;key should not start with /&quot;</span>, <span class="keyword">nameof</span>(key));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è·å–å·¥ä½œç›®å½•</span></span><br><span class="line">        <span class="built_in">string</span> workingDir = options.Value.WorkingDir;</span><br><span class="line">        <span class="comment">// æ‹¼æ¥å®Œæ•´æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">        <span class="built_in">string</span> fullPath = Path.Combine(workingDir, key);</span><br><span class="line">        <span class="comment">// è·å–æ–‡ä»¶æ‰€åœ¨ç›®å½•</span></span><br><span class="line">        <span class="built_in">string</span>? fullDir = Path.GetDirectoryName(fullPath);</span><br><span class="line">        <span class="comment">// å¦‚æœç›®å½•ä¸å­˜åœ¨åˆ™åˆ›å»º</span></span><br><span class="line">        <span class="keyword">if</span> (!Directory.Exists(fullDir))</span><br><span class="line">        &#123;</span><br><span class="line">            Directory.CreateDirectory(fullDir!);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¦‚æœæ–‡ä»¶å·²å­˜åœ¨åˆ™å…ˆåˆ é™¤</span></span><br><span class="line">        <span class="keyword">if</span> (File.Exists(fullPath))</span><br><span class="line">        &#123;</span><br><span class="line">            File.Delete(fullPath);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å†™å…¥æ–‡ä»¶å†…å®¹</span></span><br><span class="line">        <span class="keyword">using</span> Stream outStream = File.OpenWrite(fullPath);</span><br><span class="line">        <span class="keyword">await</span> content.CopyToAsync(outStream, cancellationToken);</span><br><span class="line">        <span class="comment">// è¿”å›æ–‡ä»¶çš„æœ¬åœ° Uri</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Uri(fullPath);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// SMBStorageOptions ç±»ç”¨äºé…ç½® SMB å­˜å‚¨ç›¸å…³çš„é€‰é¡¹ã€‚</span></span><br><span class="line"><span class="comment">// ç›®å‰åªåŒ…å«ä¸€ä¸ªå±æ€§ WorkingDirï¼Œç”¨äºæŒ‡å®šæ–‡ä»¶æ“ä½œçš„å·¥ä½œç›®å½•ã€‚</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">SMBStorageOptions</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// å·¥ä½œç›®å½•è·¯å¾„ï¼Œè¡¨ç¤ºæ–‡ä»¶å­˜å‚¨å’Œæ“ä½œçš„æ ¹ç›®å½•ã€‚</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> WorkingDir &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>UpYunStorageClientæ˜¯é€‚é…â€œåˆæ‹äº‘â€äº‘å­˜å‚¨å¹¿å•†çš„IStorageClientæ¥å£çš„å®ç°ç±»ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> åˆæ‹äº‘å­˜å‚¨å®¢æˆ·ç«¯ï¼Œå®ç° IStorageClient æ¥å£ã€‚</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> ç”¨äºå°†æ–‡ä»¶ä¿å­˜åˆ°åˆæ‹äº‘ï¼Œå¹¶è¿”å›æ–‡ä»¶çš„è®¿é—®åœ°å€ã€‚</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">class</span> <span class="title">UpYunStorageClient</span> : <span class="title">IStorageClient</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// åˆæ‹äº‘å­˜å‚¨ç›¸å…³é…ç½®ï¼ˆå¦‚ Bucketã€ç”¨æˆ·åã€å¯†ç ç­‰ï¼‰</span></span><br><span class="line">    <span class="keyword">private</span> IOptionsSnapshot&lt;UpYunStorageOptions&gt; options;</span><br><span class="line">    <span class="comment">// ç”¨äºåˆ›å»º HttpClient å®ä¾‹ï¼Œä¾¿äºç½‘ç»œè¯·æ±‚</span></span><br><span class="line">    <span class="keyword">private</span> IHttpClientFactory httpClientFactory;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æ„é€ æ–¹æ³•ï¼Œåˆå§‹åŒ–åˆæ‹äº‘å­˜å‚¨å®¢æˆ·ç«¯ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;bucketName&quot;&gt;</span>å­˜å‚¨ç©ºé—´åç§°ï¼ˆBucketï¼‰<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;options&quot;&gt;</span>åˆæ‹äº‘ç›¸å…³é…ç½®<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;httpClientFactory&quot;&gt;</span>HttpClient å·¥å‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UpYunStorageClient</span>(<span class="params"><span class="built_in">string</span> bucketName, IOptionsSnapshot&lt;UpYunStorageOptions&gt; options, IHttpClientFactory httpClientFactory</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.options = options;</span><br><span class="line">        <span class="keyword">this</span>.httpClientFactory = httpClientFactory;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> å­˜å‚¨ç±»å‹ï¼Œè¿™é‡Œå›ºå®šä¸º Publicï¼ˆå…¬å¼€å­˜å‚¨ï¼‰ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> StorageType StorageType =&gt; StorageType.Public;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æ‹¼æ¥ URL è·¯å¾„ï¼Œè‡ªåŠ¨å»é™¤æ¯æ®µçš„æ–œæ ï¼Œå¹¶æ ¡éªŒä¸èƒ½åŒ…å« &quot;..&quot;ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;segments&quot;&gt;</span>è·¯å¾„çš„å„ä¸ªéƒ¨åˆ†<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>æ‹¼æ¥åçš„å®Œæ•´è·¯å¾„<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="built_in">string</span> <span class="title">ConcatUrl</span>(<span class="params"><span class="keyword">params</span> <span class="built_in">string</span>[] segments</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; segments.Length; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> s = segments[i];</span><br><span class="line">            <span class="keyword">if</span> (s.Contains(<span class="string">&quot;..&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;è·¯å¾„æ®µä¸èƒ½åŒ…å« ..&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            segments[i] = s.Trim(<span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">string</span>.Join(<span class="string">&quot;/&quot;</span>, segments);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> å¼‚æ­¥ä¿å­˜æ–‡ä»¶åˆ°åˆæ‹äº‘ï¼Œå¹¶è¿”å›æ–‡ä»¶çš„è®¿é—®åœ°å€ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;key&quot;&gt;</span>æ–‡ä»¶çš„å”¯ä¸€æ ‡è¯†ï¼ˆä¸èƒ½ä»¥ / å¼€å¤´ï¼‰<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;content&quot;&gt;</span>æ–‡ä»¶å†…å®¹æµ<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;cancellationToken&quot;&gt;</span>å–æ¶ˆæ“ä½œçš„ä»¤ç‰Œ<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>æ–‡ä»¶çš„è®¿é—® Uri<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;exception cref=&quot;ArgumentException&quot;&gt;</span>key æˆ– content ä¸åˆæ³•æ—¶æŠ›å‡º<span class="doctag">&lt;/exception&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;exception cref=&quot;Exception&quot;&gt;</span>ä¸Šä¼ å¤±è´¥æ—¶æŠ›å‡º<span class="doctag">&lt;/exception&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;Uri&gt; <span class="title">SaveAsync</span>(<span class="params"><span class="built_in">string</span> key, Stream content, CancellationToken cancellationToken = <span class="literal">default</span></span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// æ ¡éªŒ key ä¸èƒ½ä»¥ / å¼€å¤´</span></span><br><span class="line">        <span class="keyword">if</span> (key.StartsWith(<span class="string">&quot;/&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;key should not start with /&quot;</span>, <span class="keyword">nameof</span>(key));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å°†æµå†…å®¹è½¬ä¸ºå­—èŠ‚æ•°ç»„</span></span><br><span class="line">        <span class="built_in">byte</span>[] bytes = content.ToArray();</span><br><span class="line">        <span class="comment">// æ ¡éªŒå†…å®¹ä¸èƒ½ä¸ºç©º</span></span><br><span class="line">        <span class="keyword">if</span> (bytes.Length == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;content is empty&quot;</span>, <span class="keyword">nameof</span>(content));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è·å–åˆæ‹äº‘ç›¸å…³é…ç½®</span></span><br><span class="line">        <span class="built_in">string</span> bucketName = options.Value.BucketName;</span><br><span class="line">        <span class="built_in">string</span> userName = options.Value.UserName;</span><br><span class="line">        <span class="built_in">string</span> password = options.Value.Password;</span><br><span class="line">        <span class="built_in">string</span> pathRoot = options.Value.WorkingDir;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ‹¼æ¥æ–‡ä»¶è®¿é—® URL</span></span><br><span class="line">        <span class="built_in">string</span> url = ConcatUrl(options.Value.UrlRoot, pathRoot, key);</span><br><span class="line">        <span class="comment">// æ‹¼æ¥åˆæ‹äº‘å­˜å‚¨è·¯å¾„</span></span><br><span class="line">        <span class="built_in">string</span> fullPath = <span class="string">&quot;/&quot;</span> + ConcatUrl(pathRoot, key);</span><br><span class="line">        <span class="comment">// åˆ›å»ºåˆæ‹äº‘å®¢æˆ·ç«¯</span></span><br><span class="line">        UpYunClient upyun = <span class="keyword">new</span> UpYunClient(bucketName, userName, password, httpClientFactory);</span><br><span class="line">        <span class="comment">// ä¸Šä¼ æ–‡ä»¶åˆ°åˆæ‹äº‘</span></span><br><span class="line">        <span class="keyword">var</span> upyunResult = <span class="keyword">await</span> upyun.WriteFileAsync(fullPath, bytes, <span class="literal">true</span>, cancellationToken);</span><br><span class="line">        <span class="comment">// åˆ¤æ–­ä¸Šä¼ ç»“æœ</span></span><br><span class="line">        <span class="keyword">if</span> (upyunResult.IsOK == <span class="literal">false</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">$&quot;ä¸Šä¼ åˆæ‹äº‘å¤±è´¥ï¼ŒçŠ¶æ€ç ï¼š<span class="subst">&#123;upyunResult.StatusCode&#125;</span>ï¼Œä¿¡æ¯ï¼š<span class="subst">&#123;upyunResult.Message&#125;</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è¿”å›æ–‡ä»¶çš„è®¿é—®åœ°å€</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Uri(url);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UpYunStorageOptions</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> åˆæ‹äº‘ç©ºé—´åç§°ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> BucketName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> åˆæ‹äº‘æ“ä½œç”¨æˆ·åã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> UserName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> åˆæ‹äº‘æ“ä½œå¯†ç ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Password &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> åˆæ‹äº‘å·¥ä½œç›®å½•ï¼ˆæ–‡ä»¶ä¸Šä¼ çš„é»˜è®¤ç›®å½•ï¼‰ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> WorkingDir &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> åˆæ‹äº‘æ–‡ä»¶è®¿é—®çš„æ ¹åœ°å€ï¼ˆç”¨äºæ‹¼æ¥æ–‡ä»¶è®¿é—® URLï¼‰ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> UrlRoot &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> ä¸Šä¼ ç»“æœå°è£…</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UpYunResult</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">bool</span> IsOK &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> StatusCode &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Message &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Path &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Url &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UpYunClient</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> UpYunStorageOptions _options;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> HttpClient _httpClient;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UpYunClient</span>(<span class="params"><span class="built_in">string</span> bucketName, <span class="built_in">string</span> userName, <span class="built_in">string</span> password, IHttpClientFactory httpClientFactory</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _options = <span class="keyword">new</span> UpYunStorageOptions</span><br><span class="line">        &#123;</span><br><span class="line">            BucketName = bucketName,</span><br><span class="line">            UserName = userName,</span><br><span class="line">            Password = password,</span><br><span class="line">            WorkingDir = <span class="string">&quot;/&quot;</span></span><br><span class="line">        &#125;;</span><br><span class="line">        _httpClient = httpClientFactory.CreateClient();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ä¸Šä¼ æ–‡ä»¶</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;UpYunResult&gt; <span class="title">WriteFileAsync</span>(<span class="params"><span class="built_in">string</span> path, <span class="built_in">byte</span>[] bytes, <span class="built_in">bool</span> autoCreateDirectory = <span class="literal">true</span>, CancellationToken cancellationToken = <span class="literal">default</span></span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrWhiteSpace(path))</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;path cannot be empty&quot;</span>, <span class="keyword">nameof</span>(path));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!path.StartsWith(<span class="string">&quot;/&quot;</span>)) path = <span class="string">&quot;/&quot;</span> + path;</span><br><span class="line">        <span class="keyword">var</span> fullPath = (_options.WorkingDir?.TrimEnd(<span class="string">&#x27;/&#x27;</span>) ?? <span class="string">&quot;&quot;</span>) + path;</span><br><span class="line">        <span class="keyword">var</span> url = (_options.UrlRoot?.TrimEnd(<span class="string">&#x27;/&#x27;</span>) ?? <span class="string">$&quot;https://<span class="subst">&#123;_options.BucketName&#125;</span>.b0.upaiyun.com&quot;</span>) + fullPath;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">using</span> <span class="keyword">var</span> content = <span class="keyword">new</span> ByteArrayContent(bytes);</span><br><span class="line">        content.Headers.ContentType = <span class="keyword">new</span> MediaTypeHeaderValue(<span class="string">&quot;application/octet-stream&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> auth = Convert.ToBase64String(Encoding.UTF8.GetBytes(<span class="string">$&quot;<span class="subst">&#123;_options.UserName&#125;</span>:<span class="subst">&#123;_options.Password&#125;</span>&quot;</span>));</span><br><span class="line">        _httpClient.DefaultRequestHeaders.Authorization = <span class="keyword">new</span> AuthenticationHeaderValue(<span class="string">&quot;Basic&quot;</span>, auth);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> response = <span class="keyword">await</span> _httpClient.PutAsync(<span class="string">$&quot;http://<span class="subst">&#123;_options.BucketName&#125;</span>.b0.upaiyun.com<span class="subst">&#123;fullPath&#125;</span>&quot;</span>, content, cancellationToken);</span><br><span class="line">            <span class="keyword">var</span> result = <span class="keyword">new</span> UpYunResult</span><br><span class="line">            &#123;</span><br><span class="line">                StatusCode = (<span class="built_in">int</span>)response.StatusCode,</span><br><span class="line">                IsOK = response.IsSuccessStatusCode,</span><br><span class="line">                Message = response.IsSuccessStatusCode ? <span class="string">&quot;ä¸Šä¼ æˆåŠŸ&quot;</span> : <span class="keyword">await</span> response.Content.ReadAsStringAsync(),</span><br><span class="line">                Path = fullPath,</span><br><span class="line">                Url = url</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> UpYunResult</span><br><span class="line">            &#123;</span><br><span class="line">                IsOK = <span class="literal">false</span>,</span><br><span class="line">                StatusCode = <span class="number">0</span>,</span><br><span class="line">                Message = ex.Message,</span><br><span class="line">                Path = fullPath,</span><br><span class="line">                Url = url</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">``` --&gt;</span><br><span class="line"></span><br><span class="line">```csharp</span><br><span class="line">    <span class="keyword">class</span> <span class="title">MockCloudStorageClient</span> : <span class="title">IStorageClient</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å­˜å‚¨ç±»å‹ï¼Œå›ºå®šä¸ºå…¬å…±å­˜å‚¨ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> StorageType StorageType =&gt; StorageType.Public;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ç”¨äºè·å–åº”ç”¨æ ¹ç›®å½•ç¯å¢ƒä¿¡æ¯ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> IWebHostEnvironment hostEnv;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ç”¨äºè·å–å½“å‰ HTTP è¯·æ±‚ä¸Šä¸‹æ–‡ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> IHttpContextAccessor httpContextAccessor;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ„é€ å‡½æ•°ï¼Œæ³¨å…¥ç¯å¢ƒå’Œ HTTP ä¸Šä¸‹æ–‡è®¿é—®å™¨ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;hostEnv&quot;&gt;</span>ä¸»æœºç¯å¢ƒä¿¡æ¯ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;httpContextAccessor&quot;&gt;</span>HTTP ä¸Šä¸‹æ–‡è®¿é—®å™¨ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">MockCloudStorageClient</span>(<span class="params">IWebHostEnvironment hostEnv, IHttpContextAccessor httpContextAccessor</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.hostEnv = hostEnv;</span><br><span class="line">            <span class="keyword">this</span>.httpContextAccessor = httpContextAccessor;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å¼‚æ­¥ä¿å­˜æ–‡ä»¶åˆ°æœ¬åœ° wwwroot ç›®å½•ï¼Œå¹¶è¿”å›å¯è®¿é—®çš„ URLã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;key&quot;&gt;</span>æ–‡ä»¶åæˆ–è·¯å¾„ï¼ˆä¸èƒ½ä»¥ / å¼€å¤´ï¼‰ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;content&quot;&gt;</span>æ–‡ä»¶å†…å®¹æµã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;cancellationToken&quot;&gt;</span>å–æ¶ˆä»¤ç‰Œã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>æ–‡ä»¶çš„è®¿é—®åœ°å€ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;Uri&gt; <span class="title">SaveAsync</span>(<span class="params"><span class="built_in">string</span> key, Stream content, CancellationToken cancellationToken = <span class="literal">default</span></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// æ£€æŸ¥ key æ˜¯å¦ä»¥ / å¼€å¤´ï¼Œè‹¥æ˜¯åˆ™æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">            <span class="keyword">if</span> (key.StartsWith(<span class="string">&quot;/&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;key should not start with /&quot;</span>, <span class="keyword">nameof</span>(key));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ‹¼æ¥æœ¬åœ°ä¿å­˜è·¯å¾„</span></span><br><span class="line">            <span class="built_in">string</span> workingDir = Path.Combine(hostEnv.ContentRootPath, <span class="string">&quot;wwwroot&quot;</span>);</span><br><span class="line">            <span class="built_in">string</span> fullPath = Path.Combine(workingDir, key);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// è·å–æ–‡ä»¶æ‰€åœ¨ç›®å½•ï¼Œå¹¶ç¡®ä¿ç›®å½•å­˜åœ¨</span></span><br><span class="line">            <span class="built_in">string</span>? fullDir = Path.GetDirectoryName(fullPath);</span><br><span class="line">            <span class="keyword">if</span> (!Directory.Exists(fullDir))</span><br><span class="line">            &#123;</span><br><span class="line">                Directory.CreateDirectory(fullDir!);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å¦‚æœæ–‡ä»¶å·²å­˜åœ¨åˆ™å…ˆåˆ é™¤</span></span><br><span class="line">            <span class="keyword">if</span> (File.Exists(fullPath))</span><br><span class="line">            &#123;</span><br><span class="line">                File.Delete(fullPath);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å°†å†…å®¹å†™å…¥æœ¬åœ°æ–‡ä»¶</span></span><br><span class="line">            <span class="keyword">using</span> Stream outStream = File.OpenWrite(fullPath);</span><br><span class="line">            <span class="keyword">await</span> content.CopyToAsync(outStream, cancellationToken);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// ç”Ÿæˆæ–‡ä»¶çš„è®¿é—® URL</span></span><br><span class="line">            <span class="keyword">var</span> req = httpContextAccessor.HttpContext.Request;</span><br><span class="line">            <span class="built_in">string</span> url = req.Scheme + <span class="string">&quot;://&quot;</span> + req.Host + <span class="string">&quot;/FileService/&quot;</span> + key;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Uri(url);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç¼–å†™IFSRepositoryçš„ä»“å‚¨å®ç°ç±»FSRepositoryã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> æ–‡ä»¶æœåŠ¡ä»“å‚¨å®ç°ï¼Œè´Ÿè´£æ–‡ä»¶ç›¸å…³çš„æ•°æ®è®¿é—®æ“ä½œã€‚</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">class</span> <span class="title">FSRepository</span> : <span class="title">IFSRepository</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> FSDbContext dbContext;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> åˆå§‹åŒ– <span class="doctag">&lt;see cref=&quot;FSRepository&quot;/&gt;</span> å®ä¾‹ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dbContext&quot;&gt;</span>æ–‡ä»¶æœåŠ¡æ•°æ®åº“ä¸Šä¸‹æ–‡ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FSRepository</span>(<span class="params">FSDbContext dbContext</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.dbContext = dbContext;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æ ¹æ®æ–‡ä»¶å¤§å°å’ŒSHA256å“ˆå¸Œå€¼æŸ¥æ‰¾å·²ä¸Šä¼ çš„æ–‡ä»¶é¡¹ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;fileSize&quot;&gt;</span>æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;sha256Hash&quot;&gt;</span>æ–‡ä»¶çš„SHA256å“ˆå¸Œå€¼ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>åŒ¹é…çš„ <span class="doctag">&lt;see cref=&quot;UploadedItem&quot;/&gt;</span>ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è¿”å› nullã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> Task&lt;UploadedItem?&gt; FindFileAsync(<span class="built_in">long</span> fileSize, <span class="built_in">string</span> sha256Hash)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> dbContext.UploadedItems.FirstOrDefaultAsync(u =&gt; u.FileSizeInBytes == fileSize &amp;&amp; u.FileSHA256Hash == sha256Hash);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸¤ä¸ªæ–‡ä»¶å¤§å°ç›¸åŒå¹¶ä¸”æ–‡ä»¶å“ˆå¸Œå€¼ç›¸åŒï¼Œæˆ‘ä»¬å°±è®¤ä¸ºå®ƒä»¬æ˜¯ç›¸åŒçš„æ–‡ä»¶ï¼Œå› æ­¤æˆ‘ä»¬ç”¨æ–‡ä»¶çš„å¤§å°å’Œå“ˆå¸Œå€¼ä¸€èµ·æ¥åŒ¹é…å†å²è®°å½•ã€‚</p><p>æœ€åæˆ‘ä»¬åœ¨é¡¹ç›®çš„ModuleInitializerä¸­æŠŠåŸºç¡€è®¾æ–½ä¸­çš„æœåŠ¡æ³¨å†Œåˆ°ä¾èµ–æ³¨å…¥å®¹å™¨ä¸­ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> æ¨¡å—åˆå§‹åŒ–å™¨ï¼Œå®ç° <span class="doctag">&lt;see cref=&quot;IModuleInitializer&quot;/&gt;</span> æ¥å£ï¼Œ</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> ç”¨äºåœ¨åº”ç”¨å¯åŠ¨æ—¶æ³¨å†Œæ–‡ä»¶æœåŠ¡ç›¸å…³çš„ä¾èµ–é¡¹ã€‚</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">class</span> <span class="title">ModuleInitializer</span> : <span class="title">IModuleInitializer</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> åˆå§‹åŒ–æ¨¡å—ï¼Œå°†æ‰€éœ€æœåŠ¡æ³¨å†Œåˆ° <span class="doctag">&lt;see cref=&quot;IServiceCollection&quot;/&gt;</span> ä¸­ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;services&quot;&gt;</span>æœåŠ¡é›†åˆï¼Œç”¨äºæ³¨å†Œä¾èµ–é¡¹ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Initialize</span>(<span class="params">IServiceCollection services</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// æ³¨å†Œ HttpContextAccessorï¼Œä¾¿äºåœ¨æœåŠ¡ä¸­è®¿é—® HttpContext</span></span><br><span class="line">        services.AddHttpContextAccessor();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ³¨å†Œ SMB å­˜å‚¨å®¢æˆ·ç«¯å®ç°</span></span><br><span class="line">        services.AddScoped&lt;IStorageClient, SMBStorageClient&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ³¨å†Œäº‘å­˜å‚¨æ¨¡æ‹Ÿå®¢æˆ·ç«¯å®ç°</span></span><br><span class="line">        services.AddScoped&lt;IStorageClient, MockCloudStorageClient&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ³¨å†Œæ–‡ä»¶ç³»ç»Ÿä»“å‚¨å®ç°</span></span><br><span class="line">        services.AddScoped&lt;IFSRepository, FSRepository&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ³¨å†Œæ–‡ä»¶é¢†åŸŸæœåŠ¡</span></span><br><span class="line">        services.AddScoped&lt;FSDomainService&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ³¨å†Œ HttpClientï¼Œç”¨äºå‘èµ· HTTP è¯·æ±‚</span></span><br><span class="line">        services.AddHttpClient();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œä»£ç ä¸­æä¾›çš„IModuleInitializeræœºåˆ¶è®©æˆ‘ä»¬å¯ä»¥æŠŠé¡¹ç›®ä¸­çš„æœåŠ¡åœ¨é¡¹ç›®ä¸­è¿›è¡Œæ³¨å†Œï¼Œè€Œä¸ç”¨ç»Ÿä¸€æ³¨å†Œåˆ°åº”ç”¨æœåŠ¡å±‚é¡¹ç›®ä¸­ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ASP.NET Core </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸»ç³»è¡¨</title>
      <link href="/2025/08/16/asp.net%20core/%E8%8B%B1%E8%AF%AD/%E4%B8%BB%E7%B3%BB%E8%A1%A8/"/>
      <url>/2025/08/16/asp.net%20core/%E8%8B%B1%E8%AF%AD/%E4%B8%BB%E7%B3%BB%E8%A1%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸»ç³»è¡¨"><a href="#ä¸»ç³»è¡¨" class="headerlink" title="ä¸»ç³»è¡¨"></a>ä¸»ç³»è¡¨</h1><p>ä¸»è°“å®¾ï¼ˆç‰¹æ®Šï¼‰&#x3D;ä¸»ç³»è¡¨<br>Look&#x3D;çœ‹èµ·æ¥<br>This girl looks pretty.<br>è¿™ä¸ªå¥³å­©çœ‹èµ·æ¥å¾ˆæ¼‚äº®ã€‚<br>Smell&#x3D;é—»èµ·æ¥<br>This flower smells good.<br>è¿™æœµèŠ±é—»èµ·æ¥å¾ˆä¸é”™ã€‚<br>Taste&#x3D;å°èµ·æ¥<br>This candy tastes sweet.</p><p>ä¸»è¯­ (Subject)ï¼šå¥å­æè¿°çš„æ ¸å¿ƒå¯¹è±¡ï¼ˆäººã€äº‹ã€ç‰©ã€æŠ½è±¡æ¦‚å¿µç­‰ï¼‰ã€‚</p><p>ç¤ºä¾‹ï¼šHe, The book, Her smile, This city</p><p>ç³»åŠ¨è¯ (Linking Verb)ï¼šè¿æ¥ä¸»è¯­å’Œè¡¨è¯­çš„åŠ¨è¯ï¼Œæœ¬èº«æ— å®é™…åŠ¨ä½œå«ä¹‰ï¼Œä»…èµ· â€œè¿æ¥â€ å’Œ â€œè¡¨è¿°çŠ¶æ€â€ çš„ä½œç”¨ã€‚</p><p>æ ¸å¿ƒç³»åŠ¨è¯ï¼šbe åŠ¨è¯ï¼ˆam, is, are, was, wereï¼‰</p><p>å…¶ä»–å¸¸è§ç³»åŠ¨è¯ï¼š</p><p>è¡¨ â€œå˜åŒ–â€ï¼šbecomeï¼ˆå˜å¾—ï¼‰ã€getï¼ˆå˜å¾—ï¼‰ã€turnï¼ˆå˜æˆï¼‰<br>è¡¨ â€œæ„Ÿå®˜â€ï¼šlookï¼ˆçœ‹èµ·æ¥ï¼‰ã€soundï¼ˆå¬èµ·æ¥ï¼‰ã€tasteï¼ˆå°èµ·æ¥ï¼‰ã€smellï¼ˆé—»èµ·æ¥ï¼‰ã€feelï¼ˆæ‘¸èµ·æ¥ &#x2F; æ„Ÿè§‰ï¼‰<br>è¡¨ â€œä¿æŒâ€ï¼škeepï¼ˆä¿æŒï¼‰ã€stayï¼ˆç»´æŒï¼‰ã€remainï¼ˆä»ç„¶æ˜¯ï¼‰<br>è¡¨è¯­ (Predicate Complement)ï¼šä½äºç³»åŠ¨è¯åï¼Œç”¨æ¥ â€œè¡¥å……è¯´æ˜ä¸»è¯­â€ çš„æˆåˆ†ï¼Œå¯ç”±åè¯ã€å½¢å®¹è¯ã€ä»‹è¯çŸ­è¯­ç­‰å……å½“ã€‚</p><h2 id="ä¹ é¢˜ï¼š"><a href="#ä¹ é¢˜ï¼š" class="headerlink" title="ä¹ é¢˜ï¼š"></a>ä¹ é¢˜ï¼š</h2><p>è¿™å¼ è½¯åœ°æ¯¯æ‘¸èµ·æ¥å¾ˆèˆ’æœã€‚<br>This soft blanket feels every comfortable.<br>å¥¹å¤§èƒ†çš„æƒ³æ³•è¢«è¯æ˜æ˜¯ç©ºæ´çš„ã€‚<br>She bold idea proves empty.<br>è¿™å¼ çº¸ä¸€ä¸‹å°±å˜é»„äº†ã€‚<br>This paper turns yellow in a second.</p>]]></content>
      
      
      <categories>
          
          <category> English </category>
          
      </categories>
      
      
        <tags>
            
            <tag> English </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŠç‰©åŠ¨è¯å’Œä¸åŠç‰©åŠ¨è¯</title>
      <link href="/2025/08/12/asp.net%20core/%E8%8B%B1%E8%AF%AD/%E5%8F%8A%E7%89%A9%E5%8A%A8%E8%AF%8D%E5%92%8C%E4%B8%8D%E5%8F%8A%E7%89%A9%E5%8A%A8%E8%AF%8D/"/>
      <url>/2025/08/12/asp.net%20core/%E8%8B%B1%E8%AF%AD/%E5%8F%8A%E7%89%A9%E5%8A%A8%E8%AF%8D%E5%92%8C%E4%B8%8D%E5%8F%8A%E7%89%A9%E5%8A%A8%E8%AF%8D/</url>
      
        <content type="html"><![CDATA[<p>åŠç‰©åŠ¨è¯å’Œä¸åŠç‰©åŠ¨è¯<br>åŠç‰©åŠ¨è¯ï¼šè§¦åŠç‰©ä½“ï¼ˆå®¾è¯­Â·ï¼‰<br>åŠç‰©åŠ¨è¯å¿…é¡»è¦æ¥å®¾è¯­ï¼<br>1.eat åƒ I eat a pear.æˆ‘åƒä¸€ä¸ªæ¢¨å­ã€‚<br>2.watch è§‚çœ‹ I watch TV. æˆ‘çœ‹ç”µè§†ã€‚<br>3.seeçœ‹åˆ° He sees a monkey. ä»–çœ‹åˆ°ä¸€åªçŒ´å­ã€‚</p><p>ä¸åŠç‰©åŠ¨è¯ï¼šä¸è§¦åŠç‰©ä½“ï¼ˆå®¾è¯­Â·ï¼‰ï¼Œä»‹è¯ï¼ˆå½“æ¡¥æ¢ï¼‰<br>1.look çœ‹ I look at a person. æˆ‘çœ‹ç€ä¸€ä¸ªäººã€‚<br>2.run è·‘ I run on the ground. æˆ‘åœ¨åœ°ä¸Šè·‘ã€‚<br>3.sleep ç¡è§‰ Marry sleeps in her bedroom. Marryåœ¨å§å®¤ç¡è§‰ã€‚<br>ä¸åŠç‰©åŠ¨è¯å¯ä¸æ¥ä»»ä½•æˆåˆ†ï¼Œå•ç‹¬æˆå¥<br>4.die æ­»äº¡ He died. ä»–æ­»äº†<br>5.win&#x2F;lose èƒœåˆ©&#x2F;å¤±è´¥ You win&#x2F;lose. ä½ èµ¢&#x2F;è¾“äº†<br>6.arrive&#x2F;come&#x2F;go He has arrived&#x2F;come&#x2F;gone ä»–åˆ°äº†&#x2F;æ¥äº†&#x2F;èµ°äº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> English </category>
          
      </categories>
      
      
        <tags>
            
            <tag> English </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ³¨å†ŒMediatRï¼Œæ·»åŠ å·¥ä½œå•å…ƒè¿‡æ»¤å™¨</title>
      <link href="/2025/08/11/asp.net%20core/%E5%AD%A6%E8%8B%B1%E8%AF%AD%E7%BD%91%E7%AB%99%E9%A1%B9%E7%9B%AE/%E6%B3%A8%E5%86%8CMediatR%EF%BC%8C%E6%B7%BB%E5%8A%A0%E5%B7%A5%E4%BD%9C%E5%8D%95%E5%85%83/"/>
      <url>/2025/08/11/asp.net%20core/%E5%AD%A6%E8%8B%B1%E8%AF%AD%E7%BD%91%E7%AB%99%E9%A1%B9%E7%9B%AE/%E6%B3%A8%E5%86%8CMediatR%EF%BC%8C%E6%B7%BB%E5%8A%A0%E5%B7%A5%E4%BD%9C%E5%8D%95%E5%85%83/</url>
      
        <content type="html"><![CDATA[<h1 id="æ³¨å†ŒMediatR"><a href="#æ³¨å†ŒMediatR" class="headerlink" title="æ³¨å†ŒMediatR"></a>æ³¨å†ŒMediatR</h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ³¨å†Œ MediatRï¼Œç”¨äºé¢†åŸŸäº‹ä»¶å’Œå‘½ä»¤å¤„ç†</span></span><br><span class="line">services.AddMediatR(assemblies);</span><br></pre></td></tr></table></figure><p>æŠŠæŒ‡å®šç¨‹åºé›†ï¼ˆassembliesï¼‰é‡Œå®ç°çš„ MediatR å¤„ç†ç¨‹åºæ³¨å†Œåˆ°ä¾èµ–æ³¨å…¥å®¹å™¨ï¼Œè¿™æ ·ä½ å°±å¯ä»¥ç”¨ MediatR çš„é¢†åŸŸäº‹ä»¶å’Œå‘½ä»¤æ¨¡å¼äº†ã€‚<br>AddMediatRæ˜¯è‡ªå®šä¹‰æ‰©å±•æ–¹æ³•ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">MediatorExtensions</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æ‰©å±•IServiceCollectionä»¥æ‰¹é‡æ³¨å†ŒMediatRç›¸å…³æœåŠ¡ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;services&quot;&gt;</span>ä¾èµ–æ³¨å…¥æœåŠ¡é›†åˆã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;assemblies&quot;&gt;</span>åŒ…å«MediatRå¤„ç†ç¨‹åºçš„ç¨‹åºé›†é›†åˆã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>æœåŠ¡é›†åˆæœ¬èº«ï¼Œä¾¿äºé“¾å¼è°ƒç”¨ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IServiceCollection <span class="title">AddMediatR</span>(<span class="params"><span class="keyword">this</span> IServiceCollection services, IEnumerable&lt;Assembly&gt; assemblies</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å°†æŒ‡å®šç¨‹åºé›†ä¸­çš„MediatRæœåŠ¡æ³¨å†Œåˆ°ä¾èµ–æ³¨å…¥å®¹å™¨</span></span><br><span class="line">        <span class="keyword">return</span> services.AddMediatR(assemblies.ToArray());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æ´¾å‘å½“å‰DbContextä¸­æ‰€æœ‰èšåˆæ ¹çš„é¢†åŸŸäº‹ä»¶ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;mediator&quot;&gt;</span>MediatRä¸­ä»‹è€…å®ä¾‹ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;ctx&quot;&gt;</span>å½“å‰çš„EF Core DbContextå®ä¾‹ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>å¼‚æ­¥ä»»åŠ¡ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">async</span> Task <span class="title">DispatchDomainEventsAsync</span>(<span class="params"><span class="keyword">this</span> IMediator mediator, DbContext ctx</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// è·å–æ‰€æœ‰å®ç°äº†IDomainEventsæ¥å£ä¸”åŒ…å«é¢†åŸŸäº‹ä»¶çš„å®ä½“</span></span><br><span class="line">        <span class="keyword">var</span> domainEntities = ctx.ChangeTracker</span><br><span class="line">            .Entries&lt;IDomainEvents&gt;()</span><br><span class="line">            .Where(x =&gt; x.Entity.GetDomainEvents().Any());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ”¶é›†æ‰€æœ‰é¢†åŸŸäº‹ä»¶</span></span><br><span class="line">        <span class="keyword">var</span> domainEvents = domainEntities</span><br><span class="line">            .SelectMany(x =&gt; x.Entity.GetDomainEvents())</span><br><span class="line">            .ToList();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ¸…ç©ºå®ä½“ä¸Šçš„é¢†åŸŸäº‹ä»¶ï¼Œé¿å…é‡å¤æ´¾å‘</span></span><br><span class="line">        domainEntities.ToList()</span><br><span class="line">            .ForEach(entity =&gt; entity.Entity.ClearDomainEvents());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é€ä¸ªé€šè¿‡MediatRå‘å¸ƒé¢†åŸŸäº‹ä»¶</span></span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">var</span> domainEvent <span class="keyword">in</span> domainEvents)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">await</span> mediator.Publish(domainEvent);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>AddMediatRæ‰¹é‡æ³¨å†ŒMediatRæœåŠ¡ã€‚<br>DispatchDomainEventsAsyncæ´¾å‘ EF Core èšåˆæ ¹çš„é¢†åŸŸäº‹ä»¶</p></blockquote><ol><li>æ‰¾å‡ºæœ‰é¢†åŸŸäº‹ä»¶çš„å®ä½“<br>ctx.ChangeTracker.Entries&lt;IDomainEvents&gt;() ä¼šè·å–å½“å‰è·Ÿè¸ªçš„ã€å®ç°äº† IDomainEvents æ¥å£çš„å®ä½“ã€‚<br>è¿‡æ»¤å‡º GetDomainEvents().Any() çš„å®ä½“ï¼Œè¯´æ˜å®ƒä»¬ç¡®å®æœ‰æœªå‘å¸ƒçš„é¢†åŸŸäº‹ä»¶ã€‚</li></ol><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IDomainEvents</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> è·å–å½“å‰å·²æ³¨å†Œçš„æ‰€æœ‰é¢†åŸŸäº‹ä»¶ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>é¢†åŸŸäº‹ä»¶çš„åªè¯»é›†åˆã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function">IEnumerable&lt;INotification&gt; <span class="title">GetDomainEvents</span>()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="number">0</span>/<span class="number">8589</span>+<span class="number">0l</span>kmmnbgfvcdx5`      <span class="number">8</span>\-<span class="number">-098765</span></span><br><span class="line"><span class="string">&#x27;;L&#x27;</span>;LK<span class="string">&#x27;;LK/.,ML,KMJNHBGV;LOKIUHGFDIUY&#x27;</span>    <span class="comment"><span class="doctag">///</span> æ·»åŠ ä¸€ä¸ªæ–°çš„é¢†åŸŸäº‹ä»¶åˆ°é›†åˆä¸­ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;eventItem&quot;&gt;</span>è¦æ·»åŠ çš„é¢†åŸŸäº‹ä»¶ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">AddDomainEvent</span>(<span class="params">INotification eventItem</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> å¦‚æœé›†åˆä¸­ä¸å­˜åœ¨è¯¥äº‹ä»¶ï¼Œåˆ™æ·»åŠ ä¸€ä¸ªæ–°çš„é¢†åŸŸäº‹ä»¶ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ç”¨äºé¿å…é‡å¤æ·»åŠ ç›¸åŒçš„äº‹ä»¶ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;eventItem&quot;&gt;</span>è¦æ·»åŠ çš„é¢†åŸŸäº‹ä»¶ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">AddDomainEventIfAbsent</span>(<span class="params">INotification eventItem</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æ¸…ç©ºå½“å‰æ‰€æœ‰å·²æ³¨å†Œçš„é¢†åŸŸäº‹ä»¶ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ClearDomainEvents</span>()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li><p>æ”¶é›†æ‰€æœ‰é¢†åŸŸäº‹ä»¶<br>SelectMany æŠŠæ‰€æœ‰å®ä½“çš„äº‹ä»¶æ‰å¹³åŒ–æˆä¸€ä¸ª List&lt;IDomainEvent&gt;ã€‚</p></li><li><p>æ¸…ç©ºå®ä½“çš„äº‹ä»¶é›†åˆ<br>é¿å…åŒä¸€ä¸ªäº‹ä»¶è¢«é‡å¤å‘å¸ƒã€‚</p></li><li><p>é€ä¸ªå‘å¸ƒäº‹ä»¶<br>mediator.Publish(domainEvent) è®© MediatR æ‰¾åˆ°å¯¹åº”çš„ INotificationHandler&lt;T&gt; æ¥å¤„ç†äº‹ä»¶ã€‚</p></li></ol><h1 id="æ·»åŠ å·¥ä½œå•å…ƒè¿‡æ»¤å™¨"><a href="#æ·»åŠ å·¥ä½œå•å…ƒè¿‡æ»¤å™¨" class="headerlink" title="æ·»åŠ å·¥ä½œå•å…ƒè¿‡æ»¤å™¨"></a>æ·»åŠ å·¥ä½œå•å…ƒè¿‡æ»¤å™¨</h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é…ç½® MVC é€‰é¡¹ï¼Œæ·»åŠ å·¥ä½œå•å…ƒè¿‡æ»¤å™¨</span></span><br><span class="line">services.Configure&lt;MvcOptions&gt;(options =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    options.Filters.Add&lt;UnitOfWorkFilter&gt;();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><blockquote><p>ASP.NET Core çš„ MVC ç®¡é“å…¨å±€åŠ äº†ä¸€ä¸ªâ€œå·¥ä½œå•å…ƒï¼ˆUnit of Workï¼‰è¿‡æ»¤å™¨â€ï¼Œè®©æ‰€æœ‰æ§åˆ¶å™¨&#x2F;Action æ‰§è¡Œæ—¶è‡ªåŠ¨å¯ç”¨ä¸€ä¸ªå·¥ä½œå•å…ƒé€»è¾‘ã€‚</p></blockquote><p>services.Configure&lt;MvcOptions&gt;<br>è¿™æ˜¯å¯¹ MVC æ¡†æ¶çš„é…ç½®å…¥å£ï¼Œå¯ä»¥ä¿®æ”¹ MVC çš„è¡Œä¸ºï¼Œæ¯”å¦‚æ ¼å¼åŒ–å™¨ã€æ¨¡å‹ç»‘å®šã€è¿‡æ»¤å™¨ç­‰ã€‚</p><p>options.Filters.Add&lt;UnitOfWorkFilter&gt;()<br>ç»™ å…¨å±€è¿‡æ»¤å™¨é›†åˆ æ·»åŠ äº†ä¸€ä¸ª UnitOfWorkFilterï¼Œæ‰€æœ‰ Controller Action æ‰§è¡Œå‰åéƒ½ä¼šç»è¿‡å®ƒã€‚<br>è¿™å’Œåœ¨æ¯ä¸ª Controller ä¸Š [ServiceFilter(typeof(UnitOfWorkFilter))] ä¸€æ ·ï¼Œä½†è¿™æ˜¯å…¨å±€ç”Ÿæ•ˆã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UnitOfWorkFilter</span> : <span class="title">IAsyncActionFilter</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> è·å–åº”ç”¨äºæ§åˆ¶å™¨æˆ–æ–¹æ³•çš„ UnitOfWorkAttribute ç‰¹æ€§ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ä¼˜å…ˆè·å–æ§åˆ¶å™¨ä¸Šçš„ç‰¹æ€§ï¼Œå¦‚æœæ²¡æœ‰åˆ™è·å–æ–¹æ³•ä¸Šçš„ç‰¹æ€§ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;actionDesc&quot;&gt;</span>å½“å‰ Action çš„æè¿°ä¿¡æ¯ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>UnitOfWorkAttribute å®ä¾‹æˆ– nullã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> UnitOfWorkAttribute? GetUoWAttr(ActionDescriptor actionDesc)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> caDesc = actionDesc <span class="keyword">as</span> ControllerActionDescriptor;</span><br><span class="line">        <span class="keyword">if</span> (caDesc == <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// ä¸æ˜¯æ§åˆ¶å™¨ Actionï¼Œç›´æ¥è¿”å› null</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ä¼˜å…ˆè·å–æ§åˆ¶å™¨ä¸Šçš„ UnitOfWorkAttribute</span></span><br><span class="line">        <span class="keyword">var</span> uowAttr = caDesc.ControllerTypeInfo</span><br><span class="line">            .GetCustomAttribute&lt;UnitOfWorkAttribute&gt;();</span><br><span class="line">        <span class="keyword">if</span> (uowAttr != <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> uowAttr;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœæ§åˆ¶å™¨ä¸Šæ²¡æœ‰ï¼Œåˆ™è·å–æ–¹æ³•ä¸Šçš„ UnitOfWorkAttribute</span></span><br><span class="line">            <span class="keyword">return</span> caDesc.MethodInfo</span><br><span class="line">                .GetCustomAttribute&lt;UnitOfWorkAttribute&gt;();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æ‹¦æˆª Action æ‰§è¡Œè¿‡ç¨‹ï¼Œå®ç°å·¥ä½œå•å…ƒäº‹åŠ¡æ§åˆ¶ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;context&quot;&gt;</span>Action æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;next&quot;&gt;</span>å§”æ‰˜ï¼Œæ‰§è¡Œä¸‹ä¸€ä¸ªä¸­é—´ä»¶æˆ– Actionã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>å¼‚æ­¥ä»»åŠ¡ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">OnActionExecutionAsync</span>(<span class="params">ActionExecutingContext context, ActionExecutionDelegate next</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// è·å–å½“å‰ Action æˆ–æ§åˆ¶å™¨ä¸Šçš„ UnitOfWorkAttribute</span></span><br><span class="line">        <span class="keyword">var</span> uowAttr = GetUoWAttr(context.ActionDescriptor);</span><br><span class="line">        <span class="keyword">if</span> (uowAttr == <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// æœªæ ‡è®° UnitOfWorkAttributeï¼Œç›´æ¥æ‰§è¡Œä¸‹ä¸€ä¸ªä¸­é—´ä»¶</span></span><br><span class="line">            <span class="keyword">await</span> next();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¯ç”¨æ”¯æŒå¼‚æ­¥æµçš„äº‹åŠ¡ä½œç”¨åŸŸ</span></span><br><span class="line">        <span class="keyword">using</span> TransactionScope txScope = <span class="keyword">new</span> TransactionScope(TransactionScopeAsyncFlowOption.Enabled);</span><br><span class="line">        List&lt;DbContext&gt; dbCtxs = <span class="keyword">new</span> List&lt;DbContext&gt;();</span><br><span class="line">        <span class="comment">// éå†ç‰¹æ€§ä¸­å£°æ˜çš„æ‰€æœ‰ DbContext ç±»å‹</span></span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">var</span> dbCtxType <span class="keyword">in</span> uowAttr.DbContextTypes)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// é€šè¿‡ä¾èµ–æ³¨å…¥è·å– DbContext å®ä¾‹</span></span><br><span class="line">            <span class="keyword">var</span> sp = context.HttpContext.RequestServices;</span><br><span class="line">            DbContext dbCtx = (DbContext)sp.GetRequiredService(dbCtxType);</span><br><span class="line">            dbCtxs.Add(dbCtx);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ‰§è¡Œ Action</span></span><br><span class="line">        <span class="keyword">var</span> result = <span class="keyword">await</span> next();</span><br><span class="line">        <span class="keyword">if</span> (result.Exception == <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœæ²¡æœ‰å¼‚å¸¸ï¼Œä¾æ¬¡ä¿å­˜æ‰€æœ‰ DbContext çš„æ›´æ”¹</span></span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> dbCtx <span class="keyword">in</span> dbCtxs)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">await</span> dbCtx.SaveChangesAsync();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// æäº¤äº‹åŠ¡</span></span><br><span class="line">            txScope.Complete();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¦‚æœæœ‰å¼‚å¸¸ï¼Œäº‹åŠ¡ä¼šè‡ªåŠ¨å›æ»š</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>GetUoWAttræŸ¥æ‰¾UnitOfWorkAttribute</li></ol><p>UnitOfWorkAttributeè‡ªå®šä¹‰çš„ç‰¹æ€§ç±»</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> ç”¨äºæ ‡è®°éœ€è¦å·¥ä½œå•å…ƒï¼ˆUnit of Workï¼‰æ”¯æŒçš„ç±»æˆ–æ–¹æ³•çš„ç‰¹æ€§ï¼ˆAttributeï¼‰ã€‚</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> é€šè¿‡æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ª DbContext ç±»å‹ï¼Œå®ç°å¯¹æ•°æ®åº“æ“ä½œçš„è‡ªåŠ¨äº‹åŠ¡ç®¡ç†ã€‚</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UnitOfWorkAttribute</span> : <span class="title">Attribute</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> è·å–éœ€è¦å‚ä¸å·¥ä½œå•å…ƒçš„ DbContext ç±»å‹æ•°ç»„ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> Type[] DbContextTypes &#123; <span class="keyword">get</span>; <span class="keyword">init</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æ„é€ å‡½æ•°ï¼Œåˆå§‹åŒ– UnitOfWorkAttribute å®ä¾‹ï¼Œå¹¶æ ¡éªŒä¼ å…¥çš„ç±»å‹æ˜¯å¦ä¸º DbContext çš„å­ç±»ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dbContextTypes&quot;&gt;</span>éœ€è¦å‚ä¸å·¥ä½œå•å…ƒçš„ DbContext ç±»å‹åˆ—è¡¨ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;exception cref=&quot;ArgumentException&quot;&gt;</span>å¦‚æœä¼ å…¥çš„ç±»å‹ä¸æ˜¯ DbContext çš„å­ç±»ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚<span class="doctag">&lt;/exception&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UnitOfWorkAttribute</span>(<span class="params"><span class="keyword">params</span> Type[] dbContextTypes</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.DbContextTypes = dbContextTypes;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">var</span> type <span class="keyword">in</span> dbContextTypes)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// æ ¡éªŒæ¯ä¸ªç±»å‹æ˜¯å¦ä¸º DbContext æˆ–å…¶å­ç±»</span></span><br><span class="line">            <span class="keyword">if</span> (!<span class="keyword">typeof</span>(DbContext).IsAssignableFrom(type))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">$&quot;Type <span class="subst">&#123;type.FullName&#125;</span> is not a DbContext type.&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>OnActionExecutionAsyncæ‹¦æˆª Action æ–¹æ³•æ‰§è¡Œï¼Œè‡ªåŠ¨å¼€å¯äº‹åŠ¡ï¼Œç¡®ä¿å¤šä¸ª DbContext æ“ä½œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å›æ»šã€‚</p>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ASP.NET Core </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åè¯æ€§ä»å¥</title>
      <link href="/2025/08/10/asp.net%20core/%E8%8B%B1%E8%AF%AD/%E5%90%8D%E8%AF%8D%E6%80%A7%E4%BB%8E%E5%8F%A5/"/>
      <url>/2025/08/10/asp.net%20core/%E8%8B%B1%E8%AF%AD/%E5%90%8D%E8%AF%8D%E6%80%A7%E4%BB%8E%E5%8F%A5/</url>
      
        <content type="html"><![CDATA[<h1 id="åè¯æ€§ä»å¥"><a href="#åè¯æ€§ä»å¥" class="headerlink" title="åè¯æ€§ä»å¥"></a>åè¯æ€§ä»å¥</h1><p>ä¸»è¯­ä»å¥+å®¾è¯­ä»å¥  ä¸»è¯­ã€å®¾è¯­&#x3D;&#x3D;åè¯<br>ä»‹è¯çŸ­è¯­ï¼ˆä»‹å®¾ï¼‰&#x3D;ä»‹è¯+åè¯<br>1,I look at you.<br>æˆ‘çœ‹ç€ä½ ã€‚<br>Youæ˜¯åè¯,å¯ä»¥æ”¹æˆæˆ‘æ‰€å–œæ¬¢çš„ä¸œè¥¿ã€‚<br>I look at what I like thing.<br>2.æˆ‘è¿›å…¥è¿™æ ‹æˆ¿å­ã€‚<br>I get into the house.<br>æˆ‘è¿›å…¥ä»–æ‰€ä½çš„åœ°æ–¹ã€‚<br>I get into where he lives.<br>3.æˆ‘å¯¹è¿™æœ¬ä¹¦å¾ˆæ„Ÿå…´è¶£ã€‚<br>I am very interested in this book.<br>æˆ‘å¯¹ä»–å•¥æ—¶å€™æ¥æˆ‘å®¶å¾ˆæ„Ÿå…´è¶£ã€‚<br>I am very interested in when he will come to my home.<br>4.æˆ‘å¯¹è¿™ä¸ªé—®é¢˜å¾ˆå›°æƒ‘ã€‚<br>I am confused with the question.<br>æˆ‘å¯¹ä»–è¿™ä¹ˆåšçš„åŸå› å¾ˆå›°æƒ‘ã€‚<br>I am confused with why he did this.<br>5.æˆ‘ä¸çŸ¥é“è¿™ä»¶äº‹ã€‚<br>I have no idea of this.<br>æˆ‘ä¸çŸ¥é“ä»–æ˜¯å¦ä¼šæ¥ã€‚<br>I have no idea of whether he will come.<br>æˆ‘ä¸çŸ¥é“å¥¹æ˜¯æ€ä¹ˆè§£å‡ºè¿™é“é—®é¢˜çš„ã€‚<br>I have no idea of how he solved this question.<br>6.åŸå› åœ¨äºä»–çš„æ‡’æƒ°ã€‚<br>The reason lies in his laziness.<br>Thatå¼•å¯¼é™ˆè¿°å¥<br>åŸå› åœ¨äºä»–å¾ˆæ‡’ã€‚<br>The reason lies in that his is lazy.</p><h2 id="ä¹ é¢˜ï¼š"><a href="#ä¹ é¢˜ï¼š" class="headerlink" title="ä¹ é¢˜ï¼š"></a>ä¹ é¢˜ï¼š</h2><p>1.æˆ‘æ‹…å¿ƒå¥¹æ˜¯å¦ä¼šæ¥å—è¿™ä»½å·¥ä½œã€‚<br>I am worried about whether she will accept this job.</p><p>2.ä»–æ­£åœ¨è€ƒè™‘å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚<br>He is thinking of how he solved this question.</p><p>3.æˆ‘ä»¬æ­£åœ¨è®¨è®ºä½•æ—¶å¯åŠ¨è¿™ä¸ªé¡¹ç›®ã€‚<br>We are discussing when we start this project.</p><p>4.ä»–å¾ˆå¥½å¥‡ä»–ä¸ºä»€ä¹ˆçªç„¶ç¦»å¼€ã€‚<br>He is curios about why she suddenly leave.</p><p>5.ä»–çš„æˆåŠŸå–å†³äºä»–å­¦ä¹ çš„æ–¹æ³•ã€‚<br>His success depends on how him studies.  </p>]]></content>
      
      
      <categories>
          
          <category> English </category>
          
      </categories>
      
      
        <tags>
            
            <tag> English </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é…ç½® JWT è®¤è¯ å’Œ Swagger çš„è®¤è¯æ”¯æŒ</title>
      <link href="/2025/08/09/asp.net%20core/%E5%AD%A6%E8%8B%B1%E8%AF%AD%E7%BD%91%E7%AB%99%E9%A1%B9%E7%9B%AE/%E9%85%8D%E7%BD%AE%20JWT%20%E8%AE%A4%E8%AF%81%20%E5%92%8C%20Swagger%20%E7%9A%84%E8%AE%A4%E8%AF%81%E6%94%AF%E6%8C%81/"/>
      <url>/2025/08/09/asp.net%20core/%E5%AD%A6%E8%8B%B1%E8%AF%AD%E7%BD%91%E7%AB%99%E9%A1%B9%E7%9B%AE/%E9%85%8D%E7%BD%AE%20JWT%20%E8%AE%A4%E8%AF%81%20%E5%92%8C%20Swagger%20%E7%9A%84%E8%AE%A4%E8%AF%81%E6%94%AF%E6%8C%81/</url>
      
        <content type="html"><![CDATA[<h1 id="é…ç½®è®¤è¯ä¸æˆæƒ"><a href="#é…ç½®è®¤è¯ä¸æˆæƒ" class="headerlink" title="é…ç½®è®¤è¯ä¸æˆæƒ"></a>é…ç½®è®¤è¯ä¸æˆæƒ</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// æ·»åŠ è®¤è¯æœåŠ¡</span><br><span class="line">builder.Services.AddAuthentication();</span><br><span class="line"></span><br><span class="line">// æ·»åŠ æˆæƒæœåŠ¡</span><br><span class="line">builder.Services.AddAuthorization();</span><br></pre></td></tr></table></figure><p>AddAuthentication()ï¼šæ³¨å†Œè®¤è¯ç³»ç»Ÿï¼Œç”¨JWTè®¤è¯ã€‚<br>AddAuthorization()ï¼šæ³¨å†Œæˆæƒç³»ç»Ÿï¼Œç”¨äºåœ¨ [Authorize] ç­‰ç‰¹æ€§ä¸­åˆ¤æ–­ç”¨æˆ·æ˜¯å¦æœ‰æƒé™è®¿é—®ã€‚</p><h1 id="è¯»å–å¹¶ç»‘å®š-JWT-é…ç½®-æ³¨å†Œ-JWT-è®¤è¯æ–¹æ¡ˆ"><a href="#è¯»å–å¹¶ç»‘å®š-JWT-é…ç½®-æ³¨å†Œ-JWT-è®¤è¯æ–¹æ¡ˆ" class="headerlink" title="è¯»å–å¹¶ç»‘å®š JWT é…ç½®,æ³¨å†Œ JWT è®¤è¯æ–¹æ¡ˆ"></a>è¯»å–å¹¶ç»‘å®š JWT é…ç½®,æ³¨å†Œ JWT è®¤è¯æ–¹æ¡ˆ</h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä»é…ç½®ä¸­è·å– JWT ç›¸å…³é…ç½®</span></span><br><span class="line">JWTOptions jwtOpt = configuration.GetSection(<span class="string">&quot;JWT&quot;</span>).Get&lt;JWTOptions&gt;();</span><br></pre></td></tr></table></figure><p>ä»é…ç½®æºè¯»å–JWTèŠ‚ç‚¹ï¼Œå¹¶ç»‘å®šåˆ° JWTOptions å¯¹è±¡é‡Œã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">JWTOptions</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ä»¤ç‰Œé¢å‘è€…ï¼ˆIssuerï¼‰ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Issuer &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ä»¤ç‰Œæ¥æ”¶è€…ï¼ˆAudienceï¼‰ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Audience &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ç”¨äºç­¾å JWT çš„å¯†é’¥ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Key &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ä»¤ç‰Œè¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> ExpireSeconds &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é…ç½® JWT é€‰é¡¹ç»‘å®š</span></span><br><span class="line">services.Configure&lt;JWTOptions&gt;(configuration.GetSection(<span class="string">&quot;JWT&quot;</span>));</span><br></pre></td></tr></table></figure><p>services<br>ä¾èµ–æ³¨å…¥å®¹å™¨ï¼ˆIServiceCollectionï¼‰å®ä¾‹ã€‚è¿™é‡Œæˆ‘ä»¬å¾€å®¹å™¨ä¸­æ·»åŠ é…ç½®ç»‘å®šã€‚<br>Configure&lt;TOptions&gt;<br>æ¥è‡ª Microsoft.Extensions.Options.ConfigurationExtensionsï¼Œç”¨äºæŠŠé…ç½®æ–‡ä»¶é‡Œçš„æŸä¸ªéƒ¨åˆ†ç»‘å®šåˆ° TOptions ç±»å‹ï¼Œå¹¶æ³¨å†Œæˆ Options æ¨¡å¼ å¯¹è±¡ã€‚<br>æ³¨å†Œåï¼Œä½ å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹é€šè¿‡ IOptions&lt;JWTOptions&gt;æ¥è·å–è¿™ä¸ªå¯¹è±¡ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ·»åŠ  JWT è®¤è¯æœåŠ¡</span></span><br><span class="line">builder.Services.AddJWTAuthentication(jwtOpt);</span><br></pre></td></tr></table></figure><p>æ³¨å†ŒJWTæœåŠ¡éœ€è¦é…ç½®JWTä»¤ç‰ŒéªŒè¯å‚æ•°,è¿™é‡Œè‡ªå®šä¹‰äº†AddJWTAuthenticationæ‰©å¼ æ–¹æ³•</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">AuthenticationExtensions</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> å‘æœåŠ¡é›†åˆä¸­æ·»åŠ JWTè®¤è¯ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;services&quot;&gt;</span>æœåŠ¡é›†åˆã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;jwtOpt&quot;&gt;</span>JWTé…ç½®é€‰é¡¹ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>è®¤è¯ç”Ÿæˆå™¨ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> AuthenticationBuilder <span class="title">AddJWTAuthentication</span>(<span class="params"><span class="keyword">this</span> IServiceCollection services, JWTOptions jwtOpt</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> services.AddAuthentication(JwtBearerDefaults.AuthenticationScheme)</span><br><span class="line">        .AddJwtBearer(x =&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// é…ç½®JWTä»¤ç‰ŒéªŒè¯å‚æ•°</span></span><br><span class="line">            x.TokenValidationParameters = <span class="keyword">new</span>()</span><br><span class="line">            &#123;</span><br><span class="line">                ValidateIssuer = <span class="literal">true</span>, <span class="comment">// éªŒè¯ç­¾å‘è€…</span></span><br><span class="line">                ValidateAudience = <span class="literal">true</span>, <span class="comment">// éªŒè¯æ¥æ”¶è€…</span></span><br><span class="line">                ValidateLifetime = <span class="literal">true</span>, <span class="comment">// éªŒè¯æœ‰æ•ˆæœŸ</span></span><br><span class="line">                ValidateIssuerSigningKey = <span class="literal">true</span>, <span class="comment">// éªŒè¯ç­¾åå¯†é’¥</span></span><br><span class="line">                ValidIssuer = jwtOpt.Issuer, <span class="comment">// æœ‰æ•ˆç­¾å‘è€…</span></span><br><span class="line">                ValidAudience = jwtOpt.Audience, <span class="comment">// æœ‰æ•ˆæ¥æ”¶è€…</span></span><br><span class="line">                IssuerSigningKey = <span class="keyword">new</span> SymmetricSecurityKey(Encoding.UTF8.GetBytes(jwtOpt.Key)), <span class="comment">// ç­¾åå¯†é’¥</span></span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>AuthenticationBuilder â€”â€” æ–¹ä¾¿ä½ åé¢ç»§ç»­é“¾å¼é…ç½®è®¤è¯</p><p>AddAuthentication(JwtBearerDefaults.AuthenticationScheme)<br>å‘Šè¯‰ ASP.NET Core é»˜è®¤ä½¿ç”¨ Bearer Tokenï¼ˆå³ Authorization: Bearer &lt;token&gt;ï¼‰æ¥è®¤è¯ã€‚<br>AddJwtBearer(â€¦)<br>æ³¨å†Œ JWT Bearer è®¤è¯å¤„ç†å™¨ï¼Œå¹¶é…ç½®å¦‚ä½•éªŒè¯ tokenã€‚<br>TokenValidationParameters<br>ValidateIssuer &#x2F; ValidIssuerï¼šæ£€æŸ¥ token é‡Œ iss å£°æ˜æ˜¯å¦å’Œé…ç½®ä¸€è‡´ã€‚<br>ValidateAudience &#x2F; ValidAudienceï¼šæ£€æŸ¥ token é‡Œ aud å£°æ˜æ˜¯å¦å’Œé…ç½®ä¸€è‡´ã€‚<br>ValidateLifetimeï¼šæ£€æŸ¥ token æ˜¯å¦è¿‡æœŸï¼ˆå–å†³äº exp å’Œ nbf å­—æ®µï¼‰ã€‚<br>ValidateIssuerSigningKeyï¼šæ£€æŸ¥ token ç­¾åæ˜¯å¦æœ‰æ•ˆï¼ˆé˜²ç¯¡æ”¹ï¼‰ã€‚<br>IssuerSigningKeyï¼šç­¾åç”¨çš„å¯†é’¥ï¼ˆè¿™é‡Œç”¨ HMACSHA256 å¯¹ç§°åŠ å¯†ï¼‰ã€‚</p><h1 id="é…ç½®-Swagger-æ”¯æŒ-JWT-è°ƒè¯•"><a href="#é…ç½®-Swagger-æ”¯æŒ-JWT-è°ƒè¯•" class="headerlink" title="é…ç½® Swagger æ”¯æŒ JWT è°ƒè¯•"></a>é…ç½® Swagger æ”¯æŒ JWT è°ƒè¯•</h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">builder.Services.Configure&lt;SwaggerGenOptions&gt;(c =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    c.AddAuthenticationHeader();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ç»™ Swagger UI æ·»åŠ ä¸€ä¸ª â€œAuthorizeâ€ æŒ‰é’®ï¼Œå¯ä»¥è¾“å…¥ Bearer Tokenï¼Œåœ¨æ¥å£è°ƒè¯•æ—¶è‡ªåŠ¨å¸¦ä¸Š Authorization å¤´ã€‚<br>AddAuthenticationHeaderæ˜¯è‡ªå®šä¹‰æ‰©å¼ æ–¹æ³•ï¼Œå‘ Swagger é…ç½®ä¸­æ·»åŠ è®¤è¯å¤´ï¼ˆAuthorization Headerï¼‰ï¼Œ ä½¿å¾—åœ¨ Swagger UI ä¸­å¯ä»¥è¾“å…¥ JWT Token è¿›è¡Œæ¥å£æµ‹è¯•ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">SwaggerGenOptionsExtensions</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> å‘ Swagger é…ç½®ä¸­æ·»åŠ è®¤è¯å¤´ï¼ˆAuthorization Headerï¼‰ï¼Œ</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ä½¿å¾—åœ¨ Swagger UI ä¸­å¯ä»¥è¾“å…¥ JWT Token è¿›è¡Œæ¥å£æµ‹è¯•ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;c&quot;&gt;</span>SwaggerGenOptions å®ä¾‹ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">AddAuthenticationHeader</span>(<span class="params"><span class="keyword">this</span> SwaggerGenOptions c</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// æ·»åŠ å®‰å…¨å®šä¹‰ï¼ŒæŒ‡å®šåç§°ä¸º &quot;Authorization&quot;ï¼Œç±»å‹ä¸º ApiKeyï¼Œä½ç½®åœ¨ Headerã€‚</span></span><br><span class="line">        <span class="comment">// è¿™æ ·åœ¨ Swagger UI ä¸­ä¼šå‡ºç°ä¸€ä¸ªè¾“å…¥æ¡†ç”¨äºå¡«å†™ Tokenã€‚</span></span><br><span class="line">        c.AddSecurityDefinition(<span class="string">&quot;Authorization&quot;</span>, <span class="keyword">new</span> OpenApiSecurityScheme</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// æè¿°ä¿¡æ¯ï¼ŒæŒ‡å¯¼ç”¨æˆ·å¦‚ä½•å¡«å†™ Tokenã€‚</span></span><br><span class="line">            Description = <span class="string">&quot;Authorization header .\r\n Example:&#x27;Bearer 12345abcdef&#x27;&quot;</span>,</span><br><span class="line">            <span class="comment">// æŒ‡å®šå‚æ•°åœ¨ HTTP Header ä¸­ä¼ é€’ã€‚</span></span><br><span class="line">            In = ParameterLocation.Header,</span><br><span class="line">            <span class="comment">// å®‰å…¨æ–¹æ¡ˆç±»å‹ä¸º ApiKeyã€‚</span></span><br><span class="line">            Type = SecuritySchemeType.ApiKey,</span><br><span class="line">            <span class="comment">// æ–¹æ¡ˆåç§°ï¼Œé€šå¸¸ä¸º &quot;Authorization&quot;ã€‚</span></span><br><span class="line">            Scheme = <span class="string">&quot;Authorization&quot;</span></span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ·»åŠ å®‰å…¨éœ€æ±‚ï¼ŒæŒ‡å®šæ‰€æœ‰æ¥å£éƒ½éœ€è¦æºå¸¦ &quot;Authorization&quot; å¤´éƒ¨ã€‚</span></span><br><span class="line">        c.AddSecurityRequirement(<span class="keyword">new</span> OpenApiSecurityRequirement()</span><br><span class="line">            &#123;</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">new</span> OpenApiSecurityScheme</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="comment">// å¼•ç”¨ä¸Šé¢å®šä¹‰çš„å®‰å…¨æ–¹æ¡ˆã€‚</span></span><br><span class="line">                        Reference = <span class="keyword">new</span> OpenApiReference</span><br><span class="line">                        &#123;</span><br><span class="line">                            Type = ReferenceType.SecurityScheme,</span><br><span class="line">                            Id=<span class="string">&quot;Authorization&quot;</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                        <span class="comment">// æ–¹æ¡ˆç±»å‹ä¸º oauth2ï¼ˆè™½ç„¶å®é™…ç±»å‹ä¸º ApiKeyï¼Œè¿™é‡Œç”¨äºå…¼å®¹æ€§ï¼‰ã€‚</span></span><br><span class="line">                        Scheme = <span class="string">&quot;oauth2&quot;</span>,</span><br><span class="line">                        <span class="comment">// å¤´éƒ¨åç§°ã€‚</span></span><br><span class="line">                        Name=<span class="string">&quot;Authorization&quot;</span>,</span><br><span class="line">                        <span class="comment">// å‚æ•°ä½ç½®ä¸º Headerã€‚</span></span><br><span class="line">                        In=ParameterLocation.Header,</span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="comment">// ä½œç”¨åŸŸåˆ—è¡¨ï¼Œè¿™é‡Œä¸ºç©ºè¡¨ç¤ºä¸é™å®šä½œç”¨åŸŸã€‚</span></span><br><span class="line">                    <span class="keyword">new</span> List&lt;<span class="built_in">string</span>&gt;()</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ Swagger UI é¡¶éƒ¨åŠ ä¸€ä¸ª â€œAuthorizeâ€ æŒ‰é’®ã€‚<br>è®©æ‰€æœ‰ API è¯·æ±‚éƒ½è‡ªåŠ¨å¸¦ä¸Š Authorization HTTP å¤´ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ASP.NET Core </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸»è¯­ä»å¥</title>
      <link href="/2025/08/08/asp.net%20core/%E8%8B%B1%E8%AF%AD/%E4%B8%BB%E8%AF%AD%E4%BB%8E%E5%8F%A5/"/>
      <url>/2025/08/08/asp.net%20core/%E8%8B%B1%E8%AF%AD/%E4%B8%BB%E8%AF%AD%E4%BB%8E%E5%8F%A5/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸»è¯­ä»å¥"><a href="#ä¸»è¯­ä»å¥" class="headerlink" title="ä¸»è¯­ä»å¥"></a>ä¸»è¯­ä»å¥</h1><p>I know that you are right.&#x3D;&gt;å¯ä»¥å½“ä¸»è¯­<br>æˆ‘çŸ¥é“ä½ æ˜¯å¯¹çš„ã€‚<br>ä¸»è¯­å’Œå®¾è¯­éƒ½æ˜¯åè¯ï¼Œåè¯å¯ä»¥å½“ä¸»è¯­</p><p>That you are right is known to everyone.<br>ä½ æ˜¯å¯¹çš„æ˜¯ä¼—æ‰€å‘¨çŸ¥çš„ã€‚</p><p>I know where he lives.&#x3D;&gt;å½“ä¸»è¯­<br>æˆ‘çŸ¥é“ä»–ä½åœ¨å“ªé‡Œï¼ˆä»–ä½åœ¨çš„ä½ç½®ï¼‰ã€‚</p><p>Where he lives is unknown.<br>ä»–ä½çš„ä½ç½®æ²¡äººçŸ¥é“ã€‚</p><p>It&#x3D;å½¢å¼ä¸»è¯­ï¼ˆå‚€å„¡ä¸»è¯­ï¼‰<br>To do sth(å¸¦åè¯æ€§)<br>è‹±è¯­ä¹ æƒ¯ å…ˆè¯´é‡ç‚¹ å› ä¸ºå¤§å¤šéƒ½æ˜¯åç½®ä¿®é¥°</p><p>å»è§£å†³è¿™ä¸ªå¤æ‚çš„å¤§é—®é¢˜å®åœ¨å¤ªéš¾äº†ã€‚<br>To solve this big complex problem is very hard.</p><p>It is very hard to solve this big complex problem.(è¿™ä¸ªæ˜¯çœŸæ­£çš„ä¸»è¯­)</p><p>æ¯”å¦‚ï¼š</p><p>è§åˆ°ä½ å¾ˆé«˜å…´ã€‚<br>To see you is nice<br>ä¸»è¯­å¯ä»¥æ”¾åˆ°åé¢ç”¨Itä»£æ›¿<br>It is nice to see you.</p><p>doing sth.ä¹Ÿæœ‰åè¯æ€§<br>Seeing you is nice.<br>Seeing å°±å¯ç”¨æ”¾åé¢<br>It is nice seeing you.</p><h2 id="ä¹ é¢˜ï¼š"><a href="#ä¹ é¢˜ï¼š" class="headerlink" title="ä¹ é¢˜ï¼š"></a>ä¹ é¢˜ï¼š</h2><p>ä»–å›æ¥æˆ‘å®¶æ˜¯ç¡®å®šçš„ã€‚<br>It is certain that he will come to my home.<br>è°ä¼šèµ¢è¿™åœºæ¸¸æˆä»ç„¶æ˜¯ä¸ªè°œã€‚<br>It is a still a mystery who will win this game.<br>ä»–è¯´çš„æ˜¯çœŸçš„ã€‚<br>It is true what he talk.<br>Marry åˆ°è¾¾çš„æ—¶é—´ä»ç„¶æ˜¯ä¸ç¡®å®šçš„<br>It is uncertain when Marry arrive time.<br>æˆ‘ä»¬åº”è¯¥åŠªåŠ›å­¦ä¹ è¿™ç‚¹å¾ˆé‡è¦ã€‚<br>It is every important that we should study hard.</p><h1 id="theè¦æ€ä¹ˆåŠ "><a href="#theè¦æ€ä¹ˆåŠ " class="headerlink" title="theè¦æ€ä¹ˆåŠ "></a>theè¦æ€ä¹ˆåŠ </h1><p>ä¸€ã€ç‰¹æŒ‡åŒæ–¹éƒ½çŸ¥é“çš„äººæˆ–äº‹ç‰©<br>å½“æ‰€æŒ‡çš„äººã€ç‰©æˆ–æ¦‚å¿µæ˜¯å¯¹è¯åŒæ–¹éƒ½æ˜ç¡®äº†è§£çš„ï¼Œéœ€è¦ç”¨ theã€‚</p><p>â€¢ä¾‹ï¼šClose the door, please.ï¼ˆè¯·å…³ä¸Šé—¨ â€”â€” åŒæ–¹éƒ½çŸ¥é“æŒ‡çš„æ˜¯å½“å‰æ‰€åœ¨æˆ¿é—´çš„é—¨ï¼‰<br>â€¢ä¾‹ï¼šDid you see the movie last night?ï¼ˆä½ çœ‹äº†æ˜¨æ™šçš„ç”µå½±å—ï¼Ÿâ€”â€” åŒæ–¹éƒ½çŸ¥é“æŒ‡å“ªéƒ¨ï¼‰<br>äºŒã€æŒ‡å‰æ–‡æåˆ°è¿‡çš„äººæˆ–äº‹ç‰©<br>ç¬¬ä¸€æ¬¡æåˆ°æ—¶ç”¨ä¸å®šå† è¯ï¼ˆa&#x2F;anï¼‰ï¼Œå†æ¬¡æåˆ°æ—¶ç”¨ theã€‚</p><p>â€¢ä¾‹ï¼šI bought a book. The book is about history.ï¼ˆæˆ‘ä¹°äº†ä¸€æœ¬ä¹¦ã€‚è¿™æœ¬ä¹¦æ˜¯å…³äºå†å²çš„ã€‚ï¼‰<br>â€¢ä¾‹ï¼šThereâ€™s a cat in the garden. The cat is black.ï¼ˆèŠ±å›­é‡Œæœ‰ä¸€åªçŒ«ã€‚è¿™åªçŒ«æ˜¯é»‘è‰²çš„ã€‚ï¼‰<br>ä¸‰ã€ç”¨äºç‹¬ä¸€æ— äºŒçš„äº‹ç‰©å‰<br>ä¸–ç•Œä¸Šå”¯ä¸€å­˜åœ¨çš„äº‹ç‰©ï¼Œéœ€è¦ç”¨ the é™å®šã€‚</p><p>â€¢å¸¸è§ä¾‹å­ï¼š<br>othe sunï¼ˆå¤ªé˜³ï¼‰<br>othe moonï¼ˆæœˆäº®ï¼‰<br>othe earthï¼ˆåœ°çƒï¼‰<br>othe skyï¼ˆå¤©ç©ºï¼‰<br>othe worldï¼ˆä¸–ç•Œï¼‰<br>â€¢ä¾‹ï¼šThe earth goes around the sun.ï¼ˆåœ°çƒç»•ç€å¤ªé˜³è½¬ã€‚ï¼‰<br>å››ã€ç”¨äºå•æ•°å¯æ•°åè¯å‰ï¼Œè¡¨ç¤ºä¸€ç±»äººæˆ–äº‹ç‰©<br>ç”¨ â€œthe + å•æ•°åè¯â€ ä»£è¡¨æ•´ä¸ªç±»åˆ«ï¼ŒåŒºåˆ«äº â€œa&#x2F;an + å•æ•°åè¯â€ æˆ– â€œå¤æ•°åè¯â€ï¼ˆåä¸¤è€…æ›´ä¾§é‡æ³›æŒ‡ï¼‰ã€‚</p><p>â€¢ä¾‹ï¼šThe tiger is a dangerous animal.ï¼ˆè€è™æ˜¯å±é™©çš„åŠ¨ç‰© â€”â€” æŒ‡æ‰€æœ‰è€è™è¿™ä¸€ç±»ï¼‰<br>â€¢ä¾‹ï¼šThe computer has changed our life.ï¼ˆç”µè„‘æ”¹å˜äº†æˆ‘ä»¬çš„ç”Ÿæ´» â€”â€” æŒ‡ç”µè„‘è¿™ä¸€ç±»äº‹ç‰©ï¼‰<br>äº”ã€ç”¨äºå½¢å®¹è¯æˆ–åˆ†è¯å‰ï¼Œè¡¨ç¤ºä¸€ç±»äºº<br>â€œthe + å½¢å®¹è¯â€ æŒ‡ä»£å…·æœ‰è¯¥ç‰¹å¾çš„ä¸€ç±»äººï¼Œçœ‹ä½œå¤æ•°ã€‚</p><p>â€¢å¸¸è§ä¾‹å­ï¼š<br>othe poorï¼ˆç©·äººï¼‰<br>othe richï¼ˆå¯Œäººï¼‰<br>othe oldï¼ˆè€äººï¼‰<br>othe youngï¼ˆå¹´è½»äººï¼‰<br>othe sickï¼ˆç—…äººï¼‰<br>othe woundedï¼ˆä¼¤å‘˜ï¼‰<br>â€¢ä¾‹ï¼šWe should help the poor.ï¼ˆæˆ‘ä»¬åº”è¯¥å¸®åŠ©ç©·äººã€‚ï¼‰<br>â€¢ä¾‹ï¼šThe old need more care.ï¼ˆè€äººéœ€è¦æ›´å¤šç…§é¡¾ã€‚ï¼‰<br>å…­ã€ç”¨äºæ–¹ä½åè¯ã€ä¹å™¨ã€æ±Ÿæ²³æ¹–æµ·ã€å±±è„‰ç¾¤å²›ç­‰å‰<br>1.æ–¹ä½åè¯ï¼š<br>othe eastï¼ˆä¸œæ–¹ï¼‰ã€the westï¼ˆè¥¿æ–¹ï¼‰ã€the leftï¼ˆå·¦è¾¹ï¼‰ã€the rightï¼ˆå³è¾¹ï¼‰<br>oä¾‹ï¼šThe sun rises in the east.ï¼ˆå¤ªé˜³ä»ä¸œæ–¹å‡èµ·ã€‚ï¼‰<br>2.ä¹å™¨ï¼š<br>oæ¼”å¥æŸç§ä¹å™¨æ—¶ï¼Œä¹å™¨å‰åŠ  the<br>oä¾‹ï¼šShe plays the piano very well.ï¼ˆå¥¹é’¢ç´å¼¹å¾—å¾ˆå¥½ã€‚ï¼‰<br>oæ³¨æ„ï¼šçƒç±»ã€æ£‹ç±»å‰ä¸åŠ ï¼ˆplay basketball, play chessï¼‰ã€‚<br>3.æ±Ÿæ²³æ¹–æµ·ã€å±±è„‰ç¾¤å²›ã€è¿æ²³ã€æ²™æ¼ ç­‰ï¼š<br>oä¾‹ï¼šthe Yangtze Riverï¼ˆé•¿æ±Ÿï¼‰ã€the Pacific Oceanï¼ˆå¤ªå¹³æ´‹ï¼‰ã€the Himalayasï¼ˆå–œé©¬æ‹‰é›…å±±è„‰ï¼‰ã€the Saharaï¼ˆæ’’å“ˆæ‹‰æ²™æ¼ ï¼‰ã€the Suez Canalï¼ˆè‹ä¼Šå£«è¿æ²³ï¼‰<br>ä¸ƒã€ç”¨äºåºæ•°è¯ã€å½¢å®¹è¯æœ€é«˜çº§å‰<br>1.åºæ•°è¯ï¼ˆfirst, second, thirdâ€¦ï¼‰ï¼š<br>oä¾‹ï¼šHe was the first to arrive.ï¼ˆä»–æ˜¯ç¬¬ä¸€ä¸ªåˆ°çš„ã€‚ï¼‰<br>oä¾‹ï¼šThis is the third time Iâ€™ve told you.ï¼ˆè¿™æ˜¯æˆ‘ç¬¬ä¸‰æ¬¡å‘Šè¯‰ä½ äº†ã€‚ï¼‰<br>2.å½¢å®¹è¯æœ€é«˜çº§ï¼ˆbest, tallest, mostâ€¦ï¼‰ï¼š<br>oä¾‹ï¼šThis is the best book Iâ€™ve ever read.ï¼ˆè¿™æ˜¯æˆ‘è¯»è¿‡çš„æœ€å¥½çš„ä¹¦ã€‚ï¼‰<br>oä¾‹ï¼šShe is the tallest in her class.ï¼ˆå¥¹æ˜¯ç­ä¸Šæœ€é«˜çš„ã€‚ï¼‰<br>å…«ã€ç”¨äºå§“æ°å¤æ•°å‰ï¼Œè¡¨ç¤º â€œä¸€å®¶äººâ€ æˆ– â€œå¤«å¦‡ä¿©â€<br>â€¢ä¾‹ï¼šThe Greens are having dinner.ï¼ˆæ ¼æ—ä¸€å®¶æ­£åœ¨åƒæ™šé¥­ã€‚ï¼‰<br>â€¢ä¾‹ï¼šI met the Smiths at the party.ï¼ˆæˆ‘åœ¨æ´¾å¯¹ä¸Šé‡åˆ°äº†å²å¯†æ–¯å¤«å¦‡ã€‚ï¼‰<br>ä¹ã€ç”¨äºæŸäº›å›ºå®šçŸ­è¯­ä¸­<br>è‹±è¯­ä¸­æœ‰è®¸å¤šå›ºå®šæ­é…å¿…é¡»ç”¨ theï¼Œéœ€è¦ç§¯ç´¯ã€‚</p><p>â€¢ä¾‹ï¼šin the morningï¼ˆåœ¨æ—©ä¸Šï¼‰ã€on the wayï¼ˆåœ¨è·¯ä¸Šï¼‰ã€at the momentï¼ˆæ­¤åˆ»ï¼‰ã€by the wayï¼ˆé¡ºä¾¿è¯´ä¸€ä¸‹ï¼‰ã€in the endï¼ˆæœ€åï¼‰ã€the same asï¼ˆå’Œâ€¦â€¦ ä¸€æ ·ï¼‰ç­‰ã€‚<br>æ€»ç»“<br>the çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯ â€œç‰¹æŒ‡â€ï¼Œåˆ¤æ–­æ˜¯å¦éœ€è¦åŠ  theï¼Œå¯å…ˆé—®è‡ªå·±ï¼šâ€œæ‰€æŒ‡çš„å¯¹è±¡æ˜¯ç¡®å®šçš„ã€å”¯ä¸€çš„ï¼Œè¿˜æ˜¯åŒæ–¹éƒ½æ˜ç¡®çš„ï¼Ÿâ€ è‹¥æ˜¯ï¼Œåˆ™å¤§æ¦‚ç‡éœ€è¦ç”¨ theã€‚æ—¥å¸¸ä½¿ç”¨ä¸­ï¼Œé™¤äº†è®°ä½è§„åˆ™ï¼Œå¤šç§¯ç´¯ä¾‹å¥å’Œå›ºå®šæ­é…èƒ½æ›´ç†Ÿç»ƒæŒæ¡ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> English </category>
          
      </categories>
      
      
        <tags>
            
            <tag> English </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•è‡ªåŠ¨æ‰«æå¹¶æ³¨å†Œå¤šä¸ªç¨‹åºé›†ä¸­çš„æ‰€æœ‰ DbContext ç±»å‹</title>
      <link href="/2025/08/07/asp.net%20core/%E5%AD%A6%E8%8B%B1%E8%AF%AD%E7%BD%91%E7%AB%99%E9%A1%B9%E7%9B%AE/%E6%89%B9%E9%87%8F%E6%B3%A8%E5%86%8C%E6%89%80%E6%9C%89%20DbContext/"/>
      <url>/2025/08/07/asp.net%20core/%E5%AD%A6%E8%8B%B1%E8%AF%AD%E7%BD%91%E7%AB%99%E9%A1%B9%E7%9B%AE/%E6%89%B9%E9%87%8F%E6%B3%A8%E5%86%8C%E6%89%80%E6%9C%89%20DbContext/</url>
      
        <content type="html"><![CDATA[<h1 id="æ‰¹é‡æ³¨å†ŒDbContext"><a href="#æ‰¹é‡æ³¨å†ŒDbContext" class="headerlink" title="æ‰¹é‡æ³¨å†ŒDbContext"></a>æ‰¹é‡æ³¨å†ŒDbContext</h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">services.AddAllDbContexts(ctx =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> connStr = configuration.GetValue&lt;<span class="built_in">string</span>&gt;(<span class="string">&quot;DefaultDB:ConnStr&quot;</span>);</span><br><span class="line">    ctx.UseSqlServer(connStr);</span><br><span class="line">&#125;, assemblies);</span><br></pre></td></tr></table></figure><p>AddAllDbContextsæ˜¯è‡ªå®šä¹‰æ‰©å±•æ–¹æ³•ï¼Œä½œç”¨æ˜¯è‡ªåŠ¨æ³¨å†Œæ‰€æœ‰DbContext ç±»å‹åˆ°ä¾èµ–æ³¨å…¥å®¹å™¨ä¸­ã€‚<br>configuration.GetValue&lt;string&gt;(â€œDefaultDB:ConnStrâ€)ä»é…ç½®ç³»ç»Ÿä¸­è¯»å–è¿æ¥å­—ç¬¦ä¸²ï¼Œæˆ‘æ˜¯é…ç½®åˆ°ç¯å¢ƒå˜é‡ã€‚<br>assemblies ä¸­æ‰€æœ‰å®ç°äº† DbContext çš„ç±»ï¼Œå¹¶ä½¿ç”¨æä¾›çš„å§”æ‰˜é…ç½®å®ƒä»¬ã€‚</p><h1 id="AddAllDbContexts"><a href="#AddAllDbContexts" class="headerlink" title="AddAllDbContexts"></a>AddAllDbContexts</h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">EFCoreInitializerHelper</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æ‰¹é‡æ³¨å†ŒæŒ‡å®šç¨‹åºé›†ä¸­çš„æ‰€æœ‰ DbContext ç±»å‹åˆ°ä¾èµ–æ³¨å…¥å®¹å™¨ä¸­ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;services&quot;&gt;</span>ä¾èµ–æ³¨å…¥æœåŠ¡å®¹å™¨ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;builder&quot;&gt;</span>ç”¨äºé…ç½® DbContext é€‰é¡¹çš„å§”æ‰˜ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;assemblies&quot;&gt;</span>åŒ…å« DbContext ç±»å‹çš„ç¨‹åºé›†é›†åˆã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>è¿”å›æœåŠ¡å®¹å™¨æœ¬èº«ï¼Œä¾¿äºé“¾å¼è°ƒç”¨ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IServiceCollection <span class="title">AddAllDbContexts</span>(<span class="params"><span class="keyword">this</span> IServiceCollection services, Action&lt;DbContextOptionsBuilder&gt; builder,</span></span></span><br><span class="line"><span class="params"><span class="function">        IEnumerable&lt;Assembly&gt; assemblies</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å®šä¹‰ AddDbContext æ³›å‹æ‰©å±•æ–¹æ³•çš„å‚æ•°ç±»å‹æ•°ç»„</span></span><br><span class="line">        Type[] types = <span class="keyword">new</span> Type[] &#123; <span class="keyword">typeof</span>(IServiceCollection), <span class="keyword">typeof</span>(Action&lt;DbContextOptionsBuilder&gt;), <span class="keyword">typeof</span>(ServiceLifetime), <span class="keyword">typeof</span>(ServiceLifetime) &#125;;</span><br><span class="line">        <span class="comment">// é€šè¿‡åå°„è·å– EntityFrameworkServiceCollectionExtensions.AddDbContext&lt;TContext&gt; æ³›å‹æ–¹æ³•ä¿¡æ¯</span></span><br><span class="line">        <span class="keyword">var</span> methodAddDbContext = <span class="keyword">typeof</span>(EntityFrameworkServiceCollectionExtensions)</span><br><span class="line">            .GetMethod(<span class="keyword">nameof</span>(EntityFrameworkServiceCollectionExtensions.AddDbContext), <span class="number">1</span>, types);</span><br><span class="line">        <span class="comment">// éå†æ‰€æœ‰ä¼ å…¥çš„ç¨‹åºé›†</span></span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">var</span> asmToLoad <span class="keyword">in</span> assemblies)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// è·å–ç¨‹åºé›†ä¸­çš„æ‰€æœ‰ç±»å‹</span></span><br><span class="line">            Type[] typesInAsm = asmToLoad.GetTypes();</span><br><span class="line">            <span class="comment">// æŸ¥æ‰¾æ‰€æœ‰éæŠ½è±¡ä¸”ç»§æ‰¿è‡ª DbContext çš„ç±»å‹</span></span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> dbCtxType <span class="keyword">in</span> typesInAsm</span><br><span class="line">                .Where(t =&gt; !t.IsAbstract &amp;&amp; <span class="keyword">typeof</span>(DbContext).IsAssignableFrom(t)))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// æ„é€  AddDbContext&lt;TContext&gt; æ³›å‹æ–¹æ³•</span></span><br><span class="line">                <span class="keyword">var</span> methodGenericAddDbContext = methodAddDbContext.MakeGenericMethod(dbCtxType);</span><br><span class="line">                <span class="comment">// è°ƒç”¨ AddDbContext&lt;TContext&gt; æ–¹æ³•ï¼Œå°† DbContext æ³¨å†Œåˆ°æœåŠ¡å®¹å™¨</span></span><br><span class="line">                methodAddDbContext.Invoke(<span class="literal">null</span>, <span class="keyword">new</span> <span class="built_in">object</span>[]</span><br><span class="line">                &#123;</span><br><span class="line">                    services,                <span class="comment">// ä¾èµ–æ³¨å…¥æœåŠ¡å®¹å™¨</span></span><br><span class="line">                    builder,                 <span class="comment">// DbContext é…ç½®å§”æ‰˜</span></span><br><span class="line">                    ServiceLifetime.Scoped,  <span class="comment">// DbContext ç”Ÿå‘½å‘¨æœŸä¸º Scoped</span></span><br><span class="line">                    ServiceLifetime.Singleton<span class="comment">// é€‰é¡¹ç”Ÿå‘½å‘¨æœŸä¸º Singleton</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è¿”å›æœåŠ¡å®¹å™¨æœ¬èº«</span></span><br><span class="line">        <span class="keyword">return</span> services;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½ è¿™æ®µä»£ç å®ç°äº†ä¸€ä¸ª æ‰¹é‡æ³¨å†Œæ‰€æœ‰ DbContext çš„å·¥å…·æ–¹æ³• AddAllDbContextsï¼Œç”¨äºè‡ªåŠ¨æ‰«æå¹¶æ³¨å†Œå¤šä¸ªç¨‹åºé›†ä¸­çš„æ‰€æœ‰ DbContext ç±»å‹ï¼Œé¿å…äº†æ‰‹åŠ¨ä¸€ä¸ªä¸€ä¸ªå†™ services.AddDbContext&amp;ltMyContext&gt;()ã€‚</p><h2 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h2><h3 id="åå°„æŸ¥æ‰¾-AddDbContext-æ–¹æ³•"><a href="#åå°„æŸ¥æ‰¾-AddDbContext-æ–¹æ³•" class="headerlink" title="åå°„æŸ¥æ‰¾ AddDbContext&lt;TContext&gt;() æ–¹æ³•"></a>åå°„æŸ¥æ‰¾ AddDbContext&lt;TContext&gt;() æ–¹æ³•</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Type[] types = <span class="keyword">new</span> Type[] &#123; <span class="keyword">typeof</span>(IServiceCollection), <span class="keyword">typeof</span>(Action&lt;DbContextOptionsBuilder&gt;), <span class="keyword">typeof</span>(ServiceLifetime), <span class="keyword">typeof</span>(ServiceLifetime) &#125;;</span><br><span class="line"><span class="keyword">var</span> methodAddDbContext = <span class="keyword">typeof</span>(EntityFrameworkServiceCollectionExtensions)</span><br><span class="line">    .GetMethod(<span class="keyword">nameof</span>(EntityFrameworkServiceCollectionExtensions.AddDbContext), <span class="number">1</span>, types);</span><br></pre></td></tr></table></figure><p>ç›®æ ‡æ˜¯æ‰¾åˆ° EF Core ä¸­çš„æ³›å‹æ–¹æ³• <code>AddDbContext&lt;TContext&gt;(this IServiceCollection, Action&lt;DbContextOptionsBuilder&gt;, ServiceLifetime, ServiceLifetime)</code><br>GetMethod çš„å‚æ•° 1 è¡¨ç¤ºè¿™ä¸ªæ–¹æ³•æœ‰ 1 ä¸ªæ³›å‹ç±»å‹å‚æ•°ã€‚</p><p>æ–¹æ³•ç­¾åä¸­å‚æ•°ä¸ºï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">AddDbContext&lt;TContext&gt;(</span><br><span class="line">  <span class="keyword">this</span> IServiceCollection services,</span><br><span class="line">  Action&lt;DbContextOptionsBuilder&gt; optionsAction,</span><br><span class="line">  ServiceLifetime contextLifetime,</span><br><span class="line">  ServiceLifetime optionsLifetime</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="æ‰«ææ‰€æœ‰ç¨‹åºé›†ä¸­çš„ç±»å‹å¹¶ç­›é€‰-DbContext"><a href="#æ‰«ææ‰€æœ‰ç¨‹åºé›†ä¸­çš„ç±»å‹å¹¶ç­›é€‰-DbContext" class="headerlink" title="æ‰«ææ‰€æœ‰ç¨‹åºé›†ä¸­çš„ç±»å‹å¹¶ç­›é€‰ DbContext"></a>æ‰«ææ‰€æœ‰ç¨‹åºé›†ä¸­çš„ç±»å‹å¹¶ç­›é€‰ DbContext</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> asmToLoad <span class="keyword">in</span> assemblies)</span><br><span class="line">&#123;</span><br><span class="line">    Type[] typesInAsm = asmToLoad.GetTypes();</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="keyword">var</span> dbCtxType <span class="keyword">in</span> typesInAsm</span><br><span class="line">        .Where(t =&gt; !t.IsAbstract &amp;&amp; <span class="keyword">typeof</span>(DbContext).IsAssignableFrom(t)))</span><br></pre></td></tr></table></figure><p>æ‰¾å‡ºå½“å‰ç¨‹åºé›†ä¸­æ‰€æœ‰ç»§æ‰¿è‡ª DbContext ä¸”ä¸æ˜¯æŠ½è±¡ç±»çš„ç±»å‹ã€‚</p><h3 id="è°ƒç”¨æ³›å‹æ–¹æ³•-AddDbContext"><a href="#è°ƒç”¨æ³›å‹æ–¹æ³•-AddDbContext" class="headerlink" title="è°ƒç”¨æ³›å‹æ–¹æ³• AddDbContext&lt;TContext&gt;"></a>è°ƒç”¨æ³›å‹æ–¹æ³• AddDbContext&lt;TContext&gt;</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> methodGenericAddDbContext = methodAddDbContext.MakeGenericMethod(dbCtxType);</span><br><span class="line">methodGenericAddDbContext.Invoke(<span class="literal">null</span>, <span class="keyword">new</span> <span class="built_in">object</span>[]</span><br><span class="line">&#123;</span><br><span class="line">    services,</span><br><span class="line">    builder,</span><br><span class="line">    ServiceLifetime.Scoped,</span><br><span class="line">    ServiceLifetime.Singleton</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>å…ˆæ„é€ æ³›å‹æ–¹æ³•ï¼šæ¯”å¦‚ AddDbContext&lt;MyDbContext&gt;()<br>ç„¶ååå°„è°ƒç”¨å®ƒï¼Œä¼ å…¥å››ä¸ªå‚æ•°ã€‚</p><p>servicesä¾èµ–æ³¨å…¥å®¹å™¨<br>builder    ç”¨æˆ·ä¼ å…¥çš„ ctx &#x3D;&gt; ctx.UseSqlServer(â€¦) å§”æ‰˜<br>Scoped    DbContext å®ä¾‹çš„ç”Ÿå‘½å‘¨æœŸï¼ˆæ¨èä½¿ç”¨ Scopedï¼‰<br>Singletoné…ç½®é€‰é¡¹çš„ç”Ÿå‘½å‘¨æœŸï¼ˆé€šå¸¸ Singleton å°±å¯ä»¥ï¼‰</p>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ASP.NET Core </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å®¾è¯­ä»å¥</title>
      <link href="/2025/08/07/asp.net%20core/%E8%8B%B1%E8%AF%AD/%E5%AE%BE%E8%AF%AD%E4%BB%8E%E5%8F%A5/"/>
      <url>/2025/08/07/asp.net%20core/%E8%8B%B1%E8%AF%AD/%E5%AE%BE%E8%AF%AD%E4%BB%8E%E5%8F%A5/</url>
      
        <content type="html"><![CDATA[<h1 id="å®¾è¯­ä»å¥"><a href="#å®¾è¯­ä»å¥" class="headerlink" title="å®¾è¯­ä»å¥"></a>å®¾è¯­ä»å¥</h1><p>å®¾è¯­ä»å¥æ˜¯åè¯æ€§ä»å¥çš„ä¸€ç§ï¼Œåœ¨å¥å­ä¸­å……å½“å®¾è¯­ï¼Œé€šå¸¸ä½äºåŠç‰©åŠ¨è¯ã€ä»‹è¯æˆ–æŸäº›å½¢å®¹è¯ä¹‹åï¼Œç”¨æ¥è¡¨è¾¾ä¸€ä¸ªå®Œæ•´çš„æ„ä¹‰ã€‚</p><p>1.æˆ‘è¯´äº†ä¸€ä¸ªè¯ã€‚   é™ˆè¿°å¥<br>I said a word.<br>æˆ‘è¯´ä½ æ˜¯å¯¹çš„ã€‚<br>I said that you are right. Thatå¯ä»¥çœç•¥ã€‚ï¼ˆèƒ½çœè€Œä¸çœè¡¨å¼ºè°ƒï¼‰<br>Thatå¼•å¯¼<br>ç”¨äºé™ˆè¿°å¥ä½œå®¾è¯­ï¼Œæ­¤æ—¶ that åœ¨ä»å¥ä¸­ä¸å……å½“æˆåˆ†ï¼Œä¹Ÿæ— å®é™…æ„ä¹‰ï¼Œå¸¸å¯çœç•¥ï¼ˆä½†åœ¨ä»¥ä¸‹æƒ…å†µä¸å¯çœç•¥ï¼šå¤šä¸ªå®¾è¯­ä»å¥å¹¶åˆ—æ—¶ï¼Œç¬¬ä¸€ä¸ª that å¯çœï¼Œåé¢çš„ that ä¸èƒ½çœï¼›that å¼•å¯¼çš„å®¾è¯­ä»å¥ä½œä»‹è¯å®¾è¯­æ—¶ï¼‰ã€‚</p><p>2.æˆ‘æƒ³é—®ä¸€ä¸ªé—®é¢˜ã€‚        ç–‘é—®å¥<br>I want to ask a question.<br>æˆ‘æƒ³é—®ä½ å•¥æ—¶å€™æ¥æˆ‘å®¶ã€‚<br>I want to ask that when you come to my home<br>3.æˆ‘ä¸çŸ¥é“è¿™ä¸ªæ•…äº‹ã€‚&#x3D;&gt;æ¢æˆä¸€ä¸ªå¥å­å°±æ˜¯å®¾è¯­ä»å¥<br>I donâ€™t know this story.<br>æˆ‘ä¸çŸ¥é“ä»–æ˜¯æ€ä¹ˆå­¦ä¹ è‹±è¯­çš„ã€‚<br>I donâ€™t know how he studies English.<br>4.æˆ‘è®¤ä¸ºä»–èƒ½è§£å†³è¿™ä¸ªé—®é¢˜ã€‚<br>I think that he can solve the problem.</p><p>5.æˆ‘æƒ³çŸ¥é“æˆ‘æ˜¯å¦èƒ½åšåˆ°è¿™ä»¶äº‹æƒ…ã€‚ ç–‘é—®å¥åšå®¾è¯­<br>I want to know whether I can do this.<br>6.ä»–å‘Šè¯‰äº†æˆ‘ä»–ä½åœ¨å“ªé‡Œã€‚<br>He told me where he lives.<br>7.æˆ‘ä¸ç†è§£è¿™ä¸ªé—®é¢˜-&gt;ä»–ä¸ºä»€ä¹ˆæƒ³å»å›¾ä¹¦é¦†ã€‚<br>I donâ€™t understand why he wants to go to the library.<br>8.æˆ‘æƒ³çŸ¥é“ä½ å–œæ¬¢å“ªä¸ªè‹¹æœã€‚<br>I want to know which apple you like.</p><h2 id="ä¹ é¢˜ï¼š"><a href="#ä¹ é¢˜ï¼š" class="headerlink" title="ä¹ é¢˜ï¼š"></a>ä¹ é¢˜ï¼š</h2><p>æˆ‘ä¸çŸ¥é“ä»–æ˜¯å¦ä¼šæ¥ã€‚<br>I donâ€™t know whether he will come.</p><p>å¥¹é—®æˆ‘ä¸ºå•¥æˆ‘è¿˜æ²¡å†™å®Œä½œä¸šã€‚<br>She asked me why I have not finished my homework.</p><p>ä»–ä»¬ç›¸ä¿¡åœ°çƒç»•ç€å¤ªé˜³è½¬ã€‚<br>They believe the Earth goes around the Sun.</p><p>æˆ‘ç†è§£å¥¹è¿™ä¹ˆåšçš„åŸå› ã€‚<br>I understand why he did this.</p><p>æˆ‘ä¸è®°å¾—æˆ‘æ”¾é’¥åŒ™çš„åœ°æ–¹ã€‚<br>I donâ€™t remember where I put the key </p><h1 id="éœ€è¦åŠ -â€œtoâ€-çš„å¸¸è§æƒ…å†µ"><a href="#éœ€è¦åŠ -â€œtoâ€-çš„å¸¸è§æƒ…å†µ" class="headerlink" title="éœ€è¦åŠ  â€œtoâ€ çš„å¸¸è§æƒ…å†µ"></a>éœ€è¦åŠ  â€œtoâ€ çš„å¸¸è§æƒ…å†µ</h1><p>ä¸€ã€è¡¨ç¤º â€œè®¡åˆ’ã€æ‰“ç®—ã€å†³å®šâ€ çš„åŠ¨è¯<br>è¿™ç±»åŠ¨è¯åæ¥ä¸å®šå¼ï¼Œè¯´æ˜å…·ä½“çš„è®¡åˆ’æˆ–ç›®æ ‡ï¼š</p><p>â€¢plan toï¼šè®¡åˆ’åšæŸäº‹<br>ä¾‹ï¼šWe plan to visit the museum tomorrow.ï¼ˆæˆ‘ä»¬è®¡åˆ’æ˜å¤©å»åšç‰©é¦†ã€‚ï¼‰<br>â€¢decide toï¼šå†³å®šåšæŸäº‹<br>ä¾‹ï¼šShe decided to study abroad.ï¼ˆå¥¹å†³å®šå‡ºå›½ç•™å­¦ã€‚ï¼‰<br>â€¢intend toï¼šæ‰“ç®—åšæŸäº‹<br>ä¾‹ï¼šI intend to finish the report by Friday.ï¼ˆæˆ‘æ‰“ç®—å‘¨äº”å‰å®ŒæˆæŠ¥å‘Šã€‚ï¼‰<br>äºŒã€è¡¨ç¤º â€œå¸Œæœ›ã€æœŸæœ›ã€æ¸´æœ›â€ çš„åŠ¨è¯<br>åæ¥ä¸å®šå¼è¡¨è¾¾å¯¹æœªæ¥çš„æ„¿æœ›æˆ–æœŸå¾…ï¼š</p><p>â€¢hope toï¼šå¸Œæœ›åšæŸäº‹<br>ä¾‹ï¼šHe hopes to pass the exam.ï¼ˆä»–å¸Œæœ›é€šè¿‡è€ƒè¯•ã€‚ï¼‰<br>â€¢expect toï¼šæœŸå¾…åšæŸäº‹<br>ä¾‹ï¼šThey expect to arrive at 6 PM.ï¼ˆä»–ä»¬é¢„è®¡ä¸‹åˆ 6 ç‚¹åˆ°è¾¾ã€‚ï¼‰<br>â€¢wish toï¼šæ¸´æœ›åšæŸäº‹ï¼ˆè¾ƒæ­£å¼ï¼‰<br>ä¾‹ï¼šI wish to speak with the manager.ï¼ˆæˆ‘æƒ³å’Œç»ç†è°ˆè°ˆã€‚ï¼‰<br>â€¢long toï¼šæ¸´æœ›åšæŸäº‹ï¼ˆè¯­æ°”è¾ƒå¼ºï¼‰<br>ä¾‹ï¼šShe longs to see her family again.ï¼ˆå¥¹æ¸´æœ›å†æ¬¡è§åˆ°å®¶äººã€‚ï¼‰<br>ä¸‰ã€è¡¨ç¤º â€œåŠªåŠ›ã€å°è¯•ã€è®¾æ³•â€ çš„åŠ¨è¯<br>åæ¥ä¸å®šå¼è¯´æ˜å…·ä½“çš„è¡ŒåŠ¨æˆ–åŠªåŠ›çš„ç›®æ ‡ï¼š</p><p>â€¢try toï¼šå°è¯•åšæŸäº‹<br>ä¾‹ï¼šHe tried to open the door, but it was locked.ï¼ˆä»–è¯•ç€å¼€é—¨ï¼Œä½†é—¨é”äº†ã€‚ï¼‰<br>â€¢attempt toï¼šè¯•å›¾åšæŸäº‹ï¼ˆè¾ƒæ­£å¼ï¼Œå¼ºè°ƒåŠªåŠ›è¿‡ç¨‹ï¼‰<br>ä¾‹ï¼šThey attempted to climb the mountain in winter.ï¼ˆä»–ä»¬è¯•å›¾åœ¨å†¬å¤©çˆ¬å±±ã€‚ï¼‰<br>â€¢manage toï¼šè®¾æ³•åšæˆæŸäº‹ï¼ˆå¼ºè°ƒç»“æœæˆåŠŸï¼‰<br>ä¾‹ï¼šShe managed to solve the problem alone.ï¼ˆå¥¹è®¾æ³•ç‹¬è‡ªè§£å†³äº†é—®é¢˜ã€‚ï¼‰<br>å››ã€è¡¨ç¤º â€œéœ€è¦ã€å¿…é¡»ã€åº”è¯¥â€ çš„åŠ¨è¯ &#x2F; çŸ­è¯­<br>åæ¥ä¸å®šå¼è¯´æ˜éœ€è¦å®Œæˆçš„åŠ¨ä½œï¼š</p><p>â€¢need toï¼šéœ€è¦åšæŸäº‹<br>ä¾‹ï¼šYou need to drink more water.ï¼ˆä½ éœ€è¦å¤šå–æ°´ã€‚ï¼‰<br>â€¢have toï¼šå¿…é¡»åšæŸäº‹ï¼ˆå¼ºè°ƒå®¢è§‚è¦æ±‚ï¼‰<br>ä¾‹ï¼šWe have to wear uniforms at school.ï¼ˆæˆ‘ä»¬åœ¨å­¦æ ¡å¿…é¡»ç©¿æ ¡æœã€‚ï¼‰<br>â€¢ought toï¼šåº”è¯¥åšæŸäº‹ï¼ˆè¯­æ°”è¾ƒå§”å©‰çš„å»ºè®®ï¼‰<br>ä¾‹ï¼šYou ought to apologize for your mistake.ï¼ˆä½ åº”è¯¥ä¸ºä½ çš„é”™è¯¯é“æ­‰ã€‚ï¼‰<br>äº”ã€è¡¨ç¤º â€œåŒæ„ã€æ‹’ç»ã€æ‰¿è¯ºâ€ çš„åŠ¨è¯<br>åæ¥ä¸å®šå¼è¯´æ˜å…·ä½“çš„æ€åº¦æˆ–æ‰¿è¯ºçš„å†…å®¹ï¼š</p><p>â€¢agree toï¼šåŒæ„åšæŸäº‹<br>ä¾‹ï¼šHe agreed to help me with the project.ï¼ˆä»–åŒæ„å¸®æˆ‘åšè¿™ä¸ªé¡¹ç›®ã€‚ï¼‰<br>â€¢refuse toï¼šæ‹’ç»åšæŸäº‹<br>ä¾‹ï¼šShe refused to answer the question.ï¼ˆå¥¹æ‹’ç»å›ç­”è¿™ä¸ªé—®é¢˜ã€‚ï¼‰<br>â€¢promise toï¼šæ‰¿è¯ºåšæŸäº‹<br>ä¾‹ï¼šHe promised to be on time.ï¼ˆä»–æ‰¿è¯ºä¼šå‡†æ—¶åˆ°ã€‚ï¼‰<br>å…­ã€å…¶ä»–å¸¸ç”¨åŠ¨è¯çŸ­è¯­<br>â€¢forget toï¼šå¿˜è®°åšæŸäº‹ï¼ˆäº‹æƒ…æœªåšï¼‰<br>ä¾‹ï¼šDonâ€™t forget to turn off the lights.ï¼ˆåˆ«å¿˜äº†å…³ç¯ã€‚ï¼‰<br>â€¢remember toï¼šè®°å¾—åšæŸäº‹ï¼ˆäº‹æƒ…éœ€è¦åšï¼‰<br>ä¾‹ï¼šRemember to call your mom.ï¼ˆè®°å¾—ç»™ä½ å¦ˆå¦ˆæ‰“ç”µè¯ã€‚ï¼‰<br>â€¢seem toï¼šä¼¼ä¹ &#x2F; å¥½åƒåšæŸäº‹<br>ä¾‹ï¼šHe seems to know the answer.ï¼ˆä»–å¥½åƒçŸ¥é“ç­”æ¡ˆã€‚ï¼‰<br>â€¢appear toï¼šçœ‹èµ·æ¥åšæŸäº‹<br>ä¾‹ï¼šThe sun appears to rise in the east.ï¼ˆå¤ªé˜³çœ‹èµ·æ¥ä»ä¸œæ–¹å‡èµ·ã€‚ï¼‰<br>â€¢offer toï¼šä¸»åŠ¨æå‡ºåšæŸäº‹<br>ä¾‹ï¼šShe offered to carry my bag.ï¼ˆå¥¹ä¸»åŠ¨æå‡ºå¸®æˆ‘æ‹¿åŒ…ã€‚ï¼‰<br>â€¢afford toï¼šæœ‰èƒ½åŠ›åšæŸäº‹ï¼ˆå¸¸ä¸ can&#x2F;canâ€™t è¿ç”¨ï¼‰<br>ä¾‹ï¼šWe canâ€™t afford to buy a new car.ï¼ˆæˆ‘ä»¬ä¹°ä¸èµ·æ–°è½¦ã€‚ï¼‰</p>]]></content>
      
      
      <categories>
          
          <category> English </category>
          
      </categories>
      
      
        <tags>
            
            <tag> English </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‰§è¡Œæ‰€æœ‰æ¨¡å—çš„åˆå§‹åŒ–æ–¹æ³•</title>
      <link href="/2025/08/06/asp.net%20core/%E5%AD%A6%E8%8B%B1%E8%AF%AD%E7%BD%91%E7%AB%99%E9%A1%B9%E7%9B%AE/%E6%89%A7%E8%A1%8C%E6%89%80%E6%9C%89%E6%A8%A1%E5%9D%97%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96%E6%96%B9%E6%B3%95/"/>
      <url>/2025/08/06/asp.net%20core/%E5%AD%A6%E8%8B%B1%E8%AF%AD%E7%BD%91%E7%AB%99%E9%A1%B9%E7%9B%AE/%E6%89%A7%E8%A1%8C%E6%89%80%E6%9C%89%E6%A8%A1%E5%9D%97%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸ºä»€ä¹ˆè¦æ‰§è¡Œæ¨¡å—åˆå§‹åŒ–"><a href="#ä¸ºä»€ä¹ˆè¦æ‰§è¡Œæ¨¡å—åˆå§‹åŒ–" class="headerlink" title="ä¸ºä»€ä¹ˆè¦æ‰§è¡Œæ¨¡å—åˆå§‹åŒ–"></a>ä¸ºä»€ä¹ˆè¦æ‰§è¡Œæ¨¡å—åˆå§‹åŒ–</h1><p>æ¯ä¸ªæ¨¡å—å¯èƒ½æœ‰è‡ªå·±çš„ä¾èµ–æœåŠ¡ï¼ˆæ¯”å¦‚ä»“å‚¨ã€æœåŠ¡ç±»ã€é…ç½®ç­‰ï¼‰ï¼Œåˆå§‹åŒ–æ—¶ç»Ÿä¸€æ³¨å†Œåˆ°ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰å®¹å™¨ã€‚</p><p>ä¹‹å‰æˆ‘ä»¬åˆ›å»ºReflectionHelperæ–¹æ³•è¿›è¡Œç¨‹åºé›†çš„è·å–ã€‚<br>è·å–ä¹‹åå¾—è®©ä»–ä»¬å‡†å¤‡å¥½è¿è¡Œèµ·æ¥ã€‚</p><p>å¥½å¤„ï¼šä¼ ç»Ÿå†™æ³•æŠŠæ‰€æœ‰æœåŠ¡æ³¨å†Œå†™åœ¨ Program.csï¼Œéšç€æ¨¡å—å¢å¤šä»£ç ä¼šéå¸¸æ··ä¹±ã€‚è€Œç”¨åˆå§‹åŒ–å™¨ï¼Œæ¯ä¸ªæ¨¡å—åªç®¡è‡ªå·±ï¼Œæ¸…æ™°æ˜äº†ï¼ŒèŒè´£å•ä¸€ã€‚</p><h2 id="æ‰¾åˆ°æ‰€æœ‰å®ç°åˆå§‹åŒ–æ¥å£çš„ç±»"><a href="#æ‰¾åˆ°æ‰€æœ‰å®ç°åˆå§‹åŒ–æ¥å£çš„ç±»" class="headerlink" title="æ‰¾åˆ°æ‰€æœ‰å®ç°åˆå§‹åŒ–æ¥å£çš„ç±»"></a>æ‰¾åˆ°æ‰€æœ‰å®ç°åˆå§‹åŒ–æ¥å£çš„ç±»</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IModuleInitializer</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> åˆå§‹åŒ–æ¨¡å—ï¼Œå°†æ‰€éœ€æœåŠ¡æ³¨å†Œåˆ° <span class="doctag">&lt;see cref=&quot;IServiceCollection&quot;/&gt;</span> ä¸­ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;services&quot;&gt;</span>æœåŠ¡é›†åˆï¼Œç”¨äºæ³¨å†Œä¾èµ–é¡¹ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Initialize</span>(<span class="params">IServiceCollection services</span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥æ¥å£çš„æ ¸å¿ƒç›®çš„æ˜¯ä¸ºæ¯ä¸ªç‹¬ç«‹æ¨¡å—æä¾›ä¸€ä¸ªæ³¨å†Œä¾èµ–æ³¨å…¥æœåŠ¡çš„ç»Ÿä¸€å…¥å£ç‚¹ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyModuleA</span> : <span class="title">IModuleInitializer</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Initialize</span>(<span class="params">IServiceCollection services</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// æ³¨å†ŒæœåŠ¡</span></span><br><span class="line">        services.AddSingleton&lt;IMyService, MyService&gt;();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ¥å£çš„æ¨¡å—åˆå§‹åŒ–å™¨"><a href="#æ¥å£çš„æ¨¡å—åˆå§‹åŒ–å™¨" class="headerlink" title="æ¥å£çš„æ¨¡å—åˆå§‹åŒ–å™¨"></a>æ¥å£çš„æ¨¡å—åˆå§‹åŒ–å™¨</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">ModuleInitializerExtensions</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æ‰§è¡ŒæŒ‡å®šç¨‹åºé›†ä¸­çš„æ‰€æœ‰å®ç° <span class="doctag">&lt;see cref=&quot;IModuleInitializer&quot;/&gt;</span> æ¥å£çš„æ¨¡å—åˆå§‹åŒ–å™¨ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;services&quot;&gt;</span>æœåŠ¡é›†åˆã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;assemblies&quot;&gt;</span>è¦æ‰«æçš„ç¨‹åºé›†é›†åˆã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>æœåŠ¡é›†åˆæœ¬èº«ï¼Œä¾¿äºé“¾å¼è°ƒç”¨ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;exception cref=&quot;ApplicationException&quot;&gt;</span>æ— æ³•åˆ›å»ºæ¨¡å—åˆå§‹åŒ–å™¨å®ä¾‹æ—¶æŠ›å‡ºã€‚<span class="doctag">&lt;/exception&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IServiceCollection <span class="title">RunModuleInitializers</span>(<span class="params"><span class="keyword">this</span> IServiceCollection services,</span></span></span><br><span class="line"><span class="params"><span class="function">      IEnumerable&lt;Assembly&gt; assemblies</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">var</span> asm <span class="keyword">in</span> assemblies)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// è·å–ç¨‹åºé›†ä¸­çš„æ‰€æœ‰ç±»å‹</span></span><br><span class="line">            Type[] types = asm.GetTypes();</span><br><span class="line">            <span class="comment">// æŸ¥æ‰¾æ‰€æœ‰éæŠ½è±¡ä¸”å®ç°äº† IModuleInitializer æ¥å£çš„ç±»å‹</span></span><br><span class="line">            <span class="keyword">var</span> moduleInitializerTypes = types.Where(t =&gt; !t.IsAbstract &amp;&amp; <span class="keyword">typeof</span>(IModuleInitializer).IsAssignableFrom(t));</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> implType <span class="keyword">in</span> moduleInitializerTypes)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// åˆ›å»ºæ¨¡å—åˆå§‹åŒ–å™¨å®ä¾‹</span></span><br><span class="line">                <span class="keyword">var</span> initializer = (IModuleInitializer?)Activator.CreateInstance(implType);</span><br><span class="line">                <span class="keyword">if</span> (initializer == <span class="literal">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> ApplicationException(<span class="string">$&quot;Cannot create $<span class="subst">&#123;implType&#125;</span>&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// è°ƒç”¨åˆå§‹åŒ–æ–¹æ³•</span></span><br><span class="line">                initializer.Initialize(services);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> services;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IServiceCollection <span class="title">RunModuleInitializers</span>(<span class="params"><span class="keyword">this</span> IServiceCollection services, IEnumerable&lt;Assembly&gt; assemblies</span>)</span></span><br></pre></td></tr></table></figure><p>æ˜¯ä¸€ä¸ªæ‰©å±•æ–¹æ³•ï¼šæŒ‚åœ¨IServiceCollectionä¸Šï¼Œå¯ä»¥<code>é“¾å¼è°ƒç”¨</code>ã€‚<br>æ¥æ”¶ä¸€ç»„ç¨‹åºé›†å‚æ•°assembiesï¼Œç”¨äºæ¨¡å—æ‰«æã€‚</p><p><b>ä»€ä¹ˆæ˜¯é“¾å¼è°ƒç”¨ï¼š</b>é“¾å¼è°ƒç”¨ï¼ˆFluent Interface æˆ–å« Method Chainingï¼‰æ˜¯ä¸€ç§ç¼–ç¨‹é£æ ¼ï¼Œå…¶ç‰¹ç‚¹æ˜¯è¿ç»­è°ƒç”¨å¤šä¸ªæ–¹æ³•ï¼Œæ¯ä¸ªæ–¹æ³•è°ƒç”¨ä¹‹åéƒ½è¿”å›å½“å‰å¯¹è±¡æˆ–å…¶ä»–å¯¹è±¡ï¼Œä»¥ä¾¿ç»§ç»­è°ƒç”¨ä¸‹ä¸€ä¸ªæ–¹æ³•ã€‚<br>ç¤ºä¾‹ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">builder.Services</span><br><span class="line">    .AddControllers()</span><br><span class="line">    .AddSwaggerGen()</span><br><span class="line">    .RunModuleInitializers(assemblies);</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> asm <span class="keyword">in</span> assemblies)</span><br><span class="line">&#123;</span><br><span class="line">    Type[] types = asm.GetTypes();</span><br></pre></td></tr></table></figure><p>éå†æ¯ä¸ªç¨‹åºé›†ï¼Œå–å‡ºæ‰€æœ‰ç±»å‹ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> moduleInitializerTypes = types.Where(t =&gt; !t.IsAbstract &amp;&amp; <span class="keyword">typeof</span>(IModuleInitializer).IsAssignableFrom(t));</span><br></pre></td></tr></table></figure><p>æ‰¾å‡ºæ‰€æœ‰éæŠ½è±¡ç±»ï¼Œå®ç°äº†IModuleInitializeræ¥å£ç±»å‹ï¼ˆåŒ…æ‹¬ç»§æ‰¿çš„ï¼‰</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> implType <span class="keyword">in</span> moduleInitializerTypes)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> initializer = (IModuleInitializer?)Activator.CreateInstance(implType);</span><br><span class="line">    <span class="keyword">if</span> (initializer == <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> ApplicationException(<span class="string">$&quot;Cannot create $<span class="subst">&#123;implType&#125;</span>&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨åå°„åˆ›å»ºæ¨¡å—åˆå§‹åŒ–å®ä¾‹ã€‚<br>å¦‚æœåˆ›å»ºå¤±è´¥ï¼ˆè¿”å›ullï¼‰,æŠ›å‡ºå¼‚å¸¸ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">    initializer.Initialize(services);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è°ƒç”¨æ¨¡å—åˆå§‹åŒ–é€»è¾‘ï¼Œè®©æ¨¡å—æŠŠè‡ªå·±çš„æœåŠ¡æ³¨å…¥è¿›æ¥ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> services;</span><br></pre></td></tr></table></figure><p>è¿”å›è‡ªèº«ï¼Œä¾¿äºé“¾å¼è°ƒç”¨ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ASP.NET Core </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•è·å–æ‰€æœ‰å¼•ç”¨çš„ç¨‹åºé›†ï¼Œç”¨äºåç»­æ¨¡å—åˆå§‹åŒ–å’Œä¾èµ–æ³¨å…¥</title>
      <link href="/2025/08/04/asp.net%20core/%E5%AD%A6%E8%8B%B1%E8%AF%AD%E7%BD%91%E7%AB%99%E9%A1%B9%E7%9B%AE/%E8%8E%B7%E5%8F%96%E6%89%80%E6%9C%89%E5%BC%95%E7%94%A8%E7%9A%84%E7%A8%8B%E5%BA%8F%E9%9B%86%EF%BC%8C%E7%94%A8%E4%BA%8E%E5%90%8E%E7%BB%AD%E6%A8%A1%E5%9D%97%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/"/>
      <url>/2025/08/04/asp.net%20core/%E5%AD%A6%E8%8B%B1%E8%AF%AD%E7%BD%91%E7%AB%99%E9%A1%B9%E7%9B%AE/%E8%8E%B7%E5%8F%96%E6%89%80%E6%9C%89%E5%BC%95%E7%94%A8%E7%9A%84%E7%A8%8B%E5%BA%8F%E9%9B%86%EF%BC%8C%E7%94%A8%E4%BA%8E%E5%90%8E%E7%BB%AD%E6%A8%A1%E5%9D%97%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<h1 id="è‡ªåŠ¨è·å–æ‰€æœ‰å¼•ç”¨çš„æœ‰æ•ˆç¨‹åºé›†ï¼ˆç¨‹åºé›†åå°„è¾…åŠ©ç±»ï¼‰"><a href="#è‡ªåŠ¨è·å–æ‰€æœ‰å¼•ç”¨çš„æœ‰æ•ˆç¨‹åºé›†ï¼ˆç¨‹åºé›†åå°„è¾…åŠ©ç±»ï¼‰" class="headerlink" title="è‡ªåŠ¨è·å–æ‰€æœ‰å¼•ç”¨çš„æœ‰æ•ˆç¨‹åºé›†ï¼ˆç¨‹åºé›†åå°„è¾…åŠ©ç±»ï¼‰"></a>è‡ªåŠ¨è·å–æ‰€æœ‰å¼•ç”¨çš„æœ‰æ•ˆç¨‹åºé›†ï¼ˆç¨‹åºé›†åå°„è¾…åŠ©ç±»ï¼‰</h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">YU.Commons</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æä¾›åå°„ç›¸å…³çš„è¾…åŠ©æ–¹æ³•ï¼Œå¦‚ç¨‹åºé›†æŸ¥æ‰¾ã€åŠ è½½ã€åˆ¤æ–­ç­‰ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">ReflectionHelper</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ ¹æ®äº§å“åç§°è·å–å½“å‰åº”ç”¨åŸŸä¸­æ‰€æœ‰åŒ¹é…çš„ç¨‹åºé›†ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;productName&quot;&gt;</span>äº§å“åç§°ï¼ˆå…¬å¸åï¼‰ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>æ‰€æœ‰åŒ¹é…çš„ç¨‹åºé›†é›†åˆã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IEnumerable&lt;Assembly&gt; <span class="title">GetAssembliesByProductName</span>(<span class="params"><span class="built_in">string</span> productName</span>)</span> </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> asms = AppDomain.CurrentDomain.GetAssemblies(); <span class="comment">// è·å–å½“å‰åº”ç”¨åŸŸä¸­çš„æ‰€æœ‰å·²åŠ è½½ç¨‹åºé›†</span></span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> asm <span class="keyword">in</span> asms) <span class="comment">//éå†æ¯ä¸ªç¨‹åºé›†</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// è·å–ç¨‹åºé›†çš„å…¬å¸å±æ€§</span></span><br><span class="line">                <span class="keyword">var</span> asmCompanyAttr = asm.GetCustomAttribute&lt;AssemblyCompanyAttribute&gt;();</span><br><span class="line">                <span class="keyword">if</span> (asmCompanyAttr != <span class="literal">null</span> &amp;&amp; asmCompanyAttr.Company == productName)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">yield</span> <span class="keyword">return</span> asm; <span class="comment">// å¦‚æœå…¬å¸ååŒ¹é…ï¼Œåˆ™è¿”å›è¯¥ç¨‹åºé›†</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> åˆ¤æ–­ç¨‹åºé›†æ˜¯å¦ä¸ºç³»ç»Ÿç¨‹åºé›†ï¼ˆé€šè¿‡å…¬å¸åæ˜¯å¦åŒ…å«&quot;Microsoft&quot;ï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;asm&quot;&gt;</span>ç¨‹åºé›†å¯¹è±¡ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>æ˜¯ç³»ç»Ÿç¨‹åºé›†è¿”å›trueï¼Œå¦åˆ™falseã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">IsSystemAssembly</span>(<span class="params">Assembly asm</span>) <span class="comment">// åˆ¤æ–­ç¨‹åºé›†æ˜¯å¦ä¸ºç³»ç»Ÿç¨‹åºé›†</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> asmCompanyAttr = asm.GetCustomAttribute&lt;AssemblyCompanyAttribute&gt;(); <span class="comment">// è·å–ç¨‹åºé›†çš„å…¬å¸å±æ€§</span></span><br><span class="line">            <span class="keyword">if</span> (asmCompanyAttr == <span class="literal">null</span>) </span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// å¦‚æœæ²¡æœ‰å…¬å¸å±æ€§ï¼Œåˆ™è®¤ä¸ºä¸æ˜¯ç³»ç»Ÿç¨‹åºé›†</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">string</span> companyName = asmCompanyAttr.Company; <span class="comment">// è·å–å…¬å¸å</span></span><br><span class="line">                <span class="keyword">return</span> companyName.Contains(<span class="string">&quot;Microsoft&quot;</span>); <span class="comment">// å¦‚æœå…¬å¸ååŒ…å«&quot;Microsoft&quot;ï¼Œåˆ™è®¤ä¸ºæ˜¯ç³»ç»Ÿç¨‹åºé›†</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> åˆ¤æ–­æŒ‡å®šè·¯å¾„çš„ç¨‹åºé›†æ–‡ä»¶æ˜¯å¦ä¸ºç³»ç»Ÿç¨‹åºé›†ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;asmPath&quot;&gt;</span>ç¨‹åºé›†æ–‡ä»¶è·¯å¾„ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>æ˜¯ç³»ç»Ÿç¨‹åºé›†è¿”å›trueï¼Œå¦åˆ™falseã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">IsSystemAssembly</span>(<span class="params"><span class="built_in">string</span> asmPath</span>) <span class="comment">// åˆ¤æ–­æŒ‡å®šè·¯å¾„çš„ç¨‹åºé›†æ–‡ä»¶æ˜¯å¦ä¸ºç³»ç»Ÿç¨‹åºé›†</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> moduleDef = AsmResolver.DotNet.ModuleDefinition.FromFile(asmPath); <span class="comment">// åŠ è½½ç¨‹åºé›†æ–‡ä»¶</span></span><br><span class="line">            <span class="keyword">var</span> assembly = moduleDef.Assembly; <span class="comment">// è·å–ç¨‹åºé›†å®šä¹‰</span></span><br><span class="line">            <span class="keyword">if</span> (assembly == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// å¦‚æœæ²¡æœ‰ç¨‹åºé›†å®šä¹‰ï¼Œåˆ™è®¤ä¸ºä¸æ˜¯ç³»ç»Ÿç¨‹åºé›†</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">var</span> asmCompanyAttr = assembly.CustomAttributes.FirstOrDefault(c =&gt; c.Constructor?.DeclaringType?.FullName == <span class="keyword">typeof</span>(AssemblyCompanyAttribute).FullName); <span class="comment">// è·å–ç¨‹åºé›†çš„å…¬å¸å±æ€§</span></span><br><span class="line">            <span class="keyword">if</span> (asmCompanyAttr == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// å¦‚æœæ²¡æœ‰å…¬å¸å±æ€§ï¼Œåˆ™è®¤ä¸ºä¸æ˜¯ç³»ç»Ÿç¨‹åºé›†</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">var</span> companyName = ((AsmResolver.Utf8String)asmCompanyAttr.Signature?.FixedArguments[<span class="number">0</span>]?.Element)?.Value;<span class="comment">// è·å–å…¬å¸å</span></span><br><span class="line">            <span class="keyword">if</span> (companyName == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;<span class="comment">// å¦‚æœå…¬å¸åä¸ºç©ºï¼Œåˆ™è®¤ä¸ºä¸æ˜¯ç³»ç»Ÿç¨‹åºé›†</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> companyName.Contains(<span class="string">&quot;Microsoft&quot;</span>); <span class="comment">// å¦‚æœå…¬å¸ååŒ…å«&quot;Microsoft&quot;ï¼Œåˆ™è®¤ä¸ºæ˜¯ç³»ç»Ÿç¨‹åºé›†</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> åˆ¤æ–­æŒ‡å®šæ–‡ä»¶æ˜¯å¦ä¸ºæ‰˜ç®¡ç¨‹åºé›†ï¼ˆ.NETç¨‹åºé›†ï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;file&quot;&gt;</span>æ–‡ä»¶è·¯å¾„ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>æ˜¯æ‰˜ç®¡ç¨‹åºé›†è¿”å›trueï¼Œå¦åˆ™falseã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">IsManagedAssembly</span>(<span class="params"><span class="built_in">string</span> file</span>)  <span class="comment">// åˆ¤æ–­æŒ‡å®šæ–‡ä»¶æ˜¯å¦ä¸ºæ‰˜ç®¡ç¨‹åºé›†</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">using</span> <span class="keyword">var</span> fs = File.OpenRead(file);<span class="comment">// æ‰“å¼€æ–‡ä»¶æµ</span></span><br><span class="line">            <span class="keyword">using</span> PEReader peReader = <span class="keyword">new</span> PEReader(fs);<span class="comment">// åˆ›å»ºPEReaderå¯¹è±¡è¯»å–PEæ–‡ä»¶</span></span><br><span class="line">            <span class="keyword">return</span> peReader.HasMetadata &amp;&amp; peReader.GetMetadataReader().IsAssembly; <span class="comment">// å¦‚æœPEæ–‡ä»¶æœ‰å…ƒæ•°æ®ä¸”æ˜¯ç¨‹åºé›†ï¼Œåˆ™è®¤ä¸ºæ˜¯æ‰˜ç®¡ç¨‹åºé›†</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å°è¯•åŠ è½½æŒ‡å®šè·¯å¾„çš„ç¨‹åºé›†ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;asmPath&quot;&gt;</span>ç¨‹åºé›†æ–‡ä»¶è·¯å¾„ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>åŠ è½½æˆåŠŸè¿”å›ç¨‹åºé›†å¯¹è±¡ï¼Œå¦åˆ™è¿”å›nullã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> Assembly? TryLoadAssembly(<span class="built_in">string</span> asmPath)</span><br><span class="line">        &#123;</span><br><span class="line">            AssemblyName asmName = AssemblyName.GetAssemblyName(asmPath);</span><br><span class="line">            Assembly? asm = <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                asm = Assembly.Load(asmName);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (BadImageFormatException ex)</span><br><span class="line">            &#123;</span><br><span class="line">                Debug.WriteLine(ex);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (FileLoadException ex)</span><br><span class="line">            &#123;</span><br><span class="line">                Debug.WriteLine(ex);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (asm == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">try</span></span><br><span class="line">                &#123;</span><br><span class="line">                    asm = Assembly.LoadFile(asmPath);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">catch</span> (BadImageFormatException ex)</span><br><span class="line">                &#123;</span><br><span class="line">                    Debug.WriteLine(ex);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">catch</span> (FileLoadException ex)</span><br><span class="line">                &#123;</span><br><span class="line">                    Debug.WriteLine(ex);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> asm;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> è·å–æ‰€æœ‰å¼•ç”¨çš„ç¨‹åºé›†ï¼ˆå¯é€‰è·³è¿‡ç³»ç»Ÿç¨‹åºé›†ï¼‰ï¼ŒåŒ…æ‹¬å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ‰˜ç®¡ç¨‹åºé›†ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;skipSystemAssemblies&quot;&gt;</span>æ˜¯å¦è·³è¿‡ç³»ç»Ÿç¨‹åºé›†ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>æ‰€æœ‰å¼•ç”¨çš„ç¨‹åºé›†é›†åˆã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IEnumerable&lt;Assembly&gt; <span class="title">GetAllReferencedAssemblies</span>(<span class="params"><span class="built_in">bool</span> skipSystemAssemblies = <span class="literal">true</span></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Assembly? rootAssembly = Assembly.GetEntryAssembly();</span><br><span class="line">            <span class="keyword">if</span> (rootAssembly == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                rootAssembly = Assembly.GetExecutingAssembly();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">var</span> returnAssemblies = <span class="keyword">new</span> HashSet&lt;Assembly&gt;(<span class="keyword">new</span> AssemblyEquality());</span><br><span class="line">            <span class="keyword">var</span> loadedAssemblies = <span class="keyword">new</span> HashSet&lt;<span class="built_in">string</span>&gt;();</span><br><span class="line">            <span class="keyword">var</span> assembliesToCheck = <span class="keyword">new</span> Queue&lt;Assembly&gt;();</span><br><span class="line">            assembliesToCheck.Enqueue(rootAssembly);</span><br><span class="line">            <span class="comment">// æ£€æŸ¥æ ¹ç¨‹åºé›†æ˜¯å¦éœ€è¦åŠ å…¥</span></span><br><span class="line">            <span class="keyword">if</span> (skipSystemAssemblies &amp;&amp; IsSystemAssembly(rootAssembly) != <span class="literal">false</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (!IsValid(rootAssembly))</span><br><span class="line">                &#123;</span><br><span class="line">                    returnAssemblies.Add(rootAssembly);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å¹¿åº¦ä¼˜å…ˆéå†æ‰€æœ‰å¼•ç”¨çš„ç¨‹åºé›†</span></span><br><span class="line">            <span class="keyword">while</span> (assembliesToCheck.Any())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">var</span> assemblyToCheck = assembliesToCheck.Dequeue();</span><br><span class="line">                <span class="keyword">foreach</span> (<span class="keyword">var</span> reference <span class="keyword">in</span> assemblyToCheck.GetReferencedAssemblies())</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (!loadedAssemblies.Contains(reference.FullName))</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">var</span> assembly = Assembly.Load(reference);</span><br><span class="line">                        <span class="keyword">if</span> (skipSystemAssemblies &amp;&amp; IsSystemAssembly(assembly))</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="keyword">continue</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        assembliesToCheck.Enqueue(assembly);</span><br><span class="line">                        loadedAssemblies.Add(reference.FullName);</span><br><span class="line">                        <span class="keyword">if</span> (IsValid(assembly))</span><br><span class="line">                        &#123;</span><br><span class="line">                            returnAssemblies.Add(assembly);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// æ‰«æå½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ‰˜ç®¡ç¨‹åºé›†</span></span><br><span class="line">            <span class="keyword">var</span> asmsInBaseDir = Directory.EnumerateFiles(AppContext.BaseDirectory,</span><br><span class="line">                <span class="string">&quot;*.dll&quot;</span>, <span class="keyword">new</span> EnumerationOptions &#123; RecurseSubdirectories = <span class="literal">true</span> &#125;);</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> asmPath <span class="keyword">in</span> asmsInBaseDir)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (!IsManagedAssembly(asmPath))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                AssemblyName asmName = AssemblyName.GetAssemblyName(asmPath);</span><br><span class="line">                <span class="keyword">if</span> (returnAssemblies.Any(x =&gt; AssemblyName.ReferenceMatchesDefinition(x.GetName(), asmName)))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (skipSystemAssemblies &amp;&amp; IsSystemAssembly(asmPath))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                Assembly? asm = TryLoadAssembly(asmPath);</span><br><span class="line">                <span class="keyword">if</span> (asm == <span class="literal">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (!IsValid(asm))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (skipSystemAssemblies &amp;&amp; IsSystemAssembly(asm))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                returnAssemblies.Add(asm);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> returnAssemblies.ToArray();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> åˆ¤æ–­ç¨‹åºé›†æ˜¯å¦æœ‰æ•ˆï¼ˆèƒ½å¦æ­£å¸¸è·å–ç±»å‹ä¿¡æ¯ï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;asm&quot;&gt;</span>ç¨‹åºé›†å¯¹è±¡ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>æœ‰æ•ˆè¿”å›trueï¼Œå¦åˆ™falseã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">IsValid</span>(<span class="params">Assembly asm</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                asm.GetTypes();</span><br><span class="line">                asm.DefinedTypes.ToList();</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (ReflectionTypeLoadException)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ç”¨äºæ¯”è¾ƒç¨‹åºé›†æ˜¯å¦ç›¸ç­‰çš„è¾…åŠ©ç±»ï¼ˆé€šè¿‡ç¨‹åºé›†åç§°ï¼‰ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">class</span> <span class="title">AssemblyEquality</span> : <span class="title">EqualityComparer</span>&lt;<span class="title">Assembly</span>&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">bool</span> <span class="title">Equals</span>(<span class="params">Assembly? x, Assembly? y</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (x == <span class="literal">null</span> &amp;&amp; y == <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (x == <span class="literal">null</span> || y == <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">return</span> AssemblyName.ReferenceMatchesDefinition(x.GetName(), y.GetName());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">int</span> <span class="title">GetHashCode</span>(<span class="params">[DisallowNull] Assembly obj</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> obj.GetName().FullName.GetHashCode();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ€»ä½“ç»“æ„è¯´æ˜"><a href="#æ€»ä½“ç»“æ„è¯´æ˜" class="headerlink" title="æ€»ä½“ç»“æ„è¯´æ˜"></a>æ€»ä½“ç»“æ„è¯´æ˜</h2><p>è¿™ä¸ªç±»æä¾›äº†ï¼š</p><p><b>GetAssembliesByProductName</b>ï¼šè·å–å½“å‰å·²ç»åŠ è½½çš„ç¨‹åºé›†ä¸­ï¼Œå…¬å¸åç­‰äºæŒ‡å®šçš„ç¨‹åºé›†ã€‚<br><b>IsSystemAssembly(Assembly)&#x2F;IsSystemAssembly(string)</b>:åˆ¤æ–­æ˜¯å¦ä¸ºç³»ç»Ÿç¨‹åºé›†ï¼ˆé€šè¿‡å…¬å¸ååˆ¤æ–­ï¼‰<br><b>IsManagedAssembly</b>:åˆ¤æ–­æŸ.dllæ–‡ä»¶æ˜¯å¦ä¸ºæ‰˜ç®¡ç¨‹åºé›†ã€‚<br><b>TryLoadAssembly</b>:å®‰å…¨åŠ è½½ä¸€ä¸ªç¨‹åºé›†ã€‚<br><b>GetAllReferencedAssemblies</b>:ä¸»æ–¹æ³•ï¼šé€’å½’è·å–æ‰€æœ‰å¼•ç”¨ç¨‹åºé›†ï¼Œå¹¶åŠ è½½å½“å‰ç›®å½•ä¸­æœ‰æ•ˆ.dllæ–‡ä»¶ã€‚<br><b>IsValid</b>:åˆ¤æ–­ç¨‹åºé›†æ˜¯å¦æœ‰æ•ˆï¼ˆèƒ½å¦è·å–ç±»å‹ï¼‰ã€‚<br><b>AssemblyEquality</b>:å¯¹ç¨‹åºé›†è¿›è¡Œæ¯”è¾ƒï¼Œé¿å…é‡å¤æ·»åŠ ã€‚</p><h2 id="åˆ†ææ¯ä¸ªéƒ¨åˆ†åŠŸèƒ½ä¸é€»è¾‘"><a href="#åˆ†ææ¯ä¸ªéƒ¨åˆ†åŠŸèƒ½ä¸é€»è¾‘" class="headerlink" title="åˆ†ææ¯ä¸ªéƒ¨åˆ†åŠŸèƒ½ä¸é€»è¾‘"></a>åˆ†ææ¯ä¸ªéƒ¨åˆ†åŠŸèƒ½ä¸é€»è¾‘</h2><h3 id="GetAssembliesByProductName"><a href="#GetAssembliesByProductName" class="headerlink" title="GetAssembliesByProductName"></a>GetAssembliesByProductName</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IEnumerable&lt;Assembly&gt; <span class="title">GetAssembliesByProductName</span>(<span class="params"><span class="built_in">string</span> productName</span>)</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> asms = AppDomain.CurrentDomain.GetAssemblies(); <span class="comment">// è·å–å½“å‰åº”ç”¨åŸŸä¸­çš„æ‰€æœ‰å·²åŠ è½½ç¨‹åºé›†</span></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="keyword">var</span> asm <span class="keyword">in</span> asms) <span class="comment">//éå†æ¯ä¸ªç¨‹åºé›†</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// è·å–ç¨‹åºé›†çš„å…¬å¸å±æ€§</span></span><br><span class="line">        <span class="keyword">var</span> asmCompanyAttr = asm.GetCustomAttribute&lt;AssemblyCompanyAttribute&gt;();</span><br><span class="line">        <span class="keyword">if</span> (asmCompanyAttr != <span class="literal">null</span> &amp;&amp; asmCompanyAttr.Company == productName)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">yield</span> <span class="keyword">return</span> asm; <span class="comment">// å¦‚æœå…¬å¸ååŒ¹é…ï¼Œåˆ™è¿”å›è¯¥ç¨‹åºé›†</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Enumerable&lt;Assembly&gt; æ˜¯ä¸€ä¸ªæ³›å‹å¯æšä¸¾ç±»å‹ï¼Œè¡¨ç¤ºä¸€ä¸ª å¯ä»¥éå†çš„ç¨‹åºé›†ï¼ˆSystem.Reflection.Assemblyï¼‰é›†åˆï¼Œé€šå¸¸ç”¨äºåå°„æ“ä½œä¸­ï¼Œæ¯”å¦‚åŠ è½½ã€ç­›é€‰ã€æ³¨å†Œç¨‹åºé›†ç­‰åœºæ™¯ã€‚<br>ä»å½“å‰åº”ç”¨åŸŸä¸­è·å–æ‰€æœ‰å·²åŠ è½½çš„ç¨‹åºé›†ï¼ˆAppDomain.CurrentDomain.GetAssembles()ï¼‰<br>æ£€æŸ¥æ¯ä¸ªç¨‹åºé›†çš„[AssemblyCompany]ç‰¹æ€§ï¼ˆå…¬å¸åï¼‰<br>è¿”å›å…¬å¸åç­‰äºæŒ‡å®šå€¼çš„ç¨‹åºé›†<br>ç”¨äºè¿‡æ»¤å‡ºâ€œå…¬å¸å†…å¼€å‘â€çš„ç¨‹åºé›†ã€‚</p></blockquote><h3 id="IsSystemAssembly-é‡è½½æ–¹æ³•"><a href="#IsSystemAssembly-é‡è½½æ–¹æ³•" class="headerlink" title="IsSystemAssembly(é‡è½½æ–¹æ³•)"></a>IsSystemAssembly(é‡è½½æ–¹æ³•)</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">IsSystemAssembly</span>(<span class="params">Assembly asm</span>) <span class="comment">// åˆ¤æ–­ç¨‹åºé›†æ˜¯å¦ä¸ºç³»ç»Ÿç¨‹åºé›†</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> asmCompanyAttr = asm.GetCustomAttribute&lt;AssemblyCompanyAttribute&gt;(); <span class="comment">// è·å–ç¨‹åºé›†çš„å…¬å¸å±æ€§</span></span><br><span class="line">    <span class="keyword">if</span> (asmCompanyAttr == <span class="literal">null</span>) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// å¦‚æœæ²¡æœ‰å…¬å¸å±æ€§ï¼Œåˆ™è®¤ä¸ºä¸æ˜¯ç³»ç»Ÿç¨‹åºé›†</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> companyName = asmCompanyAttr.Company; <span class="comment">// è·å–å…¬å¸å</span></span><br><span class="line">        <span class="keyword">return</span> companyName.Contains(<span class="string">&quot;Microsoft&quot;</span>); <span class="comment">// å¦‚æœå…¬å¸ååŒ…å«&quot;Microsoft&quot;ï¼Œåˆ™è®¤ä¸ºæ˜¯ç³»ç»Ÿç¨‹åºé›†</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>IsSystemAssembly(Assembly asm)é€šè¿‡AssemblyCompanyAttributeåˆ¤æ–­æ˜¯å¦åŒ…å«â€œMicrosoftâ€.</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">IsSystemAssembly</span>(<span class="params"><span class="built_in">string</span> asmPath</span>) <span class="comment">// åˆ¤æ–­æŒ‡å®šè·¯å¾„çš„ç¨‹åºé›†æ–‡ä»¶æ˜¯å¦ä¸ºç³»ç»Ÿç¨‹åºé›†</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> moduleDef = AsmResolver.DotNet.ModuleDefinition.FromFile(asmPath); <span class="comment">// åŠ è½½ç¨‹åºé›†æ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">var</span> assembly = moduleDef.Assembly; <span class="comment">// è·å–ç¨‹åºé›†å®šä¹‰</span></span><br><span class="line">    <span class="keyword">if</span> (assembly == <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// å¦‚æœæ²¡æœ‰ç¨‹åºé›†å®šä¹‰ï¼Œåˆ™è®¤ä¸ºä¸æ˜¯ç³»ç»Ÿç¨‹åºé›†</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> asmCompanyAttr = assembly.CustomAttributes.FirstOrDefault(c =&gt; c.Constructor?.DeclaringType?.FullName == <span class="keyword">typeof</span>(AssemblyCompanyAttribute).FullName); <span class="comment">// è·å–ç¨‹åºé›†çš„å…¬å¸å±æ€§</span></span><br><span class="line">    <span class="keyword">if</span> (asmCompanyAttr == <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// å¦‚æœæ²¡æœ‰å…¬å¸å±æ€§ï¼Œåˆ™è®¤ä¸ºä¸æ˜¯ç³»ç»Ÿç¨‹åºé›†</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> companyName = ((AsmResolver.Utf8String)asmCompanyAttr.Signature?.FixedArguments[<span class="number">0</span>]?.Element)?.Value;<span class="comment">// è·å–å…¬å¸å</span></span><br><span class="line">    <span class="keyword">if</span> (companyName == <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;<span class="comment">// å¦‚æœå…¬å¸åä¸ºç©ºï¼Œåˆ™è®¤ä¸ºä¸æ˜¯ç³»ç»Ÿç¨‹åºé›†</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> companyName.Contains(<span class="string">&quot;Microsoft&quot;</span>); <span class="comment">// å¦‚æœå…¬å¸ååŒ…å«&quot;Microsoft&quot;ï¼Œåˆ™è®¤ä¸ºæ˜¯ç³»ç»Ÿç¨‹åºé›†</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>IsSystemAssembly(string asmPath)ä½¿ç”¨AsmResolverè¯»å–.dllå…ƒæ•°æ®ï¼Œå†æ£€æŸ¥æ˜¯å¦æ˜¯ç³»ç»Ÿç¨‹åºé›†ã€‚<br><b>assembly.CustomAttributes</b>:è·å–ç¨‹åºé›†å®šä¹‰ä¸Šçš„æ‰€æœ‰è‡ªå®šä¹‰ç‰¹æ€§ï¼ˆå¦‚ [AssemblyCompany], [AssemblyTitle] ç­‰ï¼‰<br><b>.FirstOrDefault(â€¦)</b>:ä»ä¸­å–å‡ºç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„ç‰¹æ€§ï¼Œæ‰¾ä¸åˆ°å°±è¿”å›null<br><b>c.Constructor?.DeclaringType?.FullName</b>:è·å–ç‰¹æ€§çš„æ„é€ å‡½æ•°æ‰€å±ç±»å‹çš„å®Œæ•´åç§°ï¼ˆåŠç‰¹æ€§ç±»å‹æœ¬èº«çš„FullNameï¼‰<br><b>typeof(AssemblyCompanyAattribute).FullName</b>:è·å–AssemblyCompanyAttributeçš„å®Œæ•´åç§°ï¼Œå³ â€œSystem.Reflection.AssemblyCompanyAttributeâ€</p></blockquote><p><b>asmCompanyAttr.Signature</b>:è¿™æ˜¯ä¸€ä¸ª CustomAttributeSignature å¯¹è±¡ï¼Œè¡¨ç¤ºè¿™ä¸ªç‰¹æ€§çš„æ„é€ å‡½æ•°ç­¾åï¼ŒåŒ…æ‹¬å‚æ•°ç±»å‹ã€å€¼ç­‰ã€‚<br><b>.FixedArguments[0]</b>:è¿™æ˜¯è·å–ç¬¬ä¸€ä¸ªå›ºå®šå‚æ•°ã€‚å¯¹äº [AssemblyCompany(â€œOpenAIâ€)]ï¼Œè¿™ä¸ªç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯ â€œOpenAIâ€ã€‚<br><b>.Element</b>:FixedArguments[0].Element æ˜¯è¿™ä¸ªå‚æ•°çš„å€¼ï¼Œç±»å‹æ˜¯ ICustomAttributeTypeï¼Œä½†åœ¨å­—ç¬¦ä¸²ç‰¹æ€§çš„åœºæ™¯ä¸‹ï¼Œå®ƒå…¶å®å°±æ˜¯ Utf8String ç±»å‹çš„å¯¹è±¡ã€‚<br><b>(AsmResolver.Utf8String)â€¦</b>:å°† Element æ˜¾å¼è½¬æ¢ä¸º Utf8Stringï¼Œè¿™æ˜¯ AsmResolver ç”¨æ¥è¡¨ç¤ºå­—ç¬¦ä¸²çš„ä¸€ç§ç±»å‹ï¼ˆå’Œ .NET çš„ string ç±»ä¼¼ï¼Œä½†å†…éƒ¨æ˜¯ UTF-8 ç¼–ç ç»“æ„ï¼‰ã€‚<br><b>?.Value</b>:å–å‡ºå­—ç¬¦ä¸²çš„å€¼ã€‚</p><blockquote><p>è¿™ä¸¤ä¸ªæ–¹æ³•å…è®¸ä½ åœ¨è¿™ä¸¤ç§åœºæ™¯ä¸‹éƒ½åˆ¤æ–­ç¨‹åºé›†æ˜¯å¦ä¸ºâ€œç³»ç»Ÿæä¾›â€ï¼ˆé¿å…å¤„ç†ä¸å¿…è¦çš„ç³»ç»Ÿç¨‹åºé›†ï¼‰</p></blockquote><h3 id="IsManagedAssembly"><a href="#IsManagedAssembly" class="headerlink" title="IsManagedAssembly"></a>IsManagedAssembly</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">IsManagedAssembly</span>(<span class="params"><span class="built_in">string</span> file</span>)  <span class="comment">// åˆ¤æ–­æŒ‡å®šæ–‡ä»¶æ˜¯å¦ä¸ºæ‰˜ç®¡ç¨‹åºé›†</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="keyword">var</span> fs = File.OpenRead(file);<span class="comment">// æ‰“å¼€æ–‡ä»¶æµ</span></span><br><span class="line">    <span class="keyword">using</span> PEReader peReader = <span class="keyword">new</span> PEReader(fs);<span class="comment">// åˆ›å»ºPEReaderå¯¹è±¡è¯»å–PEæ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">return</span> peReader.HasMetadata &amp;&amp; peReader.GetMetadataReader().IsAssembly; <span class="comment">// å¦‚æœPEæ–‡ä»¶æœ‰å…ƒæ•°æ®ä¸”æ˜¯ç¨‹åºé›†ï¼Œåˆ™è®¤ä¸ºæ˜¯æ‰˜ç®¡ç¨‹åºé›†</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ä½¿ç”¨ System.Reflection.PortableExecutable.PEReader åˆ¤æ–­ .dll æ˜¯å¦æ˜¯æ‰˜ç®¡ç¨‹åºé›†<br>æ ¸å¿ƒåˆ¤æ–­æ˜¯ï¼šæ˜¯å¦æœ‰å…ƒæ•°æ® (peReader.HasMetadata) ä¸”ä¸ºç¨‹åºé›† (IsAssembly)</p></blockquote><p><b>peReader.HasMetadata</b>:æ–‡ä»¶ä¸­åŒ…å« .NET å…ƒæ•°æ®ï¼ˆè¯´æ˜æ˜¯æ‰˜ç®¡ä»£ç çš„ä¸€éƒ¨åˆ†ï¼‰<br><b>IsAssembly</b>:æ–‡ä»¶è¡¨ç¤ºçš„æ˜¯ä¸€ä¸ª ç¨‹åºé›†ï¼ˆå³ .dll æˆ– .exe ä¸­åŒ…å« Assembly æ¸…å•ï¼‰</p><blockquote><p>è¿™æ ·å¯ä»¥é¿å…å°è¯•åŠ è½½æœ¬åœ°DLLã€C++DLLç­‰é.NETç¨‹åºé›†ã€‚</p></blockquote><h3 id="TryLoadAssembly"><a href="#TryLoadAssembly" class="headerlink" title="TryLoadAssembly"></a>TryLoadAssembly</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> Assembly? TryLoadAssembly(<span class="built_in">string</span> asmPath) <span class="comment">//å°è¯•ä»æŒ‡å®šè·¯å¾„åŠ è½½ä¸€ä¸ª .NET ç¨‹åºé›†</span></span><br><span class="line">&#123;</span><br><span class="line">    AssemblyName asmName = AssemblyName.GetAssemblyName(asmPath);<span class="comment">//è¯»å–ç¨‹åºé›†çš„å…ƒä¿¡æ¯</span></span><br><span class="line">    Assembly? asm = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        asm = Assembly.Load(asmName);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (BadImageFormatException ex)</span><br><span class="line">    &#123;</span><br><span class="line">        Debug.WriteLine(ex);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (FileLoadException ex)</span><br><span class="line">    &#123;</span><br><span class="line">        Debug.WriteLine(ex);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (asm == <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            asm = Assembly.LoadFile(asmPath);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (BadImageFormatException ex)</span><br><span class="line">        &#123;</span><br><span class="line">            Debug.WriteLine(ex);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (FileLoadException ex)</span><br><span class="line">        &#123;</span><br><span class="line">            Debug.WriteLine(ex);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> asm;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ä½¿ç”¨ Assembly.Load(AssemblyName) åŠ è½½<br>è‹¥å¤±è´¥ï¼Œåˆ™å°è¯• Assembly.LoadFile åŠ è½½<br>æ•è·å¹¶è®°å½•å¸¸è§é”™è¯¯ï¼Œå¦‚ BadImageFormatException å’Œ FileLoadException</p></blockquote><p><b>AssemblyName.GetAssemblyName(asmPath)</b>:è¿™ä¸€æ­¥å°è¯•ä»æ–‡ä»¶ä¸­è¯»å–ç¨‹åºé›†çš„å…ƒä¿¡æ¯ï¼Œæ¯”å¦‚å®ƒçš„åç§°ã€ç‰ˆæœ¬ã€æ–‡åŒ–ã€å…¬é’¥ç­‰ã€‚ä¸ä¼šçœŸæ­£åŠ è½½ç¨‹åºé›†ï¼Œåªæ˜¯è·å–å®ƒçš„æ ‡è¯†ã€‚<br><b>Assembly.Load(asmName)</b>:è¿™æ˜¯æ ¹æ®ç¨‹åºé›†åç§°ï¼ˆè€Œä¸æ˜¯æ–‡ä»¶è·¯å¾„ï¼‰å°è¯•ä» å½“å‰ AppDomain çš„æ¢æµ‹è·¯å¾„ä¸­åŠ è½½ç¨‹åºé›†ã€‚å¦‚æœå·²ç»åŠ è½½è¿‡ï¼Œå®ƒä¼šç›´æ¥è¿”å›ã€‚<br>BadImageFormatException: æ–‡ä»¶ä¸æ˜¯æœ‰æ•ˆçš„ .NET ç¨‹åºé›†ï¼ˆå¯èƒ½æ˜¯åŸç”Ÿ DLLï¼‰<br>FileLoadException: å¯èƒ½æ˜¯æ–‡ä»¶é”å®šã€æƒé™é—®é¢˜ã€ç‰ˆæœ¬å†²çªç­‰<br><b>Assembly.LoadFile(asmPath)</b>:å¦‚æœç¬¬ä¸€æ¬¡åŠ è½½å¤±è´¥ï¼ˆè¿”å› nullï¼‰ï¼Œå°±ä½¿ç”¨ Assembly.LoadFile ç›´æ¥ä»ç»å¯¹è·¯å¾„åŠ è½½ç¨‹åºé›†ã€‚</p><blockquote><p>é¿å…ç¨‹åºå› ä¸ºä¸€ä¸ªéæ³•çš„ .dll å´©æºƒï¼ŒåŒæ—¶ä»å°½å¯èƒ½åŠ è½½æ›´å¤šç¨‹åºé›†ã€‚</p></blockquote><h3 id="IsValid"><a href="#IsValid" class="headerlink" title="IsValid"></a>IsValid</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">bool</span> <span class="title">IsValid</span>(<span class="params">Assembly asm</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        asm.GetTypes();              <span class="comment">// å°è¯•è·å–ç¨‹åºé›†ä¸­çš„æ‰€æœ‰ç±»å‹</span></span><br><span class="line">        asm.DefinedTypes.ToList();   <span class="comment">// å°è¯•æšä¸¾æ‰€æœ‰ç±»å‹å®šä¹‰</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;                 <span class="comment">// æ²¡å¼‚å¸¸ï¼Œå°±è¯´æ˜æœ‰æ•ˆ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (ReflectionTypeLoadException ex)</span><br><span class="line">    &#123;</span><br><span class="line">        Debug.WriteLine(<span class="string">$&quot;ç¨‹åºé›†åŠ è½½å¤±è´¥: <span class="subst">&#123;asm.FullName&#125;</span> - <span class="subst">&#123;ex.Message&#125;</span>&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;                <span class="comment">// å¦‚æœæ— æ³•åŠ è½½æŸäº›ç±»å‹ï¼Œè¯´æ˜ç¨‹åºé›†å¯èƒ½ä¸å®Œæ•´æˆ–æœ‰ä¾èµ–é—®é¢˜</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>é€šè¿‡è°ƒç”¨ GetTypes å’Œ DefinedTypes æ¥ç¡®ä¿ç¨‹åºé›†ä¸­çš„ç±»å‹æ˜¯å¯è®¿é—®çš„<br>æ•è· ReflectionTypeLoadException ä»¥å¤„ç†ä¸å®Œæ•´çš„ç¨‹åºé›†</p></blockquote><h3 id="AssemblyEquality"><a href="#AssemblyEquality" class="headerlink" title="AssemblyEquality"></a>AssemblyEquality</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">AssemblyEquality</span> : <span class="title">EqualityComparer</span>&lt;<span class="title">Assembly</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">bool</span> <span class="title">Equals</span>(<span class="params">Assembly? x, Assembly? y</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (x == <span class="literal">null</span> &amp;&amp; y == <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (x == <span class="literal">null</span> || y == <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">return</span> AssemblyName.ReferenceMatchesDefinition(x.GetName(), y.GetName());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">int</span> <span class="title">GetHashCode</span>(<span class="params">[DisallowNull] Assembly obj</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> obj.GetName().FullName.GetHashCode();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ¯”è¾ƒä¸¤ä¸ªç¨‹åºé›†æ˜¯å¦ç›¸ç­‰ï¼Œä½¿ç”¨ AssemblyName.ReferenceMatchesDefinition æ¥ç¡®ä¿ç‰ˆæœ¬ç­‰ä¿¡æ¯ä¸€è‡´<br>ç”¨ AssemblyName.ReferenceMatchesDefinition åˆ¤æ–­ä¸¤ä¸ªç¨‹åºé›†æ˜¯å¦â€œç­‰ä»·â€ï¼Œå¹¶ä¸”åŸºäº AssemblyName.FullName æä¾›ç¨³å®šçš„ HashCodeã€‚<br>ç”¨äº HashSet&lt;Assembly&gt; å»é‡æ—¶ï¼Œè‡ªå®šä¹‰åˆ¤æ–­é€»è¾‘ã€‚</p></blockquote><h3 id="GetAllReferencedAssemblies"><a href="#GetAllReferencedAssemblies" class="headerlink" title="GetAllReferencedAssemblies"></a>GetAllReferencedAssemblies</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IEnumerable&lt;Assembly&gt; <span class="title">GetAllReferencedAssemblies</span>(<span class="params"><span class="built_in">bool</span> skipSystemAssemblies = <span class="literal">true</span></span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    Assembly? rootAssembly = Assembly.GetEntryAssembly();</span><br><span class="line">    <span class="keyword">if</span> (rootAssembly == <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        rootAssembly = Assembly.GetExecutingAssembly();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> returnAssemblies = <span class="keyword">new</span> HashSet&lt;Assembly&gt;(<span class="keyword">new</span> AssemblyEquality());</span><br><span class="line">    <span class="keyword">var</span> loadedAssemblies = <span class="keyword">new</span> HashSet&lt;<span class="built_in">string</span>&gt;();</span><br><span class="line">    <span class="keyword">var</span> assembliesToCheck = <span class="keyword">new</span> Queue&lt;Assembly&gt;();</span><br><span class="line">    assembliesToCheck.Enqueue(rootAssembly);</span><br><span class="line">    <span class="comment">// æ£€æŸ¥æ ¹ç¨‹åºé›†æ˜¯å¦éœ€è¦åŠ å…¥</span></span><br><span class="line">    <span class="keyword">if</span> (skipSystemAssemblies &amp;&amp; IsSystemAssembly(rootAssembly) != <span class="literal">false</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!IsValid(rootAssembly))</span><br><span class="line">        &#123;</span><br><span class="line">            returnAssemblies.Add(rootAssembly);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å¹¿åº¦ä¼˜å…ˆéå†æ‰€æœ‰å¼•ç”¨çš„ç¨‹åºé›†</span></span><br><span class="line">    <span class="keyword">while</span> (assembliesToCheck.Any())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> assemblyToCheck = assembliesToCheck.Dequeue();</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">var</span> reference <span class="keyword">in</span> assemblyToCheck.GetReferencedAssemblies())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (!loadedAssemblies.Contains(reference.FullName))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">var</span> assembly = Assembly.Load(reference);</span><br><span class="line">                <span class="keyword">if</span> (skipSystemAssemblies &amp;&amp; IsSystemAssembly(assembly))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                assembliesToCheck.Enqueue(assembly);</span><br><span class="line">                loadedAssemblies.Add(reference.FullName);</span><br><span class="line">                <span class="keyword">if</span> (IsValid(assembly))</span><br><span class="line">                &#123;</span><br><span class="line">                    returnAssemblies.Add(assembly);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ‰«æå½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ‰˜ç®¡ç¨‹åºé›†</span></span><br><span class="line">    <span class="keyword">var</span> asmsInBaseDir = Directory.EnumerateFiles(AppContext.BaseDirectory,</span><br><span class="line">        <span class="string">&quot;*.dll&quot;</span>, <span class="keyword">new</span> EnumerationOptions &#123; RecurseSubdirectories = <span class="literal">true</span> &#125;);</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="keyword">var</span> asmPath <span class="keyword">in</span> asmsInBaseDir)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!IsManagedAssembly(asmPath))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        AssemblyName asmName = AssemblyName.GetAssemblyName(asmPath);</span><br><span class="line">        <span class="keyword">if</span> (returnAssemblies.Any(x =&gt; AssemblyName.ReferenceMatchesDefinition(x.GetName(), asmName)))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (skipSystemAssemblies &amp;&amp; IsSystemAssembly(asmPath))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        Assembly? asm = TryLoadAssembly(asmPath);</span><br><span class="line">        <span class="keyword">if</span> (asm == <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!IsValid(asm))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (skipSystemAssemblies &amp;&amp; IsSystemAssembly(asm))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        returnAssemblies.Add(asm);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> returnAssemblies.ToArray();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li><p>åˆå§‹åŒ–<br>å–å…¥å£ç¨‹åºé›†Assembly.GetEntryAssembly()ï¼Œæ‰¾ä¸åˆ°å°±ç”¨å½“å‰æ­£åœ¨æ‰§è¡Œçš„ç¨‹åºé›†ã€‚<br>åˆ›å»º returnAssemblies é›†åˆç”¨äºå»é‡å’Œå­˜æ”¾ç»“æœ<br>åˆ›å»ºé˜Ÿåˆ— assembliesToCheck å¹¿åº¦ä¼˜å…ˆéå†ä¾èµ–å…³ç³»</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> returnAssemblies = <span class="keyword">new</span> HashSet&lt;Assembly&gt;(<span class="keyword">new</span> AssemblyEquality()); <span class="comment">// ç»“æœé›†åˆï¼Œå»é‡</span></span><br><span class="line"><span class="keyword">var</span> loadedAssemblies = <span class="keyword">new</span> HashSet&lt;<span class="built_in">string</span>&gt;(); <span class="comment">// å·²åŠ è½½çš„ç¨‹åºé›†åï¼Œé˜²é‡å¤åŠ è½½</span></span><br><span class="line"><span class="keyword">var</span> assembliesToCheck = <span class="keyword">new</span> Queue&lt;Assembly&gt;(); <span class="comment">// å¹¿åº¦ä¼˜å…ˆé˜Ÿåˆ—</span></span><br><span class="line">assembliesToCheck.Enqueue(rootAssembly);</span><br></pre></td></tr></table></figure><p><b>assembliesToCheck.Enqueue(rootAssembly)</b>:æŠŠæ ¹ç¨‹åºé›†æ”¾å…¥é˜Ÿåˆ— assembliesToCheck ä¸­ï¼Œä½œä¸ºåç»­è¦å¤„ç†çš„ç¬¬ä¸€ä¸ªç¨‹åºé›†ã€‚</p></li><li><p>æ£€æŸ¥ç¨‹åºé›†æ˜¯å¦åŠ å…¥</p></li></ol><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (skipSystemAssemblies &amp;&amp; IsSystemAssembly(rootAssembly) != <span class="literal">false</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (!IsValid(rootAssembly))</span><br><span class="line">    &#123;</span><br><span class="line">        returnAssemblies.Add(rootAssembly);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å¦‚æœå¯ç”¨äº†è·³è¿‡ç³»ç»Ÿç¨‹åºé›†ï¼ˆskipSystemAssemblies &#x3D; trueï¼‰ï¼Œå¹¶ä¸” rootAssembly è¢«è¯†åˆ«ä¸ºç³»ç»Ÿç¨‹åºé›†ï¼Œä½†å®ƒåˆæ˜¯â€œæ— æ•ˆâ€çš„ï¼Œé‚£å°±å¼ºåˆ¶åŠ å…¥è¿™ä¸ªç¨‹åºé›†ã€‚</p></blockquote><ol start="3"><li>é€’å½’åŠ è½½å¼•ç”¨ç¨‹åºé›†</li></ol><p>éå†å½“å‰é˜Ÿåˆ—ä¸­çš„ç¨‹åºé›†å¼•ç”¨ï¼ŒåŠ è½½æœªåŠ è½½çš„å¼•ç”¨ç¨‹åºé›†ã€‚<br>ä½¿ç”¨ Assembly.Load(AssemblyName) åŠ è½½å¼•ç”¨ã€‚<br>åŠ å…¥é˜Ÿåˆ—ç»§ç»­é€’å½’ã€‚<br>åˆ¤æ–­æ˜¯å¦ä¸ºç³»ç»Ÿç¨‹åºé›†ã€æ˜¯å¦æœ‰æ•ˆã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (assembliesToCheck.Any())</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> assemblyToCheck = assembliesToCheck.Dequeue();</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="keyword">var</span> reference <span class="keyword">in</span> assemblyToCheck.GetReferencedAssemblies())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!loadedAssemblies.Contains(reference.FullName))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> assembly = Assembly.Load(reference);</span><br><span class="line">            <span class="keyword">if</span> (skipSystemAssemblies &amp;&amp; IsSystemAssembly(assembly))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            assembliesToCheck.Enqueue(assembly);</span><br><span class="line">            loadedAssemblies.Add(reference.FullName);</span><br><span class="line">            <span class="keyword">if</span> (IsValid(assembly))</span><br><span class="line">            &#123;</span><br><span class="line">                returnAssemblies.Add(assembly);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><b>while (assembliesToCheck.Any())</b>:<br>è¿™æ˜¯ å¹¿åº¦ä¼˜å…ˆéå† çš„ä¸»å¾ªç¯æ¡ä»¶ï¼š<br>assembliesToCheck æ˜¯ä¸€ä¸ª Queue&lt;Assembly&gt;ï¼Œå­˜å‚¨å¾…å¤„ç†çš„ç¨‹åºé›†ï¼›åªè¦é˜Ÿåˆ—ä¸ä¸ºç©ºï¼Œå°±ç»§ç»­å¤„ç†ã€‚<br><b>var assemblyToCheck &#x3D; assembliesToCheck.Dequeue();</b>:ä»é˜Ÿåˆ—ä¸­å–å‡ºä¸€ä¸ªå¾…æ£€æŸ¥çš„ç¨‹åºé›†ã€‚<br><b>assemblyToCheck.GetReferencedAssemblies()</b>:è·å–å½“å‰ç¨‹åºé›†å¼•ç”¨çš„æ‰€æœ‰å…¶ä»–ç¨‹åºé›†.<br><b>if (!loadedAssemblies.Contains(reference.FullName))</b>:åˆ¤æ–­å½“å‰å¼•ç”¨ç¨‹åºé›†æ˜¯å¦å·²å¤„ç†è¿‡ï¼š<br>loadedAssemblies æ˜¯ä¸€ä¸ª HashSet&lt;string&gt;ï¼›<br>é¿å…é‡å¤åŠ è½½å’Œæ— é™å¾ªç¯ã€‚<br><b>var assembly &#x3D; Assembly.Load(reference)</b>:å°è¯•æ ¹æ®åç§°åŠ è½½ç¨‹åºé›†ï¼š<br>ä½¿ç”¨ Assembly.Load(AssemblyName) ä¼šä»å½“å‰çš„åº”ç”¨åŸŸä¸­åŠ è½½å·²æœ‰çš„ï¼Œæˆ–ä» probing path ä¸­æŸ¥æ‰¾ã€‚<br><b>if (skipSystemAssemblies &amp;&amp; IsSystemAssembly(assembly))</b>:è·³è¿‡ç³»ç»Ÿç¨‹åºé›†çš„æ¡ä»¶åˆ¤æ–­ï¼š<br>å¦‚æœç”¨æˆ·è®¾ç½®äº† skipSystemAssemblies &#x3D; trueï¼›<br>å¹¶ä¸”å½“å‰ç¨‹åºé›†æ˜¯ç³»ç»Ÿç¨‹åºé›†ï¼ˆæ¯”å¦‚ Microsoftã€System å¼€å¤´ï¼‰ï¼›<br>é‚£å°± continueï¼Œç›´æ¥è·³è¿‡ä¸å¤„ç†ã€‚<br><b>assembliesToCheck.Enqueue(assembly)</b>:å°†æ–°åŠ è½½çš„ç¨‹åºé›†åŠ å…¥å¾…å¤„ç†é˜Ÿåˆ—ï¼Œé€’å½’å¤„ç†å®ƒçš„å¼•ç”¨ç¨‹åºé›†ã€‚<br><b><br><b>loadedAssemblies.Add(reference.FullName)</b>:æ ‡è®°è¿™ä¸ªç¨‹åºé›†å·²ç»å¤„ç†è¿‡ã€‚<br><b>if (IsValid(assembly)) { returnAssemblies.Add(assembly); }</b>:æœ€ååˆ¤æ–­è¿™ä¸ªç¨‹åºé›†æ˜¯å¦æ˜¯â€œæœ‰æ•ˆâ€çš„ï¼ˆæ²¡æœ‰ç±»å‹åŠ è½½é”™è¯¯ç­‰ï¼‰ï¼Œæ˜¯çš„è¯åŠ å…¥æœ€ç»ˆç»“æœé›†ä¸­ã€‚</p><ol start="4"><li>é¢å¤–åŠ è½½å½“å‰ç›®å½•ä¸‹çš„ DLL æ–‡ä»¶</li></ol><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> asmsInBaseDir = Directory.EnumerateFiles(AppContext.BaseDirectory,</span><br><span class="line">    <span class="string">&quot;*.dll&quot;</span>, <span class="keyword">new</span> EnumerationOptions &#123; RecurseSubdirectories = <span class="literal">true</span> &#125;);</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> asmPath <span class="keyword">in</span> asmsInBaseDir)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (!IsManagedAssembly(asmPath))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    AssemblyName asmName = AssemblyName.GetAssemblyName(asmPath);</span><br><span class="line">    <span class="keyword">if</span> (returnAssemblies.Any(x =&gt; AssemblyName.ReferenceMatchesDefinition(x.GetName(), asmName)))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (skipSystemAssemblies &amp;&amp; IsSystemAssembly(asmPath))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Assembly? asm = TryLoadAssembly(asmPath);</span><br><span class="line">    <span class="keyword">if</span> (asm == <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!IsValid(asm))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (skipSystemAssemblies &amp;&amp; IsSystemAssembly(asm))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    returnAssemblies.Add(asm);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> returnAssemblies.ToArray();</span><br></pre></td></tr></table></figure><blockquote><p>éå†å½“å‰åº”ç”¨ç›®å½•çš„æ‰€æœ‰ .dll<br>åˆ¤æ–­æ˜¯å¦ä¸ºæ‰˜ç®¡ç¨‹åºé›†<br>åˆ¤æ–­æ˜¯å¦ä¸ºç³»ç»Ÿç¨‹åºé›†<br>åˆ¤æ–­æ˜¯å¦å·²ç»åŠ è½½<br>é€šè¿‡ TryLoadAssembly å°è¯•åŠ è½½<br>åˆ¤æ–­æ˜¯å¦æœ‰æ•ˆï¼ˆèƒ½å¦è®¿é—®ç±»å‹å®šä¹‰ï¼‰</p></blockquote><p>è¿™æ˜¯ä¸ºäº†æŠŠé‚£äº›æ²¡æœ‰è¢«ä¸»åŠ¨å¼•ç”¨ï¼Œä½†ä»åœ¨éƒ¨ç½²ç›®å½•ä¸­çš„ç¨‹åºé›†åŠ è½½è¿›æ¥ã€‚<br>ä½¿ç”¨ AppContext.BaseDirectory è·å–è¿è¡Œç›®å½•ï¼Œé€’å½’æŸ¥æ‰¾å­ç›®å½•ä¸­æ‰€æœ‰ .dll æ–‡ä»¶<br>ç”¨ PEReader åˆ¤æ–­æ˜¯ä¸æ˜¯æ‰˜ç®¡ç¨‹åºé›†<br>if (returnAssemblies.Any(x &#x3D;&gt;ï¼šé˜²æ­¢é‡å¤åŠ è½½åŒä¸€ä¸ªç¨‹åºé›†ï¼ˆå³ä½¿è·¯å¾„ä¸åŒï¼Œåªè¦ AssemblyName ä¸€è‡´ï¼Œå°±è§†ä¸ºç›¸åŒï¼‰</p><h1 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h1><table border="1" cellspacing="0"><tr><td>åœºæ™¯</td><td>ç¤ºä¾‹</td></tr><tr><td>æ¨¡å—åŒ–æ³¨å†Œ</td><td>è‡ªåŠ¨æ‰«æå®ç°äº† IModuleInitializer çš„ç±»å‹å¹¶åˆå§‹åŒ–</td></tr><tr><td>æ’ä»¶ç³»ç»Ÿ</td><td>åŠ è½½æ’ä»¶ç›®å½•çš„æ‰€æœ‰ .NET ç¨‹åºé›†</td></tr><tr><td>è‡ªåŠ¨ä¾èµ–æ³¨å…¥</td><td>æ ¹æ®å‘½åç©ºé—´ã€æ¥å£ç‰¹å¾æ‰¹é‡æ³¨å†ŒæœåŠ¡</td></tr><tr><td>åŠ¨æ€å‘ç°æœåŠ¡</td><td>åˆ†å¸ƒå¼æ¶æ„ä¸­åŠ è½½è¿œç¨‹/æœ¬åœ°æœåŠ¡æ¨¡å—</td></tr></table>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ASP.NET Core </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WebApplication å’Œ WebApplicationBuilder</title>
      <link href="/2025/08/03/asp.net%20core/%E5%AD%A6%E8%8B%B1%E8%AF%AD%E7%BD%91%E7%AB%99%E9%A1%B9%E7%9B%AE/WebApplication%20%E5%92%8C%20WebApplicationBuilder/"/>
      <url>/2025/08/03/asp.net%20core/%E5%AD%A6%E8%8B%B1%E8%AF%AD%E7%BD%91%E7%AB%99%E9%A1%B9%E7%9B%AE/WebApplication%20%E5%92%8C%20WebApplicationBuilder/</url>
      
        <content type="html"><![CDATA[<h1 id="WebAppliction"><a href="#WebAppliction" class="headerlink" title="WebAppliction"></a>WebAppliction</h1><p><b>ç”¨é€”</b>:æ˜¯å®é™…è¿è¡Œçš„ASP.NET Coreåº”ç”¨å®ä¾‹ã€‚é€šè¿‡å®ƒæˆ‘ä»¬å¯ä»¥<code>æ³¨å†Œä¸­é—´ä»¶[Use()]</code>ã€<code>æ˜ å°„ç»ˆèŠ‚ç‚¹[Map()]</code>ã€<code>æœ€ç»ˆè°ƒç”¨[Run()]å¯åŠ¨æœåŠ¡ç›‘è§†å™¨</code>ã€‚</p><p>ç±»æ¯”ï¼šçœŸæ­£ç›–å¥½å¹¶è¿è¡Œçš„æˆ¿å­ï¼Œä½äººã€ä¾›ç”µã€ä¾›æ°´çš„é˜¶æ®µã€‚</p><h2 id="æ ¸å¿ƒç»„æˆ"><a href="#æ ¸å¿ƒç»„æˆ" class="headerlink" title="æ ¸å¿ƒç»„æˆ"></a><b>æ ¸å¿ƒç»„æˆ</b></h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(args);</span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line">app.MapGet(<span class="string">&quot;/&quot;</span>, () =&gt; <span class="string">&quot;Hello World!&quot;</span>);</span><br><span class="line"></span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure><table border="1" cellspacing="0"><tr><td>æˆå‘˜</td><td>ç±»å‹</td><td>è¯´æ˜</td></tr><tr><td>app.UseXxx()</td><td>ä¸­é—´ä»¶æ·»åŠ æ–¹æ³•</td><td>ç”¨äºå¤„ç†è¯·æ±‚çš„ä¸­é—´ä»¶ç®¡é“</td></tr><tr><td>apapp.UseXxx()</td><td>ç»ˆç»“ç‚¹æ³¨å†Œ</td><td>å®šä¹‰è¯·æ±‚çš„è·¯ç”±é€»è¾‘</td></tr><tr><td>app.Run()</td><td>å¯åŠ¨æ–¹æ³•</td><td>å¯åŠ¨HTTPæœåŠ¡ç›‘å¬è¯·æ±‚</td></tr><tr><td>app.Environment</td><td>IHostEnvironment</td><td>å½“å‰ç¯å¢ƒ</td></tr><tr><td>app.Services</td><td>IServiceProvider</td><td>è®¿é—®æœåŠ¡å®¹å™¨ä¸­çš„æœåŠ¡</td></tr></table><h2 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">app.Map(<span class="string">&quot;/test&quot;</span>, <span class="keyword">async</span> (pipeBuilder) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    pipeBuilder.Use(<span class="keyword">async</span> (context, next) =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        context.Response.ContentType = <span class="string">&quot;text/html&quot;</span>;</span><br><span class="line">        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;1 start&lt;br/&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">await</span> next.Invoke();</span><br><span class="line">        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;1 end&lt;br/&gt;&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    pipeBuilder.Use(<span class="keyword">async</span> (context, next) =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;2 start&lt;br/&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">await</span> next.Invoke();</span><br><span class="line">        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;2 end&lt;br/&gt;&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    pipeBuilder.UseMiddleware&lt;TestIMddleware&gt;();</span><br><span class="line">    pipeBuilder.Run(<span class="keyword">async</span> context =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;Run&lt;br/&gt;&quot;</span>);</span><br><span class="line">        <span class="built_in">dynamic</span> obj = context.Items[<span class="string">&quot;BodyJson&quot;</span>];</span><br><span class="line">        <span class="keyword">if</span>(obj != <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;BodyJson: <span class="subst">&#123;obj&#125;</span>&lt;br/&gt;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    pipeBuilder.Run(<span class="keyword">async</span> context =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;Run&lt;br/&gt;&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ol><li><p>app.Map(â€œ&#x2F;testâ€, async (pipeBuilder) &#x3D;&gt; { â€¦ })<br>è¿™é‡Œå°†&#x2F;testè·¯å¾„æ˜ å°„åˆ°ä¸€ä¸ªæ–°çš„ä¸­é—´ä»¶åˆ†æ”¯ä¸­ã€‚<br>Map()æ˜¯æ¡ä»¶åˆ†æ”¯ï¼ˆç±»ä¼¼ifï¼‰,åªå½“è·¯å¾„ä»¥&#x2F;testå¼€å¤´æ—¶æ‰æ‰§è¡Œå†…éƒ¨ç®¡é“ã€‚<br>pipeBuilderå°±æ˜¯æ–°çš„IApplicationBuilderï¼Œä½ å¯ä»¥åœ¨é‡Œé¢Useã€Runä¸­é—´ä»¶ï¼Œå½¼æ­¤ä¸ä¼šå½±å“ä¸»ç®¡é“ã€‚</p></li><li><p>context.Response.ContentType &#x3D; â€œtext&#x2F;htmlâ€;<br>context.Responseæ˜¯Httponseå¯¹è±¡ï¼Œä»£è¡¨æœåŠ¡å™¨è¦å‘å›çš„å“åº”ã€‚<br>ContentTypeæ˜¯è®¾ç½®å“åº”å¤´Content-Type.<br>è®¾ç½®ä¸ºâ€œtext&#x2F;htmlâ€ï¼Œæ„å‘³ç€ï¼šæµè§ˆå™¨å°†æŒ‰HTMLæ ¼å¼æ¸²æŸ“å†…å®¹ã€‚å†™å…¥çš„å­—ç¬¦ä¸²å°†è¢«å½“ä½œHTMLè§£æï¼Œè€Œä¸æ˜¯æ™®é€šæ–‡æœ¬ã€‚<br>next.Invoke();è¿›å…¥ä¸‹ä¸€ä¸ªä¸­é—´ä»¶</p></li></ol><p>å¸¸è§ Content-Type ç±»å‹</p><p>ContentType            è¯´æ˜</p><p>text&#x2F;html            è¿”å› HTML ç½‘é¡µå†…å®¹<br>text&#x2F;plain            çº¯æ–‡æœ¬ï¼ˆæ— æ ¼å¼ï¼‰<br>application&#x2F;json    JSON æ•°æ®ï¼ˆå¸¸ç”¨äº APIï¼‰<br>application&#x2F;xmlXML     æ•°æ®<br>text&#x2F;css            CSS æ ·å¼è¡¨<br>application&#x2F;javascriptJavaScript è„šæœ¬</p><p>å¦‚æœæ²¡è®¾ç½® ContentTypeï¼Œé»˜è®¤æ˜¯ text&#x2F;plainï¼Œæµè§ˆå™¨ä¸ä¼šè§£æä¸º HTMLï¼Œè€Œæ˜¯ç›´æ¥æŠŠ &lt;h1&gt;Hello&lt;&#x2F;h1&gt; å½“ä½œçº¯æ–‡æœ¬æ˜¾ç¤ºã€‚</p><p>3.pipeBuilder.UseMiddleware&lt;TestIMddleware&gt;();è‡ªå®šä¹‰ä¸­é—´ä»¶ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TestIMddleware</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> RequestDelegate next;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TestIMddleware</span>(<span class="params">RequestDelegate next</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.next = next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">InvokeAsync</span>(<span class="params">HttpContext context</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;TestIMddleware start&lt;br/&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">await</span> next.Invoke(context);</span><br><span class="line">        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;TestIMddleware end&lt;br/&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="4"><li>ä¸ºä»€ä¹ˆç¬¬äºŒä¸ªRun()ä¸æ‰§è¡Œï¼Ÿ<br>ä¸­é—´ä»¶ç®¡é“æ˜¯å•æŒ‘é“¾è¡¨ç»“æ„ï¼Œä»ä¸Šåˆ°ä¸‹ä¾æ¬¡è°ƒç”¨ã€‚<br>Run()ç›¸å½“äºUse()çš„æœ€åä¸€ç¯ï¼Œä»–ä¸ä¼šè°ƒç”¨next()ï¼Œæ‰€ä»¥æ‰§è¡Œåˆ°ç¬¬ä¸€ä¸ªRun()åï¼Œåé¢çš„ä¸­é—´ä»¶è¢«è·³è¿‡äº†ã€‚<br>è§„åˆ™:åªèƒ½æœ‰ä¸€ä¸ªRun()ï¼Œå¦‚æœå†™å¤šäº†ï¼Œåªæœ‰ç¬¬ä¸€ä¸ªç”Ÿæ•ˆï¼Œå…¶ä»–è¢«å¿½ç•¥ã€‚</li></ol><h1 id="WebApplicationBuilder"><a href="#WebApplicationBuilder" class="headerlink" title="WebApplicationBuilder"></a>WebApplicationBuilder</h1><p><b>ç”¨é€”</b>:<code>WebApplicationBuilderæ˜¯ç”¨äºæ„å»ºWebApplicationçš„å·¥å‚ç±»ï¼Œå¥¹è´Ÿè´£é…ç½®æœåŠ¡ã€é…ç½®åº”ç”¨ç¯å¢ƒã€æ—¥å¿—ã€é…ç½®æ–‡ä»¶ã€ä¸»æœºè®¾ç½®ç­‰å†…å®¹ã€‚</p><p>ç±»æ¯”ï¼šä»–æ˜¯å»ºæˆ¿å­çš„é˜¶æ®µï¼šå¤‡ææ–™ã€è®¾è®¡åœˆã€å‡†å¤‡å·¥äººã€‚</p><h2 id="æ ¸å¿ƒç»„æˆ-1"><a href="#æ ¸å¿ƒç»„æˆ-1" class="headerlink" title="æ ¸å¿ƒç»„æˆ"></a>æ ¸å¿ƒç»„æˆ</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(args);</span><br></pre></td></tr></table></figure><table border="1" cellspacing="0"><tr><td>æˆå‘˜</td><td>ç±»å‹</td><td>è¯´æ˜</td></tr><tr><td>builder.Services</td><td>IServiceCollection</td><td>æ³¨å†ŒDIå®¹å™¨ä¸­çš„æœåŠ¡</td></tr><tr><td>builder.Configuration</td><td>ICongiguration</td><td>åŠ è½½é…ç½®æ–‡ä»¶ï¼ˆappsettings.jsonã€ç¯å¢ƒå˜é‡ç­‰ï¼‰</td></tr><tr><td>builder.Logging</td><td>ILoggingBuilder</td><td>é…ç½®æ—¥å¿—</td></tr><tr><td>builder.Environment</td><td>IHostEnvironment</td><td>å½“å‰è¿è¡Œç¯å¢ƒï¼ˆå¼€å‘ã€ç”Ÿäº§ï¼‰</td></tr><tr><td>builder.Host</td><td>IHostBuilder</td><td>é…ç½®ä¸»æœºè®¾ç½®ï¼Œå¦‚æ·»åŠ  HostedService</td></tr><tr><td>builder.WebHost</td><td>IWebHostBuilder</td><td>ä¸»è¦é…ç½® WebServerï¼ˆKestrelï¼‰ã€ç›‘å¬ç«¯å£ç­‰</td></table><h2 id="ç¤ºä¾‹-1"><a href="#ç¤ºä¾‹-1" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(args);</span><br><span class="line"></span><br><span class="line"><span class="comment">// é…ç½®æœåŠ¡</span></span><br><span class="line">builder.Services.AddControllers();</span><br><span class="line">builder.Services.AddDbContext&lt;AppDbContext&gt;();</span><br><span class="line">builder.Services.AddSwaggerGen();</span><br><span class="line"></span><br><span class="line"><span class="comment">// é…ç½®æ—¥å¿—</span></span><br><span class="line">builder.Logging.ClearProviders();</span><br><span class="line">builder.Logging.AddConsole();</span><br></pre></td></tr></table></figure><p>AddControllers();é…ç½®æœåŠ¡ï¼ˆæ³¨å†Œåˆ° DI å®¹å™¨ï¼‰</p><p>AddDbContext&lt;AppDbContext&gt;();æ³¨å†Œä½ çš„æ•°æ®åº“ä¸Šä¸‹æ–‡ AppDbContextã€‚<br>é€šå¸¸ä½ ä¼šé…åˆæŒ‡å®šæ•°æ®åº“ç±»å‹ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">builder.Services.AddDbContext&lt;AppDbContext&gt;(options =&gt;</span><br><span class="line">    options.UseSqlServer(builder.Configuration.GetConnectionString(<span class="string">&quot;Default&quot;</span>)));</span><br></pre></td></tr></table></figure><p>AddSwaggerGen();æ³¨å†Œ Swagger æ–‡æ¡£ç”Ÿæˆå™¨ï¼Œç”¨äºè‡ªåŠ¨ç”Ÿæˆ OpenAPI æ¥å£æ–‡æ¡£ã€‚<br>ä¼šå¯ç”¨ /swagger/v1/swagger.json åŠ /swagger çš„ UI é¡µé¢ã€‚<br>é…åˆ app.UseSwagger() å’Œ app.UseSwaggerUI() ä½¿ç”¨ã€‚</p><p>Logging.ClearProviders()æ¸…é™¤æ‰€æœ‰é»˜è®¤æ³¨å†Œçš„æ—¥å¿—è®°å½•å™¨ï¼ˆä¾‹å¦‚ Debugã€EventLog ç­‰ï¼‰ã€‚<br>AddConsole() å¯ç”¨æ§åˆ¶å°æ—¥å¿—è¾“å‡ºï¼ˆè¿è¡Œæ—¶è¾“å‡ºåˆ°ç»ˆç«¯ï¼‰ã€‚</p><h1 id="åº•å±‚æœºåˆ¶"><a href="#åº•å±‚æœºåˆ¶" class="headerlink" title="åº•å±‚æœºåˆ¶"></a>åº•å±‚æœºåˆ¶</h1><ol><li><p>WebApplicationBuilder æ˜¯å¯¹ HostApplicationBuilder çš„åŒ…è£…ï¼Œæä¾›é»˜è®¤é…ç½®ï¼Œå¹¶é›†æˆ IHostBuilder å’Œ IWebHostBuilderã€‚</p></li><li><p>WebApplication å®ç°äº† IApplicationBuilder æ¥å£ï¼Œæ˜¯ä¸€ä¸ªæ‰©å±•äº† Web ä¸­é—´ä»¶æ„å»ºå’Œæ‰§è¡Œçš„ç±»å‹ã€‚</p></li><li><p>æ„å»ºè¿‡ç¨‹æœ¬è´¨ä¸Šè¿˜æ˜¯èµ° Host.CreateDefaultBuilder()ï¼Œå†æ·»åŠ äº† Kestrelã€æ—¥å¿—ã€é…ç½®ç­‰é»˜è®¤é…ç½®ã€‚</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ASP.NET Core </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>to doä¸»åŠ¨è¡¨è¢«åŠ¨+éè°“è¯­è¯æ€§</title>
      <link href="/2025/08/03/asp.net%20core/%E8%8B%B1%E8%AF%AD/to%20do%E4%B8%BB%E5%8A%A8%E8%A1%A8%E8%A2%AB%E5%8A%A8/"/>
      <url>/2025/08/03/asp.net%20core/%E8%8B%B1%E8%AF%AD/to%20do%E4%B8%BB%E5%8A%A8%E8%A1%A8%E8%A2%AB%E5%8A%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="to-doä¸»åŠ¨è¡¨è¢«åŠ¨-éè°“è¯­è¯æ€§"><a href="#to-doä¸»åŠ¨è¡¨è¢«åŠ¨-éè°“è¯­è¯æ€§" class="headerlink" title="to doä¸»åŠ¨è¡¨è¢«åŠ¨+éè°“è¯­è¯æ€§"></a>to doä¸»åŠ¨è¡¨è¢«åŠ¨+éè°“è¯­è¯æ€§</h1><p>1.æˆ‘æœ‰å¾ˆå¤šå·¥ä½œè¦ï¼ˆå»&#x2F;è¢«ï¼‰åšã€‚ ä½“ç°ï¼šä¸»è§‚èƒ½åŠ¨æ€§ã€‚<br>I have much work to do.</p><p>2.è¿™ä¸ªé—®é¢˜å¾ˆéš¾ï¼ˆå»&#x2F;è¢«ï¼‰è§£å†³ã€‚<br>This problem is hard to solve.&#x2F;to be solved.</p><p>3.æœ‰è®¸å¤šè¡£æœè¦ï¼ˆå»&#x2F;è¢«ï¼‰æ´—<br>There be&#x3D;æœ‰ï¼ˆå­˜åœ¨ï¼‰è¡¨ä»€ä¹ˆåœ°æ–¹æœ‰ã€‚Beå·¥å…·äººï¼Œthereå‰¯è¯ï¼Œå€’è£…å¥<br>There are many clothes to wash.&#x2F;to be washed.</p><p>æœ‰ç°å¥å­ä¸»åŠ¨è¡¨è¢«åŠ¨ä¸€å®šè¦åˆ†æ¸…æ¥šã€‚<br>4.æ˜å¤©å°†è¦ä¸¾è¡Œçš„ä¼šè®®å–æ¶ˆäº†ã€‚<br>The meeting to be held tomorrow is canceled.<br>ä¼šè®®å°±æ˜¯è¢«ä¸¾è¡Œçš„ï¼Œå°±ä¸€å®šè¦ç”¨to be.</p><h1 id="éè°“è¯­è¯æ€§"><a href="#éè°“è¯­è¯æ€§" class="headerlink" title="éè°“è¯­è¯æ€§"></a>éè°“è¯­è¯æ€§</h1><p>1.æˆ‘å–œæ¬¢è·‘æ­¥ã€‚ åŠ¨åè¯&#x3D;è¡¨ç¤ºåŠ¨ä½œå«ä¹‰çš„åè¯<br>I like running.    doing&#x3D;åè¯æ€§</p><p>+ingå˜åè¯å°±å¯ä¹Ÿåšæ–‡ç« </p><p>2.è·‘æ­¥æ˜¯ä¸€é¡¹å¾ˆå¥½çš„è¿åŠ¨ã€‚<br>Running is a good sport.<br>Doing sth.&#x3D;åè¯(åšæŸä»¶äº‹æƒ…)<br>3.æˆ‘å–œæ¬¢åˆ¶ä½œè›‹ç³•ã€‚<br>I like making cakes.<br>4.çœ‹ç”µè§†æ˜¯æˆ‘çš„ä¹ æƒ¯ã€‚<br>Watching TV is my habit.</p><p>to doç›®çš„æˆ–å°†æ¥</p><p>1.æˆ‘å–œæ¬¢å»è·‘æ­¥ã€‚<br>I like to run.<br>To do&#x3D;åè¯æ€§<br>2.è¦è§£å†³è¿™ä¸ªé—®é¢˜æ˜¯å¾ˆå›°éš¾çš„ã€‚<br>è¦è§£å†³è¿™ä¸ªé—®é¢˜è¡¨ç›®çš„ç”¨ to do<br>To solve the problem is so hard.</p><p>æµ…æµ…äº†è§£ï¼šä»‹è¯çŸ­è¯­&#x3D;in the houseï¼ˆä»‹å®¾çŸ­è¯­ï¼‰<br>Done&#x3D;å½¢å®¹è¯<br>The house æ˜¯åè¯ è¿™æ ·ä¹Ÿå¯ä»¥æ¢æˆdoing sth.<br>3.æˆ‘å¾ˆæ“…é•¿è‹±è¯­ã€‚<br>I am good at(ä»‹è¯) studying Englishã€‚</p><p>4.è¿™ä¸ªèŠ±ç“¶è¢«æ‰“ç ´äº†ã€‚<br>This vase is broken. Broken&#x3D;è¢«æ‰“ç ´äº†adj.å½¢å®¹è¯<br>5.è¿™é¡¹ä»»åŠ¡å®Œæˆäº†ã€‚<br>This task is finished. Finished&#x3D;è¢«å®Œæˆçš„ã€‚</p><p>6.è¿™ä¸ªæ¼‚äº®çš„å¥³å­©æ˜¯æˆ‘å¥³æœ‹å‹ã€‚<br>This beautiful girl is my girlfriend.<br>å½¢å®¹è¯å¯ä»¥æ”¾åœ¨å‰ç½®åšä¿®é¥°ã€‚<br>7.è¿™ä¸ªè¢«æ‰“ç ´çš„èŠ±ç“¶æ˜¯çº¢è‰²çš„ã€‚<br>This broken vase is red.   Done&#x3D;è¡¨ç¤ºè¢«åŠ¨å«ä¹‰çš„å½¢å®¹è¯</p><p>doing&#x3D;åè¯ã€å½¢å®¹è¯</p><p>This problem is confusing.(confusingæ˜¯å½¢å®¹è¯å¯ä»¥åšä¿®é¥°)<br>è¿™ä¸ªé—®é¢˜ä»¤äººå›°æƒ‘ã€‚<br>This confusing problem interests me.<br>è¿™ä¸ªä»¤äººå›°æƒ‘çš„é—®é¢˜æ¿€å‘äº†æˆ‘çš„å…´è¶£ã€‚<br>This confusing problem interests the excited boy and the exciting girl.<br>è¿™ä¸ªä»¤äººå›°æƒ‘çš„é—®é¢˜æ¿€å‘äº†è¿™ä¸ªæ„Ÿåˆ°å…´å¥‹çš„ç”·å­©ä»¥åŠè¿™ä¸ªä»¤äººå…´å¥‹çš„å¥³å­©çš„å…´è¶£ã€‚</p><p>æ”¹è¢«åŠ¨<br>The excited boy and the exciting girl are interested by&#x2F;in this confusing problem.<br>è¿™ä¸ªæ„Ÿåˆ°å…´å¥‹çš„ç”·å­©ä¸è¿™ä¸ªä»¤äººå…´å¥‹çš„å¥³å­©å¯¹è¿™ä¸ªä»¤äººå›°æƒ‘çš„é—®é¢˜æ„Ÿå…´è¶£ã€‚</p><h2 id="ä¹ é¢˜"><a href="#ä¹ é¢˜" class="headerlink" title="ä¹ é¢˜"></a>ä¹ é¢˜</h2><p>å¸çƒŸæ˜¯æœ‰å®³çš„ã€‚<br>Smoing is harmful.</p><p>Marryå¼€å§‹å­¦ä¹ é’¢ç´ã€‚<br>Marry starts learning piano.</p><p>æ¯å¤©å–æ°´æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚<br>To drink water every day is necessary.</p><p>æˆ‘å¾ˆå–œæ¬¢å¬éŸ³ä¹ã€‚<br>I like to listen to music very much.</p><p>è¿™ä½è¢«å’¬çš„ç”·å­©æ˜¯ä»–å“¥å“¥ã€‚<br>This bitten boy is his brother.</p><ol start="2"><li>doing</li></ol><p>è¿™ä¸ªæ— èŠçš„ç”·å­©æ­£åœ¨çœ‹ç€æ— èŠçš„ç”µè§†ã€‚<br>This bored boy is watching boreing TV.<br>æˆ‘å¯¹è¿™ä»½ç´¯äººçš„å·¥ä½œæ„Ÿåˆ°åŒå€¦ã€‚<br>I got tired of the tiring job.<br>è¿™éƒ¨ä»¤æˆ‘ä»¬æ‰€æœ‰åŒå­¦å…´å¥‹çš„ç”µå½±å…¶å®å¾ˆæ— èŠã€‚<br>This movies excites all our students is actually very boring</p>]]></content>
      
      
      <categories>
          
          <category> English </category>
          
      </categories>
      
      
        <tags>
            
            <tag> English </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>.NETä¾èµ–æ³¨å…¥(ä¸‰ç§ç”Ÿå‘½å‘¨æœŸ)</title>
      <link href="/2025/08/02/asp.net%20core/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/"/>
      <url>/2025/08/02/asp.net%20core/%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<h1 id="NETä¾èµ–æ³¨å…¥"><a href="#NETä¾èµ–æ³¨å…¥" class="headerlink" title=".NETä¾èµ–æ³¨å…¥"></a>.NETä¾èµ–æ³¨å…¥</h1><h3 id="ä»€ä¹ˆæ˜¯ä¾èµ–æ³¨å…¥"><a href="#ä»€ä¹ˆæ˜¯ä¾èµ–æ³¨å…¥" class="headerlink" title="ä»€ä¹ˆæ˜¯ä¾èµ–æ³¨å…¥"></a>ä»€ä¹ˆæ˜¯ä¾èµ–æ³¨å…¥</h3><p>ä¾èµ–æ³¨å…¥æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œå®ƒè®©ç±»çš„ä¾èµ–é¡¹ï¼ˆæ¯”å¦‚æœåŠ¡ã€æ•°æ®åº“ã€æ—¥å¿—ç»„ä»¶ç­‰ï¼‰ç”±å¤–éƒ¨ç³»ç»Ÿï¼ˆæ¯”å¦‚æ¡†æ¶ï¼‰æä¾›ï¼Œè€Œä¸æ˜¯ç±»è‡ªå·±åˆ›å»ºã€‚</p><h3 id="å¸¸è§æœ¯è¯­"><a href="#å¸¸è§æœ¯è¯­" class="headerlink" title="å¸¸è§æœ¯è¯­"></a>å¸¸è§æœ¯è¯­</h3><p>Serviceï¼šè¢«æ³¨å…¥çš„æœåŠ¡ï¼ˆç±»ã€æ¥å£ï¼‰</p><p>Containerï¼šæ³¨å†Œå’Œç®¡ç†æœåŠ¡çš„å®¹å™¨</p><p>Lifetimeï¼šæœåŠ¡çš„ç”Ÿå‘½å‘¨æœŸï¼ˆScopedã€Singletonã€Transientï¼‰</p><h2 id="æœåŠ¡ç”Ÿå‘½å‘¨æœŸ"><a href="#æœåŠ¡ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="æœåŠ¡ç”Ÿå‘½å‘¨æœŸ"></a>æœåŠ¡ç”Ÿå‘½å‘¨æœŸ</h2><p>ä¾èµ–æ³¨å…¥å®¹å™¨ç®¡ç†æœåŠ¡çš„ç”Ÿå‘½å‘¨æœŸï¼ˆLifetimeï¼‰ï¼Œå†³å®šäº†æœåŠ¡å®ä¾‹çš„åˆ›å»ºå’Œé”€æ¯æ—¶æœºã€‚</p><h3 id="Scoped-ä½œç”¨åŸŸ"><a href="#Scoped-ä½œç”¨åŸŸ" class="headerlink" title="Scoped(ä½œç”¨åŸŸ)"></a>Scoped(ä½œç”¨åŸŸ)</h3><p>å®šä¹‰ï¼šåœ¨<strong>ä¸€ä¸ªè¯·æ±‚ï¼ˆScopeï¼‰</strong>ä¸­åˆ›å»ºä¸€ä¸ªå®ä¾‹ã€‚é€šå¸¸åœ¨ Web åº”ç”¨ä¸­è¡¨ç¤ºä¸€æ¬¡ HTTP è¯·æ±‚å‘¨æœŸã€‚</p><p>æ³¨å†Œæ–¹å¼ï¼šservices.AddScoped&lt;TService, TImplementation&gt;()</p><p>é€‚ç”¨åœºæ™¯ï¼šé€‚ç”¨äºéœ€è¦åœ¨ä¸€ä¸ªè¯·æ±‚ä¸­ä¿æŒçŠ¶æ€ï¼Œä½†è¯·æ±‚ä¹‹é—´ä¸å…±äº«çš„æœåŠ¡ï¼Œä¾‹å¦‚å·¥ä½œå•å…ƒï¼ˆUnit of Workï¼‰ã€‚</p><p>æ¯”å–»ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">services.AddScoped&lt;IMyService, MyService&gt;();</span><br></pre></td></tr></table></figure><p>è¯´æ˜ï¼šåœ¨åŒä¸€æ¬¡ HTTP è¯·æ±‚ä¸­æ³¨å…¥çš„éƒ½æ˜¯åŒä¸€ä¸ª MyService å®ä¾‹ï¼Œä¸åŒè¯·æ±‚æ˜¯ä¸åŒå®ä¾‹ã€‚</p><p>æƒ³è±¡ä½ æ˜¯ä¸€ä¸ªé¥­åº—è€æ¿ï¼š</p><p>æ¯è¿›æ¥ä¸€ä¸ªé¡¾å®¢ï¼ˆè¡¨ç¤ºä¸€æ¬¡ HTTP è¯·æ±‚ï¼‰ï¼š</p><p>ç»™ä»–åˆ†é…ä¸€ä¸ªã€æ‰˜ç›˜ã€‘ï¼ˆè¡¨ç¤ºä¸€ä¸ªä½œç”¨åŸŸ Scopeï¼‰ã€‚</p><p>ç„¶ååœ¨æ‰˜ç›˜ä¸Šæ”¾é¥®æ–™ã€èœå•ï¼ˆæœåŠ¡å¯¹è±¡ï¼‰ã€‚</p><p>Scoped ç”Ÿå‘½å‘¨æœŸå°±åƒã€æ¯ä¸ªé¡¾å®¢éƒ½æœ‰è‡ªå·±çš„æ‰˜ç›˜ï¼Œæ‰˜ç›˜é‡Œçš„æœåŠ¡å¯¹è¿™ä¸ªé¡¾å®¢æ˜¯ä¸€æ ·çš„ã€‘ï¼š</p><p>é¡¾å®¢ Aï¼ˆHTTP è¯·æ±‚ 1ï¼‰æ¥äº†ï¼Œç³»ç»Ÿç»™ä»–ä¸€ä¸ªæ–°çš„ MyService å®ä¾‹ã€‚</p><p>é¡¾å®¢ A ç”¨äº†ä¸€æ•´é¡¿é¥­ï¼ˆè¿™ä¸ªè¯·æ±‚è¿‡ç¨‹ä¸­ï¼‰ï¼Œæ— è®º Controller &#x2F; Service å±‚è°ƒç”¨å‡ æ¬¡ï¼Œæ‹¿åˆ°çš„éƒ½æ˜¯è¿™ä¸ªå®ä¾‹ã€‚</p><p>é¡¾å®¢ Bï¼ˆHTTP è¯·æ±‚ 2ï¼‰åˆæ¥äº†ï¼Œä»–ä¹Ÿåˆ†é…äº†ä¸€ä¸ªæ–°çš„ MyService å®ä¾‹ï¼Œè·Ÿ A çš„ä¸åŒã€‚</p><h3 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h3><p>åœ¨ ASP.NET Core Web é¡¹ç›®ä¸­ä½¿ç”¨å®ƒæ¥éªŒè¯â€œåŒä¸€ä¸ªè¯·æ±‚ç”¨åŒä¸€ä¸ªå®ä¾‹â€çš„æ•ˆæœã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IMyScopedService</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function">Guid <span class="title">GetOperationId</span>()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyScopedService</span> : <span class="title">IMyScopedService</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> Guid _operationId;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyScopedService</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        _operationId = Guid.NewGuid();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Guid <span class="title">GetOperationId</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> _operationId;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨å†ŒæœåŠ¡åˆ°å®¹å™¨ä¸­ Program.cs</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">builder.Services.AddScoped&lt;IMyScopedService, MyScopedService&gt;();</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">ApiController</span>]</span><br><span class="line">[<span class="meta">Route(<span class="string">&quot;[controller]&quot;</span>)</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TestController</span> : <span class="title">ControllerBase</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> IMyScopedService _service1;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> IMyScopedService _service2;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TestController</span>(<span class="params">IMyScopedService service1, IMyScopedService service2</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _service1 = service1;</span><br><span class="line">        _service2 = service2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">HttpGet(<span class="string">&quot;check&quot;</span>)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> IActionResult <span class="title">CheckScoped</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> id1 = _service1.GetOperationId();</span><br><span class="line">        <span class="keyword">var</span> id2 = _service2.GetOperationId();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Ok(<span class="keyword">new</span></span><br><span class="line">        &#123;</span><br><span class="line">            Service1Id = id1,</span><br><span class="line">            Service2Id = id2,</span><br><span class="line">            AreSame = id1 == id2</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•æ•ˆæœ</p><p>å¯åŠ¨é¡¹ç›®ï¼Œè®¿é—® &#x2F;test&#x2F;check</p><p>ä¼šçœ‹åˆ°è¾“å‡ºå¦‚ä¸‹ï¼ˆä¸¤ä¸ª ID ä¸€æ ·ï¼Œè¯´æ˜æ˜¯åŒä¸€ä¸ªå®ä¾‹ï¼‰ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;Service1Id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0b6a22e2-2a8d-4896-9d59-82452f7032e6&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;Service2Id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0b6a22e2-2a8d-4896-9d59-82452f7032e6&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;AreSame&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>åˆ·æ–°é¡µé¢ï¼ˆå³å¦ä¸€ä¸ªè¯·æ±‚ï¼‰ï¼Œä¼šå¾—åˆ°æ–°çš„ IDï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;Service1Id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2e191177-c94a-42ce-b274-1faad4f5a5e2&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;Service2Id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2e191177-c94a-42ce-b274-1faad4f5a5e2&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;AreSame&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>è¯´æ˜ï¼š</p><p>æ¯æ¬¡è¯·æ±‚éƒ½ä¼šåˆ›å»ºæ–°çš„ MyScopedService å®ä¾‹ã€‚</p><p>åŒä¸€ä¸ªè¯·æ±‚å†…çš„å¤šä¸ªæ³¨å…¥æ˜¯åŒä¸€ä¸ªå®ä¾‹ </p><h3 id="Singleton-å•ä¾‹"><a href="#Singleton-å•ä¾‹" class="headerlink" title="Singleton(å•ä¾‹)"></a>Singleton(å•ä¾‹)</h3><p>å®šä¹‰ï¼šæ•´ä¸ªåº”ç”¨ç¨‹åºç”Ÿå‘½å‘¨æœŸä¸­åªåˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œå¹¶è¢«æ‰€æœ‰è¯·æ±‚å…±äº«ã€‚</p><p>æ³¨å†Œæ–¹å¼ï¼šservices.AddSingleton&lt;TService, TImplementation&gt;()</p><p>é€‚ç”¨åœºæ™¯ï¼šçº¿ç¨‹å®‰å…¨ã€æ— çŠ¶æ€æœåŠ¡ï¼Œæˆ–æœ‰çŠ¶æ€ä½†å…±äº«å…¨å±€çŠ¶æ€çš„æœåŠ¡ã€‚</p><p>æ¯”å–»ç†è§£ Singleton ç”Ÿå‘½å‘¨æœŸï¼ˆå•ä¾‹ï¼‰<br>é¥­åº—è€æ¿çš„ä¾‹å­ï¼ˆç»§ç»­ï¼‰<br>è¿˜è®°å¾—ä¹‹å‰è¯´çš„â€œæ¯ä¸ªé¡¾å®¢ä¸€ä¸ªæ‰˜ç›˜â€æ˜¯ Scoped å—ï¼Ÿ<br>ç°åœ¨æ¢æˆ Singletonï¼š<br>å°±åƒä½ é¥­åº—é‡Œæœ‰ä¸€å°å…±äº«çš„é¥®æ°´æœºï¼ˆæˆ–èœå•çœ‹æ¿ï¼‰â˜•ï¼Œæ‰€æœ‰é¡¾å®¢éƒ½ç”¨åŒä¸€ä¸ªï¼Œä¸ä¼šä¸ºæ¯ä¸ªé¡¾å®¢æ–°å»ºä¸€ä¸ªã€‚<br>æŠ€æœ¯ä¸Šï¼šSingleton å°±æ˜¯ â€œåªåˆ›å»ºä¸€æ¬¡æœåŠ¡å®ä¾‹â€ï¼Œå¹¶åœ¨æ•´ä¸ªç¨‹åºä¸­å…±äº«ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">services.AddSingleton&lt;IMyService, MyService&gt;();</span><br></pre></td></tr></table></figure><p>è¯´æ˜ï¼šç¬¬ä¸€æ¬¡è¯·æ±‚æ—¶åˆ›å»º MyService çš„å®ä¾‹ï¼Œä¹‹åæ¯æ¬¡éƒ½ä½¿ç”¨åŒä¸€ä¸ªå®ä¾‹ã€‚</p><h3 id="ä¾‹å­-1"><a href="#ä¾‹å­-1" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h3><p>å’Œä¹‹å‰çš„ Scoped ç¤ºä¾‹ç›¸æ¯”ï¼Œæˆ‘ä»¬åªæ”¹æ³¨å†Œæ–¹å¼ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IMySingletonService</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function">Guid <span class="title">GetOperationId</span>()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MySingletonService</span> : <span class="title">IMySingletonService</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> Guid _operationId;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MySingletonService</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        _operationId = Guid.NewGuid();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Guid <span class="title">GetOperationId</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> _operationId;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨å†Œä¸º Singletonï¼ˆProgram.csï¼‰</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">builder.Services.AddSingleton&lt;IMySingletonService, MySingletonService&gt;();</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">ApiController</span>]</span><br><span class="line">[<span class="meta">Route(<span class="string">&quot;[controller]&quot;</span>)</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TestController</span> : <span class="title">ControllerBase</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> IMySingletonService _service1;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> IMySingletonService _service2;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TestController</span>(<span class="params">IMySingletonService service1, IMySingletonService service2</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _service1 = service1;</span><br><span class="line">        _service2 = service2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">HttpGet(<span class="string">&quot;singleton&quot;</span>)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> IActionResult <span class="title">CheckSingleton</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> id1 = _service1.GetOperationId();</span><br><span class="line">        <span class="keyword">var</span> id2 = _service2.GetOperationId();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Ok(<span class="keyword">new</span></span><br><span class="line">        &#123;</span><br><span class="line">            Service1Id = id1,</span><br><span class="line">            Service2Id = id2,</span><br><span class="line">            AreSame = id1 == id2</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è®¿é—®æµ‹è¯•ï¼š<br>æ‰“å¼€æµè§ˆå™¨è®¿é—® &#x2F;test&#x2F;singletonï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;Service1Id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;f8e3a16e-1c6f-4531-9ed3-2bb89f4f750a&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;Service2Id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;f8e3a16e-1c6f-4531-9ed3-2bb89f4f750a&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;AreSame&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>å†æ¬¡åˆ·æ–°é¡µé¢ï¼Œä½ ä¼šå‘ç°è¾“å‡ºçš„è¿˜æ˜¯åŒä¸€ä¸ª ID â†’ è¯´æ˜æ‰€æœ‰è¯·æ±‚ç”¨çš„æ˜¯åŒä¸€ä¸ªæœåŠ¡å®ä¾‹</p><h3 id="Transient-ç¬æ€"><a href="#Transient-ç¬æ€" class="headerlink" title="Transient(ç¬æ€)"></a>Transient(ç¬æ€)</h3><p>å®šä¹‰ï¼šæ¯æ¬¡è¯·æ±‚éƒ½ä¼šåˆ›å»ºæ–°çš„å®ä¾‹ã€‚</p><p>æ³¨å†Œæ–¹å¼ï¼šservices.AddTransient&lt;TService, TImplementation&gt;()</p><p>é€‚ç”¨åœºæ™¯ï¼šè½»é‡çº§ã€æ— çŠ¶æ€æœåŠ¡ï¼›é€‚åˆçŸ­ç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡ã€‚å…¶ç¼ºç‚¹æ˜¯ç”Ÿæˆçš„å¯¹è±¡æ¯”è¾ƒå¤šï¼Œä¼šæµªè´¹å†…å­˜ã€‚</p><p>ç¤ºä¾‹ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">services.AddTransient&lt;IMyService, MyService&gt;();</span><br></pre></td></tr></table></figure><p>è¯´æ˜ï¼šæ¯æ¬¡æ³¨å…¥æ—¶éƒ½åˆ›å»ºä¸€ä¸ªæ–°çš„ MyService å®ä¾‹ã€‚</p><p>ç”Ÿå‘½å‘¨æœŸçš„é€‚é…ç­–ç•¥</p><p>åœºæ™¯                   æ¨èç”Ÿå‘½å‘¨æœŸ<br>å…¨å±€é…ç½®æœåŠ¡            Singleton<br>æ•°æ®åº“ä¸Šä¸‹æ–‡ï¼ˆDbContextï¼‰Scoped<br>å·¥å…·ç±»&#x2F;è½»é‡æœåŠ¡            Transient<br>ç¼“å­˜æœåŠ¡ï¼ˆå¦‚ Redis ç¼“å­˜ï¼‰Singleton<br>æ—¥å¿—è®°å½•å™¨               Singleton<br>ç”¨æˆ·è¯·æ±‚ä¸Šä¸‹æ–‡ç›¸å…³æœåŠ¡    Scoped</p><blockquote><p>æ³¨æ„äº‹é¡¹<br>ä¸è¦åœ¨ Singleton ä¸­æ³¨å…¥ Scoped æˆ– Transient<br>ä¼šå¯¼è‡´ä½œç”¨åŸŸé”™è¯¯æˆ–å†…å­˜æ³„æ¼ã€‚<br>å¦‚æœä¸€å®šè¦è¿™ä¹ˆåšï¼Œå¯ä»¥ä½¿ç”¨ IServiceScopeFactory æ‰‹åŠ¨åˆ›å»ºä½œç”¨åŸŸã€‚</p></blockquote><p>EF Core çš„ DbContext é»˜è®¤æ˜¯ Scoped ç”Ÿå‘½å‘¨æœŸ<br>æ‰€ä»¥åº”é¿å…æŠŠ DbContext æ³¨å…¥åˆ° Singleton æœåŠ¡ä¸­ã€‚</p><p>æ¯”å–»ç†è§£ Transientï¼ˆç¬æ€ï¼‰<br>ç»§ç»­ç”¨é¥­åº—çš„ä¾‹å­ï¼š</p><p>Transient å°±åƒä½ ç»™é¡¾å®¢å€’æ°´æ—¶æ¯æ¬¡éƒ½æ¢ä¸€ä¸ªä¸€æ¬¡æ€§çº¸æ¯ï¼Œè°è¦ç”¨æ°´ï¼Œç«‹å³ä¸´æ—¶ç»™ä»–ä¸€ä¸ªæ–°çš„æ¯å­ï¼Œç”¨å®Œå°±æ‰”æ‰ï¼Œæ°¸è¿œä¸ä¼šå¤ç”¨</p><h3 id="ä¾‹å­-2"><a href="#ä¾‹å­-2" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IMyTransientService</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function">Guid <span class="title">GetOperationId</span>()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyTransientService</span> : <span class="title">IMyTransientService</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> Guid _operationId;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyTransientService</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        _operationId = Guid.NewGuid();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Guid <span class="title">GetOperationId</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> _operationId;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨å†Œä¸º Transientï¼ˆProgram.csï¼‰</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">builder.Services.AddTransient&lt;IMyTransientService, MyTransientService&gt;();</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">ApiController</span>]</span><br><span class="line">[<span class="meta">Route(<span class="string">&quot;[controller]&quot;</span>)</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TestController</span> : <span class="title">ControllerBase</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> IMyTransientService _service1;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> IMyTransientService _service2;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TestController</span>(<span class="params">IMyTransientService service1, IMyTransientService service2</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _service1 = service1;</span><br><span class="line">        _service2 = service2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">HttpGet(<span class="string">&quot;transient&quot;</span>)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> IActionResult <span class="title">CheckTransient</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> id1 = _service1.GetOperationId();</span><br><span class="line">        <span class="keyword">var</span> id2 = _service2.GetOperationId();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Ok(<span class="keyword">new</span></span><br><span class="line">        &#123;</span><br><span class="line">            Service1Id = id1,</span><br><span class="line">            Service2Id = id2,</span><br><span class="line">            AreSame = id1 == id2</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;Service1Id&quot;</span>: <span class="string">&quot;a12b1234-bbcd-4f9a-81a3-f93dabc56ab1&quot;</span>,</span><br><span class="line">  <span class="string">&quot;Service2Id&quot;</span>: <span class="string">&quot;9f334b12-fada-4873-bc6d-ff3455c68e92&quot;</span>,</span><br><span class="line">  <span class="string">&quot;AreSame&quot;</span>: <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šåŒä¸€ä¸ªè¯·æ±‚ä¸­æ³¨å…¥ä¸¤æ¬¡æœåŠ¡ï¼Œæ‹¿åˆ°çš„æ˜¯ä¸¤ä¸ªä¸åŒå®ä¾‹ï¼<br>å†åˆ·æ–°é¡µé¢ï¼ŒID è¿˜ä¼šå˜ â†’ è¯´æ˜æ¯æ¬¡è¯·æ±‚éƒ½ä¼š newã€‚</p><p>ä¸‰ç§ç”Ÿå‘½å‘¨æœŸå¯¹æ¯”æ€»ç»“</p><p>ç”Ÿå‘½å‘¨æœŸ     åˆ›å»ºé¢‘ç‡           ä½¿ç”¨èŒƒå›´             ä¸¾ä¾‹ç±»æ¯”</p><p>Singleton    åº”ç”¨å¯åŠ¨æ—¶åˆ›å»ºä¸€æ¬¡   æ‰€æœ‰åœ°æ–¹éƒ½å¤ç”¨      é¥®æ°´æœº &#x2F; èœå•çœ‹æ¿</p><p>Scoped        æ¯æ¬¡è¯·æ±‚åˆ›å»ºä¸€æ¬¡   å½“å‰è¯·æ±‚ä¸­å¤ç”¨      æ¯äººæ‰˜ç›˜</p><p>Transient    æ¯æ¬¡æ³¨å…¥éƒ½åˆ›å»ºæ–°å®ä¾‹    æ— å¤ç”¨ï¼Œæ¯æ¬¡éƒ½ new   ä¸€æ¬¡æ€§çº¸æ¯</p>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ASP.NET Core </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>éè°“è¯­3+å¦‚ä½•ä½¿ç”¨to do</title>
      <link href="/2025/08/01/asp.net%20core/%E8%8B%B1%E8%AF%AD/%E9%9D%9E%E8%B0%93%E8%AF%AD3,to%20do/"/>
      <url>/2025/08/01/asp.net%20core/%E8%8B%B1%E8%AF%AD/%E9%9D%9E%E8%B0%93%E8%AF%AD3,to%20do/</url>
      
        <content type="html"><![CDATA[<h1 id="éè°“è¯­3-å¦‚ä½•ä½¿ç”¨to-do"><a href="#éè°“è¯­3-å¦‚ä½•ä½¿ç”¨to-do" class="headerlink" title="éè°“è¯­3+å¦‚ä½•ä½¿ç”¨to do"></a>éè°“è¯­3+å¦‚ä½•ä½¿ç”¨to do</h1><p>to goè¡¨ç¤ºç›®çš„æˆ–å°†æ¥<br>1.æ˜å¤©å°†è¦ä¸¾è¡Œçš„ä¼šè®®å–æ¶ˆäº†ã€‚<br>ç‹¬ç«‹åè¯å‰é¢è¦+the this that a an<br>ä¸»å¹²ï¼šThe meeting is canceled.<br>The meeting to be held tomorrow is canceled.</p><p>2.æˆ‘ç”¨ç¬”æ¥å†™æ–‡ç« ã€‚<br>ç”¨å’Œå†™éƒ½æ˜¯è°“è¯­ï¼Œä¸€å¥ä¸€è°“ï¼Œå†™åšéè°“è¯­ã€‚<br>å†™è¡¨ç›®çš„ï¼Œç”¨to  doã€‚<br>I use the pen to write an article.</p><ol start="3"><li>ä¸ºäº†å†™ç¯‡å¥½æ–‡ç« ï¼Œæˆ‘è¯»äº†å¾ˆå¤šä¹¦ã€‚<br>å†™ç¯‡å¥½æ–‡ç« æ˜¯ç›®çš„ï¼Œç”¨to do.<br>æˆ‘è¯»äº†å¾ˆå¤šä¹¦:ç°åœ¨å®Œæˆæ—¶ã€‚<br>I have read many books.<br>To write a good article, I have read many books.</li></ol><p>4.æˆ‘å»å¥èº«æˆ¿é”»ç‚¼ã€‚<br>I go to the gym to exercise</p><p>5.ä¸‹ä¸€åˆ—åˆ°ç«™çš„ç«è½¦æ˜¯ä»çº½çº¦æ¥çš„ã€‚<br>ä¸»å¹²ï¼šthe train is from New Yorkã€‚<br>The next train to arrive is from New York.</p><h2 id="ä¹ é¢˜"><a href="#ä¹ é¢˜" class="headerlink" title="ä¹ é¢˜"></a>ä¹ é¢˜</h2><p>æˆ‘å»å¸‚åœºä¹°è‹¹æœã€‚<br>I go to the market to buy apples.</p><p>è¿™æ˜¯ä¸€å°å°†åœ¨ä¸‹å‘¨å‘é€çš„ä¿¡ä»¶ã€‚<br>This is a letter to be sent next week.</p><p>ä¸ºè·å¾—å¥–å“ï¼ŒTomåŠªåŠ›å­¦ä¹ ã€‚<br>Tom studies hard, to get the prize.</p><p>Marryå­˜äº†å¾ˆå¤šé’±ä¹°æˆ¿å­ã€‚<br>Marry has saved much money to a house.</p>]]></content>
      
      
      <categories>
          
          <category> English </category>
          
      </categories>
      
      
        <tags>
            
            <tag> English </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ­å»ºè‹±è¯­ç½‘ç«™ç¬¬ä¸€é˜¶æ®µ</title>
      <link href="/2025/07/31/asp.net%20core/%E5%AD%A6%E8%8B%B1%E8%AF%AD%E7%BD%91%E7%AB%99%E9%A1%B9%E7%9B%AE/%E5%AD%A6%E8%8B%B1%E8%AF%AD%E7%BD%91%E7%AB%991%E9%98%B6%E6%AE%B5/"/>
      <url>/2025/07/31/asp.net%20core/%E5%AD%A6%E8%8B%B1%E8%AF%AD%E7%BD%91%E7%AB%99%E9%A1%B9%E7%9B%AE/%E5%AD%A6%E8%8B%B1%E8%AF%AD%E7%BD%91%E7%AB%991%E9%98%B6%E6%AE%B5/</url>
      
        <content type="html"><![CDATA[<h1 id="ç½‘ç«™ç»“æ„è¯´æ˜"><a href="#ç½‘ç«™ç»“æ„è¯´æ˜" class="headerlink" title="ç½‘ç«™ç»“æ„è¯´æ˜"></a>ç½‘ç«™ç»“æ„è¯´æ˜</h1><p><b>å­¦ä¹ æ¨ä¸­ç§‘è€å¸ˆå¼€æºé¡¹ç›®åœ¨çº¿è‹±è¯­ç½‘ç«™å¾®æœåŠ¡</b></p><ol><li>åŠŸèƒ½ï¼šå¬åŠ›ç»ƒä¹ ã€‚</li><li>ä¸šåŠ¡æ¦‚å¿µï¼šç±»åˆ«ï¼ˆCategoryï¼‰ã€ä¸“è¾‘ï¼ˆAlbumï¼‰ã€ç‰‡æ®µï¼ˆEpisodeï¼‰ã€‚</li><li>å¬åŠ›åŸæ–‡å­—å¹•æ–‡ä»¶æŸ¥çœ‹ã€‚</li><li>ç½‘ç«™åå°å…è®¸è¿›è¡Œèµ„æºçš„CRUDã€‚</li><li>å…¶ä»–æ ¼å¼çš„éŸ³é¢‘çš„è¿½è¸ªåœ¨éƒ¨åˆ†æµè§ˆå™¨ä¸Šæœ‰é—®é¢˜ï¼Œç»Ÿä¸€ç”¨M4Aã€‚</li><li>éŸ³é¢‘æ–‡ä»¶æ”¾åˆ°å•ç‹¬çš„æ–‡ä»¶æœåŠ¡å™¨ä¸Šã€‚</li><li>åŸæ–‡çš„æœç´ ã€‚</li></ol><p><img src="/img%5Cwz.png"></p><h1 id="é¡¹ç›®ç»“æ„è¯´æ˜"><a href="#é¡¹ç›®ç»“æ„è¯´æ˜" class="headerlink" title="é¡¹ç›®ç»“æ„è¯´æ˜"></a>é¡¹ç›®ç»“æ„è¯´æ˜</h1><p>ä¸ºäº†ä¾¿äºç®¡ç†ï¼Œæˆ‘ä»¬æŠŠä¸åŒæœåŠ¡çš„é¡¹ç›®æ”¾åˆ°ä¸åŒçš„è§£å†³æ–¹æ¡ˆæ–‡ä»¶å¤¹ä¸‹ï¼Œè§£å†³æ–¹æ¡ˆæ–‡ä»¶å¤¹Commonsä¸‹çš„é¡¹ç›®æ˜¯ä¸€äº›å…¬ç”¨çš„ç±»åº“ã€‚<br>å„æœåŠ¡çš„è§£å†³æ–¹æ¡ˆæ–‡ä»¶å¤¹ä¸‹éƒ½åŒ…å«Domainã€Infrastuctureã€WebAPIè¿™3ä¸ªé¡¹ç›®ï¼Œå®ƒä»¬åˆ†åˆ«å¯¹åº”é¢†åŸŸå±‚ã€åŸºç¡€è®¾æ–½å±‚ã€åº”ç”¨æœåŠ¡å±‚ã€‚å¬åŠ›ç½‘ç«™å‰å°å’Œå¬åŠ›ç½‘ç«™åå°å…±äº«ç›¸åŒçš„é¢†åŸŸå±‚å’ŒåŸºç¡€è®¾æ–½å±‚ï¼Œå› æ­¤åœ¨è§£å†³æ–¹æ¡ˆæ–‡ä»¶å¤¹Listeningä¸‹æœ‰4ä¸ªé¡¹ç›®ã€‚<br>å› ä¸ºæ‰€æœ‰çš„é¡¹ç›®éƒ½ç”¨åˆ°äº†é¢†åŸŸäº‹ä»¶ã€é›†æˆäº‹ä»¶ã€ä¸­å¿ƒé…ç½®æœåŠ¡å™¨ã€JWTã€å·¥ä½œå•å…ƒã€CORSã€FluentValidationç­‰ï¼Œåˆ›å»ºCommonlnitializeré¡¹ç›®æ¥å¤ç”¨è¿™äº›ç»„ä»¶çš„åˆå§‹åŒ–ä»£ç ã€‚</p><p>æœ‰ä¸€ç‚¹éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼Œå¦‚æœæˆ‘ä»¬åˆ›å»ºçš„æ˜¯ASP.NET Coreé¡¹ç›®ï¼Œåœ¨é¡¹ç›®ä¸­æˆ‘ä»¬å¯ä»¥ä½¿ç”¨WebApplicationBuilderã€IApplicationBuilderã€IWebHostEnvironmentç­‰ç±»å‹ï¼Œä½†æ˜¯åœ¨ç±»åº“é¡¹ç›®ä¸­æˆ‘ä»¬åˆ™ä¸èƒ½ç›´æ¥ä½¿ç”¨è¿™äº›ç±»å‹ã€‚è¿™äº›ç±»å‹éƒ½å®šä¹‰åœ¨Microsoft.AspNetCore.Hosting.Abstractionsã€Microsoft.AspNetCoreç­‰ç¨‹åºé›†ä¸­ï¼Œç‰ˆæœ¬éå¸¸ä½ï¼ŒASP.NET Coreçš„åŒ…ä¸åœ¨å•ç‹¬å‘å¸ƒåˆ°NuGetä¸­ï¼Œè€Œæ˜¯ç›´æ¥å†…å»ºåœ¨.NET Core SDKä¸­ã€‚å¦‚æœæƒ³åœ¨ASP.NET Coreä¸­å¼•ç”¨è¿™äº›ASP.NET Coreçš„ç±»å‹ï¼Œè¯·åœ¨csprojä¸­æ·»åŠ &lt;FrameworkReference Include&#x3D;â€Microsoft.AspNetCore.Appâ€&#x2F;&gt;ã€‚</p><h1 id="é¡¹ç›®è¿è¡Œç¯å¢ƒæ­å»º"><a href="#é¡¹ç›®è¿è¡Œç¯å¢ƒæ­å»º" class="headerlink" title="é¡¹ç›®è¿è¡Œç¯å¢ƒæ­å»º"></a>é¡¹ç›®è¿è¡Œç¯å¢ƒæ­å»º</h1><p>è¿™ä¸ªé¡¹ç›®ä½¿ç”¨Microsoft SQL Serverä½œä¸ºæ•°æ®åº“æœåŠ¡å™¨ã€ç”¨Nginxä½œä¸ºç½‘å…³ã€ç”¨Rediså®ç°åˆ†å¸ƒå¼ç¼“å­˜ã€ç”¨RabbitMQå®ç°é¢†åŸŸäº‹ä»¶ã€ç”¨Elasticsearchä½œä¸ºæœç´¢å¼•æ“æœåŠ¡å™¨ã€‚</p><p>ç¬¬ä¸€æ­¥ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šæŠŠä¸åŒçš„æœåŠ¡æ”¾åˆ°ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œå› æ­¤ä¸ä¼šå‡ºç°å¤šä¸ªASP.NET Coreç½‘ç«™åŒæ—¶è¿è¡Œé€ æˆçš„ç«¯å£å†²çªé—®é¢˜ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬éœ€è¦åœ¨Visual Studioä¸­åŒæ—¶è¿è¡Œå¤šä¸ªASP.NET Coreé¡¹ç›®ï¼Œå°±å¯èƒ½ä¼šé‡åˆ°è¿™äº›é¡¹ç›®çš„ç«¯å£å†²çªçš„é—®é¢˜ã€‚å¦‚æœæˆ‘ä»¬ç”¨Visual Studioä¸­çš„IIS Expressæ¥è¿è¡Œç½‘ç«™çš„è¯ï¼Œå¯ä»¥ä¿®æ”¹ASP.NET Coreé¡¹ç›®çš„Propertiesæ–‡ä»¶å¤¹ä¸‹çš„launchSettings.jsonæ–‡ä»¶ï¼Œåœ¨iisExpressèŠ‚ç‚¹ä¸‹é…ç½®æŒ‡å®šé¡¹ç›®è¿è¡Œçš„ç«¯å£ã€‚<br><img src="/img%5C%E7%BD%91%E5%9D%80%5C15.png"></p><p>æˆ‘ä»¬åˆ†åˆ«è®©FileService.WebAPIã€IdentityService.WebAPIã€Listening.Admin.WebAPIã€Listening.Main.WebAPIã€MediaEncoder.WebAPIã€SearchService.WebAPIè¿è¡Œåœ¨44339ã€44392ã€44352ã€44375ã€44353ã€44310ç«¯å£ä¸‹ã€‚</p><p>ç¬¬äºŒæ­¥ï¼Œä¸ºäº†ç»Ÿä¸€å‰ç«¯è®¿é—®åç«¯çš„ä¸åŒæœåŠ¡çš„æ¥å£ï¼Œæˆ‘ä»¬é…ç½®Nginxæ¥åå‘ä»£ç†åç«¯çš„æ¥å£ã€‚æˆ‘ä»¬åœ¨nginxçš„nginx.confæ–‡ä»¶ä¸­çš„serverèŠ‚ç‚¹ä¸‹å¢åŠ ä»£ç ã€‚</p><p><img src="/img%5C%E7%BD%91%E5%9D%80%5C16.png"></p><p><b>é…ç½®nginx,è¿™é‡Œç«¯å£å·ä¸€å®šè¦å’Œä½ çš„swaggerç«¯å£å·ç»Ÿä¸€ï¼Œå› ä¸ºä½ ä¸æ˜¯ç”¨iisï¼Œå…¶æ¬¡å°±æ˜¯è·¨åŸŸçš„è¯ï¼Œé»˜è®¤swaggerçš„urlæœ‰2ä¸ª,åªèƒ½ç•™ä¸€ä¸ª<b><br>å‡è®¾ä½ çš„ Swagger æœåŠ¡è¿è¡Œåœ¨127.0.0.1:8080ï¼ŒNginx é…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span> <span class="number">80</span>;  <span class="comment"># å¯¹å¤–æš´éœ²çš„ç«¯å£ï¼Œå¯æ ¹æ®éœ€è¦ä¿®æ”¹</span></span><br><span class="line">    <span class="attribute">server_name</span> localhost;  <span class="comment"># ä½ çš„åŸŸåæˆ–æœåŠ¡å™¨IP</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä»£ç†åˆ°SwaggeræœåŠ¡ï¼Œç¡®ä¿ç«¯å£ä¸€è‡´</span></span><br><span class="line">    <span class="section">location</span> / &#123;</span><br><span class="line">        <span class="attribute">proxy_pass</span> http://127.0.0.1:8080;  <span class="comment"># ä¸SwaggeræœåŠ¡ç«¯å£ä¿æŒä¸€è‡´</span></span><br><span class="line">        <span class="attribute">proxy_set_header</span> Host <span class="variable">$host</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span> X-Forwarded-Proto <span class="variable">$scheme</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name  localhost;</span><br><span class="line"></span><br><span class="line">        location /FileService/&#123;</span><br><span class="line">            proxy_pass http://localhost:44339/;</span><br><span class="line">            proxy_set_header Host $host;</span><br><span class="line">            proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">            proxy_set_header X-Real-PORT $remote_port;</span><br><span class="line">            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">            proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class="line">            client_max_body_size 100m;  </span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        location /IdentityService/&#123;</span><br><span class="line">            proxy_pass http://localhost:44392/;</span><br><span class="line">            proxy_set_header Host $host;</span><br><span class="line">            proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">            proxy_set_header X-Real-PORT $remote_port;</span><br><span class="line">            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">            proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        location /Listening.Admin/&#123;</span><br><span class="line">            proxy_pass http://localhost:44352/;</span><br><span class="line">            proxy_set_header Host $host;</span><br><span class="line">            proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">            proxy_set_header X-Real-PORT $remote_port;</span><br><span class="line">            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">            proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class="line">            proxy_http_version 1.1;</span><br><span class="line">            proxy_set_header Upgrade $http_upgrade;</span><br><span class="line">            proxy_set_header Connection &quot;upgrade&quot;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        localhost /Listening.Main/&#123;</span><br><span class="line">            proxy_pass http://localhost:44375/;</span><br><span class="line">            proxy_set_header Host $host;</span><br><span class="line">            proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">            proxy_set_header X-Real-PORT $remote_port;</span><br><span class="line">            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">            proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        localhost /MediaEncoder/&#123;</span><br><span class="line">            proxy_pass http://localhost:44353/;</span><br><span class="line">            proxy_set_header Host $host;</span><br><span class="line">            proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">            proxy_set_header X-Real-PORT $remoto_port;</span><br><span class="line">            proxy_set_header X-For-For $proxy_add_x_forwarded_for;</span><br><span class="line">            proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        location /SearchService/&#123;</span><br><span class="line">            proxy_pass http://localhost:44310/;</span><br><span class="line">            proxy_set_header Host $host;</span><br><span class="line">            proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">            proxy_set_header X-Real-PORT $remote_port;</span><br><span class="line">            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">            proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        #charset koi8-r;</span><br><span class="line"></span><br><span class="line">        #access_log  logs/host.access.log  main;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">            root   html;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢é…ç½®çš„proxy_set_headeræ˜¯ç”¨æ¥æ–¹ä¾¿æˆ‘ä»¬åœ¨ASP.NET Coreä¸­è·å–å®¢æˆ·ç«¯IPåœ°å€çš„ï¼Œéœ€è¦é…åˆForwardedHeadersä¸­é—´ä»¶ä½¿ç”¨ã€‚<br>é…ç½®å®ŒNginxåï¼Œåªè¦é‡å¯NginxæœåŠ¡å™¨å³å¯è®©é…ç½®ç”Ÿæ•ˆï¼Œç„¶åæˆ‘ä»¬è®¿é—®<a href="https://localhost/IdentityService/%E5%B0%B1%E5%8F%AF%E4%BB%A5%E8%AE%BF%E9%97%AEIdentityService%E7%9A%84%E6%8E%A5%E5%8F%A3%E4%BA%86%EF%BC%8C%E8%BF%99%E6%A0%B7%E5%89%8D%E7%AB%AF%E5%B0%B1%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87%E7%BB%9F%E4%B8%80%E7%9A%84%E7%AB%AF%E5%8F%A3%E6%9D%A5%E8%AE%BF%E9%97%AE%E5%90%8E%E7%AB%AF%E6%9C%8D%E5%8A%A1%E3%80%82">https://localhost/IdentityService/å°±å¯ä»¥è®¿é—®IdentityServiceçš„æ¥å£äº†ï¼Œè¿™æ ·å‰ç«¯å°±å¯ä»¥é€šè¿‡ç»Ÿä¸€çš„ç«¯å£æ¥è®¿é—®åç«¯æœåŠ¡ã€‚</a></p><p>ç¬¬ä¸‰æ­¥ï¼ŒCommonInitializerä¸­çš„åˆå§‹åŒ–ä»£ç æ˜¯è®¾å®šä»â€œDefaultDB:ConnStrâ€è·¯å¾„ä¸­è¯»å–æ•°æ®åº“çš„è¿æ¥å­—ç¬¦ä¸²ï¼Œå› æ­¤è¯·åœ¨ç¯å¢ƒå˜é‡ä¸­é…ç½®åå­—ä¸ºDefaultDB:ConnStrçš„æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²ï¼Œç„¶ååœ¨å„ä¸ªé¡¹ç›®ä¸­è¿è¡ŒEF Coreæ•°æ®åº“è¿ç§»æ¥ç”Ÿæˆæ•°æ®åº“è¡¨ã€‚<br><img src="/img%5C%E7%BD%91%E5%9D%80%5C17.png"></p><p>ç¬¬å››æ­¥ï¼Œæˆ‘ä»¬åœ¨æ•°æ®åº“ä¸­å¢åŠ ä¸€ä¸ªåå­—ä¸ºT_Configsçš„è¡¨ï¼Œå¹¶ä¸”åœ¨è¡¨ä¸­å¢åŠ å¦‚ä¸‹é…ç½®ã€‚<br><img src="/img%5C%E7%BD%91%E5%9D%80%5C18.png"></p><p>Corsçš„é…ç½®é¡¹ä¸ºé¡¹ç›®çš„è·¨åŸŸè®¾ç½®ã€‚<br>FileService:SMBçš„é…ç½®é¡¹ä¸ºæ–‡ä»¶å¤‡ä»½æœåŠ¡å™¨çš„æ ¹ç›®å½•ã€‚<br>Redisçš„é…ç½®é¡¹ä¸ºRedisæœåŠ¡å™¨çš„è¿æ¥é…ç½®ã€‚<br>RabbitMQçš„é…ç½®é¡¹ä¸ºé›†æˆäº‹ä»¶ç›¸å…³RabbitMQçš„é…ç½®ï¼ŒHostNameå±æ€§ä¸ºæœåŠ¡å™¨çš„åœ°å€ï¼ŒExchangeNameå±æ€§ä¸ºé›†æˆäº‹ä»¶çš„äº¤æ¢æœºåå­—ã€‚<br>ElasticSearchçš„é…ç½®é¡¹ä¸ºElasticSearchæœåŠ¡å™¨çš„é…ç½®ï¼Œå…¶ä¸­çš„ç”¨æˆ·åã€å¯†ç éœ€è¦å’Œè¯»è€…å®‰è£…çš„ElasticSearchæœåŠ¡å™¨çš„é…ç½®ä¸€è‡´ã€‚<br>JWTçš„é…ç½®é¡¹ä¸ºç™»å½•ä»¤ç‰Œçš„JWTé…ç½®ã€‚</p><h1 id="Commons"><a href="#Commons" class="headerlink" title="Commons"></a>Commons</h1><p>ä¸€äº›é¡¹ç›®åˆå§‹åŒ–çš„ä»£ç æ”¾åˆ°è¿™é‡Œï¼Œé¡¹ç›®é‡Œé€šç”¨çš„ä¸œè¥¿æ”¾åˆ°Commonsè§£å†³æ–¹æ¡ˆæ–‡ä»¶å¤¹ä¸‹</p><p><img src="/img%5C%E7%BD%91%E5%9D%80%5CCommons.png"></p><h3 id="é¡¹ç›®æºç "><a href="#é¡¹ç›®æºç " class="headerlink" title="é¡¹ç›®æºç "></a>é¡¹ç›®æºç </h3><table border="1" cellspacing="0"><tr><td>é¡¹ç›®</td><td>ç±»</td><td>è¯´æ˜</td></tr><tr><td>YU.ASPNETCore</td><td>DistributedCacheHelper</td><td>åˆ†å¸ƒå¼ç¼“å­˜å¸®åŠ©ç±»</td></tr><tr><td>YU.Commons</td><td>éªŒè¯å™¨æ–‡ä»¶å¤¹</td><td>FluentValidationçš„æ‰©å±•ç±»</td></tr><tr><td>YU.DomainCommons</td><td>IAggregateRoot</td><td>èšåˆæ ¹æ ‡è¯†æ¥å£</td></tr><tr><td>YU.EventBus</td><td>è®¢é˜…ã€æ’¤é”€ã€å‘å¸ƒäº‹ä»¶</td><td>é›†æˆäº‹ä»¶æ€»çº¿</td></tr><tr><td>YU.Infrastructure</td><td>BaseDbContext</td><td>é¢†åŸŸäº‹ä»¶çš„å‘å¸ƒ</td></tr><tr><td>YU.JWT</td><td>Token</td><td>ä½¿ç”¨JWTå®ç°ç™»å½•ä»¤ç‰Œ</td></tr></table><h2 id="æ‰€ç”¨åˆ°çš„NuGetåŒ…"><a href="#æ‰€ç”¨åˆ°çš„NuGetåŒ…" class="headerlink" title="æ‰€ç”¨åˆ°çš„NuGetåŒ…"></a>æ‰€ç”¨åˆ°çš„NuGetåŒ…</h2><p><img src="/img%5C%E7%BD%91%E5%9D%80%5C19.png"></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;ItemGroup&gt;</span><br><span class="line"> &lt;FrameworkReference Include=<span class="string">&quot;Microsoft.AspNetCore.App&quot;</span> /&gt;</span><br><span class="line"> &lt;PackageReference Include=<span class="string">&quot;FluentValidation&quot;</span> Version=<span class="string">&quot;12.0.0&quot;</span> /&gt;</span><br><span class="line"> &lt;PackageReference Include=<span class="string">&quot;FluentValidation.DependencyInjectionExtensions&quot;</span> Version=<span class="string">&quot;12.0.0&quot;</span> /&gt;</span><br><span class="line"> &lt;PackageReference Include=<span class="string">&quot;MediatR&quot;</span> Version=<span class="string">&quot;8.1.0&quot;</span> /&gt;</span><br><span class="line">  &lt;PackageReference Include=<span class="string">&quot;Microsoft.AspNetCore.Http.Abstractions&quot;</span> Version=<span class="string">&quot;2.3.0&quot;</span> /&gt;</span><br><span class="line">  &lt;PackageReference Include=<span class="string">&quot;Microsoft.EntityFrameworkCore&quot;</span> Version=<span class="string">&quot;8.0.18&quot;</span> /&gt;</span><br><span class="line">  &lt;PackageReference Include=<span class="string">&quot;Microsoft.EntityFrameworkCore.SqlServer&quot;</span> Version=<span class="string">&quot;8.0.18&quot;</span> /&gt;</span><br><span class="line">  &lt;PackageReference Include=<span class="string">&quot;Microsoft.Extensions.DependencyInjection&quot;</span> Version=<span class="string">&quot;9.0.7&quot;</span> /&gt;</span><br><span class="line">  &lt;PackageReference Include=<span class="string">&quot;Serilog.AspNetCore&quot;</span> Version=<span class="string">&quot;8.0.3&quot;</span> /&gt;</span><br><span class="line">  &lt;PackageReference Include=<span class="string">&quot;StackExchange.Redis&quot;</span> Version=<span class="string">&quot;2.8.58&quot;</span> /&gt;</span><br><span class="line">  &lt;PackageReference Include=<span class="string">&quot;Swashbuckle.AspNetCore.SwaggerGen&quot;</span> Version=<span class="string">&quot;8.1.4&quot;</span> /&gt;</span><br><span class="line">  &lt;PackageReference Include=<span class="string">&quot;Zack.AnyDBConfigProvider&quot;</span> Version=<span class="string">&quot;1.1.4&quot;</span> /&gt;</span><br><span class="line">&lt;/ItemGroup&gt;</span><br></pre></td></tr></table></figure><h2 id="ApplicationBuilderExtensions"><a href="#ApplicationBuilderExtensions" class="headerlink" title="ApplicationBuilderExtensions"></a>ApplicationBuilderExtensions</h2><p>é¦–ç°æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªCommonlnitializerç±»åº“é¡¹ç›®ï¼Œåœ¨csprojä¸­æ·»åŠ &lt;FrameworkReference Include&#x3D;â€Microsoft.AspNetCore.Appâ€&#x2F;&gt;è¿™ä¸ªç±»åº“æŠŠæˆ‘ä»¬æ‰€æœ‰éœ€è¦ç”¨åˆ°çš„é…ç½®é¢†åŸŸäº‹ä»¶ã€é›†æˆäº‹ä»¶ã€ä¸­å¿ƒé…ç½®æœåŠ¡å™¨ã€JWTã€å·¥ä½œå•å…ƒã€CORSã€FluentValidationç­‰ï¼Œç”¨æ¥å¤ç”¨ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Commonlnitializer</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æä¾›å¯¹IApplicationBuilderçš„æ‰©å±•æ–¹æ³•ï¼Œç”¨äºé…ç½®åº”ç”¨çš„é»˜è®¤ä¸­é—´ä»¶ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">ApplicationBuilderExtensions</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> é…ç½®åº”ç”¨çš„é»˜è®¤ä¸­é—´ä»¶ï¼ŒåŒ…æ‹¬äº‹ä»¶æ€»çº¿ã€CORSã€è½¬å‘å¤´ã€è®¤è¯å’Œæˆæƒã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;app&quot;&gt;</span>IApplicationBuilder å®ä¾‹ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>é…ç½®åçš„ IApplicationBuilder å®ä¾‹ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IApplicationBuilder <span class="title">UseZackDefault</span>(<span class="params"><span class="keyword">this</span> IApplicationBuilder app</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            app.UseEventBus(); <span class="comment">// å¯ç”¨äº‹ä»¶æ€»çº¿</span></span><br><span class="line">            app.UseCors(); <span class="comment">// å¯ç”¨è·¨åŸŸèµ„æºå…±äº«ï¼ˆCORSï¼‰</span></span><br><span class="line">            app.UseForwardedHeaders(); <span class="comment">// å¤„ç†ä»£ç†æœåŠ¡å™¨è½¬å‘çš„å¤´ä¿¡æ¯</span></span><br><span class="line">            <span class="comment">//app.UseHttpsRedirection();//ä¸èƒ½ä¸ForwardedHeaderså¾ˆå¥½çš„å·¥ä½œï¼Œè€Œä¸”webapié¡¹ç›®ä¹Ÿæ²¡å¿…è¦é…ç½®è¿™ä¸ª</span></span><br><span class="line">            app.UseAuthentication(); <span class="comment">// å¯ç”¨è®¤è¯</span></span><br><span class="line">            app.UseAuthorization(); <span class="comment">// å¯ç”¨æˆæƒ</span></span><br><span class="line">            <span class="keyword">return</span> app;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>UseEventBusåœ¨åº”ç”¨ç¨‹åºä¸­å¯ç”¨äº‹ä»¶æ€»çº¿ï¼Œæ˜¯æˆ‘ä»¬ç»™IApplicationBuilderç±»æ‰©å±•çš„æ–¹æ³•ï¼Œæ˜¯æ£€æŸ¥æ˜¯å¦äº‹ä»¶æ€»çº¿æœåŠ¡æ˜¯å¦æ³¨å†Œå¦‚æœæœªæ³¨å†Œï¼Œå°†æŠ›å‡ºå¼‚å¸¸æé†’å¼€å‘è€…ã€‚<br>app.UseForwardedHeaders(); è·å–Nignxçš„åŸå§‹å®¢æˆ·ç«¯çš„ IP åœ°å€ï¼ŒåŸå§‹è¯·æ±‚çš„åè®®ï¼ˆHTTP æˆ– HTTPSï¼‰ï¼ŒåŸå§‹ä¸»æœºåœ°å€</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">YU.EventBus</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æä¾›æ‰©å±•æ–¹æ³•ï¼Œç”¨äºåœ¨åº”ç”¨ç¨‹åºä¸­å¯ç”¨äº‹ä»¶æ€»çº¿åŠŸèƒ½ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">ApplicationBuilderExtensions</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å¯ç”¨äº‹ä»¶æ€»çº¿åŠŸèƒ½ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> è¯¥æ–¹æ³•ä¼šæ£€æŸ¥äº‹ä»¶æ€»çº¿æœåŠ¡ï¼ˆIEventBusï¼‰æ˜¯å¦å·²æ³¨å†Œã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å¦‚æœæœªæ³¨å†Œï¼Œå°†æŠ›å‡ºå¼‚å¸¸æé†’å¼€å‘è€…ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;appBuilder&quot;&gt;</span>åº”ç”¨ç¨‹åºæ„å»ºå™¨å¯¹è±¡ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>è¿”å›åŸå§‹çš„åº”ç”¨ç¨‹åºæ„å»ºå™¨å¯¹è±¡ï¼Œä¾¿äºé“¾å¼è°ƒç”¨ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;exception cref=&quot;ApplicationException&quot;&gt;</span>å¦‚æœæœªæ‰¾åˆ°IEventBusçš„å®ç°ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚<span class="doctag">&lt;/exception&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IApplicationBuilder <span class="title">UseEventBus</span>(<span class="params"><span class="keyword">this</span> IApplicationBuilder appBuilder</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// å°è¯•ä»ä¾èµ–æ³¨å…¥å®¹å™¨ä¸­è·å–IEventBusæœåŠ¡</span></span><br><span class="line">            <span class="built_in">object</span>? eventBus = appBuilder.ApplicationServices.GetService(<span class="keyword">typeof</span>(IEventBus));</span><br><span class="line">            <span class="keyword">if</span> (eventBus == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// å¦‚æœæ²¡æœ‰æ‰¾åˆ°IEventBusçš„å®ç°ï¼ŒæŠ›å‡ºå¼‚å¸¸ï¼Œæç¤ºå¼€å‘è€…éœ€è¦æ³¨å†ŒæœåŠ¡</span></span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ApplicationException(<span class="string">&quot;æ‰¾ä¸åˆ°IEventBusçš„å®ç°ï¼Œè¯·ç¡®ä¿å·²æ­£ç¡®æ³¨å†ŒEventBusæœåŠ¡ã€‚&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// è¿”å›appBuilderï¼Œæ”¯æŒé“¾å¼è°ƒç”¨</span></span><br><span class="line">            <span class="keyword">return</span> appBuilder;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ­¤æ‰©å±•æ–¹æ³•å…è®¸åº”ç”¨ç¨‹åºæ„å»ºå™¨ä½¿ç”¨äº‹ä»¶æ€»çº¿åŠŸèƒ½ã€‚</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­çš„object? eventBus &#x3D; appBuilder.ApplicationServices.GetService(typeof(IEventBus));åœ¨ ASP.NET Core ä¸­ä»ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰å®¹å™¨è·å–ä¸€ä¸ªç±»å‹ä¸º IEventBus çš„äº‹ä»¶æ¥å£ï¼Œå¹¶èµ‹å€¼ç»™ä¸€ä¸ª object? ç±»å‹çš„å˜é‡ eventBusã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">YU.EventBus</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> äº‹ä»¶æ€»çº¿æ¥å£ï¼Œå®šä¹‰äº†äº‹ä»¶çš„å‘å¸ƒä¸è®¢é˜…ç›¸å…³æ“ä½œã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IEventBus</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å‘å¸ƒäº‹ä»¶ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;eventName&quot;&gt;</span>äº‹ä»¶åç§°ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;eventData&quot;&gt;</span>äº‹ä»¶æ•°æ®ï¼Œå¯ä»¥ä¸º nullã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">publish</span>(<span class="params"><span class="built_in">string</span> eventName, <span class="built_in">object</span>? eventData</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> è®¢é˜…æŒ‡å®šäº‹ä»¶ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;eventName&quot;&gt;</span>äº‹ä»¶åç§°ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;handlerType&quot;&gt;</span>å¤„ç†è¯¥äº‹ä»¶çš„å¤„ç†å™¨ç±»å‹ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Subscribe</span>(<span class="params"><span class="built_in">string</span> eventName, Type handlerType</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å–æ¶ˆè®¢é˜…æŒ‡å®šäº‹ä»¶ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;eventName&quot;&gt;</span>äº‹ä»¶åç§°ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;handlerType&quot;&gt;</span>è¦ç§»é™¤çš„å¤„ç†å™¨ç±»å‹ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Unsubscribe</span>(<span class="params"><span class="built_in">string</span> eventName, Type handlerType</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>app.UseCors();<br>app.UseForwardedHeaders();<br>app.UseAuthentication();<br>app.UseAuthorization();<br>æ˜¯Microsoft.AspNetCore.BuilderNuGetåŒ…ï¼Œå®‰è£…åå¯ç›´æ¥é…ç½®æ‰©å±•æ–¹æ³•ï¼Œåé¢çš„é¡¹ç›®å¯ä»¥ç›´æ¥å¼•ç”¨ã€‚</p><h2 id="CorsSettings"><a href="#CorsSettings" class="headerlink" title="CorsSettings"></a>CorsSettings</h2><p>CorsSettingsç±»ç”¨äºé…ç½® è·¨åŸŸèµ„æºå…±äº«ï¼ˆCORSï¼‰</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Commonlnitializer</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> è¡¨ç¤ºè·¨åŸŸèµ„æºå…±äº«ï¼ˆCORSï¼‰ç›¸å…³çš„é…ç½®è®¾ç½®ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">CorsSettings</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å…è®¸çš„è·¨åŸŸæ¥æºåœ°å€åˆ—è¡¨ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span>[] Origins &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Origins è¡¨ç¤ºå…è®¸è·¨åŸŸè¯·æ±‚çš„æ¥æºåœ°å€åˆ—è¡¨ï¼ˆå¦‚ <a href="http://localhost:3000/">http://localhost:3000</a> ï¼‰</p><h2 id="DbContextOptionsBuilderFactory"><a href="#DbContextOptionsBuilderFactory" class="headerlink" title="DbContextOptionsBuilderFactory"></a>DbContextOptionsBuilderFactory</h2><p>æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªDbContextOptionsBuilderFactoryçš„å®ç”¨å·¥å‚ç±»ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Commonlnitializer</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æä¾›ç”¨äºåˆ›å»º <span class="doctag">&lt;see cref=&quot;DbContextOptionsBuilder&#123;TContext&#125;&quot;/&gt;</span> çš„å·¥å‚æ–¹æ³•ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">DbContextOptionsBuilderFactory</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> åˆ›å»ºå¹¶é…ç½® <span class="doctag">&lt;see cref=&quot;DbContextOptionsBuilder&#123;TDbContext&#125;&quot;/&gt;</span> å®ä¾‹ï¼Œä½¿ç”¨ç¯å¢ƒå˜é‡ &quot;DefaultDB:ConnStr&quot; ä½œä¸ºè¿æ¥å­—ç¬¦ä¸²ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;typeparam name=&quot;TDbContext&quot;&gt;</span>è¦é…ç½®çš„ DbContext ç±»å‹ã€‚<span class="doctag">&lt;/typeparam&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>é…ç½®å¥½çš„ <span class="doctag">&lt;see cref=&quot;DbContextOptionsBuilder&#123;TDbContext&#125;&quot;/&gt;</span> å®ä¾‹ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="title">DbContextOptionsBuilder</span>&lt;<span class="title">TDbContext</span>&gt; <span class="title">Create</span>&lt;<span class="title">TDbContext</span>&gt;()</span></span><br><span class="line"><span class="function">            <span class="keyword">where</span> TDbContext : DbContext</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// ä»ç¯å¢ƒå˜é‡è·å–æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²</span></span><br><span class="line">            <span class="keyword">var</span> connStr = Environment.GetEnvironmentVariable(<span class="string">&quot;DefaultDB:ConnStr&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrWhiteSpace(connStr))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> InvalidOperationException(<span class="string">&quot;Environment variable &#x27;DefaultDB:ConnStr&#x27; is not set.&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// æ£€æŸ¥è¿æ¥å­—ç¬¦ä¸²æ˜¯å¦æœ‰æ•ˆ</span></span><br><span class="line">            <span class="comment">// åˆ›å»º DbContextOptionsBuilder å®ä¾‹</span></span><br><span class="line">            <span class="keyword">var</span> optionsBuilder = <span class="keyword">new</span> DbContextOptionsBuilder&lt;TDbContext&gt;();</span><br><span class="line">            <span class="comment">// é…ç½®ä½¿ç”¨ SQL Server æ•°æ®åº“</span></span><br><span class="line">            optionsBuilder.UseSqlServer(connStr);</span><br><span class="line">            <span class="keyword">return</span> optionsBuilder;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>DbContextOptionsBuilder&lt;TDbContext&gt; å®ä¾‹ï¼Œç”¨äºç»Ÿä¸€åˆ›å»ºå¹¶é…ç½®ã€‚<br>var connStr &#x3D; Environment.GetEnvironmentVariable(â€œDefaultDB:ConnStrâ€);ä»ç¯å¢ƒå˜é‡ä¸­è¯»å–æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²ï¼Œä¸åœ¨appsettings.jsonï¼Œæ˜¯é˜²æ­¢ä¿¡æ¯çš„æ³„éœ²ã€‚<br>new DbContextOptionsBuilder&lt;TDbContext&gt;();åˆ›å»ºå¹¶é…ç½®ä¸€ä¸ªDbContextOptionsBuilder å®ä¾‹ã€‚<br>UseSqlServer();æŒ‡å®šä½¿ç”¨SQL Serveræ•°æ®åº“ã€‚</p><h2 id="InitializerOptions"><a href="#InitializerOptions" class="headerlink" title="InitializerOptions"></a>InitializerOptions</h2><p>InitializerOptionsç±»ï¼Œç”¨äºé›†ä¸­é…ç½®ä¸€äº›åˆå§‹åŒ–ç›¸å…³çš„å‚æ•°ï¼Œä¾‹å¦‚æ—¥å¿—è·¯å¾„å’Œ EventBus é˜Ÿåˆ—åç§°ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Commonlnitializer</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> åˆå§‹åŒ–é€‰é¡¹é…ç½®ç±»ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">InitializerOptions</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ—¥å¿—æ–‡ä»¶è·¯å¾„ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> LogFilePath &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ç”¨äº EventBus çš„é˜Ÿåˆ—åç§°ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> éœ€ä¿è¯åŒä¸€é¡¹ç›®å€¼ä¿æŒä¸€è‡´ï¼Œä¸åŒé¡¹ç›®ä¸èƒ½å†²çªã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> EventBusQueueName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="WebApplicationBuilderExtensions"><a href="#WebApplicationBuilderExtensions" class="headerlink" title="WebApplicationBuilderExtensions"></a>WebApplicationBuilderExtensions</h2><p>ç»™WebApplicationBuilderæä¾›æ‰©å±•æ–¹æ³•ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Commonlnitializer</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æä¾› WebApplicationBuilder çš„æ‰©å±•æ–¹æ³•ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">WebApplicationBuilderExtensions</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> é…ç½®æ•°æ®åº“é…ç½®æºï¼Œå°†æ•°æ®åº“ä¸­çš„é…ç½®ä¿¡æ¯æ·»åŠ åˆ°åº”ç”¨é…ç½®ä¸­ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;builder&quot;&gt;</span>WebApplicationBuilder å®ä¾‹ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ConfigureDbConfiguration</span>(<span class="params"><span class="keyword">this</span> WebApplicationBuilder builder</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// é…ç½®ä¸»æœºæ„å»ºå™¨çš„åº”ç”¨é…ç½®</span></span><br><span class="line">            builder.Host.ConfigureAppConfiguration((hostCtx, configBuilder) =&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// ä»åº”ç”¨é…ç½®ä¸­è·å–æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²ï¼Œé”®ä¸º &quot;DefaultDB:ConnStr&quot;</span></span><br><span class="line">                <span class="built_in">string</span> connStr = builder.Configuration.GetValue&lt;<span class="built_in">string</span>&gt;(<span class="string">&quot;DefaultDB:ConnStr&quot;</span>);</span><br><span class="line">                <span class="comment">// æ·»åŠ è‡ªå®šä¹‰çš„æ•°æ®åº“é…ç½®æºï¼Œæ”¯æŒè‡ªåŠ¨åˆ·æ–°ï¼Œåˆ·æ–°é—´éš”ä¸º5ç§’</span></span><br><span class="line">                configBuilder.AddDbConfiguration(() =&gt; <span class="keyword">new</span> SqlConnection(connStr), reloadOnChange: <span class="literal">true</span>, reloadInterval: TimeSpan.FromSeconds(<span class="number">5</span>));</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> é…ç½®åº”ç”¨æ‰€éœ€çš„é¢å¤–æœåŠ¡ï¼ŒåŒ…æ‹¬æ•°æ®åº“ã€è®¤è¯ã€æˆæƒã€æ—¥å¿—ã€CORSã€Redisã€äº‹ä»¶æ€»çº¿ç­‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;builder&quot;&gt;</span>WebApplicationBuilder å®ä¾‹ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;initOptions&quot;&gt;</span>åˆå§‹åŒ–é€‰é¡¹ï¼ŒåŒ…å«æ—¥å¿—è·¯å¾„å’Œäº‹ä»¶æ€»çº¿é˜Ÿåˆ—åç­‰ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ConfigureExtraServices</span>(<span class="params"><span class="keyword">this</span> WebApplicationBuilder builder, InitializerOptions initOptions</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// è·å–æœåŠ¡é›†åˆ</span></span><br><span class="line">            IServiceCollection services = builder.Services;</span><br><span class="line">            <span class="comment">// è·å–åº”ç”¨é…ç½®</span></span><br><span class="line">            IConfiguration configuration = builder.Configuration;</span><br><span class="line">            <span class="comment">// è·å–æ‰€æœ‰å¼•ç”¨çš„ç¨‹åºé›†ï¼Œç”¨äºåç»­æ¨¡å—åˆå§‹åŒ–å’Œä¾èµ–æ³¨å…¥</span></span><br><span class="line">            <span class="keyword">var</span> assemblies = ReflectionHelper.GetAllReferencedAssemblies();</span><br><span class="line">            <span class="comment">// æ‰§è¡Œæ‰€æœ‰æ¨¡å—çš„åˆå§‹åŒ–æ–¹æ³•</span></span><br><span class="line">            services.RunModuleInitializers(assemblies);</span><br><span class="line">            <span class="comment">// æ³¨å†Œæ‰€æœ‰æ•°æ®åº“ä¸Šä¸‹æ–‡ï¼Œä½¿ç”¨ SQL Serverï¼Œè¿æ¥å­—ç¬¦ä¸²ä»é…ç½®ä¸­è·å–</span></span><br><span class="line">            services.AddAllDbContexts(ctx =&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">string</span> connStr = configuration.GetValue&lt;<span class="built_in">string</span>&gt;(<span class="string">&quot;DefaultDB:ConnStr&quot;</span>);</span><br><span class="line">                ctx.UseSqlServer(connStr);</span><br><span class="line">            &#125;, assemblies);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ·»åŠ è®¤è¯æœåŠ¡</span></span><br><span class="line">            builder.Services.AddAuthentication();</span><br><span class="line">            <span class="comment">// æ·»åŠ æˆæƒæœåŠ¡</span></span><br><span class="line">            builder.Services.AddAuthorization();</span><br><span class="line">            <span class="comment">// ä»é…ç½®ä¸­è·å– JWT ç›¸å…³é…ç½®</span></span><br><span class="line">            JWTOptions jwtOpt = configuration.GetSection(<span class="string">&quot;JWT&quot;</span>).Get&lt;JWTOptions&gt;();</span><br><span class="line">            <span class="comment">// æ·»åŠ  JWT è®¤è¯æœåŠ¡</span></span><br><span class="line">            builder.Services.AddJWTAuthentication(jwtOpt);</span><br><span class="line">            <span class="comment">// é…ç½® Swaggerï¼Œæ·»åŠ è®¤è¯å¤´éƒ¨</span></span><br><span class="line">            builder.Services.Configure&lt;SwaggerGenOptions&gt;(c =&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                c.AddAuthenticationHeader();</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ³¨å†Œ MediatRï¼Œç”¨äºé¢†åŸŸäº‹ä»¶å’Œå‘½ä»¤å¤„ç†</span></span><br><span class="line">            services.AddMediatR(assemblies);</span><br><span class="line">            <span class="comment">// é…ç½® MVC é€‰é¡¹ï¼Œæ·»åŠ å·¥ä½œå•å…ƒè¿‡æ»¤å™¨</span></span><br><span class="line">            services.Configure&lt;MvcOptions&gt;(options =&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                options.Filters.Add&lt;UnitOfWorkFilter&gt;();</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="comment">// é…ç½® JSON é€‰é¡¹ï¼Œæ·»åŠ è‡ªå®šä¹‰çš„ DateTime åºåˆ—åŒ–è½¬æ¢å™¨</span></span><br><span class="line">            services.Configure&lt;JsonOptions&gt;(options =&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                options.JsonSerializerOptions.Converters.Add(<span class="keyword">new</span> DateTimeJsonConverter(<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>));</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// é…ç½®è·¨åŸŸèµ„æºå…±äº«ï¼ˆCORSï¼‰ç­–ç•¥</span></span><br><span class="line">            services.AddCors(options =&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// ä»é…ç½®ä¸­è·å– CORS è®¾ç½®</span></span><br><span class="line">                <span class="keyword">var</span> corsOpt = configuration.GetSection(<span class="string">&quot;Cors&quot;</span>).Get&lt;CorsSettings&gt;();</span><br><span class="line">                <span class="comment">// è·å–å…è®¸çš„æ¥æºåˆ—è¡¨</span></span><br><span class="line">                <span class="built_in">string</span>[] urls = corsOpt.Origins;</span><br><span class="line">                <span class="comment">// æ·»åŠ é»˜è®¤ç­–ç•¥ï¼Œå…è®¸æŒ‡å®šæ¥æºã€ä»»æ„å¤´ã€ä»»æ„æ–¹æ³•ï¼Œå¹¶å…è®¸æºå¸¦å‡­æ®</span></span><br><span class="line">                options.AddDefaultPolicy(builder =&gt; builder.WithOrigins(urls)</span><br><span class="line">                    .AllowAnyHeader()</span><br><span class="line">                    .AllowAnyMethod()</span><br><span class="line">                    .AllowCredentials());</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="comment">// é…ç½®æ—¥å¿—æœåŠ¡ï¼Œä½¿ç”¨ Serilogï¼Œæ—¥å¿—è¾“å‡ºåˆ°æ§åˆ¶å°å’Œæ–‡ä»¶</span></span><br><span class="line">            services.AddLogging(builder =&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// é…ç½® Serilog æ—¥å¿—è®°å½•å™¨</span></span><br><span class="line">                Log.Logger = <span class="keyword">new</span> LoggerConfiguration()</span><br><span class="line">                .WriteTo.Console()</span><br><span class="line">                .WriteTo.File(initOptions.LogFilePath)</span><br><span class="line">                .CreateLogger();</span><br><span class="line">                <span class="comment">// å°† Serilog é›†æˆåˆ°æ—¥å¿—ç³»ç»Ÿ</span></span><br><span class="line">                builder.AddSerilog();</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="comment">// è·å–åº”ç”¨ç¨‹åºä¸»ç¨‹åºé›†ï¼Œç”¨äºæ³¨å†Œ FluentValidation éªŒè¯å™¨</span></span><br><span class="line">            <span class="keyword">var</span> applicationAssembly = <span class="keyword">typeof</span>(UserModelValidator).Assembly;</span><br><span class="line">            <span class="comment">// æ³¨å†Œæ‰€æœ‰éªŒè¯å™¨</span></span><br><span class="line">            services.AddValidatorsFromAssembly(applicationAssembly);</span><br><span class="line">            <span class="comment">// é…ç½® JWT é€‰é¡¹ç»‘å®š</span></span><br><span class="line">            services.Configure&lt;JWTOptions&gt;(configuration.GetSection(<span class="string">&quot;JWT&quot;</span>));</span><br><span class="line">            <span class="comment">// é…ç½® RabbitMQ äº‹ä»¶æ€»çº¿é€‰é¡¹ç»‘å®š</span></span><br><span class="line">            services.Configure&lt;IntegrationEventRabbitMQOptions&gt;(configuration.GetSection(<span class="string">&quot;RabbitMQ&quot;</span>));</span><br><span class="line">            <span class="comment">// æ³¨å†Œäº‹ä»¶æ€»çº¿æœåŠ¡</span></span><br><span class="line">            services.AddEventBus(initOptions.EventBusQueueName, assemblies);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// ä»é…ç½®ä¸­è·å– Redis è¿æ¥å­—ç¬¦ä¸²</span></span><br><span class="line">            <span class="built_in">string</span> redisConnStr = configuration.GetValue&lt;<span class="built_in">string</span>&gt;(<span class="string">&quot;Redis:ConnStr&quot;</span>);</span><br><span class="line">            <span class="comment">// åˆ›å»º Redis è¿æ¥å¤šè·¯å¤ç”¨å™¨</span></span><br><span class="line">            IConnectionMultiplexer redisConnMultiplexer = ConnectionMultiplexer.Connect(redisConnStr);</span><br><span class="line">            <span class="comment">// æ³¨å†Œ Redis è¿æ¥ä¸ºå•ä¾‹æœåŠ¡</span></span><br><span class="line">            services.AddSingleton(<span class="keyword">typeof</span>(IConnectionMultiplexer), redisConnMultiplexer);</span><br><span class="line">            <span class="comment">// é…ç½®è½¬å‘å¤´éƒ¨é€‰é¡¹ï¼Œæ”¯æŒæ‰€æœ‰è½¬å‘å¤´</span></span><br><span class="line">            services.Configure&lt;ForwardedHeadersOptions&gt;(Options =&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                Options.ForwardedHeaders = ForwardedHeaders.All;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ConfigureDbConfiguration"><a href="#ConfigureDbConfiguration" class="headerlink" title="ConfigureDbConfiguration"></a>ConfigureDbConfiguration</h3><p>æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå¯¹WebApplicationBuilderçš„æ‰©å±•æ–¹æ³•,è¯»å–æ•°æ®åº“é…ç½®æºã€‚<br>å°†æ•°æ®åº“ä½œä¸ºé…ç½®æºï¼Œå¹¶å°†å…¶é…ç½®åŠ è½½åˆ° WebApplicationBuilder.Configuration ä¸­ï¼Œæ”¯æŒè‡ªåŠ¨åˆ·æ–°ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> é…ç½®æ•°æ®åº“é…ç½®æºï¼Œå°†æ•°æ®åº“ä¸­çš„é…ç½®ä¿¡æ¯æ·»åŠ åˆ°åº”ç”¨é…ç½®ä¸­ã€‚</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;builder&quot;&gt;</span>WebApplicationBuilder å®ä¾‹ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ConfigureDbConfiguration</span>(<span class="params"><span class="keyword">this</span> WebApplicationBuilder builder</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// é…ç½®ä¸»æœºæ„å»ºå™¨çš„åº”ç”¨é…ç½®</span></span><br><span class="line">    builder.Host.ConfigureAppConfiguration((hostCtx, configBuilder) =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ä»åº”ç”¨é…ç½®ä¸­è·å–æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²ï¼Œé”®ä¸º &quot;DefaultDB:ConnStr&quot;</span></span><br><span class="line">        <span class="built_in">string</span> connStr = builder.Configuration.GetValue&lt;<span class="built_in">string</span>&gt;(<span class="string">&quot;DefaultDB:ConnStr&quot;</span>);</span><br><span class="line">        <span class="comment">// æ·»åŠ è‡ªå®šä¹‰çš„æ•°æ®åº“é…ç½®æºï¼Œæ”¯æŒè‡ªåŠ¨åˆ·æ–°ï¼Œåˆ·æ–°é—´éš”ä¸º5ç§’</span></span><br><span class="line">        configBuilder.AddDbConfiguration(() =&gt; <span class="keyword">new</span> SqlConnection(connStr), reloadOnChange: <span class="literal">true</span>, reloadInterval: TimeSpan.FromSeconds(<span class="number">5</span>));</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­builder.Host.ConfigureAppConfiguration((hostCtx, configBuilder) &#x3D;&gt;æ˜¯ä¿®æ”¹åº”ç”¨çš„ä¸»æœºï¼ˆIHostBuilderï¼‰çš„é…ç½®æ„å»ºé€»è¾‘ã€‚<br>è¿™æ˜¯å¯¹åº”ç”¨é…ç½®ç³»ç»Ÿè¿›è¡Œæ‰©å±•ï¼ˆè€Œä¸æ˜¯ä»…ä»…ä¿®æ”¹è¿è¡Œæ—¶æœåŠ¡ï¼‰ã€‚<br><b>hostCtx æ˜¯å½“å‰ä¸»æœºçš„ä¸Šä¸‹æ–‡ï¼›configBuilder æ˜¯æ­£åœ¨æ„å»ºçš„é…ç½®ã€‚</b></p><p>è€ŒconfigBuilder.AddDbConfigurationä¸­çš„<b>AddDbConfiguration</b>æ˜¯ä½œç”¨æ˜¯ä»æ•°æ®åº“ä¸­è¯»å–é…ç½®é¡¹ï¼Œä½œä¸ºåº”ç”¨é…ç½®æºä¹‹ä¸€æ·»åŠ åˆ° Configuration ä¸­ã€‚<br><b>() &#x3D;&gt; new SqlConnection(connStr)</b>æ˜¯ä¸€ä¸ªå»¶è¿Ÿæ‰§è¡Œçš„å§”æ‰˜ï¼Œå½“é…ç½®ç³»ç»Ÿéœ€è¦åˆ·æ–°æˆ–åˆå§‹åŒ–æ—¶æ‰ä¼šåˆ›å»ºè¿æ¥å¯¹è±¡ï¼Œ<b>é¿å…å¯åŠ¨æ—¶ç«‹å³è¿æ¥æ•°æ®åº“</b>ã€‚<br><b>reloadOnChange: true</b>å¯ç”¨è‡ªåŠ¨åˆ·æ–°é…ç½®åŠŸèƒ½ï¼Œæ„æ€æ˜¯å½“<b>æ•°æ®åº“ä¸­çš„é…ç½®å€¼å‘ç”Ÿå˜æ›´æ—¶ï¼Œå¯ä»¥è‡ªåŠ¨é‡æ–°åŠ è½½ï¼Œä¸é‡å¯æœåŠ¡</b>ã€‚<br><b>reloadInterval: TimeSpan.FromSeconds(5)</b>é…ç½®åˆ·æ–°å‘¨æœŸä¸º 5 ç§’ï¼Œå³é…ç½®ç³»ç»Ÿæ¯éš” 5 ç§’å»æ£€æŸ¥æ•°æ®åº“é…ç½®æ˜¯å¦æœ‰å˜æ›´ï¼Œå¦‚æœæœ‰åˆ™åˆ·æ–°ã€‚</p><p><b>æ•°æ®åº“å˜æˆäº†åº”ç”¨çš„ä¸€ä¸ªé…ç½®æºï¼Œä¼˜å…ˆçº§å¯èƒ½æ¯” appsettings.json é«˜ï¼ˆå–å†³äºæ·»åŠ é¡ºåºï¼‰ã€‚</b></p><h3 id="ConfigureExtraServices"><a href="#ConfigureExtraServices" class="headerlink" title="ConfigureExtraServices"></a>ConfigureExtraServices</h3><p>ConfigureExtraServicesé…ç½®äº†é…ç½®åº”ç”¨æ‰€éœ€çš„é¢å¤–æœåŠ¡ï¼ŒåŒ…æ‹¬æ•°æ®åº“ã€è®¤è¯ã€æˆæƒã€æ—¥å¿—ã€CORSã€Redisã€äº‹ä»¶æ€»çº¿ç­‰ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ConfigureExtraServices</span>(<span class="params"><span class="keyword">this</span> WebApplicationBuilder builder, InitializerOptions initOptions</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// è·å–æœåŠ¡é›†åˆ</span></span><br><span class="line">    IServiceCollection services = builder.Services;</span><br><span class="line">    <span class="comment">// è·å–åº”ç”¨é…ç½®</span></span><br><span class="line">    IConfiguration configuration = builder.Configuration;</span><br><span class="line">    <span class="comment">// è·å–æ‰€æœ‰å¼•ç”¨çš„ç¨‹åºé›†ï¼Œç”¨äºåç»­æ¨¡å—åˆå§‹åŒ–å’Œä¾èµ–æ³¨å…¥</span></span><br><span class="line">    <span class="keyword">var</span> assemblies = ReflectionHelper.GetAllReferencedAssemblies();</span><br><span class="line">    <span class="comment">// æ‰§è¡Œæ‰€æœ‰æ¨¡å—çš„åˆå§‹åŒ–æ–¹æ³•</span></span><br><span class="line">    services.RunModuleInitializers(assemblies);</span><br><span class="line">    <span class="comment">// æ³¨å†Œæ‰€æœ‰æ•°æ®åº“ä¸Šä¸‹æ–‡ï¼Œä½¿ç”¨ SQL Serverï¼Œè¿æ¥å­—ç¬¦ä¸²ä»é…ç½®ä¸­è·å–</span></span><br><span class="line">    services.AddAllDbContexts(ctx =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> connStr = configuration.GetValue&lt;<span class="built_in">string</span>&gt;(<span class="string">&quot;DefaultDB:ConnStr&quot;</span>);</span><br><span class="line">        ctx.UseSqlServer(connStr);</span><br><span class="line">    &#125;, assemblies);</span><br></pre></td></tr></table></figure><p>IServiceCollection services &#x3D; builder.Servicesä» WebApplicationBuilder ä¸­è·å–æœåŠ¡æ³¨å†Œå®¹å™¨ï¼ˆIServiceCollectionï¼‰ï¼Œç”¨äºæ³¨å†Œä¾èµ–åç»­æ‰€æœ‰çš„ä¾èµ–æ³¨å…¥ï¼ˆAddScopedã€AddDbContext ç­‰ï¼‰éƒ½ä¼šå¾€è¿™ä¸ªé›†åˆä¸­æ³¨å†Œã€‚</p><p>IConfiguration configuration &#x3D; builder.Configurationè·å–åº”ç”¨ç¨‹åºçš„é…ç½®ç³»ç»Ÿæ¥å£ï¼ˆä¾‹å¦‚ appsettings.jsonã€ç¯å¢ƒå˜é‡ã€å‘½ä»¤è¡Œç­‰ï¼‰åç»­å¯é€šè¿‡ configuration.GetValue&lt;string&gt;(â€œxxxâ€) æ–¹å¼è¯»å–é…ç½®å€¼</p><p>var assemblies &#x3D; ReflectionHelper.GetAllReferencedAssemblies()ä¸­çš„ReflectionHelper.GetAllReferencedAssemblies()æ˜¯ç”¨äºé€šè¿‡åå°„è·å–å½“å‰é¡¹ç›®å¼•ç”¨çš„æ‰€æœ‰ç¨‹åºé›†ï¼ˆAssemblyï¼‰</p><p>services.RunModuleInitializers(assemblies)è¿™æ˜¯ä¸€ä¸ªæ¨¡å—åŒ–ç³»ç»Ÿçš„å…¥å£ï¼Œä¼šä»ä¼ å…¥çš„ assemblies ä¸­å¯»æ‰¾å®ç°äº†æŸä¸ªçº¦å®šæ¥å£ï¼ˆä¾‹å¦‚ IModuleInitializerï¼‰çš„ç±»ï¼Œå¹¶è°ƒç”¨å…¶åˆå§‹åŒ–æ–¹æ³•ã€‚</p><p>services.AddAllDbContexts(ctx &#x3D;&gt;ä»é…ç½®ä¸­è¯»å–æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²ï¼Œåœ¨å¤šä¸ªç¨‹åºé›†å†…æŸ¥æ‰¾æ‰€æœ‰ç»§æ‰¿è‡ª DbContext çš„ç±»ï¼Œè‡ªåŠ¨ä¸ºè¿™äº› DbContext æ³¨å†Œåˆ° DI å®¹å™¨ä¸­ï¼Œç»Ÿä¸€ä½¿ç”¨ UseSqlServer(â€¦) è¿›è¡Œæ•°æ®åº“é…ç½®ã€‚</p><p>è€ŒReflectionHelper.GetAllReferencedAssemblies()ã€RunModuleInitializers()ã€AddAllDbContexts,éƒ½æ˜¯è‡ªå®šä¹‰çš„æ‰©å±•æ–¹æ³•ã€‚</p><h4 id="JWT"><a href="#JWT" class="headerlink" title="JWT"></a>JWT</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ·»åŠ è®¤è¯æœåŠ¡</span></span><br><span class="line">builder.Services.AddAuthentication();</span><br><span class="line"><span class="comment">// æ·»åŠ æˆæƒæœåŠ¡</span></span><br><span class="line">builder.Services.AddAuthorization();</span><br><span class="line"><span class="comment">// ä»é…ç½®ä¸­è·å– JWT ç›¸å…³é…ç½®</span></span><br><span class="line">JWTOptions jwtOpt = configuration.GetSection(<span class="string">&quot;JWT&quot;</span>).Get&lt;JWTOptions&gt;();</span><br><span class="line"><span class="comment">// æ·»åŠ  JWT è®¤è¯æœåŠ¡</span></span><br><span class="line">builder.Services.AddJWTAuthentication(jwtOpt);</span><br><span class="line"><span class="comment">// é…ç½® Swaggerï¼Œæ·»åŠ è®¤è¯å¤´éƒ¨</span></span><br><span class="line">builder.Services.Configure&lt;SwaggerGenOptions&gt;(c =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    c.AddAuthenticationHeader();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>å…¶ä¸­çš„JWTOptionsæ˜¯JWT é…ç½®é€‰é¡¹ç±»ï¼Œç”¨äºå­˜å‚¨ç”Ÿæˆå’ŒéªŒè¯ JWT æ‰€éœ€çš„å‚æ•°ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">YU.JWT</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> JWT é…ç½®é€‰é¡¹ç±»ï¼Œç”¨äºå­˜å‚¨ç”Ÿæˆå’ŒéªŒè¯ JWT æ‰€éœ€çš„å‚æ•°ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">JWTOptions</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ä»¤ç‰Œé¢å‘è€…ï¼ˆIssuerï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> Issuer &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ä»¤ç‰Œæ¥æ”¶è€…ï¼ˆAudienceï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> Audience &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ç”¨äºç­¾å JWT çš„å¯†é’¥ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> Key &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ä»¤ç‰Œè¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> ExpireSeconds &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è€Œé…ç½®JWTè¿˜è¦é…ç½®é…ç½®JWTä»¤ç‰ŒéªŒè¯å’Œæ·»åŠ åœ¨ Swagger æ–‡æ¡£ä¸­æ·»åŠ è®¤è¯å¤´éƒ¨ä¿¡æ¯ï¼Œåˆ†åˆ«å¯¹è¿™ä¸¤ä¸ªé…ç½®å°è£…ä¸ºAddJWTAuthenticationã€AddAuthenticationHeaderæ‰©å±•æ–¹æ³•ã€‚</p><p><b>AddJWTAuthentication</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">YU.JWT</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æä¾›JWTè®¤è¯ç›¸å…³çš„æ‰©å±•æ–¹æ³•ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">AuthenticationExtensions</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å‘æœåŠ¡é›†åˆä¸­æ·»åŠ JWTè®¤è¯ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;services&quot;&gt;</span>æœåŠ¡é›†åˆã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;jwtOpt&quot;&gt;</span>JWTé…ç½®é€‰é¡¹ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>è®¤è¯ç”Ÿæˆå™¨ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> AuthenticationBuilder <span class="title">AddJWTAuthentication</span>(<span class="params"><span class="keyword">this</span> IServiceCollection services, JWTOptions jwtOpt</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> services.AddAuthentication(JwtBearerDefaults.AuthenticationScheme)</span><br><span class="line">            .AddJwtBearer(x =&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// é…ç½®JWTä»¤ç‰ŒéªŒè¯å‚æ•°</span></span><br><span class="line">                x.TokenValidationParameters = <span class="keyword">new</span>()</span><br><span class="line">                &#123;</span><br><span class="line">                    ValidateIssuer = <span class="literal">true</span>, <span class="comment">// éªŒè¯ç­¾å‘è€…</span></span><br><span class="line">                    ValidateAudience = <span class="literal">true</span>, <span class="comment">// éªŒè¯æ¥æ”¶è€…</span></span><br><span class="line">                    ValidateLifetime = <span class="literal">true</span>, <span class="comment">// éªŒè¯æœ‰æ•ˆæœŸ</span></span><br><span class="line">                    ValidateIssuerSigningKey = <span class="literal">true</span>, <span class="comment">// éªŒè¯ç­¾åå¯†é’¥</span></span><br><span class="line">                    ValidIssuer = jwtOpt.Issuer, <span class="comment">// æœ‰æ•ˆç­¾å‘è€…</span></span><br><span class="line">                    ValidAudience = jwtOpt.Audience, <span class="comment">// æœ‰æ•ˆæ¥æ”¶è€…</span></span><br><span class="line">                    IssuerSigningKey = <span class="keyword">new</span> SymmetricSecurityKey(Encoding.UTF8.GetBytes(jwtOpt.Key)), <span class="comment">// ç­¾åå¯†é’¥</span></span><br><span class="line">                &#125;;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><b>AddAuthenticationHeader</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">YU.JWT</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> SwaggerGenOptions çš„æ‰©å±•æ–¹æ³•ï¼Œç”¨äºåœ¨ Swagger æ–‡æ¡£ä¸­æ·»åŠ è®¤è¯å¤´éƒ¨ä¿¡æ¯ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">SwaggerGenOptionsExtensions</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å‘ Swagger é…ç½®ä¸­æ·»åŠ è®¤è¯å¤´ï¼ˆAuthorization Headerï¼‰ï¼Œ</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ä½¿å¾—åœ¨ Swagger UI ä¸­å¯ä»¥è¾“å…¥ JWT Token è¿›è¡Œæ¥å£æµ‹è¯•ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;c&quot;&gt;</span>SwaggerGenOptions å®ä¾‹ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">AddAuthenticationHeader</span>(<span class="params"><span class="keyword">this</span> SwaggerGenOptions c</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// æ·»åŠ å®‰å…¨å®šä¹‰ï¼ŒæŒ‡å®šåç§°ä¸º &quot;Authorization&quot;ï¼Œç±»å‹ä¸º ApiKeyï¼Œä½ç½®åœ¨ Headerã€‚</span></span><br><span class="line">            <span class="comment">// è¿™æ ·åœ¨ Swagger UI ä¸­ä¼šå‡ºç°ä¸€ä¸ªè¾“å…¥æ¡†ç”¨äºå¡«å†™ Tokenã€‚</span></span><br><span class="line">            c.AddSecurityDefinition(<span class="string">&quot;Authorization&quot;</span>, <span class="keyword">new</span> OpenApiSecurityScheme</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// æè¿°ä¿¡æ¯ï¼ŒæŒ‡å¯¼ç”¨æˆ·å¦‚ä½•å¡«å†™ Tokenã€‚</span></span><br><span class="line">                Description = <span class="string">&quot;Authorization header .\r\n Example:&#x27;Bearer 12345abcdef&#x27;&quot;</span>,</span><br><span class="line">                <span class="comment">// æŒ‡å®šå‚æ•°åœ¨ HTTP Header ä¸­ä¼ é€’ã€‚</span></span><br><span class="line">                In = ParameterLocation.Header,</span><br><span class="line">                <span class="comment">// å®‰å…¨æ–¹æ¡ˆç±»å‹ä¸º ApiKeyã€‚</span></span><br><span class="line">                Type = SecuritySchemeType.ApiKey,</span><br><span class="line">                <span class="comment">// æ–¹æ¡ˆåç§°ï¼Œé€šå¸¸ä¸º &quot;Authorization&quot;ã€‚</span></span><br><span class="line">                Scheme = <span class="string">&quot;Authorization&quot;</span></span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ·»åŠ å®‰å…¨éœ€æ±‚ï¼ŒæŒ‡å®šæ‰€æœ‰æ¥å£éƒ½éœ€è¦æºå¸¦ &quot;Authorization&quot; å¤´éƒ¨ã€‚</span></span><br><span class="line">            c.AddSecurityRequirement(<span class="keyword">new</span> OpenApiSecurityRequirement()</span><br><span class="line">                &#123;</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">new</span> OpenApiSecurityScheme</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="comment">// å¼•ç”¨ä¸Šé¢å®šä¹‰çš„å®‰å…¨æ–¹æ¡ˆã€‚</span></span><br><span class="line">                            Reference = <span class="keyword">new</span> OpenApiReference</span><br><span class="line">                            &#123;</span><br><span class="line">                                Type = ReferenceType.SecurityScheme,</span><br><span class="line">                                Id=<span class="string">&quot;Authorization&quot;</span></span><br><span class="line">                            &#125;,</span><br><span class="line">                            <span class="comment">// æ–¹æ¡ˆç±»å‹ä¸º oauth2ï¼ˆè™½ç„¶å®é™…ç±»å‹ä¸º ApiKeyï¼Œè¿™é‡Œç”¨äºå…¼å®¹æ€§ï¼‰ã€‚</span></span><br><span class="line">                            Scheme = <span class="string">&quot;oauth2&quot;</span>,</span><br><span class="line">                            <span class="comment">// å¤´éƒ¨åç§°ã€‚</span></span><br><span class="line">                            Name=<span class="string">&quot;Authorization&quot;</span>,</span><br><span class="line">                            <span class="comment">// å‚æ•°ä½ç½®ä¸º Headerã€‚</span></span><br><span class="line">                            In=ParameterLocation.Header,</span><br><span class="line">                        &#125;,</span><br><span class="line">                        <span class="comment">// ä½œç”¨åŸŸåˆ—è¡¨ï¼Œè¿™é‡Œä¸ºç©ºè¡¨ç¤ºä¸é™å®šä½œç”¨åŸŸã€‚</span></span><br><span class="line">                        <span class="keyword">new</span> List&lt;<span class="built_in">string</span>&gt;()</span><br><span class="line">                    &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é…ç½® JWT é€‰é¡¹ç»‘å®š</span></span><br><span class="line">services.Configure&lt;JWTOptions&gt;(configuration.GetSection(<span class="string">&quot;JWT&quot;</span>));</span><br></pre></td></tr></table></figure><p>è¿™è¡Œä»£ç çš„ä½œç”¨æ˜¯å°†åº”ç”¨é…ç½®æ–‡ä»¶ä¸­çš„ JWT é…ç½®èŠ‚ç»‘å®šåˆ° JWTOptions ç±»å‹ï¼Œå¹¶æ³¨å†Œåˆ°ä¾èµ–æ³¨å…¥å®¹å™¨ï¼Œæ–¹ä¾¿åç»­é€šè¿‡ä¾èµ–æ³¨å…¥è·å–é…ç½®ä¿¡æ¯ã€‚</p><h4 id="MediatR"><a href="#MediatR" class="headerlink" title="MediatR"></a>MediatR</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ³¨å†Œ MediatRï¼Œç”¨äºé¢†åŸŸäº‹ä»¶å’Œå‘½ä»¤å¤„ç†</span></span><br><span class="line">services.AddMediatR(assemblies);</span><br></pre></td></tr></table></figure><p>è€ŒAddMediatRæ˜¯å¯¹æ³¨å†ŒMediatRæœåŠ¡çš„é…ç½®å’Œæ´¾å‘é¢†åŸŸäº‹ä»¶ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">YU.Infrastructure.EFCore</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æä¾›ä¸MediatRç›¸å…³çš„æ‰©å±•æ–¹æ³•ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">MediatorExtensions</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ‰©å±•IServiceCollectionä»¥æ‰¹é‡æ³¨å†ŒMediatRç›¸å…³æœåŠ¡ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;services&quot;&gt;</span>ä¾èµ–æ³¨å…¥æœåŠ¡é›†åˆã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;assemblies&quot;&gt;</span>åŒ…å«MediatRå¤„ç†ç¨‹åºçš„ç¨‹åºé›†é›†åˆã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>æœåŠ¡é›†åˆæœ¬èº«ï¼Œä¾¿äºé“¾å¼è°ƒç”¨ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IServiceCollection <span class="title">AddMediatR</span>(<span class="params"><span class="keyword">this</span> IServiceCollection services, IEnumerable&lt;Assembly&gt; assemblies</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// å°†æŒ‡å®šç¨‹åºé›†ä¸­çš„MediatRæœåŠ¡æ³¨å†Œåˆ°ä¾èµ–æ³¨å…¥å®¹å™¨</span></span><br><span class="line">            <span class="keyword">return</span> services.AddMediatR(assemblies.ToArray());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ´¾å‘å½“å‰DbContextä¸­æ‰€æœ‰èšåˆæ ¹çš„é¢†åŸŸäº‹ä»¶ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;mediator&quot;&gt;</span>MediatRä¸­ä»‹è€…å®ä¾‹ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;ctx&quot;&gt;</span>å½“å‰çš„EF Core DbContextå®ä¾‹ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>å¼‚æ­¥ä»»åŠ¡ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">async</span> Task <span class="title">DispatchDomainEventsAsync</span>(<span class="params"><span class="keyword">this</span> IMediator mediator, DbContext ctx</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// è·å–æ‰€æœ‰å®ç°äº†IDomainEventsæ¥å£ä¸”åŒ…å«é¢†åŸŸäº‹ä»¶çš„å®ä½“</span></span><br><span class="line">            <span class="keyword">var</span> domainEntities = ctx.ChangeTracker</span><br><span class="line">                .Entries&lt;IDomainEvents&gt;()</span><br><span class="line">                .Where(x =&gt; x.Entity.GetDomainEvents().Any());</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ”¶é›†æ‰€æœ‰é¢†åŸŸäº‹ä»¶</span></span><br><span class="line">            <span class="keyword">var</span> domainEvents = domainEntities</span><br><span class="line">                .SelectMany(x =&gt; x.Entity.GetDomainEvents())</span><br><span class="line">                .ToList();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ¸…ç©ºå®ä½“ä¸Šçš„é¢†åŸŸäº‹ä»¶ï¼Œé¿å…é‡å¤æ´¾å‘</span></span><br><span class="line">            domainEntities.ToList()</span><br><span class="line">                .ForEach(entity =&gt; entity.Entity.ClearDomainEvents());</span><br><span class="line"></span><br><span class="line">            <span class="comment">// é€ä¸ªé€šè¿‡MediatRå‘å¸ƒé¢†åŸŸäº‹ä»¶</span></span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> domainEvent <span class="keyword">in</span> domainEvents)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">await</span> mediator.Publish(domainEvent);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¦å®ç°IDomainEventsæ¥å£ä¸”åŒ…å«é¢†åŸŸäº‹ä»¶çš„å®ä½“</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">YU.DomainCommons.Models</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> å®šä¹‰é¢†åŸŸäº‹ä»¶é›†åˆçš„æ¥å£ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> è¯¥æ¥å£ç”¨äºèšåˆæ ¹æˆ–å®ä½“ä¸­ç®¡ç†é¢†åŸŸäº‹ä»¶çš„æ·»åŠ ã€å»é‡ã€è·å–å’Œæ¸…ç†æ“ä½œã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> é¢†åŸŸäº‹ä»¶ç”¨äºåœ¨é¢†åŸŸæ¨¡å‹å†…éƒ¨æˆ–å¤–éƒ¨ä¼ æ’­é‡è¦çš„ä¸šåŠ¡çŠ¶æ€å˜åŒ–ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IDomainEvents</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> è·å–å½“å‰å·²æ³¨å†Œçš„æ‰€æœ‰é¢†åŸŸäº‹ä»¶ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>é¢†åŸŸäº‹ä»¶çš„åªè¯»é›†åˆã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function">IEnumerable&lt;INotification&gt; <span class="title">GetDomainEvents</span>()</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ·»åŠ ä¸€ä¸ªæ–°çš„é¢†åŸŸäº‹ä»¶åˆ°é›†åˆä¸­ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;eventItem&quot;&gt;</span>è¦æ·»åŠ çš„é¢†åŸŸäº‹ä»¶ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">AddDomainEvent</span>(<span class="params">INotification eventItem</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å¦‚æœé›†åˆä¸­ä¸å­˜åœ¨è¯¥äº‹ä»¶ï¼Œåˆ™æ·»åŠ ä¸€ä¸ªæ–°çš„é¢†åŸŸäº‹ä»¶ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ç”¨äºé¿å…é‡å¤æ·»åŠ ç›¸åŒçš„äº‹ä»¶ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;eventItem&quot;&gt;</span>è¦æ·»åŠ çš„é¢†åŸŸäº‹ä»¶ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">AddDomainEventIfAbsent</span>(<span class="params">INotification eventItem</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ¸…ç©ºå½“å‰æ‰€æœ‰å·²æ³¨å†Œçš„é¢†åŸŸäº‹ä»¶ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">ClearDomainEvents</span>()</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç­›é€‰å™¨ï¼ˆè¿‡æ»¤å™¨ï¼‰"><a href="#ç­›é€‰å™¨ï¼ˆè¿‡æ»¤å™¨ï¼‰" class="headerlink" title="ç­›é€‰å™¨ï¼ˆè¿‡æ»¤å™¨ï¼‰"></a>ç­›é€‰å™¨ï¼ˆè¿‡æ»¤å™¨ï¼‰</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é…ç½® MVC é€‰é¡¹ï¼Œæ·»åŠ å·¥ä½œå•å…ƒè¿‡æ»¤å™¨</span></span><br><span class="line">services.Configure&lt;MvcOptions&gt;(options =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    options.Filters.Add&lt;UnitOfWorkFilter&gt;();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>options.Filters.Add&lt;UnitOfWorkFilter&gt;()ç»™æ‰€æœ‰çš„æ§åˆ¶å™¨åŠ¨ä½œæ–¹æ³•æ·»åŠ ä¸€ä¸ªå…¨å±€è¿‡æ»¤å™¨ã€‚<br>UnitOfWorkFilter æ˜¯è‡ªå®šä¹‰çš„ç±»ï¼Œå®ç°äº†IAsyncActionFilterã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">YU.ASPNETCore</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> å®ç°åŸºäºç‰¹æ€§ï¼ˆUnitOfWorkAttributeï¼‰çš„å·¥ä½œå•å…ƒè¿‡æ»¤å™¨ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ç”¨äºåœ¨ ASP.NET Core æ§åˆ¶å™¨æˆ–æ–¹æ³•ä¸Šè‡ªåŠ¨ç®¡ç†äº‹åŠ¡å’Œ DbContext çš„ SaveChangesã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UnitOfWorkFilter</span> : <span class="title">IAsyncActionFilter</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> è·å–åº”ç”¨äºæ§åˆ¶å™¨æˆ–æ–¹æ³•çš„ UnitOfWorkAttribute ç‰¹æ€§ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ä¼˜å…ˆè·å–æ§åˆ¶å™¨ä¸Šçš„ç‰¹æ€§ï¼Œå¦‚æœæ²¡æœ‰åˆ™è·å–æ–¹æ³•ä¸Šçš„ç‰¹æ€§ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;actionDesc&quot;&gt;</span>å½“å‰ Action çš„æè¿°ä¿¡æ¯ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>UnitOfWorkAttribute å®ä¾‹æˆ– nullã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> UnitOfWorkAttribute? GetUoWAttr(ActionDescriptor actionDesc)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> caDesc = actionDesc <span class="keyword">as</span> ControllerActionDescriptor;</span><br><span class="line">            <span class="keyword">if</span> (caDesc == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// ä¸æ˜¯æ§åˆ¶å™¨ Actionï¼Œç›´æ¥è¿”å› null</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// ä¼˜å…ˆè·å–æ§åˆ¶å™¨ä¸Šçš„ UnitOfWorkAttribute</span></span><br><span class="line">            <span class="keyword">var</span> uowAttr = caDesc.ControllerTypeInfo</span><br><span class="line">                .GetCustomAttribute&lt;UnitOfWorkAttribute&gt;();</span><br><span class="line">            <span class="keyword">if</span> (uowAttr != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> uowAttr;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// å¦‚æœæ§åˆ¶å™¨ä¸Šæ²¡æœ‰ï¼Œåˆ™è·å–æ–¹æ³•ä¸Šçš„ UnitOfWorkAttribute</span></span><br><span class="line">                <span class="keyword">return</span> caDesc.MethodInfo</span><br><span class="line">                    .GetCustomAttribute&lt;UnitOfWorkAttribute&gt;();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ‹¦æˆª Action æ‰§è¡Œè¿‡ç¨‹ï¼Œå®ç°å·¥ä½œå•å…ƒäº‹åŠ¡æ§åˆ¶ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;context&quot;&gt;</span>Action æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;next&quot;&gt;</span>å§”æ‰˜ï¼Œæ‰§è¡Œä¸‹ä¸€ä¸ªä¸­é—´ä»¶æˆ– Actionã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>å¼‚æ­¥ä»»åŠ¡ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">OnActionExecutionAsync</span>(<span class="params">ActionExecutingContext context, ActionExecutionDelegate next</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// è·å–å½“å‰ Action æˆ–æ§åˆ¶å™¨ä¸Šçš„ UnitOfWorkAttribute</span></span><br><span class="line">            <span class="keyword">var</span> uowAttr = GetUoWAttr(context.ActionDescriptor);</span><br><span class="line">            <span class="keyword">if</span> (uowAttr == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// æœªæ ‡è®° UnitOfWorkAttributeï¼Œç›´æ¥æ‰§è¡Œä¸‹ä¸€ä¸ªä¸­é—´ä»¶</span></span><br><span class="line">                <span class="keyword">await</span> next();</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å¯ç”¨æ”¯æŒå¼‚æ­¥æµçš„äº‹åŠ¡ä½œç”¨åŸŸ</span></span><br><span class="line">            <span class="keyword">using</span> TransactionScope txScope = <span class="keyword">new</span> TransactionScope(TransactionScopeAsyncFlowOption.Enabled);</span><br><span class="line">            List&lt;DbContext&gt; dbCtxs = <span class="keyword">new</span> List&lt;DbContext&gt;();</span><br><span class="line">            <span class="comment">// éå†ç‰¹æ€§ä¸­å£°æ˜çš„æ‰€æœ‰ DbContext ç±»å‹</span></span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> dbCtxType <span class="keyword">in</span> uowAttr.DbContextTypes)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// é€šè¿‡ä¾èµ–æ³¨å…¥è·å– DbContext å®ä¾‹</span></span><br><span class="line">                <span class="keyword">var</span> sp = context.HttpContext.RequestServices;</span><br><span class="line">                DbContext dbCtx = (DbContext)sp.GetRequiredService(dbCtxType);</span><br><span class="line">                dbCtxs.Add(dbCtx);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// æ‰§è¡Œ Action</span></span><br><span class="line">            <span class="keyword">var</span> result = <span class="keyword">await</span> next();</span><br><span class="line">            <span class="keyword">if</span> (result.Exception == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// å¦‚æœæ²¡æœ‰å¼‚å¸¸ï¼Œä¾æ¬¡ä¿å­˜æ‰€æœ‰ DbContext çš„æ›´æ”¹</span></span><br><span class="line">                <span class="keyword">foreach</span> (<span class="keyword">var</span> dbCtx <span class="keyword">in</span> dbCtxs)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">await</span> dbCtx.SaveChangesAsync();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// æäº¤äº‹åŠ¡</span></span><br><span class="line">                txScope.Complete();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å¦‚æœæœ‰å¼‚å¸¸ï¼Œäº‹åŠ¡ä¼šè‡ªåŠ¨å›æ»š</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="åºåˆ—åŒ–è½¬æ¢å™¨"><a href="#åºåˆ—åŒ–è½¬æ¢å™¨" class="headerlink" title="åºåˆ—åŒ–è½¬æ¢å™¨"></a>åºåˆ—åŒ–è½¬æ¢å™¨</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é…ç½® JSON é€‰é¡¹ï¼Œæ·»åŠ è‡ªå®šä¹‰çš„ DateTime åºåˆ—åŒ–è½¬æ¢å™¨</span></span><br><span class="line">services.Configure&lt;JsonOptions&gt;(options =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//è®¾ç½®æ—¶é—´æ ¼å¼ã€‚è€Œéâ€œ2008-08-08T08:08:08â€è¿™æ ·çš„æ ¼å¼,è€Œæ˜¯&quot;2008-08-08 08:08:08&quot;</span></span><br><span class="line">    options.JsonSerializerOptions.Converters.Add(<span class="keyword">new</span> DateTimeJsonConverter(<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¼šæ›¿æ¢é»˜è®¤çš„ DateTime åºåˆ—åŒ–è§„åˆ™ã€‚<br>options.JsonSerializerOptions.Converters.Add(â€¦)æ·»åŠ ä¸€ä¸ªè‡ªå®šä¹‰çš„JsonConverter&lt;DateTime&amp;gtï¼ŒDateTimeJsonConverter</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">YU.Commons.JsonConverters</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> è‡ªå®šä¹‰çš„ DateTime ç±»å‹ JSON åºåˆ—åŒ–ä¸ååºåˆ—åŒ–è½¬æ¢å™¨ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æ”¯æŒæŒ‡å®šæ—¥æœŸæ—¶é—´æ ¼å¼è¿›è¡Œåºåˆ—åŒ–ä¸ååºåˆ—åŒ–ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">DateTimeJsonConverter</span> : <span class="title">JsonConverter</span>&lt;<span class="title">DateTime</span>&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ—¥æœŸæ—¶é—´æ ¼å¼å­—ç¬¦ä¸²ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> <span class="built_in">string</span> _dateFormatString;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> é»˜è®¤æ„é€ å‡½æ•°ï¼Œä½¿ç”¨ &quot;yyyy-MM-dd HH:mm:ss&quot; ä½œä¸ºæ—¥æœŸæ—¶é—´æ ¼å¼ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">DateTimeJsonConverter</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            _dateFormatString = <span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>; <span class="comment">// é»˜è®¤æ—¥æœŸæ ¼å¼</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ„é€ å‡½æ•°ï¼Œå…è®¸è‡ªå®šä¹‰æ—¥æœŸæ—¶é—´æ ¼å¼ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;dateformatString&quot;&gt;</span>è‡ªå®šä¹‰çš„æ—¥æœŸæ—¶é—´æ ¼å¼å­—ç¬¦ä¸²<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">DateTimeJsonConverter</span>(<span class="params"><span class="built_in">string</span> dateformatString</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            _dateFormatString = dateformatString; <span class="comment">// ä½¿ç”¨è‡ªå®šä¹‰æ—¥æœŸæ ¼å¼</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ååºåˆ—åŒ–ï¼šå°† JSON å­—ç¬¦ä¸²è½¬æ¢ä¸º DateTime å¯¹è±¡ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;reader&quot;&gt;</span>JSON è¯»å–å™¨<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;typeToConvert&quot;&gt;</span>è¦è½¬æ¢çš„ç±»å‹<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;options&quot;&gt;</span>åºåˆ—åŒ–é€‰é¡¹<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>ååºåˆ—åŒ–å¾—åˆ°çš„ DateTime å¯¹è±¡<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> DateTime <span class="title">Read</span>(<span class="params"><span class="keyword">ref</span> Utf8JsonReader reader, Type typeToConvert, JsonSerializerOptions options</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span>? str = reader.GetString();</span><br><span class="line">            <span class="keyword">if</span> (str == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// å¦‚æœ JSON å­—ç¬¦ä¸²ä¸º nullï¼Œåˆ™è¿”å›é»˜è®¤å€¼</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">default</span>(DateTime);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// å°†å­—ç¬¦ä¸²è§£æä¸º DateTime å¯¹è±¡</span></span><br><span class="line">                <span class="keyword">return</span> DateTime.Parse(str);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> åºåˆ—åŒ–ï¼šå°† DateTime å¯¹è±¡è½¬æ¢ä¸ºæŒ‡å®šæ ¼å¼çš„ JSON å­—ç¬¦ä¸²ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;writer&quot;&gt;</span>JSON å†™å…¥å™¨<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;value&quot;&gt;</span>è¦åºåˆ—åŒ–çš„ DateTime å€¼<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;options&quot;&gt;</span>åºåˆ—åŒ–é€‰é¡¹<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Write</span>(<span class="params">Utf8JsonWriter writer, DateTime <span class="keyword">value</span>, JsonSerializerOptions options</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// æŒ‰æŒ‡å®šæ ¼å¼å°† DateTime å†™å…¥ä¸ºå­—ç¬¦ä¸²</span></span><br><span class="line">            writer.WriteStringValue(<span class="keyword">value</span>.ToString(_dateFormatString));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Cors"><a href="#Cors" class="headerlink" title="Cors"></a>Cors</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é…ç½®è·¨åŸŸèµ„æºå…±äº«ï¼ˆCORSï¼‰ç­–ç•¥</span></span><br><span class="line">services.AddCors(options =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ä»é…ç½®ä¸­è·å– CORS è®¾ç½®</span></span><br><span class="line">    <span class="keyword">var</span> corsOpt = configuration.GetSection(<span class="string">&quot;Cors&quot;</span>).Get&lt;CorsSettings&gt;();</span><br><span class="line">    <span class="comment">// è·å–å…è®¸çš„æ¥æºåˆ—è¡¨</span></span><br><span class="line">    <span class="built_in">string</span>[] urls = corsOpt.Origins;</span><br><span class="line">    <span class="comment">// æ·»åŠ é»˜è®¤ç­–ç•¥ï¼Œå…è®¸æŒ‡å®šæ¥æºã€ä»»æ„å¤´ã€ä»»æ„æ–¹æ³•ï¼Œå¹¶å…è®¸æºå¸¦å‡­æ®</span></span><br><span class="line">    options.AddDefaultPolicy(builder =&gt; builder.WithOrigins(urls)</span><br><span class="line">        .AllowAnyHeader()</span><br><span class="line">        .AllowAnyMethod()</span><br><span class="line">        .AllowCredentials());</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šAllowCredentials() å’Œ WithOrigins(â€¦) å¿…é¡»ä¸€èµ·ä½¿ç”¨ï¼Œä¸èƒ½æ­é… AllowAnyOrigin()ï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p><h4 id="æ—¥å¿—æœåŠ¡"><a href="#æ—¥å¿—æœåŠ¡" class="headerlink" title="æ—¥å¿—æœåŠ¡"></a>æ—¥å¿—æœåŠ¡</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é…ç½®æ—¥å¿—æœåŠ¡ï¼Œä½¿ç”¨ Serilogï¼Œæ—¥å¿—è¾“å‡ºåˆ°æ§åˆ¶å°å’Œæ–‡ä»¶</span></span><br><span class="line">services.AddLogging(builder =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// é…ç½® Serilog æ—¥å¿—è®°å½•å™¨</span></span><br><span class="line">    Log.Logger = <span class="keyword">new</span> LoggerConfiguration()</span><br><span class="line">    .WriteTo.Console()</span><br><span class="line">    .WriteTo.File(initOptions.LogFilePath)</span><br><span class="line">    .CreateLogger();</span><br><span class="line">    <span class="comment">// å°† Serilog é›†æˆåˆ°æ—¥å¿—ç³»ç»Ÿ</span></span><br><span class="line">    builder.AddSerilog();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h4 id="éªŒè¯å™¨"><a href="#éªŒè¯å™¨" class="headerlink" title="éªŒè¯å™¨"></a>éªŒè¯å™¨</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–åº”ç”¨ç¨‹åºä¸»ç¨‹åºé›†ï¼Œç”¨äºæ³¨å†Œ FluentValidation éªŒè¯å™¨</span></span><br><span class="line"><span class="keyword">var</span> applicationAssembly = <span class="keyword">typeof</span>(UserModelValidator).Assembly;</span><br><span class="line"><span class="comment">// æ³¨å†Œæ‰€æœ‰éªŒè¯å™¨</span></span><br><span class="line">services.AddValidatorsFromAssembly(applicationAssembly);</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">YU.ASPNETCore</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ç”¨æˆ·æ¨¡å‹éªŒè¯å™¨ï¼Œä½¿ç”¨FluentValidationå¯¹UserValidationå¯¹è±¡è¿›è¡Œå±æ€§æ ¡éªŒã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UserModelValidator</span> : <span class="title">AbstractValidator</span>&lt;<span class="title">UserValidation</span>&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ„é€ å‡½æ•°ï¼Œå®šä¹‰äº†å¯¹UserValidationå±æ€§çš„æ ¡éªŒè§„åˆ™ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">UserModelValidator</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// æ ¡éªŒç”¨æˆ·åä¸èƒ½ä¸ºç©º</span></span><br><span class="line">            RuleFor(x =&gt; x.Name)</span><br><span class="line">                .NotEmpty()</span><br><span class="line">                .WithMessage(<span class="string">&quot;ç”¨æˆ·åä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ ¡éªŒå¹´é¾„å¿…é¡»åœ¨0åˆ°100ä¹‹é—´</span></span><br><span class="line">            RuleFor(x =&gt; x.Age)</span><br><span class="line">                .InclusiveBetween(<span class="number">0</span>, <span class="number">100</span>)</span><br><span class="line">                .WithMessage(<span class="string">&quot;å¹´é¾„å¿…é¡»åœ¨0åˆ°100ä¹‹é—´&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">YU.DomainCommons.Models</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ç”¨æˆ·éªŒè¯ä¿¡æ¯æ¨¡å‹ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UserValidation</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ç”¨æˆ·åã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ç”¨æˆ·å¹´é¾„ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> Age &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡æŸä¸ªéªŒè¯å™¨ç±»å‹ UserModelValidator è·å–å®ƒæ‰€åœ¨çš„ç¨‹åºé›†ï¼ˆAssemblyï¼‰ã€‚<br>è¿™æ ·å°±èƒ½çŸ¥é“â€œåº”ç”¨ç¨‹åºçš„ä¸»è¦ä»£ç ç¨‹åºé›†â€ï¼Œç”¨äºåç»­è‡ªåŠ¨æ‰«æå’Œæ³¨å†Œã€‚</p><h4 id="RabbitMQ"><a href="#RabbitMQ" class="headerlink" title="RabbitMQ"></a>RabbitMQ</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é…ç½® RabbitMQ äº‹ä»¶æ€»çº¿é€‰é¡¹ç»‘å®š</span></span><br><span class="line">services.Configure&lt;IntegrationEventRabbitMQOptions&gt;(configuration.GetSection(<span class="string">&quot;RabbitMQ&quot;</span>));</span><br></pre></td></tr></table></figure><p>å°†é…ç½®æ–‡ä»¶ä¸­ â€œRabbitMQâ€ èŠ‚ç‚¹çš„å†…å®¹ç»‘å®šåˆ° IntegrationEventRabbitMQOptions ç±»ï¼Œå¹¶æ³¨å…¥åˆ°ä¾èµ–æ³¨å…¥å®¹å™¨ä¸­ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">YU.EventBus</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> è¡¨ç¤ºç”¨äºé…ç½®RabbitMQé›†æˆäº‹ä»¶çš„é€‰é¡¹ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">IntegrationEventRabbitMQOptions</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> RabbitMQ ä¸»æœºåæˆ– IP åœ°å€ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> HostName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> äº¤æ¢æœºåç§°ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> ExchangeName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ç”¨äºè¿æ¥ RabbitMQ çš„ç”¨æˆ·åï¼ˆå¯é€‰ï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span>? UserName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ç”¨äºè¿æ¥ RabbitMQ çš„å¯†ç ï¼ˆå¯é€‰ï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span>? Password &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="äº‹ä»¶"><a href="#äº‹ä»¶" class="headerlink" title="äº‹ä»¶"></a>äº‹ä»¶</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ³¨å†Œäº‹ä»¶æ€»çº¿æœåŠ¡</span></span><br><span class="line">services.AddEventBus(initOptions.EventBusQueueName, assemblies);</span><br></pre></td></tr></table></figure><p>æ³¨å†Œäº‹ä»¶æ€»çº¿ï¼ˆEventBusï¼‰æœåŠ¡ï¼Œå¹¶åˆå§‹åŒ–äº‹ä»¶å¤„ç†å™¨æ‰«æã€é˜Ÿåˆ—åç§°ç­‰è®¾ç½®ã€‚</p><p>initOptions.EventBusQueueName<br>å½“å‰æœåŠ¡çš„äº‹ä»¶é˜Ÿåˆ—åï¼Œä¾‹å¦‚ â€œuser-serviceâ€ã€‚<br>ä¸åŒæœåŠ¡åº”è¯¥æœ‰ä¸åŒçš„é˜Ÿåˆ—åï¼Œé˜²æ­¢æ¶ˆè´¹äº’ä¸²ã€‚</p><p>assemblies<br>æ‰€æœ‰éœ€è¦æ‰«æçš„ç¨‹åºé›†ï¼ˆAssembly[]ï¼‰ï¼Œç”¨äºä»ä¸­æ‰¾å‡ºæ‰€æœ‰å®ç°äº† IIntegrationEventHandler&lt;T&gt; çš„äº‹ä»¶å¤„ç†å™¨ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">YU.EventBus</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æ‰©å±• IServiceCollectionï¼Œæä¾›äº‹ä»¶æ€»çº¿ï¼ˆEventBusï¼‰ç›¸å…³çš„ä¾èµ–æ³¨å…¥æ³¨å†Œæ–¹æ³•ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">ServicesCollectionExtensions</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ³¨å†Œäº‹ä»¶æ€»çº¿æœåŠ¡ï¼Œè‡ªåŠ¨æ‰«ææŒ‡å®šç¨‹åºé›†ä¸­çš„äº‹ä»¶å¤„ç†å™¨ç±»å‹ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;services&quot;&gt;</span>ä¾èµ–æ³¨å…¥æœåŠ¡é›†åˆã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;queueName&quot;&gt;</span>RabbitMQ é˜Ÿåˆ—åç§°ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;assemblies&quot;&gt;</span>è¦æ‰«æçš„ç¨‹åºé›†åˆ—è¡¨ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>æœåŠ¡é›†åˆæœ¬èº«ï¼Œä¾¿äºé“¾å¼è°ƒç”¨ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IServiceCollection <span class="title">AddEventBus</span>(<span class="params"><span class="keyword">this</span> IServiceCollection services, <span class="built_in">string</span> queueName,</span></span></span><br><span class="line"><span class="params"><span class="function">            <span class="keyword">params</span> Assembly[] assemblies</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// å°† params å½¢å¼çš„ç¨‹åºé›†æ•°ç»„è½¬æ¢ä¸º List å½¢å¼ï¼Œè°ƒç”¨é‡è½½æ–¹æ³•</span></span><br><span class="line">            <span class="keyword">return</span> AddEventBus(services, queueName, assemblies.ToList());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ³¨å†Œäº‹ä»¶æ€»çº¿æœåŠ¡ï¼Œè‡ªåŠ¨æ‰«ææŒ‡å®šç¨‹åºé›†ä¸­çš„äº‹ä»¶å¤„ç†å™¨ç±»å‹ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;services&quot;&gt;</span>ä¾èµ–æ³¨å…¥æœåŠ¡é›†åˆã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;queueName&quot;&gt;</span>RabbitMQ é˜Ÿåˆ—åç§°ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;assemblies&quot;&gt;</span>è¦æ‰«æçš„ç¨‹åºé›†é›†åˆã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>æœåŠ¡é›†åˆæœ¬èº«ï¼Œä¾¿äºé“¾å¼è°ƒç”¨ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IServiceCollection <span class="title">AddEventBus</span>(<span class="params"><span class="keyword">this</span> IServiceCollection services, <span class="built_in">string</span> queueName,</span></span></span><br><span class="line"><span class="params"><span class="function">            IEnumerable&lt;Assembly&gt; assemblies</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// ç”¨äºå­˜å‚¨æ‰€æœ‰æ‰«æåˆ°çš„äº‹ä»¶å¤„ç†å™¨ç±»å‹</span></span><br><span class="line">            List&lt;Type&gt; eventHandlers = <span class="keyword">new</span> List&lt;Type&gt;();</span><br><span class="line">            <span class="comment">// éå†æ¯ä¸ªç¨‹åºé›†</span></span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> asm <span class="keyword">in</span> assemblies)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// æŸ¥æ‰¾æ‰€æœ‰éæŠ½è±¡ä¸”å®ç°äº† IIntegrationEventHandler æ¥å£çš„ç±»å‹</span></span><br><span class="line">                <span class="keyword">var</span> types = asm.GetTypes().Where(t =&gt; t.IsAbstract == <span class="literal">false</span> &amp;&amp; t.IsAssignableTo(<span class="keyword">typeof</span>(IIntegrationEventHandler)));</span><br><span class="line">                <span class="comment">// æ·»åŠ åˆ°äº‹ä»¶å¤„ç†å™¨ç±»å‹åˆ—è¡¨</span></span><br><span class="line">                eventHandlers.AddRange(types);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// è°ƒç”¨é‡è½½æ–¹æ³•ï¼Œæ³¨å†Œäº‹ä»¶å¤„ç†å™¨ç±»å‹</span></span><br><span class="line">            <span class="keyword">return</span> AddEventBus(services, queueName, eventHandlers);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ³¨å†Œäº‹ä»¶æ€»çº¿æœåŠ¡ï¼Œå¹¶å°†æŒ‡å®šçš„äº‹ä»¶å¤„ç†å™¨ç±»å‹æ³¨å†Œåˆ°ä¾èµ–æ³¨å…¥å®¹å™¨ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;services&quot;&gt;</span>ä¾èµ–æ³¨å…¥æœåŠ¡é›†åˆã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;queueName&quot;&gt;</span>RabbitMQ é˜Ÿåˆ—åç§°ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;eventHandlerTypes&quot;&gt;</span>äº‹ä»¶å¤„ç†å™¨ç±»å‹é›†åˆã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>æœåŠ¡é›†åˆæœ¬èº«ï¼Œä¾¿äºé“¾å¼è°ƒç”¨ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> IServiceCollection <span class="title">AddEventBus</span>(<span class="params"><span class="keyword">this</span> IServiceCollection services, <span class="built_in">string</span> queueName,</span></span></span><br><span class="line"><span class="params"><span class="function">            IEnumerable&lt;Type&gt; eventHandlerTypes</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// éå†æ‰€æœ‰äº‹ä»¶å¤„ç†å™¨ç±»å‹</span></span><br><span class="line">            <span class="keyword">foreach</span> (Type type <span class="keyword">in</span> eventHandlerTypes)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// å°†äº‹ä»¶å¤„ç†å™¨ç±»å‹æ³¨å†Œä¸º Scoped ç”Ÿå‘½å‘¨æœŸ</span></span><br><span class="line">                services.AddScoped(type, type);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// æ³¨å†Œ IEventBus å•ä¾‹æœåŠ¡</span></span><br><span class="line">            services.AddSingleton&lt;IEventBus&gt;(sp =&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// è·å– RabbitMQ é…ç½®é€‰é¡¹</span></span><br><span class="line">                <span class="keyword">var</span> optionMQ = sp.GetRequiredService&lt;IOptions&lt;IntegrationEventRabbitMQOptions&gt;&gt;().Value;</span><br><span class="line">                <span class="comment">// åˆ›å»º RabbitMQ è¿æ¥å·¥å‚</span></span><br><span class="line">                <span class="keyword">var</span> factory = <span class="keyword">new</span> ConnectionFactory()</span><br><span class="line">                &#123;</span><br><span class="line">                    HostName = optionMQ.HostName, <span class="comment">// è®¾ç½®ä¸»æœºå</span></span><br><span class="line">                    DispatchConsumersAsync = <span class="literal">true</span> <span class="comment">// å¯ç”¨å¼‚æ­¥æ¶ˆè´¹è€…</span></span><br><span class="line">                &#125;;</span><br><span class="line">                <span class="comment">// å¦‚æœé…ç½®äº†ç”¨æˆ·åï¼Œåˆ™è®¾ç½®ç”¨æˆ·å</span></span><br><span class="line">                <span class="keyword">if</span> (optionMQ.UserName != <span class="literal">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    factory.UserName = optionMQ.UserName;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// å¦‚æœé…ç½®äº†å¯†ç ï¼Œåˆ™è®¾ç½®å¯†ç </span></span><br><span class="line">                <span class="keyword">if</span> (optionMQ.Password != <span class="literal">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    factory.Password = optionMQ.Password;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// åˆ›å»º RabbitMQ æŒä¹…è¿æ¥å¯¹è±¡</span></span><br><span class="line">                RabbitMQConnection mqConnection = <span class="keyword">new</span> RabbitMQConnection(factory);</span><br><span class="line">                <span class="comment">// è·å–æœåŠ¡ä½œç”¨åŸŸå·¥å‚ï¼Œç”¨äºäº‹ä»¶å¤„ç†å™¨çš„ä¾èµ–æ³¨å…¥</span></span><br><span class="line">                <span class="keyword">var</span> serviceScopeFactory = sp.GetRequiredService&lt;IServiceScopeFactory&gt;();</span><br><span class="line">                <span class="comment">// åˆ›å»º RabbitMQEventBus å®ä¾‹</span></span><br><span class="line">                <span class="keyword">var</span> eventBus = <span class="keyword">new</span> RabbitMQEventBus(mqConnection, serviceScopeFactory, optionMQ.ExchangeName, queueName);</span><br><span class="line">                <span class="comment">// è¿”å›äº‹ä»¶æ€»çº¿å®ä¾‹</span></span><br><span class="line">                <span class="keyword">return</span> eventBus;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="comment">// è¿”å›æœåŠ¡é›†åˆæœ¬èº«</span></span><br><span class="line">            <span class="keyword">return</span> services;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>IIntegrationEventHandlerå®šä¹‰é›†æˆäº‹ä»¶å¤„ç†ç¨‹åºçš„æ¥å£</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">YU.EventBus</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> å®šä¹‰é›†æˆäº‹ä»¶å¤„ç†ç¨‹åºçš„æ¥å£ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IIntegrationEventHandler</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å¤„ç†é›†æˆäº‹ä»¶çš„æ–¹æ³•ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;eventName&quot;&gt;</span>äº‹ä»¶åç§°ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;eventData&quot;&gt;</span>äº‹ä»¶æ•°æ®ï¼ˆåºåˆ—åŒ–åçš„å­—ç¬¦ä¸²ï¼‰ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>è¡¨ç¤ºå¼‚æ­¥æ“ä½œçš„ä»»åŠ¡ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function">Task <span class="title">Handle</span>(<span class="params"><span class="built_in">string</span> eventName, <span class="built_in">string</span> eventData</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>IntegrationEventRabbitMQOptionsæ¥å£è‡ªå®šä¹‰ç”¨äºé…ç½®RabbitMQé›†æˆäº‹ä»¶çš„é€‰é¡¹ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">YU.EventBus</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> è¡¨ç¤ºç”¨äºé…ç½®RabbitMQé›†æˆäº‹ä»¶çš„é€‰é¡¹ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">IntegrationEventRabbitMQOptions</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> RabbitMQ ä¸»æœºåæˆ– IP åœ°å€ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> HostName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> äº¤æ¢æœºåç§°ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> ExchangeName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ç”¨äºè¿æ¥ RabbitMQ çš„ç”¨æˆ·åï¼ˆå¯é€‰ï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span>? UserName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ç”¨äºè¿æ¥ RabbitMQ çš„å¯†ç ï¼ˆå¯é€‰ï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span>? Password &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä»é…ç½®ä¸­è·å– Redis è¿æ¥å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="built_in">string</span> redisConnStr = configuration.GetValue&lt;<span class="built_in">string</span>&gt;(<span class="string">&quot;Redis:ConnStr&quot;</span>);</span><br><span class="line"><span class="comment">// åˆ›å»º Redis è¿æ¥å¤šè·¯å¤ç”¨å™¨</span></span><br><span class="line">IConnectionMultiplexer redisConnMultiplexer = ConnectionMultiplexer.Connect(redisConnStr);</span><br><span class="line"><span class="comment">// æ³¨å†Œ Redis è¿æ¥ä¸ºå•ä¾‹æœåŠ¡</span></span><br><span class="line">services.AddSingleton(<span class="keyword">typeof</span>(IConnectionMultiplexer), redisConnMultiplexer);</span><br><span class="line"><span class="comment">// é…ç½®è½¬å‘å¤´éƒ¨é€‰é¡¹ï¼Œæ”¯æŒæ‰€æœ‰è½¬å‘å¤´</span></span><br><span class="line">services.Configure&lt;ForwardedHeadersOptions&gt;(Options =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    Options.ForwardedHeaders = ForwardedHeaders.All;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ASP.NET Core </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>éè°“è¯­2+ç‹¬ç«‹ä¸»æ ¼</title>
      <link href="/2025/07/30/asp.net%20core/%E8%8B%B1%E8%AF%AD/%E9%9D%9E%E8%B0%93%E8%AF%AD2%EF%BC%8C%E7%8B%AC%E7%AB%8B%E4%B8%BB%E6%A0%BC/"/>
      <url>/2025/07/30/asp.net%20core/%E8%8B%B1%E8%AF%AD/%E9%9D%9E%E8%B0%93%E8%AF%AD2%EF%BC%8C%E7%8B%AC%E7%AB%8B%E4%B8%BB%E6%A0%BC/</url>
      
        <content type="html"><![CDATA[<h1 id="éè°“è¯­2-ç‹¬ç«‹ä¸»æ ¼"><a href="#éè°“è¯­2-ç‹¬ç«‹ä¸»æ ¼" class="headerlink" title="éè°“è¯­2+ç‹¬ç«‹ä¸»æ ¼"></a>éè°“è¯­2+ç‹¬ç«‹ä¸»æ ¼</h1><p>éè°“è¯­&#x3D;to do ,doingä¸»åŠ¨ï¼ˆæŒç»­è¿›è¡Œï¼‰ï¼Œdoneè¢«åŠ¨ï¼ˆå®Œæˆï¼‰</p><p>1.ç«™åœ¨æ ‘ä¸‹çš„Tomçœ‹ç€å¤©ç©ºã€‚<br>ä¸»å¹²ï¼šTom looks at the sky.<br>Tom standing under the tree looks at the sky.<br>å¯ä»¥å˜ä¸ºéé™å®šæ€§å®šè¯­ä»å¥(çŠ¶è¯­)ï¼š<br>Tom, who is standing under the tree, looks at the sky.<br>çŠ¶è¯­&#x3D;éšä¾¿æ”¾ï¼ˆåªè¦è¯´å¾—é€šï¼‰<br>Standing under the tree, Tom looks at the sky.<br>è¿™å¥è¯è¿˜å¯ä»¥å˜ä¸ºï¼šTomç«™åœ¨æ ‘ä¸‹,çœ‹ç€å¤©ç©ºã€‚(ç”¨andè¿è¯)<br>Tom stands under the tree and looks at the sky.<br>Andè¿æ¥ä¸¤ä¸ªå¥å­å¯ä»¥æœ‰ä¸¤ä¸ªè°“è¯­ï¼ˆstands, looksï¼‰<br>And&#x3D;&gt; , å˜æˆä¸€å¥è¯åªèƒ½æœ‰ä¸€ä¸ªè°“è¯­<br>Tom standing under the tree, looks at the sky.</p><p>2.Tomç«™åœ¨æ ‘ä¸‹ï¼ŒMarryçœ‹ç€å¤©ç©ºã€‚<br>Tom stands under the tree and Marry looks at the sky.<br>Tom standing under the tree, Marry looks at the sky.<br>ä¸åŠ andçš„å°±æ˜¯ç‹¬ç«‹ä¸»æ ¼ã€‚<br>ä¸€ä¸ªç”¨è°“è¯­å……å½“ä¸»è¦ï¼Œéè°“è¯­å……å½“æ¬¡è¦ã€‚</p><p>2.ä¸€ä¸ªç”·å­©å“­ç€å‘æˆ‘èµ°æ¥ã€‚<br>æœ‰ä¸¤ä¸ªåŠ¨ä½œï¼šå“­ï¼Œèµ°<br>ç”¨and: A boy cries and comes to me.<br>éè°“è¯­åšçŠ¶è¯­ï¼šA boy, crying, comes to me.</p><p>3.è¿™æ¡æ²³ä»è¿œå¤„çœ‹å¾ˆæ¼‚äº®ã€‚<br>éè°“è¯­ï¼š<br>ä¸»å¹²ï¼šThis river is very beautiful.<br>This river seen from the distance is very beautiful.<br>éè°“è¯­åšçŠ¶è¯­ï¼š<br>This river ,seen from the distance, is very beautiful.</p><p>ä¹ é¢˜</p><p>1.Tomæ‹¿ç€èŠ±è·Ÿæˆ‘èŠå¤©ã€‚<br>Tom ,holding the flower, chats with me</p><p>2.ä»–èµ°åœ¨è¡—ä¸Šï¼Œå¬ç€éŸ³ä¹ã€‚<br>He walks on the street, listening to the music.</p><p>3.Marryè¢«å¾ˆå¤šç²‰ä¸åŒ…å›´ç€ï¼Œå¾ˆå¼€å¿ƒã€‚<br>Marry , surrounded by many fans, is very many</p><p>4.å¥¹èº«åè·Ÿç€ä¸€æ¡ç‹—ï¼Œèµ°è¿›æˆ¿é—´ã€‚<br>She , followed by a dog , walks into the room</p>]]></content>
      
      
      <categories>
          
          <category> English </category>
          
      </categories>
      
      
        <tags>
            
            <tag> English </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>éè°“è¯­ä¸€</title>
      <link href="/2025/07/28/asp.net%20core/%E8%8B%B1%E8%AF%AD/%E9%9D%9E%E8%B0%93%E8%AF%AD%E4%B8%80/"/>
      <url>/2025/07/28/asp.net%20core/%E8%8B%B1%E8%AF%AD/%E9%9D%9E%E8%B0%93%E8%AF%AD%E4%B8%80/</url>
      
        <content type="html"><![CDATA[<h1 id="éè°“è¯­1"><a href="#éè°“è¯­1" class="headerlink" title="éè°“è¯­1"></a>éè°“è¯­1</h1><p><b>éè°“è¯­&#x3D;to do, doingä¸»åŠ¨ï¼ˆæŒç»­è¿›è¡Œï¼‰ï¼Œdoneè¢«åŠ¨ï¼ˆå®Œæˆï¼‰<b></p><p>1.æ­£ç«™åœ¨æ ‘ä¸‹çš„ç”·è¿˜æ˜¯æˆ‘å“¥å“¥<br>ç«™&#x3D;ä¸»åŠ¨ç«™åœ¨æ ‘ä¸‹<br>Stand&#x3D;standing<br>ä¸»å¹²ï¼šThis boy is my brother standingä¿®é¥°ç”·å­©boy+ standing<br>This boy standing under the tree is my brother</p><p>ä¹Ÿå¯ä»¥ï¼šThis boy who is standing under the tree is my brother.<br>åŠ  å¼•+be&#x3D;å®šè¯­ä»å¥<br>éè°“è¯­&#x3D;ç®€åŒ–ç‰ˆçš„å®šè¯­ä»å¥</p><p>2.è¢«ç‹—å’¬çš„å¥³å­©æ˜¯æˆ‘å§å§ã€‚<br>ä¸»å¹²ï¼šThis girl is my sister. Bite&#x3D;bitten&#x3D;å’¬<br>This girl bitten by a dog is my sister    ä¸€å¥ä¸€è°“</p><p>3.æˆ‘å–œæ¬¢è¿™ä¸ªæˆ´ç€å¸½å­çš„å¥³å­©ã€‚<br>ä¸»å¹²ï¼šI like this girl. Wear&#x3D;wearing&#x3D;æˆ´<br>I like this girl wearing a cap.<br>4.è¿™ä¸ªè¢«Tomæ‰“ç ´äº†çš„èŠ±ç“¶æ˜¯çº¢è‰²çš„ã€‚<br>ä¸»å¹²ï¼šThis vase is red. Break&#x3D;broken&#x3D;æ‰“ç ´<br>This vase broken by Tom is red.</p><p>5.è¿™åŒ¹é©¬åœ¨è‰åœ°ä¸Šå–æ°´çš„é©¬æ˜¯æ£•è‰²çš„ã€‚<br>ä¸»å¹²ï¼šThis horse is brown. Drink&#x3D;drinking&#x3D;å–<br>This horse drinking water on the grass is brown.</p><p>6.è¿™æ˜¯ä¸€æ ‹æ”¿åºœä¿®å»ºçš„æˆ¿å­ã€‚<br>ä¸»å¹²ï¼šThis is a house.  Build&#x3D;built&#x3D;ä¿®å»º<br>This is a house built by the government</p><h2 id="ä¹ é¢˜"><a href="#ä¹ é¢˜" class="headerlink" title="ä¹ é¢˜"></a>ä¹ é¢˜</h2><p>è¿™æ˜¯ä¸€éƒ¨åœ¨æ²™æ¼ ä¸Šæ‹æ‘„çš„ç”µå½±ã€‚<br>This is a movie shot on the desert.</p><p>è¿™ä¸ªå–æ°´çš„å¥³å­©æ˜¯æˆ‘å¥³æœ‹å‹ã€‚<br>This girl drinking the water is my girlfriend.</p><p>æˆ‘æ”¶åˆ°Tomé€çš„ç¤¼ç‰©ã€‚<br>I received a gift sent by Tom.</p><p>Marryæ‹¿ç€çš„èŠ±å¾ˆæ¼‚äº®ã€‚<br>The flower held by Marry is very beautiful.</p><p>æˆ‘è®¤è¯†è¿™ä½æ‰“ç¯®çƒçš„ç”·å­©ã€‚<br>I know this boy playing basketball.</p>]]></content>
      
      
      <categories>
          
          <category> English </category>
          
      </categories>
      
      
        <tags>
            
            <tag> English </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€èˆ¬ã€ç‰¹æ®Šç–‘é—®å¥</title>
      <link href="/2025/07/25/asp.net%20core/%E8%8B%B1%E8%AF%AD/%E4%B8%80%E8%88%AC%E3%80%81%E7%89%B9%E6%AE%8A%E7%96%91%E9%97%AE%E5%8F%A5/"/>
      <url>/2025/07/25/asp.net%20core/%E8%8B%B1%E8%AF%AD/%E4%B8%80%E8%88%AC%E3%80%81%E7%89%B9%E6%AE%8A%E7%96%91%E9%97%AE%E5%8F%A5/</url>
      
        <content type="html"><![CDATA[<p>ç–‘é—®å¥å…¶ä¸€ï¼ˆä¸€èˆ¬ç–‘é—®å¥ï¼‰<br>ä¸€èˆ¬ç–‘é—®å¥åªå›ç­”ï¼šæ˜¯å¦<br>â€œç–‘é—®å¥â€çš„åº•å±‚åŸç†<br>You like me.<br>ä½ å–œæ¬¢æˆ‘ã€‚<br>Do you like me?<br>ä½ å–œæ¬¢æˆ‘å—ï¼Ÿ</p><p>Do &#x3D; åŠ©åŠ¨è¯<br>è‹±è¯­å¿Œé‡å¤ è‹¥é‡å¤ï¼š1.åˆ é™¤å…¶ä¸­ä¸€ä¸ª 2.æ›¿æ¢å…¶ä¸­ä¸€ä¸ªï¼ˆåŠ©åŠ¨è¯&gt;æ™®é€šåŠ¨è¯ï¼‰<br>He likes me.<br>ä»–å–œæ¬¢æˆ‘ã€‚<br>ï¼ˆç”¨2ï¼‰Do he likes me? -&gt;Does he like me?<br>ä»–å–œæ¬¢æˆ‘å—ï¼Ÿ<br>ä¸€å¥,ä¸€è°“<br>ä¸€ä¸ªå¥å­æœ‰ä¸”åªæœ‰ä¸€ä¸ªè°“è¯­<br>Doä¸ç®—è°“è¯­<br>This apple very big.ï¼ˆç¼ºå°‘è°“è¯­ï¼‰<br>è¿™ä¸ªè‹¹æœå¾ˆå¤§ã€‚<br>é‡äº‹ä¸å†³è¡¥â€œbeâ€åŠ¨è¯&#x3D;å·¥å…·äºº(æ˜¯åŠ¨è¯é‚£å°±æ˜¯è°“è¯­)<br>â€œbeâ€åŠ¨è¯æœ¬èº«ä¸è¡¨ç¤ºä»»ä½•æ„æ€ï¼Œä¹Ÿç›¸å½“äºåŠ©åŠ¨è¯<br>This apple is very big.<br>è¿™ä¸ªè‹¹æœå¾ˆå¤§ã€‚<br>ï¼ˆç”¨1ï¼‰Does this apple is very big?<br>è¿™ä¸ªè‹¹æœå¾ˆå¤§å—ï¼Ÿ<br>Is this apple very big?<br>è¿™ä¸ªè‹¹æœå¾ˆå¤§å—ï¼Ÿ<br>æ³¨æ„ï¼šâ€œbeâ€åŠ¨è¯å…¼å¤‡â€œåŠ©åŠ¨è¯â€çš„åŠŸèƒ½ä½†æœ¬è´¨ä¾ç„¶æ˜¯â€œè°“è¯­â€ã€‚<br>â€œbeâ€åŠ¨è¯é¢å¤–å…·å¤‡â€œåŠ©åŠ¨è¯â€å±æ€§ï¼Œæ•…å¯ç›´æ¥é¡¶æ›¿doè€Œdoåªæœ‰åŠ©åŠ¨è¯å±æ€§ï¼ŒåŠŸèƒ½é‡å¤äº†ã€‚</p><p>é™ˆè¿°å¥â€”&gt;ç–‘é—®å¥<br>1.æœ‰be&#x3D;beæå‰ï¼Œå…¶ä»–ç…§æŠ„<br>2.æ²¡be&#x3D;å¼€å¤´+do(æ­£ç¡®å½¢å¼ï¼Œå¦‚å•ä¸‰åˆ™å˜does),å…¶ä»–ç…§æŠ„</p><p>These workers are very busy.<br>è¿™äº›å·¥äººå¾ˆå¿™ã€‚<br>Are these workers very busy?<br>è¿™äº›å·¥äººå¾ˆå¿™å—ï¼Ÿ<br>He sits down.<br>ä»–åä¸‹äº†ã€‚<br>Does he sit down?<br>ä»–åä¸‹æ¥å—ï¼Ÿ<br>è¿™å¥³å­©å¾ˆæ¼‚äº®å—ï¼Ÿ<br>Is this girl very beautiful?<br>ä½ ä»¬å–æ°´å—ï¼Ÿ<br>Do you drink water?<br>è¿™åªçŒªå¾ˆè‚¥å—ï¼Ÿ<br>Is this pig very fat?</p><p>ç‰¹æ®Šç–‘é—®å¥<br>è¦å…·ä½“å›ç­”<br>You like me.<br>ä½ å–œæ¬¢æˆ‘ã€‚<br>Do you like me?<br>ä½ å–œæ¬¢æˆ‘å—ï¼Ÿ<br>Why do you like me?<br>ä½ ä¸ºä»€ä¹ˆå–œæ¬¢æˆ‘ï¼Ÿ </p><p>You go to school.      goä¸åŠç‰©åŠ¨è¯<br>ä½ å»å­¦æ ¡ã€‚<br>Do you go to school?<br>ä½ å»å­¦æ ¡å—ï¼Ÿ<br>When do you go to school?<br>ä½ å•¥æ—¶å€™å»å­¦æ ¡ï¼Ÿ<br>How do you go to school?<br>ä½ æ€ä¹ˆå»çš„å­¦æ ¡ï¼Ÿ<br>Why do you go to school?<br>ä½ ä¸ºä»€ä¹ˆå»å­¦æ ¡ï¼Ÿ</p><p>He watches TV.<br>ä»–çœ‹ç”µè§†ã€‚<br>Does he watches TVï¼Ÿ<br>ä»–çœ‹ç”µè§†å—ï¼Ÿ<br>Where does he watch TV?<br>ä»–åœ¨å“ªé‡Œçœ‹ç”µè§†ï¼Ÿ<br>What does he watch?<br>ä»–åœ¨çœ‹ä»€ä¹ˆï¼Ÿ</p><p>This boy is my brother.<br>è¿™ä¸ªç”·å­©æ˜¯æˆ‘å“¥å“¥ã€‚<br>Is this boy my brother?<br>è¿™ä¸ªç”·å­©æ˜¯æˆ‘å“¥å“¥å—ï¼Ÿ<br>Who is this boy?<br>è¿™ä¸ªç”·å­©æ˜¯è°ï¼Ÿ</p><p>You like red color<br>ä½ å–œæ¬¢çº¢è‰²ã€‚<br>Do you like red color?<br>ä½ å–œæ¬¢çº¢è‰²å—ï¼Ÿ<br>Which color do you like?<br>ä½ å–œæ¬¢å“ªä¸ªé¢œè‰²ï¼Ÿ</p><p>This is your book.<br>è¿™æ˜¯ä½ çš„ä¹¦ã€‚<br>Is this your book?<br>è¿™æ˜¯ä½ çš„ä¹¦å—ï¼Ÿ<br>Whose book is this?<br>è¿™æ˜¯è°çš„ä¹¦ï¼Ÿ</p><p>ä¸ºä»€ä¹ˆ&#x3D;why<br>å•¥æ—¶å€™&#x3D;when<br>æ€ä¹ˆ&#x3D;how<br>å“ªé‡Œ&#x3D;where<br>ä»€ä¹ˆ&#x3D;what<br>è°&#x3D;who<br>é‚£ä¸ª&#x3D;which<br>è°çš„&#x3D;whose</p><p>ä½ ä¸ºä»€ä¹ˆæ‰“ä»–ï¼Ÿ<br>Why do you hit him?<br>Tomåœ¨å“ªå„¿æ‰“ç¯®çƒï¼Ÿ<br>Where does Tom play basketball?<br>ä»–åœ¨ç”»ä»€ä¹ˆï¼Ÿ<br>What does he draw?<br>Marryæ€ä¹ˆæ¥çš„æˆ‘å®¶ï¼Ÿ<br>How does Marry come to home?<br>ä»–ä»¬å•¥æ—¶å€™åƒçš„æ—©é¤ï¼Ÿ<br>When do they eat breakfast?<br>è¿™äº›æ˜¯è°çš„è‡ªè¡Œè½¦ï¼Ÿ<br>Whose bikes are these?<br>è¿™ä½è‹±ä¿Šçš„ç”·å­æ˜¯è°ï¼Ÿ<br>Who is this handsome man? </p>]]></content>
      
      
      <categories>
          
          <category> English </category>
          
      </categories>
      
      
        <tags>
            
            <tag> English </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€èˆ¬è¿‡å»æ—¶ã€å°†æ¥æ—¶ã€ç°åœ¨æ—¶</title>
      <link href="/2025/07/25/asp.net%20core/%E8%8B%B1%E8%AF%AD/%E4%B8%80%E8%88%AC%E8%BF%87%E5%8E%BB%E6%97%B6%E3%80%81%E5%B0%86%E6%9D%A5%E6%97%B6%E3%80%81%E7%8E%B0%E5%9C%A8%E6%97%B6/"/>
      <url>/2025/07/25/asp.net%20core/%E8%8B%B1%E8%AF%AD/%E4%B8%80%E8%88%AC%E8%BF%87%E5%8E%BB%E6%97%B6%E3%80%81%E5%B0%86%E6%9D%A5%E6%97%B6%E3%80%81%E7%8E%B0%E5%9C%A8%E6%97%B6/</url>
      
        <content type="html"><![CDATA[<p>ä¸€èˆ¬è¿‡å»æ—¶<br>I play basketball.<br>æˆ‘æ‰“ç¯®çƒã€‚<br>I played basketball.<br>æˆ‘æ›¾ç»æ‰“è¿‡ç¯®çƒã€‚<br>He works in the school.<br>å®ƒåœ¨å­¦æ ¡å·¥ä½œã€‚<br>He worked in the school.<br>ä»–ä»¥å‰åœ¨å­¦æ ¡å·¥ä½œè¿‡ã€‚<br>inä»£è¡¨åœ¨ä»€ä¹ˆâ€¦ä¸œè¥¿é‡Œé¢<br>the&#x3D;this(è¿™ä¸ª)ï¼Œthat(å“ªä¸ª)ï¼Œthese(è¿™äº›)ï¼Œthoseï¼ˆå“ªäº›ï¼‰<br>You like me.<br>ä½ å–œæ¬¢æˆ‘ã€‚<br>You liked me.<br>ä½ å–œæ¬¢è¿‡æˆ‘ã€‚<br>She saves my life.<br>å¥¹æ•‘æˆ‘çš„å‘½ã€‚<br>She saved my life.<br>å¥¹æ•‘è¿‡æˆ‘çš„å‘½ã€‚<br>You go to a market.<br>ä½ å»ä¸€å®¶å¸‚åœºã€‚<br>You went to a market.<br>ä½ å»è¿‡ä¸€å®¶å¸‚åœºã€‚<br>Did you go to the market?<br>ä½ å»è¿‡è¿™å®¶å¸‚åœºå—ï¼Ÿ<br>Why did you go to the market?<br>ä½ ä¸ºä»€ä¹ˆå»è¿‡è¿™å®¶å¸‚åœºï¼Ÿ<br>You do home work.<br>ä½ åšåŠŸè¯¾ã€‚<br>You did homework.<br>ä½ åšè¿‡åŠŸè¯¾ã€‚<br>do å½“åŠ©åŠ¨è¯ï¼ˆæ— å«ä¹‰ï¼‰æˆ–å½“åŠ¨è¯â€œåšâ€ï¼Œè¿‡å»å¼å‡ä¸ºdid.<br>Do you did homework?-&gt;Did you do homework?<br>ä½ åšè¿‡åŠŸè¯¾å—ï¼Ÿ<br>When did you do homework?<br>ä½ å•¥æ—¶å€™åšè¿‡åŠŸè¯¾ï¼Ÿ</p><p>BeåŠ¨è¯<br>I am a teacher.<br>æˆ‘æ›¾æ˜¯ä¸€åè€å¸ˆã€‚        Was&#x3D;am&#x2F;is   were&#x3D;are<br>I was a teacher.<br>æˆ‘æ›¾ç»æ˜¯ä¸€åè€å¸ˆã€‚<br>This boy is very smart.<br>è¿™ä¸ªç”·å­©å¾ˆèªæ˜ã€‚<br>This boy was very smart.<br>è¿™ä¸ªç”·å­©æ›¾ç»å¾ˆèªæ˜ã€‚<br>Was this boy very smart?<br>è¿™ä¸ªç”·å­©æ›¾ç»å¾ˆèªæ˜ã€‚<br>Why was this boy very smart?<br>ä¸ºä»€ä¹ˆè¿™ä¸ªç”·å­©æ›¾ç»å¾ˆèªæ˜ï¼Ÿ</p><p>I have a dream.<br>æˆ‘æ›¾ç»æœ‰ä¸€ä¸ªæ¢¦æƒ³ã€‚<br>I had a dream.<br>æˆ‘æ›¾ç»æœ‰ä¸€ä¸ªæ¢¦æƒ³ã€‚</p><p>Break æ‰“ç ´ï¼šbroke<br>Strike æ‰“å‡»ï¼šstroke<br>Freeze å†°å†»ï¼šfroze<br>Hit æ‰“ï¼šhit<br>Put æ”¾ï¼šput<br>Set è®¾ç½®ï¼šset<br>Sing å”±ï¼šsang<br>Drink å–ï¼šdrank<br>Sink æ²‰æ²¡ï¼šsank<br>Come æ¥ï¼šcame<br>Become æˆä¸ºï¼šbecame</p><p>I was a student.<br>æˆ‘æ›¾æ˜¯ä¸€åå­¦ç”Ÿã€‚<br>Jerry played the piano.<br>Jerryå¼¹è¿‡é’¢ç´ã€‚<br>The teacher told the story.<br>è€å¸ˆä»¥å‰è®²è¿‡è¿™ä¸ªæ•…äº‹ã€‚<br>Wusong hit the tiger.<br>Wusongæ›¾ç»æ‰“è¿‡è€è™ã€‚<br>Those candies were my favorite.<br>é‚£äº›ç³–æœæ›¾æ˜¯æˆ‘çš„æœ€çˆ±ã€‚</p><p>ä¸€èˆ¬ç°åœ¨æ—¶<br>è¡¨ç¤ºäº‹ç‰©å½“å‰å…·æœ‰çš„å±æ€§æˆ–ç‰¹ç‚¹ã€‚</p><p>The water boils at 100â„ƒ.    At&#x3D;åœ¨æŸä¸ªç‚¹<br>æ°´åœ¨100â„ƒæ²¸è…¾ã€‚<br>The water boils. æ°´æ²¸è…¾äº†ã€‚ä¸åŠç‰©åŠ¨è¯ï¼šå•ç‹¬æˆå¥ã€‚<br>The earth is round.<br>åœ°çƒæ˜¯åœ†çš„ã€‚<br>Tom gets up at 8 a.m.<br>Tomæ—©ä¸Š8ç‚¹èµ·åºŠã€‚</p><p>ä¸€èˆ¬å°†æ¥æ—¶<br>åŠ ä¸€ä¸ªè¯ï¼ŒåŠ¨è¯è¢«æ‰“å›åŸå½¢<br>He goes to the market.-&gt;He will go to the market.<br>ä»–å°†è¦å»å¸‚åœºã€‚<br>Will he go to the market?       è‹±è¯­å¿Œé‡å¤<br>ä»–å°†è¦å»å¸‚åœºå—ï¼Ÿ<br>When will he go to the market?<br>ä»–å°†åœ¨å•¥æ—¶å€™å»å¸‚åœºï¼Ÿ<br>Will&#x3D;ï¼ˆæƒ…æ€ï¼‰åŠ©åŠ¨è¯<br>She is my teacher.<br>å¥¹æ˜¯æˆ‘çš„è€å¸ˆã€‚<br>She will be my teacher.<br>ä»–å°†ä¼šæ˜¯æˆ‘çš„è€å¸ˆã€‚<br>æƒ…æ€åŠ©åŠ¨è¯&gt;å…¶ä»–æ‰€æœ‰åŠ¨è¯<br>Will she be my teacher?<br>ä»–å°†ä¼šæ˜¯æˆ‘çš„è€å¸ˆå—ï¼Ÿ</p><p>ä½ æ˜å¤©èƒ½æ¥æˆ‘å®¶å—ï¼Ÿ<br>Can you come to my home tomorrow?<br>è¿™åªçŒ«å°†ä¼šåƒæ‰è¿™æ¡é±¼ï¼Ÿ<br>The cat will eat this fish?<br>ä½ ä¼šå»å‚åŠ æˆ‘ä»¬çš„å©šç¤¼å—ï¼Ÿ<br>Will you attend our wedding?<br>Tomå°†ä¼šç•™åœ¨è¿™æ ‹æˆ¿å­é‡Œã€‚<br>Tom Will stay in the house .<br>æ²¡äººä¼šåŠ å…¥è¿™ä¸ªé˜Ÿä¼ã€‚<br>Nobody will join the team.</p>]]></content>
      
      
      <categories>
          
          <category> English </category>
          
      </categories>
      
      
        <tags>
            
            <tag> English </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½ æˆ‘ä»–ï¼ŒbeåŠ¨è¯</title>
      <link href="/2025/07/25/asp.net%20core/%E8%8B%B1%E8%AF%AD/%E4%BD%A0%E6%88%91%E4%BB%96%EF%BC%8Cbe%E5%8A%A8%E8%AF%8D/"/>
      <url>/2025/07/25/asp.net%20core/%E8%8B%B1%E8%AF%AD/%E4%BD%A0%E6%88%91%E4%BB%96%EF%BC%8Cbe%E5%8A%A8%E8%AF%8D/</url>
      
        <content type="html"><![CDATA[<p>ç¬¬ä¸€è¯¾</p><p>ä»–&#x3D;heã€him(ä¸»ã€å®¾) </p><p>He likes me.<br>ä»–å–œæ¬¢æˆ‘<br>I like him.<br>æˆ‘å–œæ¬¢ä»–<br>æˆ‘&#x3D;Iï¼Œme(ä¸»ã€å®¾) ä½ &#x3D;you(ä¸»ã€å®¾)</p><p>She likes me.<br>å¥¹å–œæ¬¢æˆ‘<br>I like her.<br>æˆ‘å–œæ¬¢å¥¹<br>å¥¹&#x3D;sheã€her(ä¸»ã€å®¾)</p><p>å®ƒ&#x3D;it(ä¸»ã€å®¾)</p><p>It likes me.<br>å®ƒå–œæ¬¢æˆ‘<br>I like it.<br>æˆ‘å–œæ¬¢å®ƒ</p><p>å•æ•°<br>ä»–&#x3D;heã€him(ä¸»ã€å®¾)<br>æˆ‘&#x3D;Iï¼Œme(ä¸»ã€å®¾) ä½ &#x3D;you(ä¸»ã€å®¾)<br>å¥¹&#x3D;sheã€her(ä¸»ã€å®¾)<br>å®ƒ&#x3D;it(ä¸»ã€å®¾)</p><p>å¤æ•°<br>æˆ‘ä»¬&#x3D;weã€us(ä¸»ã€å®¾)</p><p>We like you.<br>æˆ‘ä»¬å–œæ¬¢ä½ </p><p>You like us.<br>ä½ å–œæ¬¢æˆ‘ä»¬</p><p>ä½ ä»¬&#x3D;You</p><p>You like me.<br>ä½ ä»¬å–œæ¬¢æˆ‘</p><p>I like you.<br>æˆ‘å–œæ¬¢ä½ ä»¬</p><p>taä»¬&#x3D;theyã€them(ä¸»ã€å®¾)</p><p>They like him.<br>ä»–ä»¬å–œæ¬¢ä»–</p><p>He likes them.<br>æˆ‘å–œæ¬¢ä½ ä»¬</p><p>Like likes </p><p>he, she, it ä»–&#x3D;è°“+s</p><p>ç‹—&#x3D;dog<br>The dogs like me.<br>The dog likes me</p><p>ç¬¬ä¸€äººç§°ï¼šæˆ‘ï¼Œæˆ‘ä»¬<br>ç¬¬äºŒäººç§°ï¼šä½ ï¼Œä½ ä»¬<br>ç¬¬ä¸‰äººç§°ï¼šéç¬¬ä¸€ï¼Œç¬¬äºŒäººç§°ï¼Œç¬¬ä¸‰äººç§°å•æ•°&#x3D;è°“+s,ç»å¤§å¤šæ•°çš„è§„å¾‹ï¼ˆ&gt;90%ï¼‰</p><p>ç¬¬äºŒè¯¾<br>æˆ‘çš„ã€ä½ çš„ã€å®ƒçš„ï¼ˆå½¢å®¹è¯ï¼‰</p><p>æˆ‘çš„&#x3D;my<br>This is my apple.<br>è¿™æ˜¯æˆ‘çš„è‹¹æœã€‚</p><p>ä½ çš„&#x3D;your<br>This is your pear.<br>è¿™æ˜¯ä½ çš„æ¢¨ã€‚</p><p>ä»–çš„&#x3D;his<br>This is his bananan.</p><p>è¿™æ˜¯ä»–çš„é¦™è•‰ã€‚</p><p>å¥¹çš„&#x3D;her<br>This is her orange.<br>è¿™æ˜¯å¥¹çš„æ¡”å­</p><p>å®ƒçš„&#x3D;its<br>This is its fish.<br>è¿™æ˜¯å®ƒçš„é±¼ã€‚</p><p>å¤æ•°</p><p>æˆ‘ä»¬çš„&#x3D;our<br>This is our song.<br>è¿™æ˜¯æˆ‘ä»¬çš„æ­Œã€‚</p><p>ä½ ä»¬çš„&#x3D;your<br>This is your bed.<br>è¿™æ˜¯ä½ ä»¬çš„åºŠã€‚</p><p>taä»¬çš„&#x3D;their<br>This is their job.<br>è¿™æ˜¯ä»–ä»¬çš„å·¥ä½œã€‚</p><p>Apple&#x3D;è‹¹æœ pear&#x3D;æ¢¨ bananan&#x3D;é¦™è•‰ orange&#x3D;æ¡”å­ fish&#x3D;é±¼ song&#x3D;æ­Œ bed&#x3D;åºŠ job&#x3D;å·¥ä½œ bird&#x3D;é¸Ÿ</p><p>ä½ çš„ã€æˆ‘çš„ã€ä»–çš„ï¼ˆä¸œè¥¿ï¼‰ï¼ˆåè¯ï¼‰<br>This book is mine.<br>è¿™æœ¬ä¹¦æ˜¯æˆ‘çš„ã€‚<br>That book is your.<br>é‚£æœ¬ä¹¦æ˜¯ä½ çš„ã€‚<br>Your book is red ,and mine is blue.<br>ä½ çš„ä¹¦æ˜¯çº¢è‰²çš„ï¼Œè€Œæˆ‘çš„æ˜¯è“è‰²çš„</p><p>æˆ‘çš„&#x3D;my  æˆ‘çš„ï¼ˆä¸œè¥¿ï¼‰&#x3D;mine<br>ä»–çš„&#x3D;his  ä»–çš„ï¼ˆä¸œè¥¿ï¼‰&#x3D;his<br>å¥¹çš„&#x3D;her  å¥¹çš„ï¼ˆä¸œè¥¿ï¼‰&#x3D;hers<br>å®ƒçš„&#x3D;its  å®ƒçš„ï¼ˆä¸œè¥¿ï¼‰&#x3D;its<br>æˆ‘ä»¬çš„&#x3D;our&#x2F;ours<br>ä½ ä»¬çš„&#x3D;your&#x2F;yours<br>Taä»¬çš„&#x3D;their&#x2F;theirs</p><p>His apple is small ,but I like hers.<br>ä»–çš„è‹¹æœå¾ˆå°ï¼Œä½†æ˜¯æˆ‘å´å–œæ¬¢å¥¹çš„ã€‚<br>ç¬¬ä¸‰è¯¾<br>â€œbeåŠ¨è¯â€çš„åŸºæœ¬ç”¨æ³•<br>BeåŠ¨è¯&#x3D;â€œæ˜¯â€<br>I am a teacher.<br>æˆ‘æ˜¯ä¸€åè€å¸ˆã€‚<br>You are a student.<br>ä½ æ˜¯ä¸€åå­¦ç”Ÿã€‚</p><p>ä»–&#x2F;å¥¹&#x2F;å®ƒæ˜¯æ­Œæ‰‹<br>He&#x2F;she&#x2F;It is a singer.</p><p>Sing&#x3D;å”±ï¼ˆæ­Œï¼‰ singer&#x3D;æ­Œæ‰‹<br>er åšâ€¦çš„äºº&#x2F;æœºå™¨<br>Rice&#x3D;ç±³é¥­ cook&#x3D;åŠ¨è¯ï¼ˆç…®ï¼Œçƒ¹é¥ªï¼‰<br>Rice cooker&#x3D;ç±³é¥­çƒ¹é¥ªè€…&#x3D;ç”µé¥­é”…</p><p>We are dancers.    åè¯+s&#x3D;å¤æ•°&gt;&#x3D;2ä¸ª<br>æˆ‘ä»¬æ˜¯èˆè€…ã€‚</p><p>You are workers.<br>ä½ ä»¬æ˜¯å·¥äººã€‚ å·¥ä½œ&#x3D;åšå·¥ä½œçš„äºº å·¥ä½œ&#x3D;work(åŠ¨è¯) å·¥äºº&#x3D;worker</p><p>They are hunters.<br>Taä»¬æ˜¯çŒäºº   çŒæ•&#x3D;hunt  çŒäºº&#x3D;hunter</p><p>This apple is red.<br>è¿™ä¸ªè‹¹æœæ˜¯çº¢è‰²çš„ã€‚</p><p>These apples are red.<br>è¿™äº›è‹¹æœæ˜¯çº¢è‰²çš„ã€‚</p><p>BeåŠ¨è¯&#x3D;isï¼Œamï¼Œare<br>æˆ‘&#x3D;am<br>å•ä¸‰&#x3D;is<br>å…¶ä»–&#x3D;are<br>I am your teacher.<br>æˆ‘æ˜¯ä½ çš„è€å¸ˆã€‚<br>This dog is white.<br>è¿™åªç‹—æ˜¯ç™½è‰²çš„ã€‚<br>They are friend<br>ä»–ä»¬æ˜¯æœ‹å‹ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> English </category>
          
      </categories>
      
      
        <tags>
            
            <tag> English </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦å®šå¥çš„åº•å±‚åŸç†</title>
      <link href="/2025/07/25/asp.net%20core/%E8%8B%B1%E8%AF%AD/%E5%90%A6%E5%AE%9A%E5%8F%A5%E7%9A%84%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86/"/>
      <url>/2025/07/25/asp.net%20core/%E8%8B%B1%E8%AF%AD/%E5%90%A6%E5%AE%9A%E5%8F%A5%E7%9A%84%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86/</url>
      
        <content type="html"><![CDATA[<p>å¦å®šå¥çš„åº•å±‚åŸç†<br>åŠ©åŠ¨è¯+not<br>I ï¼ˆdoï¼‰like you.<br>æˆ‘å–œæ¬¢ä½ ã€‚<br>å¦å®šï¼šI do not like you. æˆ‘ä¸å–œæ¬¢ä½ <br>Do you like me?<br>Yes ,I do like you.(å¯ä»¥çœç•¥)<br>No ,I donâ€™t like you.<br>èƒ½çœè€Œä¸çœ&#x3D;&#x3D;å¼ºè°ƒ<br>I donâ€™t like you.</p><p>Do&#x3D;&#x3D;donâ€™t<br>Does&#x3D;&#x3D;doesnâ€™t<br>Did&#x3D;&#x3D;didnâ€™t</p><p>He is a teacher.<br>ä»–æ˜¯ä¸€ä¸ªè€å¸ˆã€‚<br>å¦å®šï¼šHe is not a teacher. ä»–ä¸æ˜¯ä¸€ä¸ªè€å¸ˆ<br>He isnâ€™t a teacher.</p><p>Is&#x3D; isnâ€™t<br>Am&#x3D;&#x3D;am not<br>Are&#x3D;&#x3D;arenâ€™t<br>Was&#x3D;&#x3D;wasnâ€™t<br>Were&#x3D;&#x3D;werenâ€™t</p><p>Marry will go to school.<br>Marryå°†è¦å»ä¸Šå­¦ã€‚<br>å¦å®šï¼šMarry will not go to school. Marryä¸ä¼šå»ä¸Šå­¦ã€‚<br>Marry wonâ€™t go to school.</p><p>Will&#x3D;&#x3D;wonâ€™t<br>Would&#x3D;&#x3D;wouldnâ€™t</p><p>May&#x3D;&#x3D;may not<br>Might&#x3D;&#x3D;might not</p><p>Can&#x3D;&#x3D;cannot, canâ€™t<br>Could&#x3D;&#x3D;couldnâ€™t</p><p>Should&#x3D; shouldnâ€™t<br>Shall&#x3D;&#x3D;shall not</p><p>Must&#x3D;&#x3D;mustnâ€™t</p><p>He has finished his homework.<br>ä»–å·²ç»åšå®Œä½œä¸šäº†ã€‚<br>å¦å®šï¼šHe has not finished his homework. ä»–è¿˜æ²¡å†™å®Œä½œä¸šã€‚<br>ç¼©åˆï¼šåŠ©åŠ¨è¯+nâ€™t<br>He hasnâ€™t finished his homework.</p><p>Have&#x3D;&#x3D;havenâ€™t<br>Has&#x3D;&#x3D;hasnâ€™t<br>Had&#x3D;&#x3D;hadnâ€™t</p><p>ä»–æ²¡æœ‰æ‰“ä½ ã€‚<br>He hits you&#x3D;&gt;he doesnâ€™t hit you.</p><p>æˆ‘ä¸èƒ½åšè¿™ä»½å·¥ä½œã€‚<br>I canâ€™t do this job.</p><p>å°æ˜è¿˜æ²¡å›ç­”è¿™ä¸ªé—®é¢˜ã€‚<br>Xiaoming hasnâ€™t answered the question.<br>ä»–æ²¡åœ¨çœ‹ç”µè§†ã€‚ï¼ˆç”¨è¿‡å»å¼ï¼‰<br>He wasnâ€™t watching TV.<br>ä»–æ²¡åœ¨çœ‹ç”µè§†å—ï¼Ÿ<br>Wasnâ€™t he watching TV?<br>å¸¦å¦å®šçš„ç–‘é—®å¥ï¼šåŠ©åŠ¨è¯ä¸€å®šè¦ç”¨â€œç¼©åˆå½¢å¼â€</p>]]></content>
      
      
      <categories>
          
          <category> English </category>
          
      </categories>
      
      
        <tags>
            
            <tag> English </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç°åœ¨å®Œæˆæ—¶ã€è¿‡å»å®Œæˆæ—¶</title>
      <link href="/2025/07/25/asp.net%20core/%E8%8B%B1%E8%AF%AD/%E7%8E%B0%E5%9C%A8%E5%AE%8C%E6%88%90%E6%97%B6%E3%80%81%E8%BF%87%E5%8E%BB%E5%AE%8C%E6%88%90%E6%97%B6/"/>
      <url>/2025/07/25/asp.net%20core/%E8%8B%B1%E8%AF%AD/%E7%8E%B0%E5%9C%A8%E5%AE%8C%E6%88%90%E6%97%B6%E3%80%81%E8%BF%87%E5%8E%BB%E5%AE%8C%E6%88%90%E6%97%B6/</url>
      
        <content type="html"><![CDATA[<p>ç°åœ¨å®Œæˆæ—¶<br>done&#x3D;è¿‡å»åˆ†è¯ï¼ˆå®Œæˆï¼‰éè°“è¯­<br>doing(è¡¨ç¤ºä¸€ä¸ªåŠ¨ä½œæ­£åœ¨è¿›è¡Œ)<br>ä½ å·²ç»åšå®ŒåŠŸè¯¾äº†ã€‚<br>You have done homework.<br>å•ä¸‰&#x3D;have-&gt;has<br>He has done homework.<br>Tomå·²ç»é”é—¨äº†ã€‚<br>Tom has locked the door.</p><p>è¿‡å»å®Œæˆæ—¶<br>Have-&gt;had<br>ä»–ä»¬å·²ç»æŠŠæ°´å–äº†ã€‚<br>They have done drunk the water.<br>æ˜¨å¤©ï¼Œä»–ä»¬å·²ç»æŠŠæ°´å–äº†ã€‚<br>Yesterday ,they had drunk the water.</p><p>å˜ä¸€èˆ¬ç–‘é—®å¥<br>Has Tom locked the door?</p><p>ç‰¹æ®Šç–‘é—®å¥<br>Why has Tom locked the door?</p><p>be åŠ¨è¯<br>beçš„è¿‡å»åˆ†è¯&#x3D;been<br>å¥¹æ˜¯ä¸€åè€å¸ˆã€‚<br>She is a teacher.<br>å¥¹å·²ç»æ˜¯ä¸€åè€å¸ˆäº†ã€‚<br>She has been a teacher.</p><p>è¿‡å»å¼ï¼Œè¿‡å»åˆ†è¯</p><p>Go&#x3D;went, gone  do&#x3D;did&#x3D;done<br>Be&#x3D;was&#x2F;were&#x3D;been  see&#x3D;saw&#x3D;seen<br>Sleep&#x3D;slept&#x3D;slept</p><p>Break æ‰“ç ´ï¼šbroke ,broken<br>Strike æ‰“å‡»ï¼šstroke ,stricken<br>Freeze å†°å†»ï¼šfroze .frozen<br>Eat åƒï¼šate ,eaten</p><p>Hit æ‰“ï¼šhit ,hit<br>Set è®¾ç½®ï¼šset ,set<br>Put æ”¾ï¼šput ,put<br>Drink å–ï¼šdrank ,drunk<br>Sing å”±ï¼šsang ,sung<br>Sink æ²‰æ²¡ï¼šsank ,sunk</p><p>Come æ¥ï¼šcame ,come<br>Become: æˆä¸ºï¼šbecame ,become<br>Stand ç«™ç«‹ï¼šstood ,stood<br>Understand æ‡‚ï¼šunderstood ,understood</p><p>è¿™åªçŒ«å·²ç»ç¡äº†3å°æ—¶äº†ã€‚<br>The cat has slept for 3 hours.<br>Marry å·²ç»æŠŠè¿™ä¸ªè‹¹æœåƒäº†å—ï¼Ÿ<br>Has Marry eaten the apple?<br>è¿™äº›äººæ˜¨å¤©7ç‚¹å°±æ¥åˆ°æˆ‘åŠå…¬å®¤äº†ã€‚<br>At 7 oâ€™clock yesterday, these people had come to my office.<br>å¥¹æŠŠæˆ‘çš„ä¹¦æ‹¿èµ°äº†ã€‚<br>She has taken my book.</p>]]></content>
      
      
      <categories>
          
          <category> English </category>
          
      </categories>
      
      
        <tags>
            
            <tag> English </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å®šè¯­ä»å¥2</title>
      <link href="/2025/07/25/asp.net%20core/%E8%8B%B1%E8%AF%AD/%E5%AE%9A%E8%AF%AD%E4%BB%8E%E5%8F%A52/"/>
      <url>/2025/07/25/asp.net%20core/%E8%8B%B1%E8%AF%AD/%E5%AE%9A%E8%AF%AD%E4%BB%8E%E5%8F%A52/</url>
      
        <content type="html"><![CDATA[<p>å®šè¯­ä»å¥2<br>Where ,when<br>å¥¹æ‰€ä½çš„æˆ¿å­å¾ˆå¤§ã€‚<br>1.æˆ¿å­å¾ˆå¤§ã€‚<br>The house is very big.<br>2.å¥¹ä½åœ¨è¿™æ ‹æˆ¿å­é‡Œã€‚<br>She lives in the house.&#x3D;&gt;which&#x2F;that she lives in.<br>The house which she lives in is very big.<br>The house in which she lives is very big.<br>In which&#x3D;&gt;where<br>Where&#x3D;ä»‹è¯+which(è¡¨åœ°ç‚¹)<br>Which&#x2F;that å‰é¢å¸¦ä»‹è¯ï¼Œæœ‰ä»£è¡¨åœ°ç‚¹å°±å¯ç”¨where<br>Inhabit&#x3D;å±…ä½ï¼ˆåŠç‰©åŠ¨è¯ï¼‰<br>She inhabits the house.&#x3D;&gt;which&#x2F;that she inhabits.</p><p>When&#x3D;ä»‹è¯+which(è¡¨æ—¶é—´)<br>æˆ‘ä»¬æ‰“ç¯®çƒçš„æ—¥å­å°±æ˜¯æˆ‘æ— æ³•å¿˜è®°çš„æ—¥å­ã€‚<br>1.æ—¥å­å°±æ˜¯æ—¥å­ã€‚<br>The days are the days.<br>2.æˆ‘ä»¬åœ¨é‚£äº›æ—¥å­é‡Œæ‰“ç¯®çƒã€‚<br>We played basketball on those days.&#x3D;&gt;which&#x2F;that<br>The days which we played basketball on is the days.<br>ä»‹è¯onæå‰whichä¹‹å‰&#x3D;&gt;when<br>3.æˆ‘æ— æ³•å¿˜è®°é‚£äº›æ—¥å­ã€‚<br>I canâ€™t forget those days.&#x3D;&gt;which&#x2F;that(åšå®¾è¯­å¯ä»¥çœç•¥)<br>The days when we played basketball is the days which I canâ€™t forget.</p><p>Why&#x3D;ä»‹è¯+which ï¼ˆè¡¨åŸå› ï¼‰<br>è¿™å°±æ˜¯æˆ‘æ‰“ä½ çš„åŸå› ã€‚<br>1.è¿™å°±æ˜¯åŸå› ã€‚<br>This is the reason.<br>2.æˆ‘ç”±äºè¿™ä¸ªåŸå› æ‰“ä½ ã€‚<br>I hit you for the reason.&#x3D;&gt;which&#x2F;that&#x3D;&gt;for which I hit you.&#x3D;&gt;why I hit you.<br>This is the reason why I hit you.</p><p>Whose&#x3D;è°çš„(äººæˆ–éäººéƒ½å¯ä»¥ç”¨)<br>æˆ‘å–œæ¬¢çª—æˆ·å¤§çš„æˆ¿å­ã€‚<br>1.æˆ‘å–œæ¬¢æˆ¿å­ã€‚<br>2.I like the house.<br>3.è¿™ä¸ªæˆ¿å­çª—æˆ·å¾ˆå¤§ã€‚<br>4.The houseâ€™s&#x3D;&gt;whose windows are very big.<br>5.I like the house whose windows are very big.</p><p>é™å®šæ€§ å®šè¯­ä»å¥<br>éé™å®šæ€§ å®šè¯­ä»å¥<br>1.This is my brother who lives in Shanghai.<br>2.è¿™æ˜¯æˆ‘ä½åœ¨ä¸Šæµ·çš„å“¥å“¥ã€‚é™å®š<br>3.This is my brother ,who lives in Shanghai.<br>4.è¿™æ˜¯æˆ‘çš„å“¥å“¥ï¼Œå¥¹ç°åœ¨ä½åœ¨ä¸Šæµ·ã€‚ éé™å®š</p><p>Thatåœ¨å®šä»ä¸èƒ½ç”¨çš„æƒ…å†µï¼š<br>1.å‰é¢å¸¦ä»‹è¯<br>2.éé™å®šä»</p><p>éé™å®šä»çš„å¼•å¯¼è¯ä¸èƒ½çœç•¥<br>1.Tom is very smart ,whichï¼ˆè¡¨å¸¦å‰é¢ä¸€æ•´å¥è¯ï¼‰ everybody knows.<br>2.Toméå¸¸çš„èªæ˜ï¼Œè¿™ä»¶äº‹æ˜¯æ‰€æœ‰äººéƒ½çŸ¥é“çš„<br>Tom is very smart, as everybody knows.</p><p>Which&#x2F;as  asé¢å¤–è¡¨ç¤ºâ€œæ­£å¦‚â€çš„æ„æ€</p><p>As everybody knows.&#x3D;&gt;çŠ¶è¯­<br>çŠ¶è¯­ï¼šéšä¾¿æ”¾ï¼ˆåªè¦è¯»å¾—é€šï¼‰<br>As everybody knows, Tom is very smart.<br>Tom ,which everybody knows, is very smart.<br>The apple, which everybody knows, is red.<br>Which everybody knows ,the apple is red. é”™<br>è®°å°‘ä¸è®°å¤šï¼šwhichä¸èƒ½æ”¾å¼€å¤´</p><p>ä½ æ‰€å¯¹è¯çš„é‚£ä¸ªäººæ˜¯æˆ‘å“¥å“¥ã€‚<br>You talk to the people ,The person is my brother.<br>The person whom you talk to is my brother.<br>æˆ‘ä»¬æ‰“ç¯®çƒçš„æ“åœºå¾ˆå¤§ã€‚<br>We play basketball on the playground ,The playground is very big.<br>The playground which we play basketball is very big<br>Marryæ˜¨å¤©çœ‹åˆ°çš„é‚£ä¸ªæ“åœºå¾ˆå°ã€‚<br>Marry saw the playground yesterday ,the playground is very small.<br>The playground which Marry saw yesterday is very small.<br>ä½ ä¸å…¶äº¤æœ‹å‹çš„é‚£ä¸ªæ˜¯æˆ‘å§å§ã€‚<br>You make friends with the person ,The person is my sister.<br>The person with whom you make friends is my sister.</p>]]></content>
      
      
      <categories>
          
          <category> English </category>
          
      </categories>
      
      
        <tags>
            
            <tag> English </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç°åœ¨è¿›è¡Œæ—¶ã€è¿‡å»è¿›è¡Œæ—¶</title>
      <link href="/2025/07/25/asp.net%20core/%E8%8B%B1%E8%AF%AD/%E7%8E%B0%E5%9C%A8%E8%BF%9B%E8%A1%8C%E6%97%B6%E3%80%81%E8%BF%87%E5%8E%BB%E8%BF%9B%E8%A1%8C%E6%97%B6/"/>
      <url>/2025/07/25/asp.net%20core/%E8%8B%B1%E8%AF%AD/%E7%8E%B0%E5%9C%A8%E8%BF%9B%E8%A1%8C%E6%97%B6%E3%80%81%E8%BF%87%E5%8E%BB%E8%BF%9B%E8%A1%8C%E6%97%B6/</url>
      
        <content type="html"><![CDATA[<p>ç°åœ¨è¿›è¡Œæ—¶<br>è¿›è¡Œæ—¶ï¼šè¯´è¯çš„åŒæ—¶ï¼Œä¸€ä¸ªåŠ¨ä½œæ­£åœ¨è¿›è¡Œä¹‹ä¸­ã€‚<br>éè°“è¯­ï¼šdoingï¼Œto do<br>ä¸€å¥ä¸€è°“<br>ä»–æ­£åœ¨çœ‹ç”µè§†ã€‚<br>He is watching TV.<br>è¿™ä¸ªå¥³å­©å¾ˆæ¼‚äº®ã€‚<br>This girl is very beautiful.<br>Tomæ­£åœ¨æ‰“ç¯®çƒã€‚<br>Tom is playing basketball.<br>Marryæ­£åœ¨è·³èˆã€‚<br>Marry is dancing.<br>Jackæ­£åº§åœ¨æ¤…å­ä¸Šã€‚<br>Jack is sitting on the chair.</p><p>They are coming to my home.<br>ä»–ä»¬å°†è¦æ¥æˆ‘å®¶ã€‚<br>Come&#x3D;çŸ­æš‚ï¼ˆéå»¶ç»­æ€§ï¼‰åŠ¨è¯<br>çŸ­æš‚åŠ¨è¯ing&#x3D;å°†æ¥<br>They are going to ride a bike.<br>ä»–ä»¬æ‰“ç®—éª‘è‡ªè¡Œè½¦ã€‚<br>Be going to do sth.è¡¨ç¤ºå°†æ¥ä¸willäº’æ¢å³å¯ã€‚<br>è¿‡å»è¿›è¡Œæ—¶<br>æ˜¨æ™š7ç‚¹ï¼ŒJeerryæ­£åœ¨åšåŠŸè¯¾ã€‚<br>At7:00 last night,Jery was doing homework.<br>They were leaving their country.<br>ä»–ä»¬æ›¾ç»æ‰“ç®—ç¦»å¼€ä»–ä»¬çš„å›½å®¶ã€‚</p><p>æˆ‘æ­£åœ¨çœ‹ä¹¦ã€‚<br>I am reading a book.<br>ä»–ä»¬æ­£åœ¨æ“åœºä¸Šè·‘æ­¥ã€‚<br>They are running on the playground.<br>å¥¹æ­£åœ¨æ•™å®¤é‡Œç”»ç”»ã€‚<br>She is drawing a picture in the classroom.<br>They are arriving in the airport.<br>å®ƒä»¬æ­£åœ¨åˆ°è¾¾æœºåœºä¸Šã€‚<br>æ˜¨å¤©ä¸‹åˆ3ç‚¹ï¼Œjerryå’Œmarryæ­£åœ¨æ‰“ä¹’ä¹“çƒã€‚<br>At 3:00 p.m. yesterday , jerry and marry were playing the ping pong.<br>é‚£ä¸ªæ—¶å€™ï¼Œå¥¹æ­£åœ¨å§å®¤é‡Œç¡è§‰ã€‚<br>At that time, she was sleeping in the bedroom.</p>]]></content>
      
      
      <categories>
          
          <category> English </category>
          
      </categories>
      
      
        <tags>
            
            <tag> English </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è‹±è¯­çš„æ„æˆã€å®šè¯­ä»å¥</title>
      <link href="/2025/07/25/asp.net%20core/%E8%8B%B1%E8%AF%AD/%E8%8B%B1%E8%AF%AD%E7%9A%84%E6%9E%84%E6%88%90%E3%80%81%E5%AE%9A%E8%AF%AD%E4%BB%8E%E5%8F%A5/"/>
      <url>/2025/07/25/asp.net%20core/%E8%8B%B1%E8%AF%AD/%E8%8B%B1%E8%AF%AD%E7%9A%84%E6%9E%84%E6%88%90%E3%80%81%E5%AE%9A%E8%AF%AD%E4%BB%8E%E5%8F%A5/</url>
      
        <content type="html"><![CDATA[<p>è‹±è¯­çš„æ„æˆã€å®šè¯­ä»å¥<br>å…­å¤§ä¿®é¥°æˆåˆ†ï¼š<br>åè¯ã€å½¢å®¹è¯ã€ä»‹è¯çŸ­è¯­ã€éè°“è¯­ã€å„ç§ä»å¥ã€å‰¯è¯</p><p>è‹±è¯­&#x3D;ä¸»å¹²+ä¿®é¥°</p><p>è¿™ä¸ªæˆ‘æ˜¨å¤©åœ¨å¸‚åœºä¹°çš„å°è‹¹æœåŸºæœ¬ä¸Šæ˜¯æ·±çº¢è‰²çš„ã€‚<br>This small apple that I bought from the market yesterday basically is dee p red.<br>From&#x3D;ä»<br>è‹±è¯­çš„å¥å­&#x3D;ä¸»å¥+ä»å¥<br>è‹±è¯­ä¿®é¥°æˆåˆ†&#x3D;å®šè¯­+çŠ¶è¯­<br>å®šè¯­&#x3D;ä¿®é¥°åè¯<br>çŠ¶è¯­&#x3D;ä¿®é¥°å…¶ä»–ï¼ˆå½¢å®¹è¯ã€åŠ¨è¯ã€æ•´ä¸ªå¥å­ã€å‰¯è¯<br>ï¼‰<br>å®šè¯­ä»å¥&#x3D;å……å½“å®šè¯­çš„ä»å¥<br>åç½®ä¿®é¥°</p><p>å®šäºä»å¥<br>è¿™ä¸ªæˆ‘æ˜¨å¤©åœ¨å¸‚åœºä¹°çš„è‹¹æœæ˜¯çº¢è‰²çš„ã€‚<br>1.è¿™ä¸ªè‹¹æœæ˜¯çº¢è‰²çš„ã€‚</p><ol><li>This apple is red.<br>2.æˆ‘æ˜¨å¤©åœ¨å¸‚åœºä¹°çš„+è‹¹æœ&#x3D;æˆ‘æ˜¨å¤©åœ¨å¸‚åœºä¹°äº†ä¸ªè‹¹æœã€‚</li><li>I bought an apple from the market yesterday<br>å¼•å¯¼è¯ï¼šwhich ,that ,who&#x2F;whom<br>Who&#x2F;whom(ä¸»&#x2F;å®¾)&#x3D;æŒ‡ä»£â€œäººâ€<br>Which&#x3D;æŒ‡ä»£â€œç‰©â€ã€â€œå¥å­ï¼ˆéäººï¼‰â€<br>That&#x3D;ä¸‡èƒ½ï¼ˆé™¤äº†â€œå¥å­â€éƒ½å¯ä»¥æŒ‡ä»£ï¼‰<br>that I bought from the market yesterday.</li></ol><p>This apple that(å¯çœç•¥)ï¼ˆèƒ½çœè€Œä¸çœï¼‰ I bought from the market yesterday is red.<br>2. è¿™ä¸ªç«™åœ¨æ ‘ä¸‹çš„ç”·è¿˜æ˜¯æˆ‘å“¥å“¥</p><ol><li>è¿™ä¸ªç”·å­©æ˜¯æˆ‘å“¥å“¥ã€‚<br>This boy is my brother.</li><li>ç«™åœ¨æ ‘ä¸‹çš„+ç”·å­©&#x3D;è¿™ä¸ªç”·å­©ç«™åœ¨æ ‘ä¸‹ã€‚<br>This boy stands under the tree.&#x3D;&gt;who&#x2F;that stands under the tree.</li></ol><p>This boy who&#x2F;that stands under the tree is my brother.</p><p>Tom æ˜¨å¤©åƒçš„è‹¹æœæ˜¯é»„è‰²çš„ã€‚</p><ol><li>the apple is yellow.<br>2.tomæ˜¨å¤©åƒäº†è‹¹æœ<br>Tom ate the apple yesterday.<br>The apple that tom ate yesterday is yellow.<br>Marryå°±æ˜¯ä½ æ‰€çˆ±çš„äººã€‚<br>1.marry å°±æ˜¯äºº<br>Marry is the person<br>2.ä½ çˆ±çš„+äºº<br>You love person.<br>Marry is the person who you love<br>ä½ æ˜å¤©å»è§é¢çš„é‚£ä¸ªäººæ˜¯æˆ‘å§å§ã€‚<br>1.é‚£ä¸ªäººæ˜¯æˆ‘å§å§<br>There person is my sister.</li><li>ä½ æ˜å¤©å»è§é¢çš„+é‚£ä¸ªäºº<br>You to meet there person tomorrow<br>That you to meet tomorrow there person is my sister.<br>æˆ‘è®¤è¯†è¿™æ¡æ­£åº§åœ¨åœ°ä¸Šçš„ç‹—ã€‚<br>1.æˆ‘è®¤è¯†è¿™æ¡ç‹—ã€‚<br>I know this dog.</li><li>æ­£åº§åœ¨åœ°ä¸Šçš„+ç‹—ã€‚&#x3D;&gt;ç‹—ååœ¨åœ°ä¸Š<br>Dog is siting on the ground.<br>I know this dog that is siting on the ground.</li></ol>]]></content>
      
      
      <categories>
          
          <category> English </category>
          
      </categories>
      
      
        <tags>
            
            <tag> English </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ElasticSearch</title>
      <link href="/2025/07/17/asp.net%20core/%E5%AD%A6%E8%8B%B1%E8%AF%AD%E7%BD%91%E7%AB%99%E9%A1%B9%E7%9B%AE/Elasticsearch/"/>
      <url>/2025/07/17/asp.net%20core/%E5%AD%A6%E8%8B%B1%E8%AF%AD%E7%BD%91%E7%AB%99%E9%A1%B9%E7%9B%AE/Elasticsearch/</url>
      
        <content type="html"><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯ElasticSearch"><a href="#ä»€ä¹ˆæ˜¯ElasticSearch" class="headerlink" title="ä»€ä¹ˆæ˜¯ElasticSearch"></a>ä»€ä¹ˆæ˜¯ElasticSearch</h1><p>Elasticsearch æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„æœç´¢ä¸åˆ†æå¼•æ“ï¼Œä¸“é—¨ç”¨äºå¤„ç†å¤§è§„æ¨¡æ•°æ®çš„å…¨æ–‡æœç´¢ã€ç»“æ„åŒ–æŸ¥è¯¢ã€æ—¥å¿—åˆ†æå’Œå®æ—¶æ•°æ®å¯è§†åŒ–ç­‰åœºæ™¯ã€‚å®ƒæ˜¯ Elasticsearch Stackï¼ˆåŸ ELK Stackï¼‰ çš„æ ¸å¿ƒç»„ä»¶ï¼Œå’Œ Logstashã€Kibana ä¸€èµ·å¹¿æ³›åº”ç”¨äºæ—¥å¿—æ”¶é›†å’Œåˆ†æç³»ç»Ÿä¸­ã€‚</p><h2 id="æ ¸å¿ƒç‰¹ç‚¹"><a href="#æ ¸å¿ƒç‰¹ç‚¹" class="headerlink" title="æ ¸å¿ƒç‰¹ç‚¹"></a>æ ¸å¿ƒç‰¹ç‚¹</h2><p>å…¨æ–‡æœç´¢æ”¯æŒåˆ†è¯ã€æ¨¡ç³ŠåŒ¹é…ã€ç›¸å…³æ€§æ‰“åˆ†ç­‰å¼ºå¤§çš„å…¨æ–‡æ£€ç´¢åŠŸèƒ½ã€‚</p><p>åˆ†å¸ƒå¼æ¶æ„å¯ä»¥æ¨ªå‘æ‰©å±•ï¼Œæ”¯æŒäº¿çº§æ•°æ®çš„å¿«é€Ÿè¯»å†™å’ŒæŸ¥è¯¢ã€‚</p><p>å®æ—¶åˆ†ææ”¯æŒå¯¹æ•°æ®çš„å®æ—¶èšåˆã€è¿‡æ»¤ã€ç»Ÿè®¡åˆ†æã€‚<br>RESTful APIæ“ä½œåŸºäº HTTP çš„ JSON è¯·æ±‚ï¼Œæ˜“äºé›†æˆã€‚</p><p>å¼ºå¤§çš„æŸ¥è¯¢ DSLæä¾›åŸºäº JSON çš„æŸ¥è¯¢è¯­æ³•ï¼Œæ”¯æŒå¸ƒå°”ã€èŒƒå›´ã€æ¨¡ç³Šã€åœ°ç†ã€èšåˆç­‰å¤šç§æŸ¥è¯¢æ–¹å¼ã€‚</p><h2 id="Elasticsearchå·¥ä½œåŸç†"><a href="#Elasticsearchå·¥ä½œåŸç†" class="headerlink" title="Elasticsearchå·¥ä½œåŸç†"></a>Elasticsearchå·¥ä½œåŸç†</h2><p>æ•°æ®å†™å…¥æµç¨‹:            æœç´¢æŸ¥è¯¢æµç¨‹:<br>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<br>â”‚  å®¢æˆ·ç«¯   â”‚             â”‚   å®¢æˆ·ç«¯    â”‚<br>â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜<br>     â”‚ HTTP&#x2F;JSON                â”‚ HTTP&#x2F;JSON<br>     â–¼                          â–¼<br>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<br>â”‚ Elasticsearchâ”‚           â”‚ Elasticsearch â”‚<br>â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜<br>     â”‚ åˆ†ç‰‡åˆ†å‘                    â”‚ æŸ¥è¯¢è·¯ç”±<br>     â–¼                            â–¼<br>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<br>â”‚ å€’æ’ç´¢å¼•æ„å»ºâ”‚              â”‚ å€’æ’ç´¢å¼•æŸ¥æ‰¾â”‚<br>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</p><h2 id="æ ¸å¿ƒæ¦‚å¿µå…ˆæŒæ¡"><a href="#æ ¸å¿ƒæ¦‚å¿µå…ˆæŒæ¡" class="headerlink" title="æ ¸å¿ƒæ¦‚å¿µå…ˆæŒæ¡"></a>æ ¸å¿ƒæ¦‚å¿µå…ˆæŒæ¡</h2><p>æ–‡æ¡£ï¼ˆDocumentï¼‰Elasticsearch ä¸­çš„æœ€å°æ•°æ®å•å…ƒï¼ˆå¦‚ä¸€æ¡å•†å“ä¿¡æ¯ï¼‰ï¼ŒJSONæ ¼å¼<br>ç´¢å¼•ï¼ˆIndexï¼‰ä¸€ç»„ç±»ä¼¼æ–‡æ¡£çš„é›†åˆï¼Œç›¸å½“äºæ•°æ®åº“ä¸­çš„è¡¨<br>åˆ†ç‰‡ï¼ˆShardï¼‰ç´¢å¼•è¢«åˆ†æˆçš„ç‰©ç†å­˜å‚¨å•ä½ï¼Œåˆ†å¸ƒåœ¨ä¸åŒèŠ‚ç‚¹<br>å€’æ’ç´¢å¼•å®ç°å…¨æ–‡æœç´¢çš„å…³é”®æ•°æ®ç»“æ„<br>èŠ‚ç‚¹ï¼ˆNodeï¼‰Elasticsearch é›†ç¾¤ä¸­çš„å•ä¸ªæœåŠ¡å™¨å®ä¾‹<br>é›†ç¾¤ï¼ˆClusterï¼‰ä¸€ç»„ Elasticsearch èŠ‚ç‚¹ç»„æˆï¼Œæä¾›ç»Ÿä¸€æœåŠ¡</p><h2 id="æ•°æ®å†™å…¥ï¼ˆç´¢å¼•ï¼‰è¿‡ç¨‹"><a href="#æ•°æ®å†™å…¥ï¼ˆç´¢å¼•ï¼‰è¿‡ç¨‹" class="headerlink" title="æ•°æ®å†™å…¥ï¼ˆç´¢å¼•ï¼‰è¿‡ç¨‹"></a>æ•°æ®å†™å…¥ï¼ˆç´¢å¼•ï¼‰è¿‡ç¨‹</h2><p>å®¢æˆ·ç«¯æäº¤ JSON æ•°æ®ï¼ˆDocumentï¼‰</p><p>é€‰æ‹©ç›®æ ‡ç´¢å¼•ï¼ˆå¦‚ï¼šproductsï¼‰</p><p>è·¯ç”±ç®—æ³•å†³å®šå†™å…¥å“ªä¸ªä¸»åˆ†ç‰‡ï¼ˆPrimary Shardï¼‰</p><p>å­—æ®µç»è¿‡åˆ†æå™¨ï¼ˆAnalyzerï¼‰å¤„ç† â†’ åˆ†è¯ã€å»åœç”¨è¯</p><p>æ„å»ºå€’æ’ç´¢å¼•ï¼šè¯ â†’ æ–‡æ¡£ ID æ˜ å°„</p><p>ä¸»åˆ†ç‰‡å†™å…¥å®Œæˆåï¼ŒåŒæ­¥å†™å…¥å‰¯æœ¬åˆ†ç‰‡ï¼ˆReplicaï¼‰</p><h2 id="æ•°æ®æŸ¥è¯¢ï¼ˆæœç´¢ï¼‰è¿‡ç¨‹"><a href="#æ•°æ®æŸ¥è¯¢ï¼ˆæœç´¢ï¼‰è¿‡ç¨‹" class="headerlink" title="æ•°æ®æŸ¥è¯¢ï¼ˆæœç´¢ï¼‰è¿‡ç¨‹"></a>æ•°æ®æŸ¥è¯¢ï¼ˆæœç´¢ï¼‰è¿‡ç¨‹</h2><p>å®¢æˆ·ç«¯å‘èµ·æŸ¥è¯¢ï¼ˆDSL &#x2F; RESTï¼‰</p><p>åè°ƒèŠ‚ç‚¹ï¼ˆé€šå¸¸æ˜¯æ¥æ”¶è¯·æ±‚çš„èŠ‚ç‚¹ï¼‰è§£ææŸ¥è¯¢</p><p>è·¯ç”±åˆ°æ‰€æœ‰æ¶‰åŠçš„åˆ†ç‰‡ï¼ˆä¸»åˆ†ç‰‡æˆ–å‰¯æœ¬åˆ†ç‰‡ï¼‰æ‰§è¡ŒæŸ¥è¯¢</p><p>æ¯ä¸ªåˆ†ç‰‡æ‰§è¡Œå€’æ’ç´¢å¼•æœç´¢ï¼Œè®¡ç®—åŒ¹é…åº¦</p><p>æ±‡æ€»æ‰€æœ‰åˆ†ç‰‡çš„ç»“æœï¼ŒæŒ‰ç›¸å…³æ€§æ’åº</p><p>å°†æœ€ç»ˆç»“æœè¿”å›ç»™å®¢æˆ·ç«¯</p><h2 id="å€’æ’ç´¢å¼•æœºåˆ¶ï¼ˆå…¨æ–‡æœç´¢æ ¸å¿ƒï¼‰"><a href="#å€’æ’ç´¢å¼•æœºåˆ¶ï¼ˆå…¨æ–‡æœç´¢æ ¸å¿ƒï¼‰" class="headerlink" title="å€’æ’ç´¢å¼•æœºåˆ¶ï¼ˆå…¨æ–‡æœç´¢æ ¸å¿ƒï¼‰"></a>å€’æ’ç´¢å¼•æœºåˆ¶ï¼ˆå…¨æ–‡æœç´¢æ ¸å¿ƒï¼‰</h2><p>ç¤ºä¾‹ï¼š<br>æˆ‘ä»¬æœ‰ä¸‰ä¸ªæ–‡æ¡£ï¼š</p><p>IDå†…å®¹<br>1æˆ‘å–œæ¬¢è‹¹æœæ‰‹æœº<br>2è‹¹æœæ‰‹æœºå¾ˆå¥½ç”¨<br>3åä¸ºæ‰‹æœºä¹Ÿä¸é”™</p><p>åˆ†è¯åï¼š<br>è‹¹æœ â†’ [1, 2]<br>æ‰‹æœº â†’ [1, 2, 3]<br>åä¸º â†’ [3]</p><p>è¿™å°±å½¢æˆäº†â€œå…³é”®è¯ â†’ æ–‡æ¡£åˆ—è¡¨â€çš„å€’æ’ç´¢å¼•ç»“æ„ï¼Œæœç´¢â€œè‹¹æœ æ‰‹æœºâ€æ—¶å¯å¿«é€Ÿå®šä½æ–‡æ¡£ 1 å’Œ 2ã€‚</p><h2 id="åˆ†å¸ƒå¼æ¶æ„çš„å·¥ä½œæ–¹å¼"><a href="#åˆ†å¸ƒå¼æ¶æ„çš„å·¥ä½œæ–¹å¼" class="headerlink" title="åˆ†å¸ƒå¼æ¶æ„çš„å·¥ä½œæ–¹å¼"></a>åˆ†å¸ƒå¼æ¶æ„çš„å·¥ä½œæ–¹å¼</h2><p>æ¯ä¸ªç´¢å¼•ç”±è‹¥å¹²ä¸ª ä¸»åˆ†ç‰‡ï¼ˆPrimary Shardï¼‰ å’Œ å‰¯æœ¬åˆ†ç‰‡ï¼ˆReplica Shardï¼‰ ç»„æˆã€‚</p><p>æŸ¥è¯¢è¯·æ±‚å¯ä»¥ç”±ä¸»åˆ†ç‰‡æˆ–å‰¯æœ¬åˆ†ç‰‡ä»»æ„å“åº”ï¼Œå†™å…¥åªèƒ½åˆ°ä¸»åˆ†ç‰‡ã€‚</p><p>åˆ†ç‰‡åˆ†å¸ƒåœ¨ä¸åŒèŠ‚ç‚¹ä¸Šï¼Œæ”¯æŒé«˜å¯ç”¨å’Œæ°´å¹³æ‰©å±•ã€‚</p><p>ç¤ºä¾‹ï¼ˆproducts ç´¢å¼•ï¼‰ï¼š</p><p>åˆ†ç‰‡ç±»å‹åˆ†ç‰‡ç¼–å·æ‰€åœ¨èŠ‚ç‚¹<br>ä¸»åˆ†ç‰‡shard-0Node-A<br>å‰¯æœ¬åˆ†ç‰‡shard-0Node-B</p><h2 id="è¿‘å®æ—¶ç‰¹æ€§ï¼ˆNRTï¼‰"><a href="#è¿‘å®æ—¶ç‰¹æ€§ï¼ˆNRTï¼‰" class="headerlink" title="è¿‘å®æ—¶ç‰¹æ€§ï¼ˆNRTï¼‰"></a>è¿‘å®æ—¶ç‰¹æ€§ï¼ˆNRTï¼‰</h2><p>Elasticsearch æ˜¯<strong>è¿‘å®æ—¶ï¼ˆNear Real Timeï¼‰</strong>ç³»ç»Ÿï¼š</p><p>æ–‡æ¡£å†™å…¥åï¼Œä¸æ˜¯ç«‹å³å¯æœç´¢çš„ã€‚</p><p>é»˜è®¤æ¯éš” 1 ç§’ ä¼šåˆ·æ–°ï¼ˆrefreshï¼‰ï¼Œä½¿æ–°æ•°æ®å¯è§ã€‚</p><p>å¯æ‰‹åŠ¨è°ƒç”¨ POST &#x2F;index&#x2F;_refresh å¼ºåˆ¶åˆ·æ–°ã€‚</p><p>æ€»ç»“å…³é”®ç‚¹<br>ç¯èŠ‚æŠ€æœ¯åŸç†<br>å†™å…¥åˆ†ç‰‡è·¯ç”± + åˆ†è¯ + å€’æ’ç´¢å¼•æ„å»º<br>æŸ¥è¯¢åˆ†ç‰‡å¹¶è¡Œ + å€’æ’ç´¢å¼•æœç´¢ + èšåˆæ±‡æ€»<br>æ‰©å±•å¤šèŠ‚ç‚¹å¤šåˆ†ç‰‡è‡ªåŠ¨è´Ÿè½½å‡è¡¡<br>å®æ—¶æ€§é»˜è®¤ 1 ç§’åˆ·æ–°ï¼Œè¿‘å®æ—¶å¯æŸ¥</p><h1 id="å®‰è£…ElasticSearch"><a href="#å®‰è£…ElasticSearch" class="headerlink" title="å®‰è£…ElasticSearch"></a>å®‰è£…ElasticSearch</h1><p>æ‰“å¼€æµè§ˆå™¨è®¿é—®å®˜æ–¹ä¸‹è½½é¡µé¢ï¼š<br><a href="https://www.elastic.co/downloads/elasticsearch">https://www.elastic.co/downloads/elasticsearch</a></p><p>æ‰¾åˆ°æœ€æ–°ç‰ˆï¼ˆå¦‚ 9.0.3ï¼‰ï¼Œç‚¹å‡» Windows zip (x86_64) ç‰ˆæœ¬ä¸‹è½½ã€‚<br>æ–‡ä»¶ç¤ºä¾‹ï¼šelasticsearch-9.0.3-windows-x86_64.zip</p><p><img src="/img%5C%E7%BD%91%E5%9D%80%5C6.png"></p><h2 id="é…ç½®ç¯å¢ƒå˜é‡"><a href="#é…ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="é…ç½®ç¯å¢ƒå˜é‡"></a>é…ç½®ç¯å¢ƒå˜é‡</h2><p><img src="/img%5C%E7%BD%91%E5%9D%80%5C12.png"></p><h2 id="å¯åŠ¨-Elasticsearch-æœåŠ¡"><a href="#å¯åŠ¨-Elasticsearch-æœåŠ¡" class="headerlink" title="å¯åŠ¨ Elasticsearch æœåŠ¡"></a>å¯åŠ¨ Elasticsearch æœåŠ¡</h2><p>æ–¹æ³• 1ï¼šå‘½ä»¤è¡Œå¯åŠ¨ï¼ˆæ¨èç”¨äºå¼€å‘ï¼‰<br>æ‰“å¼€ PowerShell æˆ– CMDï¼ˆä»¥ç®¡ç†å‘˜èº«ä»½ï¼‰</p><p><img src="/img%5C%E7%BD%91%E5%9D%80%5C7.png"><br>è¿›å…¥ bin ç›®å½•ï¼š</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> E:\elastic<span class="built_in">search-9</span>.<span class="number">0.3</span><span class="literal">-windows-x86_64</span>\elastic<span class="built_in">search-9</span>.<span class="number">0.3</span>\bin</span><br></pre></td></tr></table></figure><p><img src="/!%5B%5D(img%5C%E7%BD%91%E5%9D%80%5C8.png)"></p><p>æ‰§è¡Œå¯åŠ¨å‘½ä»¤ï¼š</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">.\elasticsearch.bat</span><br></pre></td></tr></table></figure><p>å¯åŠ¨è¿‡ç¨‹æç¤ºï¼ˆé¦–æ¬¡è¿è¡Œå¯èƒ½æ˜¾ç¤ºï¼‰ï¼š<br>ç”Ÿæˆé»˜è®¤å¯†ç </p><p>è‡ªåŠ¨å¯ç”¨å®‰å…¨æ€§ï¼ˆElastic ç”¨æˆ·åæ˜¯ elasticï¼Œå¯†ç ä¼šæ˜¾ç¤ºåœ¨æ§åˆ¶å°ï¼‰<br>ä¸€å®šè¦å¤åˆ¶ä¿å­˜å¥½åˆå§‹å¯†ç ï¼</p><h2 id="éªŒè¯æœåŠ¡æ˜¯å¦å¯åŠ¨æˆåŠŸ"><a href="#éªŒè¯æœåŠ¡æ˜¯å¦å¯åŠ¨æˆåŠŸ" class="headerlink" title="éªŒè¯æœåŠ¡æ˜¯å¦å¯åŠ¨æˆåŠŸ"></a>éªŒè¯æœåŠ¡æ˜¯å¦å¯åŠ¨æˆåŠŸ</h2><p>æ–¹æ³• 1ï¼šæµè§ˆå™¨è®¿é—®æµ‹è¯•<br>æ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥ï¼š</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//localhost:9200</span></span><br></pre></td></tr></table></figure><p>ä½ åº”è¯¥ä¼šçœ‹åˆ°å¦‚ä¸‹ JSONï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;DESKTOP-ABC123&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;cluster_name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;elasticsearch&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;number&quot;</span><span class="punctuation">:</span> <span class="string">&quot;9.0.3&quot;</span><span class="punctuation">,</span></span><br><span class="line">    ...</span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;tagline&quot;</span><span class="punctuation">:</span> <span class="string">&quot;You Know, for Search&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>æ–¹æ³• 2ï¼šå‘½ä»¤è¡Œæµ‹è¯•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -u elastic http://localhost:9200</span><br></pre></td></tr></table></figure><h2 id="æŸ¥çœ‹é»˜è®¤ç”¨æˆ·åå’Œå¯†ç "><a href="#æŸ¥çœ‹é»˜è®¤ç”¨æˆ·åå’Œå¯†ç " class="headerlink" title="æŸ¥çœ‹é»˜è®¤ç”¨æˆ·åå’Œå¯†ç "></a>æŸ¥çœ‹é»˜è®¤ç”¨æˆ·åå’Œå¯†ç </h2><p>Elasticsearch 9.x é»˜è®¤å¯ç”¨å®‰å…¨è®¤è¯ï¼Œåˆå§‹ç”¨æˆ·ä¸ºï¼š</p><p>ç”¨æˆ·åå¯†ç <br>elasticå¯åŠ¨æ—¶åœ¨æ§åˆ¶å°ç”Ÿæˆï¼ˆæˆ– logs ä¸­æ‰¾ï¼‰</p><p>å¯é€šè¿‡å¦‚ä¸‹æ–‡ä»¶æŸ¥çœ‹å¯†ç ï¼š</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">E:\elasticsearch<span class="number">-9.0</span><span class="number">.3</span>-windows-x86_64\elasticsearch<span class="number">-9.0</span><span class="number">.3</span>\<span class="built_in">log</span>\elasticsarch.<span class="built_in">log</span></span><br></pre></td></tr></table></figure><p>æœç´¢å…³é”®è¯ generated passwordã€‚</p><h2 id="é…ç½®æ–‡ä»¶è·¯å¾„è¯´æ˜ï¼ˆå¯é€‰ä¿®æ”¹ï¼‰"><a href="#é…ç½®æ–‡ä»¶è·¯å¾„è¯´æ˜ï¼ˆå¯é€‰ä¿®æ”¹ï¼‰" class="headerlink" title="é…ç½®æ–‡ä»¶è·¯å¾„è¯´æ˜ï¼ˆå¯é€‰ä¿®æ”¹ï¼‰"></a>é…ç½®æ–‡ä»¶è·¯å¾„è¯´æ˜ï¼ˆå¯é€‰ä¿®æ”¹ï¼‰</h2><p>è·¯å¾„ï¼šE:\elasticsearch-9.0.3-windows-x86_64\elasticsearch-9.0.3\config\elasticsearch.yml</p><p>å¯é…ç½®å†…å®¹ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">cluster.name:</span> <span class="string">my-cluster</span></span><br><span class="line"><span class="attr">node.name:</span> <span class="string">node-1</span></span><br><span class="line"><span class="attr">path.data:</span> <span class="string">D:\esdata</span></span><br><span class="line"><span class="attr">path.logs:</span> <span class="string">D:\eslogs</span></span><br><span class="line"></span><br><span class="line"><span class="attr">network.host:</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>     <span class="comment"># å…è®¸å¤–éƒ¨è®¿é—®</span></span><br><span class="line"><span class="attr">http.port:</span> <span class="number">9200</span></span><br><span class="line"></span><br><span class="line"><span class="attr">xpack.security.enabled:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h2 id="å…³é—­æœåŠ¡çš„æ–¹æ³•"><a href="#å…³é—­æœåŠ¡çš„æ–¹æ³•" class="headerlink" title="å…³é—­æœåŠ¡çš„æ–¹æ³•"></a>å…³é—­æœåŠ¡çš„æ–¹æ³•</h2><p>åœ¨æ§åˆ¶å°æŒ‰ä¸‹ï¼š</p><p>Ctrl + C<br>æˆ–å…³é—­ PowerShell çª—å£å³å¯ã€‚</p><h2 id="ElasticSearchä¸€äº›é—®é¢˜"><a href="#ElasticSearchä¸€äº›é—®é¢˜" class="headerlink" title="ElasticSearchä¸€äº›é—®é¢˜"></a>ElasticSearchä¸€äº›é—®é¢˜</h2><h3 id="ä¸€ä¸ªå¼‚å¸¸received-plaintext-http-traffic-on-an-https"><a href="#ä¸€ä¸ªå¼‚å¸¸received-plaintext-http-traffic-on-an-https" class="headerlink" title="ä¸€ä¸ªå¼‚å¸¸received plaintext http traffic on an https"></a>ä¸€ä¸ªå¼‚å¸¸received plaintext http traffic on an https</h3><p><img src="/img%5C%E7%BD%91%E5%9D%80%5C10.png"></p><h3 id="åŸå› åˆ†æ"><a href="#åŸå› åˆ†æ" class="headerlink" title="åŸå› åˆ†æ"></a>åŸå› åˆ†æ</h3><p>æ—¥å¿—çº§åˆ«ä¸ºWARNï¼Œè¡¨ç¤ºæœ‰å¼‚å¸¸æƒ…å†µ<br>æ—¥å¿—æ¥è‡ªo.e.h.n.<br>Netty4HttpServerTransportï¼Œå³Elasticsearchçš„HTTPæœåŠ¡å™¨ç»„ä»¶<br>æ—¥å¿—å†…å®¹æç¤ºâ€received plaintext http traffic on an https channelâ€ï¼Œå³åœ¨HTTPSé€šé“ä¸Šæ¥æ”¶åˆ°äº†æ˜æ–‡HTTPæµé‡<br>Elasticsearchçš„åº”å¯¹æªæ–½æ˜¯â€closing connectionâ€ï¼Œå³å…³é—­äº†è¿™ä¸ªè¿æ¥<br>æ‰€ä»¥å¯ä»¥åˆ¤æ–­ï¼ŒElasticsearchæœåŠ¡å™¨æœŸæœ›å®¢æˆ·ç«¯ä½¿ç”¨HTTPSå‘é€è¯·æ±‚ï¼Œä½†å®é™…æ”¶åˆ°çš„æ˜¯æ˜æ–‡HTTPè¯·æ±‚ï¼Œå› æ­¤æ‹’ç»äº†è¿™äº›è¯·æ±‚ã€‚</p><p>åŒæ—¶æ—¥å¿—ä¸­ä¹Ÿæåˆ°äº†è¯·æ±‚çš„æºåœ°å€å’Œç›®æ ‡åœ°å€ï¼Œè¿™é‡Œéƒ½æ˜¯[0:0:0:0:0:0:0:1]ï¼Œå³IPv6ç¯å›åœ°å€ï¼Œç›¸å½“äºIPv4çš„127.0.0.1ï¼Œè¡¨ç¤ºè¯·æ±‚æ¥è‡ªæœ¬æœºã€‚ç›®æ ‡ç«¯å£ä¸º9200ï¼Œå³Elasticsearchçš„é»˜è®¤ç«¯å£ã€‚</p><h2 id="æ–¹æ¡ˆä¸€ï¼ˆä½¿ç”¨HTTPSï¼‰"><a href="#æ–¹æ¡ˆä¸€ï¼ˆä½¿ç”¨HTTPSï¼‰" class="headerlink" title="æ–¹æ¡ˆä¸€ï¼ˆä½¿ç”¨HTTPSï¼‰"></a>æ–¹æ¡ˆä¸€ï¼ˆä½¿ç”¨HTTPSï¼‰</h2><p>ä½¿ç”¨HTTPSåè®®è®¿é—®Elasticsearchè€Œä¸æ˜¯HTTPã€‚<br>ä¹‹å‰ä½ PUTè®¿é—®çš„æ˜¯<a href="http://localhost:9200ï¼Œç°åœ¨å°†è®¾ä½ å¦‚å°†è¯·æ±‚çš„URLæ”¹ä¸ºhttps://localhost:9200ï¼Œå¹¶ç¡®ä¿Elasticsearché…ç½®äº†æ­£ç¡®çš„SSLè¯ä¹¦ã€‚å¼€å‘ç¯å¢ƒä¸‹å¯ä»¥ç›´æ¥è¯·æ±‚ã€‚">http://localhost:9200ï¼Œç°åœ¨å°†è®¾ä½ å¦‚å°†è¯·æ±‚çš„URLæ”¹ä¸ºhttps://localhost:9200ï¼Œå¹¶ç¡®ä¿Elasticsearché…ç½®äº†æ­£ç¡®çš„SSLè¯ä¹¦ã€‚å¼€å‘ç¯å¢ƒä¸‹å¯ä»¥ç›´æ¥è¯·æ±‚ã€‚</a></p><h3 id="èº«ä»½éªŒè¯"><a href="#èº«ä»½éªŒè¯" class="headerlink" title="èº«ä»½éªŒè¯"></a>èº«ä»½éªŒè¯</h3><p>ä½†æ˜¯ç”¨httpsä¼šå¼¹å‡ºelasticSearchçœä»½éªŒè¯ã€‚</p><p>Elasticsearch 9.0.3 çš„å†…ç½®ç”¨æˆ·åŒ…æ‹¬ï¼š</p><p>elasticï¼šè¶…çº§ç®¡ç†å‘˜ç”¨æˆ·ï¼Œæ‹¥æœ‰æ‰€æœ‰æƒé™ã€‚<br>kibana_systemï¼šKibana ç”¨äºä¸ Elasticsearch é€šä¿¡çš„ç”¨æˆ·ã€‚<br>logstash_systemï¼šLogstash ç”¨äºä¸ Elasticsearch é€šä¿¡çš„ç”¨æˆ·ã€‚<br>beats_systemï¼šBeats ç”¨äºä¸ Elasticsearch é€šä¿¡çš„ç”¨æˆ·ã€‚</p><p>ä½¿ç”¨ elasticsearch-reset-password å·¥å…·ï¼ˆæ¨èï¼‰<br>è‹¥è¦é‡ç½® elastic ç”¨æˆ·çš„å¯†ç ï¼Œå¯æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿›å…¥Elasticsearch binç›®å½•</span></span><br><span class="line"><span class="built_in">cd</span> /path/to/elasticsearch/bin</span><br><span class="line"></span><br><span class="line"><span class="comment"># äº¤äº’å¼é‡ç½®å¯†ç ï¼ˆä¼šæç¤ºè¾“å…¥æ–°å¯†ç ï¼‰</span></span><br><span class="line">./elasticsearch-reset-password -u elastic</span><br><span class="line"></span><br><span class="line"><span class="comment"># æˆ–è‡ªåŠ¨ç”Ÿæˆéšæœºå¯†ç å¹¶æ˜¾ç¤ºï¼ˆéäº¤äº’å¼ï¼‰</span></span><br><span class="line">./elasticsearch-reset-password -u elastic --batch</span><br></pre></td></tr></table></figure><p><img src="/img%5C%E7%BD%91%E5%9D%80%5C13.png"></p><p>æµè§ˆå™¨æµ‹è¯•<a href="https://localhost:9200/">https://localhost:9200</a><br><img src="/img%5C%E7%BD%91%E5%9D%80%5C14.png"></p>]]></content>
      
      
      <categories>
          
          <category> ElasticSearch </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ElasticSearch </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nginx</title>
      <link href="/2025/07/15/asp.net%20core/%E5%AD%A6%E8%8B%B1%E8%AF%AD%E7%BD%91%E7%AB%99%E9%A1%B9%E7%9B%AE/Nginx/"/>
      <url>/2025/07/15/asp.net%20core/%E5%AD%A6%E8%8B%B1%E8%AF%AD%E7%BD%91%E7%AB%99%E9%A1%B9%E7%9B%AE/Nginx/</url>
      
        <content type="html"><![CDATA[<h2 id="å®‰è£…Nginx"><a href="#å®‰è£…Nginx" class="headerlink" title="å®‰è£…Nginx"></a>å®‰è£…Nginx</h2><p>ç¬¬ä¸€æ­¥ï¼š</p><p>ä¸‹è½½Nginx: <a href="https://nginx.p2hp.com/">https://nginx.p2hp.com/</a></p><p><img src="/img%5C%E7%BD%91%E5%9D%80%5C1.png"><br>é€‰æ‹©å¯¹åº”ç‰ˆæœ¬</p><p>ç¬¬äºŒæ­¥ï¼š</p><p>Nginxçš„ä½¿ç”¨</p><p>æˆ‘ä»¬çš„å¸¸ç”¨é…ç½®åªéœ€è¦åœ¨nginx.confä¸­ã€‚</p><p><img src="/img%5C%E7%BD%91%E5%9D%80%5C2.png"></p><p><img src="/img%5C%E7%BD%91%E5%9D%80%5C3.png"><br>å¯ä»¥çœ‹åˆ°Nginxé»˜è®¤é…ç½®çš„ç«¯å£å·æ˜¯ 80</p><p>ç¬¬ä¸‰æ­¥ï¼š</p><p>Nginxå¯åŠ¨æ–¹å¼</p><p>é€šè¿‡å‘½ä»¤è¡Œå¯åŠ¨</p><p>åœ¨nginxå®‰è£…ç›®å½•çš„ç»å¯¹è·¯å¾„çš„æ¡†æ¡†å†…è¾“å…¥ cmdï¼Œç›´æ¥è¾“å…¥ nginx æˆ–è€… start nginxï¼Œç„¶åå›è½¦ï¼Œå°±å¯ä»¥å¯åŠ¨nginxäº†ã€‚</p><p>ï¼windowsé˜²ç«å¢™è¦å…è®¸nginxè®¿é—®ç½‘ç»œã€‚</p><p><img src="/img%5C%E7%BD%91%E5%9D%80%5C4.png"></p><p>ç„¶ååœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥ localhost</p><p><img src="/img%5C%E7%BD%91%E5%9D%80%5C5.png"><br>å¦‚æœèƒ½çœ‹åˆ°è¿™ä¸ªé¡µé¢ï¼Œé‚£ä¹ˆnginxå¯åŠ¨å°±æˆåŠŸäº†ã€‚<br>å…³é—­nginxçš„å‘½ä»¤ï¼šnginx -s stop</p>]]></content>
      
      
      <categories>
          
          <category> Nginx </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Gitä½¿ç”¨</title>
      <link href="/2025/07/03/git/"/>
      <url>/2025/07/03/git/</url>
      
        <content type="html"><![CDATA[<h1 id="Gitç®€ä»‹"><a href="#Gitç®€ä»‹" class="headerlink" title="Gitç®€ä»‹"></a>Gitç®€ä»‹</h1><p>Git æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œç”¨æ¥ç®¡ç†ä»£ç æˆ–ä»»ä½•æ–‡ä»¶çš„ç‰ˆæœ¬å†å²ã€‚</p><p>å¸¸ç”¨äºåä½œå¼€å‘ï¼Œæ”¯æŒåˆ†æ”¯ã€åˆå¹¶ã€å›æ»šç­‰æ“ä½œã€‚</p><h2 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h2><p>å†Windowsä¸Šå®‰è£…Gitã€‚<br>å®˜ç½‘ä¸‹è½½ï¼š<a href="https://git-scm.com/download/win">https://git-scm.com/download/win</a><br>å®‰è£…ä¹‹åï¼Œå°±å¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œgitå·¥å…·äº†ã€‚<br>åœ¨å¼€å§‹èœå•é‡Œæ‰¾åˆ° â€œGitâ€-&gt;â€Git Bashâ€ï¼Œä¼šå¼¹å‡º Git å‘½ä»¤çª—å£ï¼Œä½ å¯ä»¥åœ¨è¯¥çª—å£è¿›è¡Œ Git æ“ä½œã€‚</p><h2 id="Gité…ç½®"><a href="#Gité…ç½®" class="headerlink" title="Gité…ç½®"></a>Gité…ç½®</h2><h3 id="åŸºæœ¬èº«ä»½é…ç½®"><a href="#åŸºæœ¬èº«ä»½é…ç½®" class="headerlink" title="åŸºæœ¬èº«ä»½é…ç½®"></a>åŸºæœ¬èº«ä»½é…ç½®</h3><p>åœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨ Git æ—¶ï¼Œå…ˆé…ç½®ç”¨æˆ·åå’Œé‚®ç®±ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name <span class="string">&quot;ä½ çš„åå­—&quot;</span></span><br><span class="line">git config --global user.email <span class="string">&quot;ä½ çš„é‚®ç®±@example.com&quot;</span></span><br></pre></td></tr></table></figure><p>è¿™ä¼šæŠŠé…ç½®å†™å…¥ ~&#x2F;.gitconfig æ–‡ä»¶ï¼Œå¹¶å¯¹æ‰€æœ‰ä»“åº“ç”Ÿæ•ˆã€‚å¦‚æœåªæƒ³å¯¹å½“å‰ä»“åº“æœ‰æ•ˆï¼Œå»æ‰ â€“globalã€‚</p><h3 id="æŸ¥çœ‹é…ç½®"><a href="#æŸ¥çœ‹é…ç½®" class="headerlink" title="æŸ¥çœ‹é…ç½®"></a>æŸ¥çœ‹é…ç½®</h3><p>æŸ¥çœ‹æ‰€æœ‰å½“å‰ç”Ÿæ•ˆçš„é…ç½®é¡¹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --list</span><br></pre></td></tr></table></figure><h1 id="Gitå¸¸ç”¨å‘½ä»¤"><a href="#Gitå¸¸ç”¨å‘½ä»¤" class="headerlink" title="Gitå¸¸ç”¨å‘½ä»¤"></a>Gitå¸¸ç”¨å‘½ä»¤</h1><h2 id="ä»“åº“æ“ä½œ"><a href="#ä»“åº“æ“ä½œ" class="headerlink" title="ä»“åº“æ“ä½œ"></a>ä»“åº“æ“ä½œ</h2><p>åˆå§‹åŒ–ä¸€ä¸ªæ–°ä»“åº“</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br></pre></td></tr></table></figure><h3 id="å…‹éš†è¿œç¨‹ä»“åº“"><a href="#å…‹éš†è¿œç¨‹ä»“åº“" class="headerlink" title="å…‹éš†è¿œç¨‹ä»“åº“"></a>å…‹éš†è¿œç¨‹ä»“åº“</h3><p>å…‹éš†è¿œç¨‹ä»“åº“</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> &lt;ä»“åº“åœ°å€&gt;</span><br></pre></td></tr></table></figure><h2 id="æ–‡ä»¶è¿½è¸ª"><a href="#æ–‡ä»¶è¿½è¸ª" class="headerlink" title="æ–‡ä»¶è¿½è¸ª"></a>æ–‡ä»¶è¿½è¸ª</h2><h3 id="æŸ¥çœ‹å½“å‰çŠ¶æ€"><a href="#æŸ¥çœ‹å½“å‰çŠ¶æ€" class="headerlink" title="æŸ¥çœ‹å½“å‰çŠ¶æ€"></a>æŸ¥çœ‹å½“å‰çŠ¶æ€</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git status</span><br></pre></td></tr></table></figure><h3 id="æ·»åŠ æ–‡ä»¶åˆ°æš‚å­˜åŒº"><a href="#æ·»åŠ æ–‡ä»¶åˆ°æš‚å­˜åŒº" class="headerlink" title="æ·»åŠ æ–‡ä»¶åˆ°æš‚å­˜åŒº"></a>æ·»åŠ æ–‡ä»¶åˆ°æš‚å­˜åŒº</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git add &lt;æ–‡ä»¶æˆ–ç›®å½•&gt;</span><br></pre></td></tr></table></figure><h3 id="æ·»åŠ å…¨éƒ¨æ”¹åŠ¨ï¼š"><a href="#æ·»åŠ å…¨éƒ¨æ”¹åŠ¨ï¼š" class="headerlink" title="æ·»åŠ å…¨éƒ¨æ”¹åŠ¨ï¼š"></a>æ·»åŠ å…¨éƒ¨æ”¹åŠ¨ï¼š</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git add .</span><br></pre></td></tr></table></figure><h3 id="ä»æš‚å­˜åŒºç§»é™¤æ–‡ä»¶"><a href="#ä»æš‚å­˜åŒºç§»é™¤æ–‡ä»¶" class="headerlink" title="ä»æš‚å­˜åŒºç§»é™¤æ–‡ä»¶"></a>ä»æš‚å­˜åŒºç§»é™¤æ–‡ä»¶</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reset HEAD &lt;æ–‡ä»¶&gt;</span><br></pre></td></tr></table></figure><h2 id="æäº¤"><a href="#æäº¤" class="headerlink" title="æäº¤"></a>æäº¤</h2><h3 id="æäº¤åˆ°æœ¬åœ°ä»“åº“"><a href="#æäº¤åˆ°æœ¬åœ°ä»“åº“" class="headerlink" title="æäº¤åˆ°æœ¬åœ°ä»“åº“"></a>æäº¤åˆ°æœ¬åœ°ä»“åº“</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit -m <span class="string">&quot;æäº¤ä¿¡æ¯&quot;</span></span><br></pre></td></tr></table></figure><h3 id="ä¿®æ”¹ä¸Šä¸€æ¬¡æäº¤ï¼ˆæ¯”å¦‚æ¼æ–‡ä»¶ã€æ”¹ä¿¡æ¯ï¼‰"><a href="#ä¿®æ”¹ä¸Šä¸€æ¬¡æäº¤ï¼ˆæ¯”å¦‚æ¼æ–‡ä»¶ã€æ”¹ä¿¡æ¯ï¼‰" class="headerlink" title="ä¿®æ”¹ä¸Šä¸€æ¬¡æäº¤ï¼ˆæ¯”å¦‚æ¼æ–‡ä»¶ã€æ”¹ä¿¡æ¯ï¼‰"></a>ä¿®æ”¹ä¸Šä¸€æ¬¡æäº¤ï¼ˆæ¯”å¦‚æ¼æ–‡ä»¶ã€æ”¹ä¿¡æ¯ï¼‰</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit --amend</span><br></pre></td></tr></table></figure><h2 id="æ—¥å¿—æŸ¥çœ‹"><a href="#æ—¥å¿—æŸ¥çœ‹" class="headerlink" title="æ—¥å¿—æŸ¥çœ‹"></a>æ—¥å¿—æŸ¥çœ‹</h2><h3 id="æŸ¥çœ‹æäº¤å†å²"><a href="#æŸ¥çœ‹æäº¤å†å²" class="headerlink" title="æŸ¥çœ‹æäº¤å†å²"></a>æŸ¥çœ‹æäº¤å†å²</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span></span><br></pre></td></tr></table></figure><h3 id="ç®€æ´å•è¡Œæ˜¾ç¤ºï¼š"><a href="#ç®€æ´å•è¡Œæ˜¾ç¤ºï¼š" class="headerlink" title="ç®€æ´å•è¡Œæ˜¾ç¤ºï¼š"></a>ç®€æ´å•è¡Œæ˜¾ç¤ºï¼š</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span> --oneline</span><br></pre></td></tr></table></figure><h2 id="åˆ†æ”¯ç®¡ç†"><a href="#åˆ†æ”¯ç®¡ç†" class="headerlink" title="åˆ†æ”¯ç®¡ç†"></a>åˆ†æ”¯ç®¡ç†</h2><h3 id="æŸ¥çœ‹åˆ†æ”¯"><a href="#æŸ¥çœ‹åˆ†æ”¯" class="headerlink" title="æŸ¥çœ‹åˆ†æ”¯"></a>æŸ¥çœ‹åˆ†æ”¯</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch</span><br></pre></td></tr></table></figure><h3 id="æ–°å»ºåˆ†æ”¯"><a href="#æ–°å»ºåˆ†æ”¯" class="headerlink" title="æ–°å»ºåˆ†æ”¯"></a>æ–°å»ºåˆ†æ”¯</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch &lt;åˆ†æ”¯å&gt;</span><br></pre></td></tr></table></figure><h3 id="åˆ‡æ¢åˆ†æ”¯"><a href="#åˆ‡æ¢åˆ†æ”¯" class="headerlink" title="åˆ‡æ¢åˆ†æ”¯"></a>åˆ‡æ¢åˆ†æ”¯</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout &lt;åˆ†æ”¯å&gt;</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºå¹¶åˆ‡æ¢æ–°åˆ†æ”¯"><a href="#åˆ›å»ºå¹¶åˆ‡æ¢æ–°åˆ†æ”¯" class="headerlink" title="åˆ›å»ºå¹¶åˆ‡æ¢æ–°åˆ†æ”¯"></a>åˆ›å»ºå¹¶åˆ‡æ¢æ–°åˆ†æ”¯</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout -b &lt;åˆ†æ”¯å&gt;</span><br></pre></td></tr></table></figure><h3 id="åˆ é™¤åˆ†æ”¯"><a href="#åˆ é™¤åˆ†æ”¯" class="headerlink" title="åˆ é™¤åˆ†æ”¯"></a>åˆ é™¤åˆ†æ”¯</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -d &lt;åˆ†æ”¯å&gt;</span><br></pre></td></tr></table></figure><h2 id="åˆå¹¶ä¸å˜åŸº"><a href="#åˆå¹¶ä¸å˜åŸº" class="headerlink" title="åˆå¹¶ä¸å˜åŸº"></a>åˆå¹¶ä¸å˜åŸº</h2><h3 id="åˆå¹¶åˆ†æ”¯åˆ°å½“å‰åˆ†æ”¯"><a href="#åˆå¹¶åˆ†æ”¯åˆ°å½“å‰åˆ†æ”¯" class="headerlink" title="åˆå¹¶åˆ†æ”¯åˆ°å½“å‰åˆ†æ”¯"></a>åˆå¹¶åˆ†æ”¯åˆ°å½“å‰åˆ†æ”¯</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git merge &lt;åˆ†æ”¯å&gt;</span><br></pre></td></tr></table></figure><h3 id="äº¤äº’å¼å˜åŸºï¼ˆæ•´ç†æäº¤å†å²ï¼‰"><a href="#äº¤äº’å¼å˜åŸºï¼ˆæ•´ç†æäº¤å†å²ï¼‰" class="headerlink" title="äº¤äº’å¼å˜åŸºï¼ˆæ•´ç†æäº¤å†å²ï¼‰"></a>äº¤äº’å¼å˜åŸºï¼ˆæ•´ç†æäº¤å†å²ï¼‰</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rebase -i HEAD~N</span><br></pre></td></tr></table></figure><h2 id="è¿œç¨‹æ“ä½œ"><a href="#è¿œç¨‹æ“ä½œ" class="headerlink" title="è¿œç¨‹æ“ä½œ"></a>è¿œç¨‹æ“ä½œ</h2><h3 id="æ·»åŠ è¿œç¨‹ä»“åº“"><a href="#æ·»åŠ è¿œç¨‹ä»“åº“" class="headerlink" title="æ·»åŠ è¿œç¨‹ä»“åº“"></a>æ·»åŠ è¿œç¨‹ä»“åº“</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote add origin &lt;ä»“åº“åœ°å€&gt;</span><br></pre></td></tr></table></figure><h3 id="æŸ¥çœ‹è¿œç¨‹åœ°å€"><a href="#æŸ¥çœ‹è¿œç¨‹åœ°å€" class="headerlink" title="æŸ¥çœ‹è¿œç¨‹åœ°å€"></a>æŸ¥çœ‹è¿œç¨‹åœ°å€</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote -v</span><br></pre></td></tr></table></figure><h3 id="æ¨é€åˆ°è¿œç¨‹åˆ†æ”¯"><a href="#æ¨é€åˆ°è¿œç¨‹åˆ†æ”¯" class="headerlink" title="æ¨é€åˆ°è¿œç¨‹åˆ†æ”¯"></a>æ¨é€åˆ°è¿œç¨‹åˆ†æ”¯</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push origin &lt;åˆ†æ”¯å&gt;</span><br></pre></td></tr></table></figure><h3 id="æ‹‰å–è¿œç¨‹æ›´æ–°å¹¶åˆå¹¶"><a href="#æ‹‰å–è¿œç¨‹æ›´æ–°å¹¶åˆå¹¶" class="headerlink" title="æ‹‰å–è¿œç¨‹æ›´æ–°å¹¶åˆå¹¶"></a>æ‹‰å–è¿œç¨‹æ›´æ–°å¹¶åˆå¹¶</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull</span><br></pre></td></tr></table></figure><h3 id="è·å–è¿œç¨‹æ›´æ–°ä½†ä¸åˆå¹¶"><a href="#è·å–è¿œç¨‹æ›´æ–°ä½†ä¸åˆå¹¶" class="headerlink" title="è·å–è¿œç¨‹æ›´æ–°ä½†ä¸åˆå¹¶"></a>è·å–è¿œç¨‹æ›´æ–°ä½†ä¸åˆå¹¶</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git fetch</span><br></pre></td></tr></table></figure><h2 id="æ’¤é”€ä¸æ¢å¤"><a href="#æ’¤é”€ä¸æ¢å¤" class="headerlink" title="æ’¤é”€ä¸æ¢å¤"></a>æ’¤é”€ä¸æ¢å¤</h2><h3 id="ä¸¢å¼ƒå·¥ä½œåŒºæ”¹åŠ¨ï¼ˆæ…ç”¨ï¼‰"><a href="#ä¸¢å¼ƒå·¥ä½œåŒºæ”¹åŠ¨ï¼ˆæ…ç”¨ï¼‰" class="headerlink" title="ä¸¢å¼ƒå·¥ä½œåŒºæ”¹åŠ¨ï¼ˆæ…ç”¨ï¼‰"></a>ä¸¢å¼ƒå·¥ä½œåŒºæ”¹åŠ¨ï¼ˆæ…ç”¨ï¼‰</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout -- &lt;æ–‡ä»¶&gt;</span><br></pre></td></tr></table></figure><h3 id="å›åˆ°æœ€è¿‘ä¸€æ¬¡æäº¤çŠ¶æ€"><a href="#å›åˆ°æœ€è¿‘ä¸€æ¬¡æäº¤çŠ¶æ€" class="headerlink" title="å›åˆ°æœ€è¿‘ä¸€æ¬¡æäº¤çŠ¶æ€"></a>å›åˆ°æœ€è¿‘ä¸€æ¬¡æäº¤çŠ¶æ€</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reset --hard</span><br></pre></td></tr></table></figure><h3 id="æ’¤é”€æœ€è¿‘çš„æäº¤ï¼ˆä¿ç•™æ”¹åŠ¨åœ¨å·¥ä½œåŒºï¼‰"><a href="#æ’¤é”€æœ€è¿‘çš„æäº¤ï¼ˆä¿ç•™æ”¹åŠ¨åœ¨å·¥ä½œåŒºï¼‰" class="headerlink" title="æ’¤é”€æœ€è¿‘çš„æäº¤ï¼ˆä¿ç•™æ”¹åŠ¨åœ¨å·¥ä½œåŒºï¼‰"></a>æ’¤é”€æœ€è¿‘çš„æäº¤ï¼ˆä¿ç•™æ”¹åŠ¨åœ¨å·¥ä½œåŒºï¼‰</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git reset --soft HEAD~1</span><br></pre></td></tr></table></figure><h1 id="Gitåˆ›å»ºä»“åº“"><a href="#Gitåˆ›å»ºä»“åº“" class="headerlink" title="Gitåˆ›å»ºä»“åº“"></a>Gitåˆ›å»ºä»“åº“</h1><ol><li><p>æŠŠå·¥ä½œç›®å½•åˆ‡æ¢åˆ°é¡¹ç›®æ‰€åœ¨ä½ç½®ï¼Œè¦æ˜¯é¡¹ç›®ç›®å½•ä¸å­˜åœ¨ï¼Œå°±å…ˆåˆ›å»ºä¸€ä¸ªã€‚</p></li><li><p>æ‰§è¡Œgit initå‘½ä»¤ï¼Œå¯¹ Git ä»“åº“è¿›è¡Œåˆå§‹åŒ–ã€‚</p></li><li><p>æŠŠæ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒºï¼Œä½¿ç”¨git addå‘½ä»¤ã€‚</p></li><li><p>è¿›è¡Œé¦–æ¬¡æäº¤ï¼Œä½¿ç”¨git commit -m â€œInitial commitâ€å‘½ä»¤ã€‚</p></li><li><p>æŸ¥çœ‹ä»“åº“çŠ¶æ€ï¼Œä½¿ç”¨git status</p></li></ol><p>ä»¥ä¸‹æ˜¯å…·ä½“çš„æ“ä½œç¤ºä¾‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ–°å»ºé¡¹ç›®ç›®å½•ï¼ˆè‹¥ç›®å½•å·²å­˜åœ¨åˆ™è·³è¿‡æ­¤æ­¥ï¼‰</span></span><br><span class="line"><span class="built_in">mkdir</span> myproject</span><br><span class="line"><span class="built_in">cd</span> myproject</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå§‹åŒ–Gitä»“åº“</span></span><br><span class="line">git init</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºæ–‡ä»¶å¹¶æ·»åŠ å†…å®¹</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Hello, Git!&quot;</span> &gt; README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ æ–‡ä»¶åˆ°æš‚å­˜åŒº</span></span><br><span class="line">git add README.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># æäº¤åˆ°æœ¬åœ°ä»“åº“</span></span><br><span class="line">git commit -m <span class="string">&quot;Initial commit&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹ä»“åº“çŠ¶æ€</span></span><br><span class="line">git status</span><br></pre></td></tr></table></figure><h2 id="å…³è”è¿œç¨‹ä»“åº“"><a href="#å…³è”è¿œç¨‹ä»“åº“" class="headerlink" title="å…³è”è¿œç¨‹ä»“åº“"></a>å…³è”è¿œç¨‹ä»“åº“</h2><p>è‹¥è¦å°†æœ¬åœ°ä»“åº“ä¸è¿œç¨‹ä»“åº“ï¼ˆä¾‹å¦‚ GitHubï¼‰è¿›è¡Œå…³è”ï¼Œå¯æŒ‰ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š</p><ol><li>åœ¨è¿œç¨‹å¹³å°ä¸Šåˆ›å»ºä¸€ä¸ªç©ºä»“åº“ã€‚</li><li>åœ¨æœ¬åœ°ä»“åº“ä¸­æ·»åŠ è¿œç¨‹ä»“åº“åœ°å€ã€‚</li><li>å°†æœ¬åœ°åˆ†æ”¯æ¨é€åˆ°è¿œç¨‹ä»“åº“ã€‚</li></ol><p>å…·ä½“å‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ·»åŠ è¿œç¨‹ä»“åº“åœ°å€</span></span><br><span class="line">git remote add origin https://github.com/</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨é€æœ¬åœ°masteråˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“</span></span><br><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure><h2 id="ä»è¿œç¨‹ä»“åº“å…‹éš†"><a href="#ä»è¿œç¨‹ä»“åº“å…‹éš†" class="headerlink" title="ä»è¿œç¨‹ä»“åº“å…‹éš†"></a>ä»è¿œç¨‹ä»“åº“å…‹éš†</h2><p>å½“éœ€è¦è·å–è¿œç¨‹ä»“åº“çš„å‰¯æœ¬æ—¶ï¼Œå¯ä»¥ä½¿ç”¨git cloneå‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/</span><br></pre></td></tr></table></figure><p>è¿™äº›éƒ½æ˜¯ Git çš„åŸºç¡€æ“ä½œï¼Œåœ¨å®é™…çš„å¼€å‘æµç¨‹ä¸­ï¼Œè¿˜ä¼šæ¶‰åŠåˆ†æ”¯ç®¡ç†ã€æ‹‰å–æ›´æ–°ç­‰æ›´å¤šæ“ä½œã€‚</p><p><img src="/img%5Cgit-2.png"></p><p>workspaceï¼šå·¥ä½œåŒº<br>staging areaï¼šæš‚å­˜åŒº&#x2F;ç¼“å­˜åŒº<br>local repositoryï¼šç‰ˆæœ¬åº“æˆ–æœ¬åœ°ä»“åº“<br>remote repositoryï¼šè¿œç¨‹ä»“åº“</p><h1 id="Gitåˆ†æ”¯ç®¡ç†"><a href="#Gitåˆ†æ”¯ç®¡ç†" class="headerlink" title="Gitåˆ†æ”¯ç®¡ç†"></a>Gitåˆ†æ”¯ç®¡ç†</h1><p>Git çš„åˆ†æ”¯ç®¡ç†æ˜¯å…¶æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€ï¼Œå®ƒå…è®¸å¼€å‘è€…åœ¨åŒä¸€ä»“åº“ä¸­å¹¶è¡Œå¼€å‘å¤šä¸ªç‰¹æ€§æˆ–ä¿®å¤ bugï¼Œè€Œä¸å½±å“ä¸»åˆ†æ”¯çš„ä»£ç ã€‚ä»¥ä¸‹æ˜¯å…³äº Git åˆ†æ”¯ç®¡ç†çš„è¯¦ç»†ä»‹ç»ï¼š</p><ol><li>åˆ†æ”¯çš„åŸºæœ¬æ¦‚å¿µ</li></ol><p>ä»€ä¹ˆæ˜¯åˆ†æ”¯ï¼Ÿ</p><p>åˆ†æ”¯æ˜¯æŒ‡å‘æäº¤å¯¹è±¡çš„å¯å˜æŒ‡é’ˆã€‚Git çš„é»˜è®¤åˆ†æ”¯åä¸ºmasterï¼ˆæˆ–mainï¼‰ï¼Œæ¯æ¬¡æäº¤æ—¶ï¼Œå½“å‰åˆ†æ”¯æŒ‡é’ˆä¼šå‘å‰ç§»åŠ¨ã€‚<br>åˆ†æ”¯æœ¬è´¨ï¼šä¸€ä¸ªè½»é‡çº§çš„å¯ç§»åŠ¨å¼•ç”¨ï¼Œå­˜å‚¨åœ¨.git&#x2F;refs&#x2F;heads&#x2F;ç›®å½•ä¸‹ã€‚<br>åˆ†æ”¯çš„ä¼˜åŠ¿<br>å¹¶è¡Œå¼€å‘ï¼šåŒæ—¶è¿›è¡Œå¤šä¸ªç‰¹æ€§å¼€å‘æˆ– bug ä¿®å¤ã€‚<br>éš”ç¦»é£é™©ï¼šåœ¨åˆ†æ”¯ä¸Šçš„ä¿®æ”¹ä¸ä¼šå½±å“ä¸»åˆ†æ”¯ï¼Œç›´åˆ°åˆå¹¶å®Œæˆã€‚<br>ç®€åŒ–åä½œï¼šå›¢é˜Ÿæˆå‘˜å¯ä»¥åœ¨ç‹¬ç«‹åˆ†æ”¯ä¸Šå·¥ä½œï¼Œå‡å°‘å†²çªã€‚<br>2. åˆ†æ”¯çš„åŸºæœ¬æ“ä½œ</p><p>æŸ¥çœ‹åˆ†æ”¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git branch            <span class="comment"># æŸ¥çœ‹æœ¬åœ°åˆ†æ”¯</span></span><br><span class="line">git branch -r         <span class="comment"># æŸ¥çœ‹è¿œç¨‹åˆ†æ”¯</span></span><br><span class="line">git branch -a         <span class="comment"># æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯ï¼ˆæœ¬åœ°+è¿œç¨‹ï¼‰</span></span><br><span class="line">git branch -vv        <span class="comment"># æŸ¥çœ‹åˆ†æ”¯å…³è”çš„è¿œç¨‹åˆ†æ”¯åŠæœ€åæäº¤ä¿¡æ¯</span></span><br></pre></td></tr></table></figure><p>åˆ›å»ºåˆ†æ”¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git branch &lt;åˆ†æ”¯å&gt;   <span class="comment"># åˆ›å»ºæ–°åˆ†æ”¯ï¼ˆä¸åˆ‡æ¢ï¼‰</span></span><br><span class="line">git checkout -b &lt;åˆ†æ”¯å&gt;  <span class="comment"># åˆ›å»ºå¹¶åˆ‡æ¢åˆ°æ–°åˆ†æ”¯</span></span><br><span class="line">git checkout -b &lt;åˆ†æ”¯å&gt; &lt;æäº¤å“ˆå¸Œ&gt;  <span class="comment"># ä»æŒ‡å®šæäº¤åˆ›å»ºåˆ†æ”¯</span></span><br></pre></td></tr></table></figure><p>åˆ‡æ¢åˆ†æ”¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git checkout &lt;åˆ†æ”¯å&gt;  <span class="comment"># åˆ‡æ¢åˆ°å·²å­˜åœ¨çš„åˆ†æ”¯</span></span><br><span class="line">git switch &lt;åˆ†æ”¯å&gt;    <span class="comment"># Git 2.23+ æ¨èçš„åˆ‡æ¢å‘½ä»¤</span></span><br></pre></td></tr></table></figure><p>åˆ é™¤åˆ†æ”¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git branch -d &lt;åˆ†æ”¯å&gt;  <span class="comment"># åˆ é™¤å·²åˆå¹¶çš„åˆ†æ”¯ï¼ˆå®‰å…¨åˆ é™¤ï¼‰</span></span><br><span class="line">git branch -D &lt;åˆ†æ”¯å&gt;  <span class="comment"># å¼ºåˆ¶åˆ é™¤æœªåˆå¹¶çš„åˆ†æ”¯</span></span><br></pre></td></tr></table></figure><p>é‡å‘½ååˆ†æ”¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git branch -m &lt;æ—§åˆ†æ”¯å&gt; &lt;æ–°åˆ†æ”¯å&gt;  <span class="comment"># é‡å‘½åå½“å‰åˆ†æ”¯</span></span><br></pre></td></tr></table></figure><ol start="3"><li>åˆ†æ”¯åˆå¹¶<br>åˆå¹¶åˆ†æ”¯çš„ä¸¤ç§æ–¹å¼<br>Fast-forwardï¼ˆå¿«è¿›åˆå¹¶ï¼‰ï¼šå½“åˆ†æ”¯æ²¡æœ‰åˆ†å‰æ—¶ï¼Œç›´æ¥å°†æŒ‡é’ˆå‘å‰ç§»åŠ¨ã€‚</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git checkout main</span><br><span class="line">git merge feature-branch  <span class="comment"># æ— å†²çªæ—¶ç›´æ¥å¿«è¿›</span></span><br></pre></td></tr></table></figure><p>ä¸‰æ–¹åˆå¹¶ï¼ˆThree-way Mergeï¼‰ï¼šå½“åˆ†æ”¯æœ‰åˆ†å‰æ—¶ï¼ŒGit ä¼šæ‰¾åˆ°ä¸¤ä¸ªåˆ†æ”¯çš„å…±åŒç¥–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„åˆå¹¶æäº¤ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git checkout main</span><br><span class="line">git merge feature-branch  <span class="comment"># åˆ›å»ºåˆå¹¶æäº¤</span></span><br></pre></td></tr></table></figure><p>åˆå¹¶å†²çª</p><p>å½“ä¸¤ä¸ªåˆ†æ”¯ä¿®æ”¹äº†åŒä¸€æ–‡ä»¶çš„åŒä¸€éƒ¨åˆ†æ—¶ï¼Œä¼šå‘ç”Ÿå†²çªã€‚è§£å†³æ–¹æ³•ï¼š</p><p>æ‰‹åŠ¨ç¼–è¾‘æ–‡ä»¶ï¼šæ‰“å¼€å†²çªæ–‡ä»¶ï¼Œæ ¹æ®æ ‡è®°ï¼ˆ&lt;&lt;&lt;&lt;&lt;&lt;&lt;ã€&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;ã€&gt;&gt;&gt;&gt;&gt;&gt;&gt;ï¼‰ä¿®æ”¹å†…å®¹ã€‚<br>ä½¿ç”¨åˆå¹¶å·¥å…·ï¼šå¦‚git mergetoolã€‚<br>æäº¤åˆå¹¶ç»“æœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git add &lt;å†²çªæ–‡ä»¶&gt;</span><br><span class="line">git commit -m <span class="string">&quot;è§£å†³åˆå¹¶å†²çª&quot;</span></span><br></pre></td></tr></table></figure><ol start="4"><li>åˆ†æ”¯ç®¡ç†ç­–ç•¥<br>Git Flow</li></ol><p>ä¸»åˆ†æ”¯ï¼šmasterï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰å’Œdevelopï¼ˆå¼€å‘ä¸»åˆ†æ”¯ï¼‰ã€‚<br>è¾…åŠ©åˆ†æ”¯ï¼š<br>Feature åˆ†æ”¯ï¼š<br>ä»developåˆ›å»ºï¼Œå®Œæˆååˆå¹¶å›developã€‚<br>Release åˆ†æ”¯ï¼š<br>å‡†å¤‡å‘å¸ƒæ—¶ä»developåˆ›å»ºï¼Œæµ‹è¯•ååˆå¹¶åˆ°masterå’Œdevelopã€‚<br>Hotfix åˆ†æ”¯ï¼š<br>ç´§æ€¥ä¿®å¤ç”Ÿäº§é—®é¢˜ï¼Œä»masteråˆ›å»ºï¼Œå®Œæˆååˆå¹¶å›masterå’Œdevelopã€‚</p><p>GitHub Flow</p><p>å•ä¸€ä¸»åˆ†æ”¯ï¼šmainå§‹ç»ˆä¿æŒå¯éƒ¨ç½²çŠ¶æ€ã€‚<br>æµç¨‹ï¼š<br>ä»mainåˆ›å»ºæ–°åˆ†æ”¯ã€‚<br>æäº¤ä¿®æ”¹å¹¶æ¨é€åˆ°è¿œç¨‹ã€‚<br>åˆ›å»º Pull Requestï¼ˆPRï¼‰è¿›è¡Œä»£ç å®¡æŸ¥ã€‚<br>æµ‹è¯•é€šè¿‡ååˆå¹¶åˆ°mainã€‚<br>ç«‹å³éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚<br>GitLab Flow<br>åŸºäº GitHub Flowï¼Œå¢åŠ äº†ç¯å¢ƒåˆ†æ”¯ï¼ˆå¦‚stagingã€productionï¼‰ï¼Œé€‚åˆå¤šç¯å¢ƒéƒ¨ç½²ã€‚<br>5. è¿œç¨‹åˆ†æ”¯æ“ä½œ</p><p>æ¨é€æœ¬åœ°åˆ†æ”¯åˆ°è¿œç¨‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git push -u origin &lt;æœ¬åœ°åˆ†æ”¯å&gt;  <span class="comment"># é¦–æ¬¡æ¨é€å¹¶å…³è”ä¸Šæ¸¸åˆ†æ”¯</span></span><br><span class="line">git push origin &lt;æœ¬åœ°åˆ†æ”¯å&gt;:&lt;è¿œç¨‹åˆ†æ”¯å&gt;  <span class="comment"># æ¨é€åˆ°ä¸åŒåçš„è¿œç¨‹åˆ†æ”¯</span></span><br></pre></td></tr></table></figure><p>è·Ÿè¸ªè¿œç¨‹åˆ†æ”¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git checkout -b &lt;æœ¬åœ°åˆ†æ”¯å&gt; origin/&lt;è¿œç¨‹åˆ†æ”¯å&gt;  <span class="comment"># åˆ›å»ºå¹¶è·Ÿè¸ªè¿œç¨‹åˆ†æ”¯</span></span><br><span class="line">git checkout --track origin/&lt;è¿œç¨‹åˆ†æ”¯å&gt;  <span class="comment"># ç®€åŒ–å‘½ä»¤ï¼ˆæœ¬åœ°åˆ†æ”¯åä¸è¿œç¨‹ä¸€è‡´ï¼‰</span></span><br></pre></td></tr></table></figure><p>æ‹‰å–è¿œç¨‹åˆ†æ”¯æ›´æ–°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git pull  <span class="comment"># æ‹‰å–å¹¶åˆå¹¶è¿œç¨‹åˆ†æ”¯</span></span><br><span class="line">git fetch <span class="comment"># ä»…è·å–è¿œç¨‹åˆ†æ”¯æ›´æ–°ï¼Œä¸åˆå¹¶</span></span><br></pre></td></tr></table></figure><p>åˆ é™¤è¿œç¨‹åˆ†æ”¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push origin --delete &lt;è¿œç¨‹åˆ†æ”¯å&gt;</span><br></pre></td></tr></table></figure><ol start="6"><li>åˆ†æ”¯çš„é«˜çº§ç”¨æ³•</li></ol><p>å˜åŸºï¼ˆRebaseï¼‰</p><p>å°†ä¸€ç³»åˆ—æäº¤åº”ç”¨åˆ°å¦ä¸€ä¸ªåŸºå‡†ç‚¹ï¼Œä½¿æäº¤å†å²æ›´çº¿æ€§ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git checkout feature-branch</span><br><span class="line">git rebase main  <span class="comment"># å°†feature-branchçš„æäº¤å˜åŸºåˆ°main</span></span><br></pre></td></tr></table></figure><p>** cherry-pick**<br>å°†æŒ‡å®šæäº¤åº”ç”¨åˆ°å½“å‰åˆ†æ”¯ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git cherry-pick &lt;æäº¤å“ˆå¸Œ&gt;  <span class="comment"># å¤åˆ¶ç‰¹å®šæäº¤åˆ°å½“å‰åˆ†æ”¯</span></span><br></pre></td></tr></table></figure><p>æš‚å­˜ï¼ˆStashï¼‰<br>ä¸´æ—¶ä¿å­˜æœªå®Œæˆçš„ä¿®æ”¹ï¼Œç”¨äºåˆ‡æ¢åˆ†æ”¯ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git stash  <span class="comment"># ä¿å­˜å½“å‰ä¿®æ”¹</span></span><br><span class="line">git stash pop  <span class="comment"># æ¢å¤æœ€è¿‘ä¸€æ¬¡stash</span></span><br><span class="line">git stash list  <span class="comment"># æŸ¥çœ‹æ‰€æœ‰stash</span></span><br></pre></td></tr></table></figure><ol start="7"><li>åˆ†æ”¯ç®¡ç†æœ€ä½³å®è·µ</li></ol><p>ä¿æŒä¸»åˆ†æ”¯ç¨³å®šï¼šmain&#x2F;masteråªåŒ…å«ç»è¿‡æµ‹è¯•çš„ä»£ç ã€‚</p><p>å°è€Œä¸“æ³¨çš„åˆ†æ”¯ï¼šæ¯ä¸ªåˆ†æ”¯åªåšä¸€ä»¶äº‹ï¼ˆå¦‚æ–°ç‰¹æ€§æˆ– bug ä¿®å¤ï¼‰ã€‚</p><p>å®šæœŸåŒæ­¥åˆ†æ”¯ï¼šé€šè¿‡git pull â€“rebaseä¿æŒåˆ†æ”¯æ›´æ–°ï¼Œå‡å°‘å†²çªã€‚</p><p>ä½¿ç”¨ PR&#x2F;MR è¿›è¡Œä»£ç å®¡æŸ¥ï¼šåˆå¹¶å‰ç¡®ä¿ä»£ç è´¨é‡ã€‚</p><p>åˆ é™¤å·²åˆå¹¶çš„åˆ†æ”¯ï¼šä¿æŒä»“åº“æ•´æ´ã€‚<br>ç¤ºä¾‹å·¥ä½œæµç¨‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. åˆ›å»ºå¹¶åˆ‡æ¢åˆ°æ–°åˆ†æ”¯</span></span><br><span class="line">git checkout -b feature/new-feature</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. å¼€å‘å¹¶æäº¤</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;æ–°åŠŸèƒ½ä»£ç &quot;</span> &gt; feature.txt</span><br><span class="line">git add feature.txt</span><br><span class="line">git commit -m <span class="string">&quot;æ·»åŠ æ–°åŠŸèƒ½&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. åŒæ­¥ä¸»åˆ†æ”¯ï¼ˆå¯é€‰ï¼‰</span></span><br><span class="line">git checkout main</span><br><span class="line">git pull origin main</span><br><span class="line">git checkout feature/new-feature</span><br><span class="line">git rebase main  <span class="comment"># æˆ– git merge main</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. æ¨é€åˆ°è¿œç¨‹</span></span><br><span class="line">git push -u origin feature/new-feature</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. åˆ›å»ºPRå¹¶åˆå¹¶åˆ°main</span></span><br><span class="line"><span class="comment"># 6. åˆ é™¤æœ¬åœ°å’Œè¿œç¨‹åˆ†æ”¯</span></span><br><span class="line">git branch -d feature/new-feature</span><br><span class="line">git push origin --delete feature/new-feature</span><br></pre></td></tr></table></figure><p>é€šè¿‡åˆç†ä½¿ç”¨åˆ†æ”¯ç®¡ç†ï¼Œå¼€å‘è€…å¯ä»¥é«˜æ•ˆåœ°ç»„ç»‡ä»£ç ã€éš”ç¦»é£é™©ï¼Œå¹¶ç®€åŒ–å›¢é˜Ÿåä½œã€‚Git çš„åˆ†æ”¯æ“ä½œéå¸¸è½»é‡ï¼Œå› æ­¤é¼“åŠ±é¢‘ç¹åˆ›å»ºå’Œä½¿ç”¨åˆ†æ”¯ï¼</p><h1 id="Git-æŸ¥çœ‹æäº¤å†å²"><a href="#Git-æŸ¥çœ‹æäº¤å†å²" class="headerlink" title="Git æŸ¥çœ‹æäº¤å†å²"></a>Git æŸ¥çœ‹æäº¤å†å²</h1><p>å¸¸ç”¨é€‰é¡¹</p><p>é™åˆ¶æ˜¾ç¤ºçš„æäº¤æ•°:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span> -n &lt;number&gt;</span><br></pre></td></tr></table></figure><p>ä¾‹å¦‚ï¼Œæ˜¾ç¤ºæœ€è¿‘çš„ 5 æ¬¡æäº¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span> -n 5</span><br></pre></td></tr></table></figure><p>æ˜¾ç¤ºè‡ªæŒ‡å®šæ—¥æœŸä¹‹åçš„æäº¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span> --since=<span class="string">&quot;2024-01-01&quot;</span></span><br></pre></td></tr></table></figure><p>æ˜¾ç¤ºæŒ‡å®šæ—¥æœŸä¹‹å‰çš„æäº¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span> --<span class="keyword">until</span>=<span class="string">&quot;2024-07-01&quot;</span></span><br></pre></td></tr></table></figure><p>åªæ˜¾ç¤ºæŸä¸ªä½œè€…çš„æäº¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span> --author=<span class="string">&quot;Author Name&quot;</span></span><br></pre></td></tr></table></figure><h1 id="Gitæ ‡ç­¾"><a href="#Gitæ ‡ç­¾" class="headerlink" title="Gitæ ‡ç­¾"></a>Gitæ ‡ç­¾</h1><p>Git æ ‡ç­¾ï¼ˆTagï¼‰æ˜¯ç”¨äºæ ‡è®°ç‰ˆæœ¬å†å²ä¸­ç‰¹å®šæäº¤çš„æŒ‡é’ˆï¼Œå¸¸ç”¨äºæ ‡è®°å‘å¸ƒç‚¹ï¼ˆå¦‚v1.0.0ï¼‰æˆ–é‡è¦é‡Œç¨‹ç¢‘ã€‚ä¸åˆ†æ”¯ä¸åŒï¼Œæ ‡ç­¾æ˜¯ä¸å¯å˜çš„ï¼Œä¸€æ—¦åˆ›å»ºå°±ä¸ä¼šç§»åŠ¨ã€‚</p><ol><li>æ ‡ç­¾çš„åŸºæœ¬æ¦‚å¿µ</li></ol><p>æ ‡ç­¾çš„ä½œç”¨</p><p>ç‰ˆæœ¬æ ‡è®°ï¼šæ ‡è®°å‘å¸ƒç‰ˆæœ¬ï¼ˆå¦‚v1.0.0ã€v2.3.1ï¼‰ã€‚<br>é‡è¦é‡Œç¨‹ç¢‘ï¼šæ ‡è®°å…³é”®æäº¤ï¼ˆå¦‚æ¶æ„é‡æ„ã€é‡å¤§åŠŸèƒ½å‘å¸ƒï¼‰ã€‚<br>å¿«é€Ÿå®šä½ï¼šé€šè¿‡æ ‡ç­¾åå¿«é€Ÿåˆ‡æ¢åˆ°å†å²ç‰ˆæœ¬ã€‚</p><p>æ ‡ç­¾çš„ç±»å‹</p><p>è½»é‡æ ‡ç­¾ï¼ˆLightweightï¼‰ï¼š<br>ç®€å•æŒ‡å‘ç‰¹å®šæäº¤çš„å¼•ç”¨ï¼Œæ— é¢å¤–å…ƒæ•°æ®ã€‚<br>å­˜å‚¨åœ¨.git&#x2F;refs&#x2F;tags&#x2F;ç›®å½•ä¸‹ã€‚<br>é™„æ³¨æ ‡ç­¾ï¼ˆAnnotatedï¼‰ï¼š<br>å®Œæ•´çš„ Git å¯¹è±¡ï¼ŒåŒ…å«æ ‡ç­¾åã€æ ‡ç­¾äººã€æ—¥æœŸã€æ³¨é‡Šä¿¡æ¯ã€‚<br>å¯ç­¾åï¼ˆGPGï¼‰ï¼Œç”¨äºéªŒè¯ç‰ˆæœ¬ã€‚</p><ol start="2"><li>æ ‡ç­¾çš„åŸºæœ¬æ“ä½œ<br>åˆ›å»ºæ ‡ç­¾<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºè½»é‡æ ‡ç­¾ï¼ˆæŒ‡å‘å½“å‰æäº¤ï¼‰</span></span><br><span class="line">git tag &lt;æ ‡ç­¾å&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºè½»é‡æ ‡ç­¾ï¼ˆæŒ‡å‘ç‰¹å®šæäº¤ï¼‰</span></span><br><span class="line">git tag &lt;æ ‡ç­¾å&gt; &lt;æäº¤å“ˆå¸Œ&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºé™„æ³¨æ ‡ç­¾ï¼ˆå¸¦æ³¨é‡Šï¼‰</span></span><br><span class="line">git tag -a &lt;æ ‡ç­¾å&gt; -m <span class="string">&quot;æ ‡ç­¾è¯´æ˜&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºå¸¦ç­¾åçš„é™„æ³¨æ ‡ç­¾ï¼ˆéœ€GPGå¯†é’¥ï¼‰</span></span><br><span class="line">git tag -s &lt;æ ‡ç­¾å&gt; -m <span class="string">&quot;ç­¾åæ ‡ç­¾è¯´æ˜&quot;</span></span><br></pre></td></tr></table></figure></li></ol><p>æŸ¥çœ‹æ ‡ç­¾</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git tag               <span class="comment"># åˆ—å‡ºæ‰€æœ‰æ ‡ç­¾</span></span><br><span class="line">git tag -l <span class="string">&quot;v1.0.*&quot;</span>   <span class="comment"># æŒ‰æ¨¡å¼ç­›é€‰æ ‡ç­¾</span></span><br><span class="line">git show &lt;æ ‡ç­¾å&gt;     <span class="comment"># æŸ¥çœ‹æ ‡ç­¾è¯¦ç»†ä¿¡æ¯</span></span><br></pre></td></tr></table></figure><p>åˆ‡æ¢åˆ°æ ‡ç­¾</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git checkout &lt;æ ‡ç­¾å&gt;  <span class="comment"># åˆ‡æ¢åˆ°æ ‡ç­¾ï¼ˆå¤„äºâ€œåˆ†ç¦»HEADâ€çŠ¶æ€ï¼‰</span></span><br><span class="line">git checkout -b &lt;åˆ†æ”¯å&gt; &lt;æ ‡ç­¾å&gt;  <span class="comment"># ä»æ ‡ç­¾åˆ›å»ºæ–°åˆ†æ”¯</span></span><br></pre></td></tr></table></figure><p>åˆ é™¤æ ‡ç­¾</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git tag -d &lt;æ ‡ç­¾å&gt;  <span class="comment"># åˆ é™¤æœ¬åœ°æ ‡ç­¾</span></span><br></pre></td></tr></table></figure><ol start="3"><li>è¿œç¨‹æ ‡ç­¾æ“ä½œ</li></ol><p>æ¨é€æ ‡ç­¾åˆ°è¿œç¨‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git push origin &lt;æ ‡ç­¾å&gt;  <span class="comment"># æ¨é€å•ä¸ªæ ‡ç­¾</span></span><br><span class="line">git push origin --tags   <span class="comment"># æ¨é€æ‰€æœ‰æœªæ¨é€çš„æ ‡ç­¾</span></span><br></pre></td></tr></table></figure><p>åˆ é™¤è¿œç¨‹æ ‡ç­¾</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git push origin --delete &lt;æ ‡ç­¾å&gt;  <span class="comment"># Git 2.8+</span></span><br><span class="line"><span class="comment"># æˆ–æ—§ç‰ˆè¯­æ³•</span></span><br><span class="line">git push origin :refs/tags/&lt;æ ‡ç­¾å&gt;</span><br></pre></td></tr></table></figure><p>è·å–è¿œç¨‹æ ‡ç­¾</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git fetch origin --tags  <span class="comment"># è·å–æ‰€æœ‰è¿œç¨‹æ ‡ç­¾</span></span><br></pre></td></tr></table></figure><ol start="4"><li>æ ‡ç­¾å‘½åè§„èŒƒ</li></ol><p>å¸¸è§çš„æ ‡ç­¾å‘½åè§„èŒƒï¼š</p><p>è¯­ä¹‰åŒ–ç‰ˆæœ¬ï¼šv&lt;ä¸»ç‰ˆæœ¬&gt;.&lt;æ¬¡ç‰ˆæœ¬&gt;.&lt;ä¿®è®¢å·&gt;ï¼ˆå¦‚v1.0.0ã€v2.3.1ï¼‰ã€‚<br>å‘å¸ƒç±»å‹ï¼š<br>æ­£å¼ç‰ˆï¼šv1.0.0<br>é¢„å‘å¸ƒç‰ˆï¼šv1.0.0-alphaã€v1.0.0-beta.1ã€v1.0.0-rc.1<br>ç‰¹æ®Šæ ‡è®°ï¼šv1.0.0-hotfixã€v2.0.0-20230615</p><ol start="5"><li>æ ‡ç­¾çš„æœ€ä½³å®è·µ</li></ol><p>ä½¿ç”¨é™„æ³¨æ ‡ç­¾ï¼šå»ºè®®åœ¨å‘å¸ƒç‰ˆæœ¬æ—¶ä½¿ç”¨é™„æ³¨æ ‡ç­¾ï¼Œä¿ç•™å®Œæ•´å…ƒæ•°æ®ã€‚<br>åŠæ—¶æ‰“æ ‡ç­¾ï¼šåœ¨å‘å¸ƒæˆ–é‡è¦æäº¤åç«‹å³æ‰“æ ‡ç­¾ã€‚<br>é¿å…ä¿®æ”¹æ ‡ç­¾ï¼šæ ‡ç­¾æ˜¯ä¸å¯å˜çš„ï¼Œå¦‚éœ€ä¿®æ”¹éœ€åˆ é™¤åé‡æ–°åˆ›å»ºï¼ˆå¯èƒ½å½±å“åä½œï¼‰ã€‚<br>å®šæœŸæ¸…ç†æ ‡ç­¾ï¼šåˆ é™¤ä¸å†éœ€è¦çš„æœ¬åœ° &#x2F; è¿œç¨‹æ ‡ç­¾ã€‚</p><p>æ ‡ç­¾ä¸åˆ†æ”¯çš„åŒºåˆ«ï¼š</p><p>åˆ†æ”¯ï¼šç”¨äºå¼€å‘ï¼ŒæŒ‡é’ˆä¼šéšæäº¤ç§»åŠ¨ã€‚<br>æ ‡ç­¾ï¼šç”¨äºæ ‡è®°å†å²ç‰ˆæœ¬ï¼ŒæŒ‡é’ˆå›ºå®šä¸å˜ã€‚</p><p>ç¤ºä¾‹å·¥ä½œæµç¨‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. æäº¤ä»£ç åˆ°ä¸»åˆ†æ”¯</span></span><br><span class="line">git checkout main</span><br><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">&quot;å®Œæˆv1.0.0åŠŸèƒ½å¼€å‘&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. åˆ›å»ºé™„æ³¨æ ‡ç­¾</span></span><br><span class="line">git tag -a v1.0.0 -m <span class="string">&quot;é¦–ä¸ªæ­£å¼ç‰ˆæœ¬å‘å¸ƒ&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. æ¨é€æ ‡ç­¾åˆ°è¿œç¨‹</span></span><br><span class="line">git push origin v1.0.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. åç»­å‘ç°bugï¼Œä¿®å¤ååˆ›å»ºè¡¥ä¸ç‰ˆæœ¬</span></span><br><span class="line">git checkout -b hotfix/v1.0.1 main</span><br><span class="line"><span class="comment"># ä¿®å¤bug...</span></span><br><span class="line">git commit -m <span class="string">&quot;ä¿®å¤ç™»å½•éªŒè¯é—®é¢˜&quot;</span></span><br><span class="line">git checkout main</span><br><span class="line">git merge hotfix/v1.0.1</span><br><span class="line">git tag -a v1.0.1 -m <span class="string">&quot;ä¿®å¤ç™»å½•éªŒè¯é—®é¢˜&quot;</span></span><br><span class="line">git push origin v1.0.1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. æŸ¥çœ‹å†å²æ ‡ç­¾</span></span><br><span class="line">git tag -l</span><br></pre></td></tr></table></figure><p>Git æ ‡ç­¾æ˜¯ç‰ˆæœ¬ç®¡ç†çš„é‡è¦å·¥å…·ï¼Œé€šè¿‡åˆç†ä½¿ç”¨æ ‡ç­¾ï¼Œå¯ä»¥æ¸…æ™°åœ°æ ‡è®°é¡¹ç›®çš„å…³é”®èŠ‚ç‚¹ï¼Œä¾¿äºå›æº¯å’Œå‘å¸ƒç®¡ç†ã€‚</p><h1 id="Gitè¿›é˜¶æ“ä½œ"><a href="#Gitè¿›é˜¶æ“ä½œ" class="headerlink" title="Gitè¿›é˜¶æ“ä½œ"></a>Gitè¿›é˜¶æ“ä½œ</h1><ol><li>äº¤äº’å¼æš‚å­˜ï¼ˆInteractive Stagingï¼‰<br>ä½œç”¨ï¼šé€å—é€‰æ‹©è¦æš‚å­˜çš„æ›´æ”¹ï¼Œç²¾ç»†æ§åˆ¶æäº¤å†…å®¹ã€‚<br>åœºæ™¯ï¼šå½“ä¸€æ¬¡ä¿®æ”¹åŒ…å«å¤šä¸ªé€»è¾‘æ›´æ”¹ï¼Œéœ€è¦æ‹†åˆ†ä¸ºå¤šä¸ªæäº¤æ—¶ã€‚</li></ol><p>åŸºæœ¬ç”¨æ³•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git add -p  <span class="comment"># äº¤äº’å¼æš‚å­˜ï¼ˆ-p æ˜¯ --patch çš„ç¼©å†™ï¼‰</span></span><br></pre></td></tr></table></figure><p>äº¤äº’å‘½ä»¤<br>yï¼šæš‚å­˜å½“å‰åŒºå—<br>nï¼šè·³è¿‡å½“å‰åŒºå—<br>sï¼šæ‹†åˆ†å½“å‰åŒºå—ï¼ˆå¦‚æœåŒºå—è¾ƒå¤§ï¼‰<br>eï¼šæ‰‹åŠ¨ç¼–è¾‘å½“å‰åŒºå—<br>dï¼šæŸ¥çœ‹ diff<br>qï¼šé€€å‡º</p><p>ç¤ºä¾‹</p><p>å‡è®¾ä¿®æ”¹äº†ä¸¤ä¸ªåŠŸèƒ½ï¼ˆç”¨æˆ·è®¤è¯å’Œæ”¯ä»˜ï¼‰ï¼Œä½†æƒ³åˆ†å¼€æäº¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿›å…¥äº¤äº’å¼æš‚å­˜æ¨¡å¼</span></span><br><span class="line">git add -p</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç³»ç»Ÿä¼šé€å—æ˜¾ç¤ºæ›´æ”¹ï¼š</span></span><br><span class="line"><span class="comment"># 1. ç”¨æˆ·è®¤è¯ç›¸å…³æ›´æ”¹ -&gt; é€‰æ‹© y æš‚å­˜</span></span><br><span class="line"><span class="comment"># 2. æ”¯ä»˜ç›¸å…³æ›´æ”¹ -&gt; é€‰æ‹© n è·³è¿‡</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æäº¤å·²æš‚å­˜çš„ç”¨æˆ·è®¤è¯æ›´æ”¹</span></span><br><span class="line">git commit -m <span class="string">&quot;å®Œå–„ç”¨æˆ·è®¤è¯é€»è¾‘&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å†æ¬¡æ‰§è¡Œ git add -p æš‚å­˜å‰©ä½™çš„æ”¯ä»˜æ›´æ”¹</span></span><br><span class="line">git add -p  <span class="comment"># æš‚å­˜æ”¯ä»˜ç›¸å…³æ›´æ”¹</span></span><br><span class="line">git commit -m <span class="string">&quot;ä¼˜åŒ–æ”¯ä»˜æµç¨‹&quot;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>Git Stash</li></ol><p>ä½œç”¨ï¼šä¸´æ—¶ä¿å­˜å·¥ä½œè¿›åº¦ï¼Œæ–¹ä¾¿åˆ‡æ¢ä»»åŠ¡ã€‚<br>åœºæ™¯ï¼šéœ€è¦ç´§æ€¥åˆ‡æ¢åˆ†æ”¯ï¼Œä½†å½“å‰å·¥ä½œæœªå®Œæˆã€‚</p><p>åŸºæœ¬æ“ä½œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git stash save <span class="string">&quot;ä¸´æ—¶ä¿å­˜æœªå®Œæˆçš„åŠŸèƒ½&quot;</span>  <span class="comment"># ä¿å­˜å½“å‰è¿›åº¦</span></span><br><span class="line">git stash list                         <span class="comment"># æŸ¥çœ‹æ‰€æœ‰stash</span></span><br><span class="line">git stash apply stash@&#123;0&#125;              <span class="comment"># æ¢å¤æŒ‡å®šstashï¼ˆé»˜è®¤æœ€æ–°ï¼‰</span></span><br><span class="line">git stash drop stash@&#123;0&#125;               <span class="comment"># åˆ é™¤æŒ‡å®šstash</span></span><br><span class="line">git stash pop                          <span class="comment"># æ¢å¤å¹¶åˆ é™¤æœ€æ–°stash</span></span><br></pre></td></tr></table></figure><p>é«˜çº§ç”¨æ³•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git stash branch new-feature  <span class="comment"># ä»stashåˆ›å»ºæ–°åˆ†æ”¯å¹¶è‡ªåŠ¨åº”ç”¨</span></span><br><span class="line">git stash show -p             <span class="comment"># æŸ¥çœ‹stashçš„è¯¦ç»†æ›´æ”¹</span></span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å½“å‰åœ¨featureåˆ†æ”¯å¼€å‘æœªå®Œæˆï¼Œéœ€è¦ç´§æ€¥ä¿®å¤bug</span></span><br><span class="line">git stash save <span class="string">&quot;æœªå®Œæˆçš„æ–°åŠŸèƒ½&quot;</span>  <span class="comment"># ä¿å­˜å½“å‰è¿›åº¦</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ‡æ¢åˆ°masteråˆ†æ”¯ä¿®å¤bug</span></span><br><span class="line">git checkout master</span><br><span class="line">git checkout -b hotfix</span><br><span class="line"><span class="comment"># ä¿®å¤bug...</span></span><br><span class="line">git commit -m <span class="string">&quot;ä¿®å¤ç™»å½•å´©æºƒé—®é¢˜&quot;</span></span><br><span class="line">git checkout master</span><br><span class="line">git merge hotfix</span><br><span class="line">git push</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿”å›featureåˆ†æ”¯æ¢å¤å·¥ä½œ</span></span><br><span class="line">git checkout feature</span><br><span class="line">git stash pop  <span class="comment"># æ¢å¤ä¹‹å‰çš„å·¥ä½œè¿›åº¦</span></span><br></pre></td></tr></table></figure><ol start="3"><li>Git Rebase<br>ä½œç”¨ï¼šå°†ä¸€ä¸ªåˆ†æ”¯ä¸Šçš„æ›´æ”¹ç§»åˆ°å¦ä¸€ä¸ªåˆ†æ”¯ä¹‹ä¸Šï¼Œä¿æŒæäº¤å†å²çº¿æ€§ã€‚<br>åœºæ™¯ï¼šåœ¨æ¨é€åˆ°è¿œç¨‹å‰æ•´ç†æœ¬åœ°æäº¤ï¼Œæˆ–åŒæ­¥æœ€æ–°ä¸»åˆ†æ”¯ã€‚</li></ol><p>åŸºæœ¬ç”¨æ³•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†featureåˆ†æ”¯çš„æäº¤å˜åŸºåˆ°main</span></span><br><span class="line">git checkout feature</span><br><span class="line">git rebase main</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç®€åŒ–æ“ä½œï¼ˆç›´æ¥åœ¨mainä¸Šæ‰§è¡Œï¼‰</span></span><br><span class="line">git rebase main feature</span><br></pre></td></tr></table></figure><p>äº¤äº’å¼å˜åŸº<br>åˆå¹¶ã€ä¿®æ”¹æˆ–åˆ é™¤å†å²æäº¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rebase -i HEAD~3  <span class="comment"># ç¼–è¾‘æœ€è¿‘3æ¬¡æäº¤</span></span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. ä»mainåˆ›å»ºæ–°åˆ†æ”¯å¹¶æäº¤ä¸¤æ¬¡</span></span><br><span class="line">git checkout -b feature main</span><br><span class="line"><span class="comment"># å¼€å‘...</span></span><br><span class="line">git commit -m <span class="string">&quot;æ·»åŠ ç”¨æˆ·åˆ—è¡¨&quot;</span></span><br><span class="line"><span class="comment"># å¼€å‘...</span></span><br><span class="line">git commit -m <span class="string">&quot;ä¼˜åŒ–ç”¨æˆ·åˆ—è¡¨æ ·å¼&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. æ­¤æ—¶mainåˆ†æ”¯å·²æ›´æ–°ï¼Œéœ€è¦åŒæ­¥</span></span><br><span class="line">git fetch origin</span><br><span class="line">git rebase origin/main  <span class="comment"># å°†featureçš„æäº¤å˜åŸºåˆ°æœ€æ–°main</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. ä½¿ç”¨äº¤äº’å¼å˜åŸºåˆå¹¶ä¸¤ä¸ªæäº¤</span></span><br><span class="line">git rebase -i HEAD~2</span><br><span class="line"><span class="comment"># åœ¨ç¼–è¾‘å™¨ä¸­å°†ç¬¬äºŒè¡Œçš„pickæ”¹ä¸ºsquashï¼Œä¿å­˜é€€å‡º</span></span><br><span class="line"><span class="comment"># ç¼–è¾‘åˆå¹¶åçš„æäº¤ä¿¡æ¯</span></span><br></pre></td></tr></table></figure><ol start="4"><li>Git Cherry-Pick<br>ä½œç”¨ï¼šé€‰æ‹©ç‰¹å®šæäº¤å¹¶åº”ç”¨åˆ°å½“å‰åˆ†æ”¯ã€‚<br>åœºæ™¯ï¼šå°†å…¶ä»–åˆ†æ”¯çš„æŸä¸ªæäº¤å¼•å…¥å½“å‰åˆ†æ”¯ï¼Œè€Œéåˆå¹¶æ•´ä¸ªåˆ†æ”¯ã€‚<br>åŸºæœ¬ç”¨æ³•</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git cherry-pick &lt;æäº¤å“ˆå¸Œ&gt;  <span class="comment"># åº”ç”¨å•ä¸ªæäº¤</span></span><br><span class="line">git cherry-pick A^..B      <span class="comment"># åº”ç”¨ä»Aï¼ˆä¸å«ï¼‰åˆ°Bçš„æ‰€æœ‰æäº¤</span></span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹<br>å‡è®¾åœ¨featureåˆ†æ”¯ä¸Šæœ‰ä¸€ä¸ªä¿®å¤æäº¤abc123ï¼Œéœ€è¦åº”ç”¨åˆ°mainåˆ†æ”¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. åˆ‡æ¢åˆ°mainåˆ†æ”¯</span></span><br><span class="line">git checkout main</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. åº”ç”¨æŒ‡å®šæäº¤</span></span><br><span class="line">git cherry-pick abc123</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. å¦‚æœæœ‰å†²çªï¼Œè§£å†³åç»§ç»­</span></span><br><span class="line">git add .</span><br><span class="line">git cherry-pick --<span class="built_in">continue</span></span><br></pre></td></tr></table></figure><p>æœ€ä½³å®è·µå»ºè®®</p><ol><li>äº¤äº’å¼æš‚å­˜ï¼š<br>æ¯æ¬¡æäº¤åªåŒ…å«ä¸€ä¸ªé€»è¾‘æ›´æ”¹<br>ä½¿ç”¨git add -pé¿å…æäº¤æ— å…³ä¿®æ”¹</li><li>Git Stashï¼š<br>å®šæœŸæ¸…ç†ä¸å†éœ€è¦çš„ stash<br>ä½¿ç”¨æè¿°æ€§çš„ stash æ¶ˆæ¯</li><li>Git Rebaseï¼š<br>åªå¯¹æœªæ¨é€åˆ°è¿œç¨‹çš„æäº¤ä½¿ç”¨ rebase<br>å¤æ‚å˜åŸºå‰å…ˆå¤‡ä»½åˆ†æ”¯ï¼ˆgit branch backup-featureï¼‰</li><li>Git Cherry-Pickï¼š<br>é¿å…è·¨åˆ†æ”¯é¢‘ç¹ cherry-pickï¼Œä¼˜å…ˆä½¿ç”¨åˆå¹¶<br>æ³¨æ„æäº¤ä½œè€…ä¿¡æ¯æ˜¯å¦éœ€è¦ä¿ç•™ï¼ˆ-xé€‰é¡¹ï¼‰</li></ol><p>è¿™äº›é«˜çº§æŠ€å·§èƒ½æ˜¾è‘—æå‡ä»£ç ç®¡ç†æ•ˆç‡ï¼Œä½†éœ€è°¨æ…ä½¿ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨å›¢é˜Ÿåä½œç¯å¢ƒä¸­ã€‚å»ºè®®å…ˆåœ¨ä¸ªäººåˆ†æ”¯ç»ƒä¹ ï¼Œç†Ÿæ‚‰åå†åº”ç”¨åˆ°å®é™…å¼€å‘æµç¨‹ä¸­ã€‚</p><h1 id="Gitè¿œç¨‹Github"><a href="#Gitè¿œç¨‹Github" class="headerlink" title="Gitè¿œç¨‹Github"></a>Gitè¿œç¨‹Github</h1><h2 id="åœ¨-GitHub-ä¸Šåˆ›å»ºè¿œç¨‹ä»“åº“"><a href="#åœ¨-GitHub-ä¸Šåˆ›å»ºè¿œç¨‹ä»“åº“" class="headerlink" title="åœ¨ GitHub ä¸Šåˆ›å»ºè¿œç¨‹ä»“åº“"></a>åœ¨ GitHub ä¸Šåˆ›å»ºè¿œç¨‹ä»“åº“</h2><ol><li><p>ç™»å½• GitHubå®˜ç½‘ã€‚</p></li><li><p>ç‚¹å‡»é¡µé¢å³ä¸Šè§’ â• â†’ New repositoryã€‚</p></li><li><p>å¡«å†™ï¼š</p><pre><code>Repository nameï¼šæ¯”å¦‚ my-awesome-projectDescriptionï¼ˆå¯é€‰ï¼‰ï¼šé¡¹ç›®æè¿°Public / Privateï¼šå…¬å¼€æˆ–ç§æœ‰</code></pre></li><li><p>å¯ä»¥ä¸ç”¨å‹¾é€‰ã€ŒInitialize this repository with a READMEã€â€”â€” æ–¹ä¾¿åé¢å’Œæœ¬åœ°ä»“åº“å…³è”ã€‚</p></li><li><p>ç‚¹å‡» Create repositoryã€‚</p></li></ol><p>æ­¤æ—¶ GitHub ä¼šç»™ä½ æ˜¾ç¤ºä¸€é¡µå‘½ä»¤æç¤ºï¼Œæ¯”å¦‚ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote add origin https://github.com/ç”¨æˆ·å/ä»“åº“å.git</span><br></pre></td></tr></table></figure><h2 id="åœ¨æœ¬åœ°åˆ›å»ºå¹¶åˆå§‹åŒ–-Git-ä»“åº“"><a href="#åœ¨æœ¬åœ°åˆ›å»ºå¹¶åˆå§‹åŒ–-Git-ä»“åº“" class="headerlink" title="åœ¨æœ¬åœ°åˆ›å»ºå¹¶åˆå§‹åŒ– Git ä»“åº“"></a>åœ¨æœ¬åœ°åˆ›å»ºå¹¶åˆå§‹åŒ– Git ä»“åº“</h2><p>è¿›å…¥ä½ çš„é¡¹ç›®ç›®å½•ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> è·¯å¾„/ä½ çš„é¡¹ç›®ç›®å½•</span><br></pre></td></tr></table></figure><p>åˆå§‹åŒ–ä»“åº“ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br></pre></td></tr></table></figure><p>æ·»åŠ æ–‡ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git add .</span><br></pre></td></tr></table></figure><p>æäº¤åˆ°æœ¬åœ°ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git commit -m <span class="string">&quot;Initial commit&quot;</span></span><br></pre></td></tr></table></figure><h2 id="å°†æœ¬åœ°ä»“åº“å…³è”åˆ°-GitHub-è¿œç¨‹ä»“åº“"><a href="#å°†æœ¬åœ°ä»“åº“å…³è”åˆ°-GitHub-è¿œç¨‹ä»“åº“" class="headerlink" title="å°†æœ¬åœ°ä»“åº“å…³è”åˆ° GitHub è¿œç¨‹ä»“åº“"></a>å°†æœ¬åœ°ä»“åº“å…³è”åˆ° GitHub è¿œç¨‹ä»“åº“</h2><p>å°† GitHub ä¸Šåˆšåˆšåˆ›å»ºçš„ä»“åº“ URLï¼ˆHTTPS æˆ– SSHï¼‰æ·»åŠ åˆ°æœ¬åœ°ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote add origin https://github.com/ç”¨æˆ·å/ä»“åº“å.git</span><br></pre></td></tr></table></figure><h2 id="æ¨é€åˆ°è¿œç¨‹ä»“åº“"><a href="#æ¨é€åˆ°è¿œç¨‹ä»“åº“" class="headerlink" title="æ¨é€åˆ°è¿œç¨‹ä»“åº“"></a>æ¨é€åˆ°è¿œç¨‹ä»“åº“</h2><p>ç¬¬ä¸€æ¬¡æ¨é€æ—¶ï¼Œé€šå¸¸éœ€è¦ -u å‚æ•°å»ºç«‹æœ¬åœ°åˆ†æ”¯ä¸è¿œç¨‹åˆ†æ”¯çš„å…³è”ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push -u origin main</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ æœ¬åœ°åˆ†æ”¯æ˜¯ masterï¼ŒGitHub åˆ›å»ºçš„æ–°ä»“åº“é»˜è®¤åˆ†æ”¯æ˜¯ mainï¼Œéœ€è¦å…ˆé‡å‘½åï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git branch -M main</span><br><span class="line">git push -u origin main</span><br></pre></td></tr></table></figure><h2 id="ä»è¿œç¨‹ä»“åº“å…‹éš†ä»£ç "><a href="#ä»è¿œç¨‹ä»“åº“å…‹éš†ä»£ç " class="headerlink" title="ä»è¿œç¨‹ä»“åº“å…‹éš†ä»£ç "></a>ä»è¿œç¨‹ä»“åº“å…‹éš†ä»£ç </h2><p>å¦‚æœæ˜¯å…¶ä»–äººè¦è·å–ä½ çš„é¡¹ç›®ï¼Œæˆ–è€…ä½ åœ¨å…¶ä»–æœºå™¨ä¸Šå·¥ä½œï¼Œå¯ä»¥ç›´æ¥å…‹éš†ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/ç”¨æˆ·å/ä»“åº“å.git</span><br></pre></td></tr></table></figure><h2 id="å¸¸ç”¨è¿œç¨‹æ“ä½œå‘½ä»¤"><a href="#å¸¸ç”¨è¿œç¨‹æ“ä½œå‘½ä»¤" class="headerlink" title="å¸¸ç”¨è¿œç¨‹æ“ä½œå‘½ä»¤"></a>å¸¸ç”¨è¿œç¨‹æ“ä½œå‘½ä»¤</h2><p>åŠŸèƒ½              å‘½ä»¤<br>æŸ¥çœ‹å½“å‰è¿œç¨‹ä»“åº“åœ°å€    git remote -v<br>ä¿®æ”¹è¿œç¨‹ä»“åº“åœ°å€    git remote set-urlorigin æ–°åœ°å€<br>æ‹‰å–è¿œç¨‹ä»“åº“æ›´æ–°    git pull origin main<br>æ¨é€åˆ°è¿œç¨‹ä»“åº“        git push origin main<br>åˆ é™¤è¿œç¨‹ä»“åº“å…³è”    git remote remove origin<br>æŸ¥çœ‹è¿œç¨‹ä»“åº“åˆ†æ”¯    git branch -r</p><h2 id="HTTPS-å’Œ-SSH-çš„åŒºåˆ«"><a href="#HTTPS-å’Œ-SSH-çš„åŒºåˆ«" class="headerlink" title="HTTPS å’Œ SSH çš„åŒºåˆ«"></a>HTTPS å’Œ SSH çš„åŒºåˆ«</h2><p>HTTPSï¼š</p><p>ä½¿ç”¨æ–¹ä¾¿ï¼Œç›´æ¥ç”¨ GitHub æä¾›çš„ HTTPS é“¾æ¥ã€‚</p><p>ç¼ºç‚¹æ˜¯æ¯æ¬¡æ¨é€&#x2F;æ‹‰å–å¯èƒ½ä¼šæç¤ºä½ è¾“å…¥ GitHub è´¦å·å’Œå¯†ç ï¼ˆæˆ– tokenï¼‰ã€‚</p><p>SSHï¼š</p><p>é…ç½®ä¸€æ¬¡ SSH Key åï¼Œå†æ¨é€&#x2F;æ‹‰å–éƒ½ä¸ä¼šéœ€è¦è¾“å…¥å¯†ç ã€‚</p><p>é€‚åˆç»å¸¸æ“ä½œã€‚</p><h2 id="å¦‚ä½•é…ç½®-SSH-Key-ä»¥ä½¿ç”¨-SSH"><a href="#å¦‚ä½•é…ç½®-SSH-Key-ä»¥ä½¿ç”¨-SSH" class="headerlink" title="å¦‚ä½•é…ç½® SSH Key ä»¥ä½¿ç”¨ SSH"></a>å¦‚ä½•é…ç½® SSH Key ä»¥ä½¿ç”¨ SSH</h2><ol><li>åœ¨ç»ˆç«¯ç”Ÿæˆ SSH Keyï¼š</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t ed25519 -C <span class="string">&quot;ä½ çš„é‚®ç®±&quot;</span></span><br></pre></td></tr></table></figure><p>æŒ‰æç¤ºä¸€ç›´å›è½¦å³å¯ï¼Œä¼šåœ¨ <del>&#x2F;.ssh&#x2F;id_ed25519 ç”Ÿæˆç§é’¥ã€</del>&#x2F;.ssh&#x2F;id_ed25519.pub ç”Ÿæˆå…¬é’¥ã€‚</p><ol start="2"><li>å¤åˆ¶å…¬é’¥å†…å®¹ï¼š</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> ~/.ssh/id_ed25519.pub</span><br></pre></td></tr></table></figure><ol start="3"><li><p>ç™»å½• GitHub â†’ ç‚¹å‡»å³ä¸Šè§’å¤´åƒ â†’ Settings â†’ å·¦ä¾§èœå• SSH and GPG keys â†’ New SSH keyï¼ŒæŠŠä¸Šä¸€æ­¥å¤åˆ¶çš„å…¬é’¥å†…å®¹ç²˜è´´è¿›å»ã€‚</p></li><li><p>ä»¥åä½ å°±å¯ä»¥ç”¨ SSH å½¢å¼å…‹éš†ä»“åº“ï¼Œæ¯”å¦‚ï¼š</p></li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> git@github.com:ç”¨æˆ·å/ä»“åº“å.git</span><br></pre></td></tr></table></figure><h2 id="å…¶ä»–å¸¸è§é—®é¢˜"><a href="#å…¶ä»–å¸¸è§é—®é¢˜" class="headerlink" title="å…¶ä»–å¸¸è§é—®é¢˜"></a>å…¶ä»–å¸¸è§é—®é¢˜</h2><ol><li>å¦‚ä½•ä¿®æ”¹ Git ç”¨æˆ·å&#x2F;é‚®ç®±ï¼Ÿ</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name <span class="string">&quot;ä½ çš„åå­—&quot;</span></span><br><span class="line">git config --global user.email <span class="string">&quot;ä½ çš„é‚®ç®±&quot;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>å¦‚ä½•åªå¯¹å½“å‰é¡¹ç›®è®¾ç½®ç”¨æˆ·å&#x2F;é‚®ç®±ï¼Ÿ</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config user.name <span class="string">&quot;ä½ çš„åå­—&quot;</span></span><br><span class="line">git config user.email <span class="string">&quot;ä½ çš„é‚®ç®±&quot;</span></span><br></pre></td></tr></table></figure><ol start="3"><li>å¦‚ä½•åˆ‡æ¢åˆ°å…¶ä»–åˆ†æ”¯ï¼Ÿ</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git checkout åˆ†æ”¯å</span><br></pre></td></tr></table></figure><ol start="4"><li>å¦‚ä½•ä»è¿œç¨‹æ‹‰å–å…¶ä»–åˆ†æ”¯ï¼Ÿ</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git fetch origin</span><br><span class="line">git checkout -b æœ¬åœ°åˆ†æ”¯å origin/è¿œç¨‹åˆ†æ”¯å</span><br></pre></td></tr></table></figure><h2 id="å¸¸è§å®Œæ•´æ“ä½œæµç¨‹"><a href="#å¸¸è§å®Œæ•´æ“ä½œæµç¨‹" class="headerlink" title="å¸¸è§å®Œæ•´æ“ä½œæµç¨‹"></a>å¸¸è§å®Œæ•´æ“ä½œæµç¨‹</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. åˆ›å»ºæœ¬åœ°ä»“åº“</span></span><br><span class="line">git init</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. æ·»åŠ æ‰€æœ‰æ–‡ä»¶</span></span><br><span class="line">git add .</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. æäº¤</span></span><br><span class="line">git commit -m <span class="string">&quot;Initial commit&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. å…³è”è¿œç¨‹</span></span><br><span class="line">git remote add origin https://github.com/ç”¨æˆ·å/ä»“åº“å.git</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. æ¨é€</span></span><br><span class="line">git branch -M main       <span class="comment"># å¯é€‰ï¼Œé‡å‘½åä¸º main</span></span><br><span class="line">git push -u origin main</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•´æ´æ¶æ„</title>
      <link href="/2025/07/01/DDD/DDD%E5%AE%9E%E6%88%98-%E9%A1%B9%E7%9B%AE%E5%88%86%E5%B1%82/"/>
      <url>/2025/07/01/DDD/DDD%E5%AE%9E%E6%88%98-%E9%A1%B9%E7%9B%AE%E5%88%86%E5%B1%82/</url>
      
        <content type="html"><![CDATA[<h1 id="å®ç°æ•´æ´æ¶æ„é¡¹ç›®åˆ†å±‚"><a href="#å®ç°æ•´æ´æ¶æ„é¡¹ç›®åˆ†å±‚" class="headerlink" title="å®ç°æ•´æ´æ¶æ„é¡¹ç›®åˆ†å±‚"></a>å®ç°æ•´æ´æ¶æ„é¡¹ç›®åˆ†å±‚</h1><p>è¿™ä¸ªæ¡ˆä¾‹åˆ†ä¸ºUsers.Domainã€Users.Infrastructureã€Users.WebAPIè¿™ä¸‰ä¸ªé¡¹ç›®ã€‚</p><p>Users.Domainæ˜¯é¢†åŸŸå±‚é¡¹ç›®ï¼Œä¸»è¦åŒ…å«å®ä½“ç±»ã€å€¼å¯¹è±¡ã€é¢†åŸŸäº‹ä»¶æ•°æ®ç±»ã€é¢†åŸŸæœåŠ¡ã€ä»“å‚¨æ¥å£ã€é˜²è…å±‚æ¥å£ç­‰ï¼›</p><p>Users.Infrastructureæ˜¯åŸºç¡€è®¾æ–½é¡¹ç›®ï¼Œä¸»è¦åŒ…å«å®ä½“ç±»çš„é…ç½®ã€ä¸Šä¸‹æ–‡ç±»çš„å®šä¹‰ã€ä»“å‚¨æœåŠ¡ã€é˜²è…å±‚æ¥å£çš„å®ç°ã€åŸºç¡€å·¥å…·ç±»ç­‰ï¼›</p><p>Users.WebAPIæ˜¯ASP.NET Web APIé¡¹ç›®ï¼Œä¸»è¦åŒ…å«åº”ç”¨æœåŠ¡ã€Controllerç±»ã€é¢†åŸŸäº‹ä»¶å¤„ç†è€…ã€æ•°æ®æ ¡éªŒã€æƒé™æ ¡éªŒã€å·¥ä½œå•å…ƒã€äº‹åŠ¡å¤„ç†ç­‰ä»£ç ã€‚</p><p>Users.Domainé¡¹ç›®å¯¹åº”çš„æ˜¯æ•´æ´æ¶æ„ä¸­çš„é¢†åŸŸæ¨¡å‹å’Œé¢†åŸŸæœåŠ¡ï¼ŒUsers.Infrastructureé¡¹ç›®å¯¹åº”çš„æ˜¯æ•´æ´æ¶æ„ä¸­çš„åŸºç¡€è®¾æ–½ã€æ•°æ®åº“ã€å¤–éƒ¨æœåŠ¡ï¼ŒUsers.WebAPIé¡¹ç›®å¯¹åº”çš„æ˜¯æ•´æ´æ¶æ„ä¸­çš„ç”¨æˆ·ç•Œé¢å’Œåº”ç”¨æœåŠ¡ã€‚</p><p><img src="/img%5CDDD%5C22.png"></p><p>Users.Domainä¸ä¾èµ–ä»»ä½•é¡¹ç›®ï¼ŒUsers.Infrastructureä¾èµ–äºUsers.Domainï¼Œè€ŒUsers.WebAPIåŒæ—¶ä¾èµ–äºUsers.Domainå’ŒUsers.Infrastructureã€‚å› æ­¤Users.WebAPIæ—¢å¯ä»¥è°ƒç”¨Users.Domainä¸­çš„é¢†åŸŸæœåŠ¡ï¼Œä¹Ÿå¯ä»¥ç›´æ¥è°ƒç”¨Users.Infrastuctureã€‚å› æ­¤Users.WebAPIæ—¢å¯ä»¥è°ƒç”¨Users.Domainä¸­çš„é¢†åŸŸæœåŠ¡ï¼Œä¹Ÿå¯ä»¥ç›´æ¥è°ƒç”¨Users.Infrastructureä¸­ä¸Šä¸‹æ–‡çš„ä»£ç ï¼Œè€ŒUsers.Domainåˆ™ä¸å¯ä»¥ç›´æ¥è°ƒç”¨Users.Infrastructureä¸­ä¸Šä¸‹æ–‡çš„ä»£ç ï¼Œè€ŒUsers.Domainåˆ™ä¸å¯ä»¥ç›´æ¥è®¿é—®Users.Infrastructureï¼Œä½†æ˜¯Users.Domainå¯ä»¥é€šè¿‡è®¿é—®IUsersDomainRepositoryæ¥å£æ¥é—´æ¥è°ƒç”¨Users.Infrastructureä¸­çš„æœåŠ¡ã€‚</p><h1 id="é¢†åŸŸæ¨¡å‹çš„å®ç°"><a href="#é¢†åŸŸæ¨¡å‹çš„å®ç°" class="headerlink" title="é¢†åŸŸæ¨¡å‹çš„å®ç°"></a>é¢†åŸŸæ¨¡å‹çš„å®ç°</h1><p>æˆ‘ä»¬å°†å®ç°å®ä½“ç±»ã€å€¼å¯¹è±¡ç­‰åŸºç¡€çš„é¢†åŸŸæ¨¡å‹ï¼Œå¹¶ä¸”è¯†åˆ«å’Œå®šä¹‰å‡ºèšåˆåŠèšåˆæ ¹ï¼Œè¿™æ˜¯DDDçš„æˆ˜æœ¯èµ·ç‚¹ã€‚è¿™äº›ä»£ç éƒ½ä½äºUsers.Domainé¡¹ç›®ä¸­ã€‚</p><p>ä½œä¸ºä¸€ä¸ªç”¨æˆ·ç®¡ç†ç³»ç»Ÿï¼Œâ€œç”¨æˆ·ï¼ˆUserï¼‰â€æ˜¯æˆ‘ä»¬è¯†åˆ«å‡ºçš„ç¬¬ä¸€ä¸ªå®ä½“ç±»ï¼›â€œç”¨æˆ·ç™»å½•å¤±è´¥æ¬¡æ•°è¿‡å¤šåˆ™é”å®šâ€è¿™ä¸ªéœ€æ±‚å¹¶ä¸å±äºâ€œç”¨æˆ·â€è¿™ä¸ªå®ä½“ç±»ä¸­çš„ä¸€ä¸ªå¸¸ç”¨çš„ç‰¹å¾ï¼Œæˆ‘ä»¬åº”å½“æŠŠå®ƒæ‹†åˆ†åˆ°ä¸€ä¸ªå•ç‹¬çš„å®ä½“ç±»ä¸­ï¼Œå› æ­¤æˆ‘ä»¬è¯†åˆ«å‡ºä¸€ä¸ªå•ç‹¬çš„â€œç”¨æˆ·ç™»å½•å¤±è´¥â€ï¼ˆUserAccessFailï¼‰å®ä½“ç±»ï¼šâ€œç”¨æˆ·ç™»é™†è®°å½•â€ï¼ˆUserLoginHistoryï¼‰ä¹Ÿåº”è¯¥è¯†åˆ«ä¸ºä¸€ä¸ªå•ç‹¬çš„å®ä½“ç±»ã€‚Userå’ŒUserAccessFailçš„å…³ç³»æ˜¯éå¸¸ç´§å¯†çš„ï¼ŒUserAccessFailï¼Œå› æ­¤è¯¥Userå’ŒUserAccessFailä¸ä¼šç‹¬ç«‹äºUserå­˜åœ¨ï¼Œè€Œä¸”æˆ‘ä»¬åªæœ‰è®¿é—®åˆ°Userçš„æ—¶å€™æ‰ä¼šè®¿é—®UserAccessFailï¼Œå› æ­¤è¯¥Userå’ŒUserAccessFailè®¾è®¡ä¸ºåŒä¸€ä¸ªèšåˆï¼Œå¹¶ä¸”æŠŠUserè®¾ç½®ä¸ºèšåˆæ ¹ï¼›ç”±äºæˆ‘æ²¡æœ‰å¯èƒ½å•ç‹¬æŸ¥è¯¢ä¸€æ®µæ—¶é—´å†…çš„ç™»å½•è®°å½•ç­‰ç‹¬ç«‹ä¸æŸä¸ªç”¨æˆ·çš„éœ€æ±‚ï¼Œå› æ­¤æˆ‘ä»¬æŠŠUserLoginHistoryè®¾è®¡ä¸ºä¸€ä¸ªå•ç‹¬çš„èšåˆã€‚</p><h2 id="PhoneNumber"><a href="#PhoneNumber" class="headerlink" title="PhoneNumber"></a>PhoneNumber</h2><p>æˆ‘ä»¬çš„ç³»ç»Ÿä¸­éœ€è¦ä¿å­˜æ‰‹æœºå·ï¼Œç”±äºè¯¥ç³»ç»Ÿå¯èƒ½è¢«æµ·å¤–ç”¨æˆ·è®¿é—®ï¼Œè€Œæµ·å¤–ç”¨æˆ·çš„æ‰‹æœºå·è¿˜éœ€è¦åŒ…å«â€œå›½å®¶&#x2F;åœ°åŒºç â€ï¼Œå› æ­¤æˆ‘ä»¬è®¾è®¡äº†ç”¨æ¥è¡¨ç¤ºæ‰‹æœºå·çš„å€¼å¯¹è±¡PhoneNumberã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="comment">//æµ·å¤–æ‰‹æœºå·</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">record</span> <span class="title">PhoneNumber</span>(<span class="params"><span class="built_in">int</span> RegionCode, <span class="built_in">int</span> Number</span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Zack.Commons</p><p>ä¸ºäº†åŒºåˆ«èšåˆæ ¹å®ä½“ç±»å’Œæ™®é€šå®ä½“ç±»ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸åŒ…å«ä»»ä½•æˆå‘˜çš„æ ‡è¯†æ¥å£IAggregateRootï¼Œå¹¶ä¸”è®©æ‰€æœ‰çš„èšåˆæ ¹å®ä½“ç±»å®ç°è¿™ä¸ªæ¥å£ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IAggregateRoot</span></span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç¼–å†™UserAccessFailç±»"><a href="#ç¼–å†™UserAccessFailç±»" class="headerlink" title="ç¼–å†™UserAccessFailç±»"></a>ç¼–å†™UserAccessFailç±»</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Users.Domain.Entities</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ç”¨æˆ·è®¿é—®å¤±è´¥è®°å½•ç±»ï¼Œç”¨äºç®¡ç†ç”¨æˆ·ç™»å½•å¤±è´¥æ¬¡æ•°å’Œé”å®šçŠ¶æ€</span></span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">UserAccessFail</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ä¸»é”®Id</span></span><br><span class="line">        <span class="keyword">public</span> Guid Id &#123; <span class="keyword">get</span>; <span class="keyword">init</span>; &#125;</span><br><span class="line">        <span class="comment">// å…³è”çš„ç”¨æˆ·Id</span></span><br><span class="line">        <span class="keyword">public</span> Guid UserId &#123; <span class="keyword">get</span>; <span class="keyword">init</span>; &#125;</span><br><span class="line">        <span class="comment">// å…³è”çš„ç”¨æˆ·å¯¹è±¡</span></span><br><span class="line">        <span class="keyword">public</span> User User &#123; <span class="keyword">get</span>; <span class="keyword">init</span>; &#125;</span><br><span class="line">        <span class="comment">// æ˜¯å¦è¢«é”å®š</span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">bool</span> lockOut;</span><br><span class="line">        <span class="comment">// é”å®šç»“æŸæ—¶é—´</span></span><br><span class="line">        <span class="keyword">public</span> DateTime? LockoutEnd &#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="comment">// è¿ç»­å¤±è´¥æ¬¡æ•°</span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> AccessFailCount &#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç§æœ‰æ„é€ å‡½æ•°ï¼Œé˜²æ­¢å¤–éƒ¨ç›´æ¥åˆ›å»º</span></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="title">UserAccessFail</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é€šè¿‡ç”¨æˆ·å¯¹è±¡åˆ›å»ºè®¿é—®å¤±è´¥è®°å½•</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">UserAccessFail</span>(<span class="params">User user</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Id = Guid.NewGuid();</span><br><span class="line">            UserId = user.Id;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é‡ç½®å¤±è´¥æ¬¡æ•°å’Œé”å®šçŠ¶æ€</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Reset</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            lockOut = <span class="literal">false</span>;</span><br><span class="line">            LockoutEnd = <span class="literal">null</span>;</span><br><span class="line">            AccessFailCount = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ¤æ–­å½“å‰æ˜¯å¦å¤„äºé”å®šçŠ¶æ€</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="built_in">bool</span> <span class="title">IsLockOut</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (lockOut)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// å¦‚æœé”å®šè¿˜æœªåˆ°æœŸï¼Œè¿”å›true</span></span><br><span class="line">                <span class="keyword">if</span> (LockoutEnd &gt;= DateTime.Now)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">// é”å®šå·²è¿‡æœŸï¼Œé‡ç½®çŠ¶æ€</span></span><br><span class="line">                    AccessFailCount = <span class="number">0</span>;</span><br><span class="line">                    LockoutEnd = <span class="literal">null</span>;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç™»å½•å¤±è´¥æ—¶è°ƒç”¨ï¼Œå¢åŠ å¤±è´¥æ¬¡æ•°ï¼Œè¶…è¿‡5æ¬¡åˆ™é”å®š5åˆ†é’Ÿ</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Fail</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            AccessFailCount++;</span><br><span class="line">            <span class="keyword">if</span> (AccessFailCount &gt;= <span class="number">5</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                lockOut = <span class="literal">true</span>;</span><br><span class="line">                LockoutEnd = DateTime.Now.AddMinutes(<span class="number">5</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>UserAccessFailç±»åŒæ ·æ˜¯å……è¡€æ¨¡å‹ï¼Œå½“ç”¨æˆ·ç™»é™†å¤±è´¥ä¸€æ¬¡æ—¶ï¼Œæˆ‘ä»¬å°±è°ƒç”¨Failæ–¹æ³•æ¥è®°å½•å› æ­¤ç™»å½•å¤±è´¥ï¼Œå¦‚æœå‘ç°ç™»é™†å¤±è´¥è¶…è¿‡3æ¬¡ï¼Œæˆ‘ä»¬å°±é”å®šè¿™ä¸ªç”¨æˆ·5minï¼›æˆ‘ä»¬é€šè¿‡IsLockOutæ–¹æ³•åˆ¤æ–­è¿™ä¸ªè´¦æˆ·æ˜¯å¦å·²ç»è¢«é”å®šï¼›ä¸€æ—¦ç™»é™†æˆåŠŸä¸€æ¬¡ï¼Œæˆ‘ä»¬å°±è°ƒç”¨Resetæ–¹æ³•æ¥é‡ç½®ç™»å½•å¤±è´¥ä¿¡æ¯ã€‚ç”±äºå®ä½“ç±»ä¸­è¿›è¡Œçš„éƒ½æ˜¯æŠ½è±¡æ“ä½œï¼Œå¹¶ä¸ä¼šç›´æ¥è¿›è¡Œæ•°æ®åº“æ“ä½œï¼Œå› æ­¤æˆ‘ä»¬ç¼–å†™çš„å®ä½“ç±»ä¸­çš„Failã€Resetç­‰æ–¹æ³•éƒ½åªæ˜¯ä¿®æ”¹å®ä½“ç±»çš„å±æ€§ï¼Œå¹¶æ²¡æœ‰å†™å…¥æ•°æ®åº“çš„æ“ä½œã€‚</p><h2 id="User"><a href="#User" class="headerlink" title="User"></a>User</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Userèšåˆæ ¹ï¼Œè¡¨ç¤ºç³»ç»Ÿä¸­çš„ç”¨æˆ·å®ä½“</span></span><br><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">User</span> : <span class="title">IAggregateRoot</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ç”¨æˆ·å”¯ä¸€æ ‡è¯†</span></span><br><span class="line">    <span class="keyword">public</span> Guid Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç”¨æˆ·æ‰‹æœºå·ï¼ˆå€¼å¯¹è±¡ï¼‰ï¼Œåªå…è®¸å†…éƒ¨ä¿®æ”¹</span></span><br><span class="line">    <span class="keyword">public</span> PhoneNumber PhoneNumber &#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç”¨æˆ·å¯†ç çš„å“ˆå¸Œå€¼ï¼Œç§æœ‰å­—æ®µ</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span>? passwordHash;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç”¨æˆ·è®¿é—®å¤±è´¥ä¿¡æ¯ï¼ˆå¦‚ç™»å½•å¤±è´¥æ¬¡æ•°ã€é”å®šçŠ¶æ€ç­‰ï¼‰</span></span><br><span class="line">    <span class="keyword">public</span> UserAccessFail AccessFail &#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ— å‚æ„é€ å‡½æ•°ï¼Œä¾›ORMæˆ–åºåˆ—åŒ–ä½¿ç”¨</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span>()</span> &#123; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é€šè¿‡æ‰‹æœºå·åˆ›å»ºç”¨æˆ·ï¼ŒåŒæ—¶åˆå§‹åŒ–è®¿é—®å¤±è´¥ä¿¡æ¯</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span>(<span class="params">PhoneNumber phoneNumber</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Id = Guid.NewGuid();</span><br><span class="line">        PhoneNumber = phoneNumber;</span><br><span class="line">        AccessFail = <span class="keyword">new</span> UserAccessFail(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ¤æ–­ç”¨æˆ·æ˜¯å¦è®¾ç½®äº†å¯†ç </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">bool</span> <span class="title">HasPassword</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> !<span class="built_in">string</span>.IsNullOrEmpty(passwordHash);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¿®æ”¹ç”¨æˆ·å¯†ç ï¼Œå¯†ç é•¿åº¦å¿…é¡»å¤§äº3ä½ï¼Œå†…éƒ¨å­˜å‚¨ä¸ºMD5å“ˆå¸Œ</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ChangePassword</span>(<span class="params"><span class="built_in">string</span> <span class="keyword">value</span></span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">value</span>.Length &lt;= <span class="number">3</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;å¯†ç é•¿åº¦ä¸èƒ½å°äºç­‰äº3&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        passwordHash = HashHelper.ComputeMd5Hash(<span class="keyword">value</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ£€æŸ¥è¾“å…¥çš„å¯†ç æ˜¯å¦æ­£ç¡®ï¼ˆä¸å­˜å‚¨çš„å“ˆå¸Œå€¼æ¯”å¯¹ï¼‰</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">bool</span> <span class="title">CheckPassword</span>(<span class="params"><span class="built_in">string</span> password</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> passwordHash == HashHelper.ComputeMd5Hash(password);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¿®æ”¹ç”¨æˆ·æ‰‹æœºå·</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ChangePhoneNumber</span>(<span class="params">PhoneNumber phoneNumber</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        PhoneNumber = phoneNumber;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œä½œä¸ºèšåˆæ ¹ï¼ŒUserç±»å®ç°äº†IAggregateRootæ¥å£ï¼Œè€Œä¸”å®ƒæ˜¯ä¸€ä¸ªå……è¡€æ¨¡å‹ã€‚å¯†ç çš„å“ˆå¸Œå€¼ä¸åº”è¯¥è¢«å¤–ç•Œè®¿é—®åˆ°ï¼Œå› æ­¤passwordHashè¢«å®šä¹‰ä¸ºç§æœ‰çš„æˆå‘˜å˜é‡ã€‚ç”±äºç”¨æˆ·å¯ä»¥ä¸è®¾ç½®å¯†ç ï¼Œè€Œä½¿ç”¨æ‰‹æœºå·åŠ çŸ­ä¿¡éªŒè¯ç ç™»å½•ï¼Œå› æ­¤passwordHashè¢«å®šä¹‰ä¸ºå¯ç©ºçš„stringç±»å‹ï¼Œå¹¶ä¸”æä¾›äº†HasPasswordæ–¹æ³•ç”¨äºåˆ¤æ–­ç”¨æˆ·æ˜¯å¦è®¾ç½®äº†å¯†ç ã€‚ChangePasswordã€CheckPasswordä¸¤ä¸ªæ–¹æ³•åˆ†åˆ«ç”¨äºä¿®æ”¹å¯†ç å’Œæ£€æŸ¥ç”¨æˆ·è¾“å…¥çš„å¯†ç æ˜¯å¦æ­£ç¡®ï¼Œç”±äºâ€œå¯†ç é‡‡ç”¨å“ˆå¸Œå€¼ä¿å­˜â€å±äºUserç±»çš„å†…éƒ¨å®ç°ç»†èŠ‚ï¼Œå› æ­¤è®¡ç®—æ˜æ–‡å¯†ç çš„å“ˆå¸Œå€¼çš„æ“ä½œåœ¨ChangePasswordã€CheckPasswrodä¸¤ä¸ªæ–¹æ³•ä¸­å®Œæˆã€‚</p><h2 id="UserAccessFail"><a href="#UserAccessFail" class="headerlink" title="UserAccessFail"></a>UserAccessFail</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> ç”¨æˆ·ç™»å½•å†å²è®°å½•å®ä½“ï¼Œè¡¨ç¤ºç”¨æˆ·æ¯æ¬¡ç™»å½•çš„ç›¸å…³ä¿¡æ¯ã€‚</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">UserLoginHistory</span> : <span class="title">IAggregateRoot</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ä¸»é”®ï¼Œè‡ªå¢IDã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">init</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ç”¨æˆ·IDï¼Œå¯èƒ½ä¸ºnullï¼ˆå¦‚æœªæ³¨å†Œç”¨æˆ·ï¼‰ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> Guid? UserId &#123; <span class="keyword">get</span>; <span class="keyword">init</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ç”¨æˆ·ç™»å½•æ—¶ä½¿ç”¨çš„æ‰‹æœºå·ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> PhoneNumber PhoneNumber &#123; <span class="keyword">get</span>; <span class="keyword">init</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ç™»å½•æ—¶é—´ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> DateTime LoginTime &#123; <span class="keyword">get</span>; <span class="keyword">init</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ç™»å½•ç›¸å…³æ¶ˆæ¯æˆ–æè¿°ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Messsage &#123; <span class="keyword">get</span>; <span class="keyword">init</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ORMæˆ–åºåˆ—åŒ–ä½¿ç”¨çš„æ— å‚æ„é€ å‡½æ•°ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">UserLoginHistory</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ORMæˆ–åºåˆ—åŒ–ä½¿ç”¨çš„æ— å‚æ„é€ å‡½æ•°</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> åˆ›å»ºç”¨æˆ·ç™»å½•å†å²è®°å½•çš„æ–°å®ä¾‹ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;userId&quot;&gt;</span>ç”¨æˆ·ID<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;phoneNumber&quot;&gt;</span>æ‰‹æœºå·<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;loginTime&quot;&gt;</span>ç™»å½•æ—¶é—´<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;message&quot;&gt;</span>ç™»å½•æ¶ˆæ¯<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UserLoginHistory</span>(<span class="params">Guid? userId, PhoneNumber phoneNumber, DateTime loginTime, <span class="built_in">string</span> message</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        UserId = userId;</span><br><span class="line">        PhoneNumber = phoneNumber;</span><br><span class="line">        LoginTime = loginTime;</span><br><span class="line">        Messsage = message;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœç”¨æˆ·è¾“å…¥ä¸€ä¸ªç³»ç»Ÿä¸­ä¸å­˜åœ¨çš„æ‰‹æœºå·ï¼Œæˆ‘ä»¬ä¹Ÿè¦æŠŠä»–è®°å½•åˆ°æ—¥å¿—ä¸­ï¼Œå› æ­¤UserIdå±æ€§ä¸ºå¯ç©ºçš„Guidç±»å‹ã€‚ç”±äºUserLoginHistoryç±»æ˜¯ç‹¬ç«‹çš„èšåˆï¼Œè€Œåœ¨DDDä¸­ï¼Œèšåˆä¹‹é—´åªé€šè¿‡èšåˆæ ¹å®ä½“ç±»çš„æ ‡è¯†æ¥å¼•ç”¨ï¼Œå› æ­¤UserLoginHistoryç±»ä¸­åªå®šä¹‰UserIdå±æ€§ï¼Œè€Œä¸æ˜¯å®šä¹‰Userå±æ€§ï¼Œè¿™æ ·æˆ‘ä»¬å°±æŠŠèšåˆä¹‹é—´çš„è€¦åˆåº¦é™ä½äº†ã€‚ä»é€»è¾‘ä¸Šæ¥è®²ï¼ŒUserLoginHistoryç±»çš„UserIdå±æ€§æ˜¯ä¸€ä¸ªæŒ‡å‘Userå®ä½“ç±»çš„å¤–é”®ï¼Œä½†æ˜¯åœ¨ç‰©ç†ä¸Šï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰åˆ›å»ºå®ƒä»¬çš„å¤–é”®å…³ç³»ï¼Œè¿™ä¸ç¬¦åˆç»å…¸çš„æ•°æ®åº“èŒƒå¼ç†è®ºï¼Œä½†æ˜¯è¿™æ ·åšæœ‰åˆ©äºåˆ†åº“åˆ†è¡¨ã€æ•°æ®åº“è¿ç§»å¹¶ä¸”æ€§èƒ½æ›´å¥½ï¼Œå› æ­¤è¿™ç§ä¸é”®ç‰©ç†å¤–é”®çš„åšæ³•è¶Šæ¥è¶Šå¸¸è§ã€‚</p><h1 id="é¢†åŸŸæœåŠ¡çš„å®ç°"><a href="#é¢†åŸŸæœåŠ¡çš„å®ç°" class="headerlink" title="é¢†åŸŸæœåŠ¡çš„å®ç°"></a>é¢†åŸŸæœåŠ¡çš„å®ç°</h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> è¡¨ç¤ºç”¨æˆ·è®¿é—®ç»“æœçš„æšä¸¾ã€‚</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="built_in">enum</span> UserAccessResult</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> è®¿é—®æˆåŠŸã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    OK,</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æœªæ‰¾åˆ°æ‰‹æœºå·ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    PhoneNumberNotFound,</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ç”¨æˆ·è¢«é”å®šã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    Lockout,</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æœªè®¾ç½®å¯†ç ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    NoPassword,</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> å¯†ç é”™è¯¯ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    PasswordError</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> ç”¨æˆ·è®¿é—®ç»“æœäº‹ä»¶ã€‚</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> ç”¨äºåœ¨ç”¨æˆ·è®¿é—®ï¼ˆå¦‚ç™»å½•ã€æ³¨å†Œç­‰ï¼‰åï¼Œå‘å¸ƒè®¿é—®ç»“æœä¿¡æ¯ã€‚</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;PhoneNumber&quot;&gt;</span>ç”¨æˆ·æ‰‹æœºå·ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;Result&quot;&gt;</span>è®¿é—®ç»“æœã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">record</span> <span class="keyword">class</span> <span class="title">UserAccessResultEvent</span>(<span class="params">PhoneNumber PhoneNumber, UserAccessResult Result</span>) : INotification</span>;</span><br></pre></td></tr></table></figure><h2 id="IUserDomainRepository"><a href="#IUserDomainRepository" class="headerlink" title="IUserDomainRepository"></a>IUserDomainRepository</h2><p>é¢†åŸŸæœåŠ¡éœ€è¦ä½¿ç”¨ä»“å‚¨æ¥å£æ¥é€šè¿‡æŒä¹…å±‚è¯»å†™æ•°æ®ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åœ¨Users.Domainé¡¹ç›®ä¸­ç¼–å†™ä»“å‚¨æ¥å£IUserDomainRepositoryï¼Œè¿™äº›ä»£ç éƒ½ä½äºUsers.Domainé¡¹ç›®ä¸­ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Users.Domain</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ç”¨æˆ·é¢†åŸŸä»“å‚¨æ¥å£ï¼Œå®šä¹‰ç”¨æˆ·ç›¸å…³çš„æ•°æ®è®¿é—®æ“ä½œã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IUserDomainRepository</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ ¹æ®æ‰‹æœºå·æŸ¥æ‰¾ç”¨æˆ·ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;phoneNumber&quot;&gt;</span>ç”¨æˆ·æ‰‹æœºå·ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>æ‰¾åˆ°çš„ç”¨æˆ·å¯¹è±¡ï¼Œæ‰¾ä¸åˆ°è¿”å›nullã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        Task&lt;User?&gt; FindOneAsync(PhoneNumber phoneNumber);</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ ¹æ®ç”¨æˆ·å”¯ä¸€æ ‡è¯†æŸ¥æ‰¾ç”¨æˆ·ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;userId&quot;&gt;</span>ç”¨æˆ·å”¯ä¸€æ ‡è¯†ï¼ˆGuidï¼‰ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>æ‰¾åˆ°çš„ç”¨æˆ·å¯¹è±¡ï¼Œæ‰¾ä¸åˆ°è¿”å›nullã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        Task&lt;User?&gt; FindOneAsync(Guid userId);</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ–°å¢ä¸€æ¡ç”¨æˆ·ç™»å½•å†å²è®°å½•ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;phoneNumber&quot;&gt;</span>ç”¨æˆ·æ‰‹æœºå·ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;msg&quot;&gt;</span>ç™»å½•ç›¸å…³ä¿¡æ¯ï¼ˆå¦‚ç™»å½•ç»“æœã€æ—¶é—´ç­‰ï¼‰ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function">Task <span class="title">AddNewLoginHistoryAsync</span>(<span class="params">PhoneNumber phoneNumber, <span class="built_in">string</span> msg</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å‘å¸ƒç”¨æˆ·è®¿é—®ç»“æœé¢†åŸŸäº‹ä»¶ï¼ˆå¦‚ç™»å½•æˆåŠŸã€å¤±è´¥ç­‰ï¼‰ï¼Œç”¨äºé¢†åŸŸäº‹ä»¶é€šçŸ¥ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;eventData&quot;&gt;</span>ç”¨æˆ·è®¿é—®ç»“æœäº‹ä»¶æ•°æ®ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function">Task <span class="title">PublishEventAsync</span>(<span class="params">UserAccessResultEvent eventData</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ä¿å­˜æ‰‹æœºéªŒè¯ç ï¼ˆå¦‚çŸ­ä¿¡éªŒè¯ç ï¼‰ï¼Œç”¨äºåç»­æ ¡éªŒã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;phoneNumber&quot;&gt;</span>ç”¨æˆ·æ‰‹æœºå·ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;code&quot;&gt;</span>éªŒè¯ç å†…å®¹ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function">Task <span class="title">SavePhoneCodeAsync</span>(<span class="params">PhoneNumber phoneNumber, <span class="built_in">string</span> code</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> è·å–æŒ‡å®šæ‰‹æœºå·æœ€è¿‘ä¿å­˜çš„éªŒè¯ç ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;phoneNumber&quot;&gt;</span>ç”¨æˆ·æ‰‹æœºå·ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>éªŒè¯ç å†…å®¹ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function">Task&lt;<span class="built_in">string</span>&gt; <span class="title">RetrievePhoneCodeAsync</span>(<span class="params">PhoneNumber phoneNumber</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸¤ä¸ªFindOneAsyncæ–¹æ³•åˆ†åˆ«ç”¨äºæ ¹æ®æ‰‹æœºå·å’Œç”¨æˆ·IDæŸ¥æ‰¾ç”¨æˆ·ï¼›AddNewLoginHistoryAsyncæ–¹æ³•ç”¨äºè®°å½•ä¸€æ¬¡ç™»å½•æ“ä½œï¼›PublishEventAsyncæ–¹æ³•ç”¨äºå‘å¸ƒé¢†åŸŸäº‹ä»¶ï¼›SavePhoneCodeAsyncæ–¹æ³•ç”¨äºä¿å­˜çŸ­ä¿¡éªŒè¯ç ï¼Œè€ŒRetrievePhoneCodeAsyncæ–¹æ³•ç”¨äºè·å–ä¿å­˜çš„çŸ­ä¿¡éªŒè¯ç ã€‚</p><h2 id="ISmsCodeSender"><a href="#ISmsCodeSender" class="headerlink" title="ISmsCodeSender"></a>ISmsCodeSender</h2><p>ISmsCodeSenderæ˜¯ç”¨äºå‘é€çŸ­ä¿¡éªŒè¯ç çš„é˜²è…å±‚æ¥å£ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> å®šä¹‰ç”¨äºå‘é€çŸ­ä¿¡éªŒè¯ç çš„æ¥å£ã€‚</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">ISmsCodeSender</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> å¼‚æ­¥å‘é€çŸ­ä¿¡éªŒè¯ç åˆ°æŒ‡å®šæ‰‹æœºå·ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;phoneNumber&quot;&gt;</span>æ¥æ”¶éªŒè¯ç çš„æ‰‹æœºå·ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;code&quot;&gt;</span>è¦å‘é€çš„éªŒè¯ç å†…å®¹ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>è¡¨ç¤ºå¼‚æ­¥æ“ä½œçš„ä»»åŠ¡ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function">Task <span class="title">SendCodeAsync</span>(<span class="params">PhoneNumber phoneNumber, <span class="built_in">string</span> code</span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> è¡¨ç¤ºæ ¡éªŒéªŒè¯ç çš„ç»“æœã€‚</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="built_in">enum</span> CheckCodeResult</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æ ¡éªŒæˆåŠŸã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    OK,</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æœªæ‰¾åˆ°å¯¹åº”çš„æ‰‹æœºå·ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    PhoneNumberNotFound,</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ç”¨æˆ·å·²è¢«é”å®šã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    Lockout,</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> éªŒè¯ç é”™è¯¯ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    CodeError</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="UserDomainService"><a href="#UserDomainService" class="headerlink" title="UserDomainService"></a>UserDomainService</h2><p>å®ä½“ç±»ä¸­å®šä¹‰çš„æ–¹æ³•åªæ˜¯å’Œç‰¹å®šå®ä½“ç±»ç›¸å…³çš„ä¸šåŠ¡é€»è¾‘ä»£ç ï¼Œè€Œè·¨å®ä½“ç±»ã€è·¨èšåˆçš„ä»£ç éœ€è¦å®šä¹‰åœ¨é¢†åŸŸæœåŠ¡æˆ–è€…åº”ç”¨æœåŠ¡ä¸­ã€‚å› æ­¤æˆ‘ä»¬ç¼–å†™é¢†åŸŸæœåŠ¡UserDomainServiceã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Users.Domain</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ç”¨æˆ·é¢†åŸŸæœåŠ¡ï¼Œå°è£…ç”¨æˆ·ç›¸å…³çš„ä¸šåŠ¡é€»è¾‘ï¼Œå¦‚ç™»å½•ã€éªŒè¯ç å‘é€ä¸æ ¡éªŒã€è®¿é—®å¤±è´¥å¤„ç†ç­‰ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UserDomainService</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ç”¨æˆ·ä»“å‚¨æ¥å£ï¼Œç”¨äºæ•°æ®æŒä¹…åŒ–å’ŒæŸ¥è¯¢</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> IUserDomainRepository repository;</span><br><span class="line">        <span class="comment">// çŸ­ä¿¡éªŒè¯ç å‘é€å™¨æ¥å£</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> ISmsCodeSender smsSender;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ„é€ å‡½æ•°ï¼Œæ³¨å…¥ä»“å‚¨å’ŒçŸ­ä¿¡å‘é€å™¨</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">UserDomainService</span>(<span class="params">IUserDomainRepository repository, ISmsCodeSender smsSender</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.repository = repository;</span><br><span class="line">            <span class="keyword">this</span>.smsSender = smsSender;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> é‡ç½®ç”¨æˆ·çš„è®¿é—®å¤±è´¥æ¬¡æ•°å’Œé”å®šçŠ¶æ€</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ResetAccessFail</span>(<span class="params">User user</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            user.AccessFail.Reset();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> åˆ¤æ–­ç”¨æˆ·æ˜¯å¦è¢«é”å®š</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="built_in">bool</span> <span class="title">IsLockOut</span>(<span class="params">User user</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> user.AccessFail.IsLockOut();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> è®°å½•ä¸€æ¬¡ç”¨æˆ·è®¿é—®å¤±è´¥ï¼ˆå¦‚ç™»å½•å¤±è´¥ï¼‰ï¼Œå¹¶æ ¹æ®å¤±è´¥æ¬¡æ•°è‡ªåŠ¨é”å®š</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AccessFail</span>(<span class="params">User user</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            user.AccessFail.Fail();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ£€æŸ¥ç”¨æˆ·ç™»å½•ï¼Œè¿”å›ç™»å½•ç»“æœï¼ˆå¦‚æˆåŠŸã€å¯†ç é”™è¯¯ã€è¢«é”å®šç­‰ï¼‰</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;phoneNum&quot;&gt;</span>ç”¨æˆ·æ‰‹æœºå·<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;password&quot;&gt;</span>ç”¨æˆ·è¾“å…¥çš„å¯†ç <span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>ç™»å½•ç»“æœæšä¸¾<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;UserAccessResult&gt; <span class="title">CheckLoginAsync</span>(<span class="params">PhoneNumber phoneNum, <span class="built_in">string</span> password</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// æ ¹æ®æ‰‹æœºå·æŸ¥æ‰¾ç”¨æˆ·</span></span><br><span class="line">            User? user = <span class="keyword">await</span> repository.FindOneAsync(phoneNum);</span><br><span class="line">            UserAccessResult result;</span><br><span class="line">            <span class="keyword">if</span> (user == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// ç”¨æˆ·ä¸å­˜åœ¨</span></span><br><span class="line">                result = UserAccessResult.PhoneNumberNotFound;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (IsLockOut(user))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// ç”¨æˆ·è¢«é”å®š</span></span><br><span class="line">                result = UserAccessResult.Lockout;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (user.HasPassword() == <span class="literal">false</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// ç”¨æˆ·æœªè®¾ç½®å¯†ç </span></span><br><span class="line">                result = UserAccessResult.NoPassword;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (user.CheckPassword(password))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// å¯†ç æ­£ç¡®</span></span><br><span class="line">                result = UserAccessResult.OK;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// å¯†ç é”™è¯¯</span></span><br><span class="line">                result = UserAccessResult.PasswordError;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (user != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (result == UserAccessResult.OK)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">// ç™»å½•æˆåŠŸï¼Œé‡ç½®å¤±è´¥æ¬¡æ•°</span></span><br><span class="line">                    ResetAccessFail(user);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">// ç™»å½•å¤±è´¥ï¼Œè®°å½•å¤±è´¥</span></span><br><span class="line">                    AccessFail(user);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å‘å¸ƒç™»å½•ç»“æœäº‹ä»¶</span></span><br><span class="line">            UserAccessResultEvent eventItem = <span class="keyword">new</span>(phoneNum, result);</span><br><span class="line">            <span class="keyword">await</span> repository.PublishEventAsync(eventItem);</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å‘é€çŸ­ä¿¡éªŒè¯ç åˆ°æŒ‡å®šæ‰‹æœºå·</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;phoneNum&quot;&gt;</span>ç”¨æˆ·æ‰‹æœºå·<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>å‘é€ç»“æœ<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;UserAccessResult&gt; <span class="title">SendCodeAsync</span>(<span class="params">PhoneNumber phoneNum</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> user = <span class="keyword">await</span> repository.FindOneAsync(phoneNum);</span><br><span class="line">            <span class="keyword">if</span> (user == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// ç”¨æˆ·ä¸å­˜åœ¨</span></span><br><span class="line">                <span class="keyword">return</span> UserAccessResult.PhoneNumberNotFound;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (IsLockOut(user))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// ç”¨æˆ·è¢«é”å®š</span></span><br><span class="line">                <span class="keyword">return</span> UserAccessResult.Lockout;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// ç”Ÿæˆ4ä½éšæœºéªŒè¯ç </span></span><br><span class="line">            <span class="built_in">string</span> code = Random.Shared.Next(<span class="number">1000</span>, <span class="number">9999</span>).ToString();</span><br><span class="line">            <span class="comment">// ä¿å­˜éªŒè¯ç åˆ°ä»“å‚¨</span></span><br><span class="line">            <span class="keyword">await</span> repository.SavePhoneCodeAsync(phoneNum, code);</span><br><span class="line">            <span class="comment">// å‘é€éªŒè¯ç çŸ­ä¿¡</span></span><br><span class="line">            <span class="keyword">await</span> smsSender.SendCodeAsync(phoneNum, code);</span><br><span class="line">            <span class="keyword">return</span> UserAccessResult.OK;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ ¡éªŒç”¨æˆ·è¾“å…¥çš„çŸ­ä¿¡éªŒè¯ç æ˜¯å¦æ­£ç¡®</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;phoneNum&quot;&gt;</span>ç”¨æˆ·æ‰‹æœºå·<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;code&quot;&gt;</span>ç”¨æˆ·è¾“å…¥çš„éªŒè¯ç <span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>æ ¡éªŒç»“æœ<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;CheckCodeResult&gt; <span class="title">CheckCodeAsync</span>(<span class="params">PhoneNumber phoneNum, <span class="built_in">string</span> code</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> user = <span class="keyword">await</span> repository.FindOneAsync(phoneNum);</span><br><span class="line">            <span class="keyword">if</span> (user == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// ç”¨æˆ·ä¸å­˜åœ¨</span></span><br><span class="line">                <span class="keyword">return</span> CheckCodeResult.PhoneNumberNotFound;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (IsLockOut(user))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// ç”¨æˆ·è¢«é”å®š</span></span><br><span class="line">                <span class="keyword">return</span> CheckCodeResult.Lockout;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// è·å–æœåŠ¡å™¨ç«¯ä¿å­˜çš„éªŒè¯ç </span></span><br><span class="line">            <span class="built_in">string</span>? codeInServer = <span class="keyword">await</span> repository.RetrievePhoneCodeAsync(phoneNum);</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrEmpty(codeInServer))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// æ²¡æœ‰éªŒè¯ç æˆ–å·²è¿‡æœŸ</span></span><br><span class="line">                <span class="keyword">return</span> CheckCodeResult.CodeError;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (code == codeInServer)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// éªŒè¯ç æ­£ç¡®</span></span><br><span class="line">                <span class="keyword">return</span> CheckCodeResult.OK;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// éªŒè¯ç é”™è¯¯ï¼Œè®°å½•ä¸€æ¬¡å¤±è´¥</span></span><br><span class="line">                AccessFail(user);</span><br><span class="line">                <span class="keyword">return</span> CheckCodeResult.CodeError;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å› ä¸ºåœ¨å®ç°é¢†åŸŸæœåŠ¡çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦è°ƒç”¨ä»“å‚¨æœåŠ¡å’ŒçŸ­ä¿¡å‘é€æœåŠ¡ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡æ„é€ æ–¹æ³•æ³¨å…¥IUserDomainRepositoryå’ŒISmsCodeSender,æˆ‘ä»¬å†è°ƒç”¨è¿™ä¸¤ä¸ªæœåŠ¡çš„æ–¹æ³•çš„æ—¶å€™ï¼Œå¹¶ä¸éœ€è¦å…³å¿ƒå®ƒä»¬æ˜¯ç”±å“ªä¸ªç±»å®ç°çš„ï¼Œä»¥åŠæ˜¯å¦‚ä½•å®ç°çš„ï¼Œè¿™å°±æ˜¯â€œä¾èµ–äºæ¥å£ï¼Œè€Œéä¾èµ–äºç°å®â€çš„ä¾èµ–åè½¬å¸¦æ¥ç»™ç³»ç»Ÿæ¶æ„çš„å¥½å¤„ã€‚</p><p>ç”±äºUseræ˜¯èšåˆæ ¹ï¼Œæ‰€ä»¥å¯¹UserAccessFailçš„æ“ä½œéƒ½é€šè¿‡Userè¿›è¡Œï¼Œå› æ­¤æˆ‘ä»¬åœ¨UserDomainServiceä¸­å®šä¹‰çš„AccessFailç­‰æ–¹æ³•éƒ½æ˜¯é€šè¿‡Userè¿›è¡Œçš„ã€‚<br>Userç­‰å®ä½“ç±»ä¸­éƒ½æ˜¯å’Œå®ä½“ç±»ç›¸å…³çš„ä»£ç ï¼Œè€ŒUserDomainServiceé¢†åŸŸæœåŠ¡ä¸­éƒ½æ˜¯è·¨å®ä½“ç±»æ“ä½œçš„ä»£ç ã€‚</p><h1 id="åŸºç¡€è®¾æ–½çš„å®ç°"><a href="#åŸºç¡€è®¾æ–½çš„å®ç°" class="headerlink" title="åŸºç¡€è®¾æ–½çš„å®ç°"></a>åŸºç¡€è®¾æ–½çš„å®ç°</h1><p>é¢†åŸŸæ¨¡å‹ã€é¢†åŸŸæœåŠ¡ä¸­åªå®šä¹‰äº†æŠ½è±¡çš„å®ä½“ç±»ã€é˜²è…å±‚å’Œä»“å‚¨ï¼Œæˆ‘ä»¬éœ€è¦åœ¨åŸºç¡€è®¾æ–½ä¸­å¯¹å®ƒä»¬è¿›è¡Œè½åœ°å’Œå®ç°ã€‚è¿™äº›ä»£ç éƒ½ä½äºUsers.Infrastructureé¡¹ç›®ä¸­ã€‚</p><h2 id="UserConfig-UserAccessFailConfig-UserLoginHistoryConfig"><a href="#UserConfig-UserAccessFailConfig-UserLoginHistoryConfig" class="headerlink" title="UserConfig\UserAccessFailConfig\UserLoginHistoryConfig"></a>UserConfig\UserAccessFailConfig\UserLoginHistoryConfig</h2><p>å®ä½“ç±»ã€å€¼å¯¹è±¡çš„å®šä¹‰æ˜¯å’ŒæŒä¹…æœºåˆ¶æ— å…³çš„ï¼Œå®ƒä»¬éœ€è¦é€šè¿‡EF Coreçš„é…ç½®ã€ä¸Šä¸‹æ–‡ç­‰å»ºç«‹å’Œæ•°æ®åº“çš„å…³ç³»ï¼ŒUserçš„é…ç½®ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Users.Infrastructure.Configs</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ç”¨æˆ·å®ä½“çš„EF Coreé…ç½®ç±»ï¼Œå®šä¹‰è¡¨ç»“æ„åŠç›¸å…³æ˜ å°„è§„åˆ™</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">UserConfig</span> : <span class="title">IEntityTypeConfiguration</span>&lt;<span class="title">User</span>&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> é…ç½®Userå®ä½“çš„æ•°æ®åº“æ˜ å°„</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;builder&quot;&gt;</span>å®ä½“ç±»å‹æ„å»ºå™¨<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">EntityTypeBuilder&lt;User&gt; builder</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// æ˜ å°„åˆ°è¡¨T_Users</span></span><br><span class="line">            builder.ToTable(<span class="string">&quot;T_Users&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// é…ç½®PhoneNumberå€¼å¯¹è±¡çš„å±æ€§æ˜ å°„</span></span><br><span class="line">            builder.OwnsOne(x =&gt; x.PhoneNumber, nb =&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// åŒºå·æœ€å¤§é•¿åº¦5ï¼ŒéUnicode</span></span><br><span class="line">                nb.Property(x =&gt; x.RegionCode).HasMaxLength(<span class="number">5</span>).IsUnicode(<span class="literal">false</span>);</span><br><span class="line">                <span class="comment">// æ‰‹æœºå·æœ€å¤§é•¿åº¦20ï¼ŒéUnicode</span></span><br><span class="line">                nb.Property(x =&gt; x.Number).HasMaxLength(<span class="number">20</span>).IsUnicode(<span class="literal">false</span>);</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// é…ç½®ç§æœ‰å­—æ®µpasswordHashçš„æ˜ å°„ï¼Œæœ€å¤§é•¿åº¦100ï¼ŒéUnicode</span></span><br><span class="line">            builder.Property(<span class="string">&quot;passwordHash&quot;</span>).HasMaxLength(<span class="number">100</span>).IsUnicode(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// é…ç½®ä¸€å¯¹ä¸€å…³ç³»ï¼šUseræœ‰ä¸€ä¸ªAccessFailï¼ŒUserAccessFailæœ‰ä¸€ä¸ªUser</span></span><br><span class="line">            builder.HasOne(x =&gt; x.AccessFail).WithOne(x =&gt; x.User)</span><br><span class="line">               <span class="comment">// é…ç½®UserAccessFailçš„å¤–é”®ï¼ŒæŒ‡å®šUserIdä¸ºå¤–é”®å­—æ®µ</span></span><br><span class="line">               .HasForeignKey&lt;UserAccessFail&gt;(x =&gt; x.UserId);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯¹å€¼å¯¹è±¡PhoneNumberè¿›è¡Œäº†é…ç½®ï¼›ç”±äºpasswordHashæ˜¯ä¸€ä¸ªç§æœ‰æˆå‘˜å˜é‡ï¼Œå› æ­¤æˆ‘ä»¬å¯¹ä»–è¿›è¡Œç‰¹æ®Šçš„é…ç½®ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Users.Infrastructure.Configs</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">UserAccessFailConfig</span> : <span class="title">IEntityTypeConfiguration</span>&lt;<span class="title">UserAccessFail</span>&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">Microsoft.EntityFrameworkCore.Metadata.Builders.EntityTypeBuilder&lt;UserAccessFail&gt; builder</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            builder.ToTable(<span class="string">&quot;T_UserAccessFails&quot;</span>);</span><br><span class="line">            builder.Property(<span class="string">&quot;lockOut&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Users.Infrastructure.Configs</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">UserLoginHistoryConfig</span> : <span class="title">IEntityTypeConfiguration</span>&lt;<span class="title">UserLoginHistory</span>&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">EntityTypeBuilder&lt;UserLoginHistory&gt; builder</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            builder.ToTable(<span class="string">&quot;T_UserLoginHistories&quot;</span>);</span><br><span class="line">            builder.OwnsOne(x=&gt;x.PhoneNumber, nb =&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// åŒºå·æœ€å¤§é•¿åº¦5ï¼ŒéUnicode</span></span><br><span class="line">                nb.Property(x =&gt; x.RegionCode).HasMaxLength(<span class="number">5</span>).IsUnicode(<span class="literal">false</span>);</span><br><span class="line">                <span class="comment">// æ‰‹æœºå·æœ€å¤§é•¿åº¦20ï¼ŒéUnicode</span></span><br><span class="line">                nb.Property(x =&gt; x.Number).HasMaxLength(<span class="number">20</span>).IsUnicode(<span class="literal">false</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="UserDbContext"><a href="#UserDbContext" class="headerlink" title="UserDbContext"></a>UserDbContext</h2><p>UserDbContextå®šä¹‰åœ¨Users.Infrastructureé¡¹ç›®ä¸­ï¼Œå¹¶ä¸”åªä¸ºUserã€UserLoginHistoryä¸¤ä¸ªèšåˆæ ¹å®ä½“ç±»å£°æ˜DbSetå±æ€§ï¼Œè€Œä¸ä¸ºUserèšåˆä¸­çš„UserAccessFailå®ä½“ç±»å®šä¹‰DbSetå±æ€§ï¼Œè¿™æ ·å°±çº¦æŸå¼€å‘äººå‘˜å°½é‡é€šè¿‡èšåˆæ ¹æ¥æ“ä½œèšåˆå†…çš„å®ä½“ç±»ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Users.Infrastructure</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// UserDbContext æ˜¯ç”¨æˆ·æ¨¡å—çš„æ•°æ®åº“ä¸Šä¸‹æ–‡ï¼Œè´Ÿè´£ä¸æ•°æ®åº“è¿›è¡Œäº¤äº’</span></span><br><span class="line">    <span class="comment">// ç»§æ‰¿è‡ª Entity Framework Core çš„ DbContext</span></span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">UserDbContext</span> : <span class="title">DbContext</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Users è¡¨ç¤ºç”¨æˆ·å®ä½“é›†åˆï¼Œå¯¹åº”æ•°æ®åº“ä¸­çš„ç”¨æˆ·è¡¨</span></span><br><span class="line">        <span class="keyword">public</span> DbSet&lt;User&gt; Users &#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="comment">// LoginHistories è¡¨ç¤ºç”¨æˆ·ç™»å½•å†å²è®°å½•é›†åˆï¼Œå¯¹åº”æ•°æ®åº“ä¸­çš„ç™»å½•å†å²è¡¨</span></span><br><span class="line">        <span class="keyword">public</span> DbSet&lt;UserLoginHistory&gt; LoginHistories &#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ„é€ å‡½æ•°ï¼Œæ¥æ”¶æ•°æ®åº“ä¸Šä¸‹æ–‡é…ç½®å‚æ•°</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">UserDbContext</span>(<span class="params">DbContextOptions&lt;UserDbContext&gt; options</span>) : <span class="title">base</span>(<span class="params">options</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é…ç½®å®ä½“æ¨¡å‹çš„æ˜ å°„å…³ç³»</span></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnModelCreating</span>(<span class="params">ModelBuilder modelBuilder</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// è°ƒç”¨åŸºç±»æ–¹æ³•ï¼Œä¿è¯åŸºç¡€é…ç½®è¢«åº”ç”¨</span></span><br><span class="line">            <span class="keyword">base</span>.OnModelCreating(modelBuilder);</span><br><span class="line">            <span class="comment">// è‡ªåŠ¨åº”ç”¨å½“å‰ç¨‹åºé›†ä¸­çš„æ‰€æœ‰å®ä½“é…ç½®ï¼ˆIEntityTypeConfigurationå®ç°ç±»ï¼‰</span></span><br><span class="line">            modelBuilder.ApplyConfigurationsFromAssembly(<span class="keyword">this</span>.GetType().Assembly);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="UserDomainRepository-ExpressionHelper"><a href="#UserDomainRepository-ExpressionHelper" class="headerlink" title="UserDomainRepository&#x2F;ExpressionHelper"></a>UserDomainRepository&#x2F;ExpressionHelper</h2><p>ä»“å‚¨æ¥å£IUserDomainRepositoryçš„å®ä½“ç±»UserDomainRepository</p><p>æˆ‘ä»¬æŠŠåˆ›å»ºçš„UserLoginHistoryå¯¹è±¡æ·»åŠ åˆ°ä¸Šä¸‹æ–‡ä¸­ä»¥åï¼Œå¹¶æ²¡æœ‰ç«‹å³æŠŠæ•°æ®ä¿å­˜åˆ°æ•°æ®åº“ä¸­ï¼Œå› ä¸ºåˆ°åº•ä»€ä¹ˆæ—¶å€™ä¿å­˜å·¥ä½œå•å…ƒä¸­çš„ä¿®æ”¹æ˜¯ç”±åº”ç”¨æœåŠ¡å±‚æ¥å†³å®šçš„ï¼Œä»“å‚¨å’Œé¢†åŸŸå±‚ä¸­éƒ½ä¸èƒ½æ‰§è¡ŒSaveChangesAsyncæ“ä½œã€‚<br>æ–‡ä¹°æŠŠçŸ­ä¿¡éªŒè¯ç ä¿å­˜åœ¨åˆ†å¸ƒå¼ç¼“å­˜ä¸­ï¼Œå½“ç„¶æˆ‘ä»¬å¯ä»¥æŠŠçŸ­ä¿¡éªŒè¯ç ä¿å­˜åˆ°æ•°æ®åº“ã€Redisç­‰åœ°æ–¹ã€‚éªŒè¯ç ä¿å­˜åˆ°ä»€ä¹ˆåœ°æ–¹æ˜¯ç”±UserDomainRepositoryç±»æ¥å†³å®šçš„ï¼ŒIUserDomainRepositoryæœåŠ¡çš„ä½¿ç”¨è€…å¹¶ä¸éœ€è¦çŸ¥é“è¿™äº›ç»†èŠ‚ã€‚è¿™å°±æ˜¯æ•´æ´æ¶æ„çš„å†…å±‚å®šä¹‰å’Œä½¿ç”¨æ¥å£ï¼Œä»¥åŠå¤–å±‚å®ç°æ¥å£æ‰€å¸¦æ¥çš„å¥½å¤„ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Users.Infrastructure</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ç”¨æˆ·é¢†åŸŸä»“å‚¨å®ç°ç±»ï¼Œè´Ÿè´£ç”¨æˆ·ç›¸å…³çš„æ•°æ®è®¿é—®å’Œæ“ä½œã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UserDomainRepository</span> : <span class="title">IUserDomainRepository</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ç”¨æˆ·æ•°æ®åº“ä¸Šä¸‹æ–‡ï¼Œç”¨äºæ“ä½œæ•°æ®åº“</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> UserDbContext dbCtx;</span><br><span class="line">        <span class="comment">// åˆ†å¸ƒå¼ç¼“å­˜ï¼Œç”¨äºå­˜å‚¨éªŒè¯ç ç­‰ä¸´æ—¶æ•°æ®</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> IDistributedCache distCache;</span><br><span class="line">        <span class="comment">// MediatRä¸­ä»‹è€…ï¼Œç”¨äºå‘å¸ƒé¢†åŸŸäº‹ä»¶</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> IMediator mediator;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ„é€ å‡½æ•°ï¼Œæ³¨å…¥æ•°æ®åº“ä¸Šä¸‹æ–‡ã€åˆ†å¸ƒå¼ç¼“å­˜å’Œä¸­ä»‹è€…ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">UserDomainRepository</span>(<span class="params">UserDbContext dbCtx, IDistributedCache distCache, IMediator mediator</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.dbCtx = dbCtx;</span><br><span class="line">            <span class="keyword">this</span>.distCache = distCache;</span><br><span class="line">            <span class="keyword">this</span>.mediator = mediator;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ–°å¢ä¸€æ¡ç”¨æˆ·ç™»å½•å†å²è®°å½•ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;phoneNumber&quot;&gt;</span>ç”¨æˆ·æ‰‹æœºå·<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;msg&quot;&gt;</span>ç™»å½•ç›¸å…³ä¿¡æ¯<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">AddNewLoginHistoryAsync</span>(<span class="params">PhoneNumber phoneNumber, <span class="built_in">string</span> msg</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// å…ˆæŸ¥æ‰¾ç”¨æˆ·</span></span><br><span class="line">            <span class="keyword">var</span> user = <span class="keyword">await</span> FindOneAsync(phoneNumber);</span><br><span class="line">            <span class="comment">// åˆ›å»ºç™»å½•å†å²è®°å½•ï¼ˆç”¨æˆ·IDå¯èƒ½ä¸ºnullï¼‰</span></span><br><span class="line">            UserLoginHistory history = <span class="keyword">new</span> UserLoginHistory(user?.Id, phoneNumber, msg);</span><br><span class="line">            <span class="comment">// æ·»åŠ åˆ°æ•°æ®åº“ä¸Šä¸‹æ–‡</span></span><br><span class="line">            dbCtx.LoginHistories.Add(history);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ ¹æ®æ‰‹æœºå·æŸ¥æ‰¾ç”¨æˆ·ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;phoneNumber&quot;&gt;</span>ç”¨æˆ·æ‰‹æœºå·<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>æ‰¾åˆ°çš„ç”¨æˆ·å¯¹è±¡ï¼Œæ‰¾ä¸åˆ°è¿”å›null<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> Task&lt;User?&gt; FindOneAsync(PhoneNumber phoneNumber)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// åŒ…å«è®¿é—®å¤±è´¥ä¿¡æ¯ï¼Œä¸€èµ·æŸ¥å‡ºæ¥</span></span><br><span class="line">            <span class="keyword">return</span> dbCtx.Users.Include(u =&gt; u.AccessFail).SingleOrDefaultAsync(MakeEqual((User u) =&gt; u.PhoneNumber, phoneNumber));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ ¹æ®ç”¨æˆ·IDæŸ¥æ‰¾ç”¨æˆ·ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;userId&quot;&gt;</span>ç”¨æˆ·å”¯ä¸€æ ‡è¯†<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>æ‰¾åˆ°çš„ç”¨æˆ·å¯¹è±¡ï¼Œæ‰¾ä¸åˆ°è¿”å›null<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> Task&lt;User?&gt; FindOneAsync(Guid userId)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// åŒ…å«è®¿é—®å¤±è´¥ä¿¡æ¯ï¼Œä¸€èµ·æŸ¥å‡ºæ¥</span></span><br><span class="line">            <span class="keyword">return</span> dbCtx.Users.Include(u =&gt; u.AccessFail)</span><br><span class="line">                .SingleOrDefaultAsync(u =&gt; u.Id == userId);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å‘å¸ƒç”¨æˆ·è®¿é—®ç»“æœé¢†åŸŸäº‹ä»¶ï¼ˆå¦‚ç™»å½•æˆåŠŸã€å¤±è´¥ç­‰ï¼‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;eventData&quot;&gt;</span>äº‹ä»¶æ•°æ®<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Task <span class="title">PublishEventAsync</span>(<span class="params">UserAccessResultEvent eventData</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// é€šè¿‡MediatRå‘å¸ƒäº‹ä»¶</span></span><br><span class="line">            <span class="keyword">return</span> mediator.Publish(eventData);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> è·å–æŒ‡å®šæ‰‹æœºå·æœ€è¿‘ä¿å­˜çš„éªŒè¯ç ï¼Œå¹¶ä»ç¼“å­˜ä¸­ç§»é™¤ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;phoneNumber&quot;&gt;</span>ç”¨æˆ·æ‰‹æœºå·<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>éªŒè¯ç å†…å®¹<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Task&lt;<span class="built_in">string</span>&gt; <span class="title">RetrievePhoneCodeAsync</span>(<span class="params">PhoneNumber phoneNumber</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// æ‹¼æ¥å®Œæ•´æ‰‹æœºå·ä½œä¸ºç¼“å­˜Key</span></span><br><span class="line">            <span class="built_in">string</span> fullNumber = phoneNumber.RegionCode + phoneNumber.Number;</span><br><span class="line">            <span class="built_in">string</span> cacheKey = <span class="string">$&quot;LoginByPhoneCode_Code_<span class="subst">&#123;fullNumber&#125;</span>&quot;</span>;</span><br><span class="line">            <span class="comment">// ä»ç¼“å­˜è·å–éªŒè¯ç </span></span><br><span class="line">            <span class="built_in">string</span>? code = distCache.GetString(cacheKey);</span><br><span class="line">            <span class="comment">// è·å–åç«‹å³ç§»é™¤ï¼Œé˜²æ­¢é‡å¤ä½¿ç”¨</span></span><br><span class="line">            distCache.Remove(cacheKey);</span><br><span class="line">            <span class="keyword">return</span> Task.FromResult(code);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ä¿å­˜æ‰‹æœºéªŒè¯ç åˆ°åˆ†å¸ƒå¼ç¼“å­˜ï¼Œæœ‰æ•ˆæœŸ5åˆ†é’Ÿã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;phoneNumber&quot;&gt;</span>ç”¨æˆ·æ‰‹æœºå·<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;code&quot;&gt;</span>éªŒè¯ç å†…å®¹<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Task <span class="title">SavePhoneCodeAsync</span>(<span class="params">PhoneNumber phoneNumber, <span class="built_in">string</span> code</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// æ‹¼æ¥å®Œæ•´æ‰‹æœºå·ä½œä¸ºç¼“å­˜Key</span></span><br><span class="line">            <span class="built_in">string</span> fullNumber = phoneNumber.RegionCode + phoneNumber.Number;</span><br><span class="line">            <span class="comment">// åˆ›å»ºåˆ†å¸ƒå¼ç¼“å­˜é¡¹é…ç½®å¯¹è±¡ï¼Œç”¨äºè®¾ç½®ç¼“å­˜é¡¹çš„è¿‡æœŸç­–ç•¥</span></span><br><span class="line">            <span class="keyword">var</span> options = <span class="keyword">new</span> DistributedCacheEntryOptions();</span><br><span class="line">            <span class="comment">// è®¾ç½®5åˆ†é’Ÿè¿‡æœŸ</span></span><br><span class="line">            options.AbsoluteExpirationRelativeToNow = TimeSpan.FromSeconds(<span class="number">300</span>);</span><br><span class="line">            <span class="comment">// ä¿å­˜åˆ°ç¼“å­˜</span></span><br><span class="line">            distCache.SetString(<span class="string">$&quot;LoginByPhoneCode_Code_<span class="subst">&#123;fullNumber&#125;</span>&quot;</span>, code, options);</span><br><span class="line">            <span class="keyword">return</span> Task.CompletedTask;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°è£…MakeEqualæ–¹æ³•è¿›è¡Œæ‰‹æœºå·çš„ç›¸ç­‰æ€§æ¯”è¾ƒã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Users.Infrastructure</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ExpressionHelper</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ„å»ºä¸€ä¸ªç”¨äºæ¯”è¾ƒå¯¹è±¡å±æ€§æ˜¯å¦ç›¸ç­‰çš„è¡¨è¾¾å¼ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ä¾‹å¦‚ï¼šå¯ç”¨äºLINQæŸ¥è¯¢ä¸­ï¼Œåˆ¤æ–­TItemç±»å‹å¯¹è±¡çš„æŸä¸ªå±æ€§ï¼ˆTPropç±»å‹ï¼‰æ˜¯å¦ä¸otherå¯¹è±¡çš„æ¯ä¸ªå±æ€§å€¼éƒ½ç›¸ç­‰ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;typeparam name=&quot;TItem&quot;&gt;</span>è¦æ¯”è¾ƒçš„å¯¹è±¡ç±»å‹<span class="doctag">&lt;/typeparam&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;typeparam name=&quot;TProp&quot;&gt;</span>è¦æ¯”è¾ƒçš„å±æ€§ç±»å‹ï¼ˆå¿…é¡»æ˜¯å¼•ç”¨ç±»å‹ï¼‰<span class="doctag">&lt;/typeparam&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;propAccessor&quot;&gt;</span>å±æ€§è®¿é—®è¡¨è¾¾å¼ï¼Œå¦‚ x =&gt; x.SomeProp<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;other&quot;&gt;</span>ç”¨äºæ¯”è¾ƒçš„å±æ€§å¯¹è±¡<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè¡¨ç¤ºTItemå¯¹è±¡çš„æŒ‡å®šå±æ€§ä¸otherå¯¹è±¡çš„æ‰€æœ‰å±æ€§å€¼éƒ½ç›¸ç­‰<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="title">Expression</span>&lt;<span class="title">Func</span>&lt;<span class="title">TItem</span>, <span class="title">bool</span>&gt;&gt; <span class="title">MakeEqual</span>&lt;<span class="title">TItem</span>, <span class="title">TProp</span>&gt;(<span class="params">Expression&lt;Func&lt;TItem, TProp&gt;&gt; propAccessor, TProp? other</span>)</span></span><br><span class="line"><span class="function">            <span class="keyword">where</span> TItem : <span class="keyword">class</span></span></span><br><span class="line"><span class="function">            <span class="keyword">where</span> TProp : <span class="keyword">class</span></span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// è·å–è¡¨è¾¾å¼å‚æ•°ï¼ˆå¦‚ x =&gt; ... ä¸­çš„ xï¼‰</span></span><br><span class="line">            <span class="keyword">var</span> e1 = propAccessor.Parameters.Single();</span><br><span class="line">            BinaryExpression? conditionalExpr = <span class="literal">null</span>;</span><br><span class="line">            <span class="comment">// éå†TPropç±»å‹çš„æ‰€æœ‰å±æ€§</span></span><br><span class="line">            <span class="keyword">foreach</span> (<span class="function"><span class="keyword">var</span> prop <span class="keyword">in</span> <span class="title">typeof</span>(<span class="params">TProp</span>).<span class="title">GetProperties</span>())</span></span><br><span class="line">            &#123;</span><br><span class="line">                BinaryExpression equalExpr;</span><br><span class="line">                <span class="built_in">object</span>? otherValue = <span class="literal">null</span>;</span><br><span class="line">                <span class="comment">// è·å–otherå¯¹è±¡å¯¹åº”å±æ€§çš„å€¼</span></span><br><span class="line">                <span class="keyword">if</span> (other != <span class="literal">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    otherValue = prop.GetValue(other);</span><br><span class="line">                &#125;</span><br><span class="line">                Type propType = prop.PropertyType;</span><br><span class="line">                <span class="comment">// æ„å»ºå·¦ä¾§è¡¨è¾¾å¼ï¼ˆå¦‚ x.SomeProp.å±æ€§ï¼‰</span></span><br><span class="line">                <span class="keyword">var</span> leftExpr = MakeMemberAccess(</span><br><span class="line">                    propAccessor.Body,</span><br><span class="line">                    prop</span><br><span class="line">                );</span><br><span class="line">                <span class="comment">// æ„å»ºå³ä¾§è¡¨è¾¾å¼ï¼ˆotherå¯¹è±¡çš„å±æ€§å€¼ï¼‰</span></span><br><span class="line">                Expression rightExpr = Convert(Constant(otherValue), propType);</span><br><span class="line">                <span class="comment">// å¦‚æœå±æ€§æ˜¯å€¼ç±»å‹ï¼ˆå¦‚intã€boolï¼‰ï¼Œç”¨Equalæ¯”è¾ƒ</span></span><br><span class="line">                <span class="keyword">if</span> (propType.IsPrimitive)</span><br><span class="line">                &#123;</span><br><span class="line">                    equalExpr = Expression.Equal(leftExpr, rightExpr);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">// å¦åˆ™å°è¯•ç”¨op_Equalityæ–¹æ³•æ¯”è¾ƒï¼ˆå¦‚stringç­‰ï¼‰</span></span><br><span class="line">                    equalExpr = MakeBinary(ExpressionType.Equal,</span><br><span class="line">                        leftExpr, rightExpr, <span class="literal">false</span>,</span><br><span class="line">                        prop.PropertyType.GetMethod(<span class="string">&quot;op_Equality&quot;</span>)</span><br><span class="line">                    );</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// å¤šä¸ªå±æ€§ç”¨AndAlsoè¿æ¥ï¼ˆå…¨éƒ¨ç›¸ç­‰æ‰ä¸ºtrueï¼‰</span></span><br><span class="line">                <span class="keyword">if</span> (conditionalExpr == <span class="literal">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    conditionalExpr = equalExpr;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    conditionalExpr = Expression.AndAlso(conditionalExpr, equalExpr);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å¦‚æœæ²¡æœ‰å±æ€§ï¼ŒæŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">            <span class="keyword">if</span> (conditionalExpr == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;propAccessor must have at least one property&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// è¿”å›æœ€ç»ˆçš„lambdaè¡¨è¾¾å¼</span></span><br><span class="line">            <span class="keyword">return</span> Lambda&lt;Func&lt;TItem, <span class="built_in">bool</span>&gt;&gt;(</span><br><span class="line">                conditionalExpr, e1</span><br><span class="line">            );</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="MockSmsCodeSender"><a href="#MockSmsCodeSender" class="headerlink" title="MockSmsCodeSender"></a>MockSmsCodeSender</h2><p>æ¨¡æ‹ŸçŸ­ä¿¡éªŒè¯ç å‘é€å™¨</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Users.Infrastructure</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æ¨¡æ‹ŸçŸ­ä¿¡éªŒè¯ç å‘é€å™¨ï¼Œå®ç° <span class="doctag">&lt;see cref=&quot;ISmsCodeSender&quot;/&gt;</span> æ¥å£ï¼Œä»…ç”¨äºæµ‹è¯•æˆ–å¼€å‘ç¯å¢ƒã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">MockSmsCodeSender</span> : <span class="title">ISmsCodeSender</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> ILogger&lt;MockSmsCodeSender&gt; logger;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ„é€ å‡½æ•°ï¼Œæ³¨å…¥æ—¥å¿—è®°å½•å™¨ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;logger&quot;&gt;</span>æ—¥å¿—è®°å½•å™¨å®ä¾‹ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">MockSmsCodeSender</span>(<span class="params">ILogger&lt;MockSmsCodeSender&gt; logger</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.logger = logger;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ¨¡æ‹Ÿå¼‚æ­¥å‘é€çŸ­ä¿¡éªŒè¯ç ï¼Œå°†éªŒè¯ç ä¿¡æ¯å†™å…¥æ—¥å¿—ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;phoneNumber&quot;&gt;</span>æ¥æ”¶éªŒè¯ç çš„æ‰‹æœºå·ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;code&quot;&gt;</span>è¦å‘é€çš„éªŒè¯ç å†…å®¹ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>è¡¨ç¤ºå¼‚æ­¥æ“ä½œçš„ä»»åŠ¡ã€‚<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Task <span class="title">SendCodeAsync</span>(<span class="params">PhoneNumber phoneNumber, <span class="built_in">string</span> code</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            logger.LogInformation(<span class="string">$&quot;å‘<span class="subst">&#123;phoneNumber&#125;</span>å‘é€éªŒè¯ç ï¼š<span class="subst">&#123;code&#125;</span>&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> Task.CompletedTask;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å·¥ä½œå•å…ƒçš„å®ç°"><a href="#å·¥ä½œå•å…ƒçš„å®ç°" class="headerlink" title="å·¥ä½œå•å…ƒçš„å®ç°"></a>å·¥ä½œå•å…ƒçš„å®ç°</h1><p>å·¥ä½œå•å…ƒç”±åº”ç”¨æœåŠ¡å±‚æ¥ç¡®å®šï¼Œå…¶ä»–å±‚ä¸åº”è¯¥è°ƒç”¨SaveChangesAsyncæ–¹æ³•ä¿å­˜å¯¹æ•°æ®çš„ä¿®æ”¹ã€‚æˆ‘ä»¬æŠŠWeb APIçš„æ§åˆ¶å™¨å½“æˆåº”ç”¨æœåŠ¡ï¼Œè€Œä¸”å¯¹äºå¤§éƒ¨åˆ†åº”ç”¨åœºæ™¯æ¥è®²ï¼Œä¸€æ¬¡å¯¹æ§åˆ¶å™¨ä¸­æ–¹æ³•çš„è°ƒç”¨å°±å¯¹åº”ä¸€ä¸ªå·¥ä½œå•å…ƒï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å¼€å‘ä¸€ä¸ªåœ¨æ§åˆ¶å™¨çš„æ–¹æ³•è°ƒç”¨ç»“æŸåè‡ªåŠ¨è°ƒç”¨SaveChangesAsyncçš„æœºåˆ¶ã€‚è¿™æ ·å°±èƒ½å¤§å¤§ç®€åŒ–åº”ç”¨æœåŠ¡å±‚ä»£ç çš„ç¼–å†™ï¼Œä»è€Œé¿å…å¯¹SaveChangesAsyncæ–¹æ³•çš„é‡å¤è°ƒç”¨ã€‚å½“ç„¶ï¼Œå¯¹äºç‰¹æ®Šçš„åº”ç”¨æœåŠ¡å±‚ä»£ç ï¼Œæˆ‘ä»¬å¯èƒ½ä»ç„¶éœ€è¦æ‰‹åŠ¨å†³å®šè°ƒç”¨SaveChangesAsyncæ–¹æ³•çš„æ—¶æœºã€‚</p><h2 id="UnitOfWorkAttribute"><a href="#UnitOfWorkAttribute" class="headerlink" title="UnitOfWorkAttribute"></a>UnitOfWorkAttribute</h2><p>æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªAttribute,å°†å…¶æ·»åŠ åˆ°éœ€è¦é‡å¯è‡ªåŠ¨æäº¤å·¥ä½œå•å…ƒçš„æ“ä½œæ–¹æ³•ä¸Šã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Users.WebAPI</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// UnitOfWorkAttribute æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰ç‰¹æ€§ï¼ˆAttributeï¼‰ï¼Œç”¨äºæ ‡è®°éœ€è¦å¯ç”¨å·¥ä½œå•å…ƒï¼ˆUnit of Workï¼‰æ¨¡å¼çš„ç±»æˆ–æ–¹æ³•ã€‚</span></span><br><span class="line">    <span class="comment">// è¯¥ç‰¹æ€§å¯ä»¥åº”ç”¨äºç±»æˆ–æ–¹æ³•ä¸Šï¼Œä¸”ä¸å…è®¸é‡å¤åº”ç”¨ï¼Œæ”¯æŒç»§æ‰¿ã€‚</span></span><br><span class="line">    [<span class="meta">AttributeUsage(AttributeTargets.Class | AttributeTargets.Method, AllowMultiple = false, Inherited = true)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UnitOfWorkAttribute</span> : <span class="title">Attribute</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// DbContextTypes ç”¨äºæŒ‡å®šéœ€è¦å‚ä¸å·¥ä½œå•å…ƒçš„ DbContext ç±»å‹æ•°ç»„ã€‚</span></span><br><span class="line">        <span class="keyword">public</span> Type[] DbContextTypes &#123; <span class="keyword">get</span>; <span class="keyword">init</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ„é€ å‡½æ•°ï¼Œæ¥æ”¶ä¸€ä¸ªæˆ–å¤šä¸ª DbContext ç±»å‹ä½œä¸ºå‚æ•°ã€‚</span></span><br><span class="line">        <span class="comment">// ä¼šæ£€æŸ¥ä¼ å…¥çš„ç±»å‹æ˜¯å¦éƒ½ç»§æ‰¿è‡ª DbContextï¼Œå¦‚æœä¸æ˜¯åˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">UnitOfWorkAttribute</span>(<span class="params"><span class="keyword">params</span> Type[] dbContextTypes</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.DbContextTypes = dbContextTypes;</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> type <span class="keyword">in</span> dbContextTypes)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// åˆ¤æ–­ç±»å‹æ˜¯å¦ç»§æ‰¿è‡ª DbContextï¼Œå¦‚æœä¸æ˜¯åˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</span></span><br><span class="line">                <span class="keyword">if</span> (!<span class="keyword">typeof</span>(DbContext).IsAssignableFrom(type))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">$&quot;<span class="subst">&#123;type&#125;</span> å¿…é¡»ç»§æ‰¿è‡ª DbContext&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœä¸€ä¸ªæ§åˆ¶å™¨ä¸Šæ ‡æ³¨äº†UnitOfWorkAttibuteï¼Œé‚£ä¹ˆè¿™ä¸ªæ§åˆ¶å™¨ä¸­æ‰€æœ‰çš„æ–¹æ³•éƒ½ä¼šåœ¨æ‰§è¡Œç»“æŸåè‡ªåŠ¨æäº¤å·¥ä½œå•å…ƒï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠUnitOfWorkAttributeæ·»åŠ åˆ°æ§åˆ¶å™¨çš„æ–¹æ³•ä¸Šã€‚å› ä¸ºä¸€ä¸ªå¾®æœåŠ¡ä¸­å¯èƒ½æœ‰å¤šä¸ªä¸Šä¸‹æ–‡ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡DbContextTypesæ¥æŒ‡å®šå·¥ä½œå•å…ƒç»“æŸåç¨‹åºè‡ªåŠ¨è°ƒç”¨å“ªäº›ä¸Šä¸‹æ–‡çš„SaveChangesAsyncæ–¹æ³•ï¼ŒDbContextTypeså±æ€§ç”¨æ¥æŒ‡å®šä¸Šä¸‹æ–‡çš„ç±»å‹ã€‚</p><h2 id="UnitOfWorkFillter"><a href="#UnitOfWorkFillter" class="headerlink" title="UnitOfWorkFillter"></a>UnitOfWorkFillter</h2><p>æˆ‘ä»¬å®ç°ä¸€ä¸ªå…¨å±€çš„ActionFillterï¼Œæ¥å®ç°åœ¨æ§åˆ¶å™¨çš„æ“ä½œæ–¹æ³•æ‰§è¡Œç»“æŸåè‡ªåŠ¨æäº¤å·¥ä½œå•å…ƒçš„åŠŸèƒ½ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Users.WebAPI</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// å•å…ƒå·¥ä½œè¿‡æ»¤å™¨ï¼Œç”¨äºè‡ªåŠ¨å¤„ç†æ•°æ®åº“äº‹åŠ¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UnitOfWorkFilter</span> : <span class="title">IAsyncActionFilter</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// è·å–æ§åˆ¶å™¨æˆ–æ–¹æ³•ä¸Šçš„ UnitOfWorkAttribute ç‰¹æ€§</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> UnitOfWorkAttribute? GetUoWAttr(ActionDescriptor actionDesc)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// å°è¯•å°† ActionDescriptor è½¬æ¢ä¸º ControllerActionDescriptor</span></span><br><span class="line">            <span class="keyword">var</span> caDesc = actionDesc <span class="keyword">as</span> ControllerActionDescriptor;</span><br><span class="line">            <span class="keyword">if</span> (caDesc == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// å¦‚æœè½¬æ¢å¤±è´¥ï¼Œè¿”å› null</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å…ˆä»æ§åˆ¶å™¨ç±»å‹ä¸Šè·å– UnitOfWorkAttribute ç‰¹æ€§</span></span><br><span class="line">            <span class="keyword">var</span> uowAttr = caDesc.ControllerTypeInfo.GetCustomAttribute&lt;UnitOfWorkAttribute&gt;();</span><br><span class="line">            <span class="keyword">if</span> (uowAttr != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// å¦‚æœæ§åˆ¶å™¨ä¸Šæœ‰ç‰¹æ€§ï¼Œç›´æ¥è¿”å›</span></span><br><span class="line">                <span class="keyword">return</span> uowAttr;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// å¦åˆ™ä»æ–¹æ³•ä¸Šè·å– UnitOfWorkAttribute ç‰¹æ€§</span></span><br><span class="line">                <span class="keyword">return</span> caDesc.MethodInfo.GetCustomAttribute&lt;UnitOfWorkAttribute&gt;();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ‹¦æˆª Action æ‰§è¡Œï¼Œå¤„ç†æ•°æ®åº“ä¸Šä¸‹æ–‡çš„ä¿å­˜</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">OnActionExecutionAsync</span>(<span class="params">ActionExecutingContext context, ActionExecutionDelegate next</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// è·å–å½“å‰ Action ä¸Šçš„ UnitOfWorkAttribute ç‰¹æ€§</span></span><br><span class="line">            <span class="keyword">var</span> uowAttr = GetUoWAttr(context.ActionDescriptor);</span><br><span class="line">            <span class="keyword">if</span> (uowAttr == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// å¦‚æœæ²¡æœ‰ç‰¹æ€§ï¼Œç›´æ¥æ‰§è¡Œä¸‹ä¸€ä¸ªä¸­é—´ä»¶</span></span><br><span class="line">                <span class="keyword">await</span> next();</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// ç”¨äºå­˜æ”¾æ‰€æœ‰éœ€è¦å¤„ç†çš„ DbContext å®ä¾‹</span></span><br><span class="line">            List&lt;DbContext&gt; dbCtxs = <span class="keyword">new</span> List&lt;DbContext&gt;();</span><br><span class="line">            <span class="comment">// éå†ç‰¹æ€§ä¸­å£°æ˜çš„æ‰€æœ‰ DbContext ç±»å‹</span></span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> dbCtxType <span class="keyword">in</span> uowAttr.DbContextTypes)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// é€šè¿‡ä¾èµ–æ³¨å…¥å®¹å™¨è·å– DbContext å®ä¾‹</span></span><br><span class="line">                <span class="keyword">var</span> sp = context.HttpContext.RequestServices;</span><br><span class="line">                DbContext dbCtx = (DbContext)sp.GetRequiredService(dbCtxType);</span><br><span class="line">                <span class="comment">// æ·»åŠ åˆ°åˆ—è¡¨ä¸­</span></span><br><span class="line">                dbCtxs.Add(dbCtx);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// æ‰§è¡Œ Action æ–¹æ³•</span></span><br><span class="line">            <span class="keyword">var</span> result = <span class="keyword">await</span> next();</span><br><span class="line">            <span class="comment">// å¦‚æœæ²¡æœ‰å¼‚å¸¸å‘ç”Ÿ</span></span><br><span class="line">            <span class="keyword">if</span> (result.Exception == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// éå†æ‰€æœ‰ DbContextï¼Œä¿å­˜æ›´æ”¹</span></span><br><span class="line">                <span class="keyword">foreach</span> (<span class="keyword">var</span> dbCtx <span class="keyword">in</span> dbCtxs)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">await</span> dbCtx.SaveChangesAsync();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€ååªè¦æŠŠUnitOfWorkFilteræ³¨å†Œä¸ºASP.NET Coreçš„å…¨å±€ç­›é€‰å™¨ï¼Œæ‰€æœ‰æ·»åŠ äº†[UnitOfWork]çš„æ§åˆ¶å™¨æˆ–è€…æ“ä½œæ–¹æ³•å°±éƒ½èƒ½è‡ªåŠ¨è¿›è¡Œå·¥ä½œå•å…ƒçš„æäº¤äº†ã€‚</p><h1 id="åº”ç”¨æœåŠ¡å±‚çš„å®ç°"><a href="#åº”ç”¨æœåŠ¡å±‚çš„å®ç°" class="headerlink" title="åº”ç”¨æœåŠ¡å±‚çš„å®ç°"></a>åº”ç”¨æœåŠ¡å±‚çš„å®ç°</h1><p>ASP.NET Core Web APIä¸­çš„æ§åˆ¶å™¨å°±æ˜¯åº”ç”¨æœåŠ¡å±‚ï¼Œå› æ­¤æˆ‘ä»¬åœ¨ASP.NET Coreçš„é¡¹ç›®Users.WebAPIä¸­ç¼–å†™çš„ä»£ç å°±æ˜¯åº”ç”¨æœåŠ¡å±‚ä»£ç ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;Logging&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;LogLevel&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;Default&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Information&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;Microsoft.AspNetCore&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Warning&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;AllowedHosts&quot;</span><span class="punctuation">:</span> <span class="string">&quot;*&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;ConnectionStrings&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;Default&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Server=localhost;Database=YOUXIANYU;Trusted_Connection=True;MultipleActiveResultSets=true;TrustServerCertificate=True;Encrypt=True;&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>åœ¨Users.WebAPIçš„Program.csä¸­ï¼Œé™¤äº†è¦è¿›è¡Œä¸Šä¸‹æ–‡ã€UnitOfWorkFilterå…¨å±€ç­›é€‰å™¨çš„æ³¨å†Œã€åˆ†å¸ƒå¼ç¼“å­˜é…ç½®ã€MediatRé…ç½®ç­‰ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ³¨å†Œå„å±‚æ‰€éœ€è¦çš„æœåŠ¡ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Mvc;</span><br><span class="line"><span class="keyword">using</span> Microsoft.EntityFrameworkCore;</span><br><span class="line"><span class="keyword">using</span> Users.Domain;</span><br><span class="line"><span class="keyword">using</span> Users.Infrastructure;</span><br><span class="line"><span class="keyword">using</span> Users.WebAPI;</span><br><span class="line"><span class="keyword">using</span> MediatR;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(args);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Add services to the container.</span></span><br><span class="line"></span><br><span class="line">builder.Services.AddControllers();</span><br><span class="line"><span class="comment">// Learn more about configuring Swagger/OpenAPI at https://aka.ms/aspnetcore/swashbuckle</span></span><br><span class="line">builder.Services.AddEndpointsApiExplorer();</span><br><span class="line">builder.Services.AddSwaggerGen();</span><br><span class="line"><span class="comment">// é…ç½®æ•°æ®åº“ä¸Šä¸‹æ–‡ï¼Œä½¿ç”¨SQL Serveræ•°æ®åº“ï¼Œè¿æ¥å­—ç¬¦ä¸²ä»é…ç½®æ–‡ä»¶è¯»å–</span></span><br><span class="line">builder.Services.AddDbContext&lt;UserDbContext&gt;(b =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> connStr = builder.Configuration.GetConnectionString(<span class="string">&quot;Default&quot;</span>);</span><br><span class="line">    b.UseSqlServer(connStr);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// é…ç½®Redisç¼“å­˜ï¼Œè®¾ç½®RedisæœåŠ¡å™¨åœ°å€å’Œå®ä¾‹åç§°</span></span><br><span class="line">builder.Services.AddStackExchangeRedisCache(options =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    options.Configuration = <span class="string">&quot;localhost&quot;</span>;</span><br><span class="line">    options.InstanceName = <span class="string">&quot;UsersCache&quot;</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// é…ç½®MVCé€‰é¡¹ï¼Œæ·»åŠ å·¥ä½œå•å…ƒè¿‡æ»¤å™¨ï¼ˆUnitOfWorkFilterï¼‰ç”¨äºè‡ªåŠ¨ç®¡ç†äº‹åŠ¡</span></span><br><span class="line">builder.Services.Configure&lt;MvcOptions&gt;(opt =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    opt.Filters.Add&lt;UnitOfWorkFilter&gt;();</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// æ³¨å†Œé¢†åŸŸæœåŠ¡UserDomainServiceä¸ºä¾èµ–æ³¨å…¥æœåŠ¡</span></span><br><span class="line">builder.Services.AddScoped&lt;UserDomainService&gt;();</span><br><span class="line"><span class="comment">// æ³¨å†ŒçŸ­ä¿¡éªŒè¯ç å‘é€æœåŠ¡æ¥å£å’Œå®ç°ï¼ˆMockSmsCodeSenderä¸ºæ¨¡æ‹Ÿå®ç°ï¼‰</span></span><br><span class="line">builder.Services.AddScoped&lt;ISmsCodeSender, MockSmsCodeSender&gt;();</span><br><span class="line"><span class="comment">// æ³¨å†Œç”¨æˆ·é¢†åŸŸä»“å‚¨æ¥å£å’Œå®ç°</span></span><br><span class="line">builder.Services.AddScoped&lt;IUserDomainRepository, UserDomainRepository&gt;();</span><br><span class="line"><span class="comment">// æ³¨å†ŒMediatRåº“ï¼Œç”¨äºå®ç°é¢†åŸŸäº‹ä»¶å’Œå‘½ä»¤çš„ä¸­ä»‹è€…æ¨¡å¼</span></span><br><span class="line">builder.Services.AddMediatR(cfg =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    cfg.RegisterServicesFromAssembly(<span class="keyword">typeof</span>(Program).Assembly);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Configure the HTTP request pipeline.</span></span><br><span class="line"><span class="keyword">if</span> (app.Environment.IsDevelopment())</span><br><span class="line">&#123;</span><br><span class="line">    app.UseSwagger();</span><br><span class="line">    app.UseSwaggerUI();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.UseHttpsRedirection();</span><br><span class="line"></span><br><span class="line">app.UseAuthorization();</span><br><span class="line"></span><br><span class="line">app.MapControllers();</span><br><span class="line"></span><br><span class="line">app.Run();</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="UserAccessResultEventHandler"><a href="#UserAccessResultEventHandler" class="headerlink" title="UserAccessResultEventHandler"></a>UserAccessResultEventHandler</h2><p>æˆ‘ä»¬ç¼–å†™ä»£ç æ¥å“åº”ä»£ç UserAccessResultEventäº‹ä»¶ï¼Œç„¶åå‘æ•°æ®åº“ä¸­æ’å…¥ç™»å½•è®°å½•ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Users.WebAPI.Events</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ç”¨æˆ·è®¿é—®ç»“æœäº‹ä»¶å¤„ç†å™¨ï¼Œå®ç°INotificationHandleræ¥å£</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UserAccessResultEventHandler</span> : <span class="title">INotificationHandler</span>&lt;<span class="title">UserAccessResultEvent</span>&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ç”¨æˆ·é¢†åŸŸä»“å‚¨ï¼Œç”¨äºæ•°æ®è®¿é—®</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> IUserDomainRepository repository;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ„é€ å‡½æ•°ï¼Œæ³¨å…¥ç”¨æˆ·é¢†åŸŸä»“å‚¨</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">UserAccessResultEventHandler</span>(<span class="params">IUserDomainRepository repository</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.repository = repository; <span class="comment">// ä¿å­˜ä»“å‚¨å¼•ç”¨</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¤„ç†ç”¨æˆ·è®¿é—®ç»“æœäº‹ä»¶çš„æ–¹æ³•</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Task <span class="title">Handle</span>(<span class="params">UserAccessResultEvent notification, CancellationToken cancellationToken</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> result = notification.Result; <span class="comment">// è·å–è®¿é—®ç»“æœæšä¸¾</span></span><br><span class="line">            <span class="keyword">var</span> phoneNum = notification.PhoneNumber; <span class="comment">// è·å–ç”¨æˆ·æ‰‹æœºå·</span></span><br><span class="line">            <span class="built_in">string</span> msg; <span class="comment">// å®šä¹‰ç™»å½•å†å²ä¿¡æ¯å­—ç¬¦ä¸²</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ ¹æ®è®¿é—®ç»“æœç±»å‹ç”Ÿæˆä¸åŒçš„ç™»å½•å†å²ä¿¡æ¯</span></span><br><span class="line">            <span class="keyword">switch</span> (result)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">case</span> UserAccessResult.OK:</span><br><span class="line">                    msg = <span class="string">$&quot;<span class="subst">&#123;phoneNum&#125;</span>ç™»å½•æˆåŠŸ&quot;</span>; <span class="comment">// ç™»å½•æˆåŠŸ</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> UserAccessResult.PhoneNumberNotFound:</span><br><span class="line">                    msg = <span class="string">$&quot;<span class="subst">&#123;phoneNum&#125;</span>ç™»é™†å¤±è´¥ï¼Œå› ä¸ºç”¨æˆ·ä¸å­˜åœ¨&quot;</span>; <span class="comment">// ç”¨æˆ·ä¸å­˜åœ¨</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> UserAccessResult.PasswordError:</span><br><span class="line">                    msg = <span class="string">$&quot;<span class="subst">&#123;phoneNum&#125;</span>ç™»å½•å¤±è´¥ï¼Œå¯†ç é”™è¯¯&quot;</span>; <span class="comment">// å¯†ç é”™è¯¯</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> UserAccessResult.NoPassword:</span><br><span class="line">                    msg = <span class="string">$&quot;<span class="subst">&#123;phoneNum&#125;</span>ç™»å½•å¤±è´¥ï¼Œç”¨æˆ·æœªè®¾ç½®å¯†ç &quot;</span>; <span class="comment">// æœªè®¾ç½®å¯†ç </span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> UserAccessResult.Lockout:</span><br><span class="line">                    msg = <span class="string">$&quot;<span class="subst">&#123;phoneNum&#125;</span>ç™»å½•å¤±è´¥ï¼Œç”¨æˆ·è¢«é”å®š&quot;</span>; <span class="comment">// ç”¨æˆ·è¢«é”å®š</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="literal">default</span>:</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> NotImplementedException(); <span class="comment">// æœªçŸ¥ç»“æœæŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// è°ƒç”¨ä»“å‚¨æ–¹æ³•ï¼Œæ–°å¢ä¸€æ¡ç™»å½•å†å²è®°å½•</span></span><br><span class="line">            <span class="keyword">return</span> repository.AddNewLoginHistoryAsync(phoneNum, msg);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±äºé¢†åŸŸäº‹ä»¶çš„å¤„ç†å™¨æ˜¯è¿è¡Œåœ¨å·¥ä½œå•å…ƒä¸­çš„ï¼Œå› æ­¤æˆ‘ä»¬åªè¦åœ¨ä»£ç ä¸­æŠŠå¯¹è±¡åŠ å…¥repositoryå³å¯ï¼Œä¸éœ€è¦æ‰‹åŠ¨è°ƒç”¨SaveChangesAsyncã€‚</p><h2 id="Controllers"><a href="#Controllers" class="headerlink" title="Controllers"></a>Controllers</h2><p>å®ç°ç™»å½•çš„æ§åˆ¶å™¨ï¼Œå…ˆåœ¨æ§åˆ¶å™¨ä¸Šæ·»åŠ [UnitOfWork(typeof(UserDbContext))],è¿™æ ·æ§åˆ¶å™¨ä¸­çš„æ‰€æœ‰æ“ä½œæ–¹æ³•éƒ½ä¼šè‡ªåŠ¨è¿›è¡Œå·¥ä½œå•å…ƒçš„æäº¤ï¼Œç„¶åä¸ºæ§åˆ¶å™¨æ³¨å…¥UserDomainSeviceæœåŠ¡ï¼Œåœ¨ç¼–å†™æ ¹æ®æ‰‹æœºå·å’Œå¯†ç è¿›è¡Œç™»å½•çš„æ“ä½œæ–¹æ³•ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ChangePasswordRequest è®°å½•ç”¨äºå°è£…ç”¨æˆ·ä¿®æ”¹å¯†ç çš„è¯·æ±‚æ•°æ®ã€‚</span></span><br><span class="line">    <span class="comment">// åŒ…å«ç”¨æˆ·å”¯ä¸€æ ‡è¯† Id ä»¥åŠæ–°çš„å¯†ç  Passwordã€‚</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">record</span> <span class="title">ChangePasswordRequest</span>(<span class="params">Guid Id, <span class="built_in">string</span> Password</span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> è¡¨ç¤ºé€šè¿‡æ‰‹æœºå·å’ŒéªŒè¯ç è¿›è¡Œç™»å½•çš„è¯·æ±‚ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;PhoneNumber&quot;&gt;</span>ç”¨æˆ·çš„æ‰‹æœºå·ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;Code&quot;&gt;</span>éªŒè¯ç ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">record</span> <span class="title">CheckLoginByPhoneAndCodeRequest</span>(<span class="params">PhoneNumber PhoneNumber, <span class="built_in">string</span> Code</span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ç™»å½•è¯·æ±‚æ•°æ®ç»“æ„ï¼ŒåŒ…å«æ‰‹æœºå·å’Œå¯†ç </span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">record</span> <span class="title">LoginByPhoneAndPwdRequest</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">        PhoneNumber PhoneNumber, // ç”¨æˆ·æ‰‹æœºå·</span></span></span><br><span class="line"><span class="params"><span class="function">        <span class="built_in">string</span> Password          // ç”¨æˆ·å¯†ç </span></span></span><br><span class="line"><span class="params"><span class="function">    </span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="comment">// è¯¥è®°å½•ç±»å‹ç”¨äºå°è£…é€šè¿‡æ‰‹æœºå·å’ŒéªŒè¯ç å‘é€ç™»å½•è¯·æ±‚çš„æ•°æ®ã€‚</span></span><br><span class="line">    <span class="comment">// PhoneNumber å±æ€§è¡¨ç¤ºç”¨æˆ·çš„æ‰‹æœºå·ç ã€‚</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">record</span> <span class="title">SendLoginByPhoneAndCodeRequest</span>(<span class="params">PhoneNumber PhoneNumber</span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Users.WebAPI.Controllers</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// è·¯ç”±æ ¼å¼ä¸º /Login/æ–¹æ³•åï¼ŒApiControllerç‰¹æ€§ç”¨äºè‡ªåŠ¨æ¨¡å‹éªŒè¯å’Œè·¯ç”±æ¨æ–­</span></span><br><span class="line">    [<span class="meta">Route(<span class="string">&quot;[controller]/[action]&quot;</span>)</span>]</span><br><span class="line">    [<span class="meta">ApiController</span>]</span><br><span class="line">    <span class="comment">// ä½¿ç”¨UnitOfWorkç‰¹æ€§ï¼ŒæŒ‡å®šè¯¥æ§åˆ¶å™¨æ“ä½œçš„æ•°æ®åº“ä¸Šä¸‹æ–‡ä¸ºUserDbContext</span></span><br><span class="line">    [<span class="meta">UnitOfWork(typeof(UserDbContext))</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">LoginController</span> : <span class="title">ControllerBase</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ç”¨æˆ·é¢†åŸŸæœåŠ¡ï¼Œå°è£…äº†ç™»å½•ã€éªŒè¯ç ç­‰ä¸šåŠ¡é€»è¾‘</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> UserDomainService domainService;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é€šè¿‡ä¾èµ–æ³¨å…¥æ–¹å¼è·å–UserDomainServiceå®ä¾‹</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">LoginController</span>(<span class="params">UserDomainService domainService</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.domainService = domainService;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> é€šè¿‡æ‰‹æœºå·å’Œå¯†ç ç™»å½•</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;req&quot;&gt;</span>åŒ…å«æ‰‹æœºå·å’Œå¯†ç çš„è¯·æ±‚å¯¹è±¡<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>ç™»å½•ç»“æœï¼ŒæˆåŠŸè¿”å›200ï¼Œå¤±è´¥è¿”å›400<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        [<span class="meta">HttpPut</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;IActionResult&gt; <span class="title">LoginByPhoneAndPwd</span>(<span class="params">LoginByPhoneAndPwdRequest req</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// å¯†ç é•¿åº¦æ ¡éªŒï¼Œé˜²æ­¢è¿‡çŸ­å¯†ç </span></span><br><span class="line">            <span class="keyword">if</span> (req.Password.Length &lt; <span class="number">3</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> BadRequest(<span class="string">&quot;å¯†ç çš„é•¿åº¦ä¸èƒ½å°äº3&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">var</span> phoneNum = req.PhoneNumber;</span><br><span class="line">            <span class="comment">// è°ƒç”¨é¢†åŸŸæœåŠ¡è¿›è¡Œç™»å½•æ ¡éªŒ</span></span><br><span class="line">            <span class="keyword">var</span> result = <span class="keyword">await</span> domainService.CheckLoginAsync(phoneNum, req.Password);</span><br><span class="line">            <span class="comment">// æ ¹æ®æ ¡éªŒç»“æœè¿”å›ä¸åŒçš„å“åº”</span></span><br><span class="line">            <span class="keyword">switch</span> (result)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">case</span> UserAccessResult.OK:</span><br><span class="line">                    <span class="keyword">return</span> Ok(<span class="string">&quot;ç™»å½•æˆåŠŸ&quot;</span>);</span><br><span class="line">                <span class="keyword">case</span> UserAccessResult.PhoneNumberNotFound:</span><br><span class="line">                    <span class="keyword">return</span> BadRequest(<span class="string">&quot;æ‰‹æœºå·æˆ–è€…å¯†ç é”™è¯¯&quot;</span>);</span><br><span class="line">                <span class="keyword">case</span> UserAccessResult.Lockout:</span><br><span class="line">                    <span class="keyword">return</span> BadRequest(<span class="string">&quot;ç”¨æˆ·è¢«é”å®šï¼Œè¯·ç¨åå†è¯•&quot;</span>);</span><br><span class="line">                <span class="keyword">case</span> UserAccessResult.NoPassword:</span><br><span class="line">                    <span class="keyword">return</span> BadRequest(<span class="string">&quot;ç”¨æˆ·æœªè®¾ç½®å¯†ç ï¼Œè¯·å…ˆè®¾ç½®å¯†ç &quot;</span>);</span><br><span class="line">                <span class="keyword">case</span> UserAccessResult.PasswordError:</span><br><span class="line">                    <span class="keyword">return</span> BadRequest(<span class="string">&quot;æ‰‹æœºå·æˆ–è€…å¯†ç é”™è¯¯&quot;</span>);</span><br><span class="line">                <span class="literal">default</span>:</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> NotImplementedException();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å‘é€çŸ­ä¿¡éªŒè¯ç åˆ°æŒ‡å®šæ‰‹æœºå·</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;req&quot;&gt;</span>åŒ…å«æ‰‹æœºå·çš„è¯·æ±‚å¯¹è±¡<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>å‘é€ç»“æœï¼ŒæˆåŠŸè¿”å›200ï¼Œå¤±è´¥è¿”å›400<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        [<span class="meta">HttpPost</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;IActionResult&gt; <span class="title">SendCodeByPhone</span>(<span class="params">SendLoginByPhoneAndCodeRequest req</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// è°ƒç”¨é¢†åŸŸæœåŠ¡å‘é€éªŒè¯ç </span></span><br><span class="line">            <span class="keyword">var</span> result = <span class="keyword">await</span> domainService.SendCodeAsync(req.PhoneNumber);</span><br><span class="line">            <span class="comment">// æ ¹æ®å‘é€ç»“æœè¿”å›ä¸åŒçš„å“åº”</span></span><br><span class="line">            <span class="keyword">switch</span> (result)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">case</span> UserAccessResult.OK:</span><br><span class="line">                    <span class="keyword">return</span> Ok(<span class="string">&quot;éªŒè¯ç å·²å‘é€ï¼Œè¯·æ³¨æ„æŸ¥æ”¶&quot;</span>);</span><br><span class="line">                <span class="keyword">case</span> UserAccessResult.Lockout:</span><br><span class="line">                    <span class="keyword">return</span> BadRequest(<span class="string">&quot;ç”¨æˆ·è¢«é”å®šï¼Œè¯·ç¨åå†è¯•&quot;</span>);</span><br><span class="line">                <span class="literal">default</span>:</span><br><span class="line">                    <span class="keyword">return</span> BadRequest(<span class="string">&quot;è¯·æ±‚é”™è¯¯&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ ¡éªŒç”¨æˆ·è¾“å…¥çš„çŸ­ä¿¡éªŒè¯ç </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;req&quot;&gt;</span>åŒ…å«æ‰‹æœºå·å’ŒéªŒè¯ç çš„è¯·æ±‚å¯¹è±¡<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>æ ¡éªŒç»“æœï¼ŒæˆåŠŸè¿”å›200ï¼Œå¤±è´¥è¿”å›400<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        [<span class="meta">HttpPost</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;IActionResult&gt; <span class="title">CheckCode</span>(<span class="params">CheckLoginByPhoneAndCodeRequest req</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// è°ƒç”¨é¢†åŸŸæœåŠ¡æ ¡éªŒéªŒè¯ç </span></span><br><span class="line">            <span class="keyword">var</span> result = <span class="keyword">await</span> domainService.CheckCodeAsync(req.PhoneNumber, req.Code);</span><br><span class="line">            <span class="comment">// æ ¹æ®æ ¡éªŒç»“æœè¿”å›ä¸åŒçš„å“åº”</span></span><br><span class="line">            <span class="keyword">switch</span> (result)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">case</span> CheckCodeResult.OK:</span><br><span class="line">                    <span class="keyword">return</span> Ok(<span class="string">&quot;ç™»å½•æˆåŠŸ&quot;</span>);</span><br><span class="line">                <span class="keyword">case</span> CheckCodeResult.PhoneNumberNotFound:</span><br><span class="line">                    <span class="keyword">return</span> BadRequest(<span class="string">&quot;è¯·æ±‚é”™è¯¯&quot;</span>);</span><br><span class="line">                <span class="keyword">case</span> CheckCodeResult.Lockout:</span><br><span class="line">                    <span class="keyword">return</span> BadRequest(<span class="string">&quot;ç”¨æˆ·è¢«é”å®šï¼Œè¯·ç¨åå†è¯•&quot;</span>);</span><br><span class="line">                <span class="keyword">case</span> CheckCodeResult.CodeError:</span><br><span class="line">                    <span class="keyword">return</span> BadRequest(<span class="string">&quot;éªŒè¯ç é”™è¯¯&quot;</span>);</span><br><span class="line">                <span class="literal">default</span>:</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> NotImplementedException();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Users.WebAPI.Controllers</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// è·¯ç”±æ ¼å¼ä¸º [æ§åˆ¶å™¨å]/[æ–¹æ³•å]ï¼Œå¦‚ UsersMgr/AddNew</span></span><br><span class="line">    [<span class="meta">Route(<span class="string">&quot;[controller]/[action]&quot;</span>)</span>]</span><br><span class="line">    [<span class="meta">ApiController</span>]</span><br><span class="line">    <span class="comment">// ä½¿ç”¨å·¥ä½œå•å…ƒè¿‡æ»¤å™¨ï¼Œè‡ªåŠ¨ç®¡ç†æ•°æ®åº“äº‹åŠ¡ï¼ŒæŒ‡å®šUserDbContextä¸ºä¸Šä¸‹æ–‡</span></span><br><span class="line">    [<span class="meta">UnitOfWork(typeof(UserDbContext))</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UsersMgrController</span> : <span class="title">ControllerBase</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// æ³¨å…¥ç”¨æˆ·æ•°æ®åº“ä¸Šä¸‹æ–‡ï¼Œç”¨äºæ“ä½œæ•°æ®åº“</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> UserDbContext dbCtx;</span><br><span class="line">        <span class="comment">// æ³¨å…¥ç”¨æˆ·é¢†åŸŸæœåŠ¡ï¼Œå°è£…ç”¨æˆ·ç›¸å…³çš„ä¸šåŠ¡é€»è¾‘</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> UserDomainService domainService;</span><br><span class="line">        <span class="comment">// æ³¨å…¥ç”¨æˆ·ä»“å‚¨æ¥å£ï¼Œç”¨äºæ•°æ®æŒä¹…åŒ–å’ŒæŸ¥è¯¢</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> IUserDomainRepository repository;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ„é€ å‡½æ•°ï¼Œä¾èµ–æ³¨å…¥æ‰€éœ€æœåŠ¡</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">UsersMgrController</span>(<span class="params">UserDbContext dbCtx, UserDomainService domainService, IUserDomainRepository repository</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.dbCtx = dbCtx;</span><br><span class="line">            <span class="keyword">this</span>.domainService = domainService;</span><br><span class="line">            <span class="keyword">this</span>.repository = repository;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ–°å¢ç”¨æˆ·æ¥å£ï¼Œå‚æ•°ä¸ºæ‰‹æœºå·</span></span><br><span class="line">        [<span class="meta">HttpPost</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;IActionResult&gt; <span class="title">AddNew</span>(<span class="params">PhoneNumber req</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²å­˜åœ¨</span></span><br><span class="line">            <span class="keyword">if</span> ((<span class="keyword">await</span> repository.FindOneAsync(req)) != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> BadRequest(<span class="string">&quot;ç”¨æˆ·å·²å­˜åœ¨&quot;</span>); <span class="comment">// å·²å­˜åœ¨åˆ™è¿”å›é”™è¯¯</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// åˆ›å»ºæ–°ç”¨æˆ·å¯¹è±¡</span></span><br><span class="line">            User user = <span class="keyword">new</span> User(req);</span><br><span class="line">            <span class="comment">// æ·»åŠ åˆ°æ•°æ®åº“ä¸Šä¸‹æ–‡ï¼Œç­‰å¾…äº‹åŠ¡æäº¤æ—¶ä¿å­˜</span></span><br><span class="line">            dbCtx.Users.Add(user);</span><br><span class="line">            <span class="keyword">return</span> Ok(<span class="string">&quot;æˆåŠŸ&quot;</span>); <span class="comment">// è¿”å›æˆåŠŸ</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä¿®æ”¹ç”¨æˆ·å¯†ç æ¥å£</span></span><br><span class="line">        [<span class="meta">HttpPut</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;IActionResult&gt; <span class="title">ChangePassword</span>(<span class="params">ChangePasswordRequest req</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// æ ¹æ®ç”¨æˆ·IDæŸ¥æ‰¾ç”¨æˆ·</span></span><br><span class="line">            <span class="keyword">var</span> user = <span class="keyword">await</span> repository.FindOneAsync(req.Id);</span><br><span class="line">            <span class="keyword">if</span> (user == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> NotFound(<span class="string">&quot;ç”¨æˆ·ä¸å­˜åœ¨&quot;</span>); <span class="comment">// æœªæ‰¾åˆ°ç”¨æˆ·è¿”å›404</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// é‡ç½®ç”¨æˆ·è®¿é—®å¤±è´¥çŠ¶æ€ï¼ˆå¦‚ç™»å½•å¤±è´¥æ¬¡æ•°ç­‰ï¼‰</span></span><br><span class="line">            domainService.ResetAccessFail(user);</span><br><span class="line">            <span class="keyword">return</span> Ok(<span class="string">&quot;æˆåŠŸ&quot;</span>); <span class="comment">// è¿”å›æˆåŠŸ</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è·å–æ‰€æœ‰ç”¨æˆ·åˆ—è¡¨æ¥å£</span></span><br><span class="line">        [<span class="meta">HttpGet</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;IActionResult&gt; <span class="title">GetAll</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·</span></span><br><span class="line">            <span class="keyword">var</span> users = <span class="keyword">await</span> dbCtx.Users.ToListAsync();</span><br><span class="line">            <span class="keyword">return</span> Ok(users); <span class="comment">// è¿”å›ç”¨æˆ·åˆ—è¡¨</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åº”ç”¨æœåŠ¡å±‚ä¸»è¦è¿›è¡Œçš„æ˜¯æ•°æ®çš„æ ¡éªŒã€è¯·æ±‚æ•°æ®çš„è·å–ã€é¢†åŸŸæœåŠ¡è¿”å›å€¼çš„æ˜¾ç¤ºç­‰å¤„ç†ï¼Œå¹¶æ²¡æœ‰å¤æ‚çš„ä¸šåŠ¡é€»è¾‘ï¼Œå› ä¸ºä¸»è¦çš„ä¸šåŠ¡é€»è¾‘éƒ½è¢«å°è£…åœ¨é¢†åŸŸå±‚ã€‚<br>åº”ç”¨æœåŠ¡å±‚æ˜¯éå¸¸â€œè–„â€çš„ä¸€å±‚ï¼Œåº”ç”¨æœåŠ¡å±‚è¦è¿›è¡Œå®‰å…¨è®¤è¯ã€æƒé™æ ¡éªŒã€æ•°æ®æ ¡éªŒã€äº‹åŠ¡æ§åˆ¶ã€å·¥ä½œå•å…ƒæ§åˆ¶ã€é¢†åŸŸæœåŠ¡å±‚çš„è°ƒç”¨ç­‰ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> EF Core </tag>
            
            <tag> ASP.NET Core </tag>
            
            <tag> Entity Framework Core </tag>
            
            <tag> DDD </tag>
            
            <tag> RabbitMQ </tag>
            
            <tag> MassTransit </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä»€ä¹ˆæ˜¯åå°„</title>
      <link href="/2025/06/29/csharp%E5%85%A5%E9%97%A8%E8%AF%A6%E8%A7%A3/%E4%BB%80%E4%B9%88%E6%98%AF%E5%8F%8D%E5%B0%84/"/>
      <url>/2025/06/29/csharp%E5%85%A5%E9%97%A8%E8%AF%A6%E8%A7%A3/%E4%BB%80%E4%B9%88%E6%98%AF%E5%8F%8D%E5%B0%84/</url>
      
        <content type="html"><![CDATA[<p>å½“ç„¶ï¼ä½ é—®çš„â€œä»€ä¹ˆæ˜¯åå°„â€ï¼Œè¿™é‡Œç»™ä½ ä¸€ä¸ªé€šä¿—æ˜“æ‡‚çš„ä¸­æ–‡è§£é‡Šï¼š</p><hr><h2 id="åå°„ï¼ˆReflectionï¼‰æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#åå°„ï¼ˆReflectionï¼‰æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="åå°„ï¼ˆReflectionï¼‰æ˜¯ä»€ä¹ˆï¼Ÿ"></a>åå°„ï¼ˆReflectionï¼‰æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p><strong>åå°„</strong> æ˜¯ .NETï¼ˆä»¥åŠå¾ˆå¤šè¯­è¨€å’Œå¹³å°ï¼Œæ¯”å¦‚ Javaï¼‰æä¾›çš„ä¸€ç§æœºåˆ¶ï¼Œå®ƒèƒ½è®©ç¨‹åºåœ¨è¿è¡Œæ—¶æŸ¥çœ‹ã€æ£€æŸ¥ã€è®¿é—®ç”šè‡³ä¿®æ”¹<strong>è‡ªèº«çš„ç±»å‹ä¿¡æ¯</strong>ã€‚</p><p>ç®€å•æ¥è¯´ï¼š</p><blockquote><p><strong>åå°„å°±æ˜¯åœ¨è¿è¡Œæ—¶åŠ¨æ€è·å–æˆ–æ“ä½œå¯¹è±¡ã€ç±»å‹ã€æ–¹æ³•ã€å±æ€§ç­‰å…ƒæ•°æ®çš„èƒ½åŠ›ã€‚</strong></p></blockquote><p>å¸¸ç”¨çš„ System.Reflection ç±»å‹<br> Type<br>è¡¨ç¤º .NET ä¸­ä»»ä½•ç±»å‹çš„è¿è¡Œæ—¶ä¿¡æ¯ï¼Œæ˜¯åå°„çš„æ ¸å¿ƒå…¥å£ã€‚</p><p> PropertyInfo<br>è¡¨ç¤ºå±æ€§çš„å…ƒæ•°æ®ï¼Œèƒ½ç”¨æ¥è¯»&#x2F;å†™å±æ€§å€¼ã€‚</p><p> MethodInfo<br>è¡¨ç¤ºæ–¹æ³•çš„å…ƒæ•°æ®ï¼Œèƒ½ç”¨æ¥è°ƒç”¨æ–¹æ³•ã€‚</p><p> FieldInfo<br>è¡¨ç¤ºå­—æ®µçš„å…ƒæ•°æ®ï¼Œèƒ½ç”¨æ¥è®¿é—®å­—æ®µå€¼ã€‚</p><p> ConstructorInfo<br>è¡¨ç¤ºæ„é€ å‡½æ•°çš„å…ƒæ•°æ®ï¼Œå¯ä»¥ç”¨æ¥åˆ›å»ºå¯¹è±¡ã€‚</p><p> Assembly<br>è¡¨ç¤ºç¨‹åºé›†ï¼ˆ.dll æˆ– .exeï¼‰ï¼Œå¯ä»¥ç”¨å®ƒåŠ¨æ€åŠ è½½ç¨‹åºé›†å¹¶è·å–ç±»å‹ä¿¡æ¯ã€‚</p><p> MemberInfo<br>è¡¨ç¤ºæˆå‘˜ï¼ˆå±æ€§ã€æ–¹æ³•ã€å­—æ®µç­‰ï¼‰çš„åŸºç±»ï¼Œå¾ˆå¤š API è¿”å›å®ƒã€‚</p><hr><h3 id="ä¸¾ä¸ªç®€å•çš„ä¾‹å­"><a href="#ä¸¾ä¸ªç®€å•çš„ä¾‹å­" class="headerlink" title="ä¸¾ä¸ªç®€å•çš„ä¾‹å­"></a>ä¸¾ä¸ªç®€å•çš„ä¾‹å­</h3><p>å‡è®¾ä½ æœ‰ä¸€ä¸ªç±»ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Person</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åœ¨å¹³æ—¶çš„ä»£ç é‡Œï¼Œä½ å¯ä»¥ç›´æ¥ç”¨ï¼š</li></ul><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> Person();</span><br><span class="line">p.Name = <span class="string">&quot;Alice&quot;</span>;</span><br></pre></td></tr></table></figure><ul><li>ä½†å¦‚æœä½ æƒ³åœ¨ä¸çŸ¥é“ç±»åå­—ã€å±æ€§åå­—çš„æƒ…å†µä¸‹ï¼Œä»å­—ç¬¦ä¸² <code>&quot;Person&quot;</code> å’Œ <code>&quot;Name&quot;</code> æ¥åŠ¨æ€æ“ä½œâ€”â€”å°±è¦ç”¨åˆ° <strong>åå°„</strong>ï¼š</li></ul><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¿è¡Œæ—¶é€šè¿‡å­—ç¬¦ä¸²è·å–ç±»å‹</span></span><br><span class="line">Type type = Type.GetType(<span class="string">&quot;YourNamespace.Person&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºå®ä¾‹</span></span><br><span class="line"><span class="built_in">object</span> obj = Activator.CreateInstance(type);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–å±æ€§</span></span><br><span class="line"><span class="keyword">var</span> prop = type.GetProperty(<span class="string">&quot;Name&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®å±æ€§å€¼</span></span><br><span class="line">prop.SetValue(obj, <span class="string">&quot;Alice&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯»å–å±æ€§å€¼</span></span><br><span class="line"><span class="built_in">string</span> <span class="keyword">value</span> = (<span class="built_in">string</span>)prop.GetValue(obj);</span><br><span class="line"></span><br><span class="line">Console.WriteLine(<span class="keyword">value</span>); <span class="comment">// è¾“å‡º Alice</span></span><br></pre></td></tr></table></figure><p>è¿™å°±æ˜¯åå°„ï¼šåœ¨ç¨‹åºè¿è¡Œæ—¶ï¼Œé€šè¿‡ç±»å‹çš„å…ƒä¿¡æ¯ï¼ˆmetadataï¼‰å¯¹ç±»å‹ã€æ–¹æ³•ã€å±æ€§ç­‰è¿›è¡Œæ“ä½œã€‚</p><hr><h2 id="åå°„èƒ½åšä»€ä¹ˆï¼Ÿ"><a href="#åå°„èƒ½åšä»€ä¹ˆï¼Ÿ" class="headerlink" title="åå°„èƒ½åšä»€ä¹ˆï¼Ÿ"></a>åå°„èƒ½åšä»€ä¹ˆï¼Ÿ</h2><p> <strong>è·å–ç±»å‹ä¿¡æ¯</strong><br>æ¯”å¦‚æ‹¿åˆ°ç±»ã€æ¥å£ã€æ–¹æ³•ã€å±æ€§ã€å­—æ®µã€æ„é€ å‡½æ•°çš„å…ƒæ•°æ®ã€‚</p><p> <strong>åŠ¨æ€åˆ›å»ºå¯¹è±¡</strong><br>æ¯”å¦‚ä½ å†™ä¸€ä¸ªæ’ä»¶ç³»ç»Ÿï¼Œéœ€è¦æ ¹æ®é…ç½®æ–‡ä»¶é‡Œå†™çš„ç±»ååˆ›å»ºå®ä¾‹ã€‚</p><p> <strong>è°ƒç”¨æ–¹æ³•</strong><br>ä½ ç”šè‡³å¯ä»¥åœ¨ä¸çŸ¥é“æ–¹æ³•åçš„æƒ…å†µä¸‹ï¼Œé€šè¿‡å­—ç¬¦ä¸²æ‰¾åˆ°æ–¹æ³•å¹¶è°ƒç”¨ã€‚</p><p> <strong>è®¿é—®å’Œä¿®æ”¹å±æ€§&#x2F;å­—æ®µ</strong><br>æ¯”å¦‚ ORM æ¡†æ¶ä¼šç”¨åå°„æŠŠæ•°æ®åº“ç»“æœè‡ªåŠ¨æ˜ å°„åˆ°å¯¹è±¡å±æ€§ã€‚</p><p> <strong>è¯»å–ç‰¹æ€§ï¼ˆAttributeï¼‰</strong><br>ä½ å¯ä»¥åœ¨è¿è¡Œæ—¶è¯»å–ç±»ã€å±æ€§ã€æ–¹æ³•ä¸Šçš„è‡ªå®šä¹‰ç‰¹æ€§ï¼ˆattributeï¼‰ï¼Œæ ¹æ®å®ƒä»¬åšä¸åŒçš„é€»è¾‘ã€‚</p><p> <strong>åŠ¨æ€åŠ è½½ç¨‹åºé›†</strong><br>æ¯”å¦‚æ’ä»¶ç³»ç»Ÿï¼Œå¯ä»¥è¿è¡Œæ—¶åŠ è½½ .dll æ–‡ä»¶å¹¶ä½¿ç”¨é‡Œé¢çš„ç±»å‹ã€‚</p><hr><h2 id="å¸¸ç”¨åœºæ™¯"><a href="#å¸¸ç”¨åœºæ™¯" class="headerlink" title="å¸¸ç”¨åœºæ™¯"></a>å¸¸ç”¨åœºæ™¯</h2><p> JSON&#x2F;XML&#x2F;æ•°æ®åº“åºåˆ—åŒ–&#x2F;ååºåˆ—åŒ–ï¼ˆè‡ªåŠ¨æ˜ å°„åˆ°å¯¹è±¡ï¼‰<br> IoC å®¹å™¨ï¼ˆä¾èµ–æ³¨å…¥ï¼‰æ ¹æ®ç±»å‹åˆ›å»ºå¯¹è±¡<br> ORM æ¡†æ¶ï¼ˆEF Coreã€Dapperï¼‰<br> æ—¥å¿—ã€å®¡è®¡ç³»ç»Ÿ<br> æ’ä»¶æ¶æ„ï¼šåŠ¨æ€åŠ è½½å’Œè°ƒç”¨æ’ä»¶<br> å†™å·¥å…·æˆ–æ¡†æ¶ï¼šæ¯”å¦‚è‡ªåŠ¨ç”Ÿæˆä»£ç ã€åšæ¨¡å‹éªŒè¯</p><hr><h2 id="ä¸ºä»€ä¹ˆå«â€œåå°„â€ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆå«â€œåå°„â€ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆå«â€œåå°„â€ï¼Ÿ"></a>ä¸ºä»€ä¹ˆå«â€œåå°„â€ï¼Ÿ</h2><p>å› ä¸ºå®ƒå°±åƒç¨‹åºâ€œç…§é•œå­â€ï¼Œèƒ½<strong>çœ‹è§è‡ªå·±</strong>ï¼ˆç±»å‹ç»“æ„ã€å±æ€§ã€æ–¹æ³•ï¼‰å¹¶ä¸”<strong>æ“ä½œè‡ªå·±</strong>ã€‚</p><hr><h2 id="åå°„çš„ç¼ºç‚¹"><a href="#åå°„çš„ç¼ºç‚¹" class="headerlink" title="åå°„çš„ç¼ºç‚¹"></a>åå°„çš„ç¼ºç‚¹</h2><ul><li>æ€§èƒ½æ¯”ç›´æ¥ä»£ç è°ƒç”¨æ…¢å¾ˆå¤šï¼ˆè™½ç„¶å¯ä»¥ç¼“å­˜åå°„ç»“æœå‡å°‘å¼€é”€ï¼‰ã€‚</li><li>å¯ç»´æŠ¤æ€§å·®ï¼šåå°„å¸¸ç”¨å­—ç¬¦ä¸²ï¼ˆç±»å‹åã€å±æ€§åï¼‰ï¼Œè¿™äº›å­—ç¬¦ä¸²å¦‚æœæ‹¼é”™ï¼Œç¼–è¯‘å™¨ä¸ä¼šæç¤ºé”™è¯¯ã€‚</li><li>ä½¿ç”¨ä¸å½“ä¼šç ´åå°è£…æ€§ï¼ˆæ¯”å¦‚å¯ä»¥è®¿é—®ç§æœ‰æˆå‘˜ï¼‰ã€‚</li></ul><hr><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p> åå°„è®©ä½ åœ¨è¿è¡Œæ—¶è·å–å’Œæ“ä½œç±»å‹ä¿¡æ¯ï¼Œæ˜¯å¾ˆå¤šæ¡†æ¶çš„åº•å±‚æ”¯æ’‘<br> ç”¨äºåŠ¨æ€è¡Œä¸ºã€æ’ä»¶ã€è‡ªåŠ¨åŒ–æ˜ å°„ç­‰<br> åŠŸèƒ½å¼ºå¤§ï¼Œä½†è¦å°å¿ƒæ€§èƒ½å’Œå¯ç»´æŠ¤æ€§</p><hr>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Visual Studio 2022 </tag>
            
            <tag> charpç¼–ç¨‹åŸºç¡€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ASP.NET Coreä½¿ç”¨RabbitMQå’ŒMassTransit</title>
      <link href="/2025/05/27/DDD/NET%20Core%208%E4%B8%AD%E4%BD%BF%E7%94%A8MassTransit/"/>
      <url>/2025/05/27/DDD/NET%20Core%208%E4%B8%AD%E4%BD%BF%E7%94%A8MassTransit/</url>
      
        <content type="html"><![CDATA[<h1 id="MassTransit"><a href="#MassTransit" class="headerlink" title="MassTransit"></a>MassTransit</h1><p>ä¸€ã€MassTransit</p><ol><li>åŸºæœ¬æ¦‚å¿µ<br>å®šä½ï¼šåŸºäº .NET å¹³å° çš„å¼€æºæ¶ˆæ¯æ€»çº¿æ¡†æ¶ï¼Œç”¨äºæ„å»ºåˆ†å¸ƒå¼ã€å¼‚æ­¥é€šä¿¡çš„åº”ç”¨ç¨‹åºï¼Œæ”¯æŒå¤šç§æ¶ˆæ¯ä¼ è¾“åè®®ï¼ˆå¦‚ RabbitMQã€Azure Service Busã€Kafka ç­‰ï¼‰ã€‚<br>è®¾è®¡ç›®æ ‡ï¼šç®€åŒ–åˆ†å¸ƒå¼ç³»ç»Ÿä¸­æ¶ˆæ¯ä¼ é€’çš„å¼€å‘ï¼Œæä¾›é«˜å±‚æ¬¡çš„æŠ½è±¡ï¼ˆå¦‚æ¶ˆè´¹è€…ã€ç®¡é“ã€ Saga æ¨¡å¼ç­‰ï¼‰ï¼Œé™ä½å¼€å‘è€…å¯¹æ¶ˆæ¯ä¸­é—´ä»¶åº•å±‚ç»†èŠ‚çš„ä¾èµ–ã€‚</li><li>æ ¸å¿ƒç‰¹ç‚¹<br>å¤šä¼ è¾“åè®®æ”¯æŒï¼šå¯æ— ç¼é›†æˆ RabbitMQã€Azure Service Busã€Kafkaã€ActiveMQ ç­‰å¤šç§æ¶ˆæ¯ä»£ç†ã€‚<br>ç¼–ç¨‹æ¨¡å‹å‹å¥½ï¼š<br>åŸºäº C# è¯­è¨€ï¼Œæ”¯æŒä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰å’Œ Lambda è¡¨è¾¾å¼ï¼Œä»£ç ç®€æ´æ˜“è¯»ã€‚<br>å†…ç½®æ¶ˆè´¹è€…ç®¡é“ï¼ˆConsumer Pipelineï¼‰ï¼Œæ”¯æŒæ¶ˆæ¯è¿‡æ»¤ã€é‡è¯•ã€æ—¥å¿—è®°å½•ç­‰ä¸­é—´ä»¶ã€‚<br>åˆ†å¸ƒå¼äº‹åŠ¡æ”¯æŒï¼šé€šè¿‡ Saga æ¨¡å¼ å®ç°é•¿æµç¨‹äº‹åŠ¡çš„å¼‚æ­¥åè°ƒï¼ˆå¦‚è®¢å•çŠ¶æ€æ›´æ–°ã€æ”¯ä»˜å›è°ƒå¤„ç†ï¼‰ã€‚<br>é«˜å¯ç”¨æ€§ä¸ç›‘æ§ï¼š<br>æ”¯æŒæ¶ˆè´¹è€…é›†ç¾¤å’Œè´Ÿè½½å‡è¡¡ã€‚<br>é›†æˆ Prometheusã€Grafana ç­‰ç›‘æ§å·¥å…·ï¼Œæä¾›è¿è¡Œæ—¶æŒ‡æ ‡å’Œå¥åº·æ£€æŸ¥ã€‚</li><li>åº”ç”¨åœºæ™¯<br>.NET å¾®æœåŠ¡æ¶æ„ï¼šä½œä¸ºæœåŠ¡é—´é€šä¿¡çš„æ ¸å¿ƒç»„ä»¶ï¼ˆå°¤å…¶é€‚åˆ C# å¼€å‘å›¢é˜Ÿï¼‰ã€‚<br>å¤æ‚ä¸šåŠ¡æµç¨‹ï¼šéœ€è¦ Saga æ¨¡å¼å¤„ç†çš„é•¿äº‹åŠ¡åœºæ™¯ï¼ˆå¦‚ç”µå•†è®¢å•çš„æ”¯ä»˜ã€å‘è´§ã€é€€æ¬¾æµç¨‹ï¼‰ã€‚<br>å¤šæ¶ˆæ¯ä»£ç†æ··åˆæ¶æ„ï¼šç³»ç»Ÿéœ€è¦å…¼å®¹å¤šç§æ¶ˆæ¯ä¸­é—´ä»¶æ—¶ï¼ˆå¦‚è¿ç§»è‡³äº‘æœåŠ¡æ—¶è¿‡æ¸¡ï¼‰ã€‚</li><li>ä¼˜ç¼ºç‚¹<br>ä¼˜ç‚¹ï¼š<br>æ·±åº¦é›†æˆ .NET ç”Ÿæ€ï¼Œå¼€å‘æ•ˆç‡é«˜ï¼Œé€‚åˆ C# å¼€å‘è€…ã€‚<br>é«˜å±‚æ¬¡æŠ½è±¡éšè—äº†æ¶ˆæ¯ä¸­é—´ä»¶çš„å¤æ‚æ€§ï¼Œèšç„¦ä¸šåŠ¡é€»è¾‘ã€‚<br>ç¼ºç‚¹ï¼š<br>ä»…é™ .NET å¹³å°ï¼Œè·¨è¯­è¨€æ”¯æŒæœ‰é™ã€‚<br>å¯¹é .NET æŠ€æœ¯æ ˆï¼ˆå¦‚ Javaã€Pythonï¼‰ä¸å‹å¥½ã€‚</li></ol><p>MassTransit æ˜¯å¹¿æ³›ä½¿ç”¨çš„ .NET æœåŠ¡æ€»çº¿ï¼Œå¯ç®€åŒ–åŸºäºæ¶ˆæ¯çš„åº”ç”¨ç¨‹åºå¼€å‘ï¼Œè€Œ MassTransit.RabbitMQ åˆ™æä¾›ä¸ RabbitMQ çš„å¿…è¦é›†æˆã€‚</p><h3 id="å®‰è£…NuGetåŒ…"><a href="#å®‰è£…NuGetåŒ…" class="headerlink" title="å®‰è£…NuGetåŒ…"></a>å®‰è£…NuGetåŒ…</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Install-Package MassTransit</span><br><span class="line">Install-Package MassTransit.RabbitMQ</span><br></pre></td></tr></table></figure><ol><li>TransferData æ¶ˆæ¯æ¨¡å‹é…ç½®</li></ol><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="comment">// TransferData è®°å½•ç±»å‹ï¼Œç”¨äºè¡¨ç¤ºä¸€æ¬¡è½¬è´¦æ“ä½œçš„æ•°æ®</span></span><br><span class="line">    <span class="comment">// Type: è½¬è´¦ç±»å‹ï¼ˆå¦‚â€œå­˜æ¬¾â€æˆ–â€œå–æ¬¾â€ï¼‰</span></span><br><span class="line">    <span class="comment">// Amount: è½¬è´¦é‡‘é¢</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">record</span> <span class="title">TransferData</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> Type &#123; <span class="keyword">get</span>; <span class="keyword">init</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> Amount &#123; <span class="keyword">get</span>; <span class="keyword">init</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Client è®°å½•ç±»å‹ï¼Œè¡¨ç¤ºä¸€ä¸ªå®¢æˆ·çš„ä¿¡æ¯</span></span><br><span class="line">    <span class="comment">// Name: å®¢æˆ·å§“å</span></span><br><span class="line">    <span class="comment">// Pin: å®¢æˆ·çš„PINç ï¼ˆä¸ªäººè¯†åˆ«ç ï¼‰</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Client</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> Pin &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Account è®°å½•ç±»å‹ï¼Œè¡¨ç¤ºä¸€ä¸ªè´¦æˆ·çš„ä¿¡æ¯</span></span><br><span class="line">    <span class="comment">// Name: è´¦æˆ·æŒæœ‰äººå§“å</span></span><br><span class="line">    <span class="comment">// Deposit: è´¦æˆ·ä½™é¢</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Account</span> </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> Deposit &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// CurrentBalance ç±»è¡¨ç¤ºå½“å‰è´¦æˆ·ä½™é¢ä¿¡æ¯</span></span><br><span class="line">    <span class="comment">// Amount: å½“å‰ä½™é¢é‡‘é¢</span></span><br><span class="line">    <span class="comment">// Currency: è´§å¸ç±»å‹ï¼ˆå¦‚ç¾å…ƒã€æ¬§å…ƒç­‰ï¼‰</span></span><br><span class="line">    <span class="comment">// Balance: ä½™é¢çš„æ•´æ•°è¡¨ç¤ºå½¢å¼</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">CurrentBalance</span></span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Amount &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Currency &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> Balance &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>åœ¨Program.csä¸­é…ç½®MassTransitã€‚</li></ol><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é…ç½® MassTransit ä½¿ç”¨ RabbitMQ ä½œä¸ºæ¶ˆæ¯æ€»çº¿</span></span><br><span class="line">builder.Services.AddMassTransit(x =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ RabbitMQ è¿›è¡Œä¼ è¾“</span></span><br><span class="line">    x.UsingRabbitMq((context, cfg) =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// é…ç½® RabbitMQ ä¸»æœºåœ°å€å’Œè®¤è¯ä¿¡æ¯</span></span><br><span class="line">        cfg.Host(<span class="keyword">new</span> Uri(<span class="string">&quot;rabbitmq://localhost&quot;</span>), h =&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            h.Username(<span class="string">&quot;root&quot;</span>); <span class="comment">// ç”¨æˆ·å</span></span><br><span class="line">            h.Password(<span class="string">&quot;root&quot;</span>); <span class="comment">// å¯†ç </span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> QueueSenderController æ§åˆ¶å™¨ç”¨äºæ¼”ç¤ºé€šè¿‡ MassTransit å‘ RabbitMQ å‘é€å‘½ä»¤ã€å‘å¸ƒäº‹ä»¶å’Œè¯·æ±‚å“åº”ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    [<span class="meta">Route(<span class="string">&quot;api/[controller]/[action]&quot;</span>)</span>]</span><br><span class="line">    [<span class="meta">ApiController</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">QueueSenderController</span> : <span class="title">ControllerBase</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// MassTransit çš„æ€»çº¿å¯¹è±¡ï¼Œç”¨äºå‘é€å’Œå‘å¸ƒæ¶ˆæ¯</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> IBus bus;</span><br><span class="line">        <span class="comment">// ç”¨äºè¯·æ±‚-å“åº”æ¨¡å¼çš„å®¢æˆ·ç«¯</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> IRequestClient&lt;TransferData&gt; requestClient;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ„é€ å‡½æ•°ï¼Œæ³¨å…¥æ€»çº¿å’Œè¯·æ±‚å®¢æˆ·ç«¯</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;bus&quot;&gt;</span>MassTransit æ€»çº¿<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;requestClient&quot;&gt;</span>è¯·æ±‚-å“åº”å®¢æˆ·ç«¯<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">QueueSenderController</span>(<span class="params">IBus bus, IRequestClient&lt;TransferData&gt; requestClient</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.bus = bus;</span><br><span class="line">            <span class="keyword">this</span>.requestClient = requestClient;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å‘é€å‘½ä»¤æ¶ˆæ¯åˆ°æŒ‡å®šçš„ RabbitMQ é˜Ÿåˆ—</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>æ“ä½œç»“æœ<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        [<span class="meta">HttpPost(<span class="string">&quot;send-command&quot;</span>)</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;IActionResult&gt; <span class="title">SendCommand</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// åˆ›å»ºä¸€ä¸ªè´¦æˆ·å¯¹è±¡ï¼Œæ¨¡æ‹Ÿè¦å‘é€çš„æ•°æ®</span></span><br><span class="line">            <span class="keyword">var</span> account = <span class="keyword">new</span> Account()</span><br><span class="line">            &#123;</span><br><span class="line">                Name = <span class="string">&quot;å¼ ä¸‰&quot;</span>,</span><br><span class="line">                Deposit = <span class="number">500</span></span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="comment">// æŒ‡å®š RabbitMQ é˜Ÿåˆ—çš„åœ°å€</span></span><br><span class="line">            <span class="keyword">var</span> url = <span class="keyword">new</span> Uri(<span class="string">&quot;rabbitmq://localhost/send-command&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// è·å–å‘é€ç«¯ç‚¹å¹¶å‘é€æ¶ˆæ¯</span></span><br><span class="line">            <span class="keyword">var</span> endpoint = <span class="keyword">await</span> bus.GetSendEndpoint(url);</span><br><span class="line">            <span class="keyword">await</span> endpoint.Send(account);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> Ok(<span class="string">&quot;å‘½ä»¤å·²æˆåŠŸå‘é€&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å‘å¸ƒäº‹ä»¶æ¶ˆæ¯ï¼Œæ‰€æœ‰è®¢é˜…è€…éƒ½èƒ½æ”¶åˆ°</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>æ“ä½œç»“æœ<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        [<span class="meta">HttpPost(<span class="string">&quot;publish-event&quot;</span>)</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;IActionResult&gt; <span class="title">PublishEvent</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// å‘å¸ƒä¸€ä¸ªå®¢æˆ·ç«¯äº‹ä»¶ï¼Œæ‰€æœ‰ç›‘å¬è¯¥äº‹ä»¶çš„æœåŠ¡éƒ½èƒ½æ”¶åˆ°</span></span><br><span class="line">            <span class="keyword">await</span> bus.Publish(<span class="keyword">new</span> Client()</span><br><span class="line">            &#123;</span><br><span class="line">                Name = <span class="string">&quot;æå››&quot;</span>,</span><br><span class="line">                Pin = <span class="number">123456</span></span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> Ok(<span class="string">&quot;äº‹ä»¶å‘å¸ƒæˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å‘é€è¯·æ±‚å¹¶ç­‰å¾…å“åº”ï¼Œæ¼”ç¤ºè¯·æ±‚-å“åº”æ¨¡å¼</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>å“åº”å†…å®¹<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">        [<span class="meta">HttpPost(<span class="string">&quot;request-response&quot;</span>)</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;IActionResult&gt; <span class="title">RequestResponse</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// æ„é€ è½¬è´¦æ•°æ®</span></span><br><span class="line">            <span class="keyword">var</span> transferData = <span class="keyword">new</span> TransferData()</span><br><span class="line">            &#123;</span><br><span class="line">                Type = <span class="string">&quot;Withdrawal&quot;</span>,</span><br><span class="line">                Amount = <span class="number">25</span></span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="comment">// å‘é€è¯·æ±‚å¹¶ç­‰å¾…å“åº”</span></span><br><span class="line">            <span class="keyword">var</span> request = requestClient.Create(transferData);</span><br><span class="line">            <span class="keyword">var</span> response = <span class="keyword">await</span> request.GetResponse&lt;CurrentBalance&gt;();</span><br><span class="line">            <span class="keyword">return</span> Ok(<span class="string">$&quot;å“åº”æ•°æ®: <span class="subst">&#123;response.Message.Currency&#125;</span>, é‡‘é¢: <span class="subst">&#123;response.Message.Amount&#125;</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é…ç½®æ¶ˆè´¹è€…</p><p>åˆ›å»ºæ¥å£ï¼Œå®šä¹‰æ¶ˆè´¹ç±»å‹</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> IConsumer æ¥å£å®šä¹‰äº†æ¶ˆè´¹ä¸åŒç±»å‹æ¶ˆæ¯çš„æ–¹æ³•ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æ¯ä¸ªæ–¹æ³•ç”¨äºå¤„ç†ä¸€ç§ç‰¹å®šçš„æ•°æ®ç±»å‹ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IConsumer</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ¶ˆè´¹ Client ç±»å‹çš„æ¶ˆæ¯ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;client&quot;&gt;</span>è¦å¤„ç†çš„ Client å¯¹è±¡ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Consume</span>(<span class="params">Client client</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ¶ˆè´¹ Account ç±»å‹çš„æ¶ˆæ¯ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;account&quot;&gt;</span>è¦å¤„ç†çš„ Account å¯¹è±¡ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Consume</span>(<span class="params">Account account</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ¶ˆè´¹ TransferData ç±»å‹çš„æ¶ˆæ¯ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;transferData&quot;&gt;</span>è¦å¤„ç†çš„ TransferData å¯¹è±¡ï¼ŒåŒ…å«è½¬è´¦ç±»å‹å’Œé‡‘é¢ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Consume</span>(<span class="params">TransferData transferData</span>)</span>;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ¶ˆè´¹ CurrentBalance ç±»å‹çš„æ¶ˆæ¯ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">Consume</span>(<span class="params">CurrentBalance currentBalance</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="comment">// PublisherServicer ç±»å®ç°äº† MassTransit çš„ IConsumer&lt;Client&gt; æ¥å£ï¼Œç”¨äºæ¶ˆè´¹ Client ç±»å‹çš„æ¶ˆæ¯</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">PublisherServicer</span> : <span class="title">IConsumer</span>&lt;<span class="title">Client</span>&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å½“æœ‰ Client ç±»å‹çš„æ¶ˆæ¯åˆ°è¾¾æ—¶ï¼ŒConsume æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">Consume</span>(<span class="params">ConsumeContext&lt;Client&gt; context</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// ä»æ¶ˆæ¯ä¸Šä¸‹æ–‡ä¸­è·å–æ¶ˆæ¯ä½“ï¼ˆClient å¯¹è±¡ï¼‰</span></span><br><span class="line">            <span class="keyword">var</span> info = context.Message;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> RequestResponseServicer ç±»å®ç°äº† IConsumer æ¥å£ï¼Œç”¨äºå¤„ç† TransferData ç±»å‹çš„æ¶ˆæ¯ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> å½“æ”¶åˆ°è½¬è´¦è¯·æ±‚æ—¶ï¼Œè®¡ç®—å½“å‰ä½™é¢å¹¶å“åº”ç»™è¯·æ±‚æ–¹ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">RequestResponseServicer</span> : <span class="title">IConsumer</span>&lt;<span class="title">TransferData</span>&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ¶ˆè´¹å¹¶å¤„ç† TransferData æ¶ˆæ¯ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> å…ˆè·å–æ¶ˆæ¯ä¸­çš„è½¬è´¦é‡‘é¢ï¼Œç„¶åç”¨ 1000 å‡å»è¯¥é‡‘é¢ï¼Œå¾—åˆ°å½“å‰ä½™é¢ï¼Œæœ€åå°†ä½™é¢ä½œä¸ºå“åº”è¿”å›ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;context&quot;&gt;</span>åŒ…å«æ¶ˆæ¯å†…å®¹å’Œä¸Šä¸‹æ–‡ä¿¡æ¯çš„å¯¹è±¡<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">Consume</span>(<span class="params">ConsumeContext&lt;TransferData&gt; context</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// è·å–æ¶ˆæ¯å†…å®¹</span></span><br><span class="line">            <span class="keyword">var</span> data = context.Message;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// è®¡ç®—å½“å‰ä½™é¢ï¼šå‡è®¾åˆå§‹ä½™é¢ä¸º 1000ï¼Œå‡å»è½¬è´¦é‡‘é¢</span></span><br><span class="line">            <span class="keyword">var</span> nowBalance = <span class="keyword">new</span> CurrentBalance()</span><br><span class="line">            &#123;</span><br><span class="line">                Balance = <span class="number">1000</span> - data.Amount</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å°†å½“å‰ä½™é¢ä½œä¸ºå“åº”è¿”å›ç»™è¯·æ±‚æ–¹</span></span><br><span class="line">            <span class="keyword">await</span> context.RespondAsync(nowBalance);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æ¶ˆæ¯æ¶ˆè´¹è€…æœåŠ¡ï¼Œå®ç°äº† IConsumer&amp;lt;Account&amp;gt; æ¥å£ï¼Œç”¨äºå¤„ç† Account ç±»å‹çš„æ¶ˆæ¯ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">SenderServicer</span> : <span class="title">IConsumer</span>&lt;<span class="title">Account</span>&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ¶ˆè´¹æ¶ˆæ¯çš„æ–¹æ³•ï¼Œå½“æ¥æ”¶åˆ° Account ç±»å‹çš„æ¶ˆæ¯æ—¶è¢«è°ƒç”¨ã€‚</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;context&quot;&gt;</span>åŒ…å«æ¶ˆæ¯å’Œä¸Šä¸‹æ–‡ä¿¡æ¯çš„ ConsumeContext å¯¹è±¡ã€‚<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">Consume</span>(<span class="params">ConsumeContext&lt;Account&gt; context</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// è·å–æ¶ˆæ¯ä½“ä¸­çš„ Account å®ä¾‹</span></span><br><span class="line">            <span class="keyword">var</span> account = context.Message;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é…ç½® MassTransit æœåŠ¡</span></span><br><span class="line">builder.Services.AddMassTransit(x =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// æ³¨å†Œæ¶ˆæ¯æ¶ˆè´¹è€…ï¼šPublisherServicerã€SenderServicerã€RequestResponseServicer</span></span><br><span class="line">    x.AddConsumer&lt;PublisherServicer&gt;();</span><br><span class="line">    x.AddConsumer&lt;SenderServicer&gt;();</span><br><span class="line">    x.AddConsumer&lt;RequestResponseServicer&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨ RabbitMQ ä½œä¸ºæ¶ˆæ¯ä¸­é—´ä»¶</span></span><br><span class="line">    x.UsingRabbitMq((contxit, config) =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// é…ç½® RabbitMQ ä¸»æœºåœ°å€å’Œç™»å½•ä¿¡æ¯</span></span><br><span class="line">        config.Host(<span class="keyword">new</span> Uri(<span class="string">&quot;rabbitmq://localhost&quot;</span>), h =&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            h.Username(<span class="string">&quot;root&quot;</span>); <span class="comment">// ç”¨æˆ·å</span></span><br><span class="line">            h.Password(<span class="string">&quot;root&quot;</span>); <span class="comment">// å¯†ç </span></span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é…ç½® send-command é˜Ÿåˆ—ï¼Œç»‘å®š SenderServicer æ¶ˆè´¹è€…</span></span><br><span class="line">        config.ReceiveEndpoint(<span class="string">&quot;send-command&quot;</span>, e =&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            e.ConfigureConsumer&lt;SenderServicer&gt;(contxit);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é…ç½® publish-event é˜Ÿåˆ—ï¼Œç»‘å®š PublisherServicer æ¶ˆè´¹è€…</span></span><br><span class="line">        config.ReceiveEndpoint(<span class="string">&quot;publish-event&quot;</span>, e =&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            e.ConfigureConsumer&lt;PublisherServicer&gt;(contxit);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é…ç½® request-response é˜Ÿåˆ—ï¼Œç»‘å®š RequestResponseServicer æ¶ˆè´¹è€…</span></span><br><span class="line">        config.ReceiveEndpoint(<span class="string">&quot;request-response&quot;</span>, e =&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            e.ConfigureConsumer&lt;RequestResponseServicer&gt;(contxit);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> EF Core </tag>
            
            <tag> ASP.NET Core </tag>
            
            <tag> Entity Framework Core </tag>
            
            <tag> DDD </tag>
            
            <tag> RabbitMQ </tag>
            
            <tag> MassTransit </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>.NET Coreçš„èšåˆï¼ŒRabbitMQå®ç°é¢†åŸŸäº‹ä»¶</title>
      <link href="/2025/05/24/DDD/EFCore%E9%A2%86%E5%9F%9F%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%90%88%E9%80%82%E6%97%B6%E6%9C%BARabbitMQ%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/"/>
      <url>/2025/05/24/DDD/EFCore%E9%A2%86%E5%9F%9F%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%90%88%E9%80%82%E6%97%B6%E6%9C%BARabbitMQ%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="EF-Coreä¸­å‘å¸ƒé¢†åŸŸäº‹ä»¶çš„åˆé€‚æ—¶æœº"><a href="#EF-Coreä¸­å‘å¸ƒé¢†åŸŸäº‹ä»¶çš„åˆé€‚æ—¶æœº" class="headerlink" title="EF Coreä¸­å‘å¸ƒé¢†åŸŸäº‹ä»¶çš„åˆé€‚æ—¶æœº"></a>EF Coreä¸­å‘å¸ƒé¢†åŸŸäº‹ä»¶çš„åˆé€‚æ—¶æœº</h1><p>é¢†åŸŸäº‹ä»¶å¤§éƒ¨åˆ†å‘ç”Ÿåœ¨é¢†åŸŸæ¨¡å‹çš„ä¸šåŠ¡é€»è¾‘æ–¹æ³•ä¸Šæˆ–è€…é¢†åŸŸæœåŠ¡ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªé¢†åŸŸäº‹ä»¶å‘ç”Ÿçš„æ—¶å€™ç«‹å³è°ƒç”¨IMediatorçš„Publishæ–¹æ³•æ¥å‘å¸ƒé¢†åŸŸäº‹ä»¶ã€‚æˆ‘ä»¬ä¸€èˆ¬åœ¨èšåˆæ ¹çš„å®ä½“ç±»å¯¹è±¡çš„ChangeNameã€æ„é€ æ–¹æ³•ç­‰æ–¹æ³•ä¸­å‘å¸ƒé¢†åŸŸäº‹ä»¶ï¼Œå› ä¸ºæ— è®ºæ˜¯åº”ç”¨æœåŠ¡è¿˜æ˜¯é¢†åŸŸæœåŠ¡ï¼Œæœ€ç»ˆéƒ½è¦è°ƒç”¨èšåˆæ ¹ä¸­çš„æ–¹æ³•æ¥æ“ä½œèšåˆï¼Œæˆ‘ä»¬è¿™æ ·åšå¯ä»¥ç¡®ä¿é¢†åŸŸäº‹ä»¶ä¸ä¼šè¢«æ¼æ‰ã€‚ä½†æ˜¯åœ¨å®ä½“ç±»çš„ä¸šåŠ¡æ–¹æ³•ä¸­ç«‹å³è¿›è¡Œé¢†åŸŸæ—¶é—´çš„å‘å¸ƒå¯èƒ½ä¼šæœ‰ä»¥ä¸‹é—®é¢˜ã€‚</p><ol><li><p>å¯èƒ½å­˜åœ¨é‡å¤å‘é€é¢†åŸŸäº‹ä»¶çš„æƒ…å†µã€‚æ¯”å¦‚ï¼Œåœ¨â€œä¿®æ”¹ç”¨æˆ·ä¿¡æ¯â€è¿™ä¸ªåº”ç”¨æœåŠ¡æ“ä½œä¸­æˆ‘ä»¬åˆ†åˆ«è°ƒç”¨å®ä½“ç±»çš„ChangeNameã€ChangeAgeã€ChangeEmailæ–¹æ³•ä¿®æ”¹ç”¨æˆ·çš„å§“åã€å¹´é¾„å’Œé‚®ç®±ã€‚å› æ­¤æ¯ä¸ªChange???æ–¹æ³•ä¸­éƒ½ä¼šå‘å¸ƒâ€œå®ä½“ç±»è¢«ä¿®æ”¹â€çš„é¢†åŸŸäº‹ä»¶ï¼Œæ‰€ä»¥é¢†åŸŸäº‹ä»¶çš„å¤„ç†è€…å°±ä¼šè¢«å¤šæ¬¡è°ƒç”¨ï¼Œè¿™æ˜¯æ²¡æœ‰å¿…è¦çš„ï¼Œå…¶å®åªè¦å‘å¸ƒä¸€æ¬¡â€œå®ä½“ç±»è¢«ä¿®æ”¹â€çš„é¢†åŸŸäº‹ä»¶å³å¯ã€‚</p></li><li><p>é¢†åŸŸäº‹ä»¶å‘å¸ƒå¤ªæ—©ã€‚ä¸ºäº†ç¡®ä¿æ–°å¢åŠ çš„å®ä½“ç±»èƒ½å¤Ÿå‘å¸ƒâ€œæ–°å¢å®ä½“ç±»â€çš„é¢†åŸŸäº‹ä»¶ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å®ä½“ç±»çš„æ„é€ æ–¹æ³•ä¸­å‘å¸ƒé¢†åŸŸäº‹ä»¶ï¼Œä½†æ˜¯å¾ˆæœ‰å¯èƒ½å› ä¸ºæ•°æ®éªŒè¯æ²¡æœ‰é€šè¿‡ç­‰åŸå› ï¼Œæˆ‘ä»¬æœ€ç»ˆæ²¡æœ‰æŠŠè¿™ä¸ªæ–°å¢çš„å®ä½“ç±»ä¿å­˜åˆ°æ•°æ®åº“ä¸­ï¼Œè¿™æ ·åœ¨æ„é€ æ–¹æ³•ä¸­è¿‡æ—©åœ°å‘å¸ƒé¢†åŸŸäº‹ä»¶å°±å¯èƒ½å¯¼è‡´â€œè¯¯æŠ¥â€çš„é—®é¢˜ã€‚</p></li></ol><p>å‚è€ƒeShopOnContainersé¡¹ç›®ä¸­çš„åšæ³•ï¼ŒæŠŠé¢†åŸŸäº‹ä»¶çš„å‘å¸ƒå»¶è¿Ÿåˆ°ä¸Šä¸‹æ–‡ä¿å­˜ä¿®æ”¹æ—¶ã€‚ä¹Ÿå°±æ˜¯å®ä½“ç±»ä¸­åªæ³¨å†Œè¦å‘å¸ƒçš„é¢†åŸŸäº‹ä»¶ï¼Œç„¶åå†ä¸Šä¸‹æ–‡çš„SaveChangesæ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œæˆ‘ä»¬å†å‘å¸ƒé¢†åŸŸäº‹ä»¶ã€‚é¢†åŸŸäº‹ä»¶æ˜¯ç”±èšåˆæ ¹è¿›è¡Œç®¡ç†çš„ï¼Œå› æ­¤æˆ‘ä»¬å®šä¹‰äº†ä¾›èšåˆæ ¹è¿›è¡Œäº‹ä»¶æ³¨å†Œçš„æ¥å£IDomainEventsã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> å®šä¹‰é¢†åŸŸäº‹ä»¶é›†åˆçš„æ¥å£ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> è¯¥æ¥å£ç”¨äºèšåˆæ ¹æˆ–å®ä½“å¯¹è±¡ä¸­ï¼Œç®¡ç†ä¸å…¶ç›¸å…³çš„é¢†åŸŸäº‹ä»¶ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> é¢†åŸŸäº‹ä»¶é€šå¸¸ç”¨äºåœ¨é¢†åŸŸæ¨¡å‹å†…éƒ¨å‘ç”Ÿé‡è¦ä¸šåŠ¡è¡Œä¸ºæ—¶ï¼Œ</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> å°†è¿™äº›è¡Œä¸ºä»¥äº‹ä»¶çš„å½¢å¼å‘å¸ƒç»™å¤–éƒ¨è¿›è¡Œå¤„ç†ï¼ˆå¦‚å‘é€é€šçŸ¥ã€é›†æˆç­‰ï¼‰ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> </span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ä¸»è¦èŒè´£åŒ…æ‹¬ï¼š</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 1. è·å–å½“å‰å·²æ³¨å†Œçš„æ‰€æœ‰é¢†åŸŸäº‹ä»¶ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 2. æ·»åŠ æ–°çš„é¢†åŸŸäº‹ä»¶ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 3. å¦‚æœä¸å­˜åœ¨åˆ™æ·»åŠ æ–°çš„é¢†åŸŸäº‹ä»¶ï¼ˆé˜²æ­¢é‡å¤æ·»åŠ ï¼‰ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 4. æ¸…ç©ºæ‰€æœ‰å·²æ³¨å†Œçš„é¢†åŸŸäº‹ä»¶ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IDomainEvents</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function">IEnumerable&lt;INotification&gt; <span class="title">GetDomainEvents</span>()</span>;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">AddDomainEvent</span>(<span class="params">INotification eventItem</span>)</span>;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">AddDomainEventIfAbsent</span>(<span class="params">INotification eventItem</span>)</span>;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">ClearDomainEvents</span>()</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸ºäº†ç®€åŒ–å®ä½“ç±»çš„ä»£ç ç¼–å†™ï¼Œæˆ‘ä»¬ç¼–å†™å®ç°äº†IDomainEventsæ¥å£çš„æŠ½è±¡å®ä½“ç±»BaseEntityã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> é¢†åŸŸå®ä½“åŸºç±»ï¼Œæ”¯æŒé¢†åŸŸäº‹ä»¶çš„æ”¶é›†ä¸ç®¡ç†ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> </span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ä¸»è¦åŠŸèƒ½è¯´æ˜ï¼š</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 1. é€šè¿‡ AddDomainEvent æ–¹æ³•æ·»åŠ é¢†åŸŸäº‹ä»¶ï¼ˆINotification å®ä¾‹ï¼‰ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 2. é€šè¿‡ AddDomainEventIfAbsent æ–¹æ³•é¿å…é‡å¤æ·»åŠ ç›¸åŒäº‹ä»¶ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 3. é€šè¿‡ ClearDomainEvents æ–¹æ³•æ¸…ç©ºæ‰€æœ‰å·²æ”¶é›†çš„é¢†åŸŸäº‹ä»¶ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> 4. é€šè¿‡ GetDomainEvents æ–¹æ³•è·å–å½“å‰æ”¶é›†çš„æ‰€æœ‰é¢†åŸŸäº‹ä»¶ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> </span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ä½¿ç”¨åœºæ™¯ï¼š</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> - é¢†åŸŸæ¨¡å‹åœ¨ä¸šåŠ¡æ“ä½œä¸­å¯è°ƒç”¨ AddDomainEvent/AddDomainEventIfAbsent æ·»åŠ äº‹ä»¶ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> - åº”ç”¨å±‚å¯åœ¨æŒä¹…åŒ–æ“ä½œåç»Ÿä¸€å‘å¸ƒå¹¶æ¸…ç†é¢†åŸŸäº‹ä»¶ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title">BaseEntity</span> : <span class="title">IDomainEvents</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> List&lt;INotification&gt; DomainEvents = <span class="keyword">new</span>();</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AddDomainEvent</span>(<span class="params">INotification eventItem</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            DomainEvents.Add(eventItem);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AddDomainEventIfAbsent</span>(<span class="params">INotification eventItem</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(!DomainEvents.Contains(eventItem))</span><br><span class="line">            &#123;</span><br><span class="line">                DomainEvents.Add(eventItem);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ClearDomainEvents</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            DomainEvents.Clear();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> IEnumerable&lt;INotification&gt; <span class="title">GetDomainEvents</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> DomainEvents;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬éœ€è¦åœ¨ä¸Šä¸‹æ–‡ä¸­ä¿å­˜æ•°æ®çš„æ—¶å€™å‘å¸ƒæ³¨å†Œçš„é¢†åŸŸäº‹ä»¶ã€‚åœ¨DDDä¸­ï¼Œæ¯ä¸ªèšåˆéƒ½å¯¹åº”ä¸€ä¸ªä¸Šä¸‹æ–‡ï¼Œå› æ­¤é¡¹ç›®ä¸­çš„ä¸Šä¸‹æ–‡ç±»éå¸¸å¤šã€‚ä¸ºäº†ç®€åŒ–ä¸Šä¸‹æ–‡ç çš„ç¼–å†™ï¼Œæˆ‘ä»¬ç¼–å†™BaseContextç±»ï¼Œå°†åœ¨SaveChangesä¸­å‘å¸ƒé¢†åŸŸäº‹ä»¶çš„ä»£ç åˆ†è£…åˆ°è¿™ä¸ªç±»ä¸­ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> åŸºç¡€DbContextï¼Œé›†æˆé¢†åŸŸäº‹ä»¶å‘å¸ƒæœºåˆ¶ã€‚</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> åœ¨è°ƒç”¨SaveChangesAsyncæ—¶ï¼Œä¼šè‡ªåŠ¨æ”¶é›†å®ç°IDomainEventsæ¥å£çš„å®ä½“ä¸Šçš„é¢†åŸŸäº‹ä»¶ï¼Œ</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> å¹¶é€šè¿‡IMediatorä¾æ¬¡å‘å¸ƒè¿™äº›äº‹ä»¶ï¼Œæœ€åå†æäº¤æ•°æ®åº“å˜æ›´ã€‚</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> æ³¨æ„ï¼šç¦æ­¢ç›´æ¥è°ƒç”¨åŒæ­¥çš„SaveChangesæ–¹æ³•ã€‚</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">BaseDbContext</span>:<span class="title">DbContext</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> IMediator mediator;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BaseDbContext</span>(<span class="params">DbContextOptions options,IMediator mediator</span>) : <span class="title">base</span>(<span class="params">options</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.mediator = mediator;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">int</span> <span class="title">SaveChanges</span>(<span class="params"><span class="built_in">bool</span> acceptAllChangesOnSuccess</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> NotImplementedException(<span class="string">&quot;Dot&#x27;t call SaveCheanges&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">async</span> Task&lt;<span class="built_in">int</span>&gt; <span class="title">SaveChangesAsync</span>(<span class="params"><span class="built_in">bool</span> acceptAllChangesOnSuccess,CancellationToken cancellationToken = <span class="literal">default</span></span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> domainEntities = <span class="keyword">this</span>.ChangeTracker.Entries&lt;IDomainEvents&gt;()</span><br><span class="line">            .Where(x =&gt; x.Entity.GetDomainEvents().Any());</span><br><span class="line">        <span class="keyword">var</span> domainEvents = domainEntities.SelectMany(x =&gt; x.Entity.GetDomainEvents()).ToList();</span><br><span class="line">        domainEntities.ToList().ForEach(entity=&gt;entity.Entity.ClearDomainEvents());</span><br><span class="line">        <span class="keyword">foreach</span>(<span class="keyword">var</span> domainEvent <span class="keyword">in</span> domainEvents)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">await</span> mediator.Publish(domainEvent);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">await</span> <span class="keyword">base</span>.SaveChangesAsync(acceptAllChangesOnSuccess,cancellationToken);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å› ä¸ºæˆ‘ä»¬éœ€è¦å‘å¸ƒæ³¨å†Œçš„é¢†åŸŸäº‹ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡æ„é€ æ–¹æ³•æ³¨å…¥IMediatoræœåŠ¡ï¼›æˆ‘ä»¬é‡å†™çˆ¶ç±»çš„SaveChangesAsyncæ–¹æ³•ï¼Œåœ¨è°ƒç”¨çˆ¶ç±»çš„SaveChangesAsyncæ–¹æ³•ä¿å­˜ä¿®æ”¹ä¹‹å‰ï¼Œæˆ‘ä»¬æŠŠæ‰€æœ‰å®ä½“ç±»ä¸­æ³¨å†Œçš„é¢†åŸŸäº‹ä»¶å‘å¸ƒå‡ºå»ï¼›ç¬¬15è¡Œä»£ç ä¸­è·å¾—ChangeTrackeræ˜¯ä¸Šä¸‹æ–‡ä¸­ç”¨æ¥å¯¹å®ä½“ç±»çš„å˜åŒ–è¿›è¡Œè¿½è¸ªçš„å¯¹è±¡ï¼ŒEntries&lt;IDomainEvents&gt;è·å¾—çš„æ˜¯æ‰€æœ‰å®ç°äº†IDomainEventsæ¥å£çš„è¿½è¸ªå®ä½“ç±»ï¼›æˆ‘ä»¬åœ¨é¡¹ç›®ä¸­å¼ºåˆ¶è¦æ±‚ä¸èƒ½ä½¿ç”¨åŒæ­¥çš„SaveChangesæ–¹æ³•ï¼Œå› æ­¤ç¬¬10è¡Œä»£ç ä¸­å¯¹SaveChangesçš„è°ƒç”¨æŠ›å‡ºå¼‚å¸¸ã€‚</p><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å®Œæˆäº†EFCoreä¸­ç®€åŒ–é¢†åŸŸäº‹ä»¶å‘å¸ƒçš„å‡ ä¸ªæ¥å£å’ŒæŠ½è±¡ç±»çš„å¼€å‘ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç¼–å†™ç”¨æ¥æµ‹è¯•çš„å®ä½“ç±»å’Œä¸Šä¸‹æ–‡ï¼Œé¦–å…ˆæˆ‘ä»¬ç¼–å†™ä»£è¡¨ç”¨æˆ·çš„å®ä½“ç±»User</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> ç”¨æˆ·é¢†åŸŸå®ä½“ï¼ŒåŒ…å«ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯åŠé¢†åŸŸäº‹ä»¶çš„å‘å¸ƒã€‚</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> </span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> ä¸»è¦åŠŸèƒ½è¯´æ˜ï¼š</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 1. æ„é€ å‡½æ•°åˆ›å»ºç”¨æˆ·æ—¶å‘å¸ƒ UserAddedEvent é¢†åŸŸäº‹ä»¶ã€‚</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 2. ä¿®æ”¹æ˜µç§°å’Œå¹´é¾„æ—¶ï¼Œè‹¥æœªå‘å¸ƒè¿‡ UserUpdatedEventï¼Œåˆ™å‘å¸ƒè¯¥äº‹ä»¶ã€‚</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 3. è½¯åˆ é™¤ç”¨æˆ·æ—¶å‘å¸ƒ UserSoftDeletedEvent é¢†åŸŸäº‹ä»¶ã€‚</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> 4. ç»§æ‰¿è‡ª BaseEntityï¼Œæ”¯æŒé¢†åŸŸäº‹ä»¶çš„æ”¶é›†ä¸ç®¡ç†ã€‚</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">User</span>:<span class="title">BaseEntity</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> Guid Id &#123; <span class="keyword">get</span>; <span class="keyword">init</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> UserName &#123; <span class="keyword">get</span>; <span class="keyword">init</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Email &#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span>? Nickname &#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span>? Age &#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">bool</span> IsDeleted &#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span>()</span> &#123; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span>(<span class="params"><span class="built_in">string</span> userName,<span class="built_in">string</span> email</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.Id = Guid.NewGuid();</span><br><span class="line">        <span class="keyword">this</span>.UserName = userName;</span><br><span class="line">        <span class="keyword">this</span>.Email = email;</span><br><span class="line">        <span class="keyword">this</span>.IsDeleted = <span class="literal">false</span>;</span><br><span class="line">        AddDomainEvent(<span class="keyword">new</span> UserAddedEvent(<span class="keyword">this</span>));        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ChangNickName</span>(<span class="params"><span class="built_in">string</span>? <span class="keyword">value</span></span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.Nickname = <span class="keyword">value</span>;</span><br><span class="line">        AddDomainEventIfAbsent(<span class="keyword">new</span> UserUpdatedEvent(Id));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ChangeAge</span>(<span class="params"><span class="built_in">int</span> <span class="keyword">value</span></span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.Age=<span class="keyword">value</span>;</span><br><span class="line">        AddDomainEventIfAbsent(<span class="keyword">new</span> UserUpdatedEvent(Id));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SoftDelete</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.IsDeleted=<span class="literal">true</span>;</span><br><span class="line">        AddDomainEvent(<span class="keyword">new</span> UserSoftDeletedEvent(Id));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬åœ¨ç¬¬16è¡Œä»£ç çš„æœ‰å‚æ„é€ æ–¹æ³•ä¸­ï¼Œå‘å¸ƒäº†UserAddedEventé¢†åŸŸäº‹ä»¶ï¼Œè¿™æ ·å½“æˆ‘ä»¬åˆ›å»ºæ–°çš„å®ä½“ç±»å¹¶ä¸”ä¿å­˜ä¿®æ”¹çš„æ—¶å€™ï¼Œè¿™ä¸ªé¢†åŸŸäº‹ä»¶å°±ä¼šè¢«å‘å¸ƒã€‚ä½†æ˜¯å¦‚æœEF Coreä»æ•°æ®åº“ä¸­åŠ è½½å·²æœ‰æ•°æ®çš„æ—¶å€™ï¼Œä¹Ÿæ‰§è¡Œç¬¬16è¡Œä»£ç çš„æœ‰å‚æ„é€ æ–¹æ³•ï¼Œå°±ä¼šå¯¼è‡´åœ¨åŠ è½½æ•°æ®çš„æ—¶å€™ä¹Ÿå‘æ­¥UserAddedEventé¢†åŸŸäº‹ä»¶ï¼Œè¿™å°±å‘ç”Ÿé€»è¾‘é”™è¯¯äº†ï¼Œå› æ­¤æˆ‘ä»¬åœ¨ç¬¬9è¡Œä»£ç ä¸­æä¾›ä¸€ä¸ªæ— å‚æ„é€ æ–¹æ³•ä¾›EF Coreä»æ•°æ®åº“ä¸­åŠ è½½æ•°æ®æ˜¯ä½¿ç”¨ã€‚</p><p>å› ä¸ºæˆ‘ä»¬å¯èƒ½è¿ç»­è°ƒç”¨ChangeNickNameã€ChangeAgeç­‰æ–¹æ³•ï¼Œæ‰€æœ‰æˆ‘ä»¬åœ¨ç¬¬21ã€26è¡Œä»£ç ä¸­é€šè¿‡AddDomainEventlfAbsentæ³¨å†Œé¢†åŸŸäº‹ä»¶ï¼Œä»è€Œé¿å…æ¶ˆæ¯çš„é‡å¤å‘å¸ƒã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">record</span> <span class="title">UserAddedEvent</span>(<span class="params">User Item</span>):INotification</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">record</span> <span class="title">UserUpdatedEvent</span>(<span class="params">Guid Id</span>):INotification</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">record</span> <span class="title">UserSoftDeletedEvent</span>(<span class="params">Guid Id</span>):INotification</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç¼–å†™äº‹ä»¶å¤„ç†ç±»æ¥å¯¹è¿™äº›é¢†åŸŸäº‹ä»¶è¿›è¡Œå¤„ç†ã€‚é¦–å…ˆæˆ‘ä»¬ç¼–å†™å“åº”UserAddedEventé¢†åŸŸäº‹ä»¶ï¼Œç„¶åå‘ç”¨æˆ·å‘é€æ³¨å†Œé‚®ä»¶çš„NewUserSendEmailHandlerç±»ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">NewUserSendEmailHandler</span> : <span class="title">INotificationHandler</span>&lt;<span class="title">UserAddedEvent</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> ILogger&lt;NewUserSendEmailHandler&gt; _logger;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">NewUserSendEmailHandler</span>(<span class="params">ILogger&lt;NewUserSendEmailHandler&gt; logger</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _logger = logger;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Task <span class="title">Handle</span>(<span class="params">UserAddedEvent notification, CancellationToken cancellationToken</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> user = notification.Item;</span><br><span class="line">        _logger.LogInformation(<span class="string">$&quot;å‘<span class="subst">&#123;user.Email&#125;</span>å‘é€æ¬¢è¿é‚®ä»¶&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> Task.CompletedTask;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ—¥å¿—è¾“å‡ºä»£æ›¿çœŸæ­£çš„æ—¥å¿—å‘é€ã€‚åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œç”±äºé‚®ä»¶å‘é€æ¯”è¾ƒè€—æ—¶ï¼Œå»ºè®®æŠŠé‚®ä»¶å‘é€çš„ä»£ç æ”¾åˆ°åå°çº¿ç¨‹æ‰§è¡Œï¼Œè€Œä¸æ˜¯å¼‚æ­¥ç­‰å¾…é‚®ä»¶å‘é€çš„ç»“æœã€‚</p><p>ä¸‹é¢æˆ‘ä»¬åœ¨å®ç°ä¸€ä¸ªâ€œå½“ç”¨æˆ·çš„ä¸ªäººä¿¡æ¯è¢«ä¿®æ”¹åï¼Œå‘é‚®ä»¶é€šçŸ¥ç”¨æˆ·çš„äº‹ä»¶å¤„ç†è€…â€çš„åŠŸèƒ½ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ModifyUserLogHandler</span> : <span class="title">INotificationHandler</span>&lt;<span class="title">UserUpdatedEvent</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> UserDbContext _dbContext;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> ILogger&lt;ModifyUserLogHandler&gt; _logger;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ModifyUserLogHandler</span>(<span class="params">BaseDbContext dbContext, ILogger&lt;ModifyUserLogHandler&gt; logger</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _dbContext = dbContext;</span><br><span class="line">        _logger = logger;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">Handle</span>(<span class="params">UserUpdatedEvent notification, CancellationToken cancellationToken</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> user=<span class="keyword">await</span> _dbContext.Users.FindAsync(notification.Id);</span><br><span class="line">        _logger.LogInformation(<span class="string">$&quot;é€šçŸ¥ç”¨æˆ·<span class="subst">&#123;user.Email&#125;</span>çš„ä¿¡æ¯è¢«ä¿®æ”¹&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å› ä¸ºUserUpdatedEventä¸­åªåŒ…å«è¢«ä¿®æ”¹ç”¨æˆ·çš„æ ‡è¯†ç¬¦ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ç¬¬12è¡Œä»£ç ä¸­é€šè¿‡FindAsyncè·å–è¢«ä¿®æ”¹ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯ã€‚å› ä¸ºFindAsyncä¼šé¦–å…ˆä»ä¸Šä¸‹æ–‡çš„ç¼“å­˜ä¸­è·å–å¯¹è±¡ï¼Œè€Œä¿®æ”¹æ“ä½œä¹‹å‰è¢«ä¿®æ”¹çš„å¯¹è±¡å·²ç»å­˜åœ¨ä¸ç¼“å­˜ä¸­äº†ï¼Œæ‰€ä»¥ç”¨FindAsyncä¸ä»…èƒ½å¤Ÿè·å–è¿˜æ²¡æœ‰æäº¤åˆ°æ•°æ®åº“çš„å¯¹è±¡ï¼Œè€Œä¸”ç”±äºFindAsyncæ“ä½œä¸ä¼šå†åˆ°æ•°æ®åº“ä¸­æŸ¥è¯¢ï¼Œå› æ­¤ç¨‹åºçš„æ€§èƒ½æ›´é«˜ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    [<span class="meta">Route(<span class="string">&quot;api/[controller]/[action]&quot;</span>)</span>]</span><br><span class="line">    [<span class="meta">ApiController</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UsersController</span> : <span class="title">ControllerBase</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> UserDbContext context;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">UsersController</span>(<span class="params">UserDbContext context</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.context = context;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        [<span class="meta">HttpPost</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;IActionResult&gt; <span class="title">Add</span>(<span class="params">AddUserRequest req</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> user = <span class="keyword">new</span> User(req.UserName, req.Email);</span><br><span class="line">            context.Users.Add(user);</span><br><span class="line">            <span class="keyword">await</span> context.SaveChangesAsync();</span><br><span class="line">            <span class="keyword">return</span> Ok();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        [<span class="meta">HttpPut</span>]</span><br><span class="line">        [<span class="meta">Route(<span class="string">&quot;&#123;id&#125;&quot;</span>)</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;IActionResult&gt; <span class="title">Update</span>(<span class="params">Guid id,UpdateUserRequest req</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            User? user = context.Users.Find(id);</span><br><span class="line">            <span class="keyword">if</span> (user==<span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> NotFound(<span class="string">$&quot;id=<span class="subst">&#123;id&#125;</span>çš„Userä¸å­˜åœ¨&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            user.ChangeAge(req.Age);</span><br><span class="line">            user.ChangeEmail(req.Email);</span><br><span class="line">            user.ChangeNickName(req.NickName);</span><br><span class="line">            <span class="keyword">await</span> context.SaveChangesAsync();</span><br><span class="line">            <span class="keyword">return</span> Ok();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        [<span class="meta">HttpDelete</span>]</span><br><span class="line">        [<span class="meta">Route(<span class="string">&quot;id&quot;</span>)</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;IActionResult&gt; <span class="title">Delete</span>(<span class="params">Guid id</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            User? user = context.Users.Find(id);</span><br><span class="line">            <span class="keyword">if</span> (user == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> NotFound(<span class="string">$&quot;id=<span class="subst">&#123;id&#125;</span>çš„Userä¸å­˜åœ¨&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            user.SoftDelete();</span><br><span class="line">            <span class="keyword">await</span> context.SaveChangesAsync();</span><br><span class="line">            <span class="keyword">return</span> Ok();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="RabbitMQçš„åŸºæœ¬ä½¿ç”¨"><a href="#RabbitMQçš„åŸºæœ¬ä½¿ç”¨" class="headerlink" title="RabbitMQçš„åŸºæœ¬ä½¿ç”¨"></a>RabbitMQçš„åŸºæœ¬ä½¿ç”¨</h1><p>å’Œé¢†åŸŸäº‹ä»¶ä¸åŒï¼Œé›†æˆäº‹ä»¶ç”¨äºåœ¨å¾®æœåŠ¡é—´è¿›è¡Œäº‹ä»¶çš„ä¼ é€’ï¼Œå› æ­¤è¿™æ˜¯æœåŠ¡å™¨é—´çš„é€šä¿¡ï¼Œæ‰€ä»¥å¿…é¡»å€ŸåŠ©äºç¬¬ä¸‰æ–¹æœåŠ¡å™¨ä½œä¸ºäº‹ä»¶æ€»çº¿ã€‚æˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨æ¶ˆæ¯ä¸­é—´ä»¶æ¥ä½œä¸ºäº‹ä»¶æ€»çº¿ã€‚æ˜å‰æœ‰Redisã€RabbitMQã€Kafkaã€ActiveMQç­‰ã€‚</p><p>æˆ‘ä»¬å…ˆäº†è§£RabbitMQä¸­çš„å‡ ä¸ªåŸºæœ¬æ¦‚å¿µã€‚</p><ol><li><p>ä¿¡é“ï¼ˆchannelï¼‰ï¼šä¿¡é“æ˜¯æ¶ˆæ¯çš„ç”Ÿäº§è€…ã€æ¶ˆæ¯è€…å’ŒæœåŠ¡å™¨ä¹‹é—´è¿›è¡Œé€šä¿¡çš„è™šæ‹Ÿè¿æ¥ã€‚<br>ä¸ºä»€ä¹ˆå«â€œè™šæ‹Ÿè¿æ¥â€å‘¢ï¼Ÿå› æ­¤TCPè¿æ¥çš„å»ºç«‹æ˜¯éå¸¸æ¶ˆè€—èµ„æºçš„ï¼Œæ‰€ä»¥RabbitMQåœ¨TCPé“¾æ¥çš„åŸºç¡€ä¸Šæ„å»ºäº†è™šæ‹Ÿé€šä¿¡ã€‚æˆ‘ä»¬å°½é‡é‡å¤ä½¿ç”¨TCPè¿æ¥ï¼Œè€Œé€šä¿¡æ˜¯å¯ä»¥ç”¨å®Œå°±å…³é—­çš„ã€‚</p></li><li><p>é˜Ÿåˆ—ï¼ˆqueueï¼‰ï¼šé˜Ÿåˆ—æ˜¯ç”¨æ¥è¿›è¡Œæ¶ˆæ¯æ”¶å‘çš„åœ°æ–¹ï¼Œç”Ÿäº§è€…æŠŠæ¶ˆæ¯æ”¾åˆ°é˜Ÿåˆ—ä¸­ï¼Œæ¶ˆè´¹è€…ä»é˜Ÿåˆ—ä¸­è·å–æ¶ˆæ¯ã€‚</p></li><li><p>äº¤æ¢æœºï¼ˆexchangeï¼‰ï¼šäº¤æ¢æœºç”¨äºæŠŠæ¶ˆæ¯è·¯ç”±åˆ°ä¸€ä¸ªæˆ–è€…å¤šä¸ªé˜Ÿåˆ—ä¸­ã€‚</p></li></ol><h2 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h2><p>ç°åœ¨è®©æˆ‘ä»¬ç”Ÿæˆä¸¤ä¸ªé¡¹ç›®ï¼Œä¸€ä¸ªç”¨äºå‘å¸ƒè€…ï¼Œä¸€ä¸ªç”¨äºä½¿ç”¨è€…</p><p><img src="/img%5CDDD%5C18.png"></p><h3 id="å‘é€"><a href="#å‘é€" class="headerlink" title="å‘é€"></a>å‘é€</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> RabbitMQ.Client;</span><br><span class="line"><span class="keyword">using</span> System.Net.Quic;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºè¿æ¥å·¥å‚å¯¹è±¡ï¼Œç”¨äºé…ç½®RabbitMQè¿æ¥å‚æ•°</span></span><br><span class="line"><span class="keyword">var</span> factory = <span class="keyword">new</span> ConnectionFactory();</span><br><span class="line">factory.HostName = <span class="string">&quot;localhost&quot;</span>; <span class="comment">// RabbitMQæœåŠ¡å™¨åœ°å€</span></span><br><span class="line">factory.Port = <span class="number">5672</span>;            <span class="comment">// ç«¯å£å·</span></span><br><span class="line">factory.UserName = <span class="string">&quot;root&quot;</span>;      <span class="comment">// ç”¨æˆ·å</span></span><br><span class="line">factory.Password = <span class="string">&quot;root&quot;</span>;      <span class="comment">// å¯†ç </span></span><br><span class="line">factory.VirtualHost = <span class="string">&quot;vhost&quot;</span>;  <span class="comment">// è™šæ‹Ÿä¸»æœº</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºä¸RabbitMQçš„è¿æ¥ï¼ˆå¼‚æ­¥ï¼‰</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">var</span> connection = <span class="keyword">await</span> factory.CreateConnectionAsync();</span><br><span class="line"><span class="comment">// åˆ›å»ºä¿¡é“ï¼ˆå¼‚æ­¥ï¼‰ï¼Œç”¨äºä¸RabbitMQè¿›è¡Œé€šä¿¡</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">var</span> channel = <span class="keyword">await</span> connection.CreateChannelAsync();</span><br><span class="line"></span><br><span class="line"><span class="comment">// å£°æ˜ä¸€ä¸ªåä¸º&quot;hello&quot;çš„é˜Ÿåˆ—ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è‡ªåŠ¨åˆ›å»º</span></span><br><span class="line"><span class="comment">// durable: é˜Ÿåˆ—æ˜¯å¦æŒä¹…åŒ–ï¼Œfalseè¡¨ç¤ºä¸æŒä¹…åŒ–</span></span><br><span class="line"><span class="comment">// exclusive: æ˜¯å¦æ’ä»–ï¼Œfalseè¡¨ç¤ºå…è®¸å¤šä¸ªè¿æ¥è®¿é—®</span></span><br><span class="line"><span class="comment">// autoDelete: æ˜¯å¦è‡ªåŠ¨åˆ é™¤ï¼Œfalseè¡¨ç¤ºä¸è‡ªåŠ¨åˆ é™¤</span></span><br><span class="line"><span class="comment">// arguments: å…¶ä»–å‚æ•°ï¼Œè¿™é‡Œä¸ºnull</span></span><br><span class="line"><span class="keyword">await</span> channel.QueueDeclareAsync(queue: <span class="string">&quot;hello&quot;</span>, durable: <span class="literal">false</span>, exclusive: <span class="literal">false</span>, autoDelete: <span class="literal">false</span>, arguments: <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¦å‘é€çš„æ¶ˆæ¯å†…å®¹</span></span><br><span class="line"><span class="keyword">const</span> <span class="built_in">string</span> message = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line"><span class="comment">// å°†æ¶ˆæ¯å†…å®¹ç¼–ç ä¸ºå­—èŠ‚æ•°ç»„</span></span><br><span class="line"><span class="keyword">var</span> body = Encoding.UTF8.GetBytes(message);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘é€æ¶ˆæ¯åˆ°æŒ‡å®šé˜Ÿåˆ—ï¼ˆexchangeä¸ºç©ºå­—ç¬¦ä¸²è¡¨ç¤ºé»˜è®¤äº¤æ¢æœºï¼‰</span></span><br><span class="line"><span class="keyword">await</span> channel.BasicPublishAsync(exchange: <span class="built_in">string</span>.Empty, routingKey: <span class="string">&quot;hello&quot;</span>, body: body);</span><br><span class="line">Console.WriteLine(<span class="string">$&quot; [x] Sent <span class="subst">&#123;message&#125;</span>&quot;</span>);</span><br><span class="line"></span><br><span class="line">Console.WriteLine(<span class="string">&quot; Press [enter] to exit&quot;</span>);</span><br><span class="line"><span class="comment">// ç­‰å¾…ç”¨æˆ·æŒ‰ä¸‹å›è½¦é”®åé€€å‡ºç¨‹åº</span></span><br><span class="line">Console.ReadLine();</span><br></pre></td></tr></table></figure><h3 id="æ¥æ”¶"><a href="#æ¥æ”¶" class="headerlink" title="æ¥æ”¶"></a>æ¥æ”¶</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> RabbitMQ.Client;</span><br><span class="line"><span class="keyword">using</span> RabbitMQ.Client.Events;</span><br><span class="line"><span class="keyword">using</span> System.Runtime.CompilerServices;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºè¿æ¥å·¥å‚å¯¹è±¡ï¼Œç”¨äºé…ç½®RabbitMQè¿æ¥å‚æ•°</span></span><br><span class="line"><span class="keyword">var</span> factory = <span class="keyword">new</span> ConnectionFactory();</span><br><span class="line">factory.HostName = <span class="string">&quot;localhost&quot;</span>; <span class="comment">// RabbitMQæœåŠ¡å™¨åœ°å€</span></span><br><span class="line">factory.Port = <span class="number">5672</span>;            <span class="comment">// ç«¯å£å·</span></span><br><span class="line">factory.UserName = <span class="string">&quot;root&quot;</span>;      <span class="comment">// ç”¨æˆ·å</span></span><br><span class="line">factory.Password = <span class="string">&quot;root&quot;</span>;      <span class="comment">// å¯†ç </span></span><br><span class="line">factory.VirtualHost = <span class="string">&quot;vhost&quot;</span>;  <span class="comment">// è™šæ‹Ÿä¸»æœº</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºä¸RabbitMQæœåŠ¡å™¨çš„è¿æ¥</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">var</span> connection = <span class="keyword">await</span> factory.CreateConnectionAsync();</span><br><span class="line"><span class="comment">// åœ¨è¿æ¥çš„åŸºç¡€ä¸Šåˆ›å»ºä¸€ä¸ªé€šé“ï¼ˆchannelï¼‰ï¼Œç”¨äºæ”¶å‘æ¶ˆæ¯</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">var</span> channel = <span class="keyword">await</span> connection.CreateChannelAsync();</span><br><span class="line"></span><br><span class="line"><span class="comment">// å£°æ˜ä¸€ä¸ªåä¸º&quot;hello&quot;çš„é˜Ÿåˆ—ï¼Œå¦‚æœé˜Ÿåˆ—ä¸å­˜åœ¨åˆ™ä¼šè‡ªåŠ¨åˆ›å»º</span></span><br><span class="line"><span class="comment">// durable: false è¡¨ç¤ºé˜Ÿåˆ—åœ¨RabbitMQé‡å¯åä¸ä¼šä¿ç•™</span></span><br><span class="line"><span class="comment">// exclusive: false è¡¨ç¤ºé˜Ÿåˆ—å¯ä»¥è¢«å¤šä¸ªè¿æ¥å…±äº«</span></span><br><span class="line"><span class="comment">// autoDelete: false è¡¨ç¤ºé˜Ÿåˆ—åœ¨æ²¡æœ‰æ¶ˆè´¹è€…æ—¶ä¸ä¼šè‡ªåŠ¨åˆ é™¤</span></span><br><span class="line"><span class="keyword">await</span> channel.QueueDeclareAsync(queue: <span class="string">&quot;hello&quot;</span>, durable: <span class="literal">false</span>, exclusive: <span class="literal">false</span>, autoDelete: <span class="literal">false</span>, arguments: <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">Console.WriteLine(<span class="string">&quot;[*] Waiting for messages&quot;</span>); <span class="comment">// æç¤ºæ­£åœ¨ç­‰å¾…æ¶ˆæ¯</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªå¼‚æ­¥äº‹ä»¶æ¶ˆè´¹è€…ï¼Œç”¨äºæ¥æ”¶é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯</span></span><br><span class="line"><span class="keyword">var</span> consumer = <span class="keyword">new</span> AsyncEventingBasicConsumer(channel);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å½“æ”¶åˆ°æ¶ˆæ¯æ—¶è§¦å‘çš„äº‹ä»¶</span></span><br><span class="line">consumer.ReceivedAsync += (model, ea) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// è·å–æ¶ˆæ¯çš„å†…å®¹ï¼ˆå­—èŠ‚æ•°ç»„ï¼‰</span></span><br><span class="line">    <span class="keyword">var</span> body = ea.Body.ToArray();</span><br><span class="line">    <span class="comment">// å°†å­—èŠ‚æ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="keyword">var</span> message = Encoding.UTF8.GetString(body);</span><br><span class="line">    <span class="comment">// æ‰“å°æ”¶åˆ°çš„æ¶ˆæ¯</span></span><br><span class="line">    Console.WriteLine(<span class="string">$&quot; [x] Received <span class="subst">&#123;message&#125;</span>&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> Task.CompletedTask;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¼€å§‹æ¶ˆè´¹&quot;hello&quot;é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ï¼ŒautoAck: true è¡¨ç¤ºè‡ªåŠ¨ç¡®è®¤æ¶ˆæ¯</span></span><br><span class="line"><span class="keyword">await</span> channel.BasicConsumeAsync(<span class="string">&quot;hello&quot;</span>, autoAck: <span class="literal">true</span>, consumer: consumer);</span><br><span class="line"></span><br><span class="line">Console.WriteLine(<span class="string">&quot; Press [enter] to exit.&quot;</span>); <span class="comment">// æç¤ºç”¨æˆ·æŒ‰å›è½¦é”®é€€å‡º</span></span><br><span class="line">Console.ReadLine(); <span class="comment">// ç­‰å¾…ç”¨æˆ·è¾“å…¥ï¼Œé˜²æ­¢ç¨‹åºé€€å‡º</span></span><br></pre></td></tr></table></figure><h2 id="å·¥ä½œé˜Ÿåˆ—"><a href="#å·¥ä½œé˜Ÿåˆ—" class="headerlink" title="å·¥ä½œé˜Ÿåˆ—"></a>å·¥ä½œé˜Ÿåˆ—</h2><p><img src="/img%5CDDD%5C19.png"></p><p>å·¥ä½œé˜Ÿåˆ—ï¼ˆåˆåï¼šä»»åŠ¡é˜Ÿåˆ—ï¼‰èƒŒåçš„ä¸»è¦æ€æƒ³æ˜¯é¿å… ç«‹å³æ‰§è¡Œèµ„æºå¯†é›†å‹ä»»åŠ¡ï¼Œå¹¶ä¸”å¿…é¡»ç­‰å¾… å®ƒå®Œæˆã€‚ç›¸åï¼Œæˆ‘ä»¬å°†ä»»åŠ¡å®‰æ’åœ¨ç¨åå®Œæˆã€‚æˆ‘ä»¬å°†ä»»åŠ¡å°è£…ä¸ºæ¶ˆæ¯å¹¶å°†å…¶å‘é€åˆ°é˜Ÿåˆ—ã€‚æ­£åœ¨è¿è¡Œçš„ worker è¿›ç¨‹ å°†å¼¹å‡ºä»»åŠ¡å¹¶æœ€ç»ˆæ‰§è¡Œ å·¥ä½œã€‚å½“æ‚¨è¿è¡Œè®¸å¤š worker æ—¶ï¼Œä»»åŠ¡å°†åœ¨å®ƒä»¬ä¹‹é—´å…±äº«ã€‚</p><p>åˆ›å»ºä¸¤ä¸ªé¡¹ç›®</p><p>åœ¨ä¹‹å‰å‘é€é¡¹ç›®æ·»åŠ GetMessageæ–¹æ³•</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> RabbitMQ.Client;</span><br><span class="line"><span class="keyword">using</span> RabbitMQ.Client.Events;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºè¿æ¥å·¥å‚ï¼Œé…ç½®RabbitMQæœåŠ¡å™¨ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">var</span> factory = <span class="keyword">new</span> ConnectionFactory();</span><br><span class="line">factory.HostName = <span class="string">&quot;localhost&quot;</span>; <span class="comment">// RabbitMQæœåŠ¡å™¨åœ°å€</span></span><br><span class="line">factory.Port = <span class="number">5672</span>;            <span class="comment">// ç«¯å£å·</span></span><br><span class="line">factory.UserName = <span class="string">&quot;root&quot;</span>;      <span class="comment">// ç”¨æˆ·å</span></span><br><span class="line">factory.Password = <span class="string">&quot;root&quot;</span>;      <span class="comment">// å¯†ç </span></span><br><span class="line">factory.VirtualHost = <span class="string">&quot;vhosst&quot;</span>; <span class="comment">// è™šæ‹Ÿä¸»æœº</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºè¿æ¥å’Œé€šé“ï¼ˆChannelï¼‰</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">var</span> connection = <span class="keyword">await</span> factory.CreateConnectionAsync();</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">var</span> channel = <span class="keyword">await</span> connection.CreateChannelAsync();</span><br><span class="line"></span><br><span class="line"><span class="comment">// å£°æ˜ä¸€ä¸ªæŒä¹…åŒ–é˜Ÿåˆ—ï¼Œåç§°ä¸ºtask_queue</span></span><br><span class="line"><span class="keyword">await</span> channel.QueueDeclareAsync(</span><br><span class="line">    queue: <span class="string">&quot;task_queue&quot;</span>,    <span class="comment">// é˜Ÿåˆ—åç§°</span></span><br><span class="line">    durable: <span class="literal">true</span>,          <span class="comment">// æŒä¹…åŒ–</span></span><br><span class="line">    exclusive: <span class="literal">false</span>,       <span class="comment">// éç‹¬å </span></span><br><span class="line">    autoDelete: <span class="literal">false</span>,      <span class="comment">// ä¸è‡ªåŠ¨åˆ é™¤</span></span><br><span class="line">    arguments: <span class="literal">null</span>         <span class="comment">// å…¶ä»–å‚æ•°</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®æ¯æ¬¡åªåˆ†å‘ä¸€ä¸ªæ¶ˆæ¯ç»™æ¶ˆè´¹è€…ï¼Œä¿è¯å…¬å¹³åˆ†å‘</span></span><br><span class="line"><span class="keyword">await</span> channel.BasicQosAsync(</span><br><span class="line">    prefetchSize: <span class="number">0</span>,        <span class="comment">// ä¸é™åˆ¶æ¶ˆæ¯å¤§å°</span></span><br><span class="line">    prefetchCount: <span class="number">1</span>,       <span class="comment">// æ¯æ¬¡åªåˆ†å‘ä¸€ä¸ªæ¶ˆæ¯</span></span><br><span class="line">    <span class="keyword">global</span>: <span class="literal">false</span>           <span class="comment">// åªå¯¹å½“å‰é€šé“ç”Ÿæ•ˆ</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">Console.WriteLine(<span class="string">&quot;[*] Waiting for message&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºå¼‚æ­¥æ¶ˆè´¹è€…</span></span><br><span class="line"><span class="keyword">var</span> consumer = <span class="keyword">new</span> AsyncEventingBasicConsumer(channel);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨å†Œæ¥æ”¶æ¶ˆæ¯çš„äº‹ä»¶å¤„ç†æ–¹æ³•</span></span><br><span class="line">consumer.ReceivedAsync += <span class="keyword">async</span> (model, ea) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// è·å–æ¶ˆæ¯å†…å®¹</span></span><br><span class="line">    <span class="built_in">byte</span>[] body = ea.Body.ToArray();</span><br><span class="line">    <span class="keyword">var</span> message = Encoding.UTF8.GetString(body);</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;[x] æ¥æ”¶<span class="subst">&#123;message&#125;</span>&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¨¡æ‹Ÿè€—æ—¶æ“ä½œï¼Œæ ¹æ®æ¶ˆæ¯ä¸­.çš„æ•°é‡å†³å®šç­‰å¾…æ—¶é—´</span></span><br><span class="line">    <span class="built_in">int</span> dots = message.Split(<span class="string">&#x27;.&#x27;</span>).Length - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">await</span> Task.Delay(dots * <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">    Console.WriteLine(<span class="string">&quot;[x] Done&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‰‹åŠ¨ç¡®è®¤æ¶ˆæ¯å·²å¤„ç†</span></span><br><span class="line">    <span class="keyword">await</span> channel.BasicAckAsync(deliveryTag: ea.DeliveryTag, multiple: <span class="literal">false</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¼€å§‹æ¶ˆè´¹é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ï¼Œå…³é—­è‡ªåŠ¨ç¡®è®¤</span></span><br><span class="line"><span class="keyword">await</span> channel.BasicConsumeAsync(</span><br><span class="line">    queue: <span class="string">&quot;task_queue&quot;</span>,    <span class="comment">// é˜Ÿåˆ—åç§°</span></span><br><span class="line">    autoAck: <span class="literal">false</span>,         <span class="comment">// å…³é—­è‡ªåŠ¨ç¡®è®¤</span></span><br><span class="line">    consumer: consumer      <span class="comment">// æ¶ˆè´¹è€…å¯¹è±¡</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">Console.WriteLine(<span class="string">&quot; Press [enter] to exit.&quot;</span>);</span><br><span class="line">Console.ReadLine();</span><br></pre></td></tr></table></figure><h2 id="å‘å¸ƒ-è®¢é˜…"><a href="#å‘å¸ƒ-è®¢é˜…" class="headerlink" title="å‘å¸ƒ&#x2F;è®¢é˜…"></a>å‘å¸ƒ&#x2F;è®¢é˜…</h2><p><img src="/img%5CDDD%5C20.png"></p><p>åœ¨è®¢é˜…æ¨¡å‹ä¸­ï¼Œå¤šäº†ä¸€ä¸ªExchangeè§’è‰²ï¼Œè€Œä¸”è¿‡ç¨‹ç•¥æœ‰å˜åŒ–ï¼š<br>Exchange:äº¤æ¢æœºï¼ˆXï¼‰ã€‚ä¸€æ–¹é¢ï¼Œæ¥æ”¶ç”Ÿäº§è€…å‘é€çš„æ¶ˆæ¯ã€‚å¦ä¸€æ–¹é¢ï¼ŒçŸ¥é“å¦‚ä½•å¤„ç†æ¶ˆæ¯ï¼Œä¾‹å¦‚é€’äº¤ç»™æŸä¸ªç‰¹åˆ«é˜Ÿåˆ—ã€é€’äº¤ç»™æ‰€æœ‰é˜Ÿåˆ—ã€æˆ–æ˜¯å°†æ¶ˆæ¯ä¸¢å¼ƒã€‚å¦‚ä½•æ“ä½œï¼Œå–å†³äºExchangeçš„ç±»å‹ã€‚Exchangeæœ‰å¸¸è§çš„ä»¥ä¸‹3ç§ç±»å‹ï¼š<br>Fanout:å¹¿æ’­ï¼Œå°†æ¶ˆæ¯äº¤ç»™æ‰€æœ‰ç»‘å®šåˆ°äº¤æ¢æœºçš„é˜Ÿåˆ—<br>Direct:å®šå‘ï¼ŒæŠŠæ¶ˆæ¯äº¤ç»™ç¬¦åˆæŒ‡å®šroutingKeyçš„é˜Ÿåˆ—<br>Topic:é€šé…ç¬¦ï¼ŒæŠŠæ¶ˆæ¯äº¤ç»™ç¬¦åˆrouting patternï¼ˆè·¯ç”±æ¨¡å¼ï¼‰çš„é˜Ÿåˆ—</p><p>Exchangeï¼ˆäº¤æ¢æœºï¼‰åªè´Ÿè´£è½¬å‘æ¶ˆæ¯ï¼Œä¸å…·å¤‡å­˜å‚¨æ¶ˆæ¯çš„èƒ½åŠ›ï¼Œå› æ­¤å¦‚æœæ²¡æœ‰ä»»ä½•é˜Ÿåˆ—ä¸Exchangeç»‘å®šï¼Œæˆ–è€…æ²¡æœ‰ç¬¦åˆè·¯ç”±è§„åˆ™çš„é˜Ÿåˆ—ï¼Œé‚£ä¹ˆæ¶ˆæ¯ä¼šä¸¢å¤±ï¼</p><h3 id="ä¸´æ—¶é˜Ÿåˆ—"><a href="#ä¸´æ—¶é˜Ÿåˆ—" class="headerlink" title="ä¸´æ—¶é˜Ÿåˆ—"></a>ä¸´æ—¶é˜Ÿåˆ—</h3><p>æ‚¨å¯èƒ½è¿˜è®°å¾—ï¼Œæˆ‘ä»¬ä¹‹å‰ä½¿ç”¨çš„é˜Ÿåˆ—å…·æœ‰ å…·ä½“åç§°ï¼ˆremember å’Œ ï¼Ÿï¼‰ã€‚èƒ½å¤Ÿå‘½å é˜Ÿåˆ—å¯¹æˆ‘ä»¬æ¥è¯´è‡³å…³é‡è¦ â€”â€” æˆ‘ä»¬éœ€è¦å°† worker æŒ‡å‘ ç›¸åŒçš„é˜Ÿåˆ—ã€‚åœ¨ä»¥ä¸‹æƒ…å†µä¸‹ï¼Œä¸ºé˜Ÿåˆ—å‘½åéå¸¸é‡è¦ å¸Œæœ›åœ¨ç”Ÿæˆè€…å’Œä½¿ç”¨è€…ä¹‹é—´å…±äº«é˜Ÿåˆ—ã€‚hellotask_queue</p><p>ä½†å¯¹äºæˆ‘ä»¬çš„ Logger æ¥è¯´ï¼Œæƒ…å†µå¹¶éå¦‚æ­¤ã€‚æˆ‘ä»¬æƒ³å¬å¬æ‰€æœ‰ æ—¥å¿—æ¶ˆæ¯ï¼Œè€Œä¸ä»…ä»…æ˜¯å…¶ä¸­çš„ä¸€ä¸ªå­é›†ã€‚æˆ‘ä»¬æ˜¯ ä¹Ÿåªå¯¹å½“å‰æµæ·Œçš„æ¶ˆæ¯æ„Ÿå…´è¶£ï¼Œè€Œä¸æ˜¯åœ¨æ—§çš„æ¶ˆæ¯ä¸­ çš„ã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ä¸¤ä»¶äº‹ã€‚</p><p>é¦–å…ˆï¼Œæ¯å½“æˆ‘ä»¬è¿æ¥åˆ° Rabbit æ—¶ï¼Œæˆ‘ä»¬éƒ½éœ€è¦ä¸€ä¸ªæ–°çš„ç©ºé˜Ÿåˆ—ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå…·æœ‰éšæœºåç§°çš„é˜Ÿåˆ—ï¼Œæˆ–è€… æ›´å¥½çš„æ˜¯ - è®©æœåŠ¡å™¨ä¸ºæˆ‘ä»¬é€‰æ‹©ä¸€ä¸ªéšæœºé˜Ÿåˆ—åç§°ã€‚</p><p>å…¶æ¬¡ï¼Œä¸€æ—¦æˆ‘ä»¬æ–­å¼€äº†æ¶ˆè´¹è€…çš„è¿æ¥ï¼Œé˜Ÿåˆ—åº”è¯¥æ˜¯ è‡ªåŠ¨åˆ é™¤ã€‚</p><p>åœ¨ .NET å®¢æˆ·ç«¯ä¸­ï¼Œå½“æˆ‘ä»¬ä¸æä¾›ä»»ä½•å‚æ•°æ—¶ï¼Œæˆ‘ä»¬ä¼šåˆ›å»ºä¸€ä¸ªå…·æœ‰ç”Ÿæˆåç§°çš„éæŒä¹…ã€ç‹¬å ã€è‡ªåŠ¨åˆ é™¤é˜Ÿåˆ—ï¼šQueueDeclareAsync()</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">QueueDeclareOk queueDeclareResult = <span class="keyword">await</span> channel.QueueDeclareAsync();</span><br><span class="line"><span class="built_in">string</span> queueName = queueDeclareResult.QueueName;</span><br></pre></td></tr></table></figure><p>ç°åœ¨æˆ‘ä»¬éœ€è¦ å‘Šè¯‰ Exchange å°†æ¶ˆæ¯å‘é€åˆ°æˆ‘ä»¬çš„é˜Ÿåˆ—ã€‚è¿™ç§å…³ç³» åœ¨ exchange å’Œ queue ä¹‹é—´ç§°ä¸º Bindingã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">await</span> channel.QueueBindAsync(queue: queueName, exchange: <span class="string">&quot;logs&quot;</span>, routingKey: <span class="built_in">string</span>.Empty);</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> RabbitMQ.Client;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºè¿æ¥å·¥å‚å¹¶è®¾ç½®RabbitMQæœåŠ¡å™¨çš„ç›¸å…³å‚æ•°</span></span><br><span class="line"><span class="keyword">var</span> factory = <span class="keyword">new</span> ConnectionFactory();</span><br><span class="line">factory.HostName = <span class="string">&quot;localhost&quot;</span>; <span class="comment">// RabbitMQæœåŠ¡å™¨åœ°å€</span></span><br><span class="line">factory.Port = <span class="number">5672</span>;            <span class="comment">// ç«¯å£å·</span></span><br><span class="line">factory.UserName = <span class="string">&quot;root&quot;</span>;      <span class="comment">// ç”¨æˆ·å</span></span><br><span class="line">factory.Password = <span class="string">&quot;root&quot;</span>;      <span class="comment">// å¯†ç </span></span><br><span class="line">factory.VirtualHost = <span class="string">&quot;vhost&quot;</span>;  <span class="comment">// è™šæ‹Ÿä¸»æœº</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¼‚æ­¥åˆ›å»ºè¿æ¥</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">var</span> connection = <span class="keyword">await</span> factory.CreateConnectionAsync();</span><br><span class="line"><span class="comment">// å¼‚æ­¥åˆ›å»ºä¿¡é“ï¼ˆchannelï¼‰</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">var</span> channel = <span class="keyword">await</span> connection.CreateChannelAsync();</span><br><span class="line"></span><br><span class="line"><span class="comment">// å£°æ˜ä¸€ä¸ªåä¸º&quot;logs&quot;çš„äº¤æ¢æœºï¼Œç±»å‹ä¸ºFanoutï¼ˆå¹¿æ’­æ¨¡å¼ï¼‰</span></span><br><span class="line"><span class="keyword">await</span> channel.ExchangeDeclareAsync(exchange: <span class="string">&quot;logs&quot;</span>, type: ExchangeType.Fanout);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–è¦å‘é€çš„æ¶ˆæ¯å†…å®¹</span></span><br><span class="line"><span class="keyword">var</span> message = GetMessage(args);</span><br><span class="line"><span class="comment">// å°†æ¶ˆæ¯å†…å®¹ç¼–ç ä¸ºå­—èŠ‚æ•°ç»„</span></span><br><span class="line"><span class="keyword">var</span> body = Encoding.UTF8.GetBytes(message);</span><br><span class="line"><span class="comment">// é€šè¿‡äº¤æ¢æœºå‘å¸ƒæ¶ˆæ¯ï¼ŒroutingKeyä¸ºç©ºè¡¨ç¤ºå¹¿æ’­</span></span><br><span class="line"><span class="keyword">await</span> channel.BasicPublishAsync(exchange: <span class="string">&quot;logs&quot;</span>, routingKey: <span class="built_in">string</span>.Empty, body: body);</span><br><span class="line">Console.WriteLine(<span class="string">$&quot;[x] å‘é€<span class="subst">&#123;message&#125;</span>&quot;</span>);</span><br><span class="line"></span><br><span class="line">Console.WriteLine(<span class="string">&quot; Press [enter] to exit.&quot;</span>);</span><br><span class="line">Console.ReadLine();</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–å‘½ä»¤è¡Œå‚æ•°ä½œä¸ºæ¶ˆæ¯å†…å®¹ï¼Œå¦‚æœæ²¡æœ‰å‚æ•°åˆ™å‘é€é»˜è®¤æ¶ˆæ¯</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="built_in">string</span> <span class="title">GetMessage</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> ((args.Length &gt; <span class="number">0</span>) ? <span class="built_in">string</span>.Join(<span class="string">&quot; &quot;</span>, args) : <span class="string">&quot;info:Hello World&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨å»ºç«‹è¿æ¥åï¼Œæˆ‘ä»¬å£°æ˜äº† äº¤æ¢ã€‚æ­¤æ­¥éª¤æ˜¯å¿…éœ€çš„ï¼Œå› ä¸ºå‘å¸ƒåˆ°ä¸å­˜åœ¨çš„ ç¦æ­¢äº¤æ¢ã€‚</p><p>å¦‚æœè¿˜æ²¡æœ‰é˜Ÿåˆ—ç»‘å®šåˆ° Exchangeï¼Œåˆ™æ¶ˆæ¯å°†ä¸¢å¤±ã€‚ ä½†è¿™å¯¹æˆ‘ä»¬æ¥è¯´æ²¡å…³ç³»;å¦‚æœè¿˜æ²¡æœ‰æ¶ˆè´¹è€…åœ¨ç›‘å¬ï¼Œæˆ‘ä»¬å¯ä»¥å®‰å…¨åœ°ä¸¢å¼ƒè¯¥æ¶ˆæ¯ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> RabbitMQ.Client;</span><br><span class="line"><span class="keyword">using</span> RabbitMQ.Client.Events;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºè¿æ¥å·¥å‚ï¼Œè®¾ç½®RabbitMQæœåŠ¡å™¨çš„ç›¸å…³å‚æ•°</span></span><br><span class="line"><span class="keyword">var</span> factory = <span class="keyword">new</span> ConnectionFactory();</span><br><span class="line">factory.HostName = <span class="string">&quot;localhost&quot;</span>; <span class="comment">// RabbitMQæœåŠ¡å™¨åœ°å€</span></span><br><span class="line">factory.Port = <span class="number">5672</span>;            <span class="comment">// ç«¯å£å·</span></span><br><span class="line">factory.UserName = <span class="string">&quot;root&quot;</span>;      <span class="comment">// ç”¨æˆ·å</span></span><br><span class="line">factory.Password = <span class="string">&quot;root&quot;</span>;      <span class="comment">// å¯†ç </span></span><br><span class="line">factory.VirtualHost = <span class="string">&quot;vhost&quot;</span>;  <span class="comment">// è™šæ‹Ÿä¸»æœº</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºä¸RabbitMQçš„è¿æ¥</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">var</span> connection = <span class="keyword">await</span> factory.CreateConnectionAsync();</span><br><span class="line"><span class="comment">// åˆ›å»ºé€šé“ï¼Œç”¨äºä¸RabbitMQè¿›è¡Œé€šä¿¡</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">var</span> channel = <span class="keyword">await</span> connection.CreateChannelAsync();</span><br><span class="line"></span><br><span class="line"><span class="comment">// å£°æ˜ä¸€ä¸ªåä¸º&quot;logs&quot;çš„äº¤æ¢æœºï¼Œç±»å‹ä¸ºfanoutï¼ˆå¹¿æ’­æ¨¡å¼ï¼‰</span></span><br><span class="line"><span class="keyword">await</span> channel.ExchangeDeclareAsync(exchange: <span class="string">&quot;logs&quot;</span>, type: ExchangeType.Fanout);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªä¸´æ—¶é˜Ÿåˆ—ï¼Œé˜Ÿåˆ—åç§°ç”±RabbitMQè‡ªåŠ¨ç”Ÿæˆ</span></span><br><span class="line">QueueDeclareOk queueDeclareResult = <span class="keyword">await</span> channel.QueueDeclareAsync();</span><br><span class="line"><span class="built_in">string</span> queueName = queueDeclareResult.QueueName;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°†é˜Ÿåˆ—ç»‘å®šåˆ°&quot;logs&quot;äº¤æ¢æœºï¼Œä¸æŒ‡å®šè·¯ç”±é”®ï¼ˆfanoutç±»å‹ä¼šå¿½ç•¥è·¯ç”±é”®ï¼‰</span></span><br><span class="line"><span class="keyword">await</span> channel.QueueBindAsync(queue: queueName, exchange: <span class="string">&quot;logs&quot;</span>, routingKey: <span class="built_in">string</span>.Empty);</span><br><span class="line"></span><br><span class="line">Console.WriteLine(<span class="string">&quot;[*] Waiting for logs.&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªå¼‚æ­¥äº‹ä»¶æ¶ˆè´¹è€…ï¼Œç”¨äºæ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line"><span class="keyword">var</span> consumer = <span class="keyword">new</span> AsyncEventingBasicConsumer(channel);</span><br><span class="line"><span class="comment">// æ³¨å†Œæ¥æ”¶æ¶ˆæ¯çš„äº‹ä»¶å¤„ç†æ–¹æ³•</span></span><br><span class="line">consumer.ReceivedAsync += (model, ea) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// è·å–æ¶ˆæ¯ä½“å¹¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="built_in">byte</span>[] body = ea.Body.ToArray();</span><br><span class="line">    <span class="keyword">var</span> message = Encoding.UTF8.GetString(body);</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot; [X] <span class="subst">&#123;message&#125;</span>&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> Task.CompletedTask;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¼€å§‹æ¶ˆè´¹é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ï¼ŒautoAck=trueè¡¨ç¤ºè‡ªåŠ¨ç¡®è®¤æ¶ˆæ¯</span></span><br><span class="line"><span class="keyword">await</span> channel.BasicConsumeAsync(queueName, autoAck: <span class="literal">true</span>, consumer: consumer);</span><br><span class="line"></span><br><span class="line">Console.WriteLine(<span class="string">&quot; Press [enter] to exit.&quot;</span>);</span><br><span class="line">Console.ReadLine();</span><br></pre></td></tr></table></figure><h2 id="è·¯ç”±"><a href="#è·¯ç”±" class="headerlink" title="è·¯ç”±"></a>è·¯ç”±</h2><p><img src="/img%5CDDD%5C21.png"></p><p>é˜Ÿåˆ—ä¸äº¤æ¢æœºçš„ç»‘å®šï¼Œä¸èƒ½æ˜¯ä»»æ„ç»‘å®šï¼Œè€Œæ˜¯è¦æŒ‡å®šä¸€ä¸ªRoutingKey<br>æ¶ˆæ¯çš„å‘é€æ–¹åœ¨å‘Exchangeå‘é€æ¶ˆæ¯æ—¶ï¼Œä¹Ÿå¿…é¡»æŒ‡å®šæ¶ˆæ¯çš„RoutingKey<br>Exchangeä¸å†æŠŠæ¶ˆæ¯äº¤ç»™æ¯ä¸€ä¸ªç»‘å®šçš„é˜Ÿåˆ—ï¼Œè€Œæ˜¯æ ¹æ®æ¶ˆæ¯çš„RoutingKeyè¿›è¡Œåˆ¤æ–­ï¼Œåªæœ‰é˜Ÿåˆ—çš„RoutingKeyä¸æ¶ˆæ¯çš„RoutingKeyå®Œå…¨ä¸€è‡´ï¼Œæ‰ä¼šæ¥æ”¶æ¶ˆæ¯</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> RabbitMQ.Client;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºè¿æ¥å·¥å‚å¹¶è®¾ç½®RabbitMQæœåŠ¡å™¨çš„ç›¸å…³å‚æ•°</span></span><br><span class="line"><span class="keyword">var</span> factory = <span class="keyword">new</span> ConnectionFactory();</span><br><span class="line">factory.HostName = <span class="string">&quot;localhost&quot;</span>; <span class="comment">// RabbitMQæœåŠ¡å™¨åœ°å€</span></span><br><span class="line">factory.Port = <span class="number">5672</span>;            <span class="comment">// ç«¯å£å·</span></span><br><span class="line">factory.UserName = <span class="string">&quot;root&quot;</span>;      <span class="comment">// ç”¨æˆ·å</span></span><br><span class="line">factory.Password = <span class="string">&quot;root&quot;</span>;      <span class="comment">// å¯†ç </span></span><br><span class="line">factory.VirtualHost = <span class="string">&quot;vhost&quot;</span>;  <span class="comment">// è™šæ‹Ÿä¸»æœº</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¼‚æ­¥åˆ›å»ºè¿æ¥</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">var</span> connection = <span class="keyword">await</span> factory.CreateConnectionAsync();</span><br><span class="line"><span class="comment">// å¼‚æ­¥åˆ›å»ºé€šé“</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">var</span> channel = <span class="keyword">await</span> connection.CreateChannelAsync();</span><br><span class="line"></span><br><span class="line"><span class="comment">// å£°æ˜ä¸€ä¸ªåä¸º&quot;direct_logs&quot;çš„ç›´è¿äº¤æ¢æœº</span></span><br><span class="line"><span class="keyword">await</span> channel.ExchangeDeclareAsync(exchange: <span class="string">&quot;direct_logs&quot;</span>, type: ExchangeType.Direct);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–æ—¥å¿—çº§åˆ«ï¼ˆå¦‚infoã€warningã€errorï¼‰ï¼Œé»˜è®¤ä¸ºinfo</span></span><br><span class="line"><span class="keyword">var</span> severity = (args.Length &gt; <span class="number">0</span>) ? args[<span class="number">0</span>] : <span class="string">&quot;info&quot;</span>;</span><br><span class="line"><span class="comment">// è·å–è¦å‘é€çš„æ¶ˆæ¯å†…å®¹ï¼Œé»˜è®¤ä¸º&quot;Hello World&quot;</span></span><br><span class="line"><span class="keyword">var</span> message = (args.Length &gt; <span class="number">1</span>) ? <span class="built_in">string</span>.Join(<span class="string">&quot; &quot;</span>, args.Skip(<span class="number">1</span>).ToArray()) : <span class="string">&quot;Hello World&quot;</span>;</span><br><span class="line"><span class="comment">// å°†æ¶ˆæ¯å†…å®¹ç¼–ç ä¸ºå­—èŠ‚æ•°ç»„</span></span><br><span class="line"><span class="keyword">var</span> body = Encoding.UTF8.GetBytes(message);</span><br><span class="line"><span class="comment">// å‘é€æ¶ˆæ¯åˆ°æŒ‡å®šçš„äº¤æ¢æœºå’Œè·¯ç”±é”®ï¼ˆå³æ—¥å¿—çº§åˆ«ï¼‰</span></span><br><span class="line"><span class="keyword">await</span> channel.BasicPublishAsync(exchange: <span class="string">&quot;direct_logs&quot;</span>, routingKey: severity, body: body);</span><br><span class="line">Console.WriteLine(<span class="string">$&quot; [x] å‘é€&#x27;<span class="subst">&#123;severity&#125;</span>:<span class="subst">&#123;message&#125;</span>&#x27;&quot;</span>);</span><br><span class="line"></span><br><span class="line">Console.WriteLine(<span class="string">&quot; Press [enter] to exit.&quot;</span>);</span><br><span class="line">Console.ReadLine();</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> RabbitMQ.Client;</span><br><span class="line"><span class="keyword">using</span> RabbitMQ.Client.Events;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ£€æŸ¥å‘½ä»¤è¡Œå‚æ•°ï¼Œè‡³å°‘éœ€è¦ä¸€ä¸ªå‚æ•°ï¼ˆinfoã€warning æˆ– errorï¼‰</span></span><br><span class="line"><span class="keyword">if</span> (args.Length &lt; <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">    Console.Error.WriteLine(<span class="string">&quot;Usage:&#123;0&#125; [info] [warning] [error]&quot;</span>,</span><br><span class="line">        Environment.GetCommandLineArgs()[<span class="number">0</span>]);</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;Press [enter] to exit.&quot;</span>);</span><br><span class="line">    Console.ReadLine();</span><br><span class="line">    Environment.ExitCode = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºè¿æ¥å·¥å‚ï¼Œè®¾ç½® RabbitMQ æœåŠ¡å™¨çš„è¿æ¥ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">var</span> factory = <span class="keyword">new</span> ConnectionFactory();</span><br><span class="line">factory.HostName = <span class="string">&quot;localhost&quot;</span>;</span><br><span class="line">factory.Port = <span class="number">5672</span>;</span><br><span class="line">factory.UserName = <span class="string">&quot;root&quot;</span>;</span><br><span class="line">factory.Password = <span class="string">&quot;root&quot;</span>;</span><br><span class="line">factory.VirtualHost = <span class="string">&quot;vhost&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å»ºç«‹ä¸ RabbitMQ çš„è¿æ¥å’Œé€šé“ï¼ˆchannelï¼‰</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">var</span> connection = <span class="keyword">await</span> factory.CreateConnectionAsync();</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">var</span> channel = <span class="keyword">await</span> connection.CreateChannelAsync();</span><br><span class="line"></span><br><span class="line"><span class="comment">// å£°æ˜ä¸€ä¸ª direct ç±»å‹çš„äº¤æ¢æœºï¼Œåç§°ä¸º direct_logs</span></span><br><span class="line"><span class="keyword">await</span> channel.ExchangeDeclareAsync(exchange: <span class="string">&quot;direct_logs&quot;</span>, type: ExchangeType.Direct);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å£°æ˜ä¸€ä¸ªä¸´æ—¶é˜Ÿåˆ—ï¼Œé˜Ÿåˆ—åç§°ç”± RabbitMQ è‡ªåŠ¨ç”Ÿæˆ</span></span><br><span class="line"><span class="keyword">var</span> queueDeclareResult = <span class="keyword">await</span> channel.QueueDeclareAsync();</span><br><span class="line"><span class="built_in">string</span> queueName = queueDeclareResult.QueueName;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°†é˜Ÿåˆ—ç»‘å®šåˆ°äº¤æ¢æœºä¸Šï¼Œä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°ä½œä¸ºè·¯ç”±é”®</span></span><br><span class="line"><span class="keyword">foreach</span> (<span class="built_in">string</span>? severity <span class="keyword">in</span> args)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">await</span> channel.QueueBindAsync(queue: queueName, exchange: <span class="string">&quot;direct_logs&quot;</span>, routingKey: severity);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Console.WriteLine(<span class="string">&quot; [*] Waitiy for messages.&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºå¼‚æ­¥æ¶ˆè´¹è€…ï¼Œæ¥æ”¶æ¶ˆæ¯æ—¶è§¦å‘äº‹ä»¶</span></span><br><span class="line"><span class="keyword">var</span> consumer = <span class="keyword">new</span> AsyncEventingBasicConsumer(channel);</span><br><span class="line">consumer.ReceivedAsync += (model, ea) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// è·å–æ¶ˆæ¯ä½“å¹¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="keyword">var</span> body = ea.Body.ToArray();</span><br><span class="line">    <span class="keyword">var</span> message = Encoding.UTF8.GetString(body);</span><br><span class="line">    <span class="keyword">var</span> routingKey = ea.RoutingKey;</span><br><span class="line">    <span class="comment">// æ‰“å°æ”¶åˆ°çš„æ¶ˆæ¯å’Œè·¯ç”±é”®</span></span><br><span class="line">    Console.WriteLine(<span class="string">$&quot; [x] Received &#x27;<span class="subst">&#123;routingKey&#125;</span>:<span class="subst">&#123;message&#125;</span>&#x27;&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> Task.CompletedTask;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¼€å§‹æ¶ˆè´¹é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ï¼Œè‡ªåŠ¨ç¡®è®¤æ¶ˆæ¯</span></span><br><span class="line"><span class="keyword">await</span> channel.BasicConsumeAsync(queueName, autoAck: <span class="literal">true</span>, consumer: consumer);</span><br><span class="line"></span><br><span class="line">Console.WriteLine(<span class="string">&quot; Press [enter] to exit.&quot;</span>);</span><br><span class="line">Console.ReadLine();</span><br></pre></td></tr></table></figure><p>å¦‚æœæ‚¨åªæƒ³ä¿å­˜ â€˜warningâ€™ å’Œ â€˜errorâ€™ ï¼ˆè€Œä¸æ˜¯ â€˜infoâ€™ï¼‰ æ—¥å¿— messages æ·»åŠ åˆ°æ–‡ä»¶ä¸­ï¼Œåªéœ€æ‰“å¼€æ§åˆ¶å°å¹¶é”®å…¥ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dotnet run info warning error</span><br></pre></td></tr></table></figure><h1 id="NETä¸­ç®€åŒ–DDDé›†æˆäº‹ä»¶çš„æ¡†æ¶"><a href="#NETä¸­ç®€åŒ–DDDé›†æˆäº‹ä»¶çš„æ¡†æ¶" class="headerlink" title=".NETä¸­ç®€åŒ–DDDé›†æˆäº‹ä»¶çš„æ¡†æ¶"></a>.NETä¸­ç®€åŒ–DDDé›†æˆäº‹ä»¶çš„æ¡†æ¶</h1><p>ä½¿ç”¨Zack.EventBusï¼Œå¹¶ç®€åŒ–äº†ä»¥åè¿ç§»åˆ°å…¶ä»–MQæœåŠ¡å™¨çš„å·¥ä½œé‡ã€‚</p><ol><li><p>åˆ›å»ºä¸¤ä¸ªASP.NET Core Web APIé¡¹ç›®ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯å‘å¸ƒé›†æˆäº‹ä»¶çš„é¡¹ç›®å’Œæ¶ˆè´¹é›†æˆäº‹ä»¶çš„é¡¹ç›®ï¼Œç„¶åæˆ‘ä»¬ä¸ºè¿™ä¸¤ä¸ªé¡¹ç›®éƒ½å®‰è£…NuGeåŒ…ï¼šZack.EventBus.</p></li><li><p>æˆ‘ä»¬åœ¨é…ç½®ç³»ç»Ÿä¸‹åˆ›å»ºä¸€ä¸ªåå­—ä¸ºEventBusçš„èŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹ä¸‹åŒ…å«HostNameã€ExchangNameä¸¤ä¸ªå±æ€§ï¼Œå®ƒä»¬åˆ†åˆ«ä»£è¡¨RabbitMQæœåŠ¡å™¨çš„åœ°å€å’Œäº¤æ¢æœºçš„åå­—ã€‚</p></li></ol><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;Logging&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;LogLevel&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;Default&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Information&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;Microsoft.AspNetCore&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Warning&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;AllowedHosts&quot;</span><span class="punctuation">:</span> <span class="string">&quot;*&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;EventBus&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;HostName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;localhost&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ExchangName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;EventBusDemo1&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><ol start="3"><li>åœ¨ä¸¤ä¸ªé¡¹ç›®ä¸­çš„Prgram.csæ–‡ä»¶ä¸­çš„builder.Build()ä¸Šé¢å¢åŠ å¯¹IntegrationEventRabbitMQOptionsè¿›è¡Œé…ç½®çš„ä»£ç ä»¥åŠå¯¹AddEventBusçš„è°ƒç”¨ï¼Œç„¶åè¿˜è¦åœ¨builder.Build()ä¸‹é¢è°ƒç”¨UseEventBus()ã€‚</li></ol><p>å‘é€è€…</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä»é…ç½®æ–‡ä»¶ä¸­è·å–åä¸º&quot;EventBus&quot;çš„é…ç½®èŠ‚</span></span><br><span class="line"><span class="keyword">var</span> eventBusSec = builder.Configuration.GetSection(<span class="string">&quot;EventBus&quot;</span>);</span><br><span class="line"><span class="comment">// å°†&quot;EventBus&quot;é…ç½®èŠ‚ç»‘å®šåˆ°IntegrationEventRabbitMQOptionså¯¹è±¡ï¼Œç”¨äºåç»­ä¾èµ–æ³¨å…¥</span></span><br><span class="line">builder.Services.Configure&lt;IntegrationEventRabbitMQOptions&gt;(eventBusSec);</span><br><span class="line"><span class="comment">// æ³¨å†Œäº‹ä»¶æ€»çº¿æœåŠ¡ï¼ŒæŒ‡å®šé˜Ÿåˆ—åç§°ä¸º&quot;EventBusDemo1_Q1&quot;ï¼Œå¹¶æ‰«æå½“å‰ç¨‹åºé›†ä¸­çš„äº‹ä»¶å¤„ç†å™¨</span></span><br><span class="line">builder.Services.AddEventBus(<span class="string">&quot;EventBusDemo1_Q1&quot;</span>, Assembly.GetExecutingAssembly());</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"><span class="comment">// å¯ç”¨äº‹ä»¶æ€»çº¿ä¸­é—´ä»¶ï¼Œè‡ªåŠ¨è®¢é˜…å’Œå¤„ç†é›†æˆäº‹ä»¶</span></span><br><span class="line">app.UseEventBus();</span><br></pre></td></tr></table></figure><p>æ¥æ”¶è€…</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> eventBusSec = builder.Configuration.GetSection(<span class="string">&quot;EventBus&quot;</span>);</span><br><span class="line">builder.Services.Configure&lt;IntegrationEventRabbitMQOptions&gt;(eventBusSec);</span><br><span class="line">builder.Services.AddEventBus(<span class="string">&quot;EventBusDemo1_Q2&quot;</span>,Assembly.GetExecutingAssembly());</span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line">app.UseEventBus();</span><br></pre></td></tr></table></figure><p>è¿™ä¸¤ä¸ªé¡¹ç›®ä»£ç å‡ ä¹ä¸€æ ·ï¼Œåªæœ‰è°ƒç”¨çš„AddEventBusæ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°queueNameçš„å€¼ä¸ä¸€æ ·ï¼Œå› ä¸ºè¿™ä¸ªå‚æ•°ç”¨æ¥è®¾å®šç¨‹åºç»‘å®šçš„é˜Ÿåˆ—çš„åå­—ï¼Œä¸€èˆ¬æ¯ä¸ªå¾®æœåŠ¡é¡¹ç›®çš„queueNameå‚æ•°å€¼éƒ½ä¸åŒï¼Œä¸€è¾¹æ¯ä¸ªç¨‹åºéƒ½èƒ½æ”¶åˆ°æ¶ˆæ¯ã€‚å¯¹äºåŒä¸€ä¸ªå¾®æœåŠ¡çš„å¤šä¸ªéƒ¨ç½²çš„é›†ç¾¤å®ä¾‹ï¼Œæˆ‘ä»¬ä¸€èˆ¬è®¾ç½®å®ƒä»¬çš„queueNameå‚æ•°å€¼ç›¸åŒï¼Œè¿™æ ·å¯¹äºåŒä¸€ä¸ªæ¶ˆæ¯ï¼ŒåŒä¸€ä¸ªå¾®æœåŠ¡é¡¹ç›®åªæœ‰ä¸€ä¸ªé›†ç¾¤å®ä¾‹æ”¶åˆ°è¯¥æ¶ˆæ¯ï¼Œè¿™ç¬¦åˆå¤§éƒ¨åˆ†é¡¹ç›®çš„éœ€æ±‚ã€‚å¦‚æœéœ€è¦åŒä¸€ä¸ªå¾®æœåŠ¡é¡¹ç›®çš„æ¯ä¸ªé›†ç¾¤å®ä¾‹éƒ½æ”¶åˆ°æ¶ˆæ¯ï¼Œåˆ™éœ€è¦æŠŠæ¯ä¸ªé›†ç¾¤å®ä¾‹çš„queueNameå‚æ•°å€¼è®¾ç½®ä¸ºä¸åŒçš„å€¼ï¼Œæ¯”å¦‚åœ¨åŸæœ‰çš„queueNameåé¢å†é™„åŠ æœºå™¨åã€IPåœ°å€ç­‰é›†ç¾¤å†…çš„å”¯ä¸€æ ‡è¯†ä¿¡æ¯ã€‚</p><p>AddEventBusæ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°ä¸ºå«æœ‰ç›‘å¬é›†æˆäº‹ä»¶çš„å¤„ç†è€…ä»£ç çš„ç¨‹åºé›†ã€‚</p><ol start="4"><li>æˆ‘ä»¬åœ¨éœ€è¦å‘å¸ƒé¢†åŸŸäº‹ä»¶çš„ç±»ä¸­æ³¨å…¥IEventBusæœåŠ¡ï¼Œç„¶åè°ƒç”¨IEventBusçš„Publishæ–¹æ³•å‘å¸ƒæ¶ˆæ¯ã€‚</li></ol><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">DemoController</span> : <span class="title">ControllerBase</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// äº‹ä»¶æ€»çº¿æ¥å£ï¼Œç”¨äºå‘å¸ƒå’Œè®¢é˜…äº‹ä»¶</span></span><br><span class="line">    <span class="keyword">private</span> IEventBus eventBus;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é€šè¿‡ä¾èµ–æ³¨å…¥è·å–äº‹ä»¶æ€»çº¿å®ä¾‹</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DemoController</span>(<span class="params">IEventBus eventBus</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.eventBus = eventBus;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é€šè¿‡ HTTP POST è¯·æ±‚è§¦å‘è¯¥æ–¹æ³•ï¼Œå‘å¸ƒä¸€ä¸ªåä¸º &quot;UserAdded&quot; çš„äº‹ä»¶</span></span><br><span class="line">    [<span class="meta">HttpPost</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">Publish</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å‘å¸ƒäº‹ä»¶ï¼Œäº‹ä»¶åä¸º &quot;UserAdded&quot;ï¼Œæºå¸¦ç”¨æˆ·ä¿¡æ¯ï¼ˆç”¨æˆ·åå’Œå¹´é¾„ï¼‰</span></span><br><span class="line">        eventBus.Publish(<span class="string">&quot;UserAdded&quot;</span>, <span class="keyword">new</span> &#123; UserName = <span class="string">&quot;YOUXIANYU&quot;</span>, Age = <span class="number">19</span> &#125;);</span><br><span class="line">        <span class="comment">// è¿”å›æ“ä½œç»“æœ</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ok&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="5"><li>æˆ‘ä»¬åˆ›é€ ä¸€ä¸ªå®ç°äº†IIntegrationEventHandleræ¥å£çš„ç±»ï¼Œè¿™ä¸ªç±»ç”¨æ¥å¤„ç†æ”¶åˆ°çš„äº‹ä»¶ã€‚</li></ol><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// äº‹ä»¶åç§°ä¸º &quot;UserAdded&quot;ï¼Œç”¨äºæ ‡è¯†è¯¥äº‹ä»¶å¤„ç†å™¨å¤„ç†çš„æ˜¯ç”¨æˆ·æ–°å¢äº‹ä»¶</span></span><br><span class="line">[<span class="meta">EventName(<span class="string">&quot;UserAdded&quot;</span>)</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UserAddesEventHandler</span> : <span class="title">IIntegrationEventHandler</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// æ—¥å¿—è®°å½•å™¨ï¼Œç”¨äºè¾“å‡ºæ—¥å¿—ä¿¡æ¯</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> ILogger&lt;UserAddesEventHandler&gt; logger;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•°ï¼Œé€šè¿‡ä¾èµ–æ³¨å…¥è·å–æ—¥å¿—è®°å½•å™¨</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UserAddesEventHandler</span>(<span class="params">ILogger&lt;UserAddesEventHandler&gt; logger</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.logger = logger;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¤„ç†äº‹ä»¶çš„æ–¹æ³•</span></span><br><span class="line">    <span class="comment">// eventName: äº‹ä»¶åç§°</span></span><br><span class="line">    <span class="comment">// eventData: äº‹ä»¶æ•°æ®ï¼ˆè¿™é‡Œä¸€èˆ¬æ˜¯æ–°ç”¨æˆ·çš„ä¿¡æ¯ï¼‰</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Task <span class="title">Handle</span>(<span class="params"><span class="built_in">string</span> eventName, <span class="built_in">string</span> eventData</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// è®°å½•ä¸€æ¡æ—¥å¿—ï¼Œè¡¨ç¤ºæ–°å»ºäº†ä¸€ä¸ªç”¨æˆ·ï¼Œå¹¶è¾“å‡ºç”¨æˆ·ç›¸å…³æ•°æ®</span></span><br><span class="line">        logger.LogInformation(<span class="string">&quot;æ–°å»ºäº†ç”¨æˆ·ï¼š&quot;</span> + eventData);</span><br><span class="line">        <span class="keyword">return</span> Task.CompletedTask;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> EF Core </tag>
            
            <tag> ASP.NET Core </tag>
            
            <tag> Entity Framework Core </tag>
            
            <tag> DDD </tag>
            
            <tag> RabbitMQ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•å®‰è£…RabbitMQæœåŠ¡å™¨</title>
      <link href="/2025/05/22/DDD/%E5%A6%82%E4%BD%95%E5%AE%89%E8%A3%85RabbitMQ/"/>
      <url>/2025/05/22/DDD/%E5%A6%82%E4%BD%95%E5%AE%89%E8%A3%85RabbitMQ/</url>
      
        <content type="html"><![CDATA[<h1 id="åœ¨Windowså®‰è£…RabbitMQ"><a href="#åœ¨Windowså®‰è£…RabbitMQ" class="headerlink" title="åœ¨Windowså®‰è£…RabbitMQ"></a>åœ¨Windowså®‰è£…RabbitMQ</h1><h3 id="å®‰è£…RabbitMQéœ€è¦å®‰è£…Erlangç¯å¢ƒ-ç½‘å€ï¼šDownloads-Erlang-OTP"><a href="#å®‰è£…RabbitMQéœ€è¦å®‰è£…Erlangç¯å¢ƒ-ç½‘å€ï¼šDownloads-Erlang-OTP" class="headerlink" title="å®‰è£…RabbitMQéœ€è¦å®‰è£…Erlangç¯å¢ƒ,ç½‘å€ï¼šDownloads - Erlang&#x2F;OTP"></a>å®‰è£…RabbitMQéœ€è¦å®‰è£…Erlangç¯å¢ƒ,ç½‘å€ï¼šDownloads - Erlang&#x2F;OTP</h3><p><img src="/img%5CDDD%5C5.png"></p><p>ä¸‹è½½å¯¹åº”çš„ç‰ˆæœ¬<br>RabbitMQ Erlang Version Requirements â€” RabbitMQ<br><img src="/img%5CDDD%5C6.png"></p><h3 id="é…ç½®Erlangç¯å¢ƒå˜é‡"><a href="#é…ç½®Erlangç¯å¢ƒå˜é‡" class="headerlink" title="é…ç½®Erlangç¯å¢ƒå˜é‡"></a>é…ç½®Erlangç¯å¢ƒå˜é‡</h3><ol><li><p>åœ¨æœç´¢æ¡†é‡Œè¾“å…¥ç¼–è¾‘ç³»ç»Ÿç¯å¢ƒå˜é‡.</p></li><li><p>å˜é‡åä¸€å®šè¦å†™æˆERLANG_HOMEï¼Œå˜é‡å€¼å°±æ˜¯ä½ çš„Erlangçš„å®‰è£…è·¯å¾„</p></li></ol><p><img src="/img%5CDDD%5C7.png"></p><ol start="3"><li><p>è¿˜éœ€è¦åœ¨ç³»ç»Ÿå˜é‡ä¸­é€‰ä¸­Pathè¿›è¡Œç¼–è¾‘ï¼Œæ–°å»ºä¸€ä¸ª%ERLANG_HOME%\bin<br><img src="/img%5CDDD%5C8.png"></p></li><li><p>æ‰“å¼€å‘½ä»¤çª—å£ï¼Œè¾“å…¥erlæˆ–è€…erl -version()éªŒè¯ç¯å¢ƒæ˜¯å¦é…ç½®æˆåŠŸï¼ˆå‡ºç°ä»¥ä¸‹ç‰ˆæœ¬å·å³æˆåŠŸï¼Œæ˜¾ç¤ºä¸æ˜¯å†…éƒ¨å‘½ä»¤åˆ™ç¯å¢ƒå˜é‡é…ç½®å¤±è´¥ï¼‰</p></li></ol><p><img src="/img%5CDDD%5C9.png"></p><h1 id="å®‰è£…RabbitMQ"><a href="#å®‰è£…RabbitMQ" class="headerlink" title="å®‰è£…RabbitMQ"></a>å®‰è£…RabbitMQ</h1><ol><li>RabbitMQå®˜ç½‘ä¸‹è½½å€ï¼šInstalling on Windows â€” RabbitMQ</li></ol><p><img src="/img%5CDDD%5C10.png"></p><ol start="2"><li>é…ç½®RabbitMQç¯å¢ƒå˜é‡</li></ol><p><img src="E:\blog\themes\butterfly\source\img\DDD\11.png"></p><p><img src="/img%5CDDD%5C12.png"></p><ol start="3"><li>è¿›å…¥sbinæ–‡ä»¶ä¸‹ï¼Œæ‰“å¼€å‘½ä»¤çª—å£è¾“å…¥<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rabbitmq-plugins enable rabbitmq_management</span><br></pre></td></tr></table></figure></li></ol><p><img src="/img%5CDDD%5C13.png"></p><ol start="4"><li>ç‚¹å‡»rabbit_server.bat,å¯åŠ¨rabbitMQ</li></ol><p><img src="/img%5CDDD%5C14.png"></p><ol start="5"><li>æœ€åè¾“å…¥<a href="http://localhost:15672/%EF%BC%88%E9%BB%98%E8%AE%A4%E8%B4%A6%E5%8F%B7%EF%BC%9Aguest%EF%BC%8C%E5%AF%86%E7%A0%81%EF%BC%9Aguest%EF%BC%89%E5%B0%B1%E8%83%BD%E8%BF%9B%E5%85%A5RabbitMQ%E7%AE%A1%E7%90%86%E7%95%8C%E9%9D%A2">http://localhost:15672/ï¼ˆé»˜è®¤è´¦å·ï¼šguestï¼Œå¯†ç ï¼šguestï¼‰å°±èƒ½è¿›å…¥RabbitMQç®¡ç†ç•Œé¢</a></li></ol><p><img src="/img%5CDDD%5C15.png"></p><ol start="6"><li>æ·»åŠ ç”¨æˆ·</li></ol><p><img src="/img%5CDDD%5C16.png"></p>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> EF Core </tag>
            
            <tag> ASP.NET Core </tag>
            
            <tag> Entity Framework Core </tag>
            
            <tag> DDD </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>.NET Coreçš„èšåˆï¼ŒMediatRå®ç°é¢†åŸŸäº‹ä»¶</title>
      <link href="/2025/05/20/DDD/%E8%81%9A%E5%90%88%E5%9C%A8NET%E4%B8%AD%E7%9A%84%E5%AE%9E%E7%8E%B0/"/>
      <url>/2025/05/20/DDD/%E8%81%9A%E5%90%88%E5%9C%A8NET%E4%B8%AD%E7%9A%84%E5%AE%9E%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="èšåˆåœ¨-NETä¸­çš„å®ç°"><a href="#èšåˆåœ¨-NETä¸­çš„å®ç°" class="headerlink" title="èšåˆåœ¨.NETä¸­çš„å®ç°"></a>èšåˆåœ¨.NETä¸­çš„å®ç°</h1><p>ä¸Šä¸‹æ–‡å¯ä»¥ä»æ•°æ®åº“ä¸­æŸ¥è¯¢å‡ºæ•°æ®å¹¶ä¸”è·Ÿè¸ªå¯¹è±¡çŠ¶æ€çš„æ”¹å˜ï¼Œç„¶åæŠŠå¯¹è±¡çŠ¶æ€çš„æ”¹å˜ä¿å­˜åˆ°æ•°æ®åº“ä¸­ï¼Œå› æ­¤ä¸Šä¸‹æ–‡å°±æ˜¯ä¸€ä¸ªå¤©ç„¶çš„ä»“å‚¨çš„å®ç°ï¼›ä¸Šä¸‹æ–‡ä¼šè·Ÿè¸ªå¤šä¸ªå¯¹è±¡çŠ¶æ€çš„æ”¹å˜ï¼Œè®©ååœ¨SaveChangesæ–¹æ³•ä¸­æŠŠæ‰€æœ‰çš„æ”¹å˜ä¸€æ¬¡æ€§æäº¤åˆ°æ•°æ®åº“ä¸­ï¼Œè¿™æ˜¯ä¸ªâ€œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥â€çš„æ“ä½œï¼Œå› æ­¤ä¸Šä¸‹æ–‡ä¹Ÿæ˜¯ä¸€ä¸ªå¤©ç„¶çš„å·¥ä½œå•å…ƒçš„å®ç°ã€‚</p><p>æœ‰ä¸€äº›å¼€å‘äººå‘˜ä¼šå†ç¼–å†™ä»“å‚¨å’Œå·¥ä½œå•å…ƒçš„æ¥å£ä»¥å°è£…ä¸Šä¸‹æ–‡çš„æ“ä½œï¼Œè¿™æ ·å¯ä»¥æŠŠEF Coreçš„æ“ä½œå°è£…èµ·æ¥ï¼Œä¸ä»…å¯ä»¥è®©ä»£ç ä¸ä¾èµ–äºEF Coreï¼Œè€Œä¸”ä»Šåå¦‚æœæˆ‘ä»¬éœ€è¦æŠŠEF Coreæ›¿æ¢ä¸ºå…¶ä»–æŒä¹…åŒ–æœºåˆ¶ï¼Œä»£ç åˆ‡æ¢èµ·æ¥ä¹Ÿä¼šæ›´å®¹æ˜“ã€‚ä½†æ˜¯æœ¬ä¹¦å°†ç›´æ¥ç”¨ä¸Šä¸‹æ–‡ä½œä¸ºä»“å‚¨ï¼Œè€Œä¸æ˜¯å®šä¹‰ä¸€ä¸ªä»“å‚¨çš„æŠ½è±¡å±‚ï¼Œå¾®è½¯ä¹Ÿæ˜¯è¿™æ ·å»ºè®®çš„ã€‚å› ä¸ºEF Coreæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä»“å‚¨å’Œå·¥ä½œå•å…ƒçš„å®ç°æ¡†æ¶ï¼Œå¾ˆéš¾æ‰¾åˆ°å¦ä¸€æ¬¾å¯ä»¥å¾ˆå¥½å®ç°DDDçš„ORMæ¡†æ¶ï¼Œæ— è®ºæŠ½è±¡å±‚æ€ä¹ˆå®šä¹‰ï¼Œå¦‚æœéœ€è¦æŠŠEF Coreæ›¿æ¢ä¸ºå…¶ä»–ORMæ¡†æ¶ï¼Œä»£ç å°±ä¸å¯èƒ½ä¸åšä»»ä½•æ”¹å˜ã€‚æˆ‘ä»¬ç›´æ¥ç”¨ä¸Šä¸‹æ–‡åšä»“å‚¨ï¼Œè¿™æ ·å¯ä»¥æœ€å¤§åŒ–åœ°åˆ©ç”¨EF Coreçš„ç‰¹æ€§ï¼Œä»è€Œæä¾›æ›´é«˜æ€§èƒ½çš„ä»“å‚¨å®ç°ã€‚</p><p>åœ¨EF Coreä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ä¸ºæ¯ä¸ªå®ä½“ç±»éƒ½å£°æ˜å¯¹åº”çš„DbSetç±»å‹çš„å±æ€§ï¼Œå³ä½¿ä¸€ä¸ªå®ä½“ç±»æ²¡æœ‰å£°æ˜å¯¹åº”çš„DbSetç±»å‹çš„å±æ€§ï¼Œåªè¦EF Coreé‡åˆ°å®ä½“ç±»å¯¹è±¡ï¼ŒEF Coreä»ç„¶ä¼šåƒå¯¹å¾…å…¶ä»–å®ä½“ç±»å¯¹è±¡ä¸€æ ·å¯¹å…¶è¿›è¡Œå¤„ç†ã€‚ç”±äºé™¤äº†èšåˆæ ¹å®ä½“ç±»ä¹‹å¤–ï¼Œèšåˆä¸­å…¶ä»–å®ä½“é›·ä¸åº”è¯¥è¢«å¼€å‘äººå‘˜è®¿é—®åˆ°ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨ä¸Šä¸‹æ–‡ä¸­åªä¸ºèšåˆæ ¹å®ä½“ç±»å£°æ˜DbSetç±»å‹çš„å±æ€§ã€‚</p><ol><li>èšåˆå…³ç³»çš„åŸºæœ¬å®ç°<br>èšåˆå…³ç³»é€šè¿‡å¼•ç”¨ç±»å‹æˆå‘˜å˜é‡å®ç°ï¼Œå­å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸä¸ç”±çˆ¶å¯¹è±¡æ§åˆ¶ã€‚ä¾‹å¦‚ï¼š</li></ol><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å­å¯¹è±¡ï¼šå¯ä»¥ç‹¬ç«‹å­˜åœ¨</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Employee</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Employee</span>(<span class="params"><span class="built_in">string</span> name</span>)</span> =&gt; Name = name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// çˆ¶å¯¹è±¡ï¼šé€šè¿‡å¼•ç”¨â€œèšåˆâ€å­å¯¹è±¡</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Department</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> DepartmentName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> Employee _manager; <span class="comment">// éƒ¨é—¨ç»ç†ï¼ˆèšåˆå…³ç³»ï¼‰</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Department</span>(<span class="params"><span class="built_in">string</span> name, Employee manager</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        DepartmentName = name;</span><br><span class="line">        _manager = manager; <span class="comment">// æ³¨å…¥å·²å­˜åœ¨çš„ Employee å¯¹è±¡</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>é›†åˆèšåˆç¤ºä¾‹<br>çˆ¶å¯¹è±¡å¯ä»¥èšåˆå¤šä¸ªå­å¯¹è±¡ï¼Œä¾‹å¦‚ä¸€ä¸ªå›¢é˜ŸåŒ…å«å¤šä¸ªæˆå‘˜ï¼š</li></ol><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Team</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> TeamName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> List&lt;Employee&gt; _members = <span class="keyword">new</span>();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Team</span>(<span class="params"><span class="built_in">string</span> name</span>)</span> =&gt; TeamName = name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ·»åŠ æˆå‘˜ï¼ˆå­å¯¹è±¡ï¼‰</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AddMember</span>(<span class="params">Employee employee</span>)</span> =&gt; _members.Add(employee);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç§»é™¤æˆå‘˜ï¼ˆå­å¯¹è±¡ä¸ä¼šè¢«é”€æ¯ï¼‰</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">RemoveMember</span>(<span class="params">Employee employee</span>)</span> =&gt; _members.Remove(employee);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>ä¸ç»„åˆå…³ç³»çš„å¯¹æ¯”<br>ç»„åˆï¼ˆCompositionï¼‰æ˜¯æ›´å¼ºçš„ â€œæ‹¥æœ‰â€ å…³ç³»ï¼Œå­å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸç”±çˆ¶å¯¹è±¡æ§åˆ¶ã€‚ä¾‹å¦‚ï¼š</li></ol><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Car</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> Engine _engine; <span class="comment">// ç»„åˆå…³ç³»</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Car</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        _engine = <span class="keyword">new</span> Engine(); <span class="comment">// çˆ¶å¯¹è±¡åˆ›å»ºå¹¶ç®¡ç†å­å¯¹è±¡ç”Ÿå‘½å‘¨æœŸ</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// çˆ¶å¯¹è±¡é”€æ¯æ—¶ï¼Œå­å¯¹è±¡ä¹Ÿä¼šè¢«é”€æ¯</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Engine</span> &#123; &#125;</span><br></pre></td></tr></table></figure><ol start="4"><li>èšåˆçš„å®é™…åº”ç”¨åœºæ™¯<br>ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰ï¼šé€šè¿‡æ„é€ å‡½æ•°æ³¨å…¥ä¾èµ–å¯¹è±¡ï¼ˆèšåˆå…³ç³»ï¼‰ã€‚</li></ol><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UserService</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> IUserRepository _repository; <span class="comment">// èšåˆå…³ç³»</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UserService</span>(<span class="params">IUserRepository repository</span>) <span class="comment">// æ³¨å…¥å·²å­˜åœ¨çš„ä»“å‚¨å®ä¾‹</span></span></span><br><span class="line">    &#123;</span><br><span class="line">        _repository = repository;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ•°æ®æ¨¡å‹èšåˆï¼šä¾‹å¦‚è®¢å•èšåˆå¤šä¸ªè®¢å•é¡¹ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Order</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> OrderId &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> List&lt;OrderItem&gt; Items &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; = <span class="keyword">new</span>(); <span class="comment">// èšåˆå¤šä¸ªè®¢å•é¡¹</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">OrderItem</span> &#123; &#125;</span><br></pre></td></tr></table></figure><p>æ€»ç»“<br>èšåˆï¼šé€šè¿‡å¼•ç”¨å…³è”å¯¹è±¡ï¼Œå­å¯¹è±¡å¯ç‹¬ç«‹å­˜åœ¨ï¼Œç”Ÿå‘½å‘¨æœŸä¸ç”±çˆ¶å¯¹è±¡ç®¡ç†ã€‚<br>ç»„åˆï¼šå­å¯¹è±¡ä¸å¯ç‹¬ç«‹å­˜åœ¨ï¼Œçˆ¶å¯¹è±¡è´Ÿè´£åˆ›å»ºå’Œé”€æ¯å­å¯¹è±¡ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªé—®é¢˜éœ€è¦è®¨è®ºï¼Œå¦‚æœä¸€ä¸ªå¾®æœåŠ¡ä¸­æœ‰å¤šä¸ªèšåˆæ ¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯æŠŠæ¯ä¸ªèšåˆæ ¹å®ä½“ç±»æ”¾åˆ°ä¸€ä¸ªå•ç‹¬çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œè¿˜æ˜¯æŠŠæ‰€æœ‰å®ä½“ç±»æ”¾åˆ°åŒä¸€ä¸ªä¸Šä¸‹æ–‡ä¸­ï¼Ÿå‰è€…çš„ä¼˜ç‚¹æ˜¯ä¸Šä¸‹æ–‡çš„è€¦åˆåº¦æ›´ä½ï¼Œèšåˆæ ¹ä¹‹é—´çš„ç•Œé™åˆ’åˆ†æ›´æ¸…æ™°ï¼Œç¼ºç‚¹å°±æ˜¯å¼€å‘èµ·æ¥æ¯”è¾ƒéº»çƒ¦ï¼Œè€Œä¸”å®ç°è·¨èšåˆæŸ¥è¯¢çš„æ—¶å€™ä¹Ÿæ¯”è¾ƒéº»çƒ¦ï¼›åè€…çš„ä¼˜ç‚¹æ˜¯å¼€å‘éš¾åº¦ä½ï¼Œè·¨èšåˆæŸ¥è¯¢ä¹Ÿç®€å•ï¼Œç¼ºç‚¹å°±æ˜¯èšåˆæ ¹åœ¨ä¸Šä¸‹æ–‡é‡Œæœ‰ä¸€ä¸ªå®šç¨‹åº¦çš„è€¦åˆï¼Œæˆ‘ä»¬æ— æ³•å¾ˆå®¹æ˜“åœ°çœ‹åˆ°èšåˆçš„åˆ’åˆ†ã€‚åè€…ï¼Œä¹Ÿå°±æ˜¯æŠŠåŒä¸€ä¸ªå¾®æœåŠ¡ä¸­çš„æ‰€æœ‰å®ä½“ç±»éƒ½æ”¾åˆ°åŒä¸€ä¸ªä¸Šä¸‹æ–‡ä¸­ï¼Œå› ä¸ºè™½ç„¶èšåˆä¹‹é—´çš„å…³ç³»ä¸ç´§å¯†ï¼Œä½†æ˜¯å®ƒä»¬æ¯•ç«Ÿå±äºåŒä¸€ä¸ªå¾®æœåŠ¡ï¼Œå®ƒä»¬ä¹‹é—´çš„å…³ç³»ä»ç„¶æ¯”å®ƒä»¬å’Œå…¶ä»–å¾®æœåŠ¡ä¹‹é—´çš„å…³ç³»æ›´ç´§å¯†ï¼Œè€Œä¸”æˆ‘ä»¬è¿˜ä¼šåœ¨åº”ç”¨æœåŠ¡ä¸­è¿›è¡Œè·¨èšåˆçš„ç»„åˆæ“ä½œï¼Œå¦‚æœå‚ä¸åº”ç”¨æœåŠ¡çš„ç»„åˆæ“ä½œçš„èšåˆéƒ½å±äºåŒä¸€ä¸ªä¸Šä¸‹æ–‡ï¼Œæˆ‘ä»¬å†è¿›è¡Œè”åˆæŸ¥è¯¢çš„æ—¶å€™å¯ä»¥è·å¾—æ›´å¥½çš„æ€§èƒ½ï¼Œå†è¿›è¡Œè·¨èšåˆçš„æ•°æ®ä¿®æ”¹çš„ä¿å­˜çš„æ—¶å€™ï¼Œä¹Ÿèƒ½æ›´å®¹æ˜“åœ°å®ç°å¼ºä¸€è‡´æ€§çš„äº‹åŠ¡ã€‚å½“è®©ï¼Œå¦‚æœç»è¿‡è‰¯å¥½çš„å¾®æœåŠ¡æ‹†åˆ†è®¾è®¡ä¹‹åï¼Œä¸€ä¸ªå¾®æœåŠ¡ä¸­çš„éƒ¨åˆ†èšåˆå’Œå…¶ä»–èšåˆçš„å…³ç³»ä»ç„¶ä¸ç´§å¯†ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠå®ƒä»¬æ”¾åˆ°ä¸åŒçš„ä¸Šä¸‹æ–‡ä¸­ã€‚</p><p>å¦‚æœé€‰æ‹©äº†æŠŠä¸€ä¸ªå¾®æœåŠ¡ä¸­æ‰€æœ‰èšåˆä¸­çš„å®ä½“ç±»éƒ½æ”¾åˆ°åŒä¸€ä¸ªä¸Šä¸‹æ–‡ä¸­ï¼Œä¸ºäº†åŒºåˆ†èšåˆæ ¹å®ä½“ç±»å’Œå…¶ä»–å®ä½“ç±»ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªä¸åŒ…å«ä»»ä½•æˆå‘˜çš„æ ‡è¯†æ¥å£ï¼Œæ¯”å¦‚IAggregateRootï¼Œç„¶åè¦æ±‚æ‰€æœ‰çš„èšåˆæ ¹å®ä½“ç±»éƒ½å®ç°è¿™ä¸ªæ¥å£ã€‚</p><p>ç”±äºèšåˆä¹‹é—´æ˜¯æ¾è€¦åˆå…³ç³»ï¼Œå®ƒä»¬åªé€šè¿‡èšåˆæ ¹çš„Idè¿›è¡Œå…³è”ï¼Œå› æ­¤æ‰€æœ‰è·¨èšåˆçš„æ•°æ®æŸ¥è¯¢éƒ½åº”è¯¥æ˜¯é€šè¿‡é¢†åŸŸæœåŠ¡çš„åè®®æ¥å®Œæˆçš„ï¼Œè€Œä¸åº”è¯¥ç›´æ¥åœ¨æ•°æ®åº“è¡¨ä¹‹é—´è¿›è¡ŒjojnæŸ¥è¯¢ã€‚å½“ç„¶ï¼Œå¯¹äºç»Ÿè®¡ã€æ±‡æ€»ç­‰æŠ¥è¡¨ç±»çš„åº”ç”¨ï¼Œåˆ™ä¸éœ€è¦éµå¾ªèšåˆçš„è§„èŒƒï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰§è¡ŒåŸç”ŸSQLè¯­å¥è¿›è¡Œè·¨è¡¨æŸ¥è¯¢ã€‚</p><h2 id="å®ä½“ç±»ä¸è¦é¢å‘æ•°æ®åº“å»ºæ¨¡"><a href="#å®ä½“ç±»ä¸è¦é¢å‘æ•°æ®åº“å»ºæ¨¡" class="headerlink" title="å®ä½“ç±»ä¸è¦é¢å‘æ•°æ®åº“å»ºæ¨¡"></a>å®ä½“ç±»ä¸è¦é¢å‘æ•°æ®åº“å»ºæ¨¡</h2><ol><li><p>å»ºæ¨¡çš„æ—¶å€™ä¸è¦å…ˆè€ƒè™‘å®ä½“åœ¨æ•°æ®åº“ä¸­å¦‚ä½•ä¿å­˜ã€‚æ¯”å¦‚å®ä½“ç±»å’Œæ•°æ®è¡¨å…·æœ‰ç›´æ¥çš„å¯¹åº”å…³ç³»ï¼Œå®ä½“ç±»ä¸­å±æ€§å’Œæ•°æ®è¡¨ä¸­çš„åˆ—å‡ ä¹å®Œæˆä¸€è‡´ã€‚è¿™æ ·è®¾è®¡å‡ºæ¥çš„ç±»ç§°ä¸ä¸Šâ€œå®ä½“ç±»â€ï¼Œåªèƒ½è¢«æˆä¸ºæ•°æ®å¯¹è±¡ï¼ˆData Objectï¼‰ã€‚æ›´ä¸è¦ç”¨DB Firstï¼ˆåå‘å·¥ç¨‹ï¼‰ã€‚</p></li><li><p>å› è¯¥ä¸è€ƒè™‘æ•°æ®åº“å®ç°çš„æƒ…å†µä¸‹è¿›è¡Œé¢†åŸŸæ¨¡å‹å»ºæ¨¡ï¼Œç„¶åå†ä½¿ç”¨Fluent APIç­‰å¯¹å®ä½“ç±»å’Œæ•°æ®åº“ä¹‹é—´åšé€‚é…ã€‚åœ¨å®ç°çš„æ—¶å€™ï¼Œå¯èƒ½éœ€è¦å¯¹å»ºæ¨¡è¿›è¡Œå¦¥åæ€§ä¿®æ”¹ï¼Œä½†æ˜¯è¿™ä¸åº”è¯¥åœ¨æœ€å¼€å§‹è¢«è€ƒè™‘ã€‚</p></li></ol><h1 id="ç”¨MediatRå®ç°é¢†åŸŸäº‹ä»¶"><a href="#ç”¨MediatRå®ç°é¢†åŸŸäº‹ä»¶" class="headerlink" title="ç”¨MediatRå®ç°é¢†åŸŸäº‹ä»¶"></a>ç”¨MediatRå®ç°é¢†åŸŸäº‹ä»¶</h1><p>ç¬¬ä¸€æ­¥ï¼Œåˆ›å»ºä¸€ä¸ªASP.NET Coreé¡¹ç›®ï¼Œç„¶åé€šè¿‡NuGetå®‰è£…MediatRã€‚<br>ç¬¬äºŒæ­¥ï¼Œåœ¨é¡¹ç›®çš„Program.csä¸­è°ƒç”¨AddMediatRæ–¹æ³•æŠŠä¸MediatRç›¸å…³çš„æœåŠ¡æ³¨å†Œåˆ°ä¾èµ–æ³¨å…¥å®¹å™¨ä¸­ï¼ŒAddMediatRæ–¹æ³•çš„å‚æ•°ä¸­ä¸€èˆ¬æŒ‡å®šäº‹ä»¶å¤„ç†è€…æ‰€åœ¨çš„è‹¥å¹²ä¸ªç¨‹åºé›†ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">builder.Services.AddMediatR(cfg =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    cfg.RegisterServicesFromAssembly(<span class="keyword">typeof</span>(Program).Assembly);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰æ­¥ï¼Œå®šä¹‰ä¸€ä¸ªåœ¨äº‹ä»¶çš„å‘å¸ƒè€…å’Œå¤„ç†è€…ä¹‹é—´è¿›è¡Œæ•°æ®ä¼ é€’çš„ç±»TestEventï¼Œè¿™ä¸ªç±»éœ€è¦å®ç°INotificationæ¥å£ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">record</span> <span class="title">TestEvent</span>(<span class="params"><span class="built_in">string</span> UserName</span>):INotification</span>;</span><br></pre></td></tr></table></figure><p>TestEventä¸­çš„UserNameå±æ€§ä»£è¡¨ç™»å½•ç”¨æˆ·åã€‚äº‹ä»¶ä¸€èˆ¬éƒ½æ˜¯ä»å‘å¸ƒè€…ä¼ é€’åˆ°å¤„ç†è€…çš„ï¼Œå¾ˆå°‘æœ‰åœ¨äº‹ä»¶çš„å¤„ç†è€…å¤„ç›´æ¥åå‘é€šçŸ¥äº‹ä»¶å‘å¸ƒè€…çš„éœ€æ±‚ï¼Œå› æ­¤å®ç°INotificationçš„TestEventç±»çš„å±æ€§ä¸€èˆ¬éƒ½æ˜¯ä¸å¯å˜çš„ï¼Œæˆ‘ä»¬ç”¨recordä¸å‘æ¥å£°æ˜è¿™ä¸ªç±»ã€‚</p><p>ç¬¬å››æ­¥ï¼Œäº‹ä»¶çš„å¤„ç†è€…è¦å®ç°NotificationHandler&lt;TNotification&gt;æ¥å£ï¼Œå…¶ä¸­çš„æ³›å‹å‚æ•°TNotificationä»£è¡¨æ­¤äº‹ä»¶å¤„ç†è€…è¦å¤„ç†çš„æ¶ˆæ¯ç±»å‹ã€‚æ‰€æœ‰TNotificationç±»å‹çš„äº‹ä»¶éƒ½ä¼šè¢«äº‹ä»¶å¤„ç†è€…å¤„ç†ã€‚æˆ‘ä»¬ç¼–å†™ä¸¤ä¸ªäº‹ä»¶å¤„ç†è€…ï¼Œå®ƒä»¬åˆ†åˆ«æŠŠæ”¶åˆ°çš„äº‹ä»¶è¾“å‡ºåˆ°æ§åˆ¶å°å’Œå†™å…¥æ–‡ä»¶ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TestEventHandler1</span> : <span class="title">INotificationHandler</span>&lt;<span class="title">TestEvent</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Task <span class="title">Handle</span>(<span class="params">TestEvent notification, CancellationToken cancellationToken</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;æˆ‘æ”¶åˆ°äº†<span class="subst">&#123;notification.UserName&#125;</span>&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> Task.CompletedTask;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TestEventHandler2</span> : <span class="title">INotificationHandler</span>&lt;<span class="title">TestEvent</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">Handle</span>(<span class="params">TestEvent notification, CancellationToken cancellationToken</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">await</span> File.WriteAllTextAsync(<span class="string">&quot;D:/SqlServer.txt&quot;</span>, <span class="string">$&quot;æ¥äº†<span class="subst">&#123;notification.UserName&#125;</span>&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬äº”æ­¥ï¼Œåœ¨éœ€è¦å‘å¸ƒäº‹ä»¶çš„ç±»ä¸­æ³¨å…¥IMediatorç±»å‹çš„æœåŠ¡ï¼Œç„¶åæˆ‘ä»¬è°ƒç”¨Publishæ–¹æ³•æ¥å‘å¸ƒã€‚æ³¨æ„ä¸è¦é”™è¯¯åœ°è°ƒç”¨Sendæ–¹æ³•æ¥å‘å¸ƒäº‹ä»¶ï¼Œå› æ­¤Sendæ–¹æ³•æ˜¯ç”¨æ¥å‘å¸ƒä¸€å¯¹ä¸€äº‹ä»¶çš„ï¼Œè€ŒPublishæ–¹æ³•æ˜¯ç”¨æ¥å‘å¸ƒä¸€å¯¹å¤šäº‹ä»¶çš„ã€‚æˆ‘ä»¬éœ€è¦åœ¨æ§åˆ¶å™¨çš„ç™»é™†æ–¹æ³•ä¸­å‘å¸ƒäº‹ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬çœç•¥å®é™…çš„ç™»é™†ä»£ç ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TestController</span> : <span class="title">ControllerBase</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> IMediator mediator;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TestController</span>(<span class="params">IMediator mediator</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.mediator = mediator;</span><br><span class="line">    &#125;</span><br><span class="line">    [<span class="meta">HttpPost</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;IActionResult&gt; <span class="title">Login</span>(<span class="params">TestEvent req</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">await</span> mediator.Publish(<span class="keyword">new</span> TestEvent(req.UserName));</span><br><span class="line">        <span class="keyword">return</span> Ok(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/img%5CDDD%5C4.png"></p>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> EF Core </tag>
            
            <tag> ASP.NET Core </tag>
            
            <tag> Entity Framework Core </tag>
            
            <tag> DDD </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>.NET Coreçš„DDDå®æˆ˜-EF Coreä¸­å®ç°å€¼å¯¹è±¡</title>
      <link href="/2025/05/19/DDD/EFCore%E4%B8%AD%E5%AE%9E%E7%8E%B0%E5%80%BC%E5%AF%B9%E8%B1%A1/"/>
      <url>/2025/05/19/DDD/EFCore%E4%B8%AD%E5%AE%9E%E7%8E%B0%E5%80%BC%E5%AF%B9%E8%B1%A1/</url>
      
        <content type="html"><![CDATA[<h1 id="EF-Coreä¸­å®ç°å€¼å¯¹è±¡"><a href="#EF-Coreä¸­å®ç°å€¼å¯¹è±¡" class="headerlink" title="EF Coreä¸­å®ç°å€¼å¯¹è±¡"></a>EF Coreä¸­å®ç°å€¼å¯¹è±¡</h1><p>åœ¨å®šä¹‰å®ä½“ç±»çš„æ—¶å€™ï¼Œå®ä½“ç±»ä¸­çš„ä¸€äº›å±æ€§ä¹‹é—´æœ‰ç€ç´§å¯†çš„è”ç³»ï¼Œæ¯”å¦‚æˆ‘ä»¬è¦åœ¨è¡¨ç¤ºåŸå¸‚çš„å®ä½“ç±»Cityä¸­å®šä¹‰è¡¨ç¤ºåœ°ç†ä½ç½®çš„å±æ€§ï¼Œå› ä¸ºåœ°ç†ä½ç½®åŒ…å«â€œç»åº¦â€ï¼ˆlongitudeï¼‰å’Œâ€œçº¬åº¦â€ï¼ˆlatitudeï¼‰ä¸¤ä¸ªå€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¸ºCityç±»å¢åŠ Longitudeã€Latitudeä¸¤ä¸ªå±æ€§ã€‚è¿™ä¹Ÿæ˜¯å¤§éƒ¨åˆ†äººçš„åšæ³•ï¼Œè¿™æ ·åšæ²¡ä»€ä¹ˆå¤ªå¤§çš„é—®é¢˜ã€‚ä¸è¿‡ï¼Œä»é€»è¾‘ä¸Šæ¥è®²ï¼Œè¿™æ ·å®šä¹‰çš„ç»çº¬åº¦å’Œä¸»é”®ã€åå­—ç­‰å±æ€§ä¹‹é—´æ˜¯å¹³ç­‰çš„å…³ç³»ï¼Œä½“ç°ä¸å‡ºæ¥ç»åº¦å’Œçº¬åº¦çš„ç´§å¯†å…³ç³»ã€‚å¦‚æœæˆ‘ä»¬èƒ½å®šä¹‰ä¸€ä¸ªåŒ…å«Longitudeã€Latitudeä¸¤ä¸ªå±æ€§çš„Geoç±»å‹ï¼Œç„¶åæŠŠCityçš„â€œåœ°ç†ä½ç½®â€å±æ€§å®šä¹‰ä¸ºGeoç±»å‹ï¼Œè¿™æ ·ç»åº¦ã€çº¬åº¦çš„å…³ç³»å°±æ›´ç´§å¯†äº†ã€‚Geoç±»å‹çš„Longitudeã€Latitudeä¸¤ä¸ªå±æ€§é€šå¸¸ä¸ä¼šè¢«å•ç‹¬ä¿®æ”¹ï¼Œå› æ­¤Geoè¢«å®šä¹‰æˆä¸å¯å˜ç±»ï¼Œä¹Ÿå°±æ˜¯å€¼å¯¹è±¡ã€‚</p><p>åœ¨å®šä¹‰å®ä½“ç±»çš„æ—¶å€™ï¼Œå®ä½“ç±»ä¸­æœ‰çš„å±æ€§ä¸ºæ•°å€¼ç±»å‹ï¼Œæ¯”åŠ â€œå•†å“â€å®ä½“ç±»ä¸­çš„è´¨é‡å±æ€§ã€‚æˆ‘ä»¬å¦‚æœæŠŠè´¨é‡å®šä¹‰ä¸ºdoubleç±»å‹ï¼Œ<br>é‚£ä¹ˆå…¶å®éšå«äº†ä¸€ä¸ªâ€œè´¨é‡å•ä½â€çš„é¢†åŸŸçŸ¥è¯†ï¼Œä½¿ç”¨è¿™ä¸ªå®ä½“ç±»çš„å¼€å‘äººå‘˜å°±éœ€è¦çŸ¥é“è¿™ä¸ªé¢†åŸŸçŸ¥è¯†,è€Œä¸”æˆ‘ä»¬è¿˜è¦é€šè¿‡æ–‡æ¡£å½¢å¼æŠŠè¿™ä¸ªé¢†åŸŸçŸ¥è¯†è®°å½•ä¸‹æ¥ï¼Œè¿™åˆé¢ä¸´ä¸€ä¸ªæ–‡æ¡£å’Œä»£ç ä¿®æ”¹åŒæ­¥çš„é—®é¢˜ã€åœ¨DDDä¸­ï¼Œæˆ‘ä»¬è¦å°½å‡å°‘æ–‡æ¡£ä¸­ä¸å¿…è¦çš„é¢†åŸŸçŸ¥è¯†ã€‚å¦‚æœæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªåŒ…å«value(æ•°å€¼)ã€Unit(è´¨é‡å•ä½)çš„Weightç±»å‹,ç„¶åæŠŠâ€œå•†å“â€çš„è´¨é‡å±æ€§è®¾ç½®ä¸ºweiphtç±»å‹ï¼Œè¿™æ ·çš„ä»£ç ä¸­å¤©ç„¶åŒ…å«äº†æ•°å€¼å’Œè´¨é‡å•ä½ä¿¡æ¯ã€‚åœ¨å®šä¹‰å®ä½“ç±»çš„æ—¶å€™ï¼Œå¾ˆå¤šæ•°å€¼ç±»å‹çš„å±æ€§å…¶å®éƒ½æ˜¯éšå«äº†å•ä½çš„ï¼Œæ¯”å¦‚é‡‘é¢éšå«äº†å¸ç§ä¿¡æ¯ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œè¿™äº›æ•°å€¼ç±»å‹çš„å±æ€§éƒ½åº”è¯¥å®šä¹‰ä¸ºåŒ…å«äº†è®¡é‡å•ä½ä¿¡æ¯çš„ç±»å‹ã€‚è¿™äº›åŒ…æ•°å€¼å’Œè®¡é‡å•ä½çš„ç±»ä¹Ÿä¸€èˆ¬è¢«å®šä¹‰ä¸ºä¸å¯å˜çš„å€¼å¯¹è±¡ã€‚</p><p>æˆ‘ä»¬åœ¨ç¼–å†™å®ä½“ç±»çš„æ—¶å€™ï¼Œæœ‰ä¸€äº›å±æ€§çš„å¯é€‰å€¼èŒƒå›´æ˜¯å›ºå®šçš„ï¼Œæ¯”å¦‚â€œå‘˜å·¥â€ä¸­ç”¨æ¥å®šä¹‰èŒä½çº§åˆ«çš„å±æ€§ä¸ºintç±»å‹ï¼Œå¯é€‰èŒƒå›´ä¸º1~3ï¼Œå®ƒä»¬åˆ†åˆ«è¡¨ç¤ºâ€œåˆçº§â€â€œä¸­çº§â€â€œé«˜çº§â€ã€‚æˆ‘ä»¬ç”¨intç±»å‹è¡¨ç¤ºçº§åˆ«ï¼Œå› æ­¤æˆ‘ä»¬åŒæ ·éœ€è¦åœ¨æ–‡æ¡£ä¸­è¯´æ˜ä¸åŒæ•°å€¼çš„å«ä¹‰ã€‚å¦‚æœæˆ‘ä»¬ç”¨C#ä¸­çš„æšä¸¾ç±»å‹æ¥è¡¨ç¤ºè¿™äº›å›ºå®šå¯é€‰å€¼èŒƒå›´çš„å±æ€§ï¼Œå°±å¯ä»¥è®©ä»£ç çš„å¯è¯»æ€§æ›´å¼ºï¼Œä¹Ÿå°±æ›´åŠ ç¬¦åˆDDDçš„æ€æƒ³ã€‚</p><p>EF Core ä¸­æä¾›äº†å¯¹äºæ²¡æœ‰æ ‡è¯†ç¬¦çš„å€¼å¯¹è±¡è¿›è¡Œæ˜ å°„çš„åŠŸèƒ½,é‚£å°±æ˜¯â€œä»å±å®ä½“ç±»â€(ownedentities)ç±»å‹ï¼Œæˆ‘ä»¬åªè¦åœ¨ä¸»å®ä½“ç±»ä¸­å£°æ˜ä»å±å®ä½“ç±»å‹çš„å±æ€§ï¼Œç„¶åä½¿ç”¨FluentAPä¸­çš„OwnsOne ç­‰æ–¹æ³•æ¥é…ç½®ã€‚</p><p>åœ¨EFCoreä¸­ï¼Œå®ä½“ç±»çš„å±æ€§å¯ä»¥å®šä¹‰ä¸ºæšä¸¾ç±»å‹ï¼Œæšä¸¾ç±»å‹çš„å±æ€§åœ¨æ•°æ®åº“ä¸­é»˜è®¤æ˜¯ä»¥intç±»å‹æ¥ä¿å­˜çš„ã€‚å¯¹äºç›´æ¥æ“ä½œæ•°æ®åº“çš„äººå‘˜æ¥è®²ï¼Œ0ã€1ã€2è¿™æ ·çš„å€¼æ²¡æœ‰â€œCNYâ€(äººæ°‘å¸)ã€â€œUSDâ€(ç¾å…ƒ)ã€â€œNZDâ€(æ–°è¥¿å…°å…ƒ)ç­‰è¿™æ ·çš„ string ç±»å‹çš„å€¼å¯è¯»æ€§å¼ºã€‚EFCore ä¸­å¯ä»¥åœ¨FluentAPIä¸­ç”¨HasConversion<string>æŠŠæšä¸¾ç±»å‹çš„å€¼é…ç½®æˆå­—ç¬¦ä¸²ã€‚</p><p>æˆ‘ä»¬é€šè¿‡â€œåœ°åŒºâ€å®ä½“ç±»Regionæ¥ä¸¾ä¾‹ã€‚ä¸€ä¸ªçœã€ä¸€ä¸ªå¸‚ç­‰éƒ½å¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ªåœ°åŒºï¼ŒRegionç±»å«æœ‰Name(åå­—)ã€Area(é¢ç§¯)ã€Level(çº§åˆ«)ã€Population(æ€»äººå£)ã€Location(åœ°ç†è¡Œç½®)ç­‰å±æ€§:Name ä¸­æ—¢åŒ…å«ä¸­æ–‡åå­—ï¼Œä¹ŸåŒ…å«è‹±æ–‡åå­—ï¼Œå› æ­¤æˆ‘ä»¬æŠŠå®ƒä»¬å®šä¹‰åˆ°MultilingualSting å€¼å¯¹è±¡ä¸­;Area å®šä¹‰ä¸ºåŒ…å«Value(æ•°å€¼)ã€Unit(è®¡é‡å•ä½)ä¸¤ä¸ªå±æ€§çš„Area ç±»å‹:Location å®šä¹‰ä¸ºåŒ…å« Longitude(ç»åº¦)ã€Latitude(çº¬åº¦)ä¸¤ä¸ªå±æ€§çš„ Geo ç±»å‹.Levelå®šä¹‰ä¸ºåŒ…å« Province(çœ)ã€City(å¸‚)ã€County(å¿)ã€Town(é•‡)å‡ ä¸ªå¯é€‰å€¼çš„æšä¸¾ç±»å‹RegionLevelã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> è¡¨ç¤ºå…·æœ‰ç›¸å…³å…ƒæ•°æ®ï¼ˆå¦‚åç§°ã€é¢ç§¯ã€äººå£å’Œä½ç½®ï¼‰çš„åœ°ç†åŒºåŸŸã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span>è¿™ä¸ª <span class="doctag">&lt;see cref=&quot;Region&quot;/&gt;</span> ç±»æä¾›äº†ä¸€ç§å»ºæ¨¡åœ°ç†åŒºåŸŸçš„æ–¹æ³•</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span>å¯¹å…¶åç§°ã€å®šä¹‰åŒºåŸŸã€äººå£æ•°æ®å’Œç‰¹å®šä½ç½®çš„å¤šè¯­è¨€æ”¯æŒã€‚å®ƒè¿˜åŒ…æ‹¬</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span>åˆ†å±‚çº§åˆ«å¯¹åŒºåŸŸè¿›è¡Œåˆ†ç±»ã€‚æ­¤ç±»çš„å®ä¾‹å¯¹äºå¤§å¤šæ•°å±æ€§éƒ½æ˜¯ä¸å¯å˜çš„ï¼Œé™¤äº†</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;see cref=&quot;Population&quot;/&gt;</span> ä¸ <span class="doctag">&lt;see cref=&quot;Level&quot;/&gt;</span>, å…¶å¯ä»¥ä½¿ç”¨æ‰€æä¾›çš„æ–¹æ³•è¿›è¡Œæ›´æ–°ã€‚<span class="doctag">&lt;/remarks&gt;</span></span></span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Region</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">long</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">init</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> MultilingualString Name&#123; <span class="keyword">get</span>; <span class="keyword">init</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> Area Area&#123; <span class="keyword">get</span>; <span class="keyword">init</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> RegionLevel Level&#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">long</span>? Population &#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> Geo Location&#123; <span class="keyword">get</span>; <span class="keyword">init</span>; &#125;</span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="title">Region</span>()</span> &#123; &#125;<span class="comment">//ç»™EFCoreä»æ•°æ®åº“ä¸­åŠ è½½æ•°æ®ç„¶åç”ŸæˆUserå¯¹è±¡è¿”å›ç”¨çš„</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Region</span>(<span class="params">MultilingualString name, Area area,Geo location,RegionLevel level</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.Name= name;</span><br><span class="line">            <span class="keyword">this</span>.Area= area;</span><br><span class="line">            <span class="keyword">this</span>.Level= level;</span><br><span class="line">            <span class="keyword">this</span>.Location= location;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ChangePopulation</span>(<span class="params"><span class="built_in">long</span> <span class="keyword">value</span></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.Population= <span class="keyword">value</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ChangeLevel</span>(<span class="params">RegionLevel <span class="keyword">value</span></span>)</span> </span><br><span class="line">        &#123; </span><br><span class="line">            <span class="keyword">this</span>.Level= <span class="keyword">value</span>; </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Regionç±»Nameã€Areaã€Locationéƒ½æ˜¯ä¸å˜çš„ï¼Œå› æ­¤æˆ‘ä»¬æŠŠIdã€Nameã€Areaã€Locationå±æ€§è®¾ç½®ä¸ºinit;Levelå’ŒPopulationæ˜¯ä¸å˜çš„ï¼Œå› æ­¤Levelå’ŒPopulationå±æ€§è®¾ç½®ä¸ºprivate setã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> å®ç°å¤šè¯­è¨€</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;Chinese&quot;&gt;</span>æ±‰è¯­<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;English&quot;&gt;</span>è‹±è¯­<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">internal</span> <span class="keyword">record</span> <span class="title">MultilingualString</span>(<span class="params"><span class="built_in">string</span> Chinese, <span class="built_in">string</span>? English</span>)</span>;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> è¡¨ç¤ºå…·æœ‰æŒ‡å®šå€¼å’Œå•ä½çš„é¢ç§¯æµ‹é‡ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span>è¯¥è®°å½•å°è£…äº†ä¸€ä¸ªé¢ç§¯æµ‹é‡ï¼ŒåŒ…æ‹¬å…¶æ•°å€¼å’Œå•ä½æµ‹é‡ã€‚å®ƒæ˜¯ä¸å˜çš„ï¼Œå¯ä»¥ç”¨æ¥è¡¨ç¤ºä¸åŒå•ä½çš„é¢ç§¯ï¼Œå¦‚å¹³æ–¹ç±³æˆ–å¹³æ–¹è‹±å°ºã€‚<span class="doctag">&lt;/remarks&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;Value&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;Unit&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="keyword">record</span> <span class="title">Area</span>(<span class="title">double</span> <span class="title">Value</span>, <span class="title">AreaType</span> <span class="title">Unit</span>);</span><br><span class="line">    <span class="built_in">enum</span> AreaType&#123;SquareKM, Hectare, CnMu&#125;; <span class="comment">//å¹³æ–¹å…¬é‡Œã€å…¬é¡·ã€å¸‚äº©</span></span><br><span class="line">    <span class="built_in">enum</span> RegionLevel &#123; Province,City,County,Town&#125;;<span class="comment">//çœã€å¸‚ã€å¿ã€é•‡</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ä»£è¡¨å…·æœ‰æŒ‡å®šçº¬åº¦å’Œç»åº¦çš„åœ°ç†åæ ‡ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span>è¿™ä¸ª <span class="doctag">&lt;see cref=&quot;Geo&quot;/&gt;</span> è®°å½•æ˜¯ä¸å¯å˜çš„ï¼Œå¹¶ç¡®ä¿çº¬åº¦å’Œç»åº¦å€¼åœ¨æœ‰æ•ˆèŒƒå›´å†…ï¼š</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;list type=&quot;bullet&quot;&gt;</span> <span class="doctag">&lt;item&gt;</span><span class="doctag">&lt;description&gt;</span>ç»åº¦å¿…é¡»ä»‹äº-180å’Œ180ä¹‹é—´åº¦ã€‚<span class="doctag">&lt;/description&gt;</span><span class="doctag">&lt;/item&gt;</span> </span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;item&gt;</span><span class="doctag">&lt;description&gt;</span>çº¬åº¦å¿…é¡»ä»‹äº-90å’Œ90ä¹‹é—´åº¦ã€‚<span class="doctag">&lt;/description&gt;</span><span class="doctag">&lt;/item&gt;</span> <span class="doctag">&lt;/list&gt;</span><span class="doctag">&lt;/remarks&gt;</span></span></span><br><span class="line">    <span class="keyword">record</span> <span class="title">Geo</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">double</span> Longitude &#123; <span class="keyword">get</span>; <span class="keyword">init</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">double</span> Latitude &#123; <span class="keyword">get</span>; <span class="keyword">init</span>; &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Geo</span>(<span class="params"><span class="built_in">double</span> Longitude, <span class="built_in">double</span> Latitude</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (Longitude &lt; <span class="number">-180</span> || Longitude &gt; <span class="number">180</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;longitude invalid&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(Latitude &lt; <span class="number">-90</span>|| Latitude &gt; <span class="number">90</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;longitude invalid&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">this</span>.Longitude = Longitude;</span><br><span class="line">            <span class="keyword">this</span>.Latitude = Latitude;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>MultilingualStringã€AreaTypeéƒ½æ˜¯ä»¥æ•´ä½“å‡ºç°çš„ï¼Œå› æ­¤æˆ‘ä»¬æŠŠå®ƒä»¬é€šè¿‡recordå®šä¹‰ä¸ºä¸å¯å˜ç±»å‹ã€‚ä»å±å®ä½“ç±»å‹å¹¶ä¸è¦æ±‚å¿…é¡»ä¸ºä¸å¯å˜ç±»å‹ï¼Œä¸è¿‡æˆ‘ä»¬ä¸€èˆ¬éƒ½æŠŠå®ƒä»¬å®šä¹‰ä¸ºä¸å¯å˜ç±»å‹ï¼Œè¿™æ ·èƒ½å¤Ÿæä¾›æ›´æ¸…æ™°çš„è¯­ä¹‰ã€‚</p><p>æˆ‘ä»¬è¿˜éœ€è¦é€šè¿‡Fluent APIæ¥å¯¹Regionä¸­çš„æšä¸¾ç±»å‹ä»¥åŠä»å±å®ä½“ç±»å‹è¿›è¡Œé…ç½®ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> åŒºåŸŸå®ä½“çš„EF Coreé…ç½®ç±»ï¼Œé…ç½®äº†Areaã€Locationã€Levelå’ŒNameç­‰å€¼å¯¹è±¡å±æ€§çš„æ˜ å°„è§„åˆ™ã€‚</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">RegionConfig</span> : <span class="title">IEntityTypeConfiguration</span>&lt;<span class="title">Region</span>&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> ä¸ºé…ç½®å®ä½“ç±»å‹<span class="doctag">&lt;see cref=&quot;Region&quot;/&gt;</span> ç±».</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;remarks&gt;</span>æ­¤æ–¹æ³•å®šä¹‰äº†<span class="doctag">&lt;see cref=&quot;Region&quot;/&gt;</span> å®ä½“ï¼ŒåŒ…æ‹¬</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span>æ‹¥æœ‰ç±»å‹å’Œå±æ€§çº¦æŸã€‚å®ƒæŒ‡å®šäº† <span class="doctag">&lt;c&gt;</span>Area<span class="doctag">&lt;/c&gt;</span>,</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;c&gt;</span>Location<span class="doctag">&lt;/c&gt;</span>, <span class="doctag">&lt;c&gt;</span>Level<span class="doctag">&lt;/c&gt;</span>, and <span class="doctag">&lt;c&gt;</span>Name<span class="doctag">&lt;/c&gt;</span> å±æ€§ <span class="doctag">&lt;see cref=&quot;Region&quot;/&gt;</span> å®ä½“.<span class="doctag">&lt;/remarks&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;builder&quot;&gt;</span>è¿™ä¸ª <span class="doctag">&lt;see cref=&quot;EntityTypeBuilder&#123;TEntity&#125;&quot;/&gt;</span> ç”¨äºé…ç½® <span class="doctag">&lt;see cref=&quot;Region&quot;/&gt;</span> å®ä½“.<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">EntityTypeBuilder&lt;Region&gt; builder</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            builder.OwnsOne(c =&gt; c.Area, nb =&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                nb.Property(e =&gt; e.Unit).HasMaxLength(<span class="number">20</span>)</span><br><span class="line">                .IsRequired(<span class="literal">true</span>).HasConversion&lt;<span class="built_in">string</span>&gt;();</span><br><span class="line">            &#125;);</span><br><span class="line">            builder.OwnsOne(c =&gt; c.Location);</span><br><span class="line">            builder.Property(c=&gt;c.Level).HasMaxLength(<span class="number">20</span>)</span><br><span class="line">                .IsRequired(<span class="literal">true</span>).HasConversion&lt;<span class="built_in">string</span>&gt;();</span><br><span class="line">            builder.OwnsOne(c =&gt; c.Name, nb =&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                nb.Property(e =&gt; e.English).HasMaxLength(<span class="number">20</span>).IsRequired(<span class="literal">true</span>);</span><br><span class="line">                nb.Property(e =&gt; e.Chinese).HasMaxLength(<span class="number">20</span>).IsRequired(<span class="literal">true</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ç”¨ wns0neå¯¹ä»å±å®ä½“ç±»å‹å±æ€§è¿›è¡Œé…ç½®ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒEFCore å°†ä¼šæŒ‰ç…§çº¦å®šå¯¹ä»å±å®ä½“ç±»å‹å±æ€§è¿›è¡Œé…ç½®ï¼Œå¦‚ç¬¬9è¡Œä»£ç æ‰€ç¤º;å¦‚æœæˆ‘ä»¬éœ€è¦å¯¹ä»å±å®ä½“ç±»å‹å±æ€§è¿›è¡Œè‡ªå®šä¹‰é…ç½®ï¼Œå¯ä»¥åƒç¬¬5<del>8è¡Œä»£ç ä»¥åŠç¬¬12</del>15 è¡Œä»£ç é‚£æ ·åœ¨ OwnsOne æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°ä¸­è¿›ä¸ªé…ç½®ã€‚ä¸ºäº†è®©æšä¸¾ç±»å‹åœ¨æ•°æ®åº“ä¸­æ˜ å°„ä¸ºstingç±»å‹è€Œä¸æ˜¯é»˜è®¤çš„intç±»å‹ï¼Œæˆ‘ä»¬åœ¨ç¬¬7è¡Œä»£ç å’Œç¬¬11è¡Œä»£ç åˆ†åˆ«å¯¹äºå®ä½“ç±»Regionä»¥åŠä»å±å®ä½“ç±»å‹Areaä¸­çš„æšä¸¾ç±»å‹æ€§HasConversion<string>æ–¹æ³•è¿›è¡Œé…ç½®ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> MyDbContext ctx = <span class="keyword">new</span> MyDbContext();</span><br><span class="line"></span><br><span class="line">MultilingualString name1 = <span class="keyword">new</span> MultilingualString(<span class="string">&quot;åŒ—äº¬&quot;</span>, <span class="string">&quot;BeiJing&quot;</span>);</span><br><span class="line">Area areal = <span class="keyword">new</span> Area(<span class="number">16410</span>, AreaType.SquareKM);</span><br><span class="line">Geo loc = <span class="keyword">new</span> Geo(<span class="number">116.4074</span>, <span class="number">39.9042</span>);</span><br><span class="line">Region c1 = <span class="keyword">new</span> Region(name1, areal, loc, RegionLevel.Province);</span><br><span class="line">c1.ChangePopulation(<span class="number">21893100</span>);</span><br><span class="line">ctx.Regions.Add(c1);</span><br><span class="line">ctx.SaveChanges();</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> EF Core </tag>
            
            <tag> ASP.NET Core </tag>
            
            <tag> Entity Framework Core </tag>
            
            <tag> DDD </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>.NET Coreçš„DDDçš„æŠ€æœ¯è½å®</title>
      <link href="/2025/05/17/DDD/%E8%B4%AB%E8%A1%80%E6%A8%A1%E5%9E%8B%E4%B8%8E%E5%85%85%E8%A1%80%E6%A8%A1%E5%9E%8B/"/>
      <url>/2025/05/17/DDD/%E8%B4%AB%E8%A1%80%E6%A8%A1%E5%9E%8B%E4%B8%8E%E5%85%85%E8%A1%80%E6%A8%A1%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="è´«è¡€æ¨¡å‹ä¸å……è¡€æ¨¡å‹"><a href="#è´«è¡€æ¨¡å‹ä¸å……è¡€æ¨¡å‹" class="headerlink" title="è´«è¡€æ¨¡å‹ä¸å……è¡€æ¨¡å‹"></a>è´«è¡€æ¨¡å‹ä¸å……è¡€æ¨¡å‹</h1><p>åœ¨é¢å‘å¯¹è±¡çš„è®¾è®¡ä¸­æœ‰è´«è¡€æ¨¡å‹ä¸å……è¡€æ¨¡å‹ä¸¤ç§é£æ ¼ã€‚æ‰€è°“çš„è´«è¡€æ¨¡å‹æŒ‡çš„æ˜¯ä¸€ä¸ªç±»ä¸­åªæœ‰å±æ€§æˆ–è€…æˆå‘˜å˜é‡ï¼Œæ²¡æœ‰æ–¹æ³•ï¼Œè€Œå……è¡€æ¨¡å‹æŒ‡çš„æ˜¯ä¸€ä¸ªç±»ä¸­æ—¢æœ‰å±æ€§ã€æˆå‘˜å˜é‡ï¼Œä¹Ÿæœ‰æ–¹æ³•ã€‚</p><p>å‡è®¾æˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸ªç±»ï¼Œè¿™ä¸ªç±»ä¸­å¯ä»¥ä¿å­˜ç”¨æˆ·çš„ç”¨æˆ·åã€å¯†ç å°±ã€ç§¯åˆ†ï¼›ç”¨æˆ·å¿…é¡»å…·æœ‰ç”¨æˆ·åï¼›ä¸ºäº†ä¿è¯å®‰å…¨ï¼Œå¯†ç é‡‡ç”¨å¯†ç çš„å“ˆå¸Œå€¼ä¿å­˜ï¼›ç”¨æˆ·çš„åˆå§‹ç§¯åˆ†ä¸º10;æ¯æ¬¡ç™»å½•æˆåŠŸå¥–åŠ±5ä¸ªç§¯åˆ†ï¼Œæ¯æ¬¡ç™»å½•å¤±è´¥æ‰£3ä¸ªç§¯åˆ†ï¼ˆè¿™æ ·çš„éœ€æ±‚è‚¯å®šæ˜¯ä¸åˆç†çš„ï¼‰</p><h2 id="è´«è¡€æ¨¡å‹"><a href="#è´«è¡€æ¨¡å‹" class="headerlink" title="è´«è¡€æ¨¡å‹"></a>è´«è¡€æ¨¡å‹</h2><p>é€»è¾‘ä»£ç ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">User</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> UserName&#123;<span class="keyword">get</span>;<span class="keyword">set</span>;&#125;<span class="comment">//ç”¨æˆ·å</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> PasswordHash &#123;<span class="keyword">get</span>;<span class="keyword">set</span>;&#125;<span class="comment">//å¯†ç çš„æ•£åˆ—å€¼</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Credit &#123;<span class="keyword">get</span>;<span class="keyword">set</span>;&#125;<span class="comment">//ç§¯åˆ†</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„åªåŒ…å«å±æ€§ã€ä¸åŒ…å«é€»è¾‘æ–¹æ³•çš„ç±»ï¼Œè¿™æ ·çš„ç±»é€šå¸¸è¢«å«ä½œPOCOç±»ï¼Œè¿™å°±æ˜¯å…¸å‹çš„â€œè´«è¡€æ¨¡å‹â€ã€‚ä½¿ç”¨è¿™æ ·çš„ç±»ï¼Œæˆ‘ä»¬ç¼–å†™ä»£ç æ¥è¿›è¡Œç”¨æˆ·åˆ›å»ºã€ç™»å½•ã€ç§¯åˆ†å˜åŠ¨æ“ä½œ</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">User u1=<span class="keyword">new</span> User();</span><br><span class="line">u1.UserName=<span class="string">&quot;YOUXIANYU&quot;</span>;</span><br><span class="line">u1.Credit=<span class="number">10</span>;</span><br><span class="line">u1.PasswordHash=HashHelper.Hash(<span class="string">&quot;123456&quot;</span>);<span class="comment">//è®¡ç®—å¯†ç çš„æ•£åˆ—å€¼</span></span><br><span class="line"><span class="built_in">string</span> pwd = Console.RedLine();</span><br><span class="line"><span class="keyword">if</span>(HashHelper.Hash(pwd)==u1.PasswordHash)</span><br><span class="line">&#123;</span><br><span class="line">    u1.Credit+=<span class="number">5</span>;<span class="comment">//ç™»å½•å¢åŠ 5ç§¯åˆ†</span></span><br><span class="line">    Console.WriteLine(<span class="string">&quot;ç™»é™†æˆåŠŸ&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(u1.Credit&lt;<span class="number">3</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;ç§¯åˆ†ä¸è¶³ï¼Œæ— æ³•æ‰£å‡&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        u1.Credit-=<span class="number">3</span>;<span class="comment">//ç™»å½•å¤±è´¥ï¼Œåˆ™æ‰£é™¤3ç§¯åˆ†</span></span><br><span class="line">        Console.WiteLine(<span class="string">&quot;ç™»å½•å¤±è´¥&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬å››è¡Œä»£ç ä¸­ï¼Œè°ƒç”¨HashHelper.Hashæ–¹æ³•æ¥è®¡ç®—å­—ç¬¦ä¸²çš„å“ˆå¸Œå€¼ï¼›ç¬¬äº”è¡Œä»£ç ä¸­ï¼Œç­‰å¾…ç”¨æˆ·è¾“å…¥ä¸€ä¸ªå¯†ç ï¼Œä»¥ä¾¿è¿›è¡Œå¯†ç æ­£ç¡®æ€§çš„æ£€æŸ¥ã€‚ä¸Šé¢çš„ä»£ç å¯ä»¥æ­£å¸¸åœ°å®ç°éœ€æ±‚ï¼Œä½†åˆå¦‚ä¸‹é—®é¢˜ã€‚</p><ol><li>ä¸€ä¸ªUserå¯¹è±¡å¿…é¡»å…·æœ‰ç”¨æˆ·åï¼Œä½†æ˜¯åœ¨ç¬¬ä¸€è¡Œä»£ç ä¸­åˆ›å»ºçš„Userç±»çš„å¯¹è±¡çš„UserNameå±æ€§ä¸ºnullã€‚è™½ç„¶æˆ‘ä»¬å¾ˆå¿«åœ¨ç¬¬äºŒè¡Œä»£ç ä¸­ç»™UserNameèµ‹å€¼äº†ï¼Œä½†æ˜¯å¦‚æœUserç±»ä½¿ç”¨ä¸å½“ï¼ŒUserç±»çš„å¯¹è±¡æœ‰å¯èƒ½å¤„äºéæ³•çŠ¶æ€ã€‚</li><li>â€œç”¨æˆ·çš„åˆå§‹ç§¯åˆ†ä¸º10â€è¿™æ ·çš„é¢†åŸŸçŸ¥è¯†æ˜¯ç”±ä½¿ç”¨è€…åœ¨ç¬¬ä¸‰è¡Œä»£ç ä¸­è®¾å®šçš„ï¼Œè€Œä¸æ˜¯ç”±Userç±»å†…åŒ–çš„è¡Œä¸ºã€‚</li><li>â€œä¿å­˜ç”¨æˆ·å¯†ç çš„å“ˆå¸Œå€¼â€è¿™æ ·çš„Userç±»å†…éƒ¨çš„é¢†åŸŸçŸ¥è¯†éœ€è¦ç±»çš„ä½¿ç”¨è€…äº†è§£ï¼Œè¿™æ ·ç±»çš„ä½¿ç”¨è€…æ‰èƒ½åœ¨ç¬¬å››è¡Œä»£ç å’Œç¬¬6è¡Œä»£ç å®Œæˆè®¾ç½®å¯†ç åŠåˆ¤æ–­ç”¨æˆ·è¾“å…¥çš„å¯†ç æ˜¯å¦æ­£ç¡®ã€‚</li><li>ç”¨æˆ·çš„ç§¯åˆ†ä½™é¢å¾ˆæ˜¾ç„¶ä¸èƒ½ä¸ºè´Ÿå€¼ï¼Œå› æ­¤æˆ‘ä»¬åœ¨åœ°13~21è¡Œä»£ç ä¸­è¿›è¡Œç§¯åˆ†æ‰£å‡çš„æ—¶å€™è¿›è¡Œäº†åˆ¤æ–­ï¼Œå¯æ˜¯è¿™æ ·çš„è¡Œä¸ºåº”è¯¥å°è£…åˆ°Userç±»ä¸­ï¼Œè€Œä¸åº”è¯¥ç”±Userç±»çš„ä½¿ç”¨è€…è¿›è¡Œåˆ¤æ–­ã€‚</li></ol><h2 id="å……è¡€æ¨¡å‹"><a href="#å……è¡€æ¨¡å‹" class="headerlink" title="å……è¡€æ¨¡å‹"></a>å……è¡€æ¨¡å‹</h2><p>é¢å‘å¯¹è±¡çš„åŸºæœ¬ç‰¹å¾æ˜¯ï¼šâ€œå°è£…æ€§â€ï¼šæŠŠç±»çš„å†…éƒ¨å®ç°ç»†èŠ‚å°è£…èµ·æ¥ï¼Œå¯¹å¤–æä¾›å¯ä¾›å®‰å…¨è°ƒç”¨çš„æ–¹æ³•ï¼Œä»è€Œè®©ç±»çš„ä½¿ç”¨æ— é¡»å…³å¿ƒç±»çš„å†…éƒ¨å®ç°ã€‚ä¸€ä¸ªç±»ä¸­æ ¸å¿ƒçš„å…ƒç´ æ˜¯æ•°æ®å’Œè¡Œä¸ºï¼Œæ•°æ®æŒ‡çš„æ˜¯ç±»çš„å±æ€§æˆ–è€…æˆå‘˜å˜é‡ï¼Œè€Œè¡Œä¸ºæŒ‡çš„æ˜¯ç±»çš„æ–¹æ³•ã€‚è€Œæˆ‘ä»¬è®¾è®¡çš„Userç±»åªåŒ…å«æ•°æ®ï¼Œä¸åŒ…å«è¡Œä¸ºï¼Œæˆ‘ä»¬ç”¨å¿ƒè®¾è®¡çš„ç±»åªèƒ½åˆ©ç”¨é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ä¸€éƒ¨åˆ†èƒ½åŠ›ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">User</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span>? UserName &#123; <span class="keyword">get</span>; <span class="keyword">init</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Credit &#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span>? PasswordHash;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span>(<span class="params"><span class="built_in">string</span> userName</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.UserName = userName;</span><br><span class="line">        <span class="keyword">this</span>.Credit = <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ChangePassword</span>(<span class="params"><span class="built_in">string</span> newValue</span>)</span> </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (newValue.Length &gt; <span class="number">6</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;å¯†ç å¤ªçŸ­&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.PasswordHash = newValue;   </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">bool</span> <span class="title">CheckPassword</span>(<span class="params"><span class="built_in">string</span> password</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> hash = password;</span><br><span class="line">        <span class="keyword">return</span> password == hash; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">DeductCredits</span>(<span class="params"><span class="built_in">int</span> delta</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (Credit &lt;<span class="number">3</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;é¢åº¦ä¸è¶³&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (delta &lt;= <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;é¢åº¦ä¸èƒ½ä¸ºè´Ÿå€¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.Credit-= delta;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">AddCredits</span>(<span class="params"><span class="built_in">int</span> delta</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.Credit += delta;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">User u1 = <span class="keyword">new</span> User(<span class="string">&quot;YOUXIANYU&quot;</span>);</span><br><span class="line">u1.ChangePassword(<span class="string">&quot;123456&quot;</span>);</span><br><span class="line"><span class="built_in">string</span>? pwd = Console.ReadLine();</span><br><span class="line"><span class="keyword">if</span> (u1.CheckPassword(pwd))</span><br><span class="line">&#123;</span><br><span class="line">    u1.AddCredits(<span class="number">5</span>);</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;ç™»é™†æˆåŠŸ&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    u1.DeductCredits(<span class="number">3</span>);</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;ç™»å½•å¤±è´¥&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼ŒUserç±»çš„ä½¿ç”¨è€…çš„å·¥ä½œé‡å°‘äº†å¾ˆå¤šï¼Œä»–ä»¬éœ€è¦äº†è§£çš„é¢†åŸŸçŸ¥è¯†ä¹Ÿå°‘äº†å¾ˆå¤šï¼Œ</p><p>æœ‰çš„è¯»è€…å¯èƒ½è®¤ä¸ºï¼Œæ— è®ºæ˜¯è´«è¡€æ¨¡å‹è¿˜æ˜¯å……è¡€æ¨¡å‹ï¼Œåªä¸è¿‡æ˜¯é€»è¾‘ä»£ç æ”¾ç½®çš„ä½ç½®ä¸ä¸€æ ·è€Œå·²ï¼Œæœ¬è´¨ä¸Šæ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚è¿™æ ·çš„è§‚ç‚¹æ˜¯é”™è¯¯çš„ã€‚é¦–å…ˆï¼Œä»ä»£ç çš„è§’åº¦æ¥è®²ï¼ŒæŠŠæœ¬åº”è¯¥å±äºUserç±»çš„è¡Œä¸ºå°è£…åˆ°Userç±»ä¸­ï¼Œè¿™æ˜¯ç¬¦åˆå•ä¸€èŒè´£åŸåˆ™çš„ï¼Œå½“ç³»ç»Ÿä¸­å…¶ä»–åœ°æ–¹éœ€è¦è°ƒç”¨Userç±»çš„æ—¶å€™å°±å¯ä»¥å¤ç”¨Userç±»ä¸­çš„æ–¹æ³•äº†ï¼Œå…¶æ¬¡ï¼Œè´«è¡€æ¨¡å‹æ˜¯ç«™åœ¨å¼€å‘äººå‘˜è§’åº¦æ€è€ƒé—®é¢˜çš„ï¼Œè€Œå……è¡€æ¨¡å‹æ˜¯ç«™åœ¨ä¸šåŠ¡è§’åº¦æ€è€ƒé—®é¢˜çš„ã€‚é¢†åŸŸä¸“å®¶ä¸æ˜ç™½ä»€ä¹ˆæ˜¯ â€œæŠŠç”¨æˆ·è¾“å…¥çš„å¯†ç è¿›è¡Œå“ˆå¸Œè¿ç®—ï¼Œç„¶åæŠŠå“ˆå¸Œå€¼ä¿å­˜èµ·æ¥â€ï¼Œä½†æ˜¯ä»–ä»¬æ˜ç™½â€œä¿®æ”¹å¯†ç ï¼Œæ£€æŸ¥å¯†ç æˆåŠŸâ€ç­‰å……è¡€æ¨¡å‹ååº”å‡ºæ¥çš„æ¦‚å¿µï¼Œå› æ­¤é¢†åŸŸæ¨¡å‹ä¸­çš„æ‰€æœ‰è¡Œä¸ºéƒ½åº”è¯¥æœ‰ä¸šåŠ¡ä»·å€¼ï¼Œè€Œä¸åº”è¯¥åªæœ‰åæ˜ æ•°æ®å±æ€§ã€‚</p><p>å°½ç®¡å……è¡€æ¨¡å‹å¸¦æ¥çš„å¥½å¤„æ˜¯æ˜æ˜¾çš„ï¼Œä½†æ˜¯è´«è¡€æ¨¡å‹ä¾æ—§å¾ˆæµè¡Œï¼Œå…¶æ ¹æœ¬åŸå› åœ¨äºæ—©æœŸçš„å¾ˆå¤šæŒä¹…æ€§æ¡†æ¶ï¼ˆæ¯”å¦‚ORMç­‰ï¼‰è¦æ±‚å®ä½“ç±»çš„æ‰€æœ‰å±æ€§å¿…é¡»æ˜¯å¯è¯»å¯å†™ï¼Œè€Œæˆ‘ä»¬å¯ä»¥å¾ˆç®€å•çš„æŠŠæ•°æ®åº“ä¸­çš„è¡¨æŒ‰ç…§å­—æ®µé€ä¸ªæ˜ å°„ä¸ºä¸€ä¸ªè´«è¡€æ¨¡å‹çš„POCOç±»ï¼Œè¿™æ ·â€œæ•°æ®åº“é©±åŠ¨â€çš„æ€ç»´æ–¹å¼æ›´ç®€å•ç›´æ¥ï¼Œå› æ­¤æˆ‘ä»¬å°±è§åˆ°â€œåˆ°å¤„éƒ½æ˜¯è´«è¡€æ¨¡å‹â€çš„æƒ…å†µäº†ã€‚å€¼å¾—æ¬£æ…°çš„æ˜¯ï¼Œç›®å‰å¤§éƒ¨åˆ†ä¸»æµæŒä¹…æ€§æ¡†æ¶éƒ½å·²ç»æ”¯æŒå……è¡€æ¨¡å‹çš„å†™æ³•äº†ï¼Œæ¯”å¦‚EF Coreå¯¹å……è¡€æ¨¡å‹çš„æ”¯æŒå°±éå¸¸å¥½ï¼Œå› æ­¤æˆ‘ä»¬æ²¡æœ‰ç†ç”±å†ç»§ç»­å†™è´«è¡€æ¨¡å‹äº†ã€‚é‡‡ç”¨å……è¡€æ¨¡å‹ç¼–å†™ä»£ç ï¼Œæˆ‘ä»¬èƒ½æ›´å¥½çš„å®ç°DDDå’Œæ¨¡å‹é©±åŠ¨ç¼–ç¨‹äº†ã€‚</p><h1 id="EF-Coreå¯¹å®ä½“ç±»å±æ€§æ“ä½œçš„å¯†ç "><a href="#EF-Coreå¯¹å®ä½“ç±»å±æ€§æ“ä½œçš„å¯†ç " class="headerlink" title="EF Coreå¯¹å®ä½“ç±»å±æ€§æ“ä½œçš„å¯†ç "></a>EF Coreå¯¹å®ä½“ç±»å±æ€§æ“ä½œçš„å¯†ç </h1><p>EF Coreå¯¹å®ä½“å±æ€§æ“ä½œçš„ç§˜å¯†</p><p>1ã€Whyï¼Ÿä¸ºEF Coreå®ç°å……è¡€æ¨¡å‹åšå‡†å¤‡ã€‚</p><p>2ã€EF Coreæ˜¯é€šè¿‡å®ä½“å¯¹è±¡çš„å±æ€§çš„getã€setæ¥è¿›è¡Œå±æ€§çš„è¯»å†™å—ï¼Ÿ</p><p>3ã€ç­”æ¡ˆï¼šåŸºäºæ€§èƒ½å’Œå¯¹ç‰¹æ®ŠåŠŸèƒ½æ”¯æŒçš„è€ƒè™‘ï¼ŒEF Coreåœ¨è¯»å†™å±æ€§çš„æ—¶å€™ï¼Œå¦‚æœå¯èƒ½ï¼Œå®ƒä¼šç›´æ¥è·³è¿‡getã€setï¼Œè€Œç›´æ¥æ“ä½œçœŸæ­£å­˜å‚¨å±æ€§å€¼çš„æˆå‘˜å˜é‡ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Dog</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span> name;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name </span><br><span class="line">    &#123; </span><br><span class="line">        <span class="keyword">get</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;getè¢«è°ƒç”¨&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> name;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">set</span> </span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;setè¢«è°ƒç”¨&quot;</span>);</span><br><span class="line">            <span class="keyword">this</span>.name = <span class="keyword">value</span>; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Dog d1 = <span class="keyword">new</span> Dog &#123; Name= <span class="string">&quot;goofy&quot;</span> &#125;;</span><br><span class="line">Console.WriteLine(<span class="string">&quot;Dogåˆå§‹åŒ–å®Œæ¯•&quot;</span>);</span><br><span class="line">ctx.Dogs.Add(d1);</span><br><span class="line">ctx.SaveChanges();</span><br><span class="line">Console.WriteLine(<span class="string">&quot;SaveChangeså®Œæ¯•&quot;</span>);</span><br><span class="line"> â€‹</span><br><span class="line">Console.WriteLine(<span class="string">&quot;å‡†å¤‡è¯»å–æ•°æ®&quot;</span>);</span><br><span class="line">Dog d2 = ctx.Dogs.First(d=&gt;d.Name== <span class="string">&quot;goofy&quot;</span>);</span><br><span class="line">Console.WriteLine(<span class="string">&quot;è¯»å–æ•°æ®å®Œæ¯•&quot;</span>);</span><br></pre></td></tr></table></figure><p>æ€»ç»“ï¼š</p><p>EF Coreåœ¨è¯»å†™å®ä½“å¯¹è±¡çš„å±æ€§æ—¶ï¼Œä¼šæŸ¥æ‰¾å±æ€§å¯¹åº”çš„æˆå‘˜å˜é‡ï¼Œå¦‚æœèƒ½æ‰¾åˆ°ï¼ŒEF Coreä¼šç›´æ¥è¯»å†™è¿™ä¸ªæˆå‘˜å˜é‡çš„å€¼ï¼Œè€Œä¸æ˜¯é€šè¿‡setå’Œgetä»£ç å—æ¥è¯»å†™ã€‚</p><p>ä¿®æ”¹Dogçš„æˆå‘˜å˜é‡å</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Dog</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span> xingming;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name </span><br><span class="line">    &#123; </span><br><span class="line">        <span class="keyword">get</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;getè¢«è°ƒç”¨&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> xingming;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">set</span> </span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;setè¢«è°ƒç”¨&quot;</span>);</span><br><span class="line">            <span class="keyword">this</span>.xingming = <span class="keyword">value</span>; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ€»ç»“ï¼š</p><p>1ã€EF Coreä¼šå°è¯•æŒ‰ç…§å‘½åè§„åˆ™å»ç›´æ¥è¯»å†™å±æ€§å¯¹åº”çš„æˆå‘˜å˜é‡ï¼Œåªæœ‰æ— æ³•æ ¹æ®å‘½åè§„åˆ™æ‰¾åˆ°å¯¹åº”æˆå‘˜å˜é‡çš„æ—¶å€™ï¼ŒEF Coreæ‰ä¼šé€šè¿‡å±æ€§çš„getã€setä»£ç å—æ¥è¯»å†™å±æ€§å€¼ã€‚</p><p>2(*)ã€å¯ä»¥åœ¨FluentAPIä¸­é€šè¿‡UsePropertyAccessMode()æ–¹æ³•æ¥ä¿®æ”¹é»˜è®¤çš„è¿™ä¸ªè¡Œä¸ºã€‚</p><h1 id="EF-Coreä¸­å……è¡€æ¨¡å‹çš„éœ€æ±‚"><a href="#EF-Coreä¸­å……è¡€æ¨¡å‹çš„éœ€æ±‚" class="headerlink" title="EF Coreä¸­å……è¡€æ¨¡å‹çš„éœ€æ±‚"></a>EF Coreä¸­å……è¡€æ¨¡å‹çš„éœ€æ±‚</h1><p>å……è¡€æ¨¡å‹å®ç°çš„è¦æ±‚<br>ä¸€ï¼šå±æ€§æ˜¯åªè¯»çš„æˆ–è€…æ˜¯åªèƒ½è¢«ç±»å†…éƒ¨çš„ä»£ç ä¿®æ”¹ã€‚</p><p>äºŒï¼šå®šä¹‰æœ‰å‚æ•°çš„æ„é€ æ–¹æ³•ã€‚</p><p>ä¸‰ï¼šæœ‰çš„æˆå‘˜å˜é‡æ²¡æœ‰å¯¹åº”å±æ€§ï¼Œä½†æ˜¯è¿™äº›æˆå‘˜å˜é‡éœ€è¦æ˜ å°„ä¸ºæ•°æ®è¡¨ä¸­çš„åˆ—ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬éœ€è¦æŠŠç§æœ‰æˆå‘˜å˜é‡æ˜ å°„åˆ°æ•°æ®è¡¨ä¸­çš„åˆ—ã€‚</p><p>å››ï¼šæœ‰çš„å±æ€§æ˜¯åªè¯»çš„ï¼Œä¹Ÿå°±æ˜¯å®ƒçš„å€¼æ˜¯ä»æ•°æ®åº“ä¸­è¯»å–å‡ºæ¥çš„ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸èƒ½ä¿®æ”¹å±æ€§å€¼ã€‚</p><p>äº”ï¼šæœ‰çš„å±æ€§ä¸éœ€è¦æ˜ å°„åˆ°æ•°æ®åˆ—ï¼Œä»…åœ¨è¿è¡Œæ—¶è¢«ä½¿ç”¨ã€‚</p><p>åœ¨EF Coreä¸­å¦‚ä½•å®ç°<br>å®ç°â€œä¸€â€</p><p>å±æ€§æ˜¯åªè¯»çš„æˆ–è€…æ˜¯åªèƒ½è¢«ç±»å†…éƒ¨çš„ä»£ç ä¿®æ”¹ã€‚ å®ç°ï¼šæŠŠå±æ€§çš„setå®šä¹‰ä¸ºprivateæˆ–è€…initï¼Œç„¶åé€šè¿‡æ„é€ æ–¹æ³•ä¸ºè¿™äº›å±æ€§èµ‹äºˆåˆå§‹å€¼ã€‚</p><p>å®ç°â€œäºŒâ€</p><p>å®šä¹‰æœ‰å‚æ•°çš„æ„é€ æ–¹æ³•ã€‚ åŸç†ï¼š EF Coreä¸­çš„å®ä½“ç±»å¦‚æœæ²¡æœ‰æ— å‚çš„æ„é€ æ–¹æ³•ï¼Œåˆ™æœ‰å‚çš„æ„é€ æ–¹æ³•ä¸­çš„å‚æ•°çš„åå­—å¿…é¡»å’Œå±æ€§çš„åå­—ä¸€è‡´ã€‚ å®ç°æ–¹å¼1ï¼šæ— å‚æ„é€ æ–¹æ³•å®šä¹‰ä¸ºprivateã€‚ å®ç°æ–¹å¼2ï¼šå®ä½“ç±»ä¸­ä¸å®šä¹‰æ— å‚æ„é€ æ–¹æ³•ï¼Œåªå®šä¹‰æœ‰æ„ä¹‰çš„æœ‰å‚æ„é€ æ–¹æ³•ï¼Œä½†æ˜¯è¦æ±‚æ„é€ æ–¹æ³•ä¸­çš„å‚æ•°çš„åå­—å’Œå±æ€§çš„åå­—ä¸€è‡´ã€‚</p><p>å®ç°â€œä¸‰â€</p><p>ä¸å±äºå±æ€§çš„æˆå‘˜å˜é‡æ˜ å°„ä¸ºæ•°æ®åˆ—ã€‚ å®ç°ï¼š builder.Property(â€œæˆå‘˜å˜é‡åâ€)</p><p>å®ç°â€œå››â€</p><p>ä»æ•°æ®åˆ—ä¸­è¯»å–å€¼çš„åªè¯»å±æ€§ã€‚ EF Coreä¸­æä¾›äº†â€œæ”¯æŒå­—æ®µâ€ï¼ˆbacking fieldï¼‰æ¥æ”¯æŒè¿™ç§å†™æ³•ï¼šåœ¨é…ç½®å®ä½“ç±»çš„ä»£ç ä¸­ï¼Œä½¿ç”¨HasField(â€œæˆå‘˜å˜é‡åâ€)æ¥é…ç½®å±æ€§ã€‚</p><p>å®ç°â€œäº”â€</p><p>æœ‰çš„å±æ€§ä¸éœ€è¦æ˜ å°„åˆ°æ•°æ®åˆ—ï¼Œä»…åœ¨è¿è¡Œæ—¶è¢«ä½¿ç”¨ã€‚ å®ç°ï¼šä½¿ç”¨Ignore()æ¥é…ç½®å¿½ç•¥è¿™ä¸ªå±æ€§ã€‚</p><h1 id="EF-Coreä¸­å®ç°å……è¡€æ¨¡å‹"><a href="#EF-Coreä¸­å®ç°å……è¡€æ¨¡å‹" class="headerlink" title="EF Coreä¸­å®ç°å……è¡€æ¨¡å‹"></a>EF Coreä¸­å®ç°å……è¡€æ¨¡å‹</h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">User</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">init</span>; &#125; <span class="comment">//ç‰¹å¾ä¸€</span></span><br><span class="line">    <span class="keyword">public</span> DateTime CreatedDateTime &#123; <span class="keyword">get</span>; <span class="keyword">init</span>; &#125; <span class="comment">//ç‰¹å¾ä¸€</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> UserName &#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;<span class="comment">//ç‰¹å¾ä¸€</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Credit &#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span>? passwordHash;<span class="comment">//ç‰¹å¾ä¸‰</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span>? remark;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span>? Remark<span class="comment">//ç‰¹å¾å››</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123; <span class="keyword">return</span> remark; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span>? Tag &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;<span class="comment">//ç‰¹å¾äº”</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">User</span>()<span class="comment">//ç»™EFCoreä»æ•°æ®åº“ä¸­åŠ è½½æ•°æ®ç„¶åç”ŸæˆUserå¯¹è±¡è¿”å›ç”¨çš„</span></span></span><br><span class="line">    &#123;</span><br><span class="line">             <span class="comment">//ç‰¹å¾äºŒ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span>(<span class="params"><span class="built_in">string</span> yhm</span>)<span class="comment">//ç‰¹å¾äºŒ</span></span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.UserName = yhm;</span><br><span class="line">        <span class="keyword">this</span>.CreatedDateTime = DateTime.Now;</span><br><span class="line">        <span class="keyword">this</span>.Credit = <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ChangeUserName</span>(<span class="params"><span class="built_in">string</span> newValue</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.UserName = newValue;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ChangePasswordHash</span>(<span class="params"><span class="built_in">string</span> newValue</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (newValue.Length &gt; <span class="number">6</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;å¯†ç å¤ªçŸ­&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.passwordHash = HashHelper.ComputeMd5Hash(newValue);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é…ç½®Userå®ä½“ç±»</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">UserConfig</span> : <span class="title">IEntityTypeConfiguration</span>&lt;<span class="title">User</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">EntityTypeBuilder&lt;User&gt; builder</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        builder.Property(<span class="string">&quot;passwordHash&quot;</span>);<span class="comment">//ç‰¹å¾ä¸‰</span></span><br><span class="line">        builder.Property(u =&gt; u.Remark).HasField(<span class="string">&quot;remark&quot;</span>);<span class="comment">//ç‰¹å¾å››</span></span><br><span class="line">        builder.Ignore(u=&gt;u.Tag);<span class="comment">//ç‰¹å¾äº”</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é…ç½®EF Core</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">MyDbContext</span>:<span class="title">DbContext</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> DbSet&lt;User&gt; Users &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnConfiguring</span>(<span class="params">DbContextOptionsBuilder optionsBuilder</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">base</span>.OnConfiguring(optionsBuilder);</span><br><span class="line">        optionsBuilder.UseSqlServer(<span class="string">&quot;Server=localhost;Database=YourDatabaseName;Trusted_Connection=True;MultipleActiveResultSets=true;TrustServerCertificate=True;Encrypt=True;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnModelCreating</span>(<span class="params">ModelBuilder modelBuilder</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">base</span>.OnModelCreating(modelBuilder);</span><br><span class="line">        <span class="keyword">new</span> UserConfig().Configure(modelBuilder.Entity&lt;User&gt;());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> MyDbContext ctx = <span class="keyword">new</span> MyDbContext();</span><br><span class="line">User u1 = <span class="keyword">new</span> User(<span class="string">&quot;YOUXIANYU&quot;</span>);</span><br><span class="line">u1.Tag = <span class="string">&quot;MyTag&quot;</span>;</span><br><span class="line">u1.ChangePasswordHash(<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">ctx.Users.Add(u1);</span><br><span class="line">ctx.SaveChanges();</span><br></pre></td></tr></table></figure><p>å› ä¸ºUserç±»çš„æ— å‚æ„é€ æ–¹æ³•ä¸ºç§æœ‰çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½è°ƒç”¨è®¾å®šåˆå§‹ç”¨æˆ·åçš„æ„é€ æ–¹æ³•ï¼Œè¿™æ ·å°±ä¿è¯äº†å¯¹è±¡çš„åˆæ³•æ€§ã€‚ä¸Šé¢çš„ä»£ç ä¼šåœ¨æ•°æ®åº“ä¸­æ’å…¥ä¸€æ¡è®°å½•ï¼Œæˆ‘ä»¬ä¿®æ”¹æ•°æ®åº“ä¸­Remarkåˆ—çš„å€¼ä¸ºâ€œyouâ€,ç„¶åæ‰§è¡Œä»£ç ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> MyDbContext ctx = <span class="keyword">new</span> MyDbContext();</span><br><span class="line">User u1 = ctx.Users.First(u =&gt; u.UserName == <span class="string">&quot;YOUXIANYU&quot;</span>);</span><br><span class="line">Console.WriteLine(u1.Remark);</span><br></pre></td></tr></table></figure><p><img src="/img%5CDDD%5C3.png"></p>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> EF Core </tag>
            
            <tag> ASP.NET Core </tag>
            
            <tag> Entity Framework Core </tag>
            
            <tag> DDD </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>.NET Coreçš„DDDæ¶æ„</title>
      <link href="/2025/05/15/DDD/NET%20Core%E7%9A%84DDD/"/>
      <url>/2025/05/15/DDD/NET%20Core%E7%9A%84DDD/</url>
      
        <content type="html"><![CDATA[<h1 id="DDDçš„åŸºæœ¬æ¦‚å¿µ"><a href="#DDDçš„åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="DDDçš„åŸºæœ¬æ¦‚å¿µ"></a>DDDçš„åŸºæœ¬æ¦‚å¿µ</h1><h2 id="ä»€ä¹ˆæ˜¯å¾®æœåŠ¡"><a href="#ä»€ä¹ˆæ˜¯å¾®æœåŠ¡" class="headerlink" title="ä»€ä¹ˆæ˜¯å¾®æœåŠ¡"></a>ä»€ä¹ˆæ˜¯å¾®æœåŠ¡</h2><h3 id="å•ä½“ç»“æ„"><a href="#å•ä½“ç»“æ„" class="headerlink" title="å•ä½“ç»“æ„"></a>å•ä½“ç»“æ„</h3><p>ä¼ ç»Ÿçš„è½¯ä»¶é¡¹ç›®å¤§éƒ¨åˆ†éƒ½æ˜¯å•ä½“ç»“æ„ï¼Œä¹Ÿå°±æ˜¯é¡¹ç›®ä¸­çš„æ‰€æœ‰ä»£ç éƒ½æ”¾åˆ°åŒä¸€ä¸ªåº”ç”¨ç¨‹åºä¸­ï¼Œä¸€èˆ¬ä»–ä»¬ä¹Ÿéƒ½è¿è¡Œåœ¨åŒä¸€ä¸ªè¿›ç¨‹ä¸­ã€‚<br><img src="/img%5CDDD%5C1.png"></p><p>å•ä½“ç»“æ„çš„é¡¹ç›®æœ‰ç»“æ„ç®€å•ã€éƒ¨ç½²ç®€å•ç­‰ä¼˜ç‚¹ï¼Œä½†æ˜¯æœ‰å¦‚ä¸‹ç¼ºç‚¹ï¼š</p><ol><li>ä»£ç ä¹‹é—´è€¦åˆä¸¥é‡ï¼Œä»£ç çš„å¯ç»´æŠ¤æ€§ä½ã€‚</li><li>é¡¹ç›®åªèƒ½é‡‡ç”¨å•ä¸€çš„è¯­è¨€å’ŒæŠ€æœ¯æ ˆï¼Œç”šè‡³é‡‡ç”¨çš„å¼€å‘åŒ…çš„ç‰ˆæœ¬éƒ½å¿…é¡»ç»Ÿä¸€ã€‚</li><li>ä¸€ä¸ªæ¨¡å—çš„å´©æºƒå°±ä¼šå¯¼è‡´æ•´ä¸ªé¡¹ç›®çš„å´©æºƒã€‚</li><li>æˆ‘ä»¬åªèƒ½æ•´ä½“è¿›è¡ŒæœåŠ¡å™¨æ‰©å®¹ï¼Œæ— æ³•å¯¹å…¶ä¸­ä¸€ä¸ªæ¨¡å—è¿›è¡Œå•ç‹¬çš„æœåŠ¡å™¨æ‰©å®¹ã€‚</li><li>å½“éœ€è¦æ›´æ–°æŸä¸€ä¸ªåŠŸèƒ½æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æŠŠæ•´ä¸ªç³»ç»Ÿé‡æ–°éƒ¨ç½²ä¸€éï¼Œè¿™ä¼šå¯¼è‡´æ–°åŠŸèƒ½çš„ä¸Šçº¿æµç¨‹å˜é•¿ã€‚</li></ol><h3 id="å¾®æœåŠ¡æ¶æ„"><a href="#å¾®æœåŠ¡æ¶æ„" class="headerlink" title="å¾®æœåŠ¡æ¶æ„"></a>å¾®æœåŠ¡æ¶æ„</h3><p>å¾®æœåŠ¡æ¶æ„æŠŠé¡¹ç›®æ‹†åˆ†ä¸ºå¤šä¸ªåº”ç”¨ç¨‹åºï¼Œæ¯ä¸ªç¨‹åºå•ç‹¬æ„å»ºå’Œéƒ¨ç½²ã€‚<br><img src="/img%5CDDD%5C2.png"></p><p>å¾®æœåŠ¡æ¶æ„æœ‰å¦‚ä¸‹çš„ä¼˜ç‚¹ï¼š</p><ol><li>æ¯ä¸ªå¾®æœåŠ¡åªè´Ÿè´£ä¸€ä¸ªç‰¹å®šçš„ä¸šåŠ¡ï¼Œä¸šåŠ¡é€»è¾‘æ¸…æ™°ã€ä»£ç ç®€å•ï¼Œå¯¹äºå…¶ä»–å¾®æœåŠ¡çš„ä¾èµ–éå¸¸ä½ï¼Œå› æ­¤æ˜“äºå¼€å‘å’Œç»´æŠ¤ã€‚</li><li>ä¸åŒçš„å¾®æœåŠ¡å¯ä»¥ç”¨ä¸åŒçš„è¯­è¨€å’ŒæŠ€æœ¯æ ˆå¼€å‘ã€‚</li><li>ä¸€ä¸ªå¾®æœåŠ¡çš„è¿è¡Œä¸ä¼šå½±å“å…¶ä»–å¾®æœåŠ¡ã€‚</li><li>å¯ä»¥å¯¹ä¸€ä¸ªç‰¹å®šçš„å¾®æœåŠ¡è¿›è¡Œå•ç‹¬ç»´æŠ¤å¯å®¹ã€‚</li><li>å½“éœ€è¦æ›´æ–°æŸä¸ªåŠŸèƒ½çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªéœ€è¦é‡æ–°éƒ¨ç½²è¿™ä¸ªåŠŸèƒ½æ‰€åœ¨çš„å¾®æœåŠ¡å³å¯ï¼Œä¸éœ€è¦é‡æ–°éƒ¨ç½²æ•´ä¸ªç³»ç»Ÿã€‚</li></ol><p>å¾®æœåŠ¡æ¶æ„ç¼ºç‚¹ï¼š</p><ol><li>åœ¨å•ä½“ç»“æ„ä¸­ï¼Œè¿ç»´äººå‘˜åªéœ€è¦ä¿è¯ä¸€ä¸ªåº”ç”¨çš„æ­£å¸¸è¿è¡Œå³å¯ï¼Œè€Œåœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œè¿ç»´äººå‘˜éœ€è¦ä¿è¯å¤šåº”ç”¨çš„æ­£å¸¸è¿è¡Œï¼Œè¿™ç»™è¿ç»´äººå‘˜å¸¦æ¥æ›´å¤§çš„æŒ‘æˆ˜ã€‚</li><li>åœ¨å•ä½“ç»“æ„ä¸­ï¼Œå„æ¨¡å—ä¹‹é—´æ˜¯è¿›ç¨‹å†…è°ƒç”¨ï¼Œæ•°æ®äº¤äº’çš„æ•ˆç‡é«˜ï¼Œè€Œåœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œå’Œå¾®æœåŠ¡ä¹‹é—´è¦é€šè¿‡ç½‘ç»œè¿›è¡Œé€šä¿¡ï¼Œæ•°æ®äº¤äº’çš„æ•ˆç‡ä½ã€‚</li><li>åœ¨å•ä½“ç»“æ„ä¸­ï¼Œå„æ¨¡å—ä¹‹é—´çš„è°ƒç”¨éƒ½æ˜¯åœ¨è¿›ç¨‹å†…è¿›è¡Œçš„ï¼Œå®ç°å®¹é”™ã€äº‹åŠ¡ä¸€è‡´æ€§ç­‰æ¯”è¾ƒå®¹æ˜“ï¼Œè€Œåœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œå„å¾®æœåŠ¡ä¹‹é—´é€šè¿‡ç½‘ç»œé€šä¿¡ï¼Œå®ç°å®¹é”™ã€å®ç‰©ä¸€è‡´æ€§ç­‰éå¸¸å›°éš¾ã€‚</li></ol><h1 id="DDDä¹‹é¢†åŸŸæ¨¡å‹"><a href="#DDDä¹‹é¢†åŸŸæ¨¡å‹" class="headerlink" title="DDDä¹‹é¢†åŸŸæ¨¡å‹"></a>DDDä¹‹é¢†åŸŸæ¨¡å‹</h1><ol><li>é¢†åŸŸï¼ˆDomainï¼‰ï¼šä¸€ä¸ªç»„ç»‡åšçš„äº‹æƒ…ã€‚å­é¢†åŸŸã€‚</li><li>é¢†åŸŸçš„åˆ’åˆ†ï¼ˆä»¥æ‰‹æœºå…¬å¸ä¸ºä¾‹ï¼‰ï¼š<br>æ ¸å¿ƒåŸŸï¼šè§£å†³é¡¹ç›®çš„æ ¸å¿ƒé—®é¢˜ï¼Œå’Œç»„ç»‡ä¸šåŠ¡ç´§å¯†ç›¸å…³ã€‚<br>æ”¯æ’‘åŸŸï¼šè§£å†³é¡¹ç›®çš„éæ ¸å¿ƒé—®é¢˜ï¼Œåˆ™å…·æœ‰ç»„ç»‡ç‰¹æ€§ï¼Œä½†ä¸å…·æœ‰é€šç”¨æ€§ã€‚<br>é€šç”¨åŸŸï¼šè§£å†³é€šç”¨é—®é¢˜ï¼Œæ²¡æœ‰ç»„ç»‡ç‰¹æ€§ã€‚</li><li>é¢†åŸŸçš„ä¸åŒåˆ†ç±»å†³å®šäº†å…¬å¸çš„ç ”å‘é‡ç‚¹ã€‚</li></ol><p>é¢†åŸŸæ¨¡å‹ï¼ˆDomain Modelï¼‰</p><ol><li>å¯¹äºé¢†åŸŸå†…çš„å¯¹è±¡è¿›è¡Œå»ºæ¨¡ï¼Œä»è€ŒæŠ½è±¡å‡ºæ¥æ¨¡å‹ã€‚</li><li>æˆ‘ä»¬çš„é¡¹ç›®åº”è¯¥å¼€å§‹äºåˆ›å»ºé¢†åŸŸæ¨¡å‹ï¼Œè€Œä¸æ˜¯è€ƒè™‘å¦‚ä½•è®¾è®¡æ•°æ®åº“å’Œç¼–å†™ä»£ç ã€‚é€‚ç”¨é¢†åŸŸæ¨¡å‹ï¼Œæˆ‘ä»¬å¯ä»¥ä¸€ç›´ç”¨ä¸šåŠ¡è¯­è¨€å»æè¿°å’Œæ„å»ºç³»ç»Ÿï¼Œè€Œä¸æ˜¯ä½¿ç”¨æŠ€æœ¯äººå‘˜çš„è¯­è¨€ã€‚</li></ol><h1 id="å®ä½“ç±»ä¸å€¼å¯¹è±¡"><a href="#å®ä½“ç±»ä¸å€¼å¯¹è±¡" class="headerlink" title="å®ä½“ç±»ä¸å€¼å¯¹è±¡"></a>å®ä½“ç±»ä¸å€¼å¯¹è±¡</h1><p>å®ä½“ç±»</p><ol><li>â€œæ ‡è¯†ç¬¦â€ç”¨æ¥å”¯ä¸€å®šä½ä¸€ä¸ªå¯¹è±¡ï¼Œåœ¨æ•°æ®åº“ä¸­æˆ‘ä»¬ä¸€èˆ¬ç”¨è¡¨çš„ä¸»é”®æ¥å®ç°â€œæ ‡è¯†ç¬¦â€ã€‚ä¸»é”®å’Œæ ‡è¯†ç¬¦çš„æ€è€ƒè§’åº¦ä¸åŒã€‚</li><li>â€œå®ä½“â€æ‹¥æœ‰å”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼Œæ ‡è¯†ç¬¦çš„å€¼ä¸ä¼šæ”¹å˜ï¼Œè€Œå¯¹è±¡çš„å…¶ä»–çŠ¶æ€åˆ™ä¼šç»å†å„ç§å˜åŒ–ã€‚æ ‡å¿—ç¬¦ç”¨æ¥è·Ÿè¸ªå¯¹è±¡çŠ¶æ€å˜åŒ–ï¼Œä¸€ä¸ªå®ä½“çš„å¯¹è±¡æ— è®ºæ€æ ·å˜åŒ–ï¼Œæˆ‘ä»¬éƒ½èƒ½é€šè¿‡æ ‡è¯†ç¬¦å®šä½è¿™ä¸ªå¯¹è±¡ã€‚</li><li>æ˜¯ä»–ä¸€èˆ¬çš„è¡¨ç°å½¢å¼å°±æ˜¯EF Coreä¸­çš„å®ä½“ç±»ã€‚</li></ol><p>å€¼å¯¹è±¡</p><ol><li>å€¼å¯¹è±¡ï¼šæ²¡æœ‰æ ‡å¿—ç¬¦çš„å¯¹è±¡ï¼Œä¹Ÿæœ‰å¤šä¸ªå±æ€§ï¼Œä¾é™„äºæŸä¸ªå®ä½“ç±»å¯¹è±¡è€Œå­˜åœ¨ã€‚æ¯”å¦‚â€œå•†å®¶â€çš„åœ°ç†ä½ç½®ã€è¡£æœçš„RGBé¢œè‰²ã€‚</li><li>å®šä¹‰ä¸ºå€¼å¯¹è±¡å’Œæ™®é€šå±æ€§çš„åŒºåˆ«ï¼šä½“ç°æ•´ä½“å…³ç³»ã€‚</li></ol><h1 id="èšåˆå’Œèšåˆæ ¹"><a href="#èšåˆå’Œèšåˆæ ¹" class="headerlink" title="èšåˆå’Œèšåˆæ ¹"></a>èšåˆå’Œèšåˆæ ¹</h1><ol><li>èšåˆï¼ˆAggregateï¼‰</li></ol><p>å®šä¹‰ï¼šèšåˆæ˜¯ç”±å¤šä¸ªå…³è”å¯¹è±¡ç»„åˆè€Œæˆçš„ä¸€ä¸ªæ•´ä½“ï¼Œè¿™äº›å¯¹è±¡åœ¨ä¸šåŠ¡é€»è¾‘ä¸Šç›¸äº’ä¾èµ–ï¼Œå½¢æˆä¸€ä¸ªè¾¹ç•Œæ¸…æ™°çš„å•å…ƒã€‚</p><p>æ ¸å¿ƒç‰¹æ€§ï¼š</p><p>ä¸€è‡´æ€§è¾¹ç•Œï¼šåœ¨è¿›è¡Œæ•°æ®ä¿®æ”¹æ“ä½œæ—¶ï¼Œèšåˆè¦ä¿è¯å†…éƒ¨å¯¹è±¡çŠ¶æ€çš„ä¸€è‡´æ€§ã€‚<br>ä½œä¸ºä¸€ä¸ªæ•´ä½“è¿›è¡Œå¼•ç”¨ï¼šå¤–éƒ¨å¯¹è±¡åªèƒ½å¼•ç”¨èšåˆæ ¹ï¼Œè€Œä¸èƒ½ç›´æ¥å¼•ç”¨èšåˆå†…éƒ¨çš„å…¶ä»–æˆå‘˜ã€‚<br>ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼šèšåˆå†…éƒ¨å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸç”±èšåˆæ ¹ç»Ÿä¸€ç®¡ç†ã€‚<br>åº”ç”¨åœºæ™¯ï¼šå½“å¤„ç†å…·æœ‰å¤æ‚ä¸šåŠ¡è§„åˆ™çš„å®ä½“å…³ç³»æ—¶ï¼Œæ¯”å¦‚è®¢å•ä¸è®¢å•é¡¹ã€è´¦æˆ·ä¸äº¤æ˜“è®°å½•ç­‰åœºæ™¯ï¼Œå°±å¯ä»¥ä½¿ç”¨èšåˆã€‚</p><ol start="2"><li>èšåˆæ ¹ï¼ˆAggregate Rootï¼‰</li></ol><p>å®šä¹‰ï¼šèšåˆæ ¹æ˜¯èšåˆä¸­çš„æ ¸å¿ƒå®ä½“ï¼Œå®ƒæ˜¯å¤–éƒ¨è®¿é—®èšåˆçš„å”¯ä¸€å…¥å£ç‚¹ã€‚<br>æ ¸å¿ƒèŒè´£ï¼š</p><p>å°è£…å†…éƒ¨é€»è¾‘ï¼šèšåˆæ ¹è´Ÿè´£ç»´æŠ¤èšåˆå†…éƒ¨å¯¹è±¡ä¹‹é—´çš„ä¸šåŠ¡è§„åˆ™ã€‚<br>ä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼šåœ¨èšåˆå†…éƒ¨çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œèšåˆæ ¹è¦ç¡®ä¿è¿™ç§å˜åŒ–ç¬¦åˆä¸šåŠ¡è§„åˆ™ã€‚<br>ç®¡ç†ç”Ÿå‘½å‘¨æœŸï¼šèšåˆæ ¹è´Ÿè´£åˆ›å»ºã€åˆ é™¤èšåˆå†…éƒ¨çš„å¯¹è±¡ã€‚<br>åº”ç”¨åœºæ™¯ï¼šèšåˆæ ¹åœ¨é¢†åŸŸæœåŠ¡ä¸­ç»å¸¸è¢«ç”¨ä½œäº‹åŠ¡è¾¹ç•Œï¼Œåƒè®¢å•ç®¡ç†ã€åº“å­˜æ§åˆ¶ç­‰åœºæ™¯éƒ½ä¼šç”¨åˆ°ã€‚<br>3. äºŒè€…çš„å…³ç³»</p><p>èšåˆæ ¹æ˜¯èšåˆçš„ â€œä»£è¨€äººâ€ï¼Œå¤–éƒ¨å¯¹è±¡åªèƒ½é€šè¿‡èšåˆæ ¹æ¥ä¸èšåˆè¿›è¡Œäº¤äº’ï¼Œä¸èƒ½ç›´æ¥è®¿é—®èšåˆå†…éƒ¨çš„å…¶ä»–å¯¹è±¡ã€‚<br>èšåˆæ ¹è¦ç¡®ä¿èšåˆå†…éƒ¨çš„æ•°æ®åœ¨ä»»ä½•æ—¶å€™éƒ½æ»¡è¶³ä¸šåŠ¡è§„åˆ™ï¼Œä»¥æ­¤æ¥ç»´æŠ¤æ•°æ®çš„ä¸€è‡´æ€§ã€‚</p><ol start="4"><li>è®¾è®¡åŸåˆ™<br>æœ€å°å¼•ç”¨åŸåˆ™ï¼šè¦å°½é‡å‡å°‘èšåˆä¹‹é—´çš„å…³è”ï¼Œé¿å…å‡ºç°å¤æ‚çš„å¼•ç”¨ç½‘ç»œã€‚</li></ol><p>äº‹åŠ¡è¾¹ç•ŒåŸåˆ™ï¼šä¸€ä¸ªèšåˆåœ¨ä¸€æ¬¡äº‹åŠ¡ä¸­åªèƒ½è¢«ä¸€ä¸ªèšåˆæ ¹ä¿®æ”¹ã€‚</p><p>ä¸å˜æ€§åŸåˆ™ï¼šèšåˆæ ¹è¦ä¿è¯èšåˆå†…éƒ¨çš„ä¸šåŠ¡è§„åˆ™å§‹ç»ˆå¾—åˆ°éµå®ˆã€‚</p><h1 id="DDDé¢†åŸŸæœåŠ¡å’Œåº”ç”¨æœåŠ¡"><a href="#DDDé¢†åŸŸæœåŠ¡å’Œåº”ç”¨æœåŠ¡" class="headerlink" title="DDDé¢†åŸŸæœåŠ¡å’Œåº”ç”¨æœåŠ¡"></a>DDDé¢†åŸŸæœåŠ¡å’Œåº”ç”¨æœåŠ¡</h1><p>èšåˆæ ¹çš„å®ä½“ç±»ä¸­æ²¡æœ‰ä¸šåŠ¡é€»è¾‘ä»£ç ï¼Œåªæœ‰å¯¹è±¡çš„åˆ›å»ºã€å¯¹è±¡çš„åˆå§‹åŒ–ã€çŠ¶æ€ç®¡ç†ç­‰ä¸ä¸ªä½“ç›¸å…³çš„ä»£ç ã€‚å¯¹äºèšåˆå†…çš„ä¸šåŠ¡ä»£ç ï¼Œæˆ‘ä»¬ç¼–å†™é¢†åŸŸæœåŠ¡ï¼ˆdomain serviceï¼‰ï¼Œè€Œå¯¹äºè·¨èšåˆåä½œçš„é€»è¾‘ï¼Œæˆ‘ä»¬ç¼–å†™åº”ç”¨æœåŠ¡ï¼ˆapplication serviceï¼‰ã€‚åº”ç”¨æœåŠ¡åè°ƒå¤šä¸ªé¢†åŸŸæœåŠ¡æ¥å®Œæˆä¸€ä¸ªç”¨ä¾‹ã€‚</p><p>åœ¨DDDä¸­ï¼Œä¸€ä¸ªå…¸å‹çš„ç”¨ä¾‹çš„å¤„ç†æµç¨‹å¦‚ä¸‹ï¼š</p><ol><li>å‡†å¤‡ä¸šåŠ¡æ“ä½œæ‰€éœ€è¦çš„æ•°æ®ï¼Œä¸€èˆ¬æ˜¯ä»æ•°æ®åº“æˆ–è€…å…¶ä»–å¤–éƒ¨æ•°æ®æºè·å–æ•°æ®ã€‚</li><li>æ‰§è¡Œç”±ä¸€ä¸ªæˆ–å¤šä¸ªé¢†åŸŸæ¨¡å‹åšå‡ºçš„ä¸šåŠ¡æ“ä½œï¼Œè¿™äº›æ“ä½œä¼šä¿®æ”¹å®ä½“ç±»çš„çŠ¶æ€ï¼Œæˆ–è€…ç”Ÿæˆä¸€äº›æ“ä½œç»“æœã€‚</li><li>æŠŠå¯¹å®ä½“ç±»çš„æ”¹å˜æˆ–è€…æ“ä½œç»“æœåº”ç”¨ä¸å¤–éƒ¨ç³»ç»Ÿï¼Œæ¯”å¦‚ä¿å­˜å¯¹å®ä½“ç±»çš„ä¿®æ”¹åˆ°æ•°æ®åº“æˆ–è€…æŠŠè®¡ç®—ç»“æœé€šè¿‡çŸ­ä¿¡å‘é€ç»™ç”¨æˆ·ã€‚</li></ol><p>ä¸Šé¢çš„æ­¥éª¤ä¸­ï¼Œåªæœ‰ç¬¬ä¸€æ­¥å’Œç¬¬ä¸‰æ­¥æ¶‰åŠä¸å¤–éƒ¨ç³»ç»Ÿçš„äº¤äº’ï¼Œç¬¬äºŒæ­¥æ˜¯å¯¹é¢†åŸŸæ¨¡å‹çš„ä¸šåŠ¡é€»è¾‘æ“ä½œã€‚è¿™ä¸‰æ­¥ç»„æˆä¸€ä¸ªå…¸å‹çš„åº”ç”¨æœåŠ¡çš„é€»è¾‘ï¼Œè€Œè‹¥ä¸ªé¢†åŸŸæœåŠ¡è¢«ç¼–æ’å®Œæˆç¬¬äºŒæ­¥çš„å·¥ä½œã€‚é¢†åŸŸæ¨¡å‹ä¸å¤–éƒ¨ç³»ç»Ÿï¼ˆæ•°æ®åº“ã€ç¼“å­˜ç­‰ï¼‰æ˜¯éš”ç¦»çš„ï¼Œä¸ä¼šå‘ç”Ÿç›´æ¥äº¤äº’ï¼Œä¹Ÿå°±æ˜¯è¯´é¢†åŸŸæœåŠ¡ä¸ä¼šæ¶‰åŠè¯»å†™æ•°æ®åº“çš„æ“çºµã€‚è¿™æ ·æˆ‘ä»¬å¯ä»¥å¾ˆå¥½åœ°å®ç°è´£ä»»çš„åˆ’åˆ†ï¼šä¸šåŠ¡é€»è¾‘æ”¾å…¥é¢†åŸŸæœåŠ¡ï¼Œè€Œä¸å¤–éƒ¨ç³»ç»Ÿçš„äº¤äº’ç”±åº”ç”¨æœåŠ¡æ¥è´Ÿè´£ã€‚å› ä¸ºé¢†åŸŸæœåŠ¡æ˜¯ç”¨æ¥åè°ƒé¢†åŸŸå¯¹è±¡å®Œæˆä¸šåŠ¡é€»è¾‘æ“ä½œçš„ï¼Œæ‰€ä»¥é¢†åŸŸæœåŠ¡æ˜¯æ— çŠ¶æ€çš„ï¼ŒçŠ¶æ€ç”±é¢†åŸŸå¯¹è±¡æ¥ç®¡ç†ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé¢†åŸŸæœåŠ¡ä¸æ˜¯å¿…éœ€çš„ï¼Œåœ¨ä¸€äº›ç®€å•çš„ä¸šåŠ¡å¤„ç†ï¼ˆæ¯”å¦‚å¢ã€åˆ ã€æ”¹ã€æŸ¥ï¼‰ä¸­æ˜¯æ²¡æœ‰é¢†åŸŸçŸ¥è¯†ï¼ˆä¹Ÿå°±æ˜¯ä¸šåŠ¡é€»è¾‘ï¼‰çš„ï¼Œè¿™ç§æƒ…å†µä¸‹åº”ç”¨æœåŠ¡å¯ä»¥å®Œæˆæ‰€æœ‰æ“ä½œï¼Œä¸éœ€è¦å¼•å…¥é¢†åŸŸæœåŠ¡ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥é¿å…ç³»ç»Ÿå‡ºç°è¿‡åº¦è®¾è®¡çš„é—®é¢˜ã€‚å¦‚æœéšç€ç³»ç»Ÿçš„è¿›åŒ–ï¼Œåº”ç”¨æœåŠ¡ä¸­å‡ºç°äº†ä¸šåŠ¡é€»è¾‘ï¼Œæˆ‘ä»¬å°±è¦æŠŠä¸šåŠ¡é€»è¾‘æ”¾å…¥é¢†åŸŸæœåŠ¡ã€‚</p><p>å’Œèšåˆç›¸å…³çš„ä¸¤ä¸ªæ¦‚å¿µæ˜¯â€œä»“å‚¨â€ï¼ˆrepositoryï¼‰å’Œâ€œå·¥ä½œå•å…ƒâ€ï¼ˆunit of workï¼‰ã€‚èšåˆä¸­çš„å®ä½“ç±»ä¸è´Ÿè´£æ•°æ®åº“è¯»å–å’Œä¿å­˜ï¼Œè¿™äº›å·¥ä½œæ˜¯æœ‰ä»“åº“å‚¨è´Ÿè´£çš„å› æ­¤å®ä½“ç±»è´Ÿè´£ä¸šåŠ¡é€»è¾‘çš„å¤„ç†ï¼Œä»“å‚¨è´Ÿè´£æŒ‰ç…§è¦æ±‚ä»æ•°æ®åº“ä¸­è¯»å–æ•°æ®å·²åŠæŠŠé¢†åŸŸæœåŠ¡ä¿®æ”¹çš„æ•°æ®ä¿å­˜å›æ•°æ®åº“ï¼Œä¸€ä¸ªèšåˆå¯¹åº”ä¸€ä¸ªç”¨æ¥å®ç°æ•°æ®æŒä¹…åŒ–çš„ä»“å‚¨ã€‚èšåˆå†…æ•°æ®æ“ä½œçš„å…³ç³»æ˜¯éå¸¸ç´§å¯†çš„ï¼Œæˆ‘ä»¬è¦ä¿è¯äº‹åŠ¡çš„å¼ºä¸€è‡´æ€§ï¼Œè€Œèšåˆé—´çš„åä½œæ˜¯å…³ç³»ä¸ç´§å¯†çš„ï¼Œå› æ­¤æˆ‘ä»¬åªè¦ä¿è¯äº‹åŠ¡çš„æœ€ç»ˆä¸€è‡´æ€§å³å¯ã€‚èšåˆå†…çš„è‹¥å¹²ç›¸å…³è”çš„æ“ä½œç»„æˆä¸€ä¸ªâ€œå·¥ä½œå•å…ƒâ€ï¼Œè¿™äº›å·¥ä½œå•å…ƒè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ã€‚<br>å› ä¸ºé¢†åŸŸæœåŠ¡ä¸ä¾èµ–å¤–éƒ¨ç³»ç»Ÿã€ä¸ä¿å­˜çŠ¶æ€ï¼Œæ‰€ä»¥é¢†åŸŸæœåŠ¡æ¯”åº”ç”¨æœåŠ¡æ›´å®¹æ˜“è¿›è¡Œå•å…ƒæµ‹è¯•ï¼Œè¿™å¯¹äºæé«˜ç³»ç»Ÿçš„è´¨é‡æ˜¯éå¸¸æœ‰å¸®åŠ©çš„ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ASP.NET Core </tag>
            
            <tag> Entity Framework Core </tag>
            
            <tag> DDD </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ASP.NET Coreç¨‹åºçš„å‘å¸ƒ</title>
      <link href="/2025/05/13/asp.net%20core/ASP.NET%20Core%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%8F%91%E5%B8%83/"/>
      <url>/2025/05/13/asp.net%20core/ASP.NET%20Core%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%8F%91%E5%B8%83/</url>
      
        <content type="html"><![CDATA[<h1 id="ç½‘ç«™å‘å¸ƒ"><a href="#ç½‘ç«™å‘å¸ƒ" class="headerlink" title="ç½‘ç«™å‘å¸ƒ"></a>ç½‘ç«™å‘å¸ƒ</h1><ol><li>ä¸èƒ½ç›´æ¥æŠŠbin&#x2F;Debugéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒçš„æœåŠ¡å™¨ä¸Šï¼Œæ€§èƒ½ä½ã€‚åº”è¯¥åˆ›å»ºç½‘ç«™çš„å‘å¸ƒç‰ˆï¼Œç”¨ã€å‘å¸ƒã€‘åŠŸèƒ½ã€‚</li><li>ä¸¤ç§éƒ¨ç½²æ¨¡å¼ï¼šâ€œæ¡†æ¶ä¾èµ–â€å’Œâ€œç‹¬ç«‹â€ã€‚ä¸¤è€…çš„ä¼˜ç¼ºç‚¹ã€‚</li><li>ç‹¬ç«‹æ¨¡å¼ä¸ºä»€ä¹ˆè¦é€‰ç›®æ ‡æ“ä½œç³»ç»Ÿå’ŒCUPç±»å‹ã€‚</li></ol><h3 id="å¦‚æœä½ ä½¿ç”¨-Visual-Studioï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ­¥éª¤å‘å¸ƒï¼š"><a href="#å¦‚æœä½ ä½¿ç”¨-Visual-Studioï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ­¥éª¤å‘å¸ƒï¼š" class="headerlink" title="å¦‚æœä½ ä½¿ç”¨ Visual Studioï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ­¥éª¤å‘å¸ƒï¼š"></a>å¦‚æœä½ ä½¿ç”¨ Visual Studioï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ­¥éª¤å‘å¸ƒï¼š</h3><ol><li><p>åœ¨è§£å†³æ–¹æ¡ˆèµ„æºç®¡ç†å™¨ä¸­å³é”®ç‚¹å‡»é¡¹ç›®</p></li><li><p>é€‰æ‹© â€œå‘å¸ƒâ€<br><img src="/img%5CWEBAPI%5C33.png"></p></li><li><p>é€‰æ‹©å‘å¸ƒç›®æ ‡ï¼ˆæ–‡ä»¶å¤¹ã€IISã€Azure ç­‰ï¼‰æˆ‘ä»¬è¿™é‡Œé€‰æ‹©ä½¿ç”¨æ–‡ä»¶å¤¹çš„æ–¹å¼å‘å¸ƒã€‚<br><img src="/img%5CWEBAPI%5C34.png"></p></li><li><p>é…ç½®å‘å¸ƒè®¾ç½®ï¼ˆå¦‚ç›®æ ‡æ¡†æ¶ã€è¿è¡Œæ—¶ã€æ˜¯å¦è‡ªåŒ…å«ç­‰ï¼‰<br><img src="/img%5CWEBAPI%5C35.png"><br><img src="/img%5CWEBAPI%5C36.png"></p></li></ol><p>ç‚¹å‡» â€œå‘å¸ƒâ€ æŒ‰é’®</p><h2 id="æ¡†æ¶ä¾èµ–éƒ¨ç½²ï¼ˆFDDï¼‰"><a href="#æ¡†æ¶ä¾èµ–éƒ¨ç½²ï¼ˆFDDï¼‰" class="headerlink" title="æ¡†æ¶ä¾èµ–éƒ¨ç½²ï¼ˆFDDï¼‰"></a>æ¡†æ¶ä¾èµ–éƒ¨ç½²ï¼ˆFDDï¼‰</h2><p>ç‰¹ç‚¹</p><p>ä¾èµ–å…±äº«è¿è¡Œæ—¶ï¼šåº”ç”¨ç¨‹åºä¾èµ–ç›®æ ‡ç¯å¢ƒä¸­å·²å®‰è£…çš„ .NET è¿è¡Œæ—¶ï¼ˆå¦‚ .NET 6&#x2F;7&#x2F;8ï¼‰ã€‚</p><p>ä½“ç§¯å°ï¼šå‘å¸ƒåŒ…ä»…åŒ…å«åº”ç”¨ä»£ç å’Œç¬¬ä¸‰æ–¹ä¾èµ–ï¼ˆå¦‚ NuGet åŒ…ï¼‰ï¼Œä¸åŒ…å« .NET è¿è¡Œæ—¶ï¼Œå› æ­¤åŒ…ä½“ç§¯å°ã€‚</p><p>è·¨å¹³å°å…¼å®¹æ€§ï¼šå‘å¸ƒåŒ…ä¸åŒ…å«è¿è¡Œæ—¶ï¼Œéœ€ç¡®ä¿ç›®æ ‡ç¯å¢ƒçš„è¿è¡Œæ—¶ç‰ˆæœ¬ä¸å¼€å‘ç¯å¢ƒå…¼å®¹ã€‚</p><p>æ›´æ–°ä¾¿æ·ï¼š.NET è¿è¡Œæ—¶ç”±æ“ä½œç³»ç»Ÿæˆ–ç®¡ç†å‘˜ç»Ÿä¸€æ›´æ–°ï¼Œåº”ç”¨æ— éœ€åŒ…å«è¿è¡Œæ—¶æ›´æ–°ã€‚</p><p>é€‚ç”¨åœºæ™¯</p><p>ç›®æ ‡ç¯å¢ƒå·²é¢„è£… .NET è¿è¡Œæ—¶ï¼ˆå¦‚æœåŠ¡å™¨ã€å¼€å‘æœºï¼‰ã€‚</p><p>éœ€è¦é¢‘ç¹æ›´æ–°åº”ç”¨ï¼Œå¸Œæœ›å‡å°å‘å¸ƒåŒ…ä½“ç§¯ã€‚<br>å¤šåº”ç”¨å…±äº«åŒä¸€è¿è¡Œæ—¶ï¼ŒèŠ‚çœç³»ç»Ÿèµ„æºã€‚</p><h2 id="ç‹¬ç«‹éƒ¨ç½²ï¼ˆSCDï¼‰"><a href="#ç‹¬ç«‹éƒ¨ç½²ï¼ˆSCDï¼‰" class="headerlink" title="ç‹¬ç«‹éƒ¨ç½²ï¼ˆSCDï¼‰"></a>ç‹¬ç«‹éƒ¨ç½²ï¼ˆSCDï¼‰</h2><p>ç‰¹ç‚¹</p><p>åŒ…å«å®Œæ•´è¿è¡Œæ—¶ï¼šåº”ç”¨ç¨‹åºåŒ…åŒ…å« .NET è¿è¡Œæ—¶ã€æ¡†æ¶åº“å’Œåº”ç”¨ä»£ç ï¼Œä¸ä¾èµ–ç›®æ ‡ç¯å¢ƒçš„è¿è¡Œæ—¶ã€‚</p><p>ä½“ç§¯å¤§ï¼šå‘å¸ƒåŒ…åŒ…å«å®Œæ•´çš„è¿è¡Œæ—¶ï¼Œä½“ç§¯æ˜¾è‘—å¢å¤§ï¼ˆé€šå¸¸å‡ ååˆ°ä¸Šç™¾ MBï¼‰ã€‚</p><p>ç‰ˆæœ¬éš”ç¦»ï¼šä¸åŒåº”ç”¨å¯ä½¿ç”¨ä¸åŒç‰ˆæœ¬çš„è¿è¡Œæ—¶ï¼Œäº’ä¸å¹²æ‰°ã€‚</p><p>æ— éœ€é¢„å®‰è£…è¿è¡Œæ—¶ï¼šå¯ç›´æ¥åœ¨æœªå®‰è£… .NET çš„ç¯å¢ƒä¸­è¿è¡Œï¼ˆå¦‚å®¢æˆ·æœºã€æ— ç®¡ç†å‘˜æƒé™çš„æœåŠ¡å™¨ï¼‰ã€‚</p><p>é€‚ç”¨åœºæ™¯</p><p>ç›®æ ‡ç¯å¢ƒæ— æ³•å®‰è£…æˆ–ç®¡ç† .NET è¿è¡Œæ—¶ï¼ˆå¦‚å®¢æˆ·æœºã€å…±äº«ä¸»æœºï¼‰ã€‚</p><p>éœ€è¦ç¡®ä¿åº”ç”¨ä½¿ç”¨ç‰¹å®šç‰ˆæœ¬çš„è¿è¡Œæ—¶ï¼Œé¿å…ç‰ˆæœ¬å†²çªã€‚</p><p>åº”ç”¨éœ€è¦åœ¨ä¸åŒç‰ˆæœ¬çš„è¿è¡Œæ—¶ç¯å¢ƒä¸­ä¿æŒä¸€è‡´æ€§ã€‚</p><h1 id="ç½‘ç«™çš„è¿è¡Œ"><a href="#ç½‘ç«™çš„è¿è¡Œ" class="headerlink" title="ç½‘ç«™çš„è¿è¡Œ"></a>ç½‘ç«™çš„è¿è¡Œ</h1><ol><li>åœ¨Windowsï¼ˆSandBoxï¼‰å’ŒLinuxï¼ˆVMWare Playerï¼‰é‡Œåˆ†åˆ«è¿è¡Œç½‘ç«™ã€‚</li><li>å¦‚ä½•åœ¨ç”Ÿäº§æœåŠ¡å™¨ä¸­éƒ¨ç½².NET Coreç½‘ç«™ã€‚å°½ç®¡Kestrelå·²ç»å¼ºå¤§åˆ°è¶³ä»¥ä½œä¸ºä¸€ä¸ªç‹¬ç«‹WebæœåŠ¡å™¨è¢«ä½¿ç”¨äº†ï¼Œä½†æ˜¯ä¸€èˆ¬ä»ç„¶ä¸ä¼šè®©Kestrelç›´æ¥é¢å¯¹ç»ˆç«¯ç”¨æˆ·çš„è¯·æ±‚ã€‚é…ç½®åŸŸåè¯ä¹¦ã€è®°å½•è¯·æ±‚æ—¥å¿—ã€Urlé‡å†™ç­‰ç”±åå‘ä»£ç†æœåŠ¡å™¨è´Ÿè´£ã€‚</li><li>å¤šç§éƒ¨ç½²æ¨¡å¼ï¼šK8S+å®¹å™¨ï¼ˆæ¨èï¼Œéš¾åº¦é«˜ï¼‰ï¼›Linux+Nginxï¼›äº‘å¹³å°ï¼›windows+IISï¼›</li></ol><h1 id="ç½‘ç«™å®‰å…¨æé†’"><a href="#ç½‘ç«™å®‰å…¨æé†’" class="headerlink" title="ç½‘ç«™å®‰å…¨æé†’"></a>ç½‘ç«™å®‰å…¨æé†’</h1><ol><li>å¯ç”¨httpsã€‚</li><li>å¦‚æœè¿ç»´äººå‘˜éœ€è¦é€šè¿‡è¿œç¨‹æ¡Œé¢æˆ–è€…SSHè¿æ¥åˆ°æœåŠ¡å™¨ï¼Œé‚£ä¹ˆä¸€å®šè¦åœ¨æœåŠ¡å™¨çš„é˜²ç«å¢™è®¾ç½®åªå…è®¸è¿ç»´äººå‘˜çš„IPæ®µè®¿é—®ç›¸å…³ç«¯å£ã€‚</li><li>ä¸¥æ ¼åŒºåˆ†å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒã€‚</li><li>ä¸è¦ç›¸ä¿¡å®¢æˆ·ç«¯è¯·æ±‚ã€‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ASP.NET Core </tag>
            
            <tag> Entity Framework Core </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SignaLRæ¡ˆä¾‹ï¼šå¯¼å…¥è‹±æ±‰è¯å…¸</title>
      <link href="/2025/05/12/asp.net%20core/SignalR%E6%A1%88%E4%BE%8B/"/>
      <url>/2025/05/12/asp.net%20core/SignalR%E6%A1%88%E4%BE%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="SignaLRæ¡ˆä¾‹ï¼šå¯¼å…¥è‹±æ±‰è¯å…¸"><a href="#SignaLRæ¡ˆä¾‹ï¼šå¯¼å…¥è‹±æ±‰è¯å…¸" class="headerlink" title="SignaLRæ¡ˆä¾‹ï¼šå¯¼å…¥è‹±æ±‰è¯å…¸"></a>SignaLRæ¡ˆä¾‹ï¼šå¯¼å…¥è‹±æ±‰è¯å…¸</h1><p><b>éœ€æ±‚</b></p><ol><li>è‹±æ±‰è¯å…¸ECDICTä¸­å¯¼å…¥å•è¯åˆ°æ•°æ®åº“ã€‚</li><li>T_Worditemsï¼šIdï¼ˆä¸»é”®ï¼‰ã€Wordï¼ˆå•è¯ï¼‰ã€Phoneticï¼ˆéŸ³æ ‡ï¼‰ã€Definitionï¼ˆè‹±æ–‡è§£é‡Šï¼‰ã€Translationï¼ˆä¸­æ–‡ç¿»è¯‘ï¼‰</li></ol><p><img src="/img%5CWEBAPI%5C32.png"><br>ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/skywind3000/ECDICT">https://github.com/skywind3000/ECDICT</a></p><p>CSVï¼ˆComma-Separated Valuesï¼‰æ˜¯ä¸€ç§å¸¸ç”¨çš„æ–‡æœ¬æ–‡ä»¶æ ¼å¼ï¼Œç”¨äºå­˜å‚¨å’Œäº¤æ¢è¡¨æ ¼æ•°æ®ã€‚ä»¥ä¸‹æ˜¯å…³äº CSV æ ¼å¼çš„è¯¦ç»†ä»‹ç»ï¼š</p><p>ç‰¹ç‚¹</p><p>ç®€å•æ€§ï¼šCSV æ ¼å¼éå¸¸ç®€å•ï¼Œå®ƒä»¥çº¯æ–‡æœ¬å½¢å¼å­˜å‚¨æ•°æ®ï¼Œæ¯è¡Œä»£è¡¨ä¸€æ¡è®°å½•ï¼Œå­—æ®µä¹‹é—´ç”¨é€—å·åˆ†éš”ã€‚è¿™ç§ç®€å•çš„ç»“æ„ä½¿å¾— CSV æ–‡ä»¶æ˜“äºé˜…è¯»ã€ç¼–å†™å’Œè§£æï¼Œå‡ ä¹æ‰€æœ‰çš„æ–‡æœ¬ç¼–è¾‘å™¨å’Œç”µå­è¡¨æ ¼è½¯ä»¶éƒ½èƒ½å¤„ç† CSV æ–‡ä»¶ã€‚<br>é€šç”¨æ€§ï¼šCSV æ˜¯ä¸€ç§é€šç”¨çš„æ ¼å¼ï¼Œå¯è¢«å¤šç§åº”ç”¨ç¨‹åºè¯†åˆ«å’Œå¯¼å…¥ï¼Œå¦‚ç”µå­è¡¨æ ¼è½¯ä»¶ï¼ˆå¦‚ Microsoft Excelã€Google Sheetsï¼‰ã€æ•°æ®åº“ç®¡ç†ç³»ç»Ÿã€æ•°æ®åˆ†æå·¥å…·ç­‰ã€‚è¿™ä½¿å¾—å®ƒæˆä¸ºä¸åŒç³»ç»Ÿä¹‹é—´æ•°æ®äº¤æ¢çš„å¸¸ç”¨æ ¼å¼ã€‚</p><p>æ•°æ®è¡¨ç¤º</p><p>è®°å½•ï¼šCSV æ–‡ä»¶ä¸­çš„æ¯ä¸€è¡Œéƒ½æ˜¯ä¸€æ¡è®°å½•ï¼Œä»£è¡¨ä¸€ä¸ªæ•°æ®å®ä½“ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªå­¦ç”Ÿä¿¡æ¯è¡¨ä¸­ï¼Œæ¯ä¸€è¡Œå¯èƒ½ä»£è¡¨ä¸€ä¸ªå­¦ç”Ÿçš„ä¿¡æ¯ã€‚<br>å­—æ®µï¼šæ¯è¡Œä¸­çš„å­—æ®µç”¨é€—å·åˆ†éš”ã€‚ä¾‹å¦‚ï¼Œåœ¨å­¦ç”Ÿä¿¡æ¯è¡¨ä¸­ï¼Œå¯èƒ½æœ‰å§“åã€å¹´é¾„ã€æ€§åˆ«ã€æˆç»©ç­‰å­—æ®µï¼Œå®ƒä»¬ä¹‹é—´ç”¨é€—å·éš”å¼€ã€‚å¦‚æœå­—æ®µå€¼æœ¬èº«åŒ…å«é€—å·æˆ–å…¶ä»–ç‰¹æ®Šå­—ç¬¦ï¼Œé€šå¸¸ä¼šç”¨åŒå¼•å·å°†å­—æ®µå€¼æ‹¬èµ·æ¥ã€‚</p><p>ç¤ºä¾‹</p><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ CSV æ–‡ä»¶ç¤ºä¾‹ï¼ŒåŒ…å«äº†ä¸‰ä¸ªå­¦ç”Ÿçš„ä¿¡æ¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å§“å,å¹´é¾„,æ€§åˆ«,æˆç»©</span><br><span class="line">å¼ ä¸‰,20,ç”·,85</span><br><span class="line">æå››,21,å¥³,90</span><br><span class="line">ç‹äº”,20,ç”·,88</span><br></pre></td></tr></table></figure><p>åº”ç”¨åœºæ™¯</p><p>æ•°æ®å¯¼å‡ºå’Œå¯¼å…¥ï¼šå¸¸ç”¨äºä»æ•°æ®åº“ä¸­å¯¼å‡ºæ•°æ®æˆ–å°†æ•°æ®å¯¼å…¥åˆ°æ•°æ®åº“ä¸­ã€‚ä¹Ÿå¯ç”¨äºåœ¨ä¸åŒçš„è½¯ä»¶åº”ç”¨ç¨‹åºä¹‹é—´äº¤æ¢æ•°æ®ï¼Œä¾‹å¦‚å°†ç”µå­è¡¨æ ¼ä¸­çš„æ•°æ®åˆ†äº«ç»™å…¶ä»–ç”¨æˆ·æˆ–å¯¼å…¥åˆ°æ•°æ®åˆ†æå·¥å…·ä¸­è¿›è¡Œå¤„ç†ã€‚<br>æ•°æ®å­˜å‚¨ï¼šå¯¹äºä¸€äº›ç®€å•çš„æ•°æ®é›†ï¼ŒCSV æ ¼å¼æ˜¯ä¸€ç§æ–¹ä¾¿çš„å­˜å‚¨æ–¹å¼ã€‚å®ƒå ç”¨çš„ç©ºé—´ç›¸å¯¹è¾ƒå°ï¼Œä¸”æ˜“äºç®¡ç†å’Œå¤‡ä»½ã€‚</p><p>æ—¥å¿—è®°å½•ï¼šä¸€äº›åº”ç”¨ç¨‹åºä¼šå°†æ—¥å¿—ä¿¡æ¯ä»¥ CSV æ ¼å¼ä¿å­˜ï¼Œä»¥ä¾¿åç»­åˆ†æå’Œå¤„ç†ã€‚ä¾‹å¦‚ï¼Œç½‘ç«™æœåŠ¡å™¨å¯èƒ½ä¼šå°†è®¿é—®æ—¥å¿—è®°å½•ä¸º CSV æ–‡ä»¶ï¼ŒåŒ…å«è®¿é—®æ—¶é—´ã€è®¿é—®è€… IP åœ°å€ã€è¯·æ±‚é¡µé¢ç­‰ä¿¡æ¯ã€‚</p><h2 id="å¼€å§‹"><a href="#å¼€å§‹" class="headerlink" title="å¼€å§‹"></a>å¼€å§‹</h2><blockquote><ol><li>ImportExectorä¸­æ³¨å…¥IHubContext&lt;ImportDictHub&gt;ç­‰æœåŠ¡ã€‚</li><li>æš‚æ—¶ç”¨å­—ç¬¦ä¸²Splitè§£æCSVï¼Œæˆ–è€…ç”¨æ›´ä¸“ä¸šçš„åº“ã€‚</li><li>ç”¨SqlBulkCopyè¿›è¡Œåˆ†æ‰¹å¿«é€Ÿå¯¼å…¥ã€‚</li></ol></blockquote><p><b>ç¬¬ä¸€æ­¥ï¼Œåˆ›å»ºASP.NET Core Web APIã€‚åˆ›å»ºä¸€ä¸ªæ‰§è¡Œæ•°æ®å¯¼å…¥çš„ç±»ImportExeccutor</b></p><blockquote><p>é€šè¿‡connectionIdæ¥é€šçŸ¥å‰ç«¯ä¼ è¾“çš„è¿›åº¦ã€‚</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ImportExecutor</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//IHubContext&lt;ImportDictHub&gt;ï¼šç”¨äºä¸å®¢æˆ·ç«¯å®æ—¶é€šä¿¡ï¼Œæ›´æ–°å¯¼å…¥è¿›åº¦</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> IHubContext&lt;ImportDictHub&gt; hubContext;</span><br><span class="line">        <span class="comment">//ILogger&lt;ImportExecutor&gt;ï¼šè®°å½•æ—¥å¿—ï¼Œä¾¿äºè°ƒè¯•å’Œç›‘æ§</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> ILogger&lt;ImportExecutor&gt; logger;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">ImportExecutor</span>(<span class="params">IHubContext&lt;ImportDictHub&gt; hubContext, ILogger&lt;ImportExecutor&gt; logger</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.hubContext = hubContext;</span><br><span class="line">            <span class="keyword">this</span>.logger = logger;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">ExecuteAsync</span>(<span class="params"><span class="built_in">string</span> connectionId</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//å¼‚æ­¥è¯»å– CSV æ–‡ä»¶çš„æ‰€æœ‰è¡Œ</span></span><br><span class="line">            <span class="built_in">string</span>[] lines = <span class="keyword">await</span> File.ReadAllLinesAsync(<span class="string">@&quot;E:\temp\stardict.csv&quot;</span>);</span><br><span class="line">            <span class="built_in">int</span> totalCount = lines.Length - <span class="number">1</span>;<span class="comment">//æ€»è¡Œæ•°ï¼šè·³è¿‡è¡¨å¤´</span></span><br><span class="line">            <span class="comment">//ç¡¬ç¼–ç ï¼Œè¿æ¥æ•°æ®åº“</span></span><br><span class="line">            <span class="built_in">string</span> connStr = <span class="string">&quot;Server=localhost;Database=T_youxianyu;Trusted_Connection=True;MultipleActiveResultSets=true;TrustServerCertificate=True;Encrypt=True;&quot;</span>;</span><br><span class="line">            <span class="comment">//SqlBulkCopyï¼šé«˜æ•ˆåœ°å°†å¤§é‡æ•°æ®æ‰¹é‡æ’å…¥ SQL Serve</span></span><br><span class="line">            <span class="keyword">using</span> SqlBulkCopy bulkCopy = <span class="keyword">new</span> SqlBulkCopy(connStr);</span><br><span class="line">            <span class="comment">//åˆ—æ˜ å°„ï¼šå°† CSV åˆ—æ˜ å°„åˆ°æ•°æ®åº“è¡¨çš„åˆ—</span></span><br><span class="line">            bulkCopy.DestinationTableName = <span class="string">&quot;T_Worditems&quot;</span>;</span><br><span class="line">            bulkCopy.ColumnMappings.Add(<span class="string">&quot;Word&quot;</span>, <span class="string">&quot;Word&quot;</span>);</span><br><span class="line">            bulkCopy.ColumnMappings.Add(<span class="string">&quot;Phonetic&quot;</span>, <span class="string">&quot;Phonetic&quot;</span>);</span><br><span class="line">            bulkCopy.ColumnMappings.Add(<span class="string">&quot;Definition&quot;</span>, <span class="string">&quot;Definition&quot;</span>);</span><br><span class="line">            bulkCopy.ColumnMappings.Add(<span class="string">&quot;Translation&quot;</span>, <span class="string">&quot;Translation&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="built_in">int</span> counter = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">//DataTableï¼šä¸´æ—¶å­˜å‚¨ CSV æ•°æ®ï¼Œç”¨äºæ‰¹é‡å¯¼å…¥</span></span><br><span class="line">            <span class="keyword">using</span> DataTable dataTable = <span class="keyword">new</span> DataTable();</span><br><span class="line">            dataTable.Columns.Add(<span class="string">&quot;Word&quot;</span>);</span><br><span class="line">            dataTable.Columns.Add(<span class="string">&quot;Phonetic&quot;</span>);</span><br><span class="line">            dataTable.Columns.Add(<span class="string">&quot;Definition&quot;</span>);</span><br><span class="line">            dataTable.Columns.Add(<span class="string">&quot;Translation&quot;</span>);</span><br><span class="line">            <span class="keyword">foreach</span>(<span class="keyword">var</span> line <span class="keyword">in</span> lines)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">string</span>[] str = line.Split(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">                <span class="comment">//æ•°æ®éªŒè¯ï¼šæ£€æŸ¥æ¯è¡Œæ˜¯å¦åŒ…å«è¶³å¤Ÿçš„å­—æ®µ</span></span><br><span class="line">                <span class="built_in">string</span> word = str[<span class="number">0</span>];</span><br><span class="line">                <span class="built_in">string</span>? phonetic = str[<span class="number">1</span>];</span><br><span class="line">                <span class="built_in">string</span>? definition = str[<span class="number">2</span>];</span><br><span class="line">                <span class="built_in">string</span>? translation = str[<span class="number">3</span>];</span><br><span class="line">                <span class="comment">//åˆ›å»º DataRowï¼šå°† CSV æ•°æ®è½¬æ¢ä¸º DataTable çš„è¡Œ</span></span><br><span class="line">                DataRow row = dataTable.NewRow();</span><br><span class="line">                row[<span class="string">&quot;Word&quot;</span>] = word;</span><br><span class="line">                row[<span class="string">&quot;Phonetic&quot;</span>] = phonetic;</span><br><span class="line">                row[<span class="string">&quot;Definition&quot;</span>] = definition;</span><br><span class="line">                row[<span class="string">&quot;Translation&quot;</span>] = translation;</span><br><span class="line">                dataTable.Rows.Add(row);</span><br><span class="line">                counter++;</span><br><span class="line">                Console.WriteLine(<span class="string">$&quot;å·²åŠ è½½<span class="subst">&#123;counter&#125;</span>&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span>(dataTable.Rows.Count == <span class="number">100</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">await</span> bulkCopy.WriteToServerAsync(dataTable);</span><br><span class="line">                    <span class="comment">//æ‰¹é‡å†™å…¥ï¼šå½“ DataTable ç§¯ç´¯åˆ° 100 è¡Œæ—¶ï¼Œæ‰§è¡Œä¸€æ¬¡æ‰¹é‡å¯¼å…¥</span></span><br><span class="line">                    dataTable.Clear();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//è¿›åº¦é€šçŸ¥ï¼šæ¯å¤„ç† 100 æ¡è®°å½•æˆ–å¤„ç†å®Œæ‰€æœ‰è®°å½•æ—¶ï¼Œé€šè¿‡ SignalR é€šçŸ¥å®¢æˆ·ç«¯</span></span><br><span class="line">                <span class="keyword">await</span> hubContext.Clients.Client(connectionId).SendAsync(<span class="string">&quot;ImportProgress&quot;</span>,totalCount,counter);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//å¤„ç†å‰©ä½™æ•°æ®ï¼šç¡®ä¿æœ€åä¸€æ‰¹ä¸è¶³ 100 æ¡çš„æ•°æ®ä¹Ÿè¢«å¯¼å…¥</span></span><br><span class="line">            <span class="keyword">await</span> bulkCopy.WriteToServerAsync(dataTable);</span><br><span class="line">            <span class="comment">//æœ€ç»ˆè¿›åº¦é€šçŸ¥ï¼šç¡®ä¿å®¢æˆ·ç«¯æ”¶åˆ° 100% å®Œæˆçš„é€šçŸ¥</span></span><br><span class="line">            <span class="keyword">await</span> hubContext.Clients.Client(connectionId).SendAsync(<span class="string">&quot;ImportProgress&quot;</span>, totalCount, counter);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*public class ImportExecutor</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">    private readonly IHubContext&lt;ImportDictHub&gt; hubContext;</span></span><br><span class="line"><span class="comment">    private readonly ILogger&lt;ImportExecutor&gt; logger;</span></span><br><span class="line"><span class="comment">    private readonly IConfiguration configuration;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    public ImportExecutor(IHubContext&lt;ImportDictHub&gt; hubContext, ILogger&lt;ImportExecutor&gt; logger, IConfiguration configuration)</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">        this.hubContext = hubContext;</span></span><br><span class="line"><span class="comment">        this.logger = logger;</span></span><br><span class="line"><span class="comment">        this.configuration = configuration;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    public async Task ExecuteAsync(string connectionId)</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">        try</span></span><br><span class="line"><span class="comment">        &#123;</span></span><br><span class="line"><span class="comment">            string filePath = @&quot;E:\temp\stardict.csv&quot;;</span></span><br><span class="line"><span class="comment">            string[] lines = await File.ReadAllLinesAsync(filePath);</span></span><br><span class="line"><span class="comment">            </span></span><br><span class="line"><span class="comment">            if (lines.Length &lt;= 1) // æ£€æŸ¥æ˜¯å¦æœ‰æ•°æ®è¡Œ</span></span><br><span class="line"><span class="comment">            &#123;</span></span><br><span class="line"><span class="comment">                await hubContext.Clients.Client(connectionId).SendAsync(&quot;ImportProgress&quot;, 0, 0);</span></span><br><span class="line"><span class="comment">                return;</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">            int totalCount = lines.Length - 1; // æ€»è¡Œæ•°ï¼šè·³è¿‡è¡¨å¤´</span></span><br><span class="line"><span class="comment">            string connStr = configuration.GetConnectionString(&quot;DefaultConnection&quot;);</span></span><br><span class="line"><span class="comment">            </span></span><br><span class="line"><span class="comment">            using (var bulkCopy = new SqlBulkCopy(connStr))</span></span><br><span class="line"><span class="comment">            &#123;</span></span><br><span class="line"><span class="comment">                bulkCopy.DestinationTableName = &quot;T_Worditems&quot;;</span></span><br><span class="line"><span class="comment">                bulkCopy.ColumnMappings.Add(&quot;Word&quot;, &quot;Word&quot;);</span></span><br><span class="line"><span class="comment">                bulkCopy.ColumnMappings.Add(&quot;Phonetic&quot;, &quot;Phonetic&quot;);</span></span><br><span class="line"><span class="comment">                bulkCopy.ColumnMappings.Add(&quot;Definition&quot;, &quot;Definition&quot;);</span></span><br><span class="line"><span class="comment">                bulkCopy.ColumnMappings.Add(&quot;Translation&quot;, &quot;Translation&quot;);</span></span><br><span class="line"><span class="comment">                </span></span><br><span class="line"><span class="comment">                using (DataTable dataTable = new DataTable())</span></span><br><span class="line"><span class="comment">                &#123;</span></span><br><span class="line"><span class="comment">                    dataTable.Columns.Add(&quot;Word&quot;);</span></span><br><span class="line"><span class="comment">                    dataTable.Columns.Add(&quot;Phonetic&quot;);</span></span><br><span class="line"><span class="comment">                    dataTable.Columns.Add(&quot;Definition&quot;);</span></span><br><span class="line"><span class="comment">                    dataTable.Columns.Add(&quot;Translation&quot;);</span></span><br><span class="line"><span class="comment">                    </span></span><br><span class="line"><span class="comment">                    int counter = 0;</span></span><br><span class="line"><span class="comment">                    int progressCounter = 0;</span></span><br><span class="line"><span class="comment">                    const int BatchSize = 100;</span></span><br><span class="line"><span class="comment">                    const int ProgressUpdateInterval = 100; // æ¯å¤„ç†100æ¡è®°å½•æ›´æ–°ä¸€æ¬¡è¿›åº¦</span></span><br><span class="line"><span class="comment">                    </span></span><br><span class="line"><span class="comment">                    // è·³è¿‡è¡¨å¤´è¡Œ</span></span><br><span class="line"><span class="comment">                    for (int i = 1; i &lt; lines.Length; i++)</span></span><br><span class="line"><span class="comment">                    &#123;</span></span><br><span class="line"><span class="comment">                        string line = lines[i];</span></span><br><span class="line"><span class="comment">                        string[] str = line.Split(&#x27;,&#x27;);</span></span><br><span class="line"><span class="comment">                        </span></span><br><span class="line"><span class="comment">                        if (str.Length &lt; 4) // ç¡®ä¿æ•°æ®è¡Œæœ‰è¶³å¤Ÿçš„å­—æ®µ</span></span><br><span class="line"><span class="comment">                        &#123;</span></span><br><span class="line"><span class="comment">                            logger.LogWarning($&quot;ç¬¬ &#123;i&#125; è¡Œæ ¼å¼ä¸æ­£ç¡®: &#123;line&#125;&quot;);</span></span><br><span class="line"><span class="comment">                            continue;</span></span><br><span class="line"><span class="comment">                        &#125;</span></span><br><span class="line"><span class="comment">                        </span></span><br><span class="line"><span class="comment">                        string word = str[0];</span></span><br><span class="line"><span class="comment">                        string phonetic = str[1];</span></span><br><span class="line"><span class="comment">                        string definition = str[2];</span></span><br><span class="line"><span class="comment">                        string translation = str[3];</span></span><br><span class="line"><span class="comment">                        </span></span><br><span class="line"><span class="comment">                        DataRow row = dataTable.NewRow();</span></span><br><span class="line"><span class="comment">                        row[&quot;Word&quot;] = word;</span></span><br><span class="line"><span class="comment">                        row[&quot;Phonetic&quot;] = phonetic;</span></span><br><span class="line"><span class="comment">                        row[&quot;Definition&quot;] = definition;</span></span><br><span class="line"><span class="comment">                        row[&quot;Translation&quot;] = translation;</span></span><br><span class="line"><span class="comment">                        dataTable.Rows.Add(row);</span></span><br><span class="line"><span class="comment">                        counter++;</span></span><br><span class="line"><span class="comment">                        </span></span><br><span class="line"><span class="comment">                        if (dataTable.Rows.Count == BatchSize)</span></span><br><span class="line"><span class="comment">                        &#123;</span></span><br><span class="line"><span class="comment">                            await bulkCopy.WriteToServerAsync(dataTable);</span></span><br><span class="line"><span class="comment">                            dataTable.Clear();</span></span><br><span class="line"><span class="comment">                        &#125;</span></span><br><span class="line"><span class="comment">                        </span></span><br><span class="line"><span class="comment">                        // æ¯å¤„ç†ProgressUpdateIntervalæ¡è®°å½•å‘é€ä¸€æ¬¡è¿›åº¦æ›´æ–°</span></span><br><span class="line"><span class="comment">                        if (counter % ProgressUpdateInterval == 0 || counter == totalCount)</span></span><br><span class="line"><span class="comment">                        &#123;</span></span><br><span class="line"><span class="comment">                            await hubContext.Clients.Client(connectionId).SendAsync(&quot;ImportProgress&quot;, totalCount, counter);</span></span><br><span class="line"><span class="comment">                        &#125;</span></span><br><span class="line"><span class="comment">                    &#125;</span></span><br><span class="line"><span class="comment">                    </span></span><br><span class="line"><span class="comment">                    // å†™å…¥å‰©ä½™çš„æ•°æ®</span></span><br><span class="line"><span class="comment">                    if (dataTable.Rows.Count &gt; 0)</span></span><br><span class="line"><span class="comment">                    &#123;</span></span><br><span class="line"><span class="comment">                        await bulkCopy.WriteToServerAsync(dataTable);</span></span><br><span class="line"><span class="comment">                    &#125;</span></span><br><span class="line"><span class="comment">                    </span></span><br><span class="line"><span class="comment">                    // ç¡®ä¿å‘é€æœ€ç»ˆè¿›åº¦</span></span><br><span class="line"><span class="comment">                    await hubContext.Clients.Client(connectionId).SendAsync(&quot;ImportProgress&quot;, totalCount, counter);</span></span><br><span class="line"><span class="comment">                &#125;</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        catch (Exception ex)</span></span><br><span class="line"><span class="comment">        &#123;</span></span><br><span class="line"><span class="comment">            logger.LogError(ex, &quot;å¯¼å…¥è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯&quot;);</span></span><br><span class="line"><span class="comment">            await hubContext.Clients.Client(connectionId).SendAsync(&quot;ImportError&quot;, ex.Message);</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ImportDictHub</span>:<span class="title">Hub</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//ä¾èµ–æ³¨å…¥ï¼šé€šè¿‡æ„é€ å‡½æ•°æ³¨å…¥ ImportExecutorï¼Œè¯¥æœåŠ¡è´Ÿè´£å®é™…çš„ CSV å¯¼å…¥æ“ä½œ</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> ImportExecutor importExecutor;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ImportDictHub</span>(<span class="params">ImportExecutor importExecutor</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.importExecutor = importExecutor;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Task <span class="title">ImportEcdict</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//å¯åŠ¨å­—å…¸æ•°æ®çš„å¯¼å…¥è¿‡ç¨‹</span></span><br><span class="line">        <span class="comment">/*this.Context.ConnectionIdï¼šè·å–å½“å‰å®¢æˆ·ç«¯è¿æ¥çš„å”¯ä¸€æ ‡è¯†ç¬¦</span></span><br><span class="line"><span class="comment">        importExecutor.ExecuteAsync(...)ï¼šè°ƒç”¨å¯¼å…¥æ‰§è¡Œå™¨çš„å¼‚æ­¥æ–¹æ³•å¼€å§‹å¯¼å…¥</span></span><br><span class="line"><span class="comment">        _ = ...ï¼šä½¿ç”¨å¼ƒå…ƒ (discard) å¿½ç•¥è¿”å›çš„ä»»åŠ¡ï¼Œè¡¨ç¤ºä¸ç­‰å¾…å¯¼å…¥å®Œæˆå°±è¿”å›</span></span><br><span class="line"><span class="comment">        return Task.CompletedTaskï¼šç«‹å³è¿”å›å·²å®Œæˆçš„ä»»åŠ¡ï¼Œè®©å®¢æˆ·ç«¯çŸ¥é“è¯·æ±‚å·²æ”¶åˆ°*/</span></span><br><span class="line">        _ = importExecutor.ExecuteAsync(<span class="keyword">this</span>.Context.ConnectionId);</span><br><span class="line">        <span class="keyword">return</span> Task.CompletedTask;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>å¼‚æ­¥éé˜»å¡è®¾è®¡</li></ol><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_ = importExecutor.ExecuteAsync(<span class="keyword">this</span>.Context.ConnectionId);</span><br></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆè¿™æ ·è®¾è®¡ï¼Ÿ<br>å¯¼å…¥æ“ä½œå¯èƒ½éœ€è¦å¾ˆé•¿æ—¶é—´ï¼ˆå‡ ç§’åˆ°å‡ åˆ†é’Ÿä¸ç­‰ï¼‰<br>å¦‚æœç­‰å¾…å¯¼å…¥å®Œæˆå†è¿”å›ï¼Œä¼šé˜»å¡ SignalR è¿æ¥ï¼Œå½±å“å…¶ä»–å®¢æˆ·ç«¯é€šä¿¡<br>é‡‡ç”¨ â€œè§¦å‘å¹¶å¿˜è®°â€(fire-and-forget) æ¨¡å¼ï¼Œè®©å¯¼å…¥åœ¨åå°æ‰§è¡Œ</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">builder.Services.AddSignalR();</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span>[] urls = <span class="keyword">new</span>[] &#123; <span class="string">&quot;&quot;</span> &#125;;</span><br><span class="line">builder.Services.AddCors(options =&gt;</span><br><span class="line">    options.AddDefaultPolicy(builder =&gt; builder</span><br><span class="line">    .WithOrigins(urls)</span><br><span class="line">    .AllowAnyMethod()</span><br><span class="line">    .AllowAnyHeader()</span><br><span class="line">    .AllowCredentials()));</span><br><span class="line"></span><br><span class="line">builder.Services.AddScoped&lt;ImportExecutor&gt;();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Configure the HTTP request pipeline.</span></span><br><span class="line"><span class="keyword">if</span> (app.Environment.IsDevelopment())</span><br><span class="line">&#123;</span><br><span class="line">    app.UseSwagger();</span><br><span class="line">    app.UseSwaggerUI();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.UseHttpsRedirection();</span><br><span class="line"></span><br><span class="line">app.UseAuthorization();</span><br><span class="line">app.MapHub&lt;ImportDictHub&gt;(<span class="string">&quot;/ImportDictHub&quot;</span>);</span><br><span class="line">app.MapControllers();</span><br></pre></td></tr></table></figure><p>å‰ç«¯Vue</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;å¯¼å…¥&quot;</span> <span class="attr">v-on:click</span>=<span class="string">&quot;importECDict&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">progress</span> <span class="attr">:value</span>=<span class="string">&quot;state.current&quot;</span> <span class="attr">:max</span>=<span class="string">&quot;state.total&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">progress</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; reactive, onMounted &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> * <span class="keyword">as</span> signalR <span class="keyword">from</span> <span class="string">&#x27;@microsoft/signalr&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">let</span> connection;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">name</span>: <span class="string">&#x27;Login&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">const</span> state = <span class="title function_">reactive</span>(&#123; <span class="attr">current</span>: <span class="number">0</span>, <span class="attr">total</span>: <span class="number">0</span> &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">const</span> importECDict = <span class="keyword">async</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="keyword">await</span> connection.<span class="title function_">invoke</span>(<span class="string">&quot;ImportEcDict&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="title function_">alert</span>(<span class="string">&quot;å¯åŠ¨å¯¼å…¥&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="title function_">onMounted</span>(<span class="keyword">async</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="keyword">var</span> options = &#123; <span class="attr">skipNegotiation</span>: <span class="literal">true</span>, <span class="attr">transport</span>: signalR.<span class="property">HttpTransportType</span>.<span class="property">WebSockets</span> &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            connection = <span class="keyword">new</span> signalR.<span class="title class_">HubConnectionBuilder</span>()</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                .<span class="title function_">withUrl</span>(<span class="string">&#x27;https://localhost:7068/ImportDictHub&#x27;</span>, options)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                .<span class="title function_">withAutomaticReconnect</span>()</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                .<span class="title function_">build</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="keyword">await</span> connection.<span class="title function_">start</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            connection.<span class="title function_">on</span>(<span class="string">&#x27;ImportProgress&#x27;</span>, <span class="function">(<span class="params">total, current</span>) =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                state.<span class="property">total</span> = total;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                state.<span class="property">current</span> = current;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">return</span> &#123; state, importECDict &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ASP.NET Core </tag>
            
            <tag> Entity Framework Core </tag>
            
            <tag> SingnalR </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ASP.NET Core SignaLRæœåŠ¡å™¨ç«¯æ¶ˆæ¯æ¨é€</title>
      <link href="/2025/05/10/asp.net%20core/ASP.NET%20Core%E9%AB%98%E7%BA%A7%E7%BB%84%E4%BB%B6%E4%B8%89/"/>
      <url>/2025/05/10/asp.net%20core/ASP.NET%20Core%E9%AB%98%E7%BA%A7%E7%BB%84%E4%BB%B6%E4%B8%89/</url>
      
        <content type="html"><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯WebSocketå’ŒSignalR"><a href="#ä»€ä¹ˆæ˜¯WebSocketå’ŒSignalR" class="headerlink" title="ä»€ä¹ˆæ˜¯WebSocketå’ŒSignalR"></a>ä»€ä¹ˆæ˜¯WebSocketå’ŒSignalR</h1><ol><li>WebSocketåŸºäºTCPåè®®ï¼Œæ”¯æŒäºŒè¿›åˆ¶é€šä¿¡ï¼ŒåŒå·¥é€šä¿¡ã€‚</li><li>æ€§èƒ½å’Œå¹¶å‘èƒ½åŠ›æ›´å¼ºã€‚</li><li>WebSocketæœåŠ¡å™¨ç«¯éƒ¨ç½²åˆ°WebæœåŠ¡å™¨ä¸Šï¼Œå› ä¸ºå¯ä»¥å€ŸåŠ©HTTPåè®®å®Œæˆåˆå§‹çš„æ¡æ‰‹ï¼ˆå¯é€‰ï¼‰ï¼Œå¹¶ä¸”å…±äº«HTTPæœåŠ¡å™¨çš„ç«¯å£ï¼ˆä¸»è¦ï¼‰</li></ol><blockquote><p>è™½ç„¶WebSocketæ˜¯ç‹¬ç«‹äºHTTPçš„ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸€èˆ¬ä»ç„¶æŠŠWebSocketæœåŠ¡å™¨ç«¯éƒ¨ç½²åˆ°WebæœåŠ¡å™¨ä¸Šï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦å€ŸåŠ©HTTPå®Œæˆåˆå§‹çš„æ¡æ‰‹ï¼Œå¹¶ä¸”å…±äº«HTTPæœåŠ¡å™¨çš„ç«¯å£ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…ä¸ºWebSocketå•ç‹¬æ‰“å¼€æ–°çš„æœåŠ¡å™¨ç«¯å£ã€‚å› æ­¤ï¼ŒSignalRçš„æœåŠ¡å™¨ç«¯ä¸€èˆ¬è¿è¡Œåœ¨ASP.NET Coreé¡¹ç›®ä¸­ã€‚</p></blockquote><p><b>SignIR</b></p><ol><li>ASP.NET Core SignalRï¼ˆä»¥ä¸‹ç®€ç§°SignalRï¼‰,æ˜¯.NET Coreå¹³å°ä¸‹å¯¹WebSocketçš„å°è£…ã€‚</li><li>Hubï¼ˆé›†çº¿å™¨ï¼‰ï¼Œæ•°æ®äº¤æ¢ä¸­å¿ƒã€‚</li></ol><p><img src="/img%5CWEBAPI%5C28.png"></p><h1 id="SignalRåŸºæœ¬ä½¿ç”¨"><a href="#SignalRåŸºæœ¬ä½¿ç”¨" class="headerlink" title="SignalRåŸºæœ¬ä½¿ç”¨"></a>SignalRåŸºæœ¬ä½¿ç”¨</h1><p>ç¬¬ä¸€æ­¥ï¼Œåˆ›å»ºä¸€ä¸ªç»§æ‰¿è‡ªHubç±»çš„ChatRoomHubç±»,æ‰€æœ‰çš„å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯éƒ½é€šè¿‡è¿™ä¸ªé›†çº¿å™¨è¿›è¡Œé€šä¿¡.</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ChatRoomHub</span>:<span class="title">Hub</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//å®¢æˆ·ç«¯å¯ä»¥é€šè¿‡ SignalR è¿æ¥è°ƒç”¨æ­¤æ–¹æ³•ï¼Œå¹¶ä¼ é€’æ¶ˆæ¯å†…å®¹</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Task <span class="title">SendPublicMessage</span>(<span class="params"><span class="built_in">string</span> message</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//è¡¨ç¤ºå½“å‰å®¢æˆ·ç«¯è¿æ¥çš„ä¸Šä¸‹æ–‡ã€‚</span></span><br><span class="line">        <span class="comment">//æ¯ä¸ªå®¢æˆ·ç«¯è¿æ¥çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œç”± SignalR è‡ªåŠ¨ç”Ÿæˆ</span></span><br><span class="line">        <span class="built_in">string</span> connId = <span class="keyword">this</span>.Context.ConnectionId;</span><br><span class="line">        <span class="built_in">string</span> msg = <span class="string">$&quot;<span class="subst">&#123;connId&#125;</span><span class="subst">&#123;DateTime.Now&#125;</span>:<span class="subst">&#123;message&#125;</span>&quot;</span>;</span><br><span class="line">        <span class="comment">//Clients.Allï¼šè¡¨ç¤ºæ‰€æœ‰è¿æ¥åˆ°è¯¥ Hub çš„å®¢æˆ·ç«¯ã€‚</span></span><br><span class="line">        <span class="comment">/*SendAsyncï¼šå¼‚æ­¥è°ƒç”¨å®¢æˆ·ç«¯æ–¹æ³•ã€‚</span></span><br><span class="line"><span class="comment">        ç¬¬ä¸€ä¸ªå‚æ•° &quot;ReceivePublicMessage&quot;ï¼šå®¢æˆ·ç«¯éœ€è¦å®ç°çš„æ–¹æ³•åã€‚</span></span><br><span class="line"><span class="comment">        ç¬¬äºŒä¸ªå‚æ•° msgï¼šä¼ é€’ç»™å®¢æˆ·ç«¯çš„æ•°æ®ã€‚*/</span></span><br><span class="line">        <span class="keyword">return</span> Clients.All.SendAsync(<span class="string">&quot;ReceivePulicMessage&quot;</span>, msg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ChatRoomHubç±»ä¸­å®šä¹‰çš„æ–¹æ³•å¯ä»¥è¢«å®¢æˆ·ç«¯è°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯å®¢æˆ·ç«¯å¯ä»¥å‘æœåŠ¡å™¨ç«¯å‘é€è¯·æ±‚ï¼Œæ–¹æ³•çš„å‚æ•°å°±æ˜¯å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯ä¼ é€çš„æ¶ˆæ¯ï¼Œå‚æ•°çš„ä¸ªæ•°åŸåˆ™ä¸Šæ¥è®²ä¸å—é™åˆ¶ï¼Œè€Œä¸”å‚æ•°çš„ç±»å‹æ”¯æŒstringã€boolã€intç­‰å¸¸ç”¨çš„æ•°æ®ç±»å‹ã€‚<br>åœ¨ChatRoomHubç±»ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªæ–¹æ³•SendPublicMessageï¼Œæ–¹æ³•çš„å‚æ•°messageä¸ºå®¢æˆ·ç«¯ä¼ é€’è¿‡æ¥çš„æ¶ˆæ¯ã€‚åœ¨ç¬¬5è¡Œä»£ç ä¸­ï¼Œæˆ‘ä»¬è·å¾—äº†å½“å‰å‘é€æ¶ˆæ¯çš„å®¢æˆ·ç«¯è¿æ¥çš„å”¯ä¸€æ ‡è¯†ConnectionIdï¼›åœ¨ç¬¬6è¡Œä»£ç ä¸­æ‹¼æ¥å‡ºä¸€ä¸ªåŒ…å«è¿æ¥IDã€å½“å‰æ—¶é—´ã€å®¢æˆ·ç«¯æ¶ˆæ¯çš„å­—ç¬¦ä¸²ï¼›éšåæˆ‘ä»¬æŠŠmsgå­—ç¬¦ä¸²ä»¥åå­—ä¸ºâ€œReceivePublicMessageâ€çš„æ¶ˆæ¯å‘é€åˆ°æ‰€æœ‰è¿æ¥åˆ°é›†çº¿å™¨çš„å®¢æˆ·ç«¯ä¸Šã€‚</p><p>ç¬¬äºŒæ­¥ï¼Œç¼–è¾‘Program.csï¼Œåœ¨builder.Buildä¹‹å‰è°ƒç”¨builder.Services.AddSignalRæ³¨å†Œæ‰€æœ‰SignalRçš„æœåŠ¡ï¼Œåœ¨app.MapControllersä¹‹å‰è°ƒç”¨app.MapHub&lt;ChatRoomHub&gt;(â€œ&#x2F;hubs&#x2F;ChatRoomHubâ€)å¯ç”¨SignalRä¸­é—´ä»¶ï¼Œå¹¶ä¸”è®¾ç½®å½“å®¢æˆ·ç«¯é€šè¿‡SignalRè¯·æ±‚â€œ&#x2F;Hubs&#x2F;ChatRoomHubâ€è¿™ä¸ªè·¯å¾„çš„æ—¶å€™ï¼Œç”±ChatRoomHubè¿›è¡Œå¤„ç†ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(args);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Add services to the container.</span></span><br><span class="line"></span><br><span class="line">builder.Services.AddControllers();</span><br><span class="line"><span class="comment">// Learn more about configuring Swagger/OpenAPI at https://aka.ms/aspnetcore/swashbuckle</span></span><br><span class="line">builder.Services.AddEndpointsApiExplorer();</span><br><span class="line">builder.Services.AddSwaggerGen();</span><br><span class="line"><span class="comment">//æ³¨å…¥æ‰€æœ‰SignalRçš„æœåŠ¡</span></span><br><span class="line">builder.Services.AddSignalR(options =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    options.EnableDetailedErrors = <span class="literal">true</span>; <span class="comment">// å¼€å‘ç¯å¢ƒæ˜¾ç¤ºè¯¦ç»†é”™è¯¯</span></span><br><span class="line">    options.ClientTimeoutInterval = TimeSpan.FromSeconds(<span class="number">30</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ³¨å…¥CORSæœåŠ¡</span></span><br><span class="line"><span class="built_in">string</span>[] urls = <span class="keyword">new</span>[] &#123; <span class="string">&quot;http://localhost:5173&quot;</span> &#125;;</span><br><span class="line">builder.Services.AddCors(options =&gt;</span><br><span class="line">    options.AddDefaultPolicy(builder =&gt;</span><br><span class="line">        builder.WithOrigins(urls).AllowAnyMethod()</span><br><span class="line">            .AllowAnyHeader().AllowCredentials())</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Configure the HTTP request pipeline.</span></span><br><span class="line"><span class="keyword">if</span> (app.Environment.IsDevelopment())</span><br><span class="line">&#123;</span><br><span class="line">    app.UseSwagger();</span><br><span class="line">    app.UseSwaggerUI();</span><br><span class="line">&#125;</span><br><span class="line">app.UseCors();</span><br><span class="line">app.UseHttpsRedirection();</span><br><span class="line">app.UseAuthentication();</span><br><span class="line">app.UseAuthorization();</span><br><span class="line">app.MapHub&lt;ChatRoomHub&gt;(<span class="string">&quot;/Hub/ChatRoomHub&quot;</span>);<span class="comment">//å¯ç”¨SignalRä¸­é—´ä»¶</span></span><br><span class="line">app.MapControllers();</span><br><span class="line"></span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰æ­¥ï¼Œæˆ‘ä»¬éœ€è¦ç¼–å†™ä¸€å…±é™æ€HTMLé¡µé¢æä¾›äº¤äº’ç•Œé¢ã€‚</p><p>æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å®‰è£…SignalRçš„JavaScriptå®¢æˆ·ç«¯SDKï¼šnpm install @microsoft&#x2F;signalr</p><p>åœ¨SignalRçš„JavaScriptå®¢æˆ·ç«¯ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨HubConnectionBuilderæ¥åˆ›å»ºä»å®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨ç«¯çš„è¿æ¥ï¼›é€šè¿‡withUrlæ–¹æ³•æ¥è®¾ç½®æœåŠ¡å™¨ç«¯é›†çº¿å™¨çš„åœ°å€ï¼Œè¯¥åœ°å€å¿…é¡»æ˜¯åŒ…å«åŸŸåç­‰çš„é‡è¿æœºåˆ¶ã€‚è™½ç„¶withAutomaticReconnectä¸æ˜¯å¿…é¡»è®¾ç½®çš„ï¼Œä½†æ˜¯è®¾ç½®è¿™ä¸ªé€‰é¡¹ä¹‹åï¼Œå¦‚æœè¿æ¥è¢«æ–­å¼€ï¼Œå®¢æˆ·ç«¯å°±ä¼šå°è¯•é‡è¿ï¼Œå› æ­¤ä½¿ç”¨èµ·æ¥æ›´æ–¹ä¾¿ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå®¢æˆ·ç«¯é‡è¿ä¹‹åï¼Œç”±äºè¿™æ˜¯ä¸ªæ–°çš„è¿æ¥ï¼Œå› æ­¤åœ¨æœåŠ¡å™¨ç«¯è·å¾—çš„ConnectionIdæ˜¯ä¸€ä¸ªæ–°çš„å€¼ã€‚å¯¹HubConnectionBuilderè®¾ç½®å®Œæˆåï¼Œæˆ‘ä»¬è°ƒç”¨buildå°±å¯ä»¥æ„å»ºå®Œæˆä¸€ä¸ªå®¢æˆ·ç«¯åˆ°é›†çº¿å™¨çš„è¿æ¥ã€‚<br>é€šè¿‡buildè·å¾—çš„åˆ°é›†çº¿å™¨çš„è¿æ¥åªèƒ½æ˜¯é€»è¾‘ä¸Šçš„è¿æ¥ï¼Œè¿˜éœ€è¦è°ƒç”¨startæ–¹æ³•æ¥å®é™…å¯åŠ¨è¿æ¥ã€‚ä¸€æ—¦è¿æ¥å»ºç«‹å®Œæˆï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è¿æ¥å¯¹è±¡çš„invokeå‡½æ•°æ¥è°ƒç”¨é›†çº¿å™¨ä¸­çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡onå‡½æ•°æ¥æ³¨å†Œç›‘å¬æœåŠ¡å™¨é€‚ç”¨SendAsyncå‘é€çš„æ¶ˆæ¯çš„ä»£ç ã€‚</p><p><img src="/img%5CWEBAPI%5C29.png"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;state.userMessage&quot;</span> <span class="attr">v-on:keypress</span>=<span class="string">&quot;textMsgOnkeypress&quot;</span>/&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;(msg,index) in state.messages&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;index&quot;</span>&gt;</span>&#123;&#123;msg&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> &#123; reactive, onMounted &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">import</span> * <span class="keyword">as</span> signalR <span class="keyword">from</span> <span class="string">&quot;@microsoft/signalr&quot;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">let</span> connection;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="attr">name</span>: <span class="string">&quot;Login&quot;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">const</span> state = <span class="title function_">reactive</span>(&#123; <span class="attr">userMessage</span>: <span class="string">&quot;&quot;</span>, <span class="attr">messages</span>: [] &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">const</span> textMsgOnkeypress = <span class="keyword">async</span> <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">if</span> (e.<span class="property">keyCode</span> != <span class="number">13</span>) <span class="keyword">return</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">await</span> connection.<span class="title function_">invoke</span>(<span class="string">&quot;SendPublicMessage&quot;</span>, state.<span class="property">userMessage</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      state.<span class="property">userMessage</span> = <span class="string">&quot;&quot;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">onMounted</span>(<span class="keyword">async</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      connection = <span class="keyword">new</span> signalR.<span class="title class_">HubConnectionBuilder</span>()<span class="comment">//åˆ›å»ºä»å®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨ç«¯çš„è¿æ¥</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        .<span class="title function_">withUrl</span>(<span class="string">&quot;https://localhost:7122/Hub/ChatRoomHub&quot;</span>)<span class="comment">//è®¾ç½®æœåŠ¡å™¨ç«¯é›†çº¿å™¨çš„åœ°å€</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        .<span class="title function_">withAutomaticReconnect</span>() <span class="comment">//è®¾ç½®è‡ªåŠ¨é‡è¿æœºåˆ¶</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        .<span class="title function_">build</span>();<span class="comment">//æ„å»ºå®Œæˆ  </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">await</span> connection.<span class="title function_">start</span>();<span class="comment">//è‡ªåŠ¨</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="comment">//é€šè¿‡onå‡½æ•°æ¥æ³¨å†Œç›‘å¬æœåŠ¡å™¨ç«¯ä½¿ç”¨SendAsyncå‘é€çš„æ¶ˆæ¯çš„ä»£ç </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      connection.<span class="title function_">on</span>(<span class="string">&quot;ReceivePulicMessage&quot;</span>, <span class="function">(<span class="params">msg</span>) =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        state.<span class="property">messages</span>.<span class="title function_">push</span>(msg);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">return</span> &#123; state, textMsgOnkeypress &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>åŠŸèƒ½å®ç°<br>SignalR è¿æ¥åˆå§‹åŒ–ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">connection = <span class="keyword">new</span> signalR.<span class="title class_">HubConnectionBuilder</span>()</span><br><span class="line">  .<span class="title function_">withUrl</span>(<span class="string">&quot;https://localhost:7122/Hub/ChatRoomHub&quot;</span>)</span><br><span class="line">  .<span class="title function_">withAutomaticReconnect</span>()</span><br><span class="line">  .<span class="title function_">build</span>();</span><br><span class="line"><span class="keyword">await</span> connection.<span class="title function_">start</span>();</span><br></pre></td></tr></table></figure><p>åˆ›å»º SignalR è¿æ¥å¹¶é…ç½®è‡ªåŠ¨é‡è¿<br>è¿æ¥åˆ°æœåŠ¡å™¨ç«¯çš„ ChatRoomHub é›†çº¿å™¨<br>ç»„ä»¶æŒ‚è½½å®Œæˆåç«‹å³å¯åŠ¨è¿æ¥<br>æ¶ˆæ¯æ¥æ”¶å¤„ç†ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">connection.<span class="title function_">on</span>(<span class="string">&quot;ReceivePulicMessage&quot;</span>, <span class="function">(<span class="params">msg</span>) =&gt;</span> &#123;</span><br><span class="line">  state.<span class="property">messages</span>.<span class="title function_">push</span>(msg);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>æ³¨å†Œäº‹ä»¶ç›‘å¬å™¨ï¼Œç›‘å¬æœåŠ¡å™¨ç«¯å‘é€çš„ReceivePulicMessageäº‹ä»¶<br>æ¥æ”¶åˆ°æ¶ˆæ¯åå°†å…¶æ·»åŠ åˆ°messagesæ•°ç»„ï¼Œè§¦å‘è§†å›¾æ›´æ–°<br>æ¶ˆæ¯å‘é€å¤„ç†ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> textMsgOnkeypress = <span class="keyword">async</span> <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (e.<span class="property">keyCode</span> != <span class="number">13</span>) <span class="keyword">return</span>;</span><br><span class="line">  <span class="keyword">await</span> connection.<span class="title function_">invoke</span>(<span class="string">&quot;SendPublicMessage&quot;</span>, state.<span class="property">userMessage</span>);</span><br><span class="line">  state.<span class="property">userMessage</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ç›‘å¬è¾“å…¥æ¡†çš„æŒ‰é”®äº‹ä»¶ï¼Œä»…å¤„ç† Enter é”® (13)<br>é€šè¿‡connection.invokeè°ƒç”¨æœåŠ¡å™¨ç«¯çš„SendPublicMessageæ–¹æ³•<br>å‘é€æˆåŠŸåæ¸…ç©ºè¾“å…¥æ¡†</p><h1 id="åè®®åå•†"><a href="#åè®®åå•†" class="headerlink" title="åè®®åå•†"></a>åè®®åå•†</h1><p>SignalRå…¶å®å¹¶ä¸åªæ˜¯å¯¹WebSocketçš„å°è£…ï¼Œå®ƒæ”¯æŒå¤šç§æœåŠ¡æ¨é€çš„å®ç°æ–¹å¼ï¼ŒåŒ…æ‹¬WebSocketã€æœåŠ¡å™¨å‘é€äº‹ä»¶ï¼ˆserver-sent eventsï¼‰å’Œé•¿è½®è¯¢ã€‚SiganlRçš„JavaScriptå®¢æˆ·ç«¯ä¼šå…ˆå°è¯•ç”¨WebSocketè¿æ¥æœåŠ¡å™¨ï¼›å¦‚æœå¤±è´¥äº†ï¼Œä»–å†ç”¨æœåŠ¡å™¨å‘é€äº‹ä»¶æ–¹å¼è¿æ¥æœåŠ¡å™¨ï¼›å¦‚æœåˆå¤±è´¥äº†ï¼Œå®ƒå†ç”¨é•¿è½®è¯¢æ–¹å¼è¿æ¥æœåŠ¡å™¨ã€‚å› æ­¤SignalRä¼šè‡ªé€‚åº”å¤æ‚çš„å®¢æˆ·ç«¯ã€ç½‘ç»œã€æœåŠ¡å™¨ç¯å¢ƒæ¥æ”¯æŒæœåŠ¡å™¨ç«¯æ¨é€çš„å®ç°ã€‚</p><p>åè®®åå•†çš„é—®é¢˜</p><ol><li>é›†ç¾¤ä¸­åè®®åå•†çš„é—®é¢˜ï¼šâ€œåå•†â€è¯·æ±‚è¢«æœåŠ¡å™¨Aå¤„ç†ï¼Œè€Œæ¥ä¸‹æ¥çš„WebSocketè¯·æ±‚å´è¢«æœåŠ¡å™¨Bå¤„ç†ã€‚</li><li>è§£å†³æ–¹æ³•ï¼šç²˜æ€§ä¼šè¯å’Œç¦ç”¨åå•†ã€‚</li><li>ç²˜æ€§ä¼šè¯ï¼ˆSticky Sessionï¼‰ï¼šæŠŠæ¥è‡ªåŒä¸€ä¸ªå®¢æˆ·ç«¯çš„è¯·æ±‚éƒ½è½¬å‘ç»™åŒä¸€å°æœåŠ¡å™¨ä¸Šã€‚ç¼ºç‚¹ï¼šå› æ­¤å…±äº«å…¬ç½‘IPç­‰é€ æˆè¯·æ±‚æ— æ³•è¢«å¹³å‡çš„åˆ†é…åˆ°æœåŠ¡å™¨é›†ç¾¤ï¼›æ‰©å®¹çš„è‡ªé€‚åº”æ€§ä¸å¼ºã€‚</li><li>ç¦ç”¨åå•†ï¼šç›´æ¥å‘æœåŠ¡å™¨å‘å‡ºWebSocketè¯·æ±‚ã€‚WebSocketè¿æ¥ä¸€æ—¦å»ºç«‹åï¼Œåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ç›´æ¥å°±å»ºç«‹äº†æŒç»­çš„ç½‘ç»œè¿æ¥é€šé“ï¼Œåœ¨è¿™ä¸ªWebSocketè¿æ¥ä¸­çš„åç»­å¾€è¿”WebSocketé€šä¿¡éƒ½æ˜¯æœ‰åŒä¸€å°æœåŠ¡å™¨æ¥å¤„ç†ã€‚ç¼ºç‚¹ï¼šæ— æ³•é™çº§åˆ°â€œæœåŠ¡å™¨å‘é€äº‹ä»¶â€æˆ–â€œé•¿è½®è¯¢â€ï¼Œä¸è¿‡ä¸æ˜¯å¤§é—®é¢˜ã€‚</li></ol><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> options = &#123;</span><br><span class="line">  skipNegotiation: <span class="literal">true</span>,</span><br><span class="line">  transport: signalR.HttpTransportType.WebSockets,</span><br><span class="line">&#125;;</span><br><span class="line">connection = <span class="keyword">new</span> signalR.HubConnectionBuilder() <span class="comment">// åˆ›å»ºä»å®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨ç«¯çš„è¿æ¥</span></span><br><span class="line">  .withUrl(<span class="string">&quot;https://localhost:7122/Hubs/ChatRoomHub&quot;</span>,options) <span class="comment">// è®¾ç½®æœåŠ¡å™¨ç«¯é›†çº¿å™¨çš„åœ°å€</span></span><br><span class="line">  .withAutomaticReconnect() <span class="comment">// è®¾ç½®è‡ªåŠ¨é‡è¿æœºåˆ¶</span></span><br><span class="line">  .build(); <span class="comment">// æ„å»ºå®Œæˆ</span></span><br></pre></td></tr></table></figure><h1 id="SignalRåˆ†å¸ƒå¼éƒ¨ç½²"><a href="#SignalRåˆ†å¸ƒå¼éƒ¨ç½²" class="headerlink" title="SignalRåˆ†å¸ƒå¼éƒ¨ç½²"></a>SignalRåˆ†å¸ƒå¼éƒ¨ç½²</h1><p>åœ¨å¤šå°æœåŠ¡å™¨ç»„æˆçš„åˆ†å¸ƒå¼ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨ç²˜æ€§ä¼šè¯æˆ–è€…ç¦ç”¨åå•†çš„æ–¹å¼æ¥ä¿è¯æ¥è‡ªåŒä¸€ä¸ªå®¢æˆ·ç«¯çš„è¯·æ±‚è¢«åŒä¸€å°æœåŠ¡å™¨å¤„ç†ï¼Œä½†æ˜¯åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­ï¼Œè¿˜æœ‰å…¶ä»–é—®é¢˜éœ€è¦è§£å†³ã€‚</p><p><img src="/img%5CWEBAPI%5C30.png"></p><p>å®¢æˆ·ç«¯1å‘æ¶ˆæ¯3ã€4æ”¶ä¸åˆ°ï¼Œå®¢æˆ·ç«¯3å‘æ¶ˆæ¯1ã€2æ”¶ä¸åˆ°ã€‚å› ä¸ºè¿™ä¸¤å°æœåŠ¡å™¨ä¹‹é—´çš„ChatRoomHubæ²¡æœ‰é€šä¿¡ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥è®©å¤šå°æœåŠ¡å™¨ä¸Šçš„é›†çº¿å™¨è¿æ¥åˆ°ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œé€šè¿‡è¿™ä¸ªæ¶ˆæ¯é˜Ÿåˆ—å®Œæˆè·¨æœåŠ¡å™¨çš„æ¶ˆæ¯æŠ•é€’ã€‚</p><p>å¾®è½¯å®˜æ–¹æä¾›äº†ç”¨RedisæœåŠ¡å™¨æ¥è§£å†³SignalRéƒ¨ç½²åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­æ•°æ®åŒæ­¥çš„æ–¹æ¡ˆâ€”â€”â€”â€”Redis backplaneã€‚</p><ol><li><p>æ‰€æœ‰æœåŠ¡å™¨è¿æ¥åˆ°åŒä¸€ä¸ªæ¶ˆæ¯ä¸­é—´ä»¶ã€‚å¿…é¡»ä½¿ç”¨ç²˜æ€§ä¼šè¯æˆ–è€…è·³è¿‡åå•†ã€‚</p></li><li><p>å®‰è£…NuGet:<br>Micrsosft.AspNetCore.SignalR.StackExchangeRedis</p></li></ol><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">builder.Services.AddSignalR().AddStackExchangeRedis(<span class="string">&quot;127.0.0.1&quot;</span>,options =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    options.Configuration.ChannelPrefix = <span class="string">&quot;SignalRChat&quot;</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>å¦‚æœæœ‰å¤šä¸ªSignalRåº”ç”¨ç¨‹åºè¿æ¥åŒä¸€å°RedisæœåŠ¡å™¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦ä¸ºæ¯ä¸€ä¸ªåº”ç”¨ç¨‹åºé…ç½®å”¯ä¸€çš„ChannelPrefixã€‚</p><h1 id="SignalRèº«è®¤è¯"><a href="#SignalRèº«è®¤è¯" class="headerlink" title="SignalRèº«è®¤è¯"></a>SignalRèº«è®¤è¯</h1><p>é…ç½®JWTçš„ä»£ç </p><ol><li>åœ¨é…ç½®ç³»ç»Ÿä¸­é…ç½®ä¸€ä¸ªåå­—ä¸ºJWTçš„èŠ‚ç‚¹ï¼Œå¹¶åœ¨èŠ‚ç‚¹ä¸‹åˆ›å»ºSigningKeyã€ExpireSecondsä¸¤ä¸ªé…ç½®é¡¹ï¼Œåˆ†åˆ«ä»£è¡¨JWTçš„å¯†é’¥å’Œè¿‡æœŸæ—¶é—´ï¼ˆå•ä½ä¸ºç§’ï¼‰ã€‚æˆ‘ä»¬åœ¨åˆ›å»ºä¸€ä¸ªå¯¹åº”JWTèŠ‚ç‚¹çš„é…ç½®ç±»JWTOptions,ç±»ä¸­åŒ…å«SigningKeyã€ExpireSwcondsè¿™ä¸¤ä¸ªå±æ€§ã€‚</li></ol><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;JWT&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;SigningKey&quot;</span><span class="punctuation">:</span> <span class="string">&quot;jlkerujoigsnvjlkasjfwehiojkgnsgss&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ExpireSeconds&quot;</span><span class="punctuation">:</span> <span class="string">&quot;3600&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;ConnectionStrings&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;Default&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Server=localhost;Database=T_youxianyu;Trusted_Connection=True;MultipleActiveResultSets=true;TrustServerCertificate=True;Encrypt=True;&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;Logging&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;LogLevel&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;Default&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Information&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;Microsoft.AspNetCore&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Warning&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;AllowedHosts&quot;</span><span class="punctuation">:</span> <span class="string">&quot;*&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">JWTOptions</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span>? SigningKey &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> ExpirSeconds &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li><p>å®‰è£…ï¼š<br>Microsoft.AspNetCore.Authentication.JwtBearer</p></li><li><p>ç¼–å†™ä»£ç å¯¹JWTè¿›è¡Œé…ç½®ã€‚</p></li></ol><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(args);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Add services to the container.</span></span><br><span class="line"></span><br><span class="line">builder.Services.AddControllers();</span><br><span class="line"><span class="comment">// Learn more about configuring Swagger/OpenAPI at https://aka.ms/aspnetcore/swashbuckle</span></span><br><span class="line">builder.Services.AddEndpointsApiExplorer();</span><br><span class="line">builder.Services.AddSwaggerGen(c =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> scheme = <span class="keyword">new</span> OpenApiSecurityScheme()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">/*Descriptionï¼šåœ¨ Swagger UI ä¸­æ˜¾ç¤ºçš„æè¿°ä¿¡æ¯ï¼ŒæŒ‡å¯¼ç”¨æˆ·å¦‚ä½•è¾“å…¥è®¤è¯ä¿¡æ¯*/</span></span><br><span class="line">        Description = <span class="string">&quot;Authorization header.\r\nExample:&#x27;Bearer 12345abcdef&#x27;&quot;</span>,</span><br><span class="line">        <span class="comment">/*Referenceï¼šå¼•ç”¨ç±»å‹ä¸ºå®‰å…¨æ–¹æ¡ˆï¼ŒID ä¸º &quot;Authorization&quot;*/</span></span><br><span class="line">        Reference = <span class="keyword">new</span> OpenApiReference</span><br><span class="line">        &#123;</span><br><span class="line">            Type = ReferenceType.SecurityScheme,</span><br><span class="line">            Id = <span class="string">&quot;Authorization&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">/*Schemeï¼šæŒ‡å®šä¸º &quot;oauth2&quot;ï¼Œå°½ç®¡æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ JWTï¼Œä½† Swagger UI ä½¿ç”¨æ­¤å€¼æ¥æ˜¾ç¤ºæˆæƒæŒ‰é’®*/</span></span><br><span class="line">        Scheme = <span class="string">&quot;oauth2&quot;</span>,</span><br><span class="line">        <span class="comment">/*Nameï¼šHTTP è¯·æ±‚å¤´çš„åç§°ï¼Œé€šå¸¸ä¸º &quot;Authorization&quot;*/</span></span><br><span class="line">        Name = <span class="string">&quot;Authorization&quot;</span>,</span><br><span class="line">        <span class="comment">/*Inï¼šæŒ‡å®šåœ¨è¯·æ±‚å¤´ä¸­ä¼ é€’è®¤è¯ä¿¡æ¯*/</span></span><br><span class="line">        In = ParameterLocation.Header,</span><br><span class="line">        <span class="comment">/*Typeï¼šæŒ‡å®šä¸º API å¯†é’¥ç±»å‹*/</span></span><br><span class="line">        Type = SecuritySchemeType.ApiKey,</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">/*å°†ä¸Šé¢å®šä¹‰çš„å®‰å…¨æ–¹æ¡ˆæ·»åŠ åˆ° Swagger ç”Ÿæˆå™¨ä¸­ï¼Œåç§°ä¸º &quot;Authorization&quot;*/</span></span><br><span class="line">    c.AddSecurityDefinition(<span class="string">&quot;Authorization&quot;</span>, scheme);</span><br><span class="line">    <span class="comment">/*åˆ›å»ºä¸€ä¸ªå®‰å…¨éœ€æ±‚å¯¹è±¡ï¼Œè¦æ±‚æ‰€æœ‰ API æ“ä½œéƒ½éœ€è¦ä¸Šè¿°å®šä¹‰çš„å®‰å…¨æ–¹æ¡ˆ*/</span></span><br><span class="line">    <span class="keyword">var</span> requirement = <span class="keyword">new</span> OpenApiSecurityRequirement();</span><br><span class="line">    <span class="comment">/*ç©ºçš„å­—ç¬¦ä¸²åˆ—è¡¨è¡¨ç¤ºä¸éœ€è¦ä»»ä½•ç‰¹å®šçš„ä½œç”¨åŸŸï¼ˆscopesï¼‰ï¼Œé€‚ç”¨äº JWT è®¤è¯*/</span></span><br><span class="line">    requirement[scheme] = <span class="keyword">new</span> List&lt;<span class="built_in">string</span>&gt;();</span><br><span class="line">    c.AddSecurityRequirement(requirement);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">IServiceCollection services = builder.Services;</span><br><span class="line"><span class="comment">//é…ç½®æ•°æ®åº“</span></span><br><span class="line">services.AddDbContext&lt;IdDbContext&gt;(opt =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span>? connStr = builder.Configuration.GetConnectionString(<span class="string">&quot;Default&quot;</span>);</span><br><span class="line">    opt.UseSqlServer(connStr);</span><br><span class="line">&#125;);</span><br><span class="line">services.AddDataProtection(); <span class="comment">//å¯¹æ•°æ®è¿›è¡Œä¿æŠ¤</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//è°ƒç”¨AddIdentityCoreæ·»åŠ æ ‡è¯†æ¡†æ¶çš„ä¸€äº›é‡è¦çš„åŸºç¡€æœåŠ¡</span></span><br><span class="line">services.AddIdentityCore&lt;User&gt;(options =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//å¯¹å¯†ç è¿›è¡Œè®¾ç½®</span></span><br><span class="line">    options.Password.RequireDigit = <span class="literal">false</span>; <span class="comment">//å¿…é¡»æ˜¯æ•°å­—</span></span><br><span class="line">    options.Password.RequireLowercase = <span class="literal">false</span>; <span class="comment">//å°å†™</span></span><br><span class="line">    options.Password.RequireNonAlphanumeric = <span class="literal">false</span>; <span class="comment">//éå­—æ¯æ•°å­—</span></span><br><span class="line">    options.Password.RequireUppercase = <span class="literal">false</span>; <span class="comment">//å¤§å†™å­—æ¯</span></span><br><span class="line">    options.Password.RequiredLength = <span class="number">6</span>;<span class="comment">//é•¿åº¦6</span></span><br><span class="line">    options.Tokens.PasswordResetTokenProvider = TokenOptions.DefaultEmailProvider;</span><br><span class="line">    options.Tokens.EmailConfirmationTokenProvider = TokenOptions.DefaultEmailProvider;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//åœ¨ä½¿ç”¨æ ‡è¯†æ¡†æ¶çš„æ—¶å€™ä¹Ÿéœ€è¦æ³¨å…¥å’Œåˆå§‹åŒ–éå¸¸å¤šçš„æœåŠ¡</span></span><br><span class="line"><span class="keyword">var</span> idBuilder = <span class="keyword">new</span> IdentityBuilder(<span class="keyword">typeof</span>(User), <span class="keyword">typeof</span>(Role), services);</span><br><span class="line">idBuilder.AddEntityFrameworkStores&lt;IdDbContext&gt;()</span><br><span class="line">    .AddDefaultTokenProviders()</span><br><span class="line">    .AddRoleManager&lt;RoleManager&lt;Role&gt;&gt;()</span><br><span class="line">    .AddUserManager&lt;UserManager&lt;User&gt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä»é…ç½®æ–‡ä»¶ï¼ˆå¦‚appsettings.jsonï¼‰çš„ &quot;JWT&quot; éƒ¨åˆ†è¯»å–é…ç½®ï¼Œå¹¶æ³¨å†Œä¸ºJWTOptionsç±»å‹çš„é€‰é¡¹æœåŠ¡</span></span><br><span class="line"><span class="comment">//åç»­å¯é€šè¿‡ä¾èµ–æ³¨å…¥ä½¿ç”¨è¿™äº›é…ç½®</span></span><br><span class="line">services.Configure&lt;JWTOptions&gt;(builder.Configuration.GetSection(<span class="string">&quot;JWT&quot;</span>));</span><br><span class="line"><span class="comment">//è®¾ç½®åº”ç”¨çš„ä¸»è¦è®¤è¯æ–¹æ¡ˆä¸º JWT Bearer</span></span><br><span class="line"><span class="comment">//æ·»åŠ  JWT æ‰¿è½½è®¤è¯å¤„ç†å™¨</span></span><br><span class="line">services.AddAuthentication(JwtBearerDefaults.AuthenticationScheme)</span><br><span class="line">    .AddJwtBearer(x =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//å†æ¬¡è¯»å– JWT é…ç½®ï¼ˆå­˜åœ¨é‡å¤è¯»å–é—®é¢˜ï¼‰</span></span><br><span class="line">        <span class="comment">/*var jwtOptions = builder.Configuration.GetSection(&quot;JWT&quot;).Get&lt;JWTOptions&gt;();</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        // æ³¨å†ŒJWTé€‰é¡¹åˆ°ä¾èµ–æ³¨å…¥å®¹å™¨</span></span><br><span class="line"><span class="comment">        services.Configure&lt;JWTOptions&gt;(builder.Configuration.GetSection(&quot;JWT&quot;));</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        // ç”Ÿæˆå®‰å…¨å¯†é’¥</span></span><br><span class="line"><span class="comment">        var securityKey = new SymmetricSecurityKey(Encoding.UTF8.GetBytes(jwtOptions.SigningKey));*/</span></span><br><span class="line">        <span class="comment">//ä»é…ç½®ä¸­è·å–ç­¾åå¯†é’¥å¹¶è½¬æ¢ä¸ºå®‰å…¨å¯†é’¥å¯¹è±¡</span></span><br><span class="line">        <span class="keyword">var</span> jwtOpt = builder.Configuration.GetSection(<span class="string">&quot;JWT&quot;</span>).Get&lt;JWTOptions&gt;();</span><br><span class="line">        <span class="built_in">byte</span>[] keyBytes = Encoding.UTF8.GetBytes(jwtOpt.SigningKey);</span><br><span class="line">        <span class="keyword">var</span> secKey = <span class="keyword">new</span> SymmetricSecurityKey(keyBytes);</span><br><span class="line">        x.TokenValidationParameters = <span class="keyword">new</span> TokenValidationParameters()</span><br><span class="line">        &#123;</span><br><span class="line">            ValidateIssuer = <span class="literal">false</span>,         <span class="comment">// ä¸éªŒè¯ä»¤ç‰Œå‘è¡Œäºº</span></span><br><span class="line">            ValidateAudience = <span class="literal">false</span>,       <span class="comment">// ä¸éªŒè¯ä»¤ç‰Œå—ä¼—</span></span><br><span class="line">            ValidateLifetime = <span class="literal">false</span>,       <span class="comment">// ä¸éªŒè¯ä»¤ç‰Œæœ‰æ•ˆæœŸ</span></span><br><span class="line">            ValidateIssuerSigningKey = <span class="literal">true</span>, <span class="comment">// éªŒè¯ç­¾åå¯†é’¥</span></span><br><span class="line">            IssuerSigningKey = secKey       <span class="comment">// è®¾ç½®ç­¾åå¯†é’¥</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">/*JwtBearerEventsï¼šè¿™æ˜¯ JWT èº«ä»½éªŒè¯ä¸­é—´ä»¶çš„äº‹ä»¶å¤„ç†ç±»ï¼Œå…è®¸åœ¨èº«ä»½éªŒè¯è¿‡ç¨‹çš„ä¸åŒé˜¶æ®µæ’å…¥è‡ªå®šä¹‰é€»è¾‘ã€‚*/</span></span><br><span class="line">        x.Events = <span class="keyword">new</span> JwtBearerEvents</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">/*OnMessageReceivedï¼šå½“ä¸­é—´ä»¶ä»è¯·æ±‚ä¸­æ¥æ”¶ä»¤ç‰Œæ—¶è§¦å‘çš„äº‹ä»¶ã€‚è¿™é‡Œé‡å†™äº†è¯¥äº‹ä»¶å¤„ç†æ–¹æ³•ã€‚*/</span></span><br><span class="line">            OnMessageReceived = context =&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//ä» URL æŸ¥è¯¢å‚æ•°ä¸­è·å–access_tokenå€¼</span></span><br><span class="line">                <span class="keyword">var</span> accessToken = context.Request.Query[<span class="string">&quot;access_token&quot;</span>];</span><br><span class="line">                <span class="comment">//æ£€æŸ¥å½“å‰è¯·æ±‚è·¯å¾„æ˜¯å¦æ˜¯ SignalR é›†çº¿å™¨è·¯å¾„ / Hubs / ChatRoomHub</span></span><br><span class="line">                <span class="keyword">var</span> path = context.HttpContext.Request.Path;</span><br><span class="line">                <span class="keyword">if</span> (!<span class="built_in">string</span>.IsNullOrEmpty(accessToken) &amp;&amp; (path.StartsWithSegments(<span class="string">&quot;/Hub/ChatRoomHub&quot;</span>)))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">//å¦‚æœä¸¤ä¸ªæ¡ä»¶éƒ½æ»¡è¶³ï¼Œåˆ™å°†æŸ¥è¯¢å‚æ•°ä¸­çš„ä»¤ç‰Œèµ‹å€¼ç»™context.Tokenï¼Œä¾›åç»­éªŒè¯ä½¿ç”¨</span></span><br><span class="line">                    context.Token = accessToken;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> Task.CompletedTask;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="comment">/*// ä»é…ç½®ä¸­è¯»å–JWTé€‰é¡¹</span></span><br><span class="line"><span class="comment">var jwtOptions = builder.Configuration.GetSection(&quot;JWT&quot;).Get&lt;JWTOptions&gt;();</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">// æ³¨å†ŒJWTé€‰é¡¹åˆ°ä¾èµ–æ³¨å…¥å®¹å™¨</span></span><br><span class="line"><span class="comment">services.Configure&lt;JWTOptions&gt;(builder.Configuration.GetSection(&quot;JWT&quot;));</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">// ç”Ÿæˆå®‰å…¨å¯†é’¥</span></span><br><span class="line"><span class="comment">var securityKey = new SymmetricSecurityKey(Encoding.UTF8.GetBytes(jwtOptions.SigningKey));</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">// é…ç½®JWTè®¤è¯</span></span><br><span class="line"><span class="comment">services.AddAuthentication(JwtBearerDefaults.AuthenticationScheme)</span></span><br><span class="line"><span class="comment">    .AddJwtBearer(options =&gt;</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">        options.TokenValidationParameters = new TokenValidationParameters</span></span><br><span class="line"><span class="comment">        &#123;</span></span><br><span class="line"><span class="comment">            ValidateIssuer = true,               // éªŒè¯å‘è¡Œäºº</span></span><br><span class="line"><span class="comment">            ValidateAudience = true,             // éªŒè¯å—ä¼—</span></span><br><span class="line"><span class="comment">            ValidateLifetime = true,             // éªŒè¯è¿‡æœŸæ—¶é—´</span></span><br><span class="line"><span class="comment">            ValidateIssuerSigningKey = true,     // éªŒè¯ç­¾åå¯†é’¥</span></span><br><span class="line"><span class="comment">            ValidIssuer = jwtOptions.Issuer,     // è®¾ç½®æœ‰æ•ˆå‘è¡Œäºº</span></span><br><span class="line"><span class="comment">            ValidAudience = jwtOptions.Audience, // è®¾ç½®æœ‰æ•ˆå—ä¼—</span></span><br><span class="line"><span class="comment">            IssuerSigningKey = securityKey,      // è®¾ç½®ç­¾åå¯†é’¥</span></span><br><span class="line"><span class="comment">            ClockSkew = TimeSpan.Zero            // ä¸¥æ ¼éªŒè¯è¿‡æœŸæ—¶é—´</span></span><br><span class="line"><span class="comment">        &#125;;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        // å¯é€‰ï¼šæ·»åŠ äº‹ä»¶å¤„ç†ï¼ˆå¦‚ä»¤ç‰ŒéªŒè¯å¤±è´¥æ—¶çš„è‡ªå®šä¹‰å“åº”ï¼‰</span></span><br><span class="line"><span class="comment">        options.Events = new JwtBearerEvents</span></span><br><span class="line"><span class="comment">        &#123;</span></span><br><span class="line"><span class="comment">            OnAuthenticationFailed = context =&gt;</span></span><br><span class="line"><span class="comment">            &#123;</span></span><br><span class="line"><span class="comment">                if (context.Exception is SecurityTokenExpiredException)</span></span><br><span class="line"><span class="comment">                &#123;</span></span><br><span class="line"><span class="comment">                    context.Response.Headers.Add(&quot;Token-Expired&quot;, &quot;true&quot;);</span></span><br><span class="line"><span class="comment">                &#125;</span></span><br><span class="line"><span class="comment">                return Task.CompletedTask;</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">        &#125;;</span></span><br><span class="line"><span class="comment">    &#125;);*/</span></span><br><span class="line"><span class="comment">//æ³¨å…¥æ‰€æœ‰SignalRçš„æœåŠ¡</span></span><br><span class="line">builder.Services.AddSignalR(options =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    options.EnableDetailedErrors = <span class="literal">true</span>; <span class="comment">// å¼€å‘ç¯å¢ƒæ˜¾ç¤ºè¯¦ç»†é”™è¯¯</span></span><br><span class="line">    options.ClientTimeoutInterval = TimeSpan.FromSeconds(<span class="number">30</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ³¨å…¥CORSæœåŠ¡</span></span><br><span class="line"><span class="built_in">string</span>[] urls = <span class="keyword">new</span>[] &#123; <span class="string">&quot;http://localhost:5173&quot;</span> &#125;;</span><br><span class="line">builder.Services.AddCors(options =&gt;</span><br><span class="line">    options.AddDefaultPolicy(builder =&gt;</span><br><span class="line">        builder.WithOrigins(urls).AllowAnyMethod()</span><br><span class="line">            .AllowAnyHeader().AllowCredentials())</span><br><span class="line">);</span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Configure the HTTP request pipeline.</span></span><br><span class="line"><span class="keyword">if</span> (app.Environment.IsDevelopment())</span><br><span class="line">&#123;</span><br><span class="line">    app.UseSwagger();</span><br><span class="line">    app.UseSwaggerUI();</span><br><span class="line">&#125;</span><br><span class="line">app.UseCors();</span><br><span class="line">app.UseHttpsRedirection();</span><br><span class="line">app.UseAuthentication();</span><br><span class="line">app.UseAuthorization();</span><br><span class="line">app.MapHub&lt;ChatRoomHub&gt;(<span class="string">&quot;/Hub/ChatRoomHub&quot;</span>);<span class="comment">//å¯ç”¨SignalRä¸­é—´ä»¶</span></span><br><span class="line">app.MapControllers();</span><br><span class="line"></span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure><ol start="4"><li><p>åœ¨app.UseAuthorization();ä¹‹å‰æ·»åŠ app.UseAuthentication();</p></li><li><p>åœ¨æ§åˆ¶å™¨ç±»Test1Controllerä¸­å¢åŠ ç™»å½•å¹¶ä¸”åˆ›å»ºJWTçš„æ“ä½œæ–¹æ³•Loginã€‚</p></li></ol><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">BuildToken</span>(<span class="params">IEnumerable&lt;Claim&gt; claims, JWTOptions options</span>)</span></span><br><span class="line"> &#123;</span><br><span class="line">     <span class="comment"><span class="doctag">///</span>ä»é…ç½®ä¸­è¯»å–è¿‡æœŸç§’æ•°ï¼Œè®¡ç®—ä»¤ç‰Œè¿‡æœŸæ—¶é—´</span></span><br><span class="line">     DateTime expires = DateTime.Now.AddSeconds(options.ExpirSeconds);</span><br><span class="line">     <span class="comment">//ä½¿ç”¨é…ç½®ä¸­çš„ç­¾åå¯†é’¥åˆ›å»ºå®‰å…¨å¯†é’¥å¯¹è±¡</span></span><br><span class="line">     <span class="built_in">byte</span>[] keyBytes = Encoding.UTF8.GetBytes(options.SigningKey);</span><br><span class="line">     <span class="comment">//æŒ‡å®š HMAC SHA-256 ç®—æ³•è¿›è¡Œç­¾å</span></span><br><span class="line">     <span class="keyword">var</span> secKey = <span class="keyword">new</span> SymmetricSecurityKey(keyBytes);</span><br><span class="line">     <span class="keyword">var</span> credentials = <span class="keyword">new</span> SigningCredentials(secKey, SecurityAlgorithms.HmacSha256Signature);</span><br><span class="line">     <span class="comment">//åˆ›å»º JWT ä»¤ç‰Œæè¿°ç¬¦ï¼ŒåŒ…å«è¿‡æœŸæ—¶é—´, ç­¾åå‡­è¯, ç”¨æˆ·å£°æ˜</span></span><br><span class="line">     <span class="keyword">var</span> tokenDescriptor = <span class="keyword">new</span> JwtSecurityToken(expires: expires, signingCredentials: credentials, claims: claims);</span><br><span class="line">     <span class="comment">//ä½¿ç”¨JwtSecurityTokenHandlerå°†ä»¤ç‰Œæè¿°ç¬¦è½¬æ¢ä¸º JWT å­—ç¬¦ä¸²</span></span><br><span class="line">     <span class="keyword">return</span> <span class="keyword">new</span> JwtSecurityTokenHandler().WriteToken(tokenDescriptor);</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line">[<span class="meta">HttpPost</span>]</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;IActionResult&gt; <span class="title">Login</span>(<span class="params">LoginRequest loginRequest, [FromServices] IOptions&lt;JWTOptions&gt; jwtOptions</span>)</span></span><br><span class="line">&#123;  <span class="comment">//LoginRequestï¼šåŒ…å«ç”¨æˆ·åå’Œå¯†ç çš„ç™»å½•è¯·æ±‚æ¨¡å‹</span></span><br><span class="line">   <span class="comment">//IOptions&lt;JWTOptions&gt;ï¼šä»ä¾èµ–æ³¨å…¥å®¹å™¨è·å– JWT é…ç½®é€‰é¡¹</span></span><br><span class="line">    <span class="built_in">string</span> userName = loginRequest.UserName;</span><br><span class="line">    <span class="built_in">string</span> password = loginRequest.Password;</span><br><span class="line">    <span class="comment">//é€šè¿‡ç”¨æˆ·åæŸ¥æ‰¾ç”¨æˆ·</span></span><br><span class="line">    <span class="keyword">var</span> user = <span class="keyword">await</span> _userManager.FindByNameAsync(userName);</span><br><span class="line">    <span class="comment">//éªŒè¯å¯†ç æ˜¯å¦æ­£ç¡®</span></span><br><span class="line">    <span class="keyword">var</span> success = <span class="keyword">await</span> _userManager.CheckPasswordAsync(user, password);</span><br><span class="line">    <span class="keyword">if</span> (!success&amp;&amp;user==<span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//éªŒè¯å¤±è´¥è¿”å› HTTP 400 é”™è¯¯</span></span><br><span class="line">        <span class="keyword">return</span> BadRequest(<span class="string">&quot;ç”¨æˆ·åæˆ–è€…å¯†ç é”™è¯¯&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> claims = <span class="keyword">new</span> List&lt;Claim&gt;();</span><br><span class="line">    <span class="comment">//NameIdentifierï¼šç”¨æˆ·å”¯ä¸€æ ‡è¯†</span></span><br><span class="line">    claims.Add(<span class="keyword">new</span> Claim(ClaimTypes.NameIdentifier, user.Id.ToString()));</span><br><span class="line">    <span class="comment">//Nameï¼šç”¨æˆ·å</span></span><br><span class="line">    claims.Add(<span class="keyword">new</span> Claim(ClaimTypes.Name, user.UserName));</span><br><span class="line">    <span class="keyword">var</span> roles = <span class="keyword">await</span> _userManager.GetRolesAsync(user);</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="keyword">var</span> role <span class="keyword">in</span> roles)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//Roleï¼šç”¨æˆ·è§’è‰²ï¼ˆå¯åŒ…å«å¤šä¸ªï¼‰</span></span><br><span class="line">        claims.Add(<span class="keyword">new</span> Claim(ClaimTypes.Role, role));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//è°ƒç”¨è¾…åŠ©æ–¹æ³•ç”Ÿæˆ JWT å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="comment">//è¿”å› HTTP 200 å“åº”ï¼ŒåŒ…å«ç”Ÿæˆçš„ä»¤ç‰Œ</span></span><br><span class="line">    <span class="built_in">string</span> jwtToken = BuildToken(claims, jwtOptions.Value);</span><br><span class="line">    <span class="keyword">return</span> Ok(jwtToken);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="6"><li>åœ¨éœ€è¦ç™»å½•æ‰èƒ½è®¿é—®çš„é›†çº¿å™¨ç±»ä¸Šæˆ–è€…æ–¹æ³•ä¸Šæ·»åŠ [Authorize]ã€‚</li></ol><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">Authorize</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ChatHub</span> : <span class="title">Hub</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> UserManager&lt;User&gt; _userManager;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ChatHub</span>(<span class="params">UserManager&lt;User&gt; userManager</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _userManager = userManager;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‘é€å…¬å…±æ¶ˆæ¯</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Task <span class="title">SendPublicMessage</span>(<span class="params"><span class="built_in">string</span> message</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> userName = Context.User.Identity.Name;</span><br><span class="line">        <span class="built_in">string</span> time = DateTime.Now.ToString(<span class="string">&quot;HH:mm&quot;</span>);</span><br><span class="line">        <span class="built_in">string</span> msg = <span class="string">$&quot;<span class="subst">&#123;userName&#125;</span>(<span class="subst">&#123;Context.ConnectionId&#125;</span>) <span class="subst">&#123;time&#125;</span>: <span class="subst">&#123;message&#125;</span>&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Clients.All.SendAsync(<span class="string">&quot;ReceivePublicMessage&quot;</span>, msg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="7"><li>å‰ç«¯ä»£ç </li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">fieldset</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">legend</span>&gt;</span>ç™»å½•<span class="tag">&lt;/<span class="name">legend</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            ç”¨æˆ·åï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;state.loginData.userName&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            å¯†ç ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span>  <span class="attr">v-model</span>=<span class="string">&quot;state.loginData.password&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ç™»å½•&quot;</span> <span class="attr">v-on:click</span>=<span class="string">&quot;loginClick&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">fieldset</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    å…¬å±ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;state.userMessage&quot;</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">v-on:keypress</span>=<span class="string">&quot;txtMsgOnkeypress&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;(msg,index) in state.messages&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;index&quot;</span>&gt;</span>&#123;&#123;msg&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">import</span> &#123; reactive, onMounted &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">import</span> * <span class="keyword">as</span> signalR <span class="keyword">from</span> <span class="string">&#x27;@microsoft/signalr&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">let</span> connection;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;<span class="attr">name</span>: <span class="string">&#x27;Login&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="comment">// stateä¸­å¢åŠ ä¸€ä¸ªå¯¹ç”¨æˆ·åã€å¯†ç è¿›è¡Œç»‘å®šçš„å±æ€§ï¼Œä»¥åŠä¸€ä¸ªä¿å­˜ç™»å½•JWTçš„å±æ€§</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="keyword">const</span> state = <span class="title function_">reactive</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">accessToken</span>:<span class="string">&quot;&quot;</span>,<span class="attr">userMessage</span>: <span class="string">&quot;&quot;</span>, <span class="attr">messages</span>: [],</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">loginData</span>: &#123; <span class="attr">userName</span>: <span class="string">&quot;&quot;</span>, <span class="attr">password</span>: <span class="string">&quot;&quot;</span> &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">privateMsg</span>: &#123; <span class="attr">destUserName</span>:<span class="string">&quot;&quot;</span>,<span class="attr">message</span>:<span class="string">&quot;&quot;</span>&#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="comment">// å¯åŠ¨ SignalR è¿æ¥</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="keyword">const</span> startConn = <span class="keyword">async</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="comment">// é…ç½® SignalR è¿æ¥</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="keyword">const</span> transport = signalR.<span class="property">HttpTransportType</span>.<span class="property">WebSockets</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="keyword">const</span> options = &#123; <span class="attr">skipNegotiation</span>: <span class="literal">true</span>, <span class="attr">transport</span>: transport &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="comment">// é€šè¿‡optionsçš„accessTokenFactoryå›è°ƒå‡½æ•°æŠŠJWTä¼ é€’ç»™æœåŠ¡å™¨ç«¯</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="comment">// åˆ›å»ºå¹¶å¯åŠ¨è¿æ¥</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                options.<span class="property">accessTokenFactory</span> = <span class="function">() =&gt;</span> state.<span class="property">accessToken</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                connection = <span class="keyword">new</span> signalR.<span class="title class_">HubConnectionBuilder</span>()</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                    .<span class="title function_">withUrl</span>(<span class="string">&#x27;https://localhost:7122/Hubs/ChatRoomHub&#x27;</span>, options)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                    .<span class="title function_">withAutomaticReconnect</span>().<span class="title function_">build</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="keyword">try</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                    <span class="keyword">await</span> connection.<span class="title function_">start</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                &#125; <span class="keyword">catch</span> (err) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                    <span class="title function_">alert</span>(err);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                    <span class="keyword">return</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="comment">// æ³¨å†Œæ¶ˆæ¯æ¥æ”¶å¤„ç†å‡½æ•°</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                connection.<span class="title function_">on</span>(<span class="string">&#x27;ReceivePublicMessage&#x27;</span>, <span class="function"><span class="params">msg</span> =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                    state.<span class="property">messages</span>.<span class="title function_">push</span>(msg);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="title function_">alert</span>(<span class="string">&quot;ç™»é™†æˆåŠŸå¯ä»¥èŠå¤©äº†&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="comment">// ç™»å½•æŒ‰é’®çš„å“åº”å‡½æ•°</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="keyword">const</span> loginClick = <span class="keyword">async</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="comment">// å‘é€ç™»å½•è¯·æ±‚è·å– JWT</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="keyword">const</span> resp = <span class="keyword">await</span> axios.<span class="title function_">post</span>(<span class="string">&#x27;https://localhost:7122/Test/Login&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                    state.<span class="property">loginData</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                state.<span class="property">accessToken</span> = resp.<span class="property">data</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="comment">// å¯åŠ¨ SignalR è¿æ¥</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="title function_">startConn</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="comment">// å…¬å±æ¶ˆæ¯è¾“å…¥æ¡†çš„æŒ‰é”®å¤„ç†</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="keyword">const</span> txtMsgOnkeypress = <span class="keyword">async</span> <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="keyword">if</span> (e.<span class="property">keyCode</span> != <span class="number">13</span>) <span class="keyword">return</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="keyword">try</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                    <span class="comment">// è°ƒç”¨æœåŠ¡å™¨ç«¯æ–¹æ³•å‘é€æ¶ˆæ¯</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                    <span class="keyword">await</span> connection.<span class="title function_">invoke</span>(<span class="string">&quot;SendPublicMessage&quot;</span>, state.<span class="property">userMessage</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                &#125;<span class="keyword">catch</span> (err) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                    <span class="title function_">alert</span>(err);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                    <span class="keyword">return</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                state.<span class="property">userMessage</span> = <span class="string">&quot;&quot;</span>;<span class="comment">// æ¸…ç©ºè¾“å…¥æ¡†</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="comment">// ç§ä¿¡è¾“å…¥æ¡†çš„æŒ‰é”®å¤„ç†</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="keyword">const</span> txtPrivateMsgOnkeypress = <span class="keyword">async</span> <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="keyword">if</span> (e.<span class="property">keyCode</span> != <span class="number">13</span>) <span class="keyword">return</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="keyword">const</span> destUserName = state.<span class="property">privateMsg</span>.<span class="property">destUserName</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="keyword">const</span> msg = state.<span class="property">privateMsg</span>.<span class="property">message</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="keyword">try</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                    <span class="keyword">const</span> ret = <span class="keyword">await</span> connection.<span class="title function_">invoke</span>(<span class="string">&quot;SendPublicMessage&quot;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                        destUserName, msg);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                    <span class="keyword">if</span> (ret != <span class="string">&quot;ok&quot;</span>) &#123; <span class="title function_">alert</span>(ret);&#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                &#125; <span class="keyword">catch</span> (err) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                    <span class="title function_">alert</span>(err);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                    <span class="keyword">return</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                state.<span class="property">privateMsg</span>.<span class="property">message</span> = <span class="string">&quot;&quot;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="keyword">return</span> &#123; state, loginClick, txtMsgOnkeypress, txtPrivateMsgOnkeypress&#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h1 id="SignalRï¼šé’ˆå¯¹éƒ¨åˆ†å®¢æˆ·ç«¯çš„æ¶ˆæ¯æ¨é€"><a href="#SignalRï¼šé’ˆå¯¹éƒ¨åˆ†å®¢æˆ·ç«¯çš„æ¶ˆæ¯æ¨é€" class="headerlink" title="SignalRï¼šé’ˆå¯¹éƒ¨åˆ†å®¢æˆ·ç«¯çš„æ¶ˆæ¯æ¨é€"></a>SignalRï¼šé’ˆå¯¹éƒ¨åˆ†å®¢æˆ·ç«¯çš„æ¶ˆæ¯æ¨é€</h1><blockquote><p>åœ¨æˆ‘ä»¬è¿›è¡Œå®¢æˆ·ç«¯ç­›é€‰çš„æ—¶å€™ï¼Œæœ‰3ä¸ªç­›é€‰å‚æ•°ï¼šConnectionIdã€ç»„åˆç”¨æˆ·IDã€‚ConnectionionIdæ˜¯SignalRä¸ºæ¯ä¸ªè¿æ¥åˆ†é…çš„å”¯ä¸€æ ‡è¯†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é›†çº¿å™¨çš„Contextå±æ€§ä¸­çš„ConnectionIdå±æ€§è·å–å½“å‰è¿æ¥çš„ConnectionIdï¼šæ¯ä¸ªç»„æœ‰å”¯ä¸€çš„åå­—ï¼Œå¯¹äºè¿æ¥åˆ°åŒä¸€ä¸ªé›†çº¿å™¨ä¸­çš„å®¢æˆ·ç«¯ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒä»¬åˆ†ç»„ï¼›ç”¨æˆ·IDæ˜¯ç™»å½•ç”¨æˆ·çš„IDï¼Œå®ƒå¯¹åº”çš„æ˜¯ç±»å‹ä¸ºClaimTypes.NameIdentifierçš„Claimçš„å€¼ï¼Œå¦‚æœä½¿ç”¨ç”¨æˆ·IDè¿›è¡Œç­›é€‰ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å®¢æˆ·ç«¯ç™»å½•çš„æ—¶å€™è®¾å®šç±»å‹ä¸ºClaimTypes.NameIdentifierçš„Claimã€‚</p></blockquote><p><b>Hubç±»</b><br>Hubç±»çš„Groupså±æ€§ä¸ºIGroupManagerç±»å‹ï¼Œå®ƒå¯ä»¥ç”¨æ¥å¯¹ç»„æˆå‘˜è¿›è¡Œç®¡ç†ï¼ŒIGroupManagerç±»åŒ…å«å¦‚ä¸‹æ‰€ç¤ºçš„æ–¹æ³•ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ‰§è¡Œåï¼Œè¯¥å®¢æˆ·ç«¯å°†è¢«æ·»åŠ åˆ°æŒ‡å®šåç§°çš„ç»„ä¸­</span></span><br><span class="line"><span class="keyword">await</span> <span class="keyword">this</span>.Groups.AddToGroupAsync(connId, message);</span><br><span class="line"><span class="comment">//æ‰§è¡Œåï¼Œè¯¥å®¢æˆ·ç«¯å°†ä¸å†å±äºæŒ‡å®šçš„ç»„</span></span><br><span class="line"><span class="keyword">await</span> <span class="keyword">this</span>.Groups.RemoveFromGroupAsync(connId, message);</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬åœ¨æŠŠè¿æ¥åŠ å…¥ç»„ä¸­çš„æ—¶å€™ï¼Œå¦‚æœæŒ‡å®šåå­—çš„ç»„ä¸å­˜åœ¨ï¼ŒSignalRä¼šè‡ªåŠ¨åˆ›å»ºç»„ã€‚å› ä¸ºè¿æ¥å’Œç»„çš„å…³ç³»æ˜¯é€šè¿‡ConnectionIdå»ºç«‹çš„ï¼Œæ‰€ä»¥å®¢æˆ·ç«¯é‡è¿ä¹‹åï¼Œæˆ‘ä»¬å°±éœ€è¦æŠŠè¿æ¥é‡æ–°åŠ å…¥ç»„ã€‚</p><p>Hubç±»çš„Clientså±æ€§ä¸ºIHubCallerClientsç±»å‹ï¼Œå®ƒå¯ä»¥ç”¨æ¥å¯¹è¿æ¥åˆ°å½“å‰é›†çº¿å™¨çš„å®¢æˆ·ç«¯è¿›è¡Œç­›é€‰ã€‚IHubCallerClientsç±»åŒ…å«å¦‚ä¸‹æ‰€ç¤ºçš„æˆå‘˜ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è·å–å½“å‰è¿æ¥çš„å®¢æˆ·ç«¯</span></span><br><span class="line">T Caller &#123; <span class="keyword">get</span>; &#125;</span><br><span class="line"><span class="comment">//è·å–é™¤äº†å½“å‰è¿æ¥å¤–çš„æ‰€æœ‰å®¢æˆ·ç«¯</span></span><br><span class="line">T Others &#123; <span class="keyword">get</span>; &#125;</span><br><span class="line"><span class="comment">//è·å–åå­—ä¸ºgroupNameç»„ä¸­é™¤äº†å½“å‰è¿æ¥å¤–çš„å…¶ä»–å®¢æˆ·ç«¯</span></span><br><span class="line"><span class="function">T <span class="title">OthersInGroup</span>(<span class="params"><span class="built_in">string</span> groupName</span>)</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//è·å–æ‰€æœ‰è¿æ¥çš„å®¢æˆ·ç«¯</span></span><br><span class="line">T All &#123; <span class="keyword">get</span>; &#125;</span><br><span class="line"><span class="comment">//è·å–é™¤äº†excludedConnectionIdsçš„å®¢æˆ·ç«¯</span></span><br><span class="line"><span class="function">T <span class="title">AllExcept</span>(<span class="params">IReadOnlyList&lt;<span class="built_in">string</span>&gt; excludedConnectionIds</span>)</span>;</span><br><span class="line"><span class="comment">//è·å–connectionIdå®¢æˆ·ç«¯</span></span><br><span class="line"><span class="function">T <span class="title">Client</span>(<span class="params"><span class="built_in">string</span> connectionId</span>)</span>;</span><br><span class="line"><span class="comment">//è·å–åŒ…å«åœ¨connectionIdsä¸­çš„å®¢æˆ·ç«¯</span></span><br><span class="line"><span class="function">T <span class="title">Clients</span>(<span class="params">IReadOnlyList&lt;<span class="built_in">string</span>&gt; connectionIds</span>)</span>;</span><br><span class="line"><span class="comment">//è·å–ç»„ågroupNameä¸­çš„å®¢æˆ·ç«¯</span></span><br><span class="line"><span class="function">T <span class="title">Group</span>(<span class="params"><span class="built_in">string</span> groupName</span>)</span>;</span><br><span class="line"><span class="comment">//è·å–ç»„ågroupNameä¸­çš„å®¢æˆ·ç«¯ï¼Œé™¤äº†åœ¨excludedConnectionIdsä¸­</span></span><br><span class="line"><span class="function">T <span class="title">GroupExcept</span>(<span class="params"><span class="built_in">string</span> groupName, IReadOnlyList&lt;<span class="built_in">string</span>&gt; excludedConnectionIds</span>)</span>;</span><br><span class="line"><span class="comment">//è·å–ç»„ååŒ…å«åœ¨groupNamesä¸­çš„å®¢æˆ·ç«¯</span></span><br><span class="line"><span class="function">T <span class="title">Groups</span>(<span class="params">IReadOnlyList&lt;<span class="built_in">string</span>&gt; groupNames</span>)</span>;</span><br><span class="line"><span class="comment">//è·å–ç”¨æˆ·idçš„å®¢æˆ·ç«¯</span></span><br><span class="line"><span class="function">T <span class="title">User</span>(<span class="params"><span class="built_in">string</span> userId</span>)</span>;</span><br><span class="line"><span class="comment">//è·å–ç”¨æˆ·idåŒ…å«åœ¨userIdsä¸­çš„å®¢æˆ·ç«¯</span></span><br><span class="line"><span class="function">T <span class="title">Users</span>(<span class="params">IReadOnlyList&lt;<span class="built_in">string</span>&gt; userIds</span>)</span>;</span><br></pre></td></tr></table></figure><p><b>å‘é€ç§èŠæ¶ˆæ¯</b></p><p>ä¸‹é¢æˆ‘ä»¬æ¥ä¸ºä¹‹å‰ç¼–å†™çš„WebèŠå¤©å®¤å¢åŠ â€œå‘é€ç§èŠæ¶ˆæ¯â€çš„åŠŸèƒ½ã€‚</p><ol><li>åœ¨ChatRoomHubä¸­å¢åŠ ä¸€ä¸ªå‘é€ç§èŠæ¶ˆæ¯çš„SendPrivateMessageæ–¹æ³•ã€‚</li></ol><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">Authorize</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ChatHub</span> : <span class="title">Hub</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> UserManager&lt;User&gt; _userManager;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ChatHub</span>(<span class="params">UserManager&lt;User&gt; userManager</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _userManager = userManager;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‘é€å…¬å…±æ¶ˆæ¯</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Task <span class="title">SendPublicMessage</span>(<span class="params"><span class="built_in">string</span> message</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> userName = Context.User.Identity.Name;</span><br><span class="line">        <span class="built_in">string</span> time = DateTime.Now.ToString(<span class="string">&quot;HH:mm&quot;</span>);</span><br><span class="line">        <span class="built_in">string</span> msg = <span class="string">$&quot;<span class="subst">&#123;userName&#125;</span>(<span class="subst">&#123;Context.ConnectionId&#125;</span>) <span class="subst">&#123;time&#125;</span>: <span class="subst">&#123;message&#125;</span>&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Clients.All.SendAsync(<span class="string">&quot;ReceivePublicMessage&quot;</span>, msg);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å‘é€ç§äººæ¶ˆæ¯</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;<span class="built_in">string</span>&gt; <span class="title">SendPrivateMessage</span>(<span class="params"><span class="built_in">string</span> destUserName, <span class="built_in">string</span> message</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> destUser = <span class="keyword">await</span> _userManager.FindByNameAsync(destUserName);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (destUser == <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;ç›®æ ‡ç”¨æˆ·ä¸å­˜åœ¨&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">string</span> srcUserName = Context.User.Identity.Name;</span><br><span class="line">        <span class="built_in">string</span> time = DateTime.Now.ToString(<span class="string">&quot;HH:mm&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">await</span> Clients.User(destUser.Id.ToString())</span><br><span class="line">            .SendAsync(<span class="string">&quot;ReceivePrivateMessage&quot;</span>, srcUserName, time, message);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ok&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒSignalRä¸ä¼šå¯¹æ¶ˆæ¯è¿›è¡ŒæŒä¹…åŒ–ï¼Œå› æ­¤å³ä½¿ç›®æ ‡ç”¨æˆ·å½“å‰ä¸åœ¨çº¿ï¼ŒSendAsyncæ–¹æ³•çš„è°ƒç”¨ä¹Ÿä¸ä¼šå‡ºé”™ï¼Œè€Œä¸”ç”¨æˆ·ä¸Šçº¿åä¹Ÿä¸ä¼šæ”¶åˆ°ç¦»çº¿æœŸé—´çš„æ¶ˆæ¯ã€‚åŒæ ·çš„é“ç†ä¹Ÿé€‚ç”¨äºåˆ†ç»„å‘é€æ¶ˆæ¯ï¼Œç”¨æˆ·åœ¨ä¸Šçº¿åæ‰èƒ½åŠ å…¥ä¸€ä¸ªåˆ†ç»„ï¼Œå› æ­¤ç”¨æˆ·ä¹Ÿæ— æ³•æ”¶åˆ°ç¦»çº¿æœŸé—´è¯¥ç»„å†…çš„æ¶ˆæ¯ã€‚</p><p>å¦‚æœæˆ‘ä»¬çš„ç³»ç»Ÿéœ€è¦å®ç°æ¥æ”¶ç¦»çº¿æœŸé—´çš„æ¶ˆæ¯çš„åŠŸèƒ½ï¼Œå°±éœ€è¦å†è‡ªè¡Œé¢å¤–å¼€å‘æ¶ˆæ¯çš„æŒä¹…åŒ–åŠŸèƒ½ï¼Œæ¯”å¦‚æœåŠ¡å™¨ç«¯åœ¨å‘å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯çš„åŒæ—¶ï¼Œä¹Ÿè¦æŠŠæ¶ˆæ¯ä¿å­˜åˆ°æ•°æ®åº“ä¸­ï¼›åœ¨ç”¨æˆ·ä¸Šçº¿æ—¶ï¼Œç¨‹åºè¦å…ˆåˆ°æ•°æ®åº“ä¸­æŸ¥è¯¢å†å²æ¶ˆæ¯ã€‚</p><ol start="2"><li>åœ¨å‰ç«¯é¡µé¢å¢åŠ ç§èŠåŠŸèƒ½çš„ç•Œé¢å’Œä»£ç ã€‚</li></ol><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®¢æˆ·ç«¯ä»£ç </span></span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;div v-<span class="keyword">if</span>=<span class="string">&quot;!state.isConnected&quot;</span>&gt;</span><br><span class="line">            &lt;fieldset&gt;</span><br><span class="line">                &lt;legend&gt;ç™»å½•&lt;/legend&gt;</span><br><span class="line">                &lt;div&gt;</span><br><span class="line">                    ç”¨æˆ·åï¼š&lt;input type=<span class="string">&quot;text&quot;</span> v-model=<span class="string">&quot;state.loginData.userName&quot;</span>/&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div&gt;</span><br><span class="line">                    å¯†ç ï¼š&lt;input type=<span class="string">&quot;password&quot;</span>  v-model=<span class="string">&quot;state.loginData.password&quot;</span>&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div&gt;</span><br><span class="line">                    &lt;input type=<span class="string">&quot;button&quot;</span> <span class="keyword">value</span>=<span class="string">&quot;ç™»å½•&quot;</span> v-<span class="keyword">on</span>:click=<span class="string">&quot;loginClick&quot;</span>/&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            &lt;/fieldset&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        </span><br><span class="line">        &lt;div v-<span class="keyword">else</span>&gt;</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                å…¬å±ï¼š&lt;input type=<span class="string">&quot;text&quot;</span> v-model=<span class="string">&quot;state.userMessage&quot;</span> </span><br><span class="line">                    v-<span class="keyword">on</span>:keypress=<span class="string">&quot;txtMsgOnkeypress&quot;</span> /&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            </span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                ç§èŠç»™ï¼š&lt;input type=<span class="string">&quot;text&quot;</span> v-model=<span class="string">&quot;state.privateMsg.destUserName&quot;</span>/&gt;</span><br><span class="line">                è¯´ï¼š&lt;input type=<span class="string">&quot;text&quot;</span> v-model=<span class="string">&quot;state.privateMsg.message&quot;</span> </span><br><span class="line">                    v-<span class="keyword">on</span>:keypress=<span class="string">&quot;txtPrivateMsgOnkeypress&quot;</span>/&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            </span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;h3&gt;æ¶ˆæ¯åˆ—è¡¨&lt;/h3&gt;</span><br><span class="line">                &lt;ul&gt;</span><br><span class="line">                    &lt;li v-<span class="keyword">for</span>=<span class="string">&quot;(msg, index) in state.messages&quot;</span> :key=<span class="string">&quot;index&quot;</span></span><br><span class="line">                        :<span class="keyword">class</span>=<span class="string">&quot;&#123; &#x27;private-message&#x27;: msg.isPrivate &#125;&quot;</span>&gt;</span><br><span class="line">                        &#123;&#123; msg.content &#125;&#125;</span><br><span class="line">                    &lt;/li&gt;</span><br><span class="line">                &lt;/ul&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    import &#123; reactive, onMounted &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span>;</span><br><span class="line">    import * <span class="keyword">as</span> signalR <span class="keyword">from</span> <span class="string">&#x27;@microsoft/signalr&#x27;</span>;</span><br><span class="line">    import axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span>;</span><br><span class="line">    </span><br><span class="line">    export <span class="literal">default</span> &#123;</span><br><span class="line">        name: <span class="string">&#x27;ChatComponent&#x27;</span>,</span><br><span class="line">        setup() &#123;</span><br><span class="line">            <span class="keyword">const</span> state = reactive(&#123;</span><br><span class="line">                accessToken: <span class="string">&quot;&quot;</span>,</span><br><span class="line">                userMessage: <span class="string">&quot;&quot;</span>,</span><br><span class="line">                messages: [],</span><br><span class="line">                loginData: &#123; userName: <span class="string">&quot;&quot;</span>, password: <span class="string">&quot;&quot;</span> &#125;,</span><br><span class="line">                privateMsg: &#123; destUserName: <span class="string">&quot;&quot;</span>, message: <span class="string">&quot;&quot;</span> &#125;,</span><br><span class="line">                isConnected: <span class="literal">false</span></span><br><span class="line">            &#125;);</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">let</span> connection = <span class="literal">null</span>;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">const</span> startConn = <span class="function"><span class="keyword">async</span> <span class="title">function</span> ()</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (connection) &#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        <span class="keyword">await</span> connection.stop();</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">                        console.error(<span class="string">&#x27;åœæ­¢è¿æ¥æ—¶å‡ºé”™:&#x27;</span>, err);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// è¿æ¥åˆ°æ­£ç¡®çš„ Hubï¼ˆChatHubï¼‰</span></span><br><span class="line">                <span class="keyword">const</span> options = &#123;</span><br><span class="line">                    skipNegotiation: <span class="literal">true</span>,</span><br><span class="line">                    transport: signalR.HttpTransportType.WebSockets,</span><br><span class="line">                    accessTokenFactory: () =&gt; state.accessToken</span><br><span class="line">                &#125;;</span><br><span class="line">                </span><br><span class="line">                connection = <span class="keyword">new</span> signalR.HubConnectionBuilder()</span><br><span class="line">                    .withUrl(<span class="string">&#x27;https://localhost:7122/Hubs/ChatHub&#x27;</span>, options)</span><br><span class="line">                    .withAutomaticReconnect().build();</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// ç›‘å¬è¿æ¥çŠ¶æ€</span></span><br><span class="line">                connection.onclose(error =&gt; &#123;</span><br><span class="line">                    console.log(<span class="string">&#x27;è¿æ¥å·²å…³é—­:&#x27;</span>, error);</span><br><span class="line">                    state.isConnected = <span class="literal">false</span>;</span><br><span class="line">                &#125;);</span><br><span class="line">                </span><br><span class="line">                connection.onreconnected(connectionId =&gt; &#123;</span><br><span class="line">                    console.log(<span class="string">&#x27;å·²é‡æ–°è¿æ¥ï¼ŒID:&#x27;</span>, connectionId);</span><br><span class="line">                    state.isConnected = <span class="literal">true</span>;</span><br><span class="line">                &#125;);</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">await</span> connection.start();</span><br><span class="line">                    state.isConnected = <span class="literal">true</span>;</span><br><span class="line">                    </span><br><span class="line">                    <span class="comment">// æ³¨å†Œæ¶ˆæ¯å¤„ç†å‡½æ•°</span></span><br><span class="line">                    connection.<span class="keyword">on</span>(<span class="string">&#x27;ReceivePublicMessage&#x27;</span>, (msg) =&gt; &#123;</span><br><span class="line">                        console.log(<span class="string">&#x27;æ”¶åˆ°å…¬å…±æ¶ˆæ¯:&#x27;</span>, msg);</span><br><span class="line">                        state.messages.push(&#123;</span><br><span class="line">                            content: msg,</span><br><span class="line">                            isPrivate: <span class="literal">false</span></span><br><span class="line">                        &#125;);</span><br><span class="line">                    &#125;);</span><br><span class="line">                    </span><br><span class="line">                    connection.<span class="keyword">on</span>(<span class="string">&#x27;ReceivePrivateMessage&#x27;</span>, (srcUser, time, msg) =&gt; &#123;</span><br><span class="line">                        console.log(<span class="string">&#x27;æ”¶åˆ°ç§ä¿¡:&#x27;</span>, srcUser, time, msg);</span><br><span class="line">                        state.messages.push(&#123;</span><br><span class="line">                            content: `$&#123;srcUser&#125;åœ¨$&#123;time&#125;å‘æ¥ç§ä¿¡: $&#123;msg&#125;`,</span><br><span class="line">                            isPrivate: <span class="literal">true</span></span><br><span class="line">                        &#125;);</span><br><span class="line">                    &#125;);</span><br><span class="line">                    </span><br><span class="line">                    alert(<span class="string">&quot;ç™»å½•æˆåŠŸï¼Œå¯ä»¥å¼€å§‹èŠå¤©äº†&quot;</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">                    console.error(<span class="string">&#x27;è¿æ¥å¤±è´¥:&#x27;</span>, err);</span><br><span class="line">                    alert(<span class="string">&#x27;è¿æ¥æœåŠ¡å™¨å¤±è´¥: &#x27;</span> + err.message);</span><br><span class="line">                    state.isConnected = <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">const</span> loginClick = <span class="function"><span class="keyword">async</span> <span class="title">function</span> ()</span> &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">const</span> resp = <span class="keyword">await</span> axios.post(<span class="string">&#x27;https://localhost:7122/Test/Login&#x27;</span>,</span><br><span class="line">                        state.loginData);</span><br><span class="line">                    state.accessToken = resp.data;</span><br><span class="line">                    startConn();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">                    alert(<span class="string">&#x27;ç™»å½•å¤±è´¥: &#x27;</span> + err.message);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">const</span> ensureConnection = () =&gt; &#123;</span><br><span class="line">                <span class="keyword">if</span> (!connection || connection.state !== signalR.HubConnectionState.Connected) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string">&#x27;è¿æ¥æœªå»ºç«‹æˆ–å·²æ–­å¼€ï¼Œè¯·å…ˆç™»å½•&#x27;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">const</span> txtMsgOnkeypress = <span class="function"><span class="keyword">async</span> <span class="title">function</span> (<span class="params">e</span>)</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (e.keyCode !== <span class="number">13</span>) <span class="keyword">return</span>;</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    ensureConnection();</span><br><span class="line">                    <span class="keyword">await</span> connection.invoke(<span class="string">&quot;SendPublicMessage&quot;</span>, state.userMessage);</span><br><span class="line">                    state.userMessage = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">                    alert(err.message);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">const</span> txtPrivateMsgOnkeypress = <span class="function"><span class="keyword">async</span> <span class="title">function</span> (<span class="params">e</span>)</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (e.keyCode !== <span class="number">13</span>) <span class="keyword">return</span>;</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">const</span> destUserName = state.privateMsg.destUserName;</span><br><span class="line">                <span class="keyword">const</span> msg = state.privateMsg.message;</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> (!destUserName || !msg) &#123;</span><br><span class="line">                    alert(<span class="string">&#x27;è¯·è¾“å…¥ç›®æ ‡ç”¨æˆ·å’Œæ¶ˆæ¯å†…å®¹&#x27;</span>);</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    ensureConnection();</span><br><span class="line">                    <span class="keyword">const</span> ret = <span class="keyword">await</span> connection.invoke(<span class="string">&quot;SendPrivateMessage&quot;</span>, destUserName, msg);</span><br><span class="line">                    <span class="keyword">if</span> (ret !== <span class="string">&quot;ok&quot;</span>) &#123;</span><br><span class="line">                        alert(ret);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="comment">// åœ¨è‡ªå·±çš„æ¶ˆæ¯åˆ—è¡¨ä¸­æ˜¾ç¤ºå·²å‘é€çš„ç§ä¿¡</span></span><br><span class="line">                        <span class="keyword">const</span> time = <span class="keyword">new</span> Date().toLocaleTimeString();</span><br><span class="line">                        state.messages.push(&#123;</span><br><span class="line">                            content: `ä½ åœ¨$&#123;time&#125;ç»™$&#123;destUserName&#125;å‘é€äº†ç§ä¿¡: $&#123;msg&#125;`,</span><br><span class="line">                            isPrivate: <span class="literal">true</span></span><br><span class="line">                        &#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                    state.privateMsg.message = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">                    alert(err.message);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// ç»„ä»¶å¸è½½æ—¶å…³é—­è¿æ¥</span></span><br><span class="line">            onMounted(() =&gt; &#123;</span><br><span class="line">                <span class="keyword">return</span> () =&gt; &#123;</span><br><span class="line">                    <span class="keyword">if</span> (connection) &#123;</span><br><span class="line">                        connection.stop().<span class="keyword">catch</span>(err =&gt; &#123;</span><br><span class="line">                            console.error(<span class="string">&#x27;å…³é—­è¿æ¥æ—¶å‡ºé”™:&#x27;</span>, err);</span><br><span class="line">                        &#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;;</span><br><span class="line">            &#125;);</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">return</span> &#123; state, loginClick, txtMsgOnkeypress, txtPrivateMsgOnkeypress &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style <span class="keyword">scoped</span>&gt;</span><br><span class="line">.<span class="keyword">private</span>-message &#123;</span><br><span class="line">    color: blue;</span><br><span class="line">    font-weight: bold;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><h1 id="åœ¨å¤–éƒ¨å‘é›†çº¿å™¨æ¨é€æ¶ˆæ¯"><a href="#åœ¨å¤–éƒ¨å‘é›†çº¿å™¨æ¨é€æ¶ˆæ¯" class="headerlink" title="åœ¨å¤–éƒ¨å‘é›†çº¿å™¨æ¨é€æ¶ˆæ¯"></a>åœ¨å¤–éƒ¨å‘é›†çº¿å™¨æ¨é€æ¶ˆæ¯</h1><p>ä¸è¦å†Hubåšäº‹åŠ¡ï¼Œè¿æ³•å•ä¸€åŸåˆ™ã€‚</p><blockquote><p>å¯ä»¥åœ¨MVCæ§åˆ¶å™¨ã€æ‰˜ç®¡æœåŠ¡ç­‰å¤–éƒ¨å‘å®¢æˆ·ç«¯æ¨é€æ¶ˆæ¯ã€‚<br>å¯ä»¥é€šè¿‡æ³¨å…¥IHubContext&lt;THub&gt;æ¥è·å–å¯¹é›†çº¿å™¨è¿›è¡Œæ“ä½œçš„æœåŠ¡ã€‚</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> ILogger&lt;TestController&gt; _logger;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> UserManager&lt;User&gt; _userManager;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> RoleManager&lt;Role&gt; _roleManager;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">readonly</span> IHubContext&lt;ChatHub&gt; hubContext;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">TestController</span></span></span><br><span class="line"><span class="function">        (<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">            ILogger&lt;TestController&gt; logger,</span></span></span><br><span class="line"><span class="params"><span class="function">            UserManager&lt;User&gt; userManager,</span></span></span><br><span class="line"><span class="params"><span class="function">            RoleManager&lt;Role&gt; roleManager</span></span></span><br><span class="line"><span class="params"><span class="function">,</span></span></span><br><span class="line"><span class="params"><span class="function">            IHubContext&lt;ChatHub&gt; hubContext</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            _logger = logger;</span><br><span class="line">            _userManager = userManager;</span><br><span class="line">            _roleManager = roleManager;</span><br><span class="line">            <span class="keyword">this</span>.hubContext = hubContext;</span><br><span class="line">        &#125;</span><br><span class="line">        [<span class="meta">HttpPost</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;ActionResult&gt; <span class="title">AddUser</span>(<span class="params"><span class="built_in">string</span> userName,<span class="built_in">string</span> password</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            User user = <span class="keyword">new</span> User &#123; UserName = userName &#125;;</span><br><span class="line">            <span class="keyword">await</span> _userManager.CreateAsync(user,password);</span><br><span class="line">            hubContext.Clients.All.SendAsync(<span class="string">&quot;PublicMsgReceived&quot;</span>, <span class="string">&quot;æ¬¢è¿&quot;</span> + userName + <span class="string">&quot;åŠ å…¥æˆ‘ä»¬&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> Ok(<span class="string">&quot;åˆ›å»ºæˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ASP.NET Core </tag>
            
            <tag> Entity Framework Core </tag>
            
            <tag> JWT </tag>
            
            <tag> SignalR </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ASP.NET Core Sessionä¸JWT</title>
      <link href="/2025/05/09/asp.net%20core/ASP.NET%20Core%E9%AB%98%E7%BA%A7%E7%BB%84%E4%BB%B6/"/>
      <url>/2025/05/09/asp.net%20core/ASP.NET%20Core%E9%AB%98%E7%BA%A7%E7%BB%84%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="Authenticationä¸Authorization"><a href="#Authenticationä¸Authorization" class="headerlink" title="Authenticationä¸Authorization"></a>Authenticationä¸Authorization</h1><p>1.Authenticationå¯¹è®¿é—®è€…çš„ç”¨æˆ·èº«ä»½è¿›è¡ŒéªŒè¯ï¼Œâ€œç”¨æˆ·æ˜¯å¦ç™»é™†æˆåŠŸâ€ã€‚<br>2.AuthorizationéªŒè¯è®¿é—®è€…ç”¨æˆ·èº«ä»½æ˜¯å¦åˆå¯¹èµ„æºè®¿é—®çš„è®¿é—®æƒé™ï¼Œâ€œç”¨æˆ·æ˜¯å¦æœ‰æƒé™è®¿é—®è¿™ä¸ªåœ°å€â€ã€‚</p><h1 id="æ ‡è¯†ï¼ˆIdentityï¼‰æ¡†æ¶"><a href="#æ ‡è¯†ï¼ˆIdentityï¼‰æ¡†æ¶" class="headerlink" title="æ ‡è¯†ï¼ˆIdentityï¼‰æ¡†æ¶"></a>æ ‡è¯†ï¼ˆIdentityï¼‰æ¡†æ¶</h1><p>1.æ ‡è¯†ï¼ˆIdentityï¼‰æ¡†æ¶ï¼šé‡‡ç”¨åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆRole-Based Access Control,ç®€ç§°RBACï¼‰ç­–ç•¥ï¼Œå†…ç½®äº†å¯¹ç”¨æˆ·ã€è§’è‰²ç­‰è¡¨çš„ç®¡ç†ä»¥åŠç›¸å…³çš„æ¥å£ï¼Œæ”¯æŒå¤–éƒ¨ç™»å½•ã€2FAç­‰ã€‚<br>2.æ ‡è¯†æ¡†æ¶ä½¿ç”¨EF Coreå¯¹æ•°æ®è¿›è¡Œæ“ä½œï¼Œå› æ­¤æ ‡è¯†æ¡†æ¶æ”¯æŒå‡ ä¹æ‰€æœ‰æ•°æ®åº“ã€‚</p><h2 id="Identityæ¡†æ¶ä½¿ç”¨"><a href="#Identityæ¡†æ¶ä½¿ç”¨" class="headerlink" title="Identityæ¡†æ¶ä½¿ç”¨"></a>Identityæ¡†æ¶ä½¿ç”¨</h2><p>1.IdentityUser&lt;TKey&gt;ã€IdentityRole&lt;TKey&gt;,TKeyä»£è¡¨ä¸»é”®çš„ç±»å‹ã€‚æˆ‘ä»¬ä¸€èˆ¬ç¼–å†™ç»§æ‰¿è‡ªIdentityUser&lt;TKey&gt;ã€IdentityRole&lt;TKey&gt;ç­‰çš„è‡ªå®šä¹‰ç±»ï¼Œå¯ä»¥å¢åŠ è‡ªå®šä¹‰å±æ€§ã€‚<br>2.NuGetå®‰è£…<br>Microsoft.AspNetCore.Identity.EntityFrameworkCore<br>3.åˆ›å»ºç»§æ‰¿è‡ªIdentityDbContextçš„ç±»ã€‚<br>4.å¯ä»¥é€šè¿‡IdDbContextç±»æ¥æ“ä½œæ•°æ®åº“ï¼Œä¸è¿‡æ¡†æ¶ä¸­æä¾›äº†RoleManagerã€UserManagerç­‰ç±»æ¥ç®€åŒ–å¯¹æ•°æ®åº“çš„æ“ä½œã€‚<br>5.éƒ¨åˆ†æ–¹æ³•çš„è¿”å›å€¼ä¸ºTask&lt;IdentityResult&gt;ç±»å‹ï¼ŒæŸ¥çœ‹ã€è®²è§£IdentityResultç±»å‹å®šä¹‰ã€‚</p><ol><li>åˆ›å»ºç”¨æˆ·å®ä½“ç±»Userå’Œè§’è‰²å®ä½“ç±»Role. åˆ†åˆ«ç»§æ‰¿è‡ªIdentityUser&lt;long&gt;ã€IdentityRole&lt;long&gt;çš„Userç±»å’ŒRoleç±»ã€‚</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public class User:IdentityUser&lt;long&gt;</span><br><span class="line">&#123;</span><br><span class="line">    public DateTime CreationTime &#123; get; set; &#125;</span><br><span class="line">    public string? NickName &#123; get; set; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Role</span>:<span class="title">IdentityRole</span>&lt;<span class="title">long</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>IdnetityUserä¸­å®šä¹‰ç±»äº†å¾ˆå¤šå±æ€§ã€‚<br><img src="/img%5CWEBAPI%5C22.png"></p><p>é™¤äº†IdentityUserå’ŒIdentityRoleä¹‹å¤–ï¼Œè¡¨ç¤ºæ¡†æ¶ä¸­è¿˜æœ‰å¾ˆå¤šå…¶ä»–å®ä½“ç±»ã€‚</p><ol start="2"><li>åˆ›å»ºç»§æ‰¿è‡ªIdentityDbContextçš„ç±»ï¼Œè¿™æ˜¯ä¸€ä¸ªEF Coreä¸­çš„ä¸Šä¸‹æ–‡ç±»ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªç±»æ“ä½œæ•°æ®åº“ã€‚IdentityDbContextæ˜¯ä¸€ä¸ªæ³›å‹ç±»ï¼Œæœ‰3ä¸ªæ³›å‹å‚æ•°ï¼Œåˆ†åˆ«ä»£è¡¨ç”¨æˆ·ç±»å‹ã€è§’è‰²ç±»å‹å’Œä¸»é”®ç±»å‹ã€‚</li></ol><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">IdDbContext</span>:<span class="title">IdentityDbContext</span>&lt;<span class="title">User</span>,<span class="title">Role</span>,<span class="title">long</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">IdDbContext</span>(<span class="params">DbContextOptions&lt;IdDbContext&gt; options</span>)</span></span><br><span class="line"><span class="function">        : <span class="title">base</span>(<span class="params">options</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnModelCreating</span>(<span class="params">ModelBuilder builder</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">base</span>.OnModelCreating(builder);</span><br><span class="line">        <span class="keyword">new</span> UserConfig().Configure(builder.Entity&lt;User&gt;());</span><br><span class="line">        <span class="keyword">new</span> RoleConfig().Configure(builder.Entity&lt;Role&gt;());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ‡è¯†æ¡†æ¶ä¸­çš„æ–¹æ³•æœ‰æ‰§è¡Œå¤±è´¥çš„å¯èƒ½ï¼Œæ¯”å¦‚é‡ç½®å¯†ç å¯èƒ½ç”±äºå¯†ç å¤ªç®€å•è€Œå¤±è´¥ï¼Œå› æ­¤æ ‡è¯†æ¡†æ¶ä¸­éƒ¨åˆ†æ–¹æ³•çš„è¿”å›å€¼ä¸ºTaskç±»å‹ã€‚IdentityResultç±»å‹ä¸­æœ‰boolç±»å‹çš„Succeededå±æ€§è¡¨ç¤ºæ“ä½œæ˜¯å¦æˆåŠŸï¼›å¦‚æœæ“ä½œå¤±è´¥ï¼Œæˆ‘ä»¬å¯ä»¥ä»Errorså±æ€§ä¸­è·å–é”™è¯¯çš„è¯¦ç»†ä¿¡æ¯ï¼Œç”±äºæœ‰å¯èƒ½æœ‰å¤šæ¡é”™è¯¯ä¿¡æ¯ï¼Œå› æ­¤Errorsæ˜¯ä¸€ä¸ªIEnumerableç±»å‹çš„å±æ€§ã€‚IdentityErrorç±»åŒ…å«Codeï¼ˆé”™è¯¯ç ï¼‰å’ŒDescriptionï¼ˆé”™è¯¯çš„è¯¦ç»†ä¿¡æ¯ï¼‰è¿™ä¸¤ä¸ªå±æ€§ã€‚</p><ol start="3"><li>å‘ä¾èµ–æ³¨å…¥å®¹å™¨ä¸­æ³¨å†Œä¸æ ‡è¯†æ¡†æ¶ç›¸å…³çš„æœåŠ¡ã€‚</li></ol><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(args);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Add services to the container.</span></span><br><span class="line"></span><br><span class="line">builder.Services.AddControllers();</span><br><span class="line"><span class="comment">// Learn more about configuring Swagger/OpenAPI at https://aka.ms/aspnetcore/swashbuckle</span></span><br><span class="line">builder.Services.AddEndpointsApiExplorer();</span><br><span class="line">builder.Services.AddSwaggerGen();</span><br><span class="line"></span><br><span class="line">IServiceCollection services = builder.Services;</span><br><span class="line"><span class="comment">//é…ç½®æ•°æ®åº“</span></span><br><span class="line">services.AddDbContext&lt;IdDbContext&gt;(opt =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span>? connStr = builder.Configuration.GetConnectionString(<span class="string">&quot;Default&quot;</span>);</span><br><span class="line">    opt.UseSqlServer(connStr);</span><br><span class="line">&#125;);</span><br><span class="line">services.AddDataProtection(); <span class="comment">//å¯¹æ•°æ®è¿›è¡Œä¿æŠ¤</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//è°ƒç”¨AddIdentityCoreæ·»åŠ æ ‡è¯†æ¡†æ¶çš„ä¸€äº›é‡è¦çš„åŸºç¡€æœåŠ¡</span></span><br><span class="line">services.AddIdentityCore&lt;User&gt;(options =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//å¯¹å¯†ç è¿›è¡Œè®¾ç½®</span></span><br><span class="line">    options.Password.RequireDigit = <span class="literal">false</span>; <span class="comment">//å¿…é¡»æ˜¯æ•°å­—</span></span><br><span class="line">    options.Password.RequireLowercase = <span class="literal">false</span>; <span class="comment">//å°å†™</span></span><br><span class="line">    options.Password.RequireNonAlphanumeric = <span class="literal">false</span>; <span class="comment">//éå­—æ¯æ•°å­—</span></span><br><span class="line">    options.Password.RequireUppercase = <span class="literal">false</span>; <span class="comment">//å¤§å†™å­—æ¯</span></span><br><span class="line">    options.Password.RequiredLength = <span class="number">6</span>;<span class="comment">//é•¿åº¦6</span></span><br><span class="line">    options.Tokens.PasswordResetTokenProvider = TokenOptions.DefaultEmailProvider;</span><br><span class="line">    options.Tokens.EmailConfirmationTokenProvider = TokenOptions.DefaultEmailProvider;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//åœ¨ä½¿ç”¨æ ‡è¯†æ¡†æ¶çš„æ—¶å€™ä¹Ÿéœ€è¦æ³¨å…¥å’Œåˆå§‹åŒ–éå¸¸å¤šçš„æœåŠ¡</span></span><br><span class="line"><span class="keyword">var</span> idBuilder = <span class="keyword">new</span> IdentityBuilder(<span class="keyword">typeof</span>(User), <span class="keyword">typeof</span>(Role), services);</span><br><span class="line">idBuilder.AddEntityFrameworkStores&lt;IdDbContext&gt;()</span><br><span class="line">    .AddDefaultTokenProviders()</span><br><span class="line">    .AddRoleManager&lt;RoleManager&lt;Role&gt;&gt;()</span><br><span class="line">    .AddUserManager&lt;UserManager&lt;User&gt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Configure the HTTP request pipeline.</span></span><br><span class="line"><span class="keyword">if</span> (app.Environment.IsDevelopment())</span><br><span class="line">&#123;</span><br><span class="line">    app.UseSwagger();</span><br><span class="line">    app.UseSwaggerUI();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.UseHttpsRedirection();</span><br><span class="line"></span><br><span class="line">app.UseAuthorization();</span><br><span class="line"></span><br><span class="line">app.MapControllers();</span><br><span class="line"></span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure><p>ç„¶åæ‰§è¡Œæ•°æ®åº“è¿ç§»Add-Migration createIdentityã€Update-databaseç­‰å‘½ä»¤æ‰§è¡ŒEF Coreçš„æ•°æ®åº“è¿ç§»ï¼Œç„¶åç¨‹åºå°±ä¼šåœ¨æ•°æ®åº“ä¸­ç”Ÿæˆå¤šå¼ æ•°æ®åº“è¡¨ã€‚è¿™äº›æ•°æ®åº“è¡¨éƒ½ç”±æ ‡è¯†æ¡†æ¶è´Ÿè´£ç®¡ç†ï¼Œå¼€å‘äººå‘˜ä¸€èˆ¬ä¸éœ€è¦ç›´æ¥è®¿é—®è¿™äº›è¡¨ã€‚</p><ol start="5"><li>ç¼–å†™æ§åˆ¶å™¨çš„ä»£ç ã€‚æˆ‘ä»¬åœ¨æ§åˆ¶å™¨ä¸­éœ€è¦å¯¹è§’è‰²ã€ç”¨æˆ·è¿›è¡Œæ“ä½œï¼Œä¹Ÿéœ€è¦è¾“å‡ºæ—¥å¿—ï¼Œå› æ­¤é€šè¿‡æ§åˆ¶å™¨çš„æ„é€ æ–¹æ³•æ³¨å…¥ç›¸å…³çš„æœåŠ¡ã€‚ç¼–å†™åˆ›å»ºè§’è‰²å’Œç”¨æˆ·çš„æ–¹æ³•CreateUserRoleã€‚</li></ol><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TestController</span> : <span class="title">ControllerBase</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> ILogger&lt;TestController&gt; _logger;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> UserManager&lt;User&gt; _userManager;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> RoleManager&lt;Role&gt; _roleManager;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TestController</span></span></span><br><span class="line"><span class="function">    (<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">        ILogger&lt;TestController&gt; logger, </span></span></span><br><span class="line"><span class="params"><span class="function">        UserManager&lt;User&gt; userManager, </span></span></span><br><span class="line"><span class="params"><span class="function">        RoleManager&lt;Role&gt; roleManager</span></span></span><br><span class="line"><span class="params"><span class="function">    </span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _logger = logger;</span><br><span class="line">        _userManager = userManager;</span><br><span class="line">        _roleManager = roleManager;</span><br><span class="line">    &#125;</span><br><span class="line">    [<span class="meta">HttpPost</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;IActionResult&gt; <span class="title">CreateUserRole</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//æ£€æŸ¥ç³»ç»Ÿä¸­æ˜¯å¦å·²å­˜åœ¨åä¸º &quot;admin&quot; çš„è§’è‰²</span></span><br><span class="line">        <span class="built_in">bool</span> roleExists = <span class="keyword">await</span> _roleManager.RoleExistsAsync(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        <span class="comment">//è‹¥ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªåä¸º &quot;Admin&quot; çš„è§’è‰²å®ä¾‹</span></span><br><span class="line">        <span class="comment">//ï¼ˆæ³¨æ„ï¼šè§’è‰²åç§°ä¸º &quot;Admin&quot;ï¼Œä¸æ£€æŸ¥æ—¶çš„ &quot;admin&quot; å¤§å°å†™ä¸ä¸€è‡´ï¼Œå¯èƒ½å¯¼è‡´åç»­é—®é¢˜ï¼‰</span></span><br><span class="line">        <span class="keyword">if</span> (!roleExists)</span><br><span class="line">        &#123;</span><br><span class="line">            Role role = <span class="keyword">new</span> Role &#123; Name = <span class="string">&quot;Admin&quot;</span> &#125;;</span><br><span class="line">            <span class="keyword">var</span> r = <span class="keyword">await</span> _roleManager.CreateAsync(role);</span><br><span class="line">            <span class="keyword">if</span> (!r.Succeeded)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> BadRequest(r.Errors);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//æ£€æŸ¥åä¸º &quot;if&quot; çš„ç”¨æˆ·æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">        User user = <span class="keyword">await</span> _userManager.FindByNameAsync(<span class="string">&quot;if&quot;</span>);</span><br><span class="line">        <span class="comment">//è‹¥ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºæ–°ç”¨æˆ·å¹¶è®¾ç½®ç”¨æˆ·åã€é‚®ç®±ï¼ŒåŒæ—¶ç¡®è®¤é‚®ç®±å·²éªŒè¯</span></span><br><span class="line">        <span class="comment">//ï¼ˆEmailConfirmed = trueï¼‰</span></span><br><span class="line">        <span class="keyword">if</span> (user == <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            user = <span class="keyword">new</span> User</span><br><span class="line">            &#123;</span><br><span class="line">                UserName = <span class="string">&quot;YOUXIANYU&quot;</span>,</span><br><span class="line">                Email = <span class="string">&quot;123456@QQ.COM&quot;</span>,</span><br><span class="line">                EmailConfirmed = <span class="literal">true</span>,</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="comment">//ä½¿ç”¨å¯†ç  &quot;123456&quot; åˆ›å»ºç”¨æˆ·ï¼ˆæ³¨æ„ï¼šç”Ÿäº§ç¯å¢ƒä¸­åº”ä½¿ç”¨æ›´å®‰å…¨çš„å¯†ç ç­–ç•¥ï¼‰</span></span><br><span class="line">            <span class="keyword">var</span> r = <span class="keyword">await</span> _userManager.CreateAsync(user, <span class="string">&quot;123456&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (!r.Succeeded)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> BadRequest(r.Errors);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//å°†ç”¨æˆ·æ·»åŠ åˆ° &quot;admin&quot; è§’è‰²</span></span><br><span class="line">            <span class="comment">//ï¼ˆæ³¨æ„ï¼šæ­¤å¤„è§’è‰²åç§°ä¸º &quot;admin&quot;ï¼Œä¸åˆ›å»ºæ—¶çš„ &quot;Admin&quot; å¤§å°å†™ä¸ä¸€è‡´ï¼Œå¯èƒ½å¯¼è‡´è§’è‰²åˆ†é…å¤±è´¥ï¼‰</span></span><br><span class="line">            r = <span class="keyword">await</span> _userManager.AddToRoleAsync(user, <span class="string">&quot;admin&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (!r.Succeeded)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> BadRequest(r.Errors);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> Ok(<span class="string">&quot;æ³¨å†ŒæˆåŠŸ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>6.ç¼–å†™å¤„ç†ç™»å½•è¯·æ±‚çš„æ“ä½œæ–¹æ³•Loginã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">HttpPost</span>]</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;IActionResult&gt; <span class="title">Login</span>(<span class="params">LoginRequest loginRequest</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> userName = loginRequest.UserName;</span><br><span class="line">    <span class="built_in">string</span> password = loginRequest.Password;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//é€šè¿‡_userManageræŸ¥æ‰¾ç”¨æˆ·ï¼Œè‹¥ä¸å­˜åœ¨åˆ™è¿”å› HTTP 404ã€‚</span></span><br><span class="line">        <span class="keyword">var</span> user = <span class="keyword">await</span> _userManager.FindByNameAsync(userName);</span><br><span class="line">        <span class="keyword">if</span> (user == <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> NotFound(<span class="string">$&quot;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å› å¤šæ¬¡ç™»å½•å¤±è´¥è¢«é”å®šï¼ˆåŸºäºASP.NET Identity çš„é”å®šæœºåˆ¶ï¼‰</span></span><br><span class="line">        <span class="keyword">var</span> islocked = <span class="keyword">await</span> _userManager.IsLockedOutAsync(user);</span><br><span class="line">        <span class="keyword">if</span> (islocked)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> lockoutEnd = <span class="keyword">await</span> _userManager.GetLockoutEndDateAsync(user);</span><br><span class="line">            <span class="keyword">return</span> BadRequest(<span class="string">$&quot;ç”¨æˆ·å·²é”å®šï¼Œè§£é”æ—¶é—´ï¼š<span class="subst">&#123;lockoutEnd.Value.LocalDateTime&#125;</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//ä½¿ç”¨CheckPasswordAsyncéªŒè¯å¯†ç ï¼ŒæˆåŠŸåˆ™è¿”å› HTTP 200</span></span><br><span class="line">        <span class="keyword">var</span> success = <span class="keyword">await</span> _userManager.CheckPasswordAsync(user, password);</span><br><span class="line">        <span class="keyword">if</span> (success)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> Ok(<span class="string">&quot;ç™»å½•æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//è°ƒç”¨AccessFailedAsyncè®°å½•ç™»å½•å¤±è´¥æ¬¡æ•°ï¼Œè§¦å‘é”å®šé€»è¾‘ï¼ˆè‹¥è¾¾åˆ°å¤±è´¥æ¬¡æ•°é˜ˆå€¼ï¼‰</span></span><br><span class="line">        <span class="comment">//è‹¥è®°å½•å¤±è´¥åˆ™è¿”å›ç‰¹å®šé”™è¯¯ï¼Œå¦åˆ™è¿”å›é€šç”¨å¤±è´¥ä¿¡æ¯</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> r = <span class="keyword">await</span> _userManager.AccessFailedAsync(user);</span><br><span class="line">            <span class="keyword">if</span> (!r.Succeeded)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> BadRequest(<span class="string">&quot;è®¿é—®å¤±è´¥ä¿¡æ¯å†™å…¥é”™è¯¯ï¼&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> BadRequest(<span class="string">&quot;å¤±è´¥ï¼&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">    &#123;</span><br><span class="line">        _logger.LogError(ex, <span class="string">&quot;ç™»å½•è¿‡ç¨‹å‘ç”Ÿå¼‚å¸¸&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> StatusCode(<span class="number">500</span>, <span class="string">&quot;ç™»å½•å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="7"><li>æ£€æŸ¥ç™»å½•ç”¨æˆ·ä¿¡æ¯</li></ol><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">HttpPost</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;ActionResult&lt;<span class="built_in">string</span>&gt;&gt; CheckPwd(CheckPwdRequest req) <span class="comment">//æ£€æŸ¥å¯†ç </span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> userName = req.userName; <span class="comment">//ç”¨æˆ·å</span></span><br><span class="line">    <span class="built_in">string</span> password = req.password; <span class="comment">//å¯†ç </span></span><br><span class="line">    <span class="keyword">var</span> user = <span class="keyword">await</span> userConfig.FindByNameAsync(userName); <span class="comment">//æŸ¥æ‰¾ç”¨æˆ·</span></span><br><span class="line">    <span class="keyword">if</span>(user == <span class="literal">null</span>) <span class="comment">// ç”¨æˆ·ä¸å­˜åœ¨</span></span><br><span class="line">        <span class="keyword">return</span> NotFound(<span class="string">$&quot;ç”¨æˆ·<span class="subst">&#123;userName&#125;</span>ä¸å­˜åœ¨&quot;</span>); <span class="comment">// è¿”å›404</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">await</span> userConfig.IsLockedOutAsync(user)) <span class="comment">//åˆ¤æ–­ç”¨æˆ·æ˜¯å¦é”å®š</span></span><br><span class="line">        <span class="keyword">return</span> BadRequest(<span class="string">&quot;ç”¨æˆ·å·²é”å®š&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> success = <span class="keyword">await</span> userConfig.CheckPasswordAsync(user, password); <span class="comment">//æ£€æŸ¥å¯†ç </span></span><br><span class="line">    <span class="keyword">if</span> (success) <span class="comment">//å¯†ç æ­£ç¡®</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">await</span> userConfig.ResetAccessFailedCountAsync(user); <span class="comment">//é‡ç½®å¤±è´¥æ¬¡æ•°</span></span><br><span class="line">        <span class="keyword">return</span> Ok(<span class="string">&quot;å¯†ç æ­£ç¡®&quot;</span>); <span class="comment">//è¿”å›200</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">await</span> userConfig.AccessFailedAsync(user); <span class="comment">//å¢åŠ å¤±è´¥æ¬¡æ•°</span></span><br><span class="line">        <span class="keyword">var</span> count = <span class="keyword">await</span> userConfig.GetAccessFailedCountAsync(user); <span class="comment">//è·å–å¤±è´¥æ¬¡æ•°</span></span><br><span class="line">        <span class="keyword">if</span> (count &gt;= <span class="number">5</span>) <span class="comment">//å¤±è´¥æ¬¡æ•°è¶…è¿‡5æ¬¡</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">await</span> userConfig.SetLockoutEndDateAsync(user, DateTimeOffset.UtcNow.AddMinutes(<span class="number">5</span>)); <span class="comment">//é”å®šç”¨æˆ·</span></span><br><span class="line">            <span class="keyword">return</span> BadRequest(<span class="string">&quot;ç”¨æˆ·å·²é”å®š&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> BadRequest(<span class="string">$&quot;å¯†ç é”™è¯¯,è¿˜æœ‰<span class="subst">&#123;<span class="number">5</span> - count&#125;</span>æ¬¡æœºä¼š&quot;</span>);</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å®ç°å¯†ç çš„é‡ç½®"><a href="#å®ç°å¯†ç çš„é‡ç½®" class="headerlink" title="å®ç°å¯†ç çš„é‡ç½®"></a>å®ç°å¯†ç çš„é‡ç½®</h2><p>1.ç”Ÿæˆé‡ç½®Token<br>2.Tokenå‘ç»™å®¢æˆ·ï¼ˆé‚®ä»¶ã€çŸ­ä¿¡ç­‰ï¼‰ï¼Œå½¢å¼ï¼šè¿æ¥ã€éªŒè¯ç ç­‰ã€‚<br>3.æ ¹æ®Tokenå®Œæˆå¯†ç çš„é‡ç½®ã€‚</p><p>ç¼–å†™ä¸€ä¸ªå‘é€é‡ç½®å¯†ç è¯·æ±‚çš„æ“ä½œæ–¹æ³•SendResetPasswordToken.</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">HttpPost</span>]</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;ActionResult&gt; <span class="title">SendResetPasswordToken</span>(<span class="params"><span class="built_in">string</span> userName</span>) <span class="comment">//å‘é€é‡ç½®å¯†ç çš„token</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> user = <span class="keyword">await</span> userConfig.FindByNameAsync(userName); <span class="comment">//æŸ¥æ‰¾ç”¨æˆ·</span></span><br><span class="line">    <span class="keyword">if</span>(user == <span class="literal">null</span>) <span class="comment">// ç”¨æˆ·ä¸å­˜åœ¨</span></span><br><span class="line">        <span class="keyword">return</span> NotFound(<span class="string">$&quot;ç”¨æˆ·<span class="subst">&#123;userName&#125;</span>ä¸å­˜åœ¨&quot;</span>);</span><br><span class="line">    <span class="built_in">string</span> token = <span class="keyword">await</span> userConfig.GeneratePasswordResetTokenAsync(user); <span class="comment">//ç”Ÿæˆé‡ç½®å¯†ç çš„token</span></span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;éªŒè¯ç æ˜¯<span class="subst">&#123;token&#125;</span>&quot;</span>); <span class="comment">//è¾“å‡ºéªŒè¯ç </span></span><br><span class="line">    <span class="keyword">return</span> Ok(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è°ƒç”¨GeneratePasswordResetTokenAsynccæ–¹æ³•æ¥ç”Ÿæˆä¸€ä¸ªå¯†ç é‡ç½®ä»¤ç‰Œï¼Œè¿™ä¸ªä»¤ç‰Œä¼šä¿å­˜åˆ°æ•°æ®åº“ä¸­ï¼Œç„¶åæˆ‘ä»¬æŠŠè¿™ä¸ªä»¤ç‰Œå‘é€åˆ°ç”¨æˆ·é‚®ç®±ã€‚</p><p>ç¼–å†™é‡ç½®å¯†ç çš„æ“ä½œæ–¹æ³•VerifyResetPasswordTokenã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">HttpPut</span>]</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;ActionResult&gt; <span class="title">ResetPassword</span>(<span class="params"><span class="built_in">string</span> userName,<span class="built_in">string</span> token,<span class="built_in">string</span> newPassword</span>) <span class="comment">//é‡ç½®å¯†ç </span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> user = <span class="keyword">await</span> userConfig.FindByNameAsync(userName); <span class="comment">//æŸ¥æ‰¾ç”¨æˆ·</span></span><br><span class="line">    <span class="keyword">if</span> (user == <span class="literal">null</span>) <span class="comment">// ç”¨æˆ·ä¸å­˜åœ¨</span></span><br><span class="line">        <span class="keyword">return</span> NotFound(<span class="string">$&quot;ç”¨æˆ·<span class="subst">&#123;userName&#125;</span>ä¸å­˜åœ¨&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> r = <span class="keyword">await</span> userConfig.ResetPasswordAsync(user, token, newPassword); <span class="comment">//é‡ç½®å¯†ç </span></span><br><span class="line">    <span class="keyword">if</span>(r.Succeeded) <span class="comment">// é‡ç½®å¯†ç æˆåŠŸ</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">await</span> userConfig.ResetAccessFailedCountAsync(user); <span class="comment">// é‡ç½®å¤±è´¥æ¬¡æ•°</span></span><br><span class="line">        <span class="keyword">return</span> Ok(<span class="string">&quot;é‡ç½®å¯†ç æˆåŠŸ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">await</span> userConfig.AccessFailedAsync(user); <span class="comment">//å¢åŠ å¤±è´¥æ¬¡æ•°</span></span><br><span class="line">        <span class="keyword">return</span> BadRequest(<span class="string">&quot;é‡ç½®å¯†ç å¤±è´¥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="JWTï¼ˆJson-Web-Tokenï¼‰"><a href="#JWTï¼ˆJson-Web-Tokenï¼‰" class="headerlink" title="JWTï¼ˆJson Web Tokenï¼‰"></a>JWTï¼ˆJson Web Tokenï¼‰</h1><p>1.JWTæŠŠç™»å½•ä¿¡æ¯ï¼ˆä¹Ÿç§°ä½œä»¤ç‰Œï¼‰ä¿å­˜åœ¨å®¢æˆ·ç«¯ã€‚<br>2.ä¸ºäº†é˜²æ­¢å®¢æˆ·ç«¯çš„æ•°æ®é€ å‡ï¼Œä¿å­˜åœ¨å®¢æˆ·ç«¯çš„ä»¤ç‰Œç»è¿‡äº†ç­¾åå¤„ç†ï¼Œè€Œç­¾åçš„å¯†é’¥åªæœ‰æœåŠ¡å™¨ç«¯æ‰çŸ¥é“ï¼Œæ¯æ¬¡æœåŠ¡å™¨æ®µæ”¶åˆ°å®¢æˆ·ç«¯æäº¤è¿‡æ¥çš„ä»¤ç‰Œçš„æ—¶å€™éƒ½è¦æ£€æŸ¥ä¸€ä¸‹ç­¾åã€‚<br>3.åŸºäºJWTå¦‚ä½•å®ç°â€œç™»å½•â€ã€‚</p><p>JWTå®ç°ç™»é™†çš„æµç¨‹å¦‚ä¸‹ã€‚</p><ol><li>å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€ç”¨æˆ·åã€å¯†ç ç­‰è¯·æ±‚ç™»å½•ã€‚</li><li>æœåŠ¡å™¨ç«¯æ ¡éªŒç”¨æˆ·åã€å¯†ç ï¼Œå¦‚æœæ ¡éªŒæˆåŠŸï¼Œåˆ™ä»æ•°æ®åº“ä¸­å–å‡ºè¿™ä¸ªç”¨æˆ·çš„IDã€è§’è‰²ç­‰ç”¨æˆ·ç›¸å…³ä¿¡æ¯ã€‚</li><li>æœåŠ¡å™¨æ®µé‡‡ç”¨åªæœ‰æœåŠ¡å™¨ç«¯æ‰çŸ¥é“çš„å¯†é’¥æ¥å¯¹ç”¨æˆ·ä¿¡æ¯çš„JSONå­—ç¬¦ä¸²è¿›è¡Œç­¾åï¼Œå½¢æˆç­¾åæ•°æ®ã€‚</li><li>æœåŠ¡å™¨ç«¯æŠŠç”¨æˆ·ä¿¡æ¯çš„JSONå­—ç¬¦ä¸²å’Œç­¾åæ‹¼æ¥åˆ°ä¸€èµ·å½¢æˆJWTï¼Œç„¶åå‘é€ç»™å®¢æˆ·ç«¯ã€‚</li><li>å®¢æˆ·ç«¯ä¿å­˜æœåŠ¡å™¨è¿”å›çš„JWTï¼Œå¹¶ä¸”åœ¨å®¢æˆ·ç«¯æ¯æ¬¡å‘æœåŠ¡å™¨ç«¯å‘é€è¯·æ±‚çš„æ—¶å€™éƒ½å¸¦ä¸Šè¿™ä¸ªJWTã€‚</li><li>æ¯æ¬¡æœåŠ¡å™¨ç«¯æ”¶åˆ°æµè§ˆå™¨è¯·æ±‚ä¸­æºå¸¦çš„JWTåï¼ŒæœåŠ¡å™¨ç«¯ç”¨å¯†é’¥å¯¹JWTçš„ç­¾åè¿›è¡Œæ ¡éªŒï¼Œå¦‚æœæ ¡éªŒæˆåŠŸï¼ŒæœåŠ¡å™¨ç«¯åˆ™ä»JWTä¸­çš„JSONå­—ç¬¦ä¸²ä¸­è¯»å–å‡ºç”¨æˆ·çš„ä¿¡æ¯ã€‚è¿™æ ·æœåŠ¡å™¨ç«¯å°±çŸ¥é“è¿™ä¸ªè¯·æ±‚å¯¹åº”çš„ç”¨æˆ·äº†ï¼Œä¹Ÿå°±å®ç°äº†ç™»å½•çš„åŠŸèƒ½ã€‚</li></ol><h2 id="JWTçš„åŸºæœ¬ä½¿ç”¨"><a href="#JWTçš„åŸºæœ¬ä½¿ç”¨" class="headerlink" title="JWTçš„åŸºæœ¬ä½¿ç”¨"></a>JWTçš„åŸºæœ¬ä½¿ç”¨</h2><p>å…ˆåˆ›å»ºä¸€ä¸ªæ§åˆ¶å°ç¨‹åºç”¨æ¥åˆ›å»ºJWTï¼Œåœ¨åˆ›å»ºä¸€ä¸ªç¨‹åºè¯»å–JWTã€‚<br>.NETä¸­è¿›è¡ŒJWTè¯»å–çš„NuGetåŒ…æ˜¯ï¼šSystem.IdentityModel.Tokens.Jwt</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//NameIdentifier å’Œ Nameï¼šç”¨äºæ ‡è¯†ç”¨æˆ·èº«ä»½</span></span><br><span class="line"><span class="comment">//ä¸¤ä¸ªRoleå£°æ˜ï¼šè¡¨ç¤ºç”¨æˆ·åŒæ—¶æ‹¥æœ‰ &quot;User&quot; å’Œ &quot;Admin&quot; è§’è‰²</span></span><br><span class="line"><span class="comment">//è‡ªå®šä¹‰å£°æ˜jzï¼šå¯ç”¨äºä¼ é€’ä¸šåŠ¡ç›¸å…³æ•°æ®ï¼ˆå¦‚è´¦æˆ·çº§åˆ«ï¼‰</span></span><br><span class="line"><span class="keyword">var</span> claims = <span class="keyword">new</span> List&lt;Claim&gt;();</span><br><span class="line">claims.Add(<span class="keyword">new</span> Claim(ClaimTypes.NameIdentifier, <span class="string">&quot;6&quot;</span>)); <span class="comment">// ç”¨æˆ·ID</span></span><br><span class="line">claims.Add(<span class="keyword">new</span> Claim(ClaimTypes.Name, <span class="string">&quot;è·¯é£&quot;</span>)); <span class="comment">// ç”¨æˆ·å</span></span><br><span class="line">claims.Add(<span class="keyword">new</span> Claim(ClaimTypes.Role, <span class="string">&quot;User&quot;</span>)); <span class="comment">// è§’è‰²1</span></span><br><span class="line">claims.Add(<span class="keyword">new</span> Claim(ClaimTypes.Role, <span class="string">&quot;Admin&quot;</span>)); <span class="comment">// è§’è‰²2</span></span><br><span class="line">claims.Add(<span class="keyword">new</span> Claim(<span class="string">&quot;jz&quot;</span>, <span class="string">&quot;112233&quot;</span>)); <span class="comment">// è‡ªå®šä¹‰å£°æ˜</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> key = <span class="string">&quot;hweorgnfhsoifhjafvbsfjawoighnbsdhfvklawhng&quot;</span>; <span class="comment">// å¯†é’¥</span></span><br><span class="line">DateTime expires = DateTime.Now.AddDays(<span class="number">1</span>); <span class="comment">//è¿‡æœŸæ—¶é—´</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ä½¿ç”¨ HMAC-SHA256 ç®—æ³•å¯¹ JWT è¿›è¡Œç­¾å</span></span><br><span class="line"><span class="comment">//å¯†é’¥é•¿åº¦éœ€è¶³å¤Ÿï¼ˆå»ºè®®è‡³å°‘ 128 ä½ï¼‰ï¼Œä¸”åº”å®‰å…¨å­˜å‚¨ï¼ˆå®é™…é¡¹ç›®ä¸­ä¸åº”ç¡¬ç¼–ç ï¼‰</span></span><br><span class="line"><span class="built_in">byte</span>[] secBytes = Encoding.UTF8.GetBytes(key);</span><br><span class="line"><span class="keyword">var</span> secKey = <span class="keyword">new</span> SymmetricSecurityKey(secBytes);</span><br><span class="line"><span class="keyword">var</span> credentials = <span class="keyword">new</span> SigningCredentials(secKey,SecurityAlgorithms.HmacSha256Signature);</span><br><span class="line"><span class="comment">//JWT åŒ…å«ä¸‰éƒ¨åˆ†ï¼šHeaderï¼ˆå¤´éƒ¨ï¼‰ã€Payloadï¼ˆè´Ÿè½½ï¼‰å’Œ Signatureï¼ˆç­¾åï¼‰</span></span><br><span class="line"><span class="comment">//ç”Ÿæˆçš„ JWT å¯ç”¨äºåç»­ API è¯·æ±‚çš„èº«ä»½éªŒè¯</span></span><br><span class="line"><span class="keyword">var</span> tokenDescriptor = <span class="keyword">new</span> JwtSecurityToken(claims:claims,expires:expires,signingCredentials:credentials);</span><br><span class="line"><span class="built_in">string</span> jwt = <span class="keyword">new</span> JwtSecurityTokenHandler().WriteToken(tokenDescriptor);</span><br><span class="line"></span><br><span class="line">Console.WriteLine(jwt);</span><br></pre></td></tr></table></figure><p>è¿è¡Œç¨‹åº</p><p><img src="/img%5CWEBAPI%5C23.png"></p><p>JWTè¢«å¥ç‚¹åˆ†éš”æˆäº†3éƒ¨åˆ†ï¼Œåˆ†åˆ«æ˜¯å¤´éƒ¨ã€è´Ÿè½½å’Œç­¾åã€‚JWTéƒ½æ˜¯æ˜æ–‡å­˜å‚¨çš„ï¼ŒJWTä¸­ä½¿ç”¨Base64URLç®—æ³•å¯¹å­—ç¬¦ä¸²è¿›è¡Œç¼–ç ï¼Œè¿™ä¸ªç®—æ³•è·ŸBase64ç®—æ³•åŸºæœ¬ç›¸åŒï¼Œè€ƒè™‘åˆ°JWTå¯èƒ½ä¼šè¢«æ”¾åˆ°URLä¸­ï¼Œè€ŒBase64æœ‰3ä¸ªç‰¹æ®Šå­—ç¬¦+ã€&#x2F;å’Œ&#x3D;ï¼Œå®ƒä»¬åœ¨URLé‡Œé¢æœ‰ç‰¹æ®Šå«ä¹‰ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä»Base64ä¸­åˆ é™¤&#x3D;ï¼Œå¹¶ä¸”æŠŠ+æ›¿æ¢æˆ-ã€æŠŠ&#x2F;æ›¿æ¢æˆ_ã€‚</p><p>æŠŠJWTå­—ç¬¦ä¸²çš„å¤´éƒ¨å’Œè´Ÿè½½è§£ç ä¸ºå¯è¯»çš„å­—ç¬¦ä¸²ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> jwt = Console.ReadLine()!;</span><br><span class="line"><span class="built_in">string</span>[] segments = jwt.Split(<span class="string">&#x27;.&#x27;</span>);</span><br><span class="line"><span class="built_in">string</span> head = JwtDecode(segments[<span class="number">0</span>]); ;</span><br><span class="line"><span class="built_in">string</span> payload = JwtDecode(segments[<span class="number">1</span>]);</span><br><span class="line">Console.WriteLine(<span class="string">&quot;--------head--------&quot;</span>);</span><br><span class="line">Console.WriteLine(head);</span><br><span class="line">Console.WriteLine(<span class="string">&quot;--------payload--------&quot;</span>);</span><br><span class="line">Console.WriteLine(payload);</span><br><span class="line"><span class="function"><span class="built_in">string</span> <span class="title">JwtDecode</span>(<span class="params"><span class="built_in">string</span> s</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    s=s.Replace(<span class="string">&#x27;-&#x27;</span>,<span class="string">&#x27;+&#x27;</span>).Replace(<span class="string">&quot;/&quot;</span>,<span class="string">&quot;-&quot;</span>);</span><br><span class="line">    <span class="keyword">switch</span> (s.Length % <span class="number">4</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            s += <span class="string">&quot;===&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">            s += <span class="string">&quot;=&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> bytes = Convert.FromBase64String(s); </span><br><span class="line">    <span class="keyword">return</span> Encoding.UTF8.GetString(bytes);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/img%5CWEBAPI%5C24.png"></p><p>JWTçš„ç¼–ç å’Œè§£ç è§„åˆ™éƒ½æ˜¯å…¬å¼€çš„ï¼Œè€Œä¸”è´Ÿéƒ¨åˆ†çš„Claimä¿¡æ¯ä¹Ÿæ˜¯æ˜æ–‡çš„ï¼Œå› æ­¤æ¶æ„æ”»å‡»è€…å¯ä»¥å¯¹è´Ÿè½½éƒ¨åˆ†ä¸­çš„ç”¨æˆ·IDç­‰ä¿¡æ¯è¿›è¡Œä¿®æ”¹ï¼Œä»è€Œå†’å……å…¶ä»–ç”¨æˆ·çš„èº«ä»½æ¥è®¿é—®æœåŠ¡å™¨ä¸Šçš„èµ„æºã€‚å› æ­¤ï¼ŒæœåŠ¡å™¨ç«¯éœ€è¦å¯¹éƒ¨åˆ†è¿›è¡Œæ ¡éªŒï¼Œä»è€Œæ£€æŸ¥JWTæ˜¯å¦è¢«ç¯¡æ”¹äº†ã€‚<br>æˆ‘ä»¬å¯ä»¥è°ƒç”¨JwtSecurityTokenHandlerç±»å¯¹JWTè¿›è¡Œè§£ç ï¼Œå› ä¸ºå®ƒä¼šåœ¨å¯¹JWTè§£ç å‰å¯¹ç­¾åè¿›è¡Œæ ¡éªŒã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> jwt =Console.ReadLine()!;<span class="comment">//ä»æ§åˆ¶å°è¯»å–ç”¨æˆ·è¾“å…¥çš„ JWT å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment">//ä½¿ç”¨ä¸ç”Ÿæˆ JWT æ—¶ç›¸åŒçš„å¯†é’¥</span></span><br><span class="line"><span class="built_in">string</span> secKey = <span class="string">&quot;hweorgnfhsoifhjafvbsfjawoighnbsdhfvklawhng&quot;</span>;</span><br><span class="line"><span class="comment">//åˆ›å»º JWT å¤„ç†å™¨å’ŒéªŒè¯å‚æ•°å¯¹è±¡</span></span><br><span class="line"><span class="comment">//è®¾ç½®ç­¾åå¯†é’¥ä¸ºä¹‹å‰ç”Ÿæˆ JWT æ—¶ä½¿ç”¨çš„å¯†é’¥</span></span><br><span class="line"><span class="comment">//ç¦ç”¨å‘è¡Œäººï¼ˆIssuerï¼‰å’Œå—ä¼—ï¼ˆAudienceï¼‰éªŒè¯ï¼ˆå®é™…é¡¹ç›®ä¸­é€šå¸¸éœ€è¦éªŒè¯ï¼‰</span></span><br><span class="line">JwtSecurityTokenHandler tokenHandler = <span class="keyword">new</span>();</span><br><span class="line">TokenValidationParameters valParam = <span class="keyword">new</span>();</span><br><span class="line"><span class="keyword">var</span> securityKey = <span class="keyword">new</span> SymmetricSecurityKey(Encoding.UTF8.GetBytes(secKey));</span><br><span class="line">valParam.IssuerSigningKey = securityKey;</span><br><span class="line">valParam.ValidateIssuer = <span class="literal">false</span>;</span><br><span class="line">valParam.ValidateAudience = <span class="literal">false</span>;</span><br><span class="line"><span class="comment">//ValidateToken æ–¹æ³•æ‰§è¡Œä»¥ä¸‹éªŒè¯ï¼š</span></span><br><span class="line"><span class="comment">//ç­¾åæ˜¯å¦æœ‰æ•ˆï¼ˆé˜²æ­¢ç¯¡æ”¹ï¼‰</span></span><br><span class="line"><span class="comment">//ä»¤ç‰Œæ˜¯å¦è¿‡æœŸï¼ˆé»˜è®¤éªŒè¯ exp å£°æ˜ï¼‰</span></span><br><span class="line"><span class="comment">//å…¶ä»–è‡ªå®šä¹‰éªŒè¯ï¼ˆæ ¹æ® TokenValidationParameters è®¾ç½®ï¼‰</span></span><br><span class="line"><span class="comment">//éªŒè¯é€šè¿‡åï¼Œä» ClaimsPrincipal ä¸­æå–æ‰€æœ‰å£°æ˜å¹¶æ‰“å°</span></span><br><span class="line">ClaimsPrincipal claimsPrincipl = tokenHandler.ValidateToken(jwt, valParam, <span class="keyword">out</span> SecurityToken sectToken);</span><br><span class="line"><span class="keyword">foreach</span>(<span class="keyword">var</span> claim <span class="keyword">in</span> claimsPrincipl.Claims)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;<span class="subst">&#123;claim.Type&#125;</span>=<span class="subst">&#123;claim.Value&#125;</span>&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>JWTæœºåˆ¶è®©æˆ‘ä»¬å¯ä»¥æŠŠç”¨æˆ·çš„ä¿¡æ¯ä¿å­˜åˆ°å®¢æˆ·ç«¯ï¼Œæ¯æ¬¡å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€è¯·æ±‚çš„æ—¶å€™ï¼Œå®¢æˆ·ç«¯åªè¦æŠŠJWTå‘é€åˆ°æœåŠ¡å™¨ç«¯ï¼ŒæœåŠ¡å™¨ç«¯å°±å¯ä»¥å¾—çŸ¥å½“å‰è¯·æ±‚ç”¨æˆ·çš„ä¿¡æ¯ï¼Œè€Œé€šè¿‡ç­¾åçš„æœºåˆ¶åˆ™å¯ä»¥é¿å…JWTå†…å­˜è¢«ç¯¡æ”¹ã€‚</p><h1 id="ASP-NET-Coreå¯¹äºJWTçš„å°è£…"><a href="#ASP-NET-Coreå¯¹äºJWTçš„å°è£…" class="headerlink" title="ASP.NET Coreå¯¹äºJWTçš„å°è£…"></a>ASP.NET Coreå¯¹äºJWTçš„å°è£…</h1><ol><li>é…ç½®JWTèŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹ä¸‹åˆ›å»ºSigningKeyã€ExpireSecondsä¸¤ä¸ªé…ç½®é¡¹ï¼Œåˆ†åˆ«ä»£è¡¨JWTçš„å¯†é’¥å’Œè¿‡æœŸæ—¶é—´ï¼ˆå•ä½ï¼šç§’ï¼‰ã€‚åœ¨åˆ›å»ºé…ç½®ç±»JWTOptionsï¼ŒåŒ…å«SigningKeyã€ExpireSecondsä¸¤ä¸ªå±æ€§ã€‚</li><li>NuGet:Microsoft.AspNetCore.Authentication.JwtBearer</li></ol><p>ç¬¬ä¸€æ­¥ï¼Œåœ¨é…ç½®ç³»ç»Ÿä¸­é…ç½®ä¸€ä¸ªåå­—ä¸ºJWTçš„èŠ‚ç‚¹ï¼Œå¹¶åœ¨èŠ‚ç‚¹ä¸‹åˆ›å»ºSigningKeyã€ExpireSecondsä¸¤ä¸ªé…ç½®é¡¹ï¼Œåˆ†åˆ«ä»£è¡¨JWTçš„å¯†é’¥å’Œè¿‡æœŸæ—¶é—´ï¼ˆå•ä½ä¸ºç§’ï¼‰ã€‚æˆ‘ä»¬åœ¨åˆ›å»ºä¸€ä¸ªå¯¹åº”JWTèŠ‚ç‚¹çš„é…ç½®ç±»JWTOptions,ç±»ä¸­åŒ…å«SigningKeyã€ExpireSwcondsè¿™ä¸¤ä¸ªå±æ€§ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;JWT&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;SigningKey&quot;</span><span class="punctuation">:</span> <span class="string">&quot;jlkerujoigsnvjlkasjfwehiojkgnsgss&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ExpireSeconds&quot;</span><span class="punctuation">:</span> <span class="string">&quot;3600&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;ConnectionStrings&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;DefaultConnection&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Server=localhost;Database=YourDatabaseName;Trusted_Connection=True;MultipleActiveResultSets=true;TrustServerCertificate=True;Encrypt=True;&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;Logging&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;LogLevel&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;Default&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Information&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;Microsoft.AspNetCore&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Warning&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;AllowedHosts&quot;</span><span class="punctuation">:</span> <span class="string">&quot;*&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">JWTOptions</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> SigningKey &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> ExpirSeconds &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰æ­¥ï¼Œç¼–å†™ä»£ç å¯¹JWTè¿›è¡Œé…ç½®ï¼Œå†…å®¹æ·»åŠ åˆ°Program.csçš„builder.Buildä¹‹å‰ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä»é…ç½®æ–‡ä»¶ï¼ˆå¦‚appsettings.jsonï¼‰çš„ &quot;JWT&quot; éƒ¨åˆ†è¯»å–é…ç½®ï¼Œå¹¶æ³¨å†Œä¸ºJWTOptionsç±»å‹çš„é€‰é¡¹æœåŠ¡</span></span><br><span class="line"><span class="comment">//åç»­å¯é€šè¿‡ä¾èµ–æ³¨å…¥ä½¿ç”¨è¿™äº›é…ç½®</span></span><br><span class="line">services.Configure&lt;JWTOptions&gt;(builder.Configuration.GetSection(<span class="string">&quot;JWT&quot;</span>));</span><br><span class="line"><span class="comment">//è®¾ç½®åº”ç”¨çš„ä¸»è¦è®¤è¯æ–¹æ¡ˆä¸º JWT Bearer</span></span><br><span class="line"><span class="comment">//æ·»åŠ  JWT æ‰¿è½½è®¤è¯å¤„ç†å™¨</span></span><br><span class="line">services.AddAuthentication(JwtBearerDefaults.AuthenticationScheme)</span><br><span class="line">    .AddJwtBearer(x =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//å†æ¬¡è¯»å– JWT é…ç½®ï¼ˆå­˜åœ¨é‡å¤è¯»å–é—®é¢˜ï¼‰</span></span><br><span class="line">        <span class="comment">/*var jwtOptions = builder.Configuration.GetSection(&quot;JWT&quot;).Get&lt;JWTOptions&gt;();</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        // æ³¨å†ŒJWTé€‰é¡¹åˆ°ä¾èµ–æ³¨å…¥å®¹å™¨</span></span><br><span class="line"><span class="comment">        services.Configure&lt;JWTOptions&gt;(builder.Configuration.GetSection(&quot;JWT&quot;));</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        // ç”Ÿæˆå®‰å…¨å¯†é’¥</span></span><br><span class="line"><span class="comment">        var securityKey = new SymmetricSecurityKey(Encoding.UTF8.GetBytes(jwtOptions.SigningKey));*/</span></span><br><span class="line">        <span class="comment">//ä»é…ç½®ä¸­è·å–ç­¾åå¯†é’¥å¹¶è½¬æ¢ä¸ºå®‰å…¨å¯†é’¥å¯¹è±¡</span></span><br><span class="line">        <span class="keyword">var</span> jwtOpt = builder.Configuration.GetSection(<span class="string">&quot;JWT&quot;</span>).Get&lt;JWTOptions&gt;();</span><br><span class="line">        <span class="built_in">byte</span>[] keyBytes = Encoding.UTF8.GetBytes(jwtOpt.SigningKey);</span><br><span class="line">        <span class="keyword">var</span> secKey = <span class="keyword">new</span> SymmetricSecurityKey(keyBytes);</span><br><span class="line">        x.TokenValidationParameters = <span class="keyword">new</span> TokenValidationParameters()</span><br><span class="line">        &#123;</span><br><span class="line">            ValidateIssuer = <span class="literal">false</span>,         <span class="comment">// ä¸éªŒè¯ä»¤ç‰Œå‘è¡Œäºº</span></span><br><span class="line">            ValidateAudience = <span class="literal">false</span>,       <span class="comment">// ä¸éªŒè¯ä»¤ç‰Œå—ä¼—</span></span><br><span class="line">            ValidateLifetime = <span class="literal">false</span>,       <span class="comment">// ä¸éªŒè¯ä»¤ç‰Œæœ‰æ•ˆæœŸ</span></span><br><span class="line">            ValidateIssuerSigningKey = <span class="literal">true</span>, <span class="comment">// éªŒè¯ç­¾åå¯†é’¥</span></span><br><span class="line">            IssuerSigningKey = secKey       <span class="comment">// è®¾ç½®ç­¾åå¯†é’¥</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="comment">/*// ä»é…ç½®ä¸­è¯»å–JWTé€‰é¡¹</span></span><br><span class="line"><span class="comment">var jwtOptions = builder.Configuration.GetSection(&quot;JWT&quot;).Get&lt;JWTOptions&gt;();</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">// æ³¨å†ŒJWTé€‰é¡¹åˆ°ä¾èµ–æ³¨å…¥å®¹å™¨</span></span><br><span class="line"><span class="comment">services.Configure&lt;JWTOptions&gt;(builder.Configuration.GetSection(&quot;JWT&quot;));</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">// ç”Ÿæˆå®‰å…¨å¯†é’¥</span></span><br><span class="line"><span class="comment">var securityKey = new SymmetricSecurityKey(Encoding.UTF8.GetBytes(jwtOptions.SigningKey));</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">// é…ç½®JWTè®¤è¯</span></span><br><span class="line"><span class="comment">services.AddAuthentication(JwtBearerDefaults.AuthenticationScheme)</span></span><br><span class="line"><span class="comment">    .AddJwtBearer(options =&gt;</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">        options.TokenValidationParameters = new TokenValidationParameters</span></span><br><span class="line"><span class="comment">        &#123;</span></span><br><span class="line"><span class="comment">            ValidateIssuer = true,               // éªŒè¯å‘è¡Œäºº</span></span><br><span class="line"><span class="comment">            ValidateAudience = true,             // éªŒè¯å—ä¼—</span></span><br><span class="line"><span class="comment">            ValidateLifetime = true,             // éªŒè¯è¿‡æœŸæ—¶é—´</span></span><br><span class="line"><span class="comment">            ValidateIssuerSigningKey = true,     // éªŒè¯ç­¾åå¯†é’¥</span></span><br><span class="line"><span class="comment">            ValidIssuer = jwtOptions.Issuer,     // è®¾ç½®æœ‰æ•ˆå‘è¡Œäºº</span></span><br><span class="line"><span class="comment">            ValidAudience = jwtOptions.Audience, // è®¾ç½®æœ‰æ•ˆå—ä¼—</span></span><br><span class="line"><span class="comment">            IssuerSigningKey = securityKey,      // è®¾ç½®ç­¾åå¯†é’¥</span></span><br><span class="line"><span class="comment">            ClockSkew = TimeSpan.Zero            // ä¸¥æ ¼éªŒè¯è¿‡æœŸæ—¶é—´</span></span><br><span class="line"><span class="comment">        &#125;;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        // å¯é€‰ï¼šæ·»åŠ äº‹ä»¶å¤„ç†ï¼ˆå¦‚ä»¤ç‰ŒéªŒè¯å¤±è´¥æ—¶çš„è‡ªå®šä¹‰å“åº”ï¼‰</span></span><br><span class="line"><span class="comment">        options.Events = new JwtBearerEvents</span></span><br><span class="line"><span class="comment">        &#123;</span></span><br><span class="line"><span class="comment">            OnAuthenticationFailed = context =&gt;</span></span><br><span class="line"><span class="comment">            &#123;</span></span><br><span class="line"><span class="comment">                if (context.Exception is SecurityTokenExpiredException)</span></span><br><span class="line"><span class="comment">                &#123;</span></span><br><span class="line"><span class="comment">                    context.Response.Headers.Add(&quot;Token-Expired&quot;, &quot;true&quot;);</span></span><br><span class="line"><span class="comment">                &#125;</span></span><br><span class="line"><span class="comment">                return Task.CompletedTask;</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">        &#125;;</span></span><br><span class="line"><span class="comment">    &#125;);*/</span></span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Configure the HTTP request pipeline.</span></span><br><span class="line"><span class="keyword">if</span> (app.Environment.IsDevelopment())</span><br><span class="line">&#123;</span><br><span class="line">    app.UseSwagger();</span><br><span class="line">    app.UseSwaggerUI();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.UseHttpsRedirection();</span><br><span class="line">app.UseAuthentication();</span><br><span class="line">app.UseAuthorization();</span><br><span class="line"></span><br><span class="line">app.MapControllers();</span><br><span class="line"></span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure><p>ç¬¬4æ­¥ï¼Œåœ¨Program.csçš„app.UseAuthorizationä¹‹å‰æ·»åŠ app.UseAuthenticationã€‚</p><p>ç¬¬äº”æ­¥ï¼Œåœ¨TestControllerç±»ä¸­å¢åŠ ç™»å½•å¹¶ä¸”åˆ›å»ºJWTçš„æ“ä½œæ–¹æ³•Loginã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">HttpPost</span>]</span><br><span class="line"><span class="comment">//LoginRequestï¼šåŒ…å«ç”¨æˆ·åå’Œå¯†ç çš„ç™»å½•è¯·æ±‚æ¨¡å‹</span></span><br><span class="line"><span class="comment">//IOptions&lt;JWTOptions&gt;ï¼šä»ä¾èµ–æ³¨å…¥å®¹å™¨è·å– JWT é…ç½®é€‰é¡¹</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;IActionResult&gt; <span class="title">Login</span>(<span class="params">LoginRequest loginRequest, [FromServices] IOptions&lt;JWTOptions&gt; jwtOptions</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> userName = loginRequest.UserName;</span><br><span class="line">    <span class="built_in">string</span> password = loginRequest.Password;</span><br><span class="line">    <span class="comment">//é€šè¿‡ç”¨æˆ·åæŸ¥æ‰¾ç”¨æˆ·</span></span><br><span class="line">    <span class="keyword">var</span> user = <span class="keyword">await</span> _userManager.FindByNameAsync(userName);</span><br><span class="line">    <span class="comment">//éªŒè¯å¯†ç æ˜¯å¦æ­£ç¡®</span></span><br><span class="line">    <span class="keyword">var</span> success = <span class="keyword">await</span> _userManager.CheckPasswordAsync(user,password);</span><br><span class="line">    <span class="keyword">if</span> (!success)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//éªŒè¯å¤±è´¥è¿”å› HTTP 400 é”™è¯¯</span></span><br><span class="line">        <span class="keyword">return</span> BadRequest(<span class="string">&quot;å¤±è´¥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> claims = <span class="keyword">new</span> List&lt;Claim&gt;();</span><br><span class="line">                                   <span class="comment">//NameIdentifierï¼šç”¨æˆ·å”¯ä¸€æ ‡è¯†</span></span><br><span class="line">    claims.Add(<span class="keyword">new</span> Claim(ClaimTypes.NameIdentifier,user.Id.ToString()));</span><br><span class="line">                                   <span class="comment">//Nameï¼šç”¨æˆ·å</span></span><br><span class="line">    claims.Add(<span class="keyword">new</span> Claim(ClaimTypes.Name,user.UserName));</span><br><span class="line">    <span class="keyword">var</span> roles = <span class="keyword">await</span> _userManager.GetRolesAsync(user);</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="keyword">var</span> role <span class="keyword">in</span> roles)</span><br><span class="line">    &#123;</span><br><span class="line">                            <span class="comment">//Roleï¼šç”¨æˆ·è§’è‰²ï¼ˆå¯åŒ…å«å¤šä¸ªï¼‰</span></span><br><span class="line">        claims.Add(<span class="keyword">new</span> Claim(ClaimTypes.Role, role));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//è°ƒç”¨è¾…åŠ©æ–¹æ³•ç”Ÿæˆ JWT å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="comment">//è¿”å› HTTP 200 å“åº”ï¼ŒåŒ…å«ç”Ÿæˆçš„ä»¤ç‰Œ</span></span><br><span class="line">    <span class="built_in">string</span> jwtToken = BuildToken(claims, jwtOptions.Value);</span><br><span class="line">    <span class="keyword">return</span> Ok(jwtToken);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> </span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;claims&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;options&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span> è¿™æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œæ ¹æ®ç”¨æˆ·å£°æ˜å’Œé…ç½®ç”Ÿæˆ JWT</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">BuildToken</span>(<span class="params">IEnumerable&lt;Claim&gt; claims,JWTOptions options</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span>ä»é…ç½®ä¸­è¯»å–è¿‡æœŸç§’æ•°ï¼Œè®¡ç®—ä»¤ç‰Œè¿‡æœŸæ—¶é—´</span></span><br><span class="line">    DateTime expires = DateTime.Now.AddSeconds(options.ExpirSeconds);</span><br><span class="line">    <span class="comment">//ä½¿ç”¨é…ç½®ä¸­çš„ç­¾åå¯†é’¥åˆ›å»ºå®‰å…¨å¯†é’¥å¯¹è±¡</span></span><br><span class="line">    <span class="built_in">byte</span>[] keyBytes = Encoding.UTF8.GetBytes(options.SigningKey);</span><br><span class="line">    <span class="comment">//æŒ‡å®š HMAC SHA-256 ç®—æ³•è¿›è¡Œç­¾å</span></span><br><span class="line">    <span class="keyword">var</span> secKey = <span class="keyword">new</span> SymmetricSecurityKey(keyBytes);</span><br><span class="line">    <span class="keyword">var</span> credentials = <span class="keyword">new</span> SigningCredentials(secKey, SecurityAlgorithms.HmacSha256Signature);</span><br><span class="line">    <span class="comment">//åˆ›å»º JWT ä»¤ç‰Œæè¿°ç¬¦ï¼ŒåŒ…å«è¿‡æœŸæ—¶é—´, ç­¾åå‡­è¯, ç”¨æˆ·å£°æ˜</span></span><br><span class="line">    <span class="keyword">var</span> tokenDescriptor = <span class="keyword">new</span> JwtSecurityToken(expires:expires,signingCredentials:credentials,claims:claims);</span><br><span class="line">    <span class="comment">//ä½¿ç”¨JwtSecurityTokenHandlerå°†ä»¤ç‰Œæè¿°ç¬¦è½¬æ¢ä¸º JWT å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> JwtSecurityTokenHandler().WriteToken(tokenDescriptor);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬å…­æ­¥ï¼Œåœ¨éœ€è¦ç™»å½•æ‰èƒ½è®¿é—®çš„æ§åˆ¶å™¨ç±»æˆ–è€…Actionæ–¹æ³•ä¸Šæ·»åŠ [Authorize]</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">Authorize</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Demo2Controller</span> : <span class="title">ControllerBase</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">HttpGet</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> IActionResult <span class="title">Hello</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> id= <span class="keyword">this</span>.User.FindFirst(ClaimTypes.NameIdentifier)!.Value; <span class="comment">//ç”¨æˆ·ID</span></span><br><span class="line">        <span class="built_in">string</span> userName = <span class="keyword">this</span>.User.FindFirst(ClaimTypes.Name)!.Value; <span class="comment">//ç”¨æˆ·å</span></span><br><span class="line">        IEnumerable&lt;Claim&gt; roleClaims = <span class="keyword">this</span>.User.FindAll(ClaimTypes.Role); <span class="comment">//è§’è‰²</span></span><br><span class="line">        <span class="built_in">string</span> roleNames = <span class="built_in">string</span>.Join(<span class="string">&quot;,&quot;</span>, roleClaims.Select(c =&gt; c.Value)); <span class="comment">//è§’è‰²</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Ok(<span class="string">$&quot;Hello <span class="subst">&#123;userName&#125;</span>, your ID is <span class="subst">&#123;id&#125;</span>, and your roles are <span class="subst">&#123;roleNames&#125;</span>.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸ƒæ­¥ï¼Œæµ‹è¯•ç™»å½•å’Œè®¿é—®ã€‚ç”¨PostManè‡ªå®šä¹‰æŠ¥æ–‡å¤´ï¼šAuthorizationçš„å€¼ä¸ºâ€œBearer JWTTokenâ€,Authorizationçš„å€¼ä¸­çš„â€œBearerâ€å’ŒJWTä»¤ç‰Œä¹‹é—´ä¸€å®šè¦é€šè¿‡ç©ºæ ¼åˆ†éš”ã€‚å‰åä¸èƒ½å¤šå‡ºæ¥é¢å¤–çš„ç©ºæ ¼ã€æ¢è¡Œç­‰ã€‚</p><p><img src="/img%5CWEBAPI%5C25.png"></p><p><img src="/img%5CWEBAPI%5C26.png"></p><p>[Authorize]çš„æ³¨æ„äº‹é¡¹</p><ol><li>ASP.NET Coreä¸­èº«ä»½éªŒè¯å’ŒæˆæƒéªŒè¯çš„åŠŸèƒ½ç”±Authenticationã€Authorizationä¸­é—´ä»¶æä¾›ï¼šapp.UseAuthentication()ã€app.UseAuthorization()ã€‚</li><li>æ§åˆ¶å™¨ç±»ä¸Šæ ‡æ³¨[Authorize],åˆ™æ‰€æœ‰æ“ä½œæ–¹æ³•éƒ½ä¼šè¢«è¿›è¡Œèº«ä»½éªŒè¯å’ŒæˆæƒéªŒè¯ï¼›å¯¹äºæ ‡æ³¨äº†[Authorzie]çš„æ§åˆ¶å™¨ä¸­ï¼Œå¦‚æœå…¶ä¸­æŸä¸ªæ“ä½œæ–¹æ³•ä¸æƒ³è¢«éªŒè¯ï¼Œå¯ä»¥åœ¨æ“ä½œæ–¹æ³•ä¸Šæ·»åŠ [AllowAnonymous]ã€‚å¦‚æœæ²¡æœ‰åœ¨æ§åˆ¶å™¨ç±»ä¸Šæ ‡æ³¨[Authorize],é‚£ä¹ˆè¿™ä¸ªæ§åˆ¶å™¨ä¸­çš„æ‰€æœ‰æ“ä½œæ–¹æ³•éƒ½å…è®¸è¢«è‡ªç”±åœ°è®¿é—®ï¼›å¯¹äºæ²¡æœ‰æ ‡æ³¨[Authorzie]çš„æ§åˆ¶å™¨ä¸­ï¼Œå¦‚æœå…¶ä¸­æŸä¸ªæ“ä½œæ–¹æ³•éœ€è¦è¢«éªŒè¯ï¼Œæ–‡ä¹°ä¹Ÿå¯ä»¥åœ¨æ“ä½œæ–¹æ³•ä¸Šæ·»åŠ [Authorize].</li><li>ASP.NET Coreä¼šæŒ‰ç…§HTTPåè®®çš„è§„èŒƒï¼Œä»Authorizationå–å‡ºæ¥ä»¤ç‰Œï¼Œå¹¶ä¸”è¿›è¡Œæ ¡éªŒã€è§£æï¼Œç„¶åæŠŠè§£æç»“æœå¡«å……åˆ°Userå±æ€§ä¸­ï¼Œè¿™ä¸€åˆ‡éƒ½æ˜¯ASP.NET Coreå®Œæˆçš„ï¼Œä¸éœ€è¦å¼€å‘äººå‘˜è‡ªå·±ç¼–å†™ä»£ç ã€‚ä½†æ˜¯ä¸€æ—¦å‡ºç°401ï¼Œæ²¡æœ‰è¯¦ç»†çš„æŠ¥é”™ä¿¡æ¯ï¼Œå¾ˆéš¾æ’æŸ¥ã€‚</li></ol><h2 id="è®©Swaggerä¸­è°ƒè¯•å¾…éªŒè¯çš„è¯·æ±‚è·Ÿç®€å•"><a href="#è®©Swaggerä¸­è°ƒè¯•å¾…éªŒè¯çš„è¯·æ±‚è·Ÿç®€å•" class="headerlink" title="è®©Swaggerä¸­è°ƒè¯•å¾…éªŒè¯çš„è¯·æ±‚è·Ÿç®€å•"></a>è®©Swaggerä¸­è°ƒè¯•å¾…éªŒè¯çš„è¯·æ±‚è·Ÿç®€å•</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">builder.Services.AddSwaggerGen(c =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> scheme = <span class="keyword">new</span> OpenApiSecurityScheme()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">/*Descriptionï¼šåœ¨ Swagger UI ä¸­æ˜¾ç¤ºçš„æè¿°ä¿¡æ¯ï¼ŒæŒ‡å¯¼ç”¨æˆ·å¦‚ä½•è¾“å…¥è®¤è¯ä¿¡æ¯*/</span></span><br><span class="line">        Description = <span class="string">&quot;Authorization header.\r\nExample:&#x27;Bearer 12345abcdef&#x27;&quot;</span>,</span><br><span class="line">        <span class="comment">/*Referenceï¼šå¼•ç”¨ç±»å‹ä¸ºå®‰å…¨æ–¹æ¡ˆï¼ŒID ä¸º &quot;Authorization&quot;*/</span></span><br><span class="line">        Reference = <span class="keyword">new</span> OpenApiReference</span><br><span class="line">        &#123;</span><br><span class="line">            Type = ReferenceType.SecurityScheme,</span><br><span class="line">            Id = <span class="string">&quot;Authorization&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">/*Schemeï¼šæŒ‡å®šä¸º &quot;oauth2&quot;ï¼Œå°½ç®¡æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ JWTï¼Œä½† Swagger UI ä½¿ç”¨æ­¤å€¼æ¥æ˜¾ç¤ºæˆæƒæŒ‰é’®*/</span></span><br><span class="line">        Scheme = <span class="string">&quot;oauth2&quot;</span>,</span><br><span class="line">        <span class="comment">/*Nameï¼šHTTP è¯·æ±‚å¤´çš„åç§°ï¼Œé€šå¸¸ä¸º &quot;Authorization&quot;*/</span></span><br><span class="line">        Name = <span class="string">&quot;Authorization&quot;</span>,</span><br><span class="line">        <span class="comment">/*Inï¼šæŒ‡å®šåœ¨è¯·æ±‚å¤´ä¸­ä¼ é€’è®¤è¯ä¿¡æ¯*/</span></span><br><span class="line">        In = ParameterLocation.Header,</span><br><span class="line">        <span class="comment">/*Typeï¼šæŒ‡å®šä¸º API å¯†é’¥ç±»å‹*/</span></span><br><span class="line">        Type = SecuritySchemeType.ApiKey,</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">/*å°†ä¸Šé¢å®šä¹‰çš„å®‰å…¨æ–¹æ¡ˆæ·»åŠ åˆ° Swagger ç”Ÿæˆå™¨ä¸­ï¼Œåç§°ä¸º &quot;Authorization&quot;*/</span></span><br><span class="line">    c.AddSecurityDefinition(<span class="string">&quot;Authorization&quot;</span>, scheme);</span><br><span class="line">    <span class="comment">/*åˆ›å»ºä¸€ä¸ªå®‰å…¨éœ€æ±‚å¯¹è±¡ï¼Œè¦æ±‚æ‰€æœ‰ API æ“ä½œéƒ½éœ€è¦ä¸Šè¿°å®šä¹‰çš„å®‰å…¨æ–¹æ¡ˆ*/</span></span><br><span class="line">    <span class="keyword">var</span> requirement = <span class="keyword">new</span> OpenApiSecurityRequirement();</span><br><span class="line">    <span class="comment">/*ç©ºçš„å­—ç¬¦ä¸²åˆ—è¡¨è¡¨ç¤ºä¸éœ€è¦ä»»ä½•ç‰¹å®šçš„ä½œç”¨åŸŸï¼ˆscopesï¼‰ï¼Œé€‚ç”¨äº JWT è®¤è¯*/</span></span><br><span class="line">    requirement[scheme] = <span class="keyword">new</span> List&lt;<span class="built_in">string</span>&gt;();</span><br><span class="line">    c.AddSecurityRequirement(requirement);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><img src="/img%5CWEBAPI%5C31.png"></p><h1 id="è§£å†³JWTæ— æ³•æå‰æ’¤å›çš„éš¾é¢˜"><a href="#è§£å†³JWTæ— æ³•æå‰æ’¤å›çš„éš¾é¢˜" class="headerlink" title="è§£å†³JWTæ— æ³•æå‰æ’¤å›çš„éš¾é¢˜"></a>è§£å†³JWTæ— æ³•æå‰æ’¤å›çš„éš¾é¢˜</h1><p>JWTçš„ç¼ºç‚¹<br>1.åˆ°æœŸå‰ï¼Œä»¤ç‰Œæ— æ³•æ’¤é”€</p><p>é‡åˆ°è¿™ç§æƒ…å†µç”¨Sessionæ›´å¥½è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p>è§£å†³æ–¹æ³•<br>åœ¨ç”¨æˆ·è¡¨ä¸­å¢åŠ ä¸€ä¸ªæ•´æ•°ç±»å‹çš„åˆ—JWTVersion,ä»£è¡¨æœ€åä¸€æ¬¡å‘æ”¾å‡ºå»çš„ä»¤ç‰Œçš„ç‰ˆæœ¬å·;æ¯æ¬¡ç™»å½•ã€å‘æ”¾ä»¤ç‰Œçš„æ—¶å€™ï¼Œéƒ½è®©JWTVersionçš„å€¼è‡ªå¢ï¼ŒåŒæ—¶å°†JWTVersionçš„å€¼ä¹Ÿæ”¾åˆ°JWTä»¤ç‰Œçš„è´Ÿè½½ä¸­ï¼›å½“æ‰§è¡Œç¦ç”¨ç”¨æˆ·ã€æ’¤å›ç”¨æˆ·çš„ä»¤ç‰Œç­‰æ“ä½œçš„æ—¶å€™ï¼ŒæŠŠè¿™ä¸ªç”¨æˆ·å¯¹åº”çš„JWTVersionåˆ—çš„å€¼è‡ªå¢ï¼›å½“æœåŠ¡å™¨æ®µæ”¶åˆ°å®¢æˆ·ç«¯æäº¤çš„JWTä»¤ç‰Œåï¼Œå…ˆæŠŠJWTä»¤ç‰Œä¸­çš„JWTVersionå€¼å’Œæ•°æ®åº“ä¸­JWTVersionçš„å€¼åšä¸€ä¸‹æ¯”è¾ƒï¼Œå¦‚æœJWTä»¤ç‰Œä¸­JWTVersionçš„å€¼å°äºæ•°æ®åº“ä¸­JWTVsersionçš„å€¼ï¼Œå°±è¯´æ˜è¿™ä¸ªJWTä»¤ç‰Œè¿‡æœŸäº†ã€‚</p><p>å…ˆé…ç½®æ‰€éœ€ç¨‹åºï¼š</p><p>é…ç½®CheckAsyncæ‰©å±•æ–¹æ³•ï¼šå¦‚æœç”¨æˆ·ã€å¯†ç æ­£ç¡®åˆ™ç©ºï¼Œå¤±è´¥åˆ™è‡ªå¢</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">IdentityHelper</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">async</span> Task <span class="title">CheckAsync</span>(<span class="params"><span class="keyword">this</span> Task&lt;IdentityResult&gt; task</span>) <span class="comment">//æ£€æŸ¥IdentityResult</span></span></span><br><span class="line">    &#123;</span><br><span class="line">         <span class="keyword">var</span> r = <span class="keyword">await</span> task; <span class="comment">//ç­‰å¾…ä»»åŠ¡å®Œæˆ</span></span><br><span class="line">         <span class="keyword">if</span> (!r.Succeeded) <span class="comment">//å¦‚æœæ“ä½œå¤±è´¥</span></span><br><span class="line">         &#123;</span><br><span class="line">             <span class="keyword">throw</span> <span class="keyword">new</span> Exception(JsonSerializer.Serialize(r.Errors)); <span class="comment">//æŠ›å‡ºå¼‚å¸¸å¹¶åºåˆ—åŒ–é”™è¯¯ä¿¡æ¯</span></span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">DemoController</span> : <span class="title">ControllerBase</span></span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> IOptionsSnapshot&lt;JWTSettings&gt; jwtSettings; <span class="comment">//å¯†é’¥</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> UserManager&lt;MyUser&gt; userManager; <span class="comment">//ç”¨æˆ·ç®¡ç†å™¨</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DemoController</span>(<span class="params">IOptionsSnapshot&lt;JWTSettings&gt; jwtSettings, UserManager&lt;MyUser&gt; userManager</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.jwtSettings = jwtSettings;</span><br><span class="line">        <span class="keyword">this</span>.userManager = userManager;</span><br><span class="line">    &#125;</span><br><span class="line">    [<span class="meta">HttpPost</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">async</span> Task&lt;ActionResult&lt;<span class="built_in">string</span>&gt;&gt; Login(<span class="built_in">string</span> userName,<span class="built_in">string</span> password) <span class="comment">//ç™»å½•</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> user = <span class="keyword">await</span> userManager.FindByNameAsync(userName); <span class="comment">//æ ¹æ®ç”¨æˆ·åæŸ¥æ‰¾ç”¨æˆ·</span></span><br><span class="line">        <span class="keyword">if</span>(user == <span class="literal">null</span>) <span class="comment">//ç”¨æˆ·ä¸å­˜åœ¨</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> BadRequest(<span class="string">&quot;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">await</span> userManager.CheckPasswordAsync(user,password)) <span class="comment">//éªŒè¯å¯†ç </span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">await</span> userManager.AccessFailedAsync(user).CheckAsync(); <span class="comment">//é‡ç½®ç™»å½•å¤±è´¥æ¬¡æ•°</span></span><br><span class="line">            List&lt;Claim&gt; claims = <span class="keyword">new</span> List&lt;Claim&gt;();</span><br><span class="line">            claims.Add(<span class="keyword">new</span> Claim(ClaimTypes.NameIdentifier, user.Id.ToString())); <span class="comment">//ç”¨æˆ·ID</span></span><br><span class="line">            claims.Add(<span class="keyword">new</span> Claim(ClaimTypes.Name, user.UserName)); <span class="comment">//ç”¨æˆ·å</span></span><br><span class="line">            <span class="keyword">var</span> roles = <span class="keyword">await</span> userManager.GetRolesAsync(user); <span class="comment">//è·å–ç”¨æˆ·è§’è‰²</span></span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> role <span class="keyword">in</span> roles) <span class="comment">//éå†è§’è‰²</span></span><br><span class="line">            &#123;</span><br><span class="line">                claims.Add(<span class="keyword">new</span> Claim(ClaimTypes.Role, role)); <span class="comment">//æ·»åŠ è§’è‰²å£°æ˜</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">string</span> key = jwtSettings.Value.SecKey; <span class="comment">//å¯†é’¥</span></span><br><span class="line">            DateTime expires = DateTime.Now.AddSeconds(jwtSettings.Value.ExpirSeconds); <span class="comment">//è¿‡æœŸæ—¶é—´</span></span><br><span class="line">            <span class="built_in">byte</span>[] secBytes = Encoding.UTF8.GetBytes(key); <span class="comment">//å°†å¯†é’¥è½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„</span></span><br><span class="line">            <span class="keyword">var</span> secKey = <span class="keyword">new</span> SymmetricSecurityKey(secBytes); <span class="comment">//åˆ›å»ºå¯¹ç§°å¯†é’¥</span></span><br><span class="line">            <span class="keyword">var</span> credentials = <span class="keyword">new</span> SigningCredentials(secKey, SecurityAlgorithms.HmacSha256Signature); <span class="comment">//åˆ›å»ºç­¾åå‡­æ®</span></span><br><span class="line">            <span class="keyword">var</span> tokenDescriptor = <span class="keyword">new</span> JwtSecurityToken(claims: claims, <span class="comment">//å£°æ˜</span></span><br><span class="line">                expires: expires, <span class="comment">//è¿‡æœŸæ—¶é—´</span></span><br><span class="line">                signingCredentials: credentials); <span class="comment">//ç­¾åå‡­æ®</span></span><br><span class="line">            <span class="built_in">string</span> jwt = <span class="keyword">new</span> JwtSecurityTokenHandler().WriteToken(tokenDescriptor); <span class="comment">//ç”ŸæˆJWT</span></span><br><span class="line">            <span class="keyword">return</span> jwt; <span class="comment">//è¾“å‡ºJWT</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">await</span> userManager.AccessFailedAsync(user).CheckAsync(); <span class="comment">//å¢åŠ ç™»å½•å¤±è´¥æ¬¡æ•°</span></span><br><span class="line">            <span class="keyword">return</span> BadRequest(<span class="string">&quot;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>ä¸ºç”¨æˆ·å®ä½“Userç±»å¢åŠ ä¸€ä¸ªlongç±»å‹çš„å±æ€§JWTVersion.</li></ol><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyUser</span>:<span class="title">IdentityUser</span>&lt;<span class="title">long</span>&gt; </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span>? WeiXinAccount &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; </span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> JWTVersion &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;  <span class="comment">// JWTç‰ˆæœ¬å·</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>ä¿®æ”¹ç™»å½•å¹¶å‘æ”¾ä»¤ç‰Œçš„ä»£ç ï¼ŒæŠŠç”¨æˆ·çš„JWTVersionå±æ€§çš„å€¼è‡ªå¢ï¼Œå¹¶ä¸”æŠŠJWTVersionçš„å€¼å†™å…¥JWTä»¤ç‰Œã€‚</li></ol><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">await</span> userManager.AccessFailedAsync(user).CheckAsync(); <span class="comment">//é‡ç½®ç™»å½•å¤±è´¥æ¬¡æ•°</span></span><br><span class="line">user.JWTVersion++; <span class="comment">//å¢åŠ JWTç‰ˆæœ¬å·</span></span><br><span class="line"><span class="keyword">await</span> userManager.UpdateAsync(user); <span class="comment">//æ›´æ–°ç”¨æˆ·ä¿¡æ¯ </span></span><br><span class="line">List&lt;Claim&gt; claims = <span class="keyword">new</span> List&lt;Claim&gt;();</span><br><span class="line">claims.Add(<span class="keyword">new</span> Claim(ClaimTypes.NameIdentifier, user.Id.ToString())); <span class="comment">//ç”¨æˆ·ID</span></span><br><span class="line">claims.Add(<span class="keyword">new</span> Claim(ClaimTypes.Name, user.UserName)); <span class="comment">//ç”¨æˆ·å</span></span><br><span class="line">claims.Add(<span class="keyword">new</span> Claim(<span class="string">&quot;JWTVersion&quot;</span>, user.JWTVersion.ToString())); <span class="comment">//JWTç‰ˆæœ¬å· </span></span><br></pre></td></tr></table></figure><ol start="3"><li>ç¼–å†™ä¸€ä¸ªæ“ä½œç­›é€‰å™¨ï¼Œç»Ÿä¸€å®ç°å¯¹æ‰€æœ‰çš„æ§åˆ¶å™¨çš„æ“ä½œæ–¹æ³•ä¸­JWTä»¤ç‰Œçš„æ£€æŸ¥æ“ä½œã€‚æŠŠJWTValidationFilteræ³¨å†Œåˆ°Program.csä¸­MVCçš„å…¨å±€ç­›é€‰å™¨ä¸­ã€‚</li></ol><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">JWTValidationFilter</span> : <span class="title">IAsyncActionFilter</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> IMemoryCache memCache; <span class="comment">//å†…å­˜ç¼“å­˜</span></span><br><span class="line">    <span class="keyword">private</span> UserManager&lt;MyUser&gt; userManager; <span class="comment">//ç”¨æˆ·ç®¡ç†å™¨</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">JWTValidationFilter</span>(<span class="params">IMemoryCache memCache, UserManager&lt;MyUser&gt; userManager</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//æ„é€ å‡½æ•°</span></span><br><span class="line">        <span class="comment">//æ³¨å…¥å†…å­˜ç¼“å­˜å’Œç”¨æˆ·ç®¡ç†å™¨            </span></span><br><span class="line">        <span class="keyword">this</span>.memCache = memCache;</span><br><span class="line">        <span class="keyword">this</span>.userManager = userManager;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">OnActionExecutionAsync</span>(<span class="params">ActionExecutingContext context, ActionExecutionDelegate next</span>)</span> </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> claimUserId = context.HttpContext.User.FindFirst(ClaimTypes.NameIdentifier); <span class="comment">//è·å–ç”¨æˆ·ID</span></span><br><span class="line">        <span class="keyword">if</span>(claimUserId == <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">await</span> next(); <span class="comment">//å¦‚æœæ²¡æœ‰ç”¨æˆ·IDï¼Œç»§ç»­æ‰§è¡Œ</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">long</span> userId = <span class="built_in">long</span>.Parse(claimUserId!.Value); <span class="comment">//è§£æç”¨æˆ·ID</span></span><br><span class="line">        <span class="built_in">string</span> cacheKey = <span class="string">$&quot;JWTValidationFilter.UserInfo.<span class="subst">&#123;userId&#125;</span>&quot;</span>; <span class="comment">//ç¼“å­˜é”®</span></span><br><span class="line">        MyUser user = <span class="keyword">await</span> memCache.GetOrCreateAsync(cacheKey, <span class="keyword">async</span> e =&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            e.AbsoluteExpirationRelativeToNow = TimeSpan.FromMinutes(<span class="number">5</span>); <span class="comment">//è®¾ç½®ç¼“å­˜è¿‡æœŸæ—¶é—´</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">await</span> userManager.FindByIdAsync(userId.ToString()); <span class="comment">//æ ¹æ®ç”¨æˆ·IDæŸ¥æ‰¾ç”¨æˆ·</span></span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">if</span>(user == <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> result = <span class="keyword">new</span> ObjectResult(<span class="string">$&quot;UserId(<span class="subst">&#123;userId&#125;</span>) not found&quot;</span>); <span class="comment">//ç”¨æˆ·ä¸å­˜åœ¨</span></span><br><span class="line">            result.StatusCode = (<span class="built_in">int</span>)HttpStatusCode.Unauthorized; <span class="comment">//æœªæˆæƒ</span></span><br><span class="line">            context.Result = result; <span class="comment">//è®¾ç½®ç»“æœ</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> claimJWTVersion = context.HttpContext.User.FindFirst(ClaimTypes.Version); <span class="comment">//è·å–JWTç‰ˆæœ¬å·</span></span><br><span class="line">        <span class="built_in">long</span> jwtVersion = <span class="built_in">long</span>.Parse(claimJWTVersion!.Value); <span class="comment">//è§£æJWTç‰ˆæœ¬å·</span></span><br><span class="line">        <span class="keyword">if</span>(jwtVersion != user.JWTVersion) <span class="comment">//å¦‚æœJWTç‰ˆæœ¬å·ä¸åŒ¹é…</span></span><br><span class="line">        &#123;</span><br><span class="line">            next(); <span class="comment">//ç»§ç»­æ‰§è¡Œ</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> result = <span class="keyword">new</span> ObjectResult(<span class="string">$&quot;UserId(<span class="subst">&#123;userId&#125;</span>) JWTVersion(<span class="subst">&#123;jwtVersion&#125;</span>) not match&quot;</span>); <span class="comment">//JWTç‰ˆæœ¬å·ä¸åŒ¹é…</span></span><br><span class="line">            result.StatusCode = (<span class="built_in">int</span>)HttpStatusCode.Unauthorized; <span class="comment">//æœªæˆæƒ</span></span><br><span class="line">            context.Result = result; <span class="comment">//è®¾ç½®ç»“æœ</span></span><br><span class="line">            <span class="keyword">return</span>; <span class="comment">//è¿”å›</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="4"><li>æŠŠJWTValidationFilteræ³¨å†Œåˆ°Program.csä¸­MVCçš„å…¨å±€ç­›é€‰å™¨ä¸­ã€‚</li></ol><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">builder.Services.Configure&lt;MvcOptions&gt;(opt =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    opt.Filters.Add&lt;JWTValidationFilter&gt;(); <span class="comment">// æ·»åŠ JWTéªŒè¯è¿‡æ»¤å™¨</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ASP.NET Core </tag>
            
            <tag> Entity Framework Core </tag>
            
            <tag> JWT </tag>
            
            <tag> SignalR </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ASP.NET Core æ‰˜ç®¡ï¼Œæ•°æ®çš„æ ¡éªŒ</title>
      <link href="/2025/05/09/asp.net%20core/ASP.NET%20Core%E9%AB%98%E7%BA%A7%E7%BB%84%E4%BB%B6%E4%BA%8C/"/>
      <url>/2025/05/09/asp.net%20core/ASP.NET%20Core%E9%AB%98%E7%BA%A7%E7%BB%84%E4%BB%B6%E4%BA%8C/</url>
      
        <content type="html"><![CDATA[<h1 id="æ‰˜ç®¡-è½®è¯¢-æœåŠ¡"><a href="#æ‰˜ç®¡-è½®è¯¢-æœåŠ¡" class="headerlink" title="æ‰˜ç®¡(è½®è¯¢)æœåŠ¡"></a>æ‰˜ç®¡(è½®è¯¢)æœåŠ¡</h1><ol><li>åœºæ™¯ï¼Œä»£ç è¿è¡Œåœ¨åå°ã€‚æ¯”å¦‚æœåŠ¡å™¨å¯åŠ¨çš„æ—¶å€™åœ¨åå°é¢„å…ˆåŠ è½½æ•°æ®åœ¨ç¼“å­˜ï¼Œæ¯å¤©å‡Œæ™¨3ç‚¹æŠŠæ•°æ®å¯¼å‡ºåˆ°å¤‡ä»½æ•°æ®åº“ï¼Œæ¯éš”5ç§’é’Ÿåœ¨ä¸¤å¼ è¡¨ä¹‹é—´åŒæ­¥ä¸€æ¬¡æ•°æ®ã€‚</li><li>æ‰˜ç®¡æœåŠ¡å®ç°IHostdServiceæ¥å£ï¼Œä¸€èˆ¬ç¼–å†™ä»BackgroundServiceç»§æ‰¿çš„ç±»ã€‚<br>æµ‹è¯•ï¼šå»¶è¿Ÿè‹¥å¹²ç§’å†è¯»å–æ–‡ä»¶ï¼Œå†å»¶è¿Ÿï¼Œå†è¾“å‡ºã€‚</li></ol><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">DemoBgService</span>:<span class="title">BackgroundService</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> ILogger&lt;DemoBgService&gt; _logger; <span class="comment">//æ³¨å…¥æ—¥å¿—æœåŠ¡</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DemoBgService</span>(<span class="params">ILogger&lt;DemoBgService&gt; logger</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _logger = logger;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">async</span> Task <span class="title">ExecuteAsync</span>(<span class="params">CancellationToken stoppingToken</span>)</span>   </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">await</span> Task.Delay(<span class="number">3000</span>); <span class="comment">//ç­‰å¾…3ç§’</span></span><br><span class="line">        <span class="built_in">string</span> s = <span class="keyword">await</span> File.ReadAllTextAsync(<span class="string">&quot;D:/SqlServer.txt&quot;</span>); <span class="comment">//è¯»å–æ–‡ä»¶</span></span><br><span class="line">        <span class="keyword">await</span> Task.Delay(<span class="number">3000</span>); <span class="comment">//ç­‰å¾…3ç§’</span></span><br><span class="line">        _logger.LogInformation(s); <span class="comment">// è¾“å‡ºæ—¥å¿—</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è°ƒç”¨AddHostedServiceåˆ°ä¾èµ–æ³¨å…¥å®¹å™¨ä¸­</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">builder.Services.AddHostedService&lt;DemoBgService&gt;(); <span class="comment">//æ³¨å†Œåå°æœåŠ¡</span></span><br></pre></td></tr></table></figure><h2 id="æ‰˜ç®¡æœåŠ¡çš„å¼‚å¸¸é—®é¢˜"><a href="#æ‰˜ç®¡æœåŠ¡çš„å¼‚å¸¸é—®é¢˜" class="headerlink" title="æ‰˜ç®¡æœåŠ¡çš„å¼‚å¸¸é—®é¢˜"></a>æ‰˜ç®¡æœåŠ¡çš„å¼‚å¸¸é—®é¢˜</h2><ol><li>ä».NET 6å¼€å§‹ï¼Œå½“æ‰˜ç®¡æœåŠ¡å‘ç”Ÿæœªå¤„ç†å¼‚å¸¸çš„æ—¶å€™ï¼Œç¨‹åºå°±ä¼šè‡ªåŠ¨åœæ­¢å¹¶é€€å‡ºã€‚å¯ä»¥æŠŠHostOptions.BackgroundServiceExceptionBehaviorè®¾ç½®ä¸ºlgnore,ç¨‹åºä¼šå¿½ç•¥å¼‚å¸¸ï¼Œè€Œä¸æ˜¯åœæ­¢ç¨‹åºã€‚ä¸è¿‡æ¨èé‡‡ç”¨é»˜è®¤çš„è®¾ç½®ï¼Œå› ä¸ºâ€œå¼‚å¸¸åº”è¯¥è¢«å¦¥å–„çš„å¤„ç†ï¼Œè€Œä¸æ˜¯è¢«å¿½ç•¥â€ã€‚</li><li>è¦åœ¨ExecuteAsyncæ–¹æ³•ä¸­æŠŠä»£ç ç”¨tryâ€¦catchåŒ…è£¹èµ·æ¥ï¼Œå½“å‘ç”Ÿå¼‚å¸¸çš„æ—¶å€™ï¼Œè®°å½•æ—¥å¿—ä¸­æˆ–å‘ç”ŸæŠ¥è­¦ç­‰ã€‚</li></ol><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">await</span> Task.Delay(<span class="number">3000</span>); <span class="comment">//ç­‰å¾…3ç§’</span></span><br><span class="line">    <span class="built_in">string</span> s = <span class="keyword">await</span> File.ReadAllTextAsync(<span class="string">&quot;D:/SqlServer.txt&quot;</span>); <span class="comment">//è¯»å–æ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">await</span> Task.Delay(<span class="number">3000</span>); <span class="comment">//ç­‰å¾…3ç§’</span></span><br><span class="line">    _logger.LogInformation(s); <span class="comment">// è¾“å‡ºæ—¥å¿—</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (Exception ex)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;ç¨‹åºä¸­å‡ºç°å¼‚å¸¸&quot;</span>+ex); <span class="comment">//è¾“å‡ºå¼‚å¸¸ä¿¡æ¯</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ‰˜ç®¡æœåŠ¡ä¸­ä½¿ç”¨ä¾èµ–æ³¨å…¥çš„é™·é˜±"><a href="#æ‰˜ç®¡æœåŠ¡ä¸­ä½¿ç”¨ä¾èµ–æ³¨å…¥çš„é™·é˜±" class="headerlink" title="æ‰˜ç®¡æœåŠ¡ä¸­ä½¿ç”¨ä¾èµ–æ³¨å…¥çš„é™·é˜±"></a>æ‰˜ç®¡æœåŠ¡ä¸­ä½¿ç”¨ä¾èµ–æ³¨å…¥çš„é™·é˜±</h2><ol><li><p>æ‰˜ç®¡æœåŠ¡æ˜¯ä»¥å•ä¾‹çš„ç”Ÿå‘½å‘¨æœŸæ³¨å†Œåˆ°ä¾èµ–æ³¨å…¥å®¹å™¨ä¸­çš„ã€‚å› æ­¤ä¸èƒ½æ³¨å…¥ç”Ÿå‘½å‘¨æœŸä¸ºèŒƒå›´æˆ–è€…ç¬å¤ªçš„æœåŠ¡ã€‚æ¯”å¦‚æ³¨å…¥EF Coreçš„ä¸Šä¸‹æ–‡çš„è¯ï¼Œç¨‹åºå°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p></li><li><p>å¯ä»¥é€šè¿‡æ„é€ æ–¹æ³•æ³¨å…¥ä¸€ä¸ªIServiceScopeFactoryæœåŠ¡ï¼Œå®ƒå¯ä»¥ç”¨æ¥åˆ›å»ºä¸€ä¸ªIServiceScopeå¯¹è±¡ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡IServiceScopeæ¥åˆ›å»ºçŸ­ç”Ÿå‘½å‘¨å…¨çš„æœåŠ¡äº†ã€‚è®°å¾—å†Disposeä¸­é‡Šæ”¾IServiceScopeã€‚</p></li><li><p>ä¸‹é¢å®ç°ä¸€ä¸ªå¸¸é©»åå°çš„æ‰˜ç®¡æœåŠ¡ï¼Œå®ƒå®ç°çš„åŠŸèƒ½æ˜¯æ¯éš”5så¯¹æ•°æ®åº“ä¸­çš„æ•°æ®è¿›è¡Œæ±‡æ€»ï¼Œç„¶åæŠŠæ±‡æ€»ç»“æœå†™å…¥ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ä¸­ã€‚</p></li></ol><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ExplortStatisticBgService</span> : <span class="title">BackgroundService</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> MyDbContext ctx; <span class="comment">//æ³¨å…¥æ•°æ®åº“ä¸Šä¸‹æ–‡</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> ILogger&lt;ExplortStatisticBgService&gt; _logger; <span class="comment">//æ³¨å…¥æ—¥å¿—æœåŠ¡</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> IServiceScope serviceScope; <span class="comment">//æ³¨å…¥æœåŠ¡èŒƒå›´</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ExplortStatisticBgService</span>(<span class="params">IServiceScopeFactory scopeFactory</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.serviceScope = scopeFactory.CreateScope(); <span class="comment">//åˆ›å»ºæœåŠ¡èŒƒå›´</span></span><br><span class="line">        <span class="keyword">var</span> sp = serviceScope.ServiceProvider; <span class="comment">//è·å–æœåŠ¡æä¾›è€…</span></span><br><span class="line">        <span class="keyword">this</span>.ctx = sp.GetRequiredService&lt;MyDbContext&gt;(); <span class="comment">//è·å–æ•°æ®åº“ä¸Šä¸‹æ–‡</span></span><br><span class="line">        <span class="keyword">this</span>._logger = sp.GetRequiredService&lt;ILogger&lt;ExplortStatisticBgService&gt;&gt;(); <span class="comment">//è·å–æ—¥å¿—æœåŠ¡</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">async</span> Task <span class="title">ExecuteAsync</span>(<span class="params">CancellationToken stoppingToken</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(!stoppingToken.IsCancellationRequested) <span class="comment">// åˆ¤æ–­æ˜¯å¦å–æ¶ˆè¯·æ±‚</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">await</span> DoExecuteAsync(); <span class="comment">//æ‰§è¡Œå…·ä½“æ“ä½œ</span></span><br><span class="line">                <span class="keyword">await</span> Task.Delay(<span class="number">3000</span>); <span class="comment">//ç­‰å¾…3ç§’</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">            &#123;</span><br><span class="line">                _logger.LogError(ex, <span class="string">&quot;ç¨‹åºä¸­å‡ºç°å¼‚å¸¸&quot;</span>); <span class="comment">//è¾“å‡ºå¼‚å¸¸ä¿¡æ¯</span></span><br><span class="line">                <span class="keyword">await</span> Task.Delay(<span class="number">3000</span>); <span class="comment">//ç­‰å¾…3ç§’</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">async</span> Task <span class="title">DoExecuteAsync</span>() <span class="comment">//æ‰§è¡Œå…·ä½“æ“ä½œ</span></span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// è¿™é‡Œå¯ä»¥æ·»åŠ ä½ éœ€è¦æ‰§è¡Œçš„å…·ä½“æ“ä½œ</span></span><br><span class="line">        <span class="comment">// ä¾‹å¦‚ï¼šå¯¼å‡ºç»Ÿè®¡æ•°æ®åˆ°æ–‡ä»¶ç­‰</span></span><br><span class="line">        <span class="comment">//await Task.Delay(1000); //æ¨¡æ‹Ÿå¼‚æ­¥æ“ä½œ</span></span><br><span class="line">        <span class="keyword">var</span> items = ctx.Users.GroupBy(u =&gt; u.UserName).Select(g =&gt; <span class="keyword">new</span></span><br><span class="line">        &#123;</span><br><span class="line">            UserName = g.Key, <span class="comment">//åˆ†ç»„çš„é”®</span></span><br><span class="line">            Count = g.Count() <span class="comment">//ç»Ÿè®¡æ¯ä¸ªç”¨æˆ·çš„æ•°é‡</span></span><br><span class="line">        &#125;); <span class="comment">// åˆ†ç»„ç»Ÿè®¡</span></span><br><span class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder(); <span class="comment">//åˆ›å»ºStringBuilderå¯¹è±¡</span></span><br><span class="line">        sb.AppendLine(<span class="string">$&quot;Date:<span class="subst">&#123;DateTime.Now&#125;</span>&quot;</span>); <span class="comment">//æ·»åŠ å½“å‰æ—¥æœŸ</span></span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> items) <span class="comment">// éå†ç»Ÿè®¡ç»“æœ</span></span><br><span class="line">        &#123;</span><br><span class="line">            sb.Append(item.UserName).AppendLine(<span class="string">$&quot;:<span class="subst">&#123;item.Count&#125;</span>&quot;</span>); <span class="comment">//æ·»åŠ ç”¨æˆ·åå’Œæ•°é‡</span></span><br><span class="line">            sb.AppendLine(); <span class="comment">//æ·»åŠ ç©ºè¡Œ</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">await</span> File.WriteAllTextAsync(<span class="string">&quot;D:/SqlServer.txt&quot;</span>, sb.ToString()); <span class="comment">//å†™å…¥æ–‡ä»¶</span></span><br><span class="line">        _logger.LogInformation(<span class="string">&quot;å¯¼å‡ºç»Ÿè®¡æ•°æ®æˆåŠŸ&quot;</span>); <span class="comment">//è¾“å‡ºæ—¥å¿—</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Dispose</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">base</span>.Dispose(); <span class="comment">//é‡Šæ”¾èµ„æº</span></span><br><span class="line">        serviceScope.Dispose(); <span class="comment">//é‡Šæ”¾æœåŠ¡èŒƒå›´</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è¯·æ±‚æ•°æ®çš„æ ¡éªŒ"><a href="#è¯·æ±‚æ•°æ®çš„æ ¡éªŒ" class="headerlink" title="è¯·æ±‚æ•°æ®çš„æ ¡éªŒ"></a>è¯·æ±‚æ•°æ®çš„æ ¡éªŒ</h2><p>.NET Coreä¸­å†…ç½®äº†å¯¹æ•°æ®æ ¡éªŒçš„æ”¯æŒï¼Œåœ¨System.ComponentModel.DataAnnotationså‘½åç©ºé—´ä¸‹å®šä¹‰äº†éå¸¸å¤šçš„æ ¡éªŒè§„åˆ™Attribute,æ¯”å¦‚[Required]ç”¨æ¥è®¾ç½®å€¼å¿…é¡»æ˜¯éç©ºçš„ã€[EmailAddress]ç”¨æ¥è®¾ç½®å€¼å¿…é¡»æ˜¯Emailæ ¼å¼çš„ã€[RegularExpression]ç”¨æ¥æ ¹æ®ç»™å®šçš„æ­£åˆ™è¡¨è¾¾å¼å¯¹æ•°æ®è¿›è¡Œæ ¡éªŒã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨CustomValidationAttributeæˆ–è€…æ¨¡å‹ç±»å®ç°IValidatableObjectæ¥å£æ¥ç¼–å†™è‡ªå®šä¹‰çš„æ ¡éªŒè§„åˆ™ã€‚</p><p>.NET Coreå†…ç½®çš„æ ¡éªŒæœºåˆ¶æœ‰ä»¥ä¸‹å‡ ä¸ªé—®é¢˜</p><ol><li>æ— è®ºæ˜¯é€šè¿‡åœ¨å±æ€§ä¸Šæ ‡æ³¨æ ¡éªŒè§„åˆ™Attributeçš„æ–¹æ³•ï¼Œè¿˜æ˜¯å®ç°IValidatableObjectæ¥å£çš„æ–¹å¼ï¼Œæˆ‘ä»¬çš„æ ¡éªŒè§„åˆ™éƒ½æ˜¯å’Œæ¨¡å‹ç±»è€¦åˆåœ¨ä¸€èµ·çš„ï¼Œè¿™è¿åäº†é¢å‘å¯¹è±¡çš„â€œå•ä¸€èŒè´£åŸåˆ™â€ã€‚</li><li>.NET Coreä¸­å†…ç½®çš„æ ¡éªŒè§„åˆ™ä¸å¤Ÿå¤šï¼Œå¾ˆå¤šå¸¸ç”¨çš„æ ¡éªŒéœ€æ±‚éƒ½éœ€è¦æˆ‘ä»¬ç¼–å†™è‡ªå®šä¹‰æ ¡éªŒè§„åˆ™ã€‚</li></ol><h2 id="FluentValidationçš„åŸºæœ¬ä½¿ç”¨"><a href="#FluentValidationçš„åŸºæœ¬ä½¿ç”¨" class="headerlink" title="FluentValidationçš„åŸºæœ¬ä½¿ç”¨"></a>FluentValidationçš„åŸºæœ¬ä½¿ç”¨</h2><ol><li>FluentValidationï¼šç”¨ç±»ä¼¼äºEF Coreä¸­Fluent APIçš„æ–¹å¼è¿›è¡Œæ ¡éªŒè§„åˆ™çš„é…ç½®ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¯ä»¥æŠŠå¯¹æ¨¡å‹ç±»çš„æ ¡éªŒæ”¾åˆ°å•ç‹¬çš„æ ¡éªŒç±»ä¸­ã€‚</li><li>åœ¨é¡¹ç›®ä¸­å®‰è£…NuGetåŒ…ï¼š<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FluentValidation.AspNetCore</span><br></pre></td></tr></table></figure></li></ol><p>ç¬¬ä¸€æ­¥ï¼Œåœ¨Program.csä¸­æ·»åŠ æ³¨å†Œç›¸å…³æœåŠ¡çš„ä»£ç ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">builder.Services.AddFluentValidationAutoValidation(); <span class="comment">//æ³¨å†ŒFluentValidationè‡ªåŠ¨éªŒè¯</span></span><br><span class="line">builder.Services.AddFluentValidationClientsideAdapters(); <span class="comment">//æ³¨å†ŒFluentValidationå®¢æˆ·ç«¯éªŒè¯</span></span><br><span class="line">builder.Services.AddValidatorsFromAssemblies(AppDomain.CurrentDomain.GetAssemblies()); <span class="comment">//æ³¨å†Œæ‰€æœ‰ç¨‹åºé›†ä¸­çš„éªŒè¯å™¨</span></span><br></pre></td></tr></table></figure><p>AddValidatorsFromAssembliesæ–¹æ³•ç”¨äºæŠŠæŒ‡å®šç¨‹åºé›†ä¸­æ‰€æœ‰å®ç°äº†IValidatoræ¥å£çš„æ•°æ®æ ¡éªŒç±»æ³¨å†Œåˆ°ä¾èµ–æ³¨å…¥å®¹å™¨ä¸­ã€‚</p><p>ç¬¬äºŒæ­¥ï¼Œç¼–å†™ä¸€ä¸ªæ¨¡å‹ç±»Login2Requestã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">record</span> <span class="title">Login2Request</span>(<span class="params"><span class="built_in">string</span> Email,<span class="built_in">string</span> Password,<span class="built_in">string</span> Password2</span>)</span>; <span class="comment">//å®šä¹‰ç™»å½•è¯·æ±‚è®°å½•</span></span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰æ­¥ï¼Œç¼–å†™ä¸€ä¸ªç»§æ‰¿è‡ªAbstractValidatorçš„æ•°æ®æ ¡éªŒç±»ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Login2RequestValidator</span> : <span class="title">AbstractValidator</span>&lt;<span class="title">Login2Request</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Login2RequestValidator</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        RuleFor(x =&gt; x.Email)</span><br><span class="line">            .NotEmpty().WithMessage(<span class="string">&quot;é‚®ç®±ä¸èƒ½ä¸ºç©º&quot;</span>)</span><br><span class="line">            .EmailAddress().WithMessage(<span class="string">&quot;é‚®ç®±æ ¼å¼ä¸æ­£ç¡®&quot;</span>);</span><br><span class="line">        RuleFor(x =&gt; x.Password)</span><br><span class="line">            .NotEmpty().WithMessage(<span class="string">&quot;å¯†ç ä¸èƒ½ä¸ºç©º&quot;</span>)</span><br><span class="line">            .MinimumLength(<span class="number">6</span>).WithMessage(<span class="string">&quot;å¯†ç é•¿åº¦ä¸èƒ½å°äº6ä½&quot;</span>);</span><br><span class="line">        RuleFor(x =&gt; x.Password2)</span><br><span class="line">            .NotEmpty().WithMessage(<span class="string">&quot;ç¡®è®¤å¯†ç ä¸èƒ½ä¸ºç©º&quot;</span>)</span><br><span class="line">            .Equal(x =&gt; x.Password).WithMessage(<span class="string">&quot;ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ValuesController</span> : <span class="title">ControllerBase</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">HttpPost</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ActionResult <span class="title">Login</span>(<span class="params">Login2Request request</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> Ok(request); <span class="comment">//è¿”å›è¯·æ±‚å¯¹è±¡</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/img%5CWEBAPI%5C27.png"></p><h2 id="FluentValidationä¸­çš„æ³¨å…¥æœåŠ¡"><a href="#FluentValidationä¸­çš„æ³¨å…¥æœåŠ¡" class="headerlink" title="FluentValidationä¸­çš„æ³¨å…¥æœåŠ¡"></a>FluentValidationä¸­çš„æ³¨å…¥æœåŠ¡</h2><p>åœ¨ç¼–å†™æ•°æ®æ ¡éªŒä»£ç çš„æ—¶å€™ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦è°ƒç”¨ä¾èµ–æ³¨å…¥å®¹å™¨ä¸­çš„æœåŠ¡ï¼ŒFluentValidationä¸­çš„æ•°æ®æ ¡éªŒç±»æ˜¯é€šè¿‡ä¾èµ–æ³¨å…¥å®¹å™¨å®ä¾‹åŒ–çš„ï¼Œå› æ­¤æˆ‘ä»¬åŒæ ·å¯ä»¥é€šè¿‡æ„é€ æ–¹æ³•æ¥æ•°æ®æ ¡éªŒä¸­æ³¨å…¥æœåŠ¡ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Login3RequestValidator</span> : <span class="title">AbstractValidator</span>&lt;<span class="title">Login3Request</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Login3RequestValidator</span>(<span class="params">MyDbContext dbCtx</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        RuleFor(x =&gt; x.UserName).NotNull()</span><br><span class="line">            .MustAsync((name,_) =&gt;dbCtx.Users.AnyAsync(u =&gt; u.UserName == name))</span><br><span class="line">            .WithMessage(c =&gt; <span class="string">$&quot;ç”¨æˆ·å<span class="subst">&#123;c.UserName&#125;</span>ä¸å­˜åœ¨&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ASP.NET Core </tag>
            
            <tag> Entity Framework Core </tag>
            
            <tag> JWT </tag>
            
            <tag> SignalR </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ASP.NET Coreç­›é€‰å™¨ï¼Œä¸­é—´ä»¶</title>
      <link href="/2025/04/24/asp.net%20core/ASP.NET%20Core%E7%AD%9B%E9%80%89%E5%99%A8%EF%BC%8C%E4%B8%AD%E9%97%B4%E4%BB%B6/"/>
      <url>/2025/04/24/asp.net%20core/ASP.NET%20Core%E7%AD%9B%E9%80%89%E5%99%A8%EF%BC%8C%E4%B8%AD%E9%97%B4%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="ç­›é€‰å™¨"><a href="#ç­›é€‰å™¨" class="headerlink" title="ç­›é€‰å™¨"></a>ç­›é€‰å™¨</h1><p>1.ç­›é€‰å™¨ï¼ˆfilter,ä¹Ÿå¯ä»¥ç¿»è¯‘ä¸ºâ€œè¿‡æ»¤å™¨â€ï¼‰æ˜¯ASP.NET Coreä¸­æä¾›çš„ä¸€ç§åˆ‡é¢ç¼–ç¨‹æœºåˆ¶ï¼Œå®ƒå…è®¸å¼€å‘äººå‘˜åˆ›å»ºè‡ªå®šä¹‰ç­›é€‰å™¨æ¥å¤„ç†æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼Œä¹Ÿå°±æ˜¯åœ¨ASP.NET Coreç‰¹å®šçš„ä½ç½®æ‰§è¡Œæˆ‘ä»¬è‡ªå®šä¹‰çš„ä»£ç ï¼Œæ¯”å¦‚åœ¨æ§åˆ¶å™¨çš„æ“ä½œæ–¹æ³•ä¹‹å‰æ‰§è¡Œæ•°æ®æ£€æŸ¥çš„ä»£ç ï¼Œæˆ–è€…åœ¨ActionResultæ‰§è¡Œçš„æ—¶å€™å‘å“åº”æŠ¥æ–‡å¤´ä¸­å†™å…¥è‡ªå®šä¹‰æ•°æ®ç­‰ã€‚<br>2.ASP.NET Coreä¸­çš„ç­›é€‰å™¨æœ‰ä»¥ä¸‹5ç§ç±»å‹ï¼šæˆæƒç­›é€‰å™¨ï¼ˆAuthorization filterï¼‰ã€èµ„æºç­›é€‰å™¨ï¼ˆResource filterï¼‰ã€æ“ä½œç­›é€‰å™¨ï¼ˆAction filterï¼‰ã€å¼‚å¸¸ç­›é€‰å™¨ï¼ˆException filterï¼‰ã€ç»“æœç­›é€‰å™¨ï¼ˆResult filterï¼‰ã€‚<br>3.æ‰€æœ‰ç­›é€‰å™¨ä¸€èˆ¬æœ‰åŒæ­¥å’Œå¼‚æ­¥ä¸¤ä¸ªç‰ˆæœ¬ï¼Œåœ¨å¤§éƒ¨åˆ†åœºæ™¯ä¸‹ï¼Œå¼‚æ­¥ç­›é€‰å™¨çš„æ€§èƒ½æ›´å¥½ï¼Œè€Œä¸”å¯ä»¥æ”¯æŒåœ¨å®ç°ç±»ä¸­ç¼–å†™å¼‚æ­¥è°ƒç”¨çš„ä»£ç ã€‚</p><h2 id="å¼‚å¸¸ç­›é€‰å™¨"><a href="#å¼‚å¸¸ç­›é€‰å™¨" class="headerlink" title="å¼‚å¸¸ç­›é€‰å™¨"></a>å¼‚å¸¸ç­›é€‰å™¨</h2><p>å½“ç³»ç»Ÿä¸­å‡ºç°æœªç»å¤„ç†çš„å¼‚å¸¸çš„æ—¶å€™ï¼Œå¼‚å¸¸ç­›é€‰å™¨å°±ä¼šæ‰§è¡Œï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¼‚å¸¸ç­›é€‰å™¨ä¸­å¯¹å¼‚å¸¸è¿›è¡Œå¤„ç†ã€‚<br>è¿™æ ·çš„å¼‚å¸¸ä¿¡æ¯åªæœ‰å®¢æˆ·ç«¯æ‰çŸ¥é“ï¼Œç½‘ç«™çš„è¿ç»´äººå‘˜ä¸çŸ¥é“è¿™ä¸ªå¼‚å¸¸çš„å­˜åœ¨ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç¨‹åºä¸­æŠŠæœªå¤„ç†å¼‚å¸¸è®°å½•åˆ°æ—¥å¿—ä¸­ã€‚</p><p>1.å½“ç³»ç»Ÿä¸­å‡ºç°æœªå¤„ç†å¼‚å¸¸çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ç»Ÿä¸€ç»™å®¢æˆ·ç«¯è¿”å›å¦‚ä¸‹æ ¼å¼çš„å“åº”æŠ¥æ–‡ï¼š{â€œcodeâ€:â€500â€,â€messageâ€:â€å¼‚å¸¸ä¿¡æ¯â€}ã€‚å¯¹äºå¼€å‘ç¯å¢ƒä¸­messageæ˜¯å¼‚å¸¸å †æ ˆï¼Œå¯¹äºå…¶ä»–ç¯å¢ƒmessageç”¨ä¸€ä¸ªgeneralçš„æŠ¥é”™ä¿¡æ¯ã€‚<br>2.å®ç°IAsyncExceptionFileræ¥å£ã€‚æ³¨å…¥IHostEnvironmentå¾—çŸ¥è¿è¡Œç¯å¢ƒã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyExceptionFilter</span> : <span class="title">IAsyncExceptionFilter</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> ILogger&lt;MyExceptionFilter&gt; logger;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> IHostEnvironment env;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyExceptionFilter</span>(<span class="params">ILogger&lt;MyExceptionFilter&gt; logger, IHostEnvironment env</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.logger = logger;</span><br><span class="line">        <span class="keyword">this</span>.env = env;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Task <span class="title">OnExceptionAsync</span>(<span class="params">ExceptionContext context</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Exception exception = context.Exception;</span><br><span class="line">        logger.LogError(exception,<span class="string">&quot;UnhandledException occured&quot;</span>);</span><br><span class="line">        <span class="built_in">string</span> message;</span><br><span class="line">        <span class="keyword">if</span>(env.IsDevelopment())</span><br><span class="line">        &#123;</span><br><span class="line">            message = exception.ToString();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">           message= <span class="string">&quot;ç¨‹åºä¸­å‡ºç°æœªå¤„ç†å¼‚å¸¸&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ObjectResult result = <span class="keyword">new</span> ObjectResult(<span class="keyword">new</span> &#123; code = <span class="number">500</span>, message = message &#125;);</span><br><span class="line">        result.StatusCode = <span class="number">500</span>;</span><br><span class="line">        context.Result = result;</span><br><span class="line">        context.ExceptionHandled = <span class="literal">true</span>; <span class="comment">// æ ‡è®°å¼‚å¸¸å·²å¤„ç†</span></span><br><span class="line">        <span class="keyword">return</span> Task.CompletedTask;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è®¾ç½®context.ExceptionHandled &#x3D; true;é€šè¿‡è¿™æ ·çš„æ–¹å¼æ¥å‘ŠçŸ¥ASP.NET Coreä¸å†æ‰§è¡Œé»˜è®¤çš„å¼‚å¸¸å“åº”é€»è¾‘ã€‚</p><p>æˆ‘ä»¬åœ¨Program.csçš„builder.Buildä¹‹å‰æ·»åŠ å…¨å±€çš„ç­›é€‰å™¨ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">builder.Services.Configure&lt;MvcOptions&gt;(options =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    options.Filters.Add&lt;MyExceptionFilter&gt;();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>MvcOptionsæ˜¯ASP.NET Coreé¡¹ç›®çš„ä¸»è¦é…ç½®å¯¹è±¡ï¼Œæˆ‘ä»¬åœ¨ç¬¬3è¡Œä»£ç ä¸­å‘Filtersæ³¨å†Œå…¨å±€çš„ç­›é€‰å™¨ï¼Œè¿™æ ·ï¼Œé¡¹ç›®ä¸­æ‰€æœ‰çš„ASP.NET Coreä¸­çš„æœªå¤„ç†å¼‚å¸¸éƒ½ä¼šè¢«MyExxceptionFilterå¤„ç†ã€‚ç”¨è¿™ç§æ–¹å¼æ³¨å…¥çš„ç­›é€‰å™¨æ˜¯ç”±ä¾èµ–æ³¨å…¥æœºåˆ¶è¿›è¡Œç®¡ç†çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡æ„é€ æ–¹æ³•ä¸ºç­›é€‰å™¨æ³¨å…¥å…¶ä»–çš„æœåŠ¡ã€‚</p><h2 id="æ“ä½œç­›é€‰å™¨åŸºç¡€"><a href="#æ“ä½œç­›é€‰å™¨åŸºç¡€" class="headerlink" title="æ“ä½œç­›é€‰å™¨åŸºç¡€"></a>æ“ä½œç­›é€‰å™¨åŸºç¡€</h2><p>æ¯æ¬¡ASP.NET Coreä¸­æ§åˆ¶å™¨çš„æ“ä½œå™¨çš„æ“ä½œæ–¹æ³•æ‰§è¡Œçš„æ—¶å€™ï¼Œæ“ä½œç­›é€‰å™¨éƒ½ä¼šè¢«æ‰§è¡Œï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ“ä½œæ–¹æ³•æ‰§è¡Œä¹‹å‰å’Œæ‰§è¡Œä¹‹åæ‰§è¡Œä¸€äº›ä»£ç ï¼Œå®Œæˆç‰¹å®šçš„åŠŸèƒ½ã€‚<br>æ“ä½œç­›é€‰å™¨ä¸€èˆ¬å®ç°IAsyncActionFilteræ¥å£ï¼Œè¿™ä¸ªæ¥å£å®šä¹‰OnActionExecutionAsyncæ–¹æ³•ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Task OnActionExecutionAsync (ActionExecutingContext context, ActionExecutionDelegate next)</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œcontextå‚æ•°ä»£è¡¨Actionæ‰§è¡Œçš„ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œä»contextä¸­æˆ‘ä»¬å¯ä»¥è·å–è¯·æ±‚çš„è·¯å¾„ã€å‚æ•°å€¼ç­‰ä¿¡æ¯ï¼›nextå‚æ•°ä»£è¡¨ä¸‹ä¸€ä¸ªè¦æ‰§è¡Œçš„æ“ä½œç­›é€‰å™¨ã€‚ä¸€ä¸ªé¡¹ç›®ä¸­å¯ä»¥æ³¨å†Œå¤šä¸ªæ“ä½œç­›é€‰å™¨ï¼Œè¿™äº›æ“ä½œç­›é€‰å™¨ç»„æˆä¸€ä¸ªé“¾ï¼Œä¸Šä¸€ä¸ªç­›é€‰å™¨æ‰§è¡Œå®Œäº†å†æ‰§è¡Œä¸‹ä¸€ä¸ªã€‚nextå°±æ˜¯ä¸€ä¸ªç”¨æ¥æŒ‡å‘ä¸‹ä¸€ä¸ªç­›é€‰å™¨çš„è¯ï¼Œnextå°±ä¼šæ‰§è¡Œè¦æ‰§è¡Œçš„æ“ä½œæ–¹æ³•ã€‚</p><p><img src="/img%5CWEBAPI%5C16.png"></p><p>1.ç¼–å†™ä¸€ä¸ªå®ç°äº†IAsyncActionFilteræ¥å£çš„ç±»MyActionFilter1.</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyActionFilter1</span> : <span class="title">IAsyncActionFilter</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">OnActionExecutionAsync</span>(<span class="params">ActionExecutingContext context, ActionExecutionDelegate next</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;MyActionFilter1ï¼šå¼€å§‹æ‰§è¡Œ&quot;</span>);</span><br><span class="line">        ActionExecutedContext r = <span class="keyword">await</span> next();</span><br><span class="line">        <span class="keyword">if</span>(r.Exception != <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;MyActionFilter1ï¼šå‘ç”Ÿå¼‚å¸¸&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;MyActionFilter1ï¼šæ‰§è¡Œç»“æŸ&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>nextçš„è¿”å›å€¼æ˜¯æ“ä½œæ–¹æ³•çš„æ‰§è¡Œç»“æœï¼Œè¿”å›å€¼æ˜¯ActionExecutedContextç±»å‹çš„ã€‚å¦‚æœæ“ä½œæ–¹æ³•æ‰§è¡Œçš„æ—¶å€™å‡ºç°äº†æœªå¤„ç†å¼‚å¸¸ï¼Œé‚£ä¹ˆActionExecutedContextçš„Exceptionå±æ€§å°±æ˜¯å¼‚å¸¸å¯¹è±¡ï¼ŒActionExecutedContextçš„Resultå±æ€§å°±æ˜¯æ“ä½œæ–¹æ³•çš„æ‰§è¡Œç»“æœã€‚</p><p>2.ç¼–å†™ä¸€ä¸ªå’ŒMyActionFilter1ç±»ä¼¼çš„ç±»MyActionFilter2.</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyActionFilter2</span> : <span class="title">IAsyncActionFilter</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">OnActionExecutionAsync</span>(<span class="params">ActionExecutingContext context, ActionExecutionDelegate next</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;MyActionFilter2ï¼šå¼€å§‹æ‰§è¡Œ&quot;</span>);</span><br><span class="line">        ActionExecutedContext r = <span class="keyword">await</span> next();</span><br><span class="line">        <span class="keyword">if</span>(r.Exception != <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;MyActionFilter2ï¼šå‘ç”Ÿå¼‚å¸¸&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;MyActionFilter2ï¼šæ‰§è¡Œç»“æŸ&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3.åœ¨Program.csä¸­æ³¨å†Œè¿™ä¸¤ä¸ªæ“ä½œç­›é€‰å™¨ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">builder.Services.Configure&lt;MvcOptions&gt;(options =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// æ·»åŠ å…¨å±€ç­›é€‰å™¨</span></span><br><span class="line">    options.Filters.Add(<span class="keyword">new</span> MyActionFilter1());</span><br><span class="line">    options.Filters.Add(<span class="keyword">new</span> MyActionFilter2());</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>4.åœ¨æ§åˆ¶å…¶ä¸­å¢åŠ ä¸€ä¸ªè¦æµ‹è¯•çš„æ“ä½œæ–¹æ³•ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">HttpGet</span>]</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">Get</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;TextControllerï¼šGetæ–¹æ³•è¢«è°ƒç”¨&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Hello, World!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œ</p><p><img src="/img%5CWEBAPI%5C17.png"></p><h1 id="æ¡ˆä¾‹ï¼šè‡ªåŠ¨å¯åŠ¨äº‹åŠ¡çš„æ“ä½œç­›é€‰å™¨"><a href="#æ¡ˆä¾‹ï¼šè‡ªåŠ¨å¯åŠ¨äº‹åŠ¡çš„æ“ä½œç­›é€‰å™¨" class="headerlink" title="æ¡ˆä¾‹ï¼šè‡ªåŠ¨å¯åŠ¨äº‹åŠ¡çš„æ“ä½œç­›é€‰å™¨"></a>æ¡ˆä¾‹ï¼šè‡ªåŠ¨å¯åŠ¨äº‹åŠ¡çš„æ“ä½œç­›é€‰å™¨</h1><p>1.æ•°æ®åº“äº‹åŠ¡ï¼šè¦ä¹ˆå…¨éƒ¨æˆåŠŸã€è¦ä¹ˆå…¨éƒ¨å¤±è´¥ã€‚<br>2.è‡ªåŠ¨åŒ–ï¼šå¯åŠ¨ã€æäº¤ä»¥åŠå›æ»šäº‹åŠ¡ã€‚<br>3.å½“ä¸€æ®µä½¿ç”¨EF Coreè¿›è¡Œæ•°æ®åº“æ“ä½œçš„ä»£ç æ”¾åˆ°TransactionScopeå£°æ˜çš„èŒƒå›´ä¸­çš„æ—¶å€™ï¼Œè¿™æ®µä»£ç å°±ä¼šè‡ªåŠ¨è¢«æ ‡è®°ä¸ºâ€œæ”¯æŒäº‹åŠ¡â€ã€‚<br>4.TransactionScopeå®ç°äº†IDisposaleæ¥å£ï¼Œå¦‚æœä¸€ä¸ªTransactionScopeçš„å¯¹è±¡æ²¡æœ‰è°ƒç”¨Conmplete()å°±æ‰§è¡Œäº†Dispose()æ–¹æ³•ï¼Œåˆ™äº‹åŠ¡ä¼šè¢«å›æ»šï¼Œå¦åˆ™äº‹åŠ¡å°±ä¼šè¢«æäº¤ã€‚<br>5.TransactionScopeè¿˜æ”¯æŒåµŒå¥—å¼äº‹åŠ¡ã€‚<br>6..NET Coreä¸­çš„TransactionScopeä¸åƒ.NET FXä¸€æ ·æœ‰MSDTCåˆ†å¸ƒå¼äº‹åŠ¡æå‡çš„é—®é¢˜ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">DemoController</span> : <span class="title">ControllerBase</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> MyDbContext ctx;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DemoController</span>(<span class="params">MyDbContext ctx</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.ctx = ctx;</span><br><span class="line">    &#125;</span><br><span class="line">    [<span class="meta">HttpGet</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;<span class="built_in">string</span>&gt; <span class="title">Test1</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">using</span> (TransactionScope tx=<span class="keyword">new</span> TransactionScope(<span class="comment">/*TransactionScopeAsyncFlowOption.Enabled*/</span>)) </span><br><span class="line">        &#123;</span><br><span class="line">            ctx.Books.Add(<span class="keyword">new</span> Book &#123; Name = <span class="string">&quot;.Net1&quot;</span>, Price = <span class="number">1</span> &#125;);</span><br><span class="line">            <span class="keyword">await</span> ctx.SaveChangesAsync(); <span class="comment">// è¿™é‡Œä¼šè‡ªåŠ¨å¯ç”¨äº‹åŠ¡</span></span><br><span class="line">            ctx.Personcs.Add(<span class="keyword">new</span> Personcs &#123; Name = <span class="string">&quot;YOUXIANYU&quot;</span>, Age = <span class="number">19</span> &#125;);</span><br><span class="line">            <span class="keyword">await</span> ctx.SaveChangesAsync(); <span class="comment">// è¿™é‡Œä¼šè‡ªåŠ¨å¯ç”¨äº‹åŠ¡</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;ok&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ç¼–å†™çš„æ“ä½œæ–¹æ³•ä¸­ï¼Œå¯èƒ½ä¸å¸Œæœ›æœ‰çš„æ–¹æ³•è‡ªåŠ¨å¯ç”¨äº‹åŠ¡æ§åˆ¶ï¼Œå¯ä»¥ç»™è¿™äº›æ“ä½œæ–¹æ³•æ·»åŠ ä¸€ä¸ªè‡ªå®šä¹‰çš„NotTransactionlAttributeã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">AttributeUsage(AttributeTargets.Method)</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">NotTransactionalAttribute</span>:<span class="title">Attribute</span></span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åï¼Œå¼€å‘ç­›é€‰å™¨TransactionScopeFilter,å…¶OnActionExecutionAsyncæ–¹æ³•çš„å®ç°ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TransactionScopeFilt</span> : <span class="title">IAsyncActionFilter</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">OnActionExecutionAsync</span>(<span class="params">ActionExecutingContext context, ActionExecutionDelegate next</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">bool</span> hasNotTransactionalAttribute = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">if</span> (context.ActionDescriptor <span class="keyword">is</span> ControllerActionDescriptor)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> actionDesc = (ControllerActionDescriptor)context.ActionDescriptor;</span><br><span class="line">            hasNotTransactionalAttribute = actionDesc.MethodInfo.IsDefined(<span class="keyword">typeof</span>(NotTransactionalAttribute), <span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (hasNotTransactionalAttribute)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">await</span> next();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">using</span> <span class="keyword">var</span> txScope = <span class="keyword">new</span> TransactionScope(TransactionScopeAsyncFlowOption.Enabled);</span><br><span class="line">        <span class="keyword">var</span> result = <span class="keyword">await</span> next();</span><br><span class="line">        <span class="keyword">if</span> (result.Exception == <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            txScope.Complete();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é…ç½®Program.csç¨‹åºé›†</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">builder.Services.Configure&lt;MvcOptions&gt;(options =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    options.Filters.Add(<span class="keyword">typeof</span>(TransactionScopeFilt));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1 id="æ¡ˆä¾‹ï¼šå¼€å‘è¯·æ±‚é™æµå™¨"><a href="#æ¡ˆä¾‹ï¼šå¼€å‘è¯·æ±‚é™æµå™¨" class="headerlink" title="æ¡ˆä¾‹ï¼šå¼€å‘è¯·æ±‚é™æµå™¨"></a>æ¡ˆä¾‹ï¼šå¼€å‘è¯·æ±‚é™æµå™¨</h1><p>1.Action Filterå¯ä»¥åœ¨æ»¡è¶³æ¡ä»¶çš„æ—¶å€™ç»ˆæ­¢æ“ä½œæ–¹æ³•çš„æ‰§è¡Œã€‚<br>2.åœ¨Action Filterä¸­ï¼Œå¦‚æœæˆ‘ä»¬ä¸è°ƒç”¨await next(),å°±å¯ä»¥ç»ˆæ­¢Actionæ–¹æ³•çš„æ‰§è¡Œäº†ã€‚<br>3.ä¸ºäº†é¿å…è€Œå·²å®¢æˆ·ç«¯é¢‘ç¹å‘é€å¤§é‡è¯·æ±‚æ¶ˆè€—æœåŠ¡å™¨èµ„æºï¼Œæˆ‘ä»¬è¦å®ç°â€œä¸€ç§’é’Ÿå†…åªå…è®¸æœ€å¤šæœ‰ä¸€ä¸ªæ¥è‡ªåŒä¸€ä¸ªIPåœ°å€çš„è¯·æ±‚â€ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">RateLimitFilter</span> : <span class="title">IAsyncActionFilter</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> IMemoryCache memCache; <span class="comment">//æ³¨å…¥å†…å­˜ç¼“å­˜</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RateLimitFilter</span>(<span class="params">IMemoryCache memCache</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.memCache = memCache;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Task <span class="title">OnActionExecutionAsync</span>(<span class="params">ActionExecutingContext context, ActionExecutionDelegate next</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> removeIP = context.HttpContext.Connection.RemoteIpAddress.ToString(); <span class="comment">//è·å–è¯·æ±‚IP</span></span><br><span class="line">        <span class="built_in">string</span> cacheKey = <span class="string">$&quot;LastVisitTick_<span class="subst">&#123;removeIP&#125;</span>&quot;</span>; <span class="comment">//ç¼“å­˜é”®</span></span><br><span class="line">        <span class="built_in">long</span>? lastTick = memCache.Get&lt;<span class="built_in">long</span>?&gt;(cacheKey);  <span class="comment">//è·å–ä¸Šæ¬¡è¯·æ±‚æ—¶é—´</span></span><br><span class="line">        <span class="keyword">if</span> (lastTick == <span class="literal">null</span> || Environment.TickCount64 - lastTick &gt; <span class="number">1000</span>)  <span class="comment">//è¯·æ±‚é—´éš”å¤§äº1ç§’</span></span><br><span class="line">        &#123;</span><br><span class="line">            memCache.Set(cacheKey, Environment.TickCount64, TimeSpan.FromSeconds(<span class="number">10</span>));  <span class="comment">//è®¾ç½®ç¼“å­˜æ—¶é—´ä¸º10ç§’</span></span><br><span class="line">            <span class="keyword">return</span> next();  <span class="comment">//ç»§ç»­æ‰§è¡Œè¯·æ±‚</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">        &#123;</span><br><span class="line">            context.Result = <span class="keyword">new</span> ContentResult &#123; StatusCode = <span class="number">429</span>, Content = <span class="string">&quot;è¯·æ±‚è¿‡å¿«ï¼Œè¯·ç¨åå†è¯•&quot;</span> &#125;;  <span class="comment">//è¿”å›429çŠ¶æ€ç </span></span><br><span class="line">            <span class="keyword">return</span> Task.CompletedTask; <span class="comment">//ç»“æŸè¯·æ±‚</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ç”¨å†…å­˜ç¼“å­˜</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">builder.Services.Configure&lt;MvcOptions&gt;(options =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    options.Filters.Add(<span class="keyword">typeof</span>(RateLimitFilter));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1 id="ä¸­é—´ä»¶"><a href="#ä¸­é—´ä»¶" class="headerlink" title="ä¸­é—´ä»¶"></a>ä¸­é—´ä»¶</h1><p>ä¸­é—´ä»¶æ˜¯ASP.NET Coreçš„æ ¸å¿ƒç»„ä»¶ï¼ŒMVCæ¡†æ¶ã€ç›¸åº”ç¼“å­˜ã€èº«ä»½éªŒè¯ã€CORSã€Swaggerç­‰éƒ½æ˜¯å†…ç½®ä¸­é—´ä»¶ã€‚</p><p><img src="/img%5CWEBAPI%5C18.png"></p><h2 id="ä»€ä¹ˆæ˜¯ä¸­é—´ä»¶"><a href="#ä»€ä¹ˆæ˜¯ä¸­é—´ä»¶" class="headerlink" title="ä»€ä¹ˆæ˜¯ä¸­é—´ä»¶"></a>ä»€ä¹ˆæ˜¯ä¸­é—´ä»¶</h2><p>1.å¹¿ä¹‰ä¸Šæ¥è®²ï¼šTomcatã€WebLogicã€Redisã€ISSï¼›ç‹­ä¹‰ä¸Šæ¥è®²ï¼ŒASP.NET Coreä¸­çš„ä¸­é—´ä»¶æŒ‡ASP.ENT Coreä¸­çš„ä¸€ä¸ªç»„ä»¶ã€‚<br>2.ä¸­é—´ä»¶ç”±å‰é€»è¾‘ã€nextã€åé€»è¾‘3éƒ¨åˆ†ç»„æˆï¼Œå‰é€»è¾‘ä¸ºç¬¬ä¸€æ®µè¦æ‰§è¡Œçš„é€»è¾‘ä»£ç ã€nextä¸ºæŒ‡å‘ä¸‹ä¸€ä¸ªä¸­é—´ä»¶çš„è°ƒç”¨ã€åé€»è¾‘ä¸ºä»ä¸‹ä¸€ä¸ªä¸­é—´ä»¶æ‰§è¡Œè¿”å›æ‰€æ‰§è¡Œçš„é€»è¾‘ä»£ç ã€‚æ¯ä¸ªHTTPè¯·æ±‚éƒ½è¦ç»å†ä¸€ä¸ªç³»åˆ—ä¸­é—´ä»¶çš„å¤„ç†ï¼Œæ¯ä¸ªä¸­é—´ä»¶å¯¹äºè¯·æ±‚è¿›è¡Œç‰¹å®šçš„å¤„ç†åï¼Œå†è½¬åˆ°ä¸‹ä¸€ä¸ªä¸­é—´ä»¶ï¼Œæœ€ç»ˆçš„ä¸šåŠ¡é€»è¾‘ä»£ç æ‰§è¡Œå®Œæˆåï¼Œç›¸åº”çš„å†…å®¹ä¹Ÿä¼šæŒ‰ç…§å¤„ç†çš„ç›¸åé¡ºåºè¿›è¡Œå¤„ç†ï¼Œç„¶åå½¢æˆHTTPå“åº”æŠ¥æ–‡è¿”å›ç»™å®¢æˆ·ç«¯ã€‚<br>3.ä¸­é—´ä»¶ç»„æˆä¸€ä¸ªç®¡é“ï¼Œæ•´ä¸ªASP.ENT Coreçš„æ‰§è¡Œè¿‡ç¨‹å°±æ˜¯HTTPè¯·æ±‚å’Œç›¸åº”æŒ‰ç…§ä¸­é—´ä»¶ç»„è£…çš„é¡ºåºåœ¨ä¸­é—´ä»¶ä¹‹é—´æµè½¬çš„è¿‡ç¨‹ã€‚å¼€å‘äººå‘˜å¯ä»¥å¯¹ç»„æˆç®¡é“çš„ä¸­é—´ä»¶æŒ‰ç…§éœ€è¦è¿›è¡Œè‡ªç”±ç»„åˆã€‚</p><h3 id="ä¸­é—´ä»¶çš„ä¸‰ä¸ªæ¦‚å¿µ"><a href="#ä¸­é—´ä»¶çš„ä¸‰ä¸ªæ¦‚å¿µ" class="headerlink" title="ä¸­é—´ä»¶çš„ä¸‰ä¸ªæ¦‚å¿µ"></a>ä¸­é—´ä»¶çš„ä¸‰ä¸ªæ¦‚å¿µ</h3><p>Mapã€Useå’ŒRunã€‚Mapç”¨æ¥å®šä¹‰ä¸€ä¸ªç®¡é“å¯ä»¥å¤„ç†é‚£äº›è¯·æ±‚ï¼ŒUseå’ŒRunç”¨æ¥å®šä¹‰ç®¡é“ï¼Œä¸€ä¸ªç®¡é“ç”±è‹¥å¹²ä¸ªUseå’Œä¸€ä¸ªRunç»„æˆï¼Œæ¯ä¸ªUseå¼•å…¥ä¸€ä¸ªä¸­é—´ä»¶ï¼Œè€ŒRunæ˜¯ç”¨æ¥æ‰§è¡Œæœ€ç»ˆçš„æ ¸å¿ƒåº”ç”¨é€»è¾‘ã€‚</p><p><img src="/img%5CWEBAPI%5C19.png"></p><h2 id="åŸºæœ¬ä¸­é—´ä»¶ä½¿ç”¨"><a href="#åŸºæœ¬ä¸­é—´ä»¶ä½¿ç”¨" class="headerlink" title="åŸºæœ¬ä¸­é—´ä»¶ä½¿ç”¨"></a>åŸºæœ¬ä¸­é—´ä»¶ä½¿ç”¨</h2><p>åˆ›å»ºä¸€ä¸ªASP.NET Coreç©ºé¡¹ç›®ã€‚</p><p>ç®€å•çš„è‡ªå®šä¹‰ä¸­é—´ä»¶<br>ä¸ºäº†èƒ½å¤Ÿæ›´æ¸…æ™°åœ°äº†è§£ä¸­é—´ä»¶ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç©ºçš„ASP.NET Coreé¡¹ç›®ï¼Œç„¶åæ‰‹åŠ¨æ·»åŠ ä¸­é—´ä»¶ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">app.Map(<span class="string">&quot;/test&quot;</span>, <span class="keyword">async</span> (pipeBuilder) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    pipeBuilder.Use(<span class="keyword">async</span> (context, next) =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        context.Response.ContentType = <span class="string">&quot;text/html&quot;</span>;</span><br><span class="line">        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;1 start&lt;br/&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">await</span> next.Invoke();</span><br><span class="line">        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;1 end&lt;br/&gt;&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    pipeBuilder.Use(<span class="keyword">async</span> (context, next) =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;2 start&lt;br/&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">await</span> next.Invoke();</span><br><span class="line">        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;2 end&lt;br/&gt;&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    pipeBuilder.Run(<span class="keyword">async</span> context =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;Run&lt;br/&gt;&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒæŒ‰ç…§å¾®è½¯çš„å»ºè®®ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ä¸€ä¸ªä¸­é—´ä»¶ä¸­ä½¿ç”¨ctx.Response.WriteAsyncç­‰æ–¹å¼å‘å®¢æˆ·ç«¯å‘é€å“åº”ï¼Œæˆ‘ä»¬å°±ä¸èƒ½å†æ‰§è¡Œnext.InvokeæŠŠè¯·æ±‚è½¬åˆ°å…¶ä»–ä¸­é—´ä»¶äº†ã€‚å› ä¸ºå…¶ä»–ä¸­é—´ä»¶æœ‰å¯èƒ½å¯¹Responseè¿›è¡Œäº†æ›´æ”¹ï¼Œæ¯”å¦‚ä¿®æ”¹å“åº”çŠ¶æ€ç ã€ä¿®æ”¹æŠ¥æ–‡å¤´æˆ–è€…å‘å“åº”æŠ¥æ–‡ä¸­å†™å…¥å…¶ä»–æ•°æ®ï¼Œè¿™æ ·å°±ä¼šé€ æˆå“åº”æŠ¥æ–‡ä½“è¢«æŸåçš„é—®é¢˜ã€‚å› æ­¤ï¼Œåœ¨ä»£ç ä¸­çš„ä¸­é—´ä»¶ä¸­ï¼Œæˆ‘ä»¬åœ¨å‘æŠ¥æ–‡ä½“ä¸­å†™å…¥å†…å®¹åï¼Œåˆæ‰§è¡Œnext.Invokeæ˜¯ä¸æ¨èçš„è¡Œä¸ºã€‚</p><h3 id="ä¸­é—´ä»¶ç±»"><a href="#ä¸­é—´ä»¶ç±»" class="headerlink" title="ä¸­é—´ä»¶ç±»"></a>ä¸­é—´ä»¶ç±»</h3><p>1.å¦‚æœå®šä¹‰ä¸­é—´ä»¶çš„ä»£ç æ¯”è¾ƒå¤æ‚ï¼Œæˆ–è€…éœ€è¦é‡å¤ä½¿ç”¨ä¸€ä¸ªä¸­é—´ä»¶çš„è¯ï¼Œæœ€å¥½æŠŠä¸­é—´çš„ä»£ç æ”¾åˆ°ä¸€ä¸ªå•ç‹¬çš„ç±»ä¸­ï¼Œè¿™æ ·çš„ç±»æˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œä¸­é—´ä»¶ç±»â€ã€‚<br>2.ä¸­é—´ä»¶ç±»æ˜¯ä¸€ä¸ªæ™®é€šçš„.NETç±»ï¼Œå®ƒä¸éœ€è¦ç»§æ‰¿ä»»ä½•çˆ¶ç±»æˆ–è€…å®ç°ä»»ä½•æ¥å£ï¼Œä½†æ˜¯è¿™ä¸ªç±»éœ€è¦æœ‰ä¸€ä¸ªæ„é€ æ–¹æ³•ï¼Œæ„é€ æ–¹æ³•è‡³å°‘æœ‰ä¸€ä¸ªRequertDelegateç±»å‹çš„å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°ç”¨æ¥æŒ‡å‘ä¸‹ä¸€ä¸ªä¸­é—´ä»¶ã€‚è¿™ä¸ªç±»è¿˜éœ€è¦å®šä¹‰ä¸€ä¸ªåå­—ä¸ºInvokeæˆ–InvokeAsyncçš„æ–¹æ³•ï¼Œæ–¹æ³•è‡³å°‘æœ‰ä¸€ä¸ªHttpContextç±»å‹çš„å‚æ•°ï¼Œæ–¹æ³•çš„è¿”å›å€¼å¿…é¡»æ˜¯Taskç±»å‹ã€‚ä¸­é—´ä»¶ç±»çš„æ„é€ æ–¹æ³•å’ŒInvokeï¼ˆæˆ–InvokeAsyncï¼‰æ–¹æ³•è¿˜å¯ä»¥å®šä¹‰å…¶ä»–å‚æ•°ï¼Œå…¶ä»–å‚æ•°çš„å€¼ä¼šé€šè¿‡ä¾èµ–æ³¨å…¥è‡ªåŠ¨èµ‹å€¼ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TestIMddleware</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> RequestDelegate next;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TestIMddleware</span>(<span class="params">RequestDelegate next</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.next = next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">InvokeAsync</span>(<span class="params">HttpContext context</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;TestIMddleware start&lt;br/&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">await</span> next.Invoke(context);</span><br><span class="line">        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;TestIMddleware end&lt;br/&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¼€å‘ä¸€ä¸ªç®€å•çš„ä¸­é—´ä»¶ç±»ï¼Œè¿™ä¸ªä¸­é—´ä»¶ç±»ä¼šæ£€æŸ¥è¯·æ±‚ä¸­æ˜¯å¦æœ‰passwordä¸º123çš„æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œè€Œä¸”ä¼šæŠŠè¯·æ±‚æŠ¥æ–‡ä½“æŒ‰ç…§JSONæ ¼å¼å°è¯•è§£æä¸ºdynamicç±»å‹çš„å¯¹è±¡ï¼Œå¹¶ä¸”æŠŠpynamicå¯¹è±¡æ”¾å…¥context.Itemsä¸­ä¾›åç»­çš„ä¸­é—´ä»¶æˆ–è€…Runä½¿ç”¨ã€‚</p><p>JsonSerializer.Deserialize&lt;dynamic&gt;<br>æŠŠjsonååºåˆ—åŒ–ä¸ºdynamicç±»å‹</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">CheckMiddleware</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> RequestDelegate next;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CheckMiddleware</span>(<span class="params">RequestDelegate next</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.next = next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">InvokeAsync</span>(<span class="params">HttpContext context</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> pwd = context.Request.Query[<span class="string">&quot;passwork&quot;</span>];</span><br><span class="line">        <span class="keyword">if</span> (pwd == <span class="string">&quot;123&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (context.Request.HasJsonContentType())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">var</span> reqStream = context.Request.BodyReader.AsStream();</span><br><span class="line">                <span class="keyword">var</span> obj = JsonSerializer.Deserialize&lt;<span class="built_in">dynamic</span>&gt;(reqStream);</span><br><span class="line">                context.Items[<span class="string">&quot;BodyJson&quot;</span>] = obj;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">await</span> next(context);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            context.Response.StatusCode = <span class="number">401</span>;</span><br><span class="line">            <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;æ²¡æœ‰æƒé™è®¿é—®&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä¸­é—´ä»¶ç±»CheckAndParsingMiddleware,ä¿®æ”¹åçš„Program.cs</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">app.Map(<span class="string">&quot;/test&quot;</span>, <span class="keyword">async</span> (pipeBuilder) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    pipeBuilder.Use(<span class="keyword">async</span> (context, next) =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        context.Response.ContentType = <span class="string">&quot;text/html&quot;</span>;</span><br><span class="line">        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;1 start&lt;br/&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">await</span> next.Invoke();</span><br><span class="line">        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;1 end&lt;br/&gt;&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    pipeBuilder.Use(<span class="keyword">async</span> (context, next) =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;2 start&lt;br/&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">await</span> next.Invoke();</span><br><span class="line">        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;2 end&lt;br/&gt;&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    pipeBuilder.UseMiddleware&lt;TestIMddleware&gt;();</span><br><span class="line">    pipeBuilder.Run(<span class="keyword">async</span> context =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;Run&lt;br/&gt;&quot;</span>);</span><br><span class="line">        <span class="built_in">dynamic</span> obj = context.Items[<span class="string">&quot;BodyJson&quot;</span>];</span><br><span class="line">        <span class="keyword">if</span>(obj != <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">$&quot;BodyJson: <span class="subst">&#123;obj&#125;</span>&lt;br/&gt;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    pipeBuilder.Run(<span class="keyword">async</span> context =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">await</span> context.Response.WriteAsync(<span class="string">&quot;Run&lt;br/&gt;&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><img src="/img%5CWEBAPI%5C20.png"></p><h1 id="Filterï¼ˆç­›é€‰å™¨ï¼‰å’ŒMiddilewareï¼ˆä¸­é—´ä»¶ï¼‰çš„åŒºåˆ«"><a href="#Filterï¼ˆç­›é€‰å™¨ï¼‰å’ŒMiddilewareï¼ˆä¸­é—´ä»¶ï¼‰çš„åŒºåˆ«" class="headerlink" title="Filterï¼ˆç­›é€‰å™¨ï¼‰å’ŒMiddilewareï¼ˆä¸­é—´ä»¶ï¼‰çš„åŒºåˆ«"></a>Filterï¼ˆç­›é€‰å™¨ï¼‰å’ŒMiddilewareï¼ˆä¸­é—´ä»¶ï¼‰çš„åŒºåˆ«</h1><p>ä¸­é—´ä»¶æ˜¯ASP.NET Coreè¿™ä¸ªåŸºç¡€æä¾›çš„åŠŸèƒ½ï¼Œè€ŒFilteræ˜¯ASP.NET Core WVCä¸­æä¾›çš„åŠŸèƒ½ã€‚ASP.NET Core MVCæ˜¯ç”±MVCä¸­é—´ä»¶æä¾›çš„æ¡†æ¶ï¼Œè€ŒFilterå±äºMVCä¸­é—´ä»¶æä¾›çš„åŠŸèƒ½ã€‚</p><p><img src="/img%5CWEBAPI%5C21.png"></p><p>åŒºåˆ«</p><ol><li>ä¸­é—´ä»¶å¯ä»¥å¤„ç†æ‰€æœ‰çš„è¯·æ±‚ï¼Œè€ŒFilteråªèƒ½å¤„ç†å¯¹æ§åˆ¶å™¨çš„è¯·æ±‚ï¼›ä¸­é—´ä»¶è¿è¡Œåœ¨ä¸€ä¸ªæ›´åº•å±‚ã€æ›´æŠ½è±¡çš„çº§åˆ«ï¼Œå› æ­¤åœ¨ä¸­é—´ä»¶ä¸­æ— æ³•å¤„ç†MVCä¸­é—´ä»¶ç‰¹æœ‰çš„æ¦‚å¿µã€‚</li><li>ä¸­é—´ä»¶å’ŒFilterå¯ä»¥å®Œæˆå¾ˆå¤šç›¸ä¼¼çš„åŠŸèƒ½ã€‚â€œæœªå¤„ç†å¼‚å¸¸ä¸­é—´ä»¶â€å’Œâ€œæœªå¤„ç†å¼‚å¸¸Filterâ€;â€œè¯·æ±‚é™æµä¸­é—´ä»¶â€å’Œâ€œè¯·æ±‚é™æµFilterâ€çš„åŒºåˆ«ã€‚</li><li>ä¼˜å…ˆé€‰æ‹©ä½¿ç”¨ä¸­é—´ä»¶ï¼›ä½†æ˜¯å¦‚æœè¿™ä¸ªç»„ä»¶åªé’ˆå¯¹MVCæˆ–è€…éœ€è¦è°ƒç”¨ä¸€äº›MVCç›¸å…³çš„ç±»çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±åªèƒ½é€‰æ‹©Filterã€‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ASP.NET Core </tag>
            
            <tag> Entity Framework Core </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é…ç½®ç³»ç»Ÿä¸ASP.NET Core</title>
      <link href="/2025/04/21/asp.net%20core/%E9%85%8D%E7%BD%AE%E7%B3%BB%E7%BB%9F%E4%B8%8EASP.NET%20Core%E7%9A%84%E9%9B%86%E7%BE%A4/"/>
      <url>/2025/04/21/asp.net%20core/%E9%85%8D%E7%BD%AE%E7%B3%BB%E7%BB%9F%E4%B8%8EASP.NET%20Core%E7%9A%84%E9%9B%86%E7%BE%A4/</url>
      
        <content type="html"><![CDATA[<h1 id="é…ç½®ç³»ç»Ÿä¸ASP-NET-Core"><a href="#é…ç½®ç³»ç»Ÿä¸ASP-NET-Core" class="headerlink" title="é…ç½®ç³»ç»Ÿä¸ASP.NET Core"></a>é…ç½®ç³»ç»Ÿä¸ASP.NET Core</h1><h3 id="é»˜è®¤æ·»åŠ çš„é…ç½®æä¾›è€…"><a href="#é»˜è®¤æ·»åŠ çš„é…ç½®æä¾›è€…" class="headerlink" title="é»˜è®¤æ·»åŠ çš„é…ç½®æä¾›è€…"></a>é»˜è®¤æ·»åŠ çš„é…ç½®æä¾›è€…</h3><p>1.åŠ è½½ç°æœ‰çš„IConfigurationã€‚<br>2.åŠ è½½é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„appsettings.jsonã€‚<br>3.åŠ è½½é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„appsettings.{Environment}.jsonã€‚<br>4.å½“ç¨‹åºè¿è¡Œåœ¨å¼€å‘ç¯å¢ƒä¸‹ï¼Œç¨‹åºä¼šåŠ è½½â€œç”¨æˆ·æœºå¯†â€é…ç½®ã€‚<br>5.åŠ è½½ç¯å¢ƒå˜é‡ä¸­çš„é…ç½®ã€‚<br>6.åŠ è½½å‘½ä»¤è¡Œä¸­çš„é…ç½®ã€‚</p><h3 id="é…ç½®çš„ç¯å¢ƒé—®é¢˜"><a href="#é…ç½®çš„ç¯å¢ƒé—®é¢˜" class="headerlink" title="é…ç½®çš„ç¯å¢ƒé—®é¢˜"></a>é…ç½®çš„ç¯å¢ƒé—®é¢˜</h3><p>1.å¼€å‘ç¯å¢ƒã€æµ‹è¯•ç¯å¢ƒã€ç”Ÿäº§ç¯å¢ƒéœ€è¦è¿›è¡Œä¸åŒé…ç½®ã€‚<br>2.è¿è¡Œç¯å¢ƒï¼šASP.NET Coreä¼šä»ç¯å¢ƒå˜é‡ä¸­è¯»å–åå­—ä¸ºASPNETCORE_ENVIRONMENTçš„å€¼ã€‚æ¨èå€¼ï¼šDevelopmentï¼ˆå¼€å‘ç¯å¢ƒï¼‰ã€Staginï¼ˆæµ‹è¯•ç¯å¢ƒï¼‰ã€Productionï¼ˆå¼€å‘ç¯å¢ƒï¼‰ã€‚<br>3.è¯»å–æ–¹æ³•ï¼šapp.Environment.EnvironmentNameã€app.Environment.IsDvelopment()â€¦<br>4.åœ¨Windowså’ŒVSï¼ˆæ¨èå¼€å‘æ—¶ç”¨ï¼‰ä¸­è®¾ç½®ç¯å¢ƒå˜é‡çš„æ–¹æ³•ã€‚</p><p>åœ¨Program.csä¸­è®¾ç½®</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Console.WriteLine(app.Environment.EnvironmentName);</span><br><span class="line">Console.WriteLine(app.Environment.IsDevelopment());</span><br><span class="line">Console.WriteLine(app.Environment.IsProduction());</span><br></pre></td></tr></table></figure><p>åœ¨Controllersä¸­è®¾ç½®</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TestController</span> : <span class="title">ControllerBase</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> IWebHostEnvironment webhost;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TestController</span>(<span class="params">IWebHostEnvironment webhost</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.webhost = webhost;</span><br><span class="line">    &#125;</span><br><span class="line">    [<span class="meta">HttpGet</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">Get</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> webhost.EnvironmentName;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="NET-Coreé˜²æ­¢æœºå¯†é…ç½®å¤–æ³„"><a href="#NET-Coreé˜²æ­¢æœºå¯†é…ç½®å¤–æ³„" class="headerlink" title=".NET Coreé˜²æ­¢æœºå¯†é…ç½®å¤–æ³„"></a>.NET Coreé˜²æ­¢æœºå¯†é…ç½®å¤–æ³„</h1><h2 id="ç”¨â€œç”¨æˆ·æœºå¯†â€æ¥é¿å…æœºå¯†ä¿¡æ¯çš„æ³„éœ²"><a href="#ç”¨â€œç”¨æˆ·æœºå¯†â€æ¥é¿å…æœºå¯†ä¿¡æ¯çš„æ³„éœ²" class="headerlink" title="ç”¨â€œç”¨æˆ·æœºå¯†â€æ¥é¿å…æœºå¯†ä¿¡æ¯çš„æ³„éœ²"></a>ç”¨â€œç”¨æˆ·æœºå¯†â€æ¥é¿å…æœºå¯†ä¿¡æ¯çš„æ³„éœ²</h2><p>1.æŠŠä¸æ–¹ä¾¿æ”¾åˆ°appsettings.jsonä¸­çš„æœºå¯†ä¿¡æ¯æ”¾åˆ°ä¸€ä¸ªä¸åœ¨é¡¹ç›®ä¸­çš„jsonæ–‡ä»¶ä¸­ã€‚<br>2.åœ¨ASP.NET Coreé¡¹ç›®ä¸Šå•å‡»é¼ æ ‡å³é”®ï¼Œé€‰æ‹©ã€ç®¡ç†ç”¨æˆ·æœºå¯†ã€‘ã€‚<br>3.secrets.jsonæ–‡ä»¶åˆ°åº•ä¿å­˜åœ¨å“ªé‡Œï¼Ÿå¦‚ä½•å’Œé¡¹ç›®å»ºç«‹å…³ç³»ï¼Ÿcsprojæ–‡ä»¶ä¸­çš„&lt;UserSecretsld&gt;</p><p>è¿™ä¸ªèŠ‚ç‚¹çš„å€¼å°±æ˜¯ä¸€ä¸ªç”¨æ¥å®šä½ç”¨æˆ·æœºå¯†é…ç½®çš„æ ‡è¯†ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;PropertyGroup&gt;</span><br><span class="line">  &lt;TargetFramework&gt;net8<span class="number">.0</span>&lt;/TargetFramework&gt;</span><br><span class="line">  &lt;Nullable&gt;enable&lt;/Nullable&gt;</span><br><span class="line">  &lt;ImplicitUsings&gt;enable&lt;/ImplicitUsings&gt;</span><br><span class="line">  &lt;UserSecretsId&gt;e049b89f<span class="number">-2772</span><span class="number">-408</span>a<span class="number">-9073</span><span class="number">-938f</span>00afc514&lt;/UserSecretsId&gt;</span><br><span class="line">&lt;/PropertyGroup&gt;</span><br></pre></td></tr></table></figure><p>è¯»å–é…ç½®</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> name= app.Configuration.GetSection(<span class="string">&quot;name&quot;</span>).Value;</span><br><span class="line">Console.WriteLine(name);</span><br></pre></td></tr></table></figure><h3 id="åœ¨ä½¿ç”¨ç”¨æˆ·æœºå¯†çš„æ—¶å€™æœ‰å¦‚ä¸‹å‡ ç‚¹éœ€è¦æ³¨æ„"><a href="#åœ¨ä½¿ç”¨ç”¨æˆ·æœºå¯†çš„æ—¶å€™æœ‰å¦‚ä¸‹å‡ ç‚¹éœ€è¦æ³¨æ„" class="headerlink" title="åœ¨ä½¿ç”¨ç”¨æˆ·æœºå¯†çš„æ—¶å€™æœ‰å¦‚ä¸‹å‡ ç‚¹éœ€è¦æ³¨æ„"></a>åœ¨ä½¿ç”¨ç”¨æˆ·æœºå¯†çš„æ—¶å€™æœ‰å¦‚ä¸‹å‡ ç‚¹éœ€è¦æ³¨æ„</h3><p>1.ç”¨æˆ·æœºå¯†æœºåˆ¶æ˜¯ä¾›å¼€å‘äººå‘˜ä½¿ç”¨çš„ï¼Œå› æ­¤ä¸é€‚åˆåœ¨ç”Ÿæˆç¯å¢ƒä¸­ä½¿ç”¨ã€‚<br>2.secrets.jsonä¸­çš„é…ç½®ä»»ç„¶æ˜¯æ˜æ–‡å­˜å‚¨çš„ï¼Œå¹¶æ²¡æœ‰åŠ å¯†ã€‚å¦‚æœæƒ³é¿å…è¿æ¥å­—ç¬¦ä¸²ç­‰æœºå¯†é…ç½®è¢«åˆ«äººçœ‹åˆ°ï¼Œå¯ä»¥é‡‡ç”¨Azure Key Vaultç­‰é…ç½®æœåŠ¡å™¨ã€‚ä½†æ˜¯æ— è®ºä»€ä¹ˆé…ç½®æœåŠ¡å™¨ï¼Œåªè¦ç¨‹åºèƒ½è¯»å–è¿™äº›é…ç½®ï¼Œé‡‡ç”¨ä»»ä½•é…ç½®æœåŠ¡å™¨çš„â€œè¿æ¥å­—ç¬¦ä¸²åŠ å¯†â€åªèƒ½å¢åŠ æœºå¯†ä¿¡æ¯è¢«å‘ç°çš„éš¾åº¦ï¼Œä¸èƒ½å½»åº•æœç»æœºå¯†ä¿¡æ¯è¢«å‘ç°ã€‚<br>3.å¦‚æœå› ä¸ºé‡è£…ã€å°±éœ€è¦é‡æ–°é…ç½®ï¼Œéº»çƒ¦ã€‚å¦‚æœå½±å“å¤§çš„è¯ï¼Œè¿˜æ˜¯ç”¨é›†ä¸­å¼é…ç½®æœåŠ¡å™¨ã€‚</p><h1 id="é…ç½®ç³»ç»Ÿç»¼åˆ"><a href="#é…ç½®ç³»ç»Ÿç»¼åˆ" class="headerlink" title="é…ç½®ç³»ç»Ÿç»¼åˆ"></a>é…ç½®ç³»ç»Ÿç»¼åˆ</h1><h3 id="åŠŸèƒ½éœ€æ±‚"><a href="#åŠŸèƒ½éœ€æ±‚" class="headerlink" title="åŠŸèƒ½éœ€æ±‚"></a>åŠŸèƒ½éœ€æ±‚</h3><p>1.ç³»ç»Ÿçš„ä¸»è¦é…ç½®ï¼ˆRedisã€Smtpï¼‰æ”¾åˆ°é…ç½®ä¸“ç”¨çš„æ•°æ®åº“ä¸­ã€‚<br>2.è¿æ¥é…ç½®æ•°æ®åº“çš„è¿æ¥å­—ç¬¦ä¸²é…ç½®åœ¨â€œç”¨æˆ·æœºå¯†â€ä¸­ã€‚<br>3.æŠŠSmtpçš„é…ç½®æ˜¾ç¤ºåˆ°ç•Œé¢ä¸Šã€‚<br>4.ç¨‹åºå¯åŠ¨çš„æ—¶å€™å°±è¿æ¥Redis,å¹¶ä¸”æŠŠRedisè¿æ¥å¯¹è±¡æ³¨å†Œåˆ°ä¾èµ–æ³¨å…¥ç³»ç»Ÿä¸­ã€‚</p><p>ç¬¬ä¸€æ­¥ï¼šåœ¨SQL Serveræ•°æ®åº“ä¸­åˆ›å»ºä¸€å¼ ä¿å­˜é…ç½®ä¿¡æ¯çš„æ•°æ®åº“è¡¨T_Configs,è¡¨åŒ…å«Idã€Nameã€Valueè¿™3åˆ—ï¼ŒIdåˆ—å®šä¹‰ä¸ºæ•´æ•°ç±»å‹çš„æ ‡è¯†åˆ—ï¼ŒNameåˆ—å’ŒValueåˆ—éƒ½å®šä¹‰ä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼ŒNameåˆ—ä¸ºé…ç½®é¡¹çš„åå­—ï¼ŒValueåˆ—ä¸ºé…ç½®é¡¹çš„å€¼ã€‚</p><p>ç¬¬äºŒæ­¥ï¼šåœ¨T_Configsè¡¨ä¸­å¢åŠ ä¸¤è¡Œæ•°æ®ã€‚<br><img src="/img%5CWEBAPI%5C12.png"></p><p>ç¬¬ä¸‰æ­¥ï¼šåœ¨é¡¹ç›®ä¸­åˆ›å»ºä¸€ä¸ªSmtpOptionsç±»ç”¨æ¥ç»‘å®šSmtpçš„é…ç½®å€¼ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">SmtpOptions</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Host &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; = <span class="built_in">string</span>.Empty;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> UserName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; = <span class="built_in">string</span>.Empty;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Password &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; = <span class="built_in">string</span>.Empty;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬å››æ­¥ï¼šé€šè¿‡NuGetå®‰è£…ä»æ•°æ®åº“ä¸­è¯»å–é…ç½®çš„Zack.AnyDBConfigProvider,ä»¥åŠè¿æ¥Redisçš„Stack Exchange.Redisã€‚</p><p>ç¬¬äº”æ­¥ï¼šåœ¨é¡¹ç›®ä¸Šå³å‡»ï¼Œé€‰æ‹©ã€ç®¡ç†ç”¨æˆ·æœºå¯†ã€‘ã€‚é…ç½®secrets.jsonã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;ConnectionStrings&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;configServer&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Data Source=.;Initial Catalog=demo1;Integrated Security=SSPI;&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>ç¬¬å…­æ­¥ï¼šç¼–å†™ä»£ç è¿›è¡Œé…ç½®ç³»ç»Ÿçš„åˆå§‹åŒ–ã€‚åœ¨Program.csæ–‡ä»¶çš„WebApplication.CreateBuilder(args)çš„ä¸‹é¢æ·»åŠ ã€‚</p><p>å®‰è£…NuGetåŒ…StackExchange.Redis</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">builder.Host.ConfigureAppConfiguration((_, configBuilder) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> connStr=builder.Configuration.GetConnectionString(<span class="string">&quot;ConnectionStrings&quot;</span>);</span><br><span class="line">    configBuilder.AddDbConfiguration(() =&gt; <span class="keyword">new</span> SqlConnection(connStr),reloadOnChange:<span class="literal">true</span>,reloadInterval:TimeSpan.FromSeconds(<span class="number">2</span>));</span><br><span class="line">&#125;);</span><br><span class="line">builder.Services.Configure&lt;SmtpOptions&gt;(builder.Configuration.GetSection(<span class="string">&quot;Smtp&quot;</span>));</span><br><span class="line">builder.Services.AddSingleton&lt;IConnectionMultiplexer&gt;(sp =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> connStr = builder.Configuration.GetValue&lt;<span class="built_in">string</span>&gt;(<span class="string">&quot;Redis:ConnStr&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> ConnectionMultiplexer.Connect(connStr);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸ƒæ­¥ï¼šåœ¨æ§åˆ¶å™¨ä¸­é€šè¿‡æ„é€ æ–¹æ³•æ³¨å…¥è·å–SmtpOptionså’ŒRedisè¿æ¥å¯¹è±¡ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">builder.Host.ConfigureAppConfiguration((_, configBuilder) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> connStr = builder.Configuration.GetConnectionString(<span class="string">&quot;configServer&quot;</span>);</span><br><span class="line">    configBuilder.AddDbConfiguration(() =&gt; <span class="keyword">new</span> SqlConnection(connStr), reloadOnChange: <span class="literal">true</span>, reloadInterval: TimeSpan.FromSeconds(<span class="number">2</span>));</span><br><span class="line">&#125;);</span><br><span class="line">builder.Services.AddSingleton&lt;IConnectionMultiplexer&gt;(sp =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> connStr = builder.Configuration.GetSection(<span class="string">&quot;Redis&quot;</span>).Value;</span><br><span class="line">    <span class="keyword">return</span> ConnectionMultiplexer.Connect(connStr);</span><br><span class="line">&#125;);</span><br><span class="line">builder.Services.Configure&lt;SmtpOptions&gt;(builder.Configuration.GetSection(<span class="string">&quot;Smtp&quot;</span>));</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/img%5CWEBAPI%5C13.png"></p><h1 id="EF-Coreä¸ASP-NET-Coreçš„é›†æˆ"><a href="#EF-Coreä¸ASP-NET-Coreçš„é›†æˆ" class="headerlink" title="EF Coreä¸ASP.NET Coreçš„é›†æˆ"></a>EF Coreä¸ASP.NET Coreçš„é›†æˆ</h1><p>EF Coreå¯ä»¥ç”¨äºæ‰€æœ‰.NET Coreå¹³å°ä¸‹çš„ç¨‹åºï¼ŒASP.NET Coreä¹Ÿä¸ä¾‹å¤–ã€‚åœ¨ASP.NET Coreä¸­ä½¿ç”¨EF Coreçš„æ—¶å€™è¿˜æœ‰ä¸€äº›éœ€è¦é¢å¤–æ³¨æ„çš„é—®é¢˜ã€‚</p><h3 id="åˆ†å±‚é¡¹ç›®ä¸­EF-Coreçš„ç”¨æ³•"><a href="#åˆ†å±‚é¡¹ç›®ä¸­EF-Coreçš„ç”¨æ³•" class="headerlink" title="åˆ†å±‚é¡¹ç›®ä¸­EF Coreçš„ç”¨æ³•"></a>åˆ†å±‚é¡¹ç›®ä¸­EF Coreçš„ç”¨æ³•</h3><p>åœ¨ç¼–å†™ç®€å•çš„æ¼”ç¤ºæ¡ˆä¾‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šæŠŠé¡¹ç›®çš„æ‰€æœ‰ä»£ç æ”¾åœ¨åŒä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œè€Œå¯¹äºç°å®ä¸­æ¯”è¾ƒå¤æ‚çš„é¡¹ç›®ï¼Œæˆ‘ä»¬é€šå¸¸æ˜¯è¦  å…¶è¿›è¡Œåˆ†å±‚çš„ï¼Œä¹Ÿå°±æ˜¯ä¸åŒçš„ç±»æ”¾åˆ°ä¸åŒçš„æ–‡ä»¶å¤¹ä¸­ã€‚è¿™æ ·çš„åˆ†å±‚é¡¹ç›®ä¸­ä½¿ç”¨EF Coreçš„æ—¶å€™æœ‰ä¸€äº›é—®é¢˜éœ€è¦è€ƒè™‘ã€‚</p><p>1.åˆ›å»ºä¸€ä¸ª.NETç±»åº“é¡¹ç›®ï¼Œé¡¹ç›®åå­—ä¸ºBooksEFCoreã€‚<br>NuGetï¼šMicrosoft.EntityFrameworkCore.Relational<br>å¹¶ä¸”åœ¨é¡¹ç›®ä¸­å¢åŠ ä»£è¡¨å›¾ä¹¦çš„å®ä½“ç±»Bookå’Œå®ƒçš„å®ä½“ç±»çš„é…ç½®ç±»BookConfig.</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Book</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Title &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> AuthorName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> Price &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> DateTime PuDate &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">BookConfig</span> : <span class="title">IEntityTypeConfiguration</span>&lt;<span class="title">Book</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">EntityTypeBuilder&lt;Book&gt; builder</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        builder.ToTable(<span class="string">&quot;T_Book&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œï¼Œè¿™é‡ŒæŠŠBookç±»å£°æ˜ä¸ºä¸€ä¸ªè®°å½•ç±»ï¼Œè€Œä¸æ˜¯æ™®é€šçš„ç±»ï¼Œä¸»è¦æ˜¯ä¸ºäº†è®©ç¼–è¯‘å™¨è‡ªåŠ¨ç”ŸæˆToStringæ–¹æ³•ï¼Œå¸®æˆ‘ä»¬ç®€åŒ–å¯¹è±¡çš„è¾“å‡ºã€‚</p><p>2.åœ¨BookEFCoreé¡¹ç›®ä¸­å¢åŠ ä¸Šä¸‹æ–‡ç±»ã€‚</p><p>æ•°æ®åº“çš„é…ç½®1</p><p>1.ä¸Šä¸‹æ–‡ç±»MyDbContextï¼šä¸ºä»€ä¹ˆæ­£å¼é¡¹ç›®ä¸­æœ€å¥½åˆ«ä¸è¦åœ¨MyDbContextå†™æ•°æ®åº“é…ç½®ï¼ˆè¿æ¥ä¸åŒçš„DBç”šè‡³ä¸åŒç±»å‹çš„DBï¼‰ã€‚å°½é‡æ•°æ®åº“é…ç½®çš„ä»£ç å†™åˆ°ASP.NET Coreé¡¹ç›®ä¸­ã€‚ä¸é‡å¤OnConfiguringæ–¹æ³•ï¼Œè€Œæ˜¯ä¸ºMyDbContextç±»çš„æ„é€ æ–¹æ³•å¢åŠ DbContextOptions&lt;MyDbContext&gt;å‚æ•°ã€‚åœ¨ASP.NET Coreé¡¹ç›®å¯¹DbContextOptionsçš„é…ç½®ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">MyDbContext</span> : <span class="title">DbContext</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DbSet</span>&lt;<span class="title">Book</span>&gt; Books</span> &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyDbContext</span>(<span class="params">DbContextOptions&lt;MyDbContext&gt; options</span>) : <span class="title">base</span>(<span class="params">options</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnModelCreating</span>(<span class="params">ModelBuilder modelBuilder</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">base</span>.OnModelCreating(modelBuilder);</span><br><span class="line">        <span class="keyword">new</span> BookConfig().Configure(modelBuilder.Entity&lt;Book&gt;());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2.åˆ›å»ºASP.NET Coreé¡¹ç›®ï¼Œæ·»åŠ å¯¹â€œBooksEFCoreâ€é¡¹ç›®çš„å¼•ç”¨ã€‚NuGetå®‰è£…<br>Microsoft.EntityFrameworkCore.SqlServer<br>åœ¨ASP.NET Coreé¡¹ç›®çš„appsettings.jsonä¸­å¢åŠ å¯¹æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²çš„é…ç½®ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;ConnectionStrings&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;Default&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Server=localhost;Database=T_dome;Trusted_Connection=True;MultipleActiveResultSets=true;Encrypt=false;&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>3.é…ç½®æ–‡ä»¶ã€é…ç½®ä»£ç ç­‰æ”¾åˆ°ASP.NET Coreé¡¹ç›®ä¸­ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">builder.Services.AddDbContext&lt;MyDbContext&gt;(opt =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> Default = builder.Configuration.GetConnectionString(<span class="string">&quot;Default&quot;</span>);</span><br><span class="line">    opt.UseSqlServer(Default);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨AddDbContextæ–¹æ³•æ¥é€šè¿‡ä¾èµ–æ³¨å…¥çš„æ–¹å¼è®©MyDbContexté‡‡ç”¨æˆ‘ä»¬æŒ‡å®šçš„è¿æ¥å­—ç¬¦ä¸²è¿æ¥æ•°æ®åº“ã€‚ç”±äºAddDbContextæ–¹æ³•æ˜¯æ³›å‹çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä¸ºåŒä¸€ä¸ªé¡¹ç›®ä¸­çš„å¤šä¸ªä¸åŒçš„ä¸Šä¸‹æ–‡è®¾å®šè¿æ¥ä¸åŒçš„æ•°æ®åº“ã€‚</p><p>4.åœ¨ASP.NET Coreæƒ³ä¹°ä¸­å¢åŠ ä½¿ç”¨MyDbContextè¿›è¡Œæ•°æ®åº“è¯»å†™çš„æµ‹è¯•ä»£ç ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TextController</span> : <span class="title">ControllerBase</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> MyDbContext dbCtx;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TextController</span>(<span class="params">MyDbContext dbCtx</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.dbCtx = dbCtx;</span><br><span class="line">    &#125;</span><br><span class="line">    [<span class="meta">HttpGet</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;IActionResult&gt; <span class="title">Index</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        dbCtx.Add(<span class="keyword">new</span> Book &#123; Id=Guid.NewGuid(),AuthorName= <span class="string">&quot;AuthorName&quot;</span>, Price = <span class="number">100</span>, PuDate = DateTime.Now, Title = <span class="string">&quot;Title&quot;</span> &#125;);</span><br><span class="line">        <span class="keyword">await</span> dbCtx.SaveChangesAsync(); </span><br><span class="line">        <span class="keyword">var</span> book=dbCtx.Books.First();</span><br><span class="line">        <span class="keyword">return</span> Content(book.ToString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>5.ç”Ÿæˆå®ä½“ç±»çš„è¿ç§»è„šæœ¬ã€‚å®‰è£…Microsoft.EntityFrameworkCore.Toolsã€‚ç„¶åæŠŠEFCoreBookè®¾ç½®ä¸ºå¯åŠ¨é¡¹ç›®ï¼Œå¹¶ä¸”åœ¨ã€ç¨‹åºåŒ…ç®¡ç†å™¨æ§åˆ¶å°ã€‘ä¸­ä¹Ÿé€‰ä¸­EFCoreBooké¡¹ç›®åï¼Œæ‰§è¡ŒAdd-Migrationå’ŒUpdate-Database</p><p>6.å†æ‰§è¡ŒAdd-Migrationçš„æ—¶å€™ï¼Œè¿ç§»å·¥å…·å°±ä¼šæç¤ºï¼šUnable to create a â€˜DbContextâ€™ of type â€˜RuntimeTypeâ€™.<br>æ•°æ®åº“è¿ç§»çš„æ—¶å€™å‡ºç°è¿™ç§é”™è¯¯ï¼Œé‡‡ç”¨IDesignTimeDbContextFactoryæ¥å£æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚<br>å½“é¡¹ç›®ä¸­å­˜åœ¨ä¸€ä¸ªIDesignTimeDbContextFactoryæ¥å£çš„å®ç°ç±»çš„æ—¶å€™ï¼Œæ•°æ®åº“è¿ç§»å·¥å…·å°±ä¼šè°ƒç”¨è¿™ä¸ªå®ç°ç±»çš„CreateDbContextæ–¹æ³•æ¥è·å–ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œç„¶åè¿ç§»å·¥å…·ä¼šä½¿ç”¨è¿™ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡æ¥è¿æ¥æ•°æ®åº“ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦åœ¨BooksEFCoreé¡¹ç›®åˆ›å»ºä¸€ä¸ªIDesignTimeDbContextFactoryæ¥å£çš„å®ç°ç±»ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">MyDesignTimeDbContextFactroy</span> : <span class="title">IDesignTimeDbContextFactory</span>&lt;<span class="title">MyDbContext</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> MyDbContext <span class="title">CreateDbContext</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        DbContextOptionsBuilder&lt;MyDbContext&gt; builder = <span class="keyword">new</span> DbContextOptionsBuilder&lt;MyDbContext&gt;();</span><br><span class="line">        <span class="built_in">string</span> ConnStr=<span class="string">&quot;Server=localhost;Database=T_dome3;Trusted_Connection=True;MultipleActiveResultSets=true;Encrypt=false;&quot;</span>;</span><br><span class="line">        builder.UseSqlServer(ConnStr);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> MyDbContext(builder.Options);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†æœ‰æ•°æ®æ³„éœ²çš„é£é™©</p><p><img src="/img%5CWEBAPI%5C15.png"></p>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ASP.NET Core </tag>
            
            <tag> Entity Framework Core </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ASP.NET Core Web APIåŸºç¡€ç»„ä»¶</title>
      <link href="/2025/04/19/asp.net%20core/ASP.NET%20Core%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/"/>
      <url>/2025/04/19/asp.net%20core/ASP.NET%20Core%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="ASP-NET-Coreä¸­æœåŠ¡æ³¨å…¥çš„åœ°æ–¹"><a href="#ASP-NET-Coreä¸­æœåŠ¡æ³¨å…¥çš„åœ°æ–¹" class="headerlink" title="ASP.NET Coreä¸­æœåŠ¡æ³¨å…¥çš„åœ°æ–¹"></a>ASP.NET Coreä¸­æœåŠ¡æ³¨å…¥çš„åœ°æ–¹</h1><p>1.åœ¨ASP.NET Coreé¡¹ç›®ä¸­ä¸€èˆ¬ä¸éœ€è¦è‡ªå·±åˆ›å»ºServiceCollectionã€IServiceProviderã€‚åœ¨Program.csçš„builder.Build()ä¹‹å‰å‘builder.Servicesä¸­æ³¨å…¥ã€‚<br>2.åœ¨Controllerä¸­å¯ä»¥é€šè¿‡æ„é€ æ–¹æ³•æ³¨å…¥æœåŠ¡ã€‚</p><p>å®šä¹‰ä¸€ä¸ªMyServiceç±»</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyService</span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> IEnumerable&lt;<span class="built_in">string</span>&gt; <span class="title">GetName</span>()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">string</span>[] &#123;<span class="string">&quot;you&quot;</span>,<span class="string">&quot;xian&quot;</span>,<span class="string">&quot;yu&quot;</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ASP.NET Coreé¡¹ç›®çš„Program.csæ–‡ä»¶ä¸­çš„var app&#x3D;builder.Build()ä»£ç ä¹‹å‰é€šè¿‡AddScopedæ–¹æ³•æ¥æ³¨å†ŒMyServiceæœåŠ¡ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">builder.Services.AddScoped&lt;MyService&gt;();</span><br></pre></td></tr></table></figure><p>åœ¨æ§åˆ¶å™¨ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡æ„é€ æ–¹æ³•æ¥æ³¨å…¥æœåŠ¡ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TestController</span>:<span class="title">ControllerBase</span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> MyService myService;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TestController</span>(<span class="params">MyService myService</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.myService=myService;</span><br><span class="line">    &#125;</span><br><span class="line">    [<span class="meta">HttpGet</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">Test</span>()</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> names=myService.GetNames();</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">string</span>.Join(<span class="string">&quot;,&quot;</span>,names);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä½ä½¿ç”¨é¢‘ç‡æœåŠ¡çš„å¦ç±»æ³¨å…¥æ–¹å¼"><a href="#ä½ä½¿ç”¨é¢‘ç‡æœåŠ¡çš„å¦ç±»æ³¨å…¥æ–¹å¼" class="headerlink" title="ä½ä½¿ç”¨é¢‘ç‡æœåŠ¡çš„å¦ç±»æ³¨å…¥æ–¹å¼"></a>ä½ä½¿ç”¨é¢‘ç‡æœåŠ¡çš„å¦ç±»æ³¨å…¥æ–¹å¼</h3><p>1.æŠŠActionç”¨åˆ°çš„æœåŠ¡é€šè¿‡Actionçš„å‚æ•°æ³¨å…¥ï¼Œåœ¨è¿™ä¸ªå‚æ•°ä¸Šæ ‡æ³¨[FromServices]ã€‚å’ŒActionçš„å…¶ä»–å‚æ•°ä¸å†²çªã€‚<br>2.ä¸€èˆ¬ä¸éœ€è¦ï¼Œåªæœ‰è°ƒç”¨é¢‘ç‡ä¸é«˜å¹¶ä¸”èµ„æºçš„åˆ›å»ºæ¯”è¾ƒæ¶ˆè€—èµ„æºçš„æœåŠ¡æ‰[FromServices]ã€‚<br>3.åªæœ‰Actionæ–¹æ³•æ‰èƒ½ç”¨[FromServices],æ™®é€šçš„ç±»é»˜è®¤ä¸æ”¯æŒã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">Test</span>(<span class="params">[FromServices]MyService myService,<span class="built_in">string</span> name</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> names=myService.GetName();</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">string</span>.Join(<span class="string">&quot;,&quot;</span>,names)+<span class="string">&quot;,Hello:&quot;</span>+name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¼€å‘æ¨¡å—åŒ–çš„æœåŠ¡æ³¨å†Œæ¡†æ¶"><a href="#å¼€å‘æ¨¡å—åŒ–çš„æœåŠ¡æ³¨å†Œæ¡†æ¶" class="headerlink" title="å¼€å‘æ¨¡å—åŒ–çš„æœåŠ¡æ³¨å†Œæ¡†æ¶"></a>å¼€å‘æ¨¡å—åŒ–çš„æœåŠ¡æ³¨å†Œæ¡†æ¶</h3><p>ä¸€ä¸ªè½¯ä»¶é€šå¸¸æœ‰å¤šä¸ªé¡¹ç›®ç»„æˆï¼Œè¿™äº›é¡¹ç›®éƒ½ä¼šç›´æ¥æˆ–è€…é—´æ¥è¢«ä¸»ASP.NET Coreé¡¹ç›®å¼•ç”¨ã€‚è¿™äº›é¡¹ç›®ä¸­é€šå¸¸éƒ½ä¼šç”¨åˆ°è‹¥å¹²ä¸ªè¢«æ³¨å…¥çš„æœåŠ¡ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åœ¨ä¸»ASP.NET Coreé¡¹ç›®çš„Program.csä¸­æ³¨å†Œè¿™äº›æœã€‚è¿™æ ·ä¸ä»…å¢åŠ äº†Program.csç®¡ç†çš„å¤æ‚åº¦ï¼Œè€Œä¸”å¢åŠ äº†é¡¹ç›®çš„è€¦åˆåº¦ã€‚</p><p>Scrutoræ˜¯ Kristian Hellang å¤§ç¥å†™çš„ä¸€ä¸ªåŸºäºMicrosoft.Extensions.DependencyInjectionçš„ä¸€ä¸ªæ‰©å±•åº“ï¼Œä¸»è¦æ˜¯ä¸ºäº†ç®€åŒ–æˆ‘ä»¬å¯¹DIçš„æ“ä½œã€‚</p><p>Scrutoræä¾›Scanè¿™ä¸ªæ–¹æ³•ã€‚</p><p>1.é€‰æ‹©ç¨‹åºé›†ï¼šæŒ‡å®šä»å“ªä¸ªç¨‹åºé›†ä¸­æ‰«æç±»å‹ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">builder.Services.Scan(scan =&gt; scan.FromAssemblyOf&lt;Class1&gt;());</span><br></pre></td></tr></table></figure><p>2.æ·»åŠ ç±»ï¼šè¿‡æ»¤éœ€è¦æ³¨å†Œçš„ç±»ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">builder.Services.Scan(scan =&gt; scan.FromAssemblyOf&lt;Class1&gt;()</span><br><span class="line">.AddClasses(cl =&gt; cl.Where(t =&gt; t.Name.EndsWith(<span class="string">&quot;Service&quot;</span>)))<span class="comment">//åªæ³¨å†Œä»¥Serviceç»“å°¾çš„ç±»</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>3.æŒ‡å®šæ³¨å†Œæ–¹å¼ï¼šæŒ‡å®šåº”è¯¥æ³¨å†Œä¸ºå“ªäº›æ¥å£ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">builder.Services.Scan(scan =&gt; scan.FromAssemblyOf&lt;Class1&gt;()</span><br><span class="line">.AddClasses(cl =&gt; cl.Where(t =&gt; t.Name.EndsWith(<span class="string">&quot;Service&quot;</span>)))</span><br><span class="line">.AsImplementedInterfaces() <span class="comment">//æ³¨å†Œä¸ºå®ç°çš„æ‰€æœ‰æ¥å£</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>4.è®¾ç½®ç”Ÿå‘½å‘¨æœŸï¼šä¸ºæ³¨å†Œçš„æœåŠ¡è®¾ç½®ç”Ÿå‘½å‘¨æœŸ</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">builder.Services.Scan(scan =&gt; scan.FromAssemblyOf&lt;Class1&gt;()</span><br><span class="line">.AddClasses(cl =&gt; cl.Where(t =&gt; t.Name.EndsWith(<span class="string">&quot;Service&quot;</span>)))</span><br><span class="line">.AsImplementedInterfaces()</span><br><span class="line">.WithScopedLifetime() <span class="comment">//è®¾ç½®ä¸ºScopedç”Ÿå‘½å‘¨æœŸ</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><h2 id="æ€§èƒ½ä¼˜åŒ–â€œä¸‡é‡‘æ²¹â€ï¼šç¼“å­˜"><a href="#æ€§èƒ½ä¼˜åŒ–â€œä¸‡é‡‘æ²¹â€ï¼šç¼“å­˜" class="headerlink" title="æ€§èƒ½ä¼˜åŒ–â€œä¸‡é‡‘æ²¹â€ï¼šç¼“å­˜"></a>æ€§èƒ½ä¼˜åŒ–â€œä¸‡é‡‘æ²¹â€ï¼šç¼“å­˜</h2><p>ç¼“å­˜ï¼ˆcachingï¼‰æ˜¯ç³»ç»Ÿä¼˜åŒ–ä¸­ç®€å•åˆæœ‰æ•ˆçš„å·¥å…·ï¼Œåªè¦ç®€å•å‡ è¡Œä»£ç æˆ–å‡ ä¸ªç®€å•çš„é…ç½®ï¼Œæˆ‘ä»¬å°±å¯åˆ©ç”¨ç¼“å­˜çš„æ€§èƒ½å¾—åˆ°æå¤§çš„æå‡ã€‚</p><p>1.ä»€ä¹ˆæ˜¯ç¼“å­˜</p><p>ç¼“å­˜æ˜¯ä¸€ä¸ªç”¨æ¥ä¿å­˜æ•°æ®çš„åŒºåŸŸï¼Œä»ç¼“å­˜åŒºåŸŸä¸­è¯»å–æ•°æ®çš„é€Ÿåº¦æ¯”ä»æ•°æ®æºè¯»å–æ•°æ®çš„é€Ÿåº¦å¿«å¾ˆå¤šã€‚åœ¨ä»æ•°æ®æºï¼ˆå¦‚æ•°æ®åº“ï¼‰è·å–æ•°æ®ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ•°æ®ä¿å­˜åˆ°ç¼“å­˜ä¸­ã€‚</p><p><img src="/img%5CWEBAPI%5C%E7%BC%93%E5%AD%98.png"></p><h3 id="å®¢æˆ·ç«¯å“åº”ç¼“å­˜"><a href="#å®¢æˆ·ç«¯å“åº”ç¼“å­˜" class="headerlink" title="å®¢æˆ·ç«¯å“åº”ç¼“å­˜"></a>å®¢æˆ·ç«¯å“åº”ç¼“å­˜</h3><p>1.RFC7324æ˜¯HTTPåè®®ä¸­å¯¹ç¼“å­˜è¿›è¡Œæ§åˆ¶çš„è§„èŒƒï¼Œå…¶ä¸­é‡è¦çš„æ˜¯cache-controlè¿™ä¸ªå“åº”æŠ¥æ–‡å¤´ã€‚æœåŠ¡å™¨å¦‚æœè¿”å›cache-control:max-age&#x3D;60,åˆ™è¡¨ç¤ºæœåŠ¡å™¨æŒ‡ç¤ºæµè§ˆå™¨ç«¯â€œå¯ä»¥ç¼“å­˜è¿™ä¸ªå“åº”å†…å®¹60ç§’â€ã€‚<br>2.æˆ‘ä»¬åªè¦ç»™éœ€è¦è¿›è¡Œç¼“å­˜æ§åˆ¶çš„æ§åˆ¶å™¨çš„æ“ä½œæ–¹æ³•æ·»åŠ ResponseCacheAttributeè¿™ä¸ªAttributeï¼ŒASP.NET Coreä¼šè‡ªåŠ¨æ·»åŠ cache-controlæŠ¥æ–‡å¤´ã€‚<br>3.éªŒè¯ï¼šç¼–å†™ä¸€ä¸ªè¿”å›å½“å‰æ—¶é—´çš„Actionæ–¹æ³•ã€‚åˆ†åˆ«åŠ å’Œä¸åŠ ResponseCacheAttributeçœ‹åŒºåˆ«ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TestController</span> : <span class="title">ControllerBase</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">HttpGet</span>]</span><br><span class="line">    [<span class="meta">ResponseCache(Duration =20)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> DateTime <span class="title">Now</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> DateTime.Now;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€æ¬¡è®¿é—®ï¼ŒæœåŠ¡å™¨è¿”å›å½“å‰æ—¶é—´<br><img src="/img%5CWEBAPI%5C6.png"></p><p>ç¬¬äºŒæ¬¡è®¿é—®ï¼Œå“åº”æ˜¯ç›´æ¥ä»æµè§ˆå™¨ç¼“å­˜ä¸­è·å–çš„ã€‚<br><img src="/img%5CWEBAPI%5C7.png"></p><p>ç¬¬ä¸‰æ¬¡è®¿é—®<br><img src="/img%5CWEBAPI%5C8.png"></p><h3 id="æœåŠ¡å™¨ç«¯å“åº”ç¼“å­˜"><a href="#æœåŠ¡å™¨ç«¯å“åº”ç¼“å­˜" class="headerlink" title="æœåŠ¡å™¨ç«¯å“åº”ç¼“å­˜"></a>æœåŠ¡å™¨ç«¯å“åº”ç¼“å­˜</h3><p>1.å¦‚æœASP.NET Coreä¸­å®‰è£…äº†â€œç›¸åº”ç¼“å­˜ä¸­é—´ä»¶â€ï¼Œé‚£ä¹ˆASP.NET Coreä¸ä»…ä¼šç»§ç»­æ ¹æ®[ResponseCache]è®¾ç½®æ¥ç”Ÿæˆcache-controlå“åº”æŠ¥æ–‡å¤´æ¥è®¾ç½®å®¢æˆ·ç«¯ç¼“å­˜ï¼Œè€Œä¸”æœåŠ¡å™¨ä¹Ÿä¼šæŒ‰ç…§[ResponseCache]çš„è®¾ç½®æ¥å¯¹åº”å“åº”æœåŠ¡å™¨ç«¯ç¼“å­˜ã€‚å’Œå®¢æˆ·ç«¯ç¼“å­˜çš„åŒºåˆ«ï¼Ÿæ¥å­å¤šä¸ªä¸åŒå®¢æˆ·ç«¯çš„ç›¸åŒè¯·æ±‚ã€‚<br>2.â€œå“åº”ç¼“å­˜ä¸­é—´ä»¶â€çš„å¥½å¤„ï¼šå¯¹äºæ¥è‡ªä¸åŒå®¢æˆ·ç«¯çš„ç›¸åŒè¯·æ±‚æˆ–è€…ä¸æ”¯æŒå®¢æˆ·ç«¯ç¼“å­˜çš„å®¢æˆ·ç«¯ï¼Œèƒ½é™ä½æœåŠ¡å™¨ç«¯çš„å‹åŠ›ã€‚<br>3.ç”¨æ³•ï¼šåœ¨ç¨‹åºé›†Program.csä¸­app.MapControllers()ä¹‹å‰åŠ ä¸Šapp.UseResponseCaching()ã€‚è¯·ç¡®ä¿app.UseCors()å†™åˆ°app.UseResponseCaching()ä¹‹å‰ã€‚  </p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">app.UseResponseCaching();<span class="comment">//å¯åŠ¨æœåŠ¡å™¨ç«¯å“åº”ç¼“å­˜</span></span><br><span class="line">app.MapControllers();</span><br></pre></td></tr></table></figure><p>æœåŠ¡å™¨ç«¯å“åº”ç¼“å­˜å¾ˆé¸¡è‚‹<br>1.æ— æ³•è§£å†³æ¶æ„è¯·æ±‚ç»™æœåŠ¡å™¨å¸¦æ¥çš„å‹åŠ›ã€‚<br>2.æœåŠ¡å™¨ç«¯å“åº”ç¼“å­˜è¿˜æœ‰å¾ˆå¤šé™åˆ¶ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼šå“åº”çŠ¶æ€ç ä¸º200çš„GETæˆ–è€…HEADå“åº”æ‰å¯èƒ½è¢«ç¼“å­˜ï¼›æŠ¥æ–‡å¤´ä¸­ä¸èƒ½å«æœ‰Authorizationã€Set-Cookieç­‰ã€‚<br>3.å»ºè®®é‡‡ç”¨ASP.NET Coreæä¾›çš„å†…å­˜ç¼“å­˜ã€åˆ†å¸ƒå¼ç¼“å­˜æœºåˆ¶æ¥ç¼–å†™ç¨‹åºï¼Œä»¥æ›´çµæ´»åœ°è¿›è¡Œè‡ªå®šä¹‰ç¼“å­˜å¤„ç†ã€‚</p><h3 id="å†…å­˜ç¼“å­˜"><a href="#å†…å­˜ç¼“å­˜" class="headerlink" title="å†…å­˜ç¼“å­˜"></a>å†…å­˜ç¼“å­˜</h3><p>1.æŠŠç¼“å­˜æ•°æ®æ”¾åœ¨åº”ç”¨ç¨‹åºçš„å†…å­˜ã€‚å†…å­˜ç¼“å­˜ä¸­ä¿å­˜çš„æ˜¯ä¸€ä¸ªç³»åˆ—çš„é”®å€¼å¯¹ï¼Œå°±åƒDictionaryç±»å‹ä¸€æ ·ã€‚<br>2.å†…å­˜ç¼“å­˜çš„æ•°æ®ä¿å­˜åœ¨å½“å‰è¿è¡Œçš„ç½‘ç«™ç¨‹åºçš„å†…å­˜ä¸­ï¼Œæ˜¯å’Œè¿›ç¨‹ç›¸å…³çš„ã€‚å› ä¸ºåœ¨WebæœåŠ¡å™¨ä¸­ï¼Œå¤šä¸ªä¸åŒç½‘ç«™é‡å¯åï¼Œå†…å­˜ç¼“å­˜ä¸­çš„æ‰€æœ‰æ•°æ®ä¹Ÿå°±éƒ½è¢«æ¸…ç©ºäº†ã€‚</p><p><b>å†…å­˜ç¼“å­˜ç”¨æ³•</b><br>1.å¯ç”¨ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">builder.Services.AddMemoryCache();<span class="comment">//æ·»åŠ å†…å­˜ç¼“å­˜æœåŠ¡</span></span><br></pre></td></tr></table></figure><p>2.æ³¨å…¥IMemoryCacheæ¥å£ï¼ŒæŸ¥çœ‹æ¥å£çš„æ–¹æ³•ï¼šTryGetValueã€Removeã€Setã€GetOrCreateã€GetOrCreateAsync</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">readonly</span> IMemoryCache memoryCache;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">readonly</span> ILogger&lt;TestController&gt; logger;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">TestController</span>(<span class="params">IMemoryCache memoryCache, ILogger&lt;TestController&gt; logger</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">this</span>.memoryCache = memoryCache;</span><br><span class="line">    <span class="keyword">this</span>.logger = logger;</span><br><span class="line">&#125;</span><br><span class="line">[<span class="meta">HttpGet</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;ActionResult&lt;Book?&gt;&gt; GetBookById(<span class="built_in">long</span> id)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//GetOrCreateAsyncäºŒåˆä¸€ï¼š1ã€‚è·å–ç¼“å­˜ 2.å¦‚æœæ²¡æœ‰ç¼“å­˜ï¼Œåˆ™æ‰§è¡ŒGetBookByIdAsyncæ–¹æ³•ï¼Œå¹¶å°†ç»“æœç¼“å­˜</span></span><br><span class="line">    logger.LogInformation(<span class="string">$&quot;GetBookById id=<span class="subst">&#123;id&#125;</span>&quot;</span>); <span class="comment">// è®°å½•æ—¥å¿—</span></span><br><span class="line">    Book? b= <span class="keyword">await</span> memoryCache.GetOrCreateAsync(<span class="string">&quot;Book&quot;</span> + id, <span class="keyword">async</span> (e) =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        logger.LogInformation(<span class="string">$&quot;GetBookById id=<span class="subst">&#123;id&#125;</span> è¿›å…¥ç¼“å­˜&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">await</span> MyDbContext.GetBookByIdAsync(id);</span><br><span class="line">    &#125;);</span><br><span class="line">    logger.LogInformation(<span class="string">$&quot;GetBookById id=<span class="subst">&#123;id&#125;</span> ç»“æŸç¼“å­˜&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (b == <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> NotFound(<span class="string">$&quot;æ‰¾ä¸åˆ°id=<span class="subst">&#123;id&#125;</span>çš„ä¹¦&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç¼“å­˜çš„è¿‡æœŸæ—¶é—´ç­–ç•¥"><a href="#ç¼“å­˜çš„è¿‡æœŸæ—¶é—´ç­–ç•¥" class="headerlink" title="ç¼“å­˜çš„è¿‡æœŸæ—¶é—´ç­–ç•¥"></a>ç¼“å­˜çš„è¿‡æœŸæ—¶é—´ç­–ç•¥</h3><p>1.ä¸Šé¢çš„ä¾‹å­ä¸­çš„ç¼“å­˜ä¸ä¼šè¿‡æœŸï¼Œé™¤éé‡å¯æœåŠ¡å™¨ã€‚<br>2.è§£å†³æ–¹æ³•ï¼šåœ¨æ•°æ®æ”¹å˜çš„æ—¶å€™è°ƒç”¨Removeæˆ–è€…Setæ¥åˆ é™¤æˆ–è€…ä¿®æ”¹ç¼“å­˜ï¼ˆä¼˜ç‚¹ï¼šåŠæ—¶ï¼‰ï¼›è¿‡æœŸæ—¶é—´ï¼ˆåªè¦è¿‡æœŸæ—¶é—´æ¯”è¾ƒçŸ­ï¼Œç¼“å­˜æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µä¹Ÿä¸ä¼šæŒç»­å¾ˆé•¿æ—¶é—´ã€‚ï¼‰<br>3.ä¸¤ç§è¿‡æœŸæ—¶é—´ç­–ç•¥ï¼šç»å¯¹è¿‡æœŸæ—¶é—´ã€æ»‘è¿‡è¿‡æœŸæ—¶é—´ã€‚</p><p>ç¼“å­˜çš„ç»å¯¹è¿‡æœŸæ—¶é—´</p><p>1.GetOrCreateAsync()æ–¹æ³•çš„å›è°ƒæ–¹æ³•ä¸­æœ‰ä¸€ä¸ªICacheEntryç±»å‹çš„å‚æ•°ï¼Œé€šè¿‡ICacheEntryå¯¹å½“å‰çš„ç¼“å­˜é¡¹åšè®¾ç½®ã€‚<br>2.AbsoluteExpirationRelativeToNowç”¨æ¥è®¾å®šç¼“å­˜é¡¹çš„ç»å¯¹è¿‡æœŸæ—¶é—´ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">logger.LogInformation(<span class="string">$&quot;GetBookById id=<span class="subst">&#123;id&#125;</span>&quot;</span>); <span class="comment">// è®°å½•æ—¥å¿—</span></span><br><span class="line">Book? b= <span class="keyword">await</span> memoryCache.GetOrCreateAsync(<span class="string">&quot;Book&quot;</span> + id, <span class="keyword">async</span> (e) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    e.AbsoluteExpirationRelativeToNow = TimeSpan.FromSeconds(<span class="number">10</span>); <span class="comment">// è®¾ç½®ç¼“å­˜è¿‡æœŸæ—¶é—´</span></span><br><span class="line">    logger.LogInformation(<span class="string">$&quot;GetBookById id=<span class="subst">&#123;id&#125;</span> è¿›å…¥ç¼“å­˜&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">await</span> MyDbContext.GetBookByIdAsync(id);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ç¼“å­˜çš„æ»‘åŠ¨è¿‡æœŸæ—¶é—´</p><p>1.ICacheEntryçš„SlidingExpirationå±æ€§ç”¨æ¥è®¾å®šç¼“å­˜é¡¹çš„æ»‘åŠ¨è¿‡æœŸæ—¶é—´ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">logger.LogInformation(<span class="string">$&quot;GetBookById id=<span class="subst">&#123;id&#125;</span>&quot;</span>); <span class="comment">// è®°å½•æ—¥å¿—</span></span><br><span class="line">Book? b= <span class="keyword">await</span> memoryCache.GetOrCreateAsync(<span class="string">&quot;Book&quot;</span> + id, <span class="keyword">async</span> (e) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/*e.AbsoluteExpirationRelativeToNow = TimeSpan.FromSeconds(10); // è®¾ç½®ç¼“å­˜è¿‡æœŸæ—¶é—´*/</span></span><br><span class="line">    e.SlidingExpiration = TimeSpan.FromSeconds(<span class="number">10</span>); <span class="comment">// è®¾ç½®æ»‘åŠ¨è¿‡æœŸæ—¶é—´</span></span><br><span class="line">    logger.LogInformation(<span class="string">$&quot;GetBookById id=<span class="subst">&#123;id&#125;</span> è¿›å…¥ç¼“å­˜&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">await</span> MyDbContext.GetBookByIdAsync(id);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¸¤ç§è¿‡æœŸæ—¶é—´æ··ç”¨</p><p>ä½¿ç”¨æ»‘åŠ¨è¿‡æœŸæ—¶é—´ç­–ç•¥ï¼Œå¦‚æœä¸€ä¸ªç¼“å­˜é¡¹ä¸€ç›´è¢«é¢‘ç¹è®¿é—®ï¼Œé‚£ä¹ˆè¿™ä¸ªç¼“å­˜é¡¹å°±ä¼šä¸€ç›´è¢«ç»­æœŸè€Œä¸è¿‡æœŸã€‚å¯ä»¥å¯¹ä¸€ä¸ªç¼“å­˜é¡¹åŒæ—¶è®¾å®šæ»‘åŠ¨è¿‡æœŸæ—¶é—´å’Œç»å¯¹è¿‡æœŸæ—¶é—´é•¿ï¼Œè¿™æ ·ç¼“å­˜æƒ³çš„å†…å®¹ä¼šåœ¨ç»å¯¹è¿‡æœŸæ—¶é—´å†…éšç€è®¿é—®è¢«æ»‘åŠ¨ç»­æœŸï¼Œä½†æ˜¯ä¸€æ—¦è¶…è¿‡äº†ç»å¯¹è¿‡æœŸæ—¶é—´ï¼Œç¼“å­˜åƒå°±ä¼šè¢«åˆ é™¤ã€‚</p><h3 id="ç¼“å­˜ç©¿é€é—®é¢˜çš„è§„é¿"><a href="#ç¼“å­˜ç©¿é€é—®é¢˜çš„è§„é¿" class="headerlink" title="ç¼“å­˜ç©¿é€é—®é¢˜çš„è§„é¿"></a>ç¼“å­˜ç©¿é€é—®é¢˜çš„è§„é¿</h3><p>åœ¨ä½¿ç”¨å†…å­˜ç¼“å­˜çš„æ—¶å€™ï¼Œå¦‚æœå¤„ç†ä¸å½“ï¼Œæˆ‘ä»¬å®¹æ˜“é‡åˆ°â€œç¼“å­˜ç©¿é€â€çš„é—®é¢˜ã€‚æˆ‘ä»¬æ³¨æ„åˆ°ï¼ŒIMemoryCacheæ¥å£ä¸­æœ‰ä¸€ä¸ªGet(object key)æ–¹æ³•ï¼Œå®ƒç”¨æ¥æ ¹æ®ç¼“å­˜é”®keyæŸ¥æ‰¾ç¼“å­˜å€¼ï¼Œå¦‚æœæ‰¾ä¸åˆ°ç¼“å­˜é¡¹ï¼Œåˆ™æ–¹æ³•ä¼šè¿”å›nullç­‰é»˜è®¤å€¼ã€‚</p><p>ç¼“å­˜ç©¿é€çš„è§£å†³æ–¹æ¡ˆ</p><p>1.è§£å†³æ–¹æ³•ï¼šæŠŠâ€œæŸ¥ä¸åˆ°â€ä¹Ÿå½“æˆä¸€ä¸ªæ•°æ®æ”¾å…¥ç¼“å­˜ã€‚<br>2.æˆ‘ä»¬ç”¨GetOrCreateAsyncæ–¹æ³•å³å¯ï¼Œå› ä¸ºå®ƒä¼šæŠŠnullå€¼ä¹Ÿå½“æˆåˆæ³•çš„ç¼“å­˜å€¼ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">logger.LogInformation(<span class="string">$&quot;GetBookById id=<span class="subst">&#123;id&#125;</span>&quot;</span>); <span class="comment">// è®°å½•æ—¥å¿—</span></span><br><span class="line">Book? b= <span class="keyword">await</span> memoryCache.GetOrCreateAsync(<span class="string">&quot;Book&quot;</span> + id, <span class="keyword">async</span> (e) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/*e.AbsoluteExpirationRelativeToNow = TimeSpan.FromSeconds(10); // è®¾ç½®ç¼“å­˜è¿‡æœŸæ—¶é—´*/</span></span><br><span class="line">    <span class="comment">/*e.SlidingExpiration = TimeSpan.FromSeconds(10); // è®¾ç½®æ»‘åŠ¨è¿‡æœŸæ—¶é—´*/</span></span><br><span class="line">    Book? d= <span class="keyword">await</span> MyDbContext.GetBookByIdAsync(id);</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;GetBookById id=<span class="subst">&#123;id&#125;</span> è¿›å…¥ç¼“å­˜&quot;</span>); <span class="comment">// è®°å½•æ—¥å¿—</span></span><br><span class="line">    logger.LogInformation(<span class="string">$&quot;GetBookById id=<span class="subst">&#123;id&#125;</span> è¿›å…¥ç¼“å­˜&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">await</span> MyDbContext.GetBookByIdAsync(id);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="ç¼“å­˜é›ªå´©"><a href="#ç¼“å­˜é›ªå´©" class="headerlink" title="ç¼“å­˜é›ªå´©"></a>ç¼“å­˜é›ªå´©</h3><p>1.ç¼“å­˜é¡¹é›†ä¸­è¿‡æœŸå¼•èµ·ç¼“å­˜é›ªå´©ã€‚<br>2.è§£å†³æ–¹æ³•ï¼šåœ¨åŸºç¡€è¿‡æœŸæ—¶é—´ä¹‹ä¸Šï¼Œå†åŠ ä¸€ä¸ªéšæœºçš„è¿‡æœŸæ—¶é—´ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">logger.LogInformation(<span class="string">$&quot;GetBookById id=<span class="subst">&#123;id&#125;</span>&quot;</span>); <span class="comment">// è®°å½•æ—¥å¿—</span></span><br><span class="line">Book? b= <span class="keyword">await</span> memoryCache.GetOrCreateAsync(<span class="string">&quot;Book&quot;</span> + id, <span class="keyword">async</span> (e) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">/*e.AbsoluteExpirationRelativeToNow = TimeSpan.FromSeconds(10); // è®¾ç½®ç¼“å­˜è¿‡æœŸæ—¶é—´*/</span></span><br><span class="line">    <span class="comment">/*e.SlidingExpiration = TimeSpan.FromSeconds(10); // è®¾ç½®æ»‘åŠ¨è¿‡æœŸæ—¶é—´*/</span></span><br><span class="line">    e.AbsoluteExpirationRelativeToNow=TimeSpan.FromSeconds(Random.Shared.Next(<span class="number">5</span>, <span class="number">10</span>)); <span class="comment">// è®¾ç½®ç¼“å­˜è¿‡æœŸæ—¶é—´</span></span><br><span class="line">    Book? d= <span class="keyword">await</span> MyDbContext.GetBookByIdAsync(id);</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;GetBookById id=<span class="subst">&#123;id&#125;</span> è¿›å…¥ç¼“å­˜&quot;</span>); <span class="comment">// è®°å½•æ—¥å¿—</span></span><br><span class="line">    logger.LogInformation(<span class="string">$&quot;GetBookById id=<span class="subst">&#123;id&#125;</span> è¿›å…¥ç¼“å­˜&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">await</span> MyDbContext.GetBookByIdAsync(id);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="å°è£…å†…å­˜ç¼“å­˜æ“ä½œçš„å¸®åŠ©ç±»"><a href="#å°è£…å†…å­˜ç¼“å­˜æ“ä½œçš„å¸®åŠ©ç±»" class="headerlink" title="å°è£…å†…å­˜ç¼“å­˜æ“ä½œçš„å¸®åŠ©ç±»"></a>å°è£…å†…å­˜ç¼“å­˜æ“ä½œçš„å¸®åŠ©ç±»</h3><p>1.IQueryableã€IEnumerableç­‰ç±»å‹å¯èƒ½å­˜åœ¨ç€å»¶è¿ŸåŠ è½½çš„é—®é¢˜ï¼Œå¦‚æœæŠŠè¿™ä¸¤ç§ç±»å‹çš„å˜é‡æŒ‡å‘çš„å¯¹è±¡ä¿å­˜åˆ°ç¼“å­˜ä¸­ï¼Œåœ¨æˆ‘ä»¬æŠŠå®ƒä»¬å–å‡ºæ¥å†å»æ‰§è¡Œçš„æ—¶å€™ï¼Œå¦‚æœå®ƒä»¬å»¶è¿ŸåŠ è½½æ—¶å€™éœ€è¦çš„å¯¹è±¡å·²ç»è¢«é‡Šæ”¾çš„è¯ï¼Œå°±ä¼šæ‰§è¡Œå¤±è´¥ã€‚å› æ­¤ç¼“å­˜ç¦æ­¢è¿™ä¸¤ç§ç±»å‹ã€‚<br>2.å®ç°éšæœºç¼“å­˜è¿‡æœŸæ—¶é—´ã€‚</p><p>ä½¿ç”¨NuGetåŒ…ï¼šZack.ASPNETCore</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">builder.Services.AddScoped&lt;IMemoryCacheHelper, MemoryCacheHelper&gt;();</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">HttpGet</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;ActionResult&lt;Book?&gt;&gt; Test3(<span class="built_in">long</span> id)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> book = <span class="keyword">await</span> memoryCache.GetOrCreateAsync(<span class="string">&quot;Book&quot;</span> + id, <span class="keyword">async</span> (e) =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        e.SlidingExpiration = TimeSpan.FromSeconds(<span class="number">5</span>); <span class="comment">// è®¾ç½®æ»‘åŠ¨è¿‡æœŸæ—¶é—´</span></span><br><span class="line">        <span class="keyword">var</span> book = <span class="keyword">await</span> MyDbContext.GetBookByIdAsync(id);</span><br><span class="line">        <span class="keyword">return</span> book;</span><br><span class="line">    &#125;,<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (book == <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> NotFound(<span class="string">&quot;ä¸å­˜åœ¨&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> book;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åˆ†å¸ƒå¼ç¼“å­˜"><a href="#åˆ†å¸ƒå¼ç¼“å­˜" class="headerlink" title="åˆ†å¸ƒå¼ç¼“å­˜"></a>åˆ†å¸ƒå¼ç¼“å­˜</h2><p>åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å†…å­˜ç¼“å­˜<br><img src="/img%5CWEBAPI%5C%E5%88%86%E5%B8%83%E5%BC%8F.png"><br>å¦‚æœé›†ç¾¤èŠ‚ç‚¹çš„æ•°é‡éå¸¸å¤šçš„è¯ï¼Œè¿™æ ·çš„é‡å¤æŸ¥è¯¢ä¹ŸåŒæ ·å¯èƒ½ä¼šæŠŠæ•°æ®åº“å‹å®ã€‚</p><p>1.å¸¸ç”¨çš„åˆ†å¸ƒå¼ç¼“å­˜æœåŠ¡å™¨æœ‰Redisã€Memcachedç­‰ã€‚<br>2..NET Coreä¸­æä¾›äº†ç»Ÿä¸€çš„åˆ†å¸ƒå¼ç¼“å­˜æœåŠ¡å™¨çš„æ“ä½œæ¥å£IDistributedCacheï¼Œç”¨æ³•å’Œå†…å­˜ç¼“å­˜ç±»ä¼¼ã€‚<br>3.åˆ†å¸ƒå¼ç¼“å­˜å’Œå†…å­˜ç¼“å­˜çš„åŒºåˆ«ï¼šç¼“å­˜å€¼çš„ç±»å‹ä¸ºbyte[]ï¼Œéœ€è¦æˆ‘ä»¬è¿›è¡Œç±»å‹è½¬æ¢ï¼Œä¹Ÿæä¾›äº†ä¸€äº›æŒ‰ç…§stringç±»å‹å­˜å–ç¼“å­˜å€¼çš„æ‰©å±•æ–¹æ³•ã€‚</p><p><img src="/img%5CWEBAPI%5C9.png"></p><p>ç”¨ä»€ä¹ˆåšç¼“å­˜æœåŠ¡å™¨</p><p>1.Memcachedæ˜¯ç¼“å­˜ä¸“ç”¨ï¼Œæ€§èƒ½éå¸¸é«˜ï¼Œä½†æ˜¯é›†ç¾¤ã€é«˜å¯ç”¨ç­‰æ–¹é¢æ¯”è¾ƒå¼±ï¼Œè€Œä¸”æœ‰â€œç¼“å­˜é”®çš„æœ€å¤§é•¿åº¦ä¸º250å­—èŠ‚â€ç­‰é™åˆ¶ã€‚å¯ä»¥å®‰è£…EnyimMemcachedCoreè¿™ä¸ªç¬¬ä¸‰NuGetåŒ…ã€‚<br>2.Redisä¸å±€é™äºç¼“å­˜ï¼ŒRedisåšç¼“å­˜æœåŠ¡å™¨æ¯”Memcachedæ€§èƒ½ç¨å·®ï¼Œä½†æ˜¯Redisçš„é«˜å¯ç”¨ã€é›†ç¾¤ç­‰æ–¹é¢éå¸¸å¼ºå¤§ï¼Œé€‚åˆåœ¨æ•°æ®é‡å¤§ã€é«˜å¯ç”¨æ€§ç­‰åœºåˆä½¿ç”¨ã€‚</p><p>ä½¿ç”¨Redis</p><p>1.NuGetå®‰è£…</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Microsoft.Extensions.Caching.StackExchangeRedis</span><br></pre></td></tr></table></figure><p>é…ç½®redis</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">builder.Services.AddStackExchangeRedisCache(options =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    options.Configuration= <span class="string">&quot;127.0.0.1:6379&quot;</span>;</span><br><span class="line">    options.InstanceName = <span class="string">&quot;XIAN_&quot;</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">readonly</span> IMemoryCache memoryCache;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">readonly</span> ILogger&lt;TestController&gt; logger;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">readonly</span> IMemoryCacheHelper memoryCacheHelper;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">readonly</span> IDistributedCache distCache;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">TestController</span>(<span class="params">IMemoryCache memoryCache, ILogger&lt;TestController&gt; logger, IMemoryCacheHelper memoryCacheHelper, IDistributedCache distCache</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">this</span>.memoryCache = memoryCache;</span><br><span class="line">    <span class="keyword">this</span>.logger = logger;</span><br><span class="line">    <span class="keyword">this</span>.memoryCacheHelper = memoryCacheHelper;</span><br><span class="line">    <span class="keyword">this</span>.distCache = distCache;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[<span class="meta">HttpGet </span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;ActionResult&lt;Book?&gt;&gt; Test2(<span class="built_in">long</span> id)</span><br><span class="line">&#123;</span><br><span class="line">    Book? book;</span><br><span class="line">    <span class="built_in">string</span>? s= <span class="keyword">await</span> distCache.GetStringAsync(<span class="string">&quot;Book&quot;</span> + id);</span><br><span class="line">    <span class="keyword">if</span>(s == <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        book = <span class="keyword">await</span> MyDbContext.GetBookByIdAsync(id);</span><br><span class="line">       <span class="keyword">await</span> distCache.SetStringAsync(<span class="string">&quot;Book&quot;</span> + id,JsonSerializer.Serialize(book));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        book = JsonSerializer.Deserialize&lt;Book?&gt;(s);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (book == <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> NotFound(<span class="string">&quot;ä¸å­˜åœ¨&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> book;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œ<br><img src="/img%5CWEBAPI%5C11.png"></p><p>ä½¿ç”¨RedisdesktopæŸ¥çœ‹,è½¬æ¢jsonæ ¼å¼<br><img src="/img%5CWEBAPI%5C10.png"></p><h3 id="å°è£…åˆ†å¸ƒå¼ç¼“å­˜æ“ä½œçš„å¸®åŠ©ç±»"><a href="#å°è£…åˆ†å¸ƒå¼ç¼“å­˜æ“ä½œçš„å¸®åŠ©ç±»" class="headerlink" title="å°è£…åˆ†å¸ƒå¼ç¼“å­˜æ“ä½œçš„å¸®åŠ©ç±»"></a>å°è£…åˆ†å¸ƒå¼ç¼“å­˜æ“ä½œçš„å¸®åŠ©ç±»</h3><p>è§£å†³é›ªå´©ç¼“å­˜é—®é¢˜</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">builder.Services.AddScoped&lt;IDistributedCacheHelper, DistributedCacheHelper&gt;();</span><br></pre></td></tr></table></figure><p>æ³¨å…¥æœåŠ¡</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">readonly</span> IMemoryCache memoryCache;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">readonly</span> ILogger&lt;TestController&gt; logger;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">readonly</span> IMemoryCacheHelper memoryCacheHelper;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">readonly</span> IDistributedCache distCache;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">readonly</span> IDistributedCacheHelper distributedCacheHelper;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">TestController</span>(<span class="params">IMemoryCache memoryCache, ILogger&lt;TestController&gt; logger, IMemoryCacheHelper memoryCacheHelper, IDistributedCache distCache, IDistributedCacheHelper distributedCacheHelper</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">this</span>.memoryCache = memoryCache;</span><br><span class="line">    <span class="keyword">this</span>.logger = logger;</span><br><span class="line">    <span class="keyword">this</span>.memoryCacheHelper = memoryCacheHelper;</span><br><span class="line">    <span class="keyword">this</span>.distCache = distCache;</span><br><span class="line">    <span class="keyword">this</span>.distributedCacheHelper = distributedCacheHelper;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">HttpGet</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">async</span> Task&lt;ActionResult&lt;Book?&gt;&gt; Test3(<span class="built_in">long</span> id)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> book = <span class="keyword">await</span> distributedCacheHelper.GetOrCreateAsync(<span class="string">&quot;Book&quot;</span> + id, <span class="keyword">async</span> (e) =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        e.SlidingExpiration = TimeSpan.FromSeconds(<span class="number">5</span>); <span class="comment">// è®¾ç½®æ»‘åŠ¨è¿‡æœŸæ—¶é—´</span></span><br><span class="line">        <span class="keyword">var</span> book = <span class="keyword">await</span> MyDbContext.GetBookByIdAsync(id);</span><br><span class="line">        <span class="keyword">return</span> book;</span><br><span class="line">    &#125;,<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (book == <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> NotFound(<span class="string">&quot;ä¸å­˜åœ¨&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> book;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> EF Core </tag>
            
            <tag> ASP.NET Core </tag>
            
            <tag> Entity Framework Core </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vueå¿«é€Ÿä¸Šæ‰‹äºŒ</title>
      <link href="/2025/04/11/vue/Vue3-2/"/>
      <url>/2025/04/11/vue/Vue3-2/</url>
      
        <content type="html"><![CDATA[<h1 id="ç”Ÿå‘½å‘¨æœŸ"><a href="#ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸ"></a>ç”Ÿå‘½å‘¨æœŸ</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class=&quot;person&quot;&gt;</span><br><span class="line">        &lt;h2&gt;å½“å‰æ±‚å’Œä¸ºï¼š&#123;&#123;sum&#125;&#125;&lt;/h2&gt;</span><br><span class="line">        &lt;button @click=&quot;add&quot;&gt;ç‚¹å‡»&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup&gt;</span><br><span class="line">defineOptions(&#123; name: &#x27;person5&#x27; &#125;)</span><br><span class="line">import &#123; ref ,onBeforeMount,onMounted,onBeforeUpdate, onUpdated,onBeforeUnmount,onUnmounted&#125; from &#x27;vue&#x27;</span><br><span class="line">//æ•°æ®</span><br><span class="line">let sum = ref(0)</span><br><span class="line"></span><br><span class="line">//æ–¹æ³•</span><br><span class="line">function add() &#123;</span><br><span class="line">    sum.value+=1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//åˆ›å»º</span><br><span class="line">console.log(&#x27;åˆ›å»º&#x27;)</span><br><span class="line"></span><br><span class="line">//æŒ‚è½½å‰</span><br><span class="line">onBeforeMount(() =&gt; &#123;</span><br><span class="line">    console.log(&#x27;æŒ‚è½½å‰&#x27;)</span><br><span class="line">&#125;)</span><br><span class="line">//æŒ‚è½½å®Œæ¯•</span><br><span class="line">onMounted(() =&gt; &#123;</span><br><span class="line">    console.log(&#x27;æŒ‚è½½å®Œæ¯•&#x27;)</span><br><span class="line">&#125;)</span><br><span class="line">//æ›´æ–°å‰</span><br><span class="line">onBeforeUpdate(() =&gt; &#123;</span><br><span class="line">    console.log(&#x27;æ›´æ–°å‰&#x27;)</span><br><span class="line">&#125;)</span><br><span class="line">//æ›´æ–°å®Œæ¯•</span><br><span class="line">onUpdated(() =&gt; &#123;</span><br><span class="line">    console.log(&#x27;æ›´æ–°å®Œæ¯•&#x27;)</span><br><span class="line">&#125;)</span><br><span class="line">//å¸è½½å‰</span><br><span class="line">onBeforeUnmount(() =&gt; &#123;</span><br><span class="line">    console.log(&#x27;å¸è½½å‰&#x27;)</span><br><span class="line"> &#125;)</span><br><span class="line">//å¸è½½å®Œæ¯•</span><br><span class="line">onUnmounted(() =&gt; &#123;</span><br><span class="line">    console.log(&#x27;å¸è½½å®Œæ¯•&#x27;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.person&#123;</span><br><span class="line">    background-color: aqua;</span><br><span class="line">    box-shadow: 0 0 10px;</span><br><span class="line">    border-radius: 10px;</span><br><span class="line">    padding:20px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;Preson5 v-if=&quot;isShow&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup&gt;</span><br><span class="line">defineOptions(&#123; name:&#x27;you&#x27;&#125;)</span><br><span class="line">import Preson5 from &#x27;./components/Preson5.vue&#x27;;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">let isShow=ref(true)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="è·¯ç”±"><a href="#è·¯ç”±" class="headerlink" title="è·¯ç”±"></a>è·¯ç”±</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm i axios</span><br><span class="line">npm i vue-router</span><br></pre></td></tr></table></figure><p>1.app.vue</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;div class=&quot;app&quot;&gt;</span><br><span class="line">    &lt;h2&gt;Vueè·¯ç”±æµ‹è¯•&lt;/h2&gt;</span><br><span class="line">    &lt;div class=&quot;navigate&quot;&gt;</span><br><span class="line">        &lt;RouterLink to=&quot;/home&quot;active-class=&quot;you&quot;&gt;é¦–é¡µ&lt;/RouterLink&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;div class=&quot;main-content&quot;&gt;</span><br><span class="line">        &lt;RouterView&gt;&lt;/RouterView&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup&gt;</span><br><span class="line">import &#123; RouterView,RouterLink &#125; from &#x27;vue-router&#x27;;</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.navigate a.you&#123;</span><br><span class="line">    background-color: aqua;</span><br><span class="line">    box-shadow: 0 0 10px;</span><br><span class="line">    border-radius: 10px;</span><br><span class="line">    padding:20px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><p>2.index.ts</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åˆ›å»ºä¸€ä¸ªè·¯ç”±å™¨ï¼Œå¹¶æš´éœ²å‡ºå»</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¬¬ä¸€æ­¥ï¼šå¼•å…¥createRouter</span></span><br><span class="line"><span class="keyword">import</span> &#123;createRouter,createWebHistory&#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&#x27;@/components/Home.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¬¬äºŒæ­¥Lï¼šåˆ›å»ºè·¯ç”±å™¨</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123;</span><br><span class="line">    <span class="attr">history</span>:<span class="title function_">createWebHistory</span>(),</span><br><span class="line">    <span class="attr">routes</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">path</span>: <span class="string">&#x27;/home&#x27;</span>,</span><br><span class="line">            <span class="attr">component</span>:<span class="title class_">Home</span></span><br><span class="line">       &#125; </span><br><span class="line">    ]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//æš´éœ²å‡ºå»router</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure><p>3.Home.vue</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class=&quot;home&quot;&gt;hksjflasfjlsa&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><p>4.main.ts</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å¼•å…¥createAppç”¨äºåˆ›å»ºåº”ç”¨</span></span><br><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span></span><br><span class="line"><span class="comment">//å¼•å…¥Appæ ¹ç»„ä»¶</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"><span class="comment">//å¼•å…¥è·¯ç”±å™¨</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&quot;./router&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ›å»ºä¸€ä¸ªåº”ç”¨</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>)</span><br><span class="line"><span class="comment">//ä½¿ç”¨è·¯ç”±å™¨</span></span><br><span class="line">app.<span class="title function_">use</span>(router)</span><br><span class="line"><span class="comment">//æŒ‚åœ¨æ•´ä¸ªåº”ç”¨åˆ°appå®¹å™¨ä¸­</span></span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Vue3 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vueå¿«é€Ÿä¸Šæ‰‹ä¸€</title>
      <link href="/2025/04/10/vue/Vue3/"/>
      <url>/2025/04/10/vue/Vue3/</url>
      
        <content type="html"><![CDATA[<h1 id="åˆ›å»ºVue3å·¥ç¨‹"><a href="#åˆ›å»ºVue3å·¥ç¨‹" class="headerlink" title="åˆ›å»ºVue3å·¥ç¨‹"></a>åˆ›å»ºVue3å·¥ç¨‹</h1><p>åˆ›å»ºä¸€ä¸ªVueåº”ç”¨ï¼Œç¡®ä¿å®‰è£…äº†Node.js</p><p>1.åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm create vue@latest</span><br></pre></td></tr></table></figure><p><img src="/img%5Cjs%5Cvue.png"></p><p><img src="/img%5Cjs%5Cvue2.png"></p><blockquote><p>åœ¨ç»ˆç«¯ï¼šnpm i ä¼šæŠŠæ‰€æœ‰è¦ç”¨çš„åŒ…éƒ½ä¸‹è½½å¥½</p></blockquote><p>é€šè¿‡package.jsonæ–‡ä»¶ï¼Œåœ¨ç»ˆç«¯å‘½ä»¤è¡Œä¸­è¾“å…¥ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run dev</span><br></pre></td></tr></table></figure><p>å¯åŠ¨é¡¹ç›®</p><p><img src="/img%5Cjs%5Cvue3.png"></p><h2 id="ç¼–å†™APPç»„ä»¶"><a href="#ç¼–å†™APPç»„ä»¶" class="headerlink" title="ç¼–å†™APPç»„ä»¶"></a>ç¼–å†™APPç»„ä»¶</h2><p>åˆ é™¤åŸæ¥çš„srcæ–‡ä»¶å¤¹ï¼Œæ–°å»ºä¸€ä¸ªsrcæ–‡ä»¶å¤¹,å®ç°ä¸€ä¸ªå°æ•ˆæœã€‚<br>1.åœ¨æ–‡ä»¶å¤¹ä¸­åˆ›å»º<code>main.ts</code>å’Œ<code>App.vue</code>ã€‚<br>2.åœ¨<code>main.ts</code>å¼•å…¥createApp,Appæ ¹ç»„ä»¶</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å¼•å…¥createAppç”¨äºåˆ›å»ºåº”ç”¨</span></span><br><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span></span><br><span class="line"><span class="comment">//å¼•å…¥Appæ ¹ç»„ä»¶</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">createApp</span>(<span class="title class_">App</span>).<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure><p>3.ç¼–å†™</p><blockquote><p>.vueé‡Œé¢è¦å†™ä¸‰ç§æ ‡ç­¾ï¼š&lt;template&gt;â€“htmlâ€“&lt;&#x2F;templategt&gt;&lt;script&gt;â€“jsâ€“&lt;&#x2F;script&gt;lt;style&gt;&lt;&#x2F;style&gt;</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;div class=&quot;cn&quot;&gt;YOUXIANYU&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot;&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">    name:&#x27;App&#x27; //ç»„ä»¶å</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">.cn&#123;</span><br><span class="line">   background-color: blueviolet;</span><br><span class="line">   box-shadow:0 0 10px;</span><br><span class="line">   border-radius: 10px;</span><br><span class="line">   padding: 20px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt; </span><br></pre></td></tr></table></figure><p><img src="/img%5Cjs%5Cvue4.png"></p><h1 id="Vue3æ ¸å¿ƒè¯­æ³•"><a href="#Vue3æ ¸å¿ƒè¯­æ³•" class="headerlink" title="Vue3æ ¸å¿ƒè¯­æ³•"></a>Vue3æ ¸å¿ƒè¯­æ³•</h1><h2 id="CompositionAPI"><a href="#CompositionAPI" class="headerlink" title="CompositionAPI"></a>CompositionAPI</h2><h3 id="setup"><a href="#setup" class="headerlink" title="setup"></a>setup</h3><p>setupæ˜¯Vue3ä¸­ä¸€ä¸ªæ–°çš„é…ç½®é¡¹ï¼Œå€¼æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæ˜¯Composition APIâ€œè¡¨æ¼”çš„èˆå°â€ï¼Œç»„ä»¶ä¸­æ‰€ç”¨åˆ°çš„ï¼šæ•°æ®ã€æ–¹æ³•ã€è®¡ç®—å±æ€§ã€ç›‘è§†Â·Â·Â·ç­‰ç­‰ï¼Œå†›é…ç½®åœ¨setupä¸­ã€‚</p><p>ç‰¹ç‚¹ï¼š<br>setupå‡½æ•°è¿”å›çš„å¯¹è±¡ä¸­çš„å†…å®¹ï¼Œå¯ç›´æ¥åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨ã€‚<br>setupä¸­è®¿é—®thisæ˜¯undefinedã€‚<br>setupå‡½æ•°ä¼šåœ¨beforeCreateä¹‹å‰è°ƒç”¨ï¼Œå®ƒæ˜¯â€œé¢†å…ˆâ€æ‰€æœ‰é’©å­æ‰§è¡Œçš„ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;div class=&quot;person&quot;&gt;</span><br><span class="line">&lt;h2&gt;å§“åï¼š&#123;&#123;name&#125;&#125;&lt;/h2&gt;</span><br><span class="line">&lt;h3&gt;å¹´é¾„ï¼š&#123;&#123;age&#125;&#125;&lt;/h3&gt;</span><br><span class="line">&lt;button @click=&quot;changName&quot;class=&quot;cn&quot;&gt;æ›´æ”¹å§“å&lt;/button&gt;</span><br><span class="line">&lt;button @click=&quot;changage&quot;class=&quot;cn&quot;&gt;æ›´æ”¹å¹´é¾„&lt;/button&gt;</span><br><span class="line">&lt;button @click=&quot;showTel&quot;class=&quot;cn&quot;&gt;è·å–è”ç³»æ–¹å¼&lt;/button&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot;&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">    name: &#x27;Person&#x27;,</span><br><span class="line">    //ç”Ÿå‘½å‘¨æœŸ</span><br><span class="line">    beforeCreate() &#123;</span><br><span class="line">        console.log(&#x27;deforeCreate&#x27;)</span><br><span class="line">    &#125;,</span><br><span class="line">    setup() &#123;</span><br><span class="line">        //æ•°æ®</span><br><span class="line">        let name = &#x27;YOUXIANYU&#x27; //æ³¨æ„æ­¤æ—¶çš„nameä¸æ˜¯å“åº”å¼çš„</span><br><span class="line">        let age = 19 //æ³¨æ„æ­¤æ—¶çš„ageä¸æ˜¯å“åº”å¼çš„</span><br><span class="line">        let tel = &#x27;14292369230&#x27; //æ³¨æ„æ­¤æ—¶çš„telä¸æ˜¯å“åº”å¼çš„</span><br><span class="line"></span><br><span class="line">        //æ–¹æ³•</span><br><span class="line">        function changName() &#123;</span><br><span class="line">            name=&#x27;youxianyu&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">        function changage() &#123;</span><br><span class="line">            age+=1</span><br><span class="line">        &#125;</span><br><span class="line">        function showTel() &#123;</span><br><span class="line">            alert(tel)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return &#123;name,age,changName,changage,showTel&#125;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">.person&#123;</span><br><span class="line">    background-color: burlywood;</span><br><span class="line">    box-shadow: 0 0 10px;</span><br><span class="line">    border-radius: 10px;</span><br><span class="line">    padding:20px;</span><br><span class="line">&#125;</span><br><span class="line">.cn&#123;</span><br><span class="line">    margin-right: 10px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><p>setupè¿”å›å€¼ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªæ¸²æŸ“å‡½æ•°</p><p>setupè¯­æ³•ç³–</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;script lang=&quot;ts&quot; setup&gt;</span><br><span class="line">defineOptions(&#123; name: &#x27;Person&#x27; &#125;)</span><br><span class="line">        //æ•°æ®</span><br><span class="line">        let name = &#x27;YOUXIANYU&#x27; //æ³¨æ„æ­¤æ—¶çš„nameä¸æ˜¯å“åº”å¼çš„</span><br><span class="line">        let age = 19 //æ³¨æ„æ­¤æ—¶çš„ageä¸æ˜¯å“åº”å¼çš„</span><br><span class="line">        let tel = &#x27;14292369230&#x27; //æ³¨æ„æ­¤æ—¶çš„telä¸æ˜¯å“åº”å¼çš„</span><br><span class="line"></span><br><span class="line">        //æ–¹æ³•</span><br><span class="line">        function changName() &#123;</span><br><span class="line">            name=&#x27;youxianyu&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">        function changage() &#123;</span><br><span class="line">            age+=1</span><br><span class="line">        &#125;</span><br><span class="line">        function showTel() &#123;</span><br><span class="line">            alert(tel)</span><br><span class="line">        &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="refï¼šåŸºæœ¬ç±»å‹çš„å“åº”å¼æ•°æ®"><a href="#refï¼šåŸºæœ¬ç±»å‹çš„å“åº”å¼æ•°æ®" class="headerlink" title="refï¼šåŸºæœ¬ç±»å‹çš„å“åº”å¼æ•°æ®"></a>refï¼šåŸºæœ¬ç±»å‹çš„å“åº”å¼æ•°æ®</h3><p>ä½œç”¨ï¼šå®šä¹‰å“åº”å¼å˜é‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;script lang=&quot;ts&quot; setup&gt;</span><br><span class="line">defineOptions(&#123; name: &#x27;Person&#x27; &#125;)</span><br><span class="line">import &#123;ref&#125; from &#x27;vue&#x27;</span><br><span class="line">        //æ•°æ®</span><br><span class="line">        let name = ref(&#x27;YOUXIANYU&#x27;) //æ³¨æ„æ­¤æ—¶çš„nameä¸æ˜¯å“åº”å¼çš„</span><br><span class="line">        let age = ref(19)//æ³¨æ„æ­¤æ—¶çš„ageä¸æ˜¯å“åº”å¼çš„</span><br><span class="line">        let tel = &#x27;14292369230&#x27; //æ³¨æ„æ­¤æ—¶çš„telä¸æ˜¯å“åº”å¼çš„</span><br><span class="line"></span><br><span class="line">        //æ–¹æ³•</span><br><span class="line">        function changName() &#123;</span><br><span class="line">            name.value=&#x27;youxianyu&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">        function changage() &#123;</span><br><span class="line">            age.value+=1</span><br><span class="line">        &#125;</span><br><span class="line">        function showTel() &#123;</span><br><span class="line">            alert(tel)</span><br><span class="line">        &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="å¯¹è±¡ç±»å‹çš„å“åº”å¼æ•°æ®"><a href="#å¯¹è±¡ç±»å‹çš„å“åº”å¼æ•°æ®" class="headerlink" title="å¯¹è±¡ç±»å‹çš„å“åº”å¼æ•°æ®"></a>å¯¹è±¡ç±»å‹çš„å“åº”å¼æ•°æ®</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class=&quot;preson&quot;&gt;</span><br><span class="line">        &lt;h1&gt;ä¸€äºº&#123;&#123;car.brand&#125;&#125;,ä»·å€¼&#123;&#123;car.price&#125;&#125;å…ƒ&lt;/h1&gt;</span><br><span class="line">        &lt;button @click=&quot;changePrice&quot; class=&quot;on&quot;&gt;ä¿®æ”¹äººç‰©ä»·æ ¼&lt;/button&gt;</span><br><span class="line">        &lt;br&gt;</span><br><span class="line">        &lt;ul&gt;</span><br><span class="line">            &lt;li v-for=&quot;g in games&quot;:key=&quot;g.id&quot;&gt;&#123;&#123;g.name&#125;&#125;&lt;/li&gt;</span><br><span class="line">        &lt;/ul&gt;</span><br><span class="line">        &lt;button @click=&quot;changeFirstGame&quot;&gt;ä¿®æ”¹ç¬¬ä¸€ä¸ªæ¸¸æˆåå­—&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup&gt;</span><br><span class="line">defineOptions(&#123; name: &#x27;preson&#x27; &#125;)</span><br><span class="line">import &#123; reactive &#125; from &#x27;vue&#x27;</span><br><span class="line">//æ•°æ®</span><br><span class="line">let car = reactive(&#123; brand: &#x27;almango&#x27;, price: 10 &#125;)</span><br><span class="line">let games = reactive([&#123; id: &#x27;hsadfdskjfds&#x27;, name: &#x27;è§£é‡Šå°±æ˜¯æ©é¥°&#x27; &#125;,</span><br><span class="line">&#123;id:&#x27;hsadfdskjfds&#x27;,name:&#x27;æ©é¥°å°±æ˜¯&#x27;&#125;,&#123;id:&#x27;hsadfdskjfds&#x27;,name:&#x27;äº‹å®&#x27;&#125;</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">//æ–¹æ³•</span><br><span class="line">function changePrice() &#123;</span><br><span class="line">    car.price+=10</span><br><span class="line">&#125;</span><br><span class="line">function changeFirstGame() &#123;</span><br><span class="line">    games[0].name=&#x27;å°±æ˜¯ä¸ªjb&#x27;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>refå¯¹æ¯”reactive</p><p>å®è§‚è§’åº¦ï¼š<br>1.refç”¨æ¥å®šä¹‰ï¼šåŸºæœ¬ç±»å‹æ•°æ®ã€å¯¹è±¡ç±»å‹æ•°æ®ï¼›<br>2.reactiveç”¨æ¥å®šä¹‰ï¼šå¯¹è±¡ç±»å‹æ•°æ®ã€‚</p><p>åŒºåˆ«ï¼š<br>1.refåˆ›å»ºçš„å˜é‡å¿…é¡»ä½¿ç”¨.value<br>2.reactiveé‡æ–°åˆ†é…ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œä¼šå¤±å»å“åº”å¼</p><p>ä½¿ç”¨è§„åˆ™ï¼š<br>1.è‹¥éœ€è¦ä¸€ä¸ªåŸºæœ¬ç±»å‹çš„å“åº”æ•°æ®ï¼Œå¿…é¡»ä½¿ç”¨refã€‚<br>2.è‹¥éœ€è¦ä¸€ä¸ªå“åº”å¼å¯¹è±¡ï¼Œå±‚çº§ä¸æ·±ï¼Œrefã€reactiveéƒ½å¯ä»¥ã€‚<br>3.è‹¥éœ€è¦ä¸€ä¸ªå“åº”å¼å¯¹è±¡ï¼Œä¸”å±‚çº§è¾ƒæ·±ï¼Œæ¨èä½¿ç”¨reactiveã€‚</p><h3 id="roReftä¸toRef"><a href="#roReftä¸toRef" class="headerlink" title="roReftä¸toRef"></a>roReftä¸toRef</h3><p>ä½œç”¨ï¼šå°†ä¸€ä¸ªå“åº”å¼å¯¹è±¡çš„æ¯ä¸€ä¸ªå±æ€§ï¼Œè½¬æ¢ä¸ºrefå¯¹è±¡ã€‚<br>toRefsä¸toRefåŠŸèƒ½ä¸€è‡´ï¼Œä½†toRefså¯ä»¥æ‰¹é‡è½¬æ¢ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;script lang=&quot;ts&quot; setup&gt;</span><br><span class="line">defineOptions(&#123; name: &#x27;preson2&#x27; &#125;)</span><br><span class="line">import &#123; reactive, toRefs &#125; from &#x27;vue&#x27;;</span><br><span class="line"></span><br><span class="line">//æ•°æ®</span><br><span class="line">let preson = reactive(&#123;</span><br><span class="line">    name: &#x27;youxianyu&#x27;,</span><br><span class="line">    age:19</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">let &#123;name,age&#125;=toRefs(preson)</span><br><span class="line"></span><br><span class="line">function changeName() &#123;</span><br><span class="line">    name.value+=&#x27;~&#x27;</span><br><span class="line">&#125;</span><br><span class="line">function changeage() &#123;</span><br><span class="line">    age.value+=1</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="computedè®¡ç®—å±æ€§"><a href="#computedè®¡ç®—å±æ€§" class="headerlink" title="computedè®¡ç®—å±æ€§"></a>computedè®¡ç®—å±æ€§</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class=&quot;preson3&quot;&gt;</span><br><span class="line">        å§“ï¼š&lt;input type=&quot;text&quot; v-model=&quot;firstName&quot;&gt;&lt;br&gt;</span><br><span class="line">        åï¼š&lt;input type=&quot;text&quot; v-model=&quot;lastName&quot;&gt;&lt;br&gt;\&lt;button @click=&quot;changeFullName&quot;&gt;ç‚¹å‡»&lt;/button&gt;</span><br><span class="line">        å…¨åï¼š&lt;span&gt;&#123;&#123;fullName&#125;&#125;&lt;/span&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup&gt;</span><br><span class="line">defineOptions(&#123; name: &#x27;preson3&#x27; &#125;)</span><br><span class="line">import &#123;ref,computed&#125; from &#x27;vue&#x27;;</span><br><span class="line">let firstName = ref(&#x27;YOU&#x27;)</span><br><span class="line">let lastName = ref(&#x27;XIANYU&#x27;)</span><br><span class="line">//è¿™ä¹ˆå®šä¹‰çš„fullNameæ˜¯ä¸€ä¸ªè®¡ç®—å±æ€§ï¼Œä¸”æ˜¯åªè¯»çš„</span><br><span class="line">let fullName = computed( &#123;</span><br><span class="line">    get()&#123;</span><br><span class="line">        return firstName.value.slice(0,1).toUpperCase()+firstName.value.slice(1)+lastName.value</span><br><span class="line">    &#125;,</span><br><span class="line">    set(val) &#123;</span><br><span class="line">        const [str1, str2] = val</span><br><span class="line">        firstName.value = str1</span><br><span class="line">        lastName.value=str2</span><br><span class="line">    console.log(&#x27;set&#x27;,val )</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line">function changeFullName() &#123;</span><br><span class="line">    fullName.value =&#x27;li-ls&#x27;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h1 id="watchç›‘è§†"><a href="#watchç›‘è§†" class="headerlink" title="watchç›‘è§†"></a>watchç›‘è§†</h1><p>ä½œç”¨ï¼šç›‘è§†æ•°æ®çš„å˜åŒ–ï¼ˆå’ŒVue2ä¸­çš„watchä½œç”¨ä¸€è‡´ï¼‰<br>ç‰¹ç‚¹ï¼šVue3ä¸­çš„watchåªèƒ½ç›‘è§†ä»¥ä¸‹å››ç§æ•°æ®ï¼š<br>1.refå®šä¹‰çš„æ•°æ®ã€‚<br>2.reactiveå®šä¹‰çš„æ•°æ®ã€‚<br>3.å‡½æ•°è¿”å›ä¸€ä¸ªå€¼ã€‚<br>4.ä¸€ä¸ªåŒ…å«ä¸Šè¿°å†…å®¹çš„æ•°ç»„ã€‚</p><br><p>1.ç›‘è§†refå®šä¹‰çš„ã€åŸºæœ¬ç±»å‹ã€‘æ•°æ®ï¼šç›´æ¥å†™æ•°æ®åå³å¯ï¼Œç›‘è§†çš„æ˜¯å…¶valueå€¼çš„å˜åŒ–ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class=&quot;Person&quot;&gt;</span><br><span class="line">        &lt;h2&gt;&#123;&#123;sum&#125;&#125;&lt;/h2&gt;</span><br><span class="line">        &lt;button @click=&quot;changeSum&quot;&gt;ç‚¹å‡»&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup name=&quot;Person&quot;&gt;</span><br><span class="line">import &#123; ref, watch &#125; from &#x27;vue&#x27;;</span><br><span class="line">let sum = ref(0)</span><br><span class="line"></span><br><span class="line">function changeSum() &#123;</span><br><span class="line">    sum.value+=1</span><br><span class="line">&#125;</span><br><span class="line">//ç›‘è§†</span><br><span class="line">watch(sum, (newValue,oldValue) =&gt; &#123;</span><br><span class="line">    console.log(&#x27;sumå˜åŒ–äº†&#x27;,newValue,oldValue)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><br><p>2.ç›‘è§†refå®šä¹‰çš„ã€å¯¹è±¡ç±»å‹ã€‘æ•°æ®ï¼šç›´æ¥å†™æ•°æ®åï¼Œç›‘è§†çš„æ˜¯å¯¹è±¡çš„ã€åœ°å€å€¼ã€‘ï¼Œè‹¥æƒ³ç›‘è§†å¯¹è±¡å†…éƒ¨çš„æ•°æ®ï¼Œè¦æ‰‹åŠ¨å¼€å¯æ·±åº¦ç›‘è§†ã€‚</p><blockquote><p>è‹¥ä¿®æ”¹çš„æ˜¯refå®šä¹‰çš„å¯¹è±¡ä¸­çš„å±æ€§ï¼ŒnewValueå’ŒoldValueéƒ½æ˜¯æ–°å€¼ï¼Œå› ä¸ºå®ƒä»¬æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚<br>è‹¥ä¿®æ”¹æ•´ä¸ªrefå®šä¹‰çš„å¯¹è±¡ï¼ŒnewValueæ˜¯æ–°å€¼ï¼ŒoldValueæ˜¯æ—§å€¼ï¼Œå› ä¸ºä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡äº†ã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">watch(preson,(newValue,oldValue)=&gt;&#123;</span><br><span class="line">    console.log(newValue,oldValue)</span><br><span class="line">&#125;,&#123;deep:true&#125;)</span><br></pre></td></tr></table></figure><br><p>3.ç›‘è§†reactiveå®šä¹‰çš„ã€å¯¹è±¡ç±»å‹ã€‘æ•°æ®ï¼Œä¸”é»˜è®¤å¼€å¯äº†æ·±åº¦ç›‘è§†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">watch(person,(newValue,oldValue)=&gt;&#123;</span><br><span class="line">    console.log(newValue,oldValue)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><br>4.ç›‘è§†refæˆ–reactiveå®šä¹‰çš„ã€å¯¹è±¡ç±»å‹ã€‘æ•°æ®ä¸­çš„æŸä¸ªå±æ€§ã€‚<blockquote><p>è‹¥è¯¥å±æ€§å€¼ä¸æ˜¯ã€å¯¹è±¡ç±»å‹ã€‘ï¼Œéœ€è¦å†™æˆå‡½æ•°å½¢å¼ã€‚<br>è‹¥è¯¥å±æ€§å€¼ä¾ç„¶æ˜¯ã€å¯¹è±¡ç±»å‹ã€‘ï¼Œå¯ç›´æ¥ç¼–ï¼Œä¹Ÿå¯å†™æˆå‡½æ•°ï¼Œä¸è¿‡å»ºè®®å†™æˆå‡½æ•°</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div class=&quot;person&quot;&gt;</span><br><span class="line">        &lt;h2&gt;å§“åï¼š&#123;&#123;person.name&#125;&#125;&lt;/h2&gt;</span><br><span class="line">        &lt;h2&gt;å¹´é¾„ï¼š&#123;&#123;person.age&#125;&#125;&lt;/h2&gt;</span><br><span class="line">        &lt;h2&gt;æ±½è½¦ï¼š&#123;&#123;person.car.c1&#125;&#125;\&#123;&#123;person.car.c2&#125;&#125;&lt;/h2&gt;</span><br><span class="line">        &lt;button @click=&quot;changeName&quot;&gt;ä¿®æ”¹åå­—&lt;/button&gt;</span><br><span class="line">        &lt;button @click=&quot;changeage&quot;&gt;ä¿®æ”¹å¹´é¾„&lt;/button&gt;</span><br><span class="line">        &lt;button @click=&quot;changec1&quot;&gt;ä¿®æ”¹ç¬¬ä¸€è¾†è½¦&lt;/button&gt;</span><br><span class="line">        &lt;button @click=&quot;changec2&quot;&gt;ä¿®æ”¹ç¬¬äºŒè¾†è½¦&lt;/button&gt;</span><br><span class="line">        &lt;button @click=&quot;changeCar&quot;&gt;ä¿®æ”¹æ•´è¾†è½¦&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;script lang=&quot;ts&quot; setup&gt;</span><br><span class="line">defineOptions(&#123; name: &#x27;person5&#x27; &#125;)</span><br><span class="line">import &#123; reactive,watch &#125; from &#x27;vue&#x27;;</span><br><span class="line"></span><br><span class="line">//æ•°æ®</span><br><span class="line">let person = reactive(&#123;</span><br><span class="line">    name: &#x27;youxianyu&#x27;,</span><br><span class="line">    age: 19,</span><br><span class="line">    car: &#123;</span><br><span class="line">        c1:&#x27;å¥”é©°&#x27;,</span><br><span class="line">        c2:&#x27;å®é©¬&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">//æ–¹æ³•</span><br><span class="line">function changeName() &#123;</span><br><span class="line">    person.name+=&#x27;~&#x27;</span><br><span class="line">&#125;</span><br><span class="line">function changeage() &#123;</span><br><span class="line">    person.age+=1</span><br><span class="line">&#125;</span><br><span class="line">function changec1() &#123;</span><br><span class="line">    person.car.c1=&#x27;å¥¥è¿ª&#x27;</span><br><span class="line">&#125;</span><br><span class="line">function changec2() &#123;</span><br><span class="line">    person.car.c2=&#x27;å¤§ä¼—&#x27;</span><br><span class="line">&#125;</span><br><span class="line">function changeCar() &#123;</span><br><span class="line">    person.car=&#123;</span><br><span class="line">        c1:&#x27;é›…è¿ª&#x27;,c2:&#x27;çˆ±ç›&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">watch(() =&gt; person.name, (newValue, oldValue) =&gt; &#123;</span><br><span class="line">    console.log(newValue, oldValue)</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>æ€»ç»“ï¼šç›‘è§†çš„è¦æ˜¯å¯¹è±¡é‡Œçš„å±æ€§ï¼Œé‚£ä¹ˆæœ€å¥½å†™å‡½æ•°å¼ï¼Œæ³¨æ„ç‚¹ï¼šè‹¥æ˜¯å¯¹è±¡ç›‘è§†çš„æ˜¯åœ°å€å€¼ï¼Œéœ€è¦å…³æ³¨å¯¹è±¡å†…éƒ¨ï¼Œéœ€è¦æ‰‹åŠ¨å¼€å¯æ·±åº¦ç›‘è§†ã€‚</p><br><p>5.ç›‘è§†ä¸Šè¿°çš„å¤šä¸ªæ•°æ®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">watch([()=&gt;person.name,()=&gt;person.car.c1],(newValue,oldValue)=&gt;&#123;</span><br><span class="line">    console.log(newValue,oldValue)</span><br><span class="line">&#125;,&#123;deep:ture&#125;)</span><br></pre></td></tr></table></figure><h3 id="watchRffect"><a href="#watchRffect" class="headerlink" title="watchRffect"></a>watchRffect</h3><p>ç«‹å³è¿è¡Œä¸€ä¸ªå‡½æ•°ï¼ŒåŒæ—¶å“åº”å¼åœ°è¿½è¸ªå…¶ä¾èµ–ï¼Œå¹¶åœ¨ä¾èµ–æ›´æ”¹æ—¶é‡æ–°æ‰§è¡Œè¯¥å‡½æ•°ã€‚</p><p>watchå¯¹æ¯”watchEffect<br>1.éƒ½èƒ½ç›‘å¬å“åº”å¼æ•°æ®çš„å˜åŒ–ï¼Œä¸åŒçš„æ˜¯ç›‘å¬æ•°æ®å˜åŒ–çš„æ–¹å¼ä¸åŒ<br>2.watchï¼šè¦æ˜ç¡®æŒ‡å‡ºç›‘è§†çš„æ•°æ®<br>3.watchEffectï¼šä¸åŒæ˜ç¡®æŒ‡å‡ºç›‘è§†çš„æ•°æ®ï¼ˆå‡½æ•°ä¸­ç”¨åˆ°å“ªå†™å±æ€§ï¼Œé‚£å°±ç›‘è§†å“ªäº›å±æ€§ï¼‰</p><p>éœ€æ±‚ï¼šå½“æ°´æ¸©åˆ°è¾¾60Â°ï¼Œæˆ–æ°´ä½åˆ°è¾¾80cmæ—¶ï¼Œè¯¥æœåŠ¡å™¨å‘è¯·æ±‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">watchEffect(()=&gt;&#123;</span><br><span class="line">    if(temp.value&gt;=60||height.value&gt;=80)&#123;</span><br><span class="line">        console.log(&#x27;ç»™æœåŠ¡å™¨å‘è¯·æ±‚&#x27;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="æ ‡ç­¾çš„refå±æ€§"><a href="#æ ‡ç­¾çš„refå±æ€§" class="headerlink" title="æ ‡ç­¾çš„refå±æ€§"></a>æ ‡ç­¾çš„refå±æ€§</h3><p>ä½œç”¨ï¼šç”¨äºæ³¨å†Œæ¨¡æ¿å¼•ç”¨<br>ç”¨åœ¨æ™®é€šDOMæ ‡ç­¾ä¸Šï¼Œè·å–çš„æ˜¯DOMèŠ‚ç‚¹ã€‚<br>ç”¨åœ¨ç»„ä»¶æ ‡ç­¾ä¸Šï¼Œè·å–çš„æ˜¯ç»„ä»¶å®ä¾‹å¯¹è±¡ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1 ref=&quot;title&quot;&gt;&lt;/h1&gt;</span><br></pre></td></tr></table></figure><h3 id="propsçš„ä½¿ç”¨"><a href="#propsçš„ä½¿ç”¨" class="headerlink" title="propsçš„ä½¿ç”¨"></a>propsçš„ä½¿ç”¨</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> <span class="title class_">PersonInter</span>&#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="built_in">string</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>,</span><br><span class="line">    <span class="attr">age</span>:<span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸€ä¸ªè‡ªå®šä¹‰ç±»å‹</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> person=<span class="title class_">Array</span>&lt;<span class="title class_">PersonInter</span>&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">    &lt;Preson5 a=&quot;aha&quot; :list=&quot;personList&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    import &#123; reactive &#125; from &#x27;vue&#x27;;</span><br><span class="line">    import &#123; type person &#125; from &#x27;./types&#x27;;</span><br><span class="line"></span><br><span class="line">    let personList = reactive&lt;person&gt;([</span><br><span class="line">    &#123; id: &#x27;shgslfs&#x27;, name: &#x27;shkg&#x27;, age: 12 &#125;,</span><br><span class="line">    &#123; id: &#x27;shgslfs&#x27;, name: &#x27;shkg&#x27;, age: 12 &#125;,</span><br><span class="line">    &#123; id: &#x27;shgslfs&#x27;, name: &#x27;shkg&#x27;, age: 12 &#125;</span><br><span class="line">])</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;li v-for=&quot;p in list&quot; :key=&quot;p.id&quot;&gt;&#123;&#123;p.name&#125;&#125;&#123;&#123;p.age&#125;&#125;&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import &#123;defineProps,withDeraults&#125; from &#x27;vue&#x27;</span><br><span class="line">import &#123;type Persons&#125; from &#x27;@/types&#x27;</span><br><span class="line"></span><br><span class="line">//æ¥æ”¶</span><br><span class="line">definProps([&#x27;a&#x27;,&#x27;list&#x27;])</span><br><span class="line"></span><br><span class="line">//æ¥æ”¶list+é™åˆ¶ç±»å‹</span><br><span class="line">defineProps&lt;list:Persons&gt;()</span><br><span class="line"></span><br><span class="line">//æ¥æ”¶list+é™åˆ¶ç±»å‹+é™åˆ¶å¿…è¦æ€§+æŒ‡å®šé»˜è®¤å€¼</span><br><span class="line">withDeraults(defineProps&lt;&#123;list?:Persons&#125;&gt;()),&#123;</span><br><span class="line">    list:()=&gt;[&#123;id:&#x27;hgskfs&#x27;,name:&#x27;you&#x27;,age:19&#125;]</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Vue3 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TypeScriptå¿«é€Ÿä¸Šæ‰‹</title>
      <link href="/2025/04/10/JavaScript/TypeScript/"/>
      <url>/2025/04/10/JavaScript/TypeScript/</url>
      
        <content type="html"><![CDATA[<h1 id="tscã€TypeScriptç¼–è¯‘å™¨"><a href="#tscã€TypeScriptç¼–è¯‘å™¨" class="headerlink" title="tscã€TypeScriptç¼–è¯‘å™¨"></a>tscã€TypeScriptç¼–è¯‘å™¨</h1><p>åœ¨ç»ˆç«¯å®‰è£…typescript:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i typescript -g</span><br></pre></td></tr></table></figure><p>å®‰è£…å®Œæˆåå¯ä»¥ä½¿ç”¨<code>tsc</code>å‘½ä»¤æ¥æ‰§è¡Œtypescriptçš„ç›¸å…³ä»£ç ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tsc -v  //æŸ¥çœ‹ç‰ˆæœ¬å·</span><br></pre></td></tr></table></figure><p>åœ¨vscodeæ–°å»ºä¸€ä¸ªindex.ts,è¾“å…¥ä¸€ä¸‹ä»£ç ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">a</span>: string</span><br><span class="line"><span class="keyword">let</span> <span class="attr">b</span>: number</span><br><span class="line"><span class="keyword">let</span> <span class="attr">c</span>: boolean</span><br><span class="line"></span><br><span class="line">a = <span class="string">&#x27;hello&#x27;</span></span><br><span class="line">b = <span class="number">99</span></span><br><span class="line">c = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a, b, c)</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">count</span>(<span class="params">x: number, y: number</span>): number &#123;</span><br><span class="line">    <span class="keyword">return</span> x + y</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> result = <span class="title function_">count</span>(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">srt1</span>: string </span><br><span class="line"></span><br><span class="line">srt1 = <span class="string">&#x27;youxianyu&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> srt1)</span><br></pre></td></tr></table></figure><p>ç›´æ¥ä½¿ç”¨æµè§ˆå™¨æ˜¯ä¸è®¤è¯†çš„ï¼Œéœ€è¦ç”¨<code>tsc</code>å‘½ä»¤è½¬æ¢ä¸ºjavascriptä»£ç ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tsc --watch <span class="comment">//å…¨å±€è½¬æ¢</span></span><br><span class="line">tsc --watch index.ts <span class="comment">//è½¬æ¢æŒ‡å®š.ts</span></span><br></pre></td></tr></table></figure><p><img src="/img%5Cjs%5Cts.png"></p><p>è½¬æ¢åindex.js</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&quot;use strict&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> a;</span><br><span class="line"><span class="keyword">let</span> b;</span><br><span class="line"><span class="keyword">let</span> c;</span><br><span class="line">a = <span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line">b = <span class="number">99</span>;</span><br><span class="line">c = <span class="literal">true</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a, b, c);</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">count</span>(<span class="params">x, y</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> result = <span class="title function_">count</span>(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br><span class="line"><span class="keyword">let</span> srt1;</span><br><span class="line">srt1 = <span class="string">&#x27;youxianyu&#x27;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> srt1);</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨index.js</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>index<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;./index.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æˆåŠŸ<br><img src="/img%5Cjs%5Czk.png"></p><h1 id="å¸¸ç”¨ç±»å‹"><a href="#å¸¸ç”¨ç±»å‹" class="headerlink" title="å¸¸ç”¨ç±»å‹"></a>å¸¸ç”¨ç±»å‹</h1><h3 id="any"><a href="#any" class="headerlink" title="any"></a>any</h3><p>anyçš„å«ä¹‰é‡ï¼šä»»æ„ç±»å‹ï¼Œä¸€æ—¦å°†å˜é‡ç±»å‹é™åˆ¶ä¸ºany,é‚£å°±æ„å‘³ç€æ”¾å¼ƒäº†å¯¹è¯¥å˜é‡çš„ç±»å‹æ£€æŸ¥ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">an</span>: <span class="built_in">any</span> <span class="comment">//æ˜¾ç¤º</span></span><br><span class="line"></span><br><span class="line">an = <span class="number">91</span></span><br><span class="line">an = <span class="string">&#x27;hello&#x27;</span></span><br><span class="line">an = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">as</span>: <span class="built_in">any</span> <span class="comment">//éšå¼</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">as</span> = <span class="number">92</span></span><br><span class="line"><span class="keyword">as</span> = <span class="string">&#x27;world&#x27;</span></span><br><span class="line"><span class="keyword">as</span> = <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šanyç±»å‹çš„å˜é‡ï¼Œå¯ä»¥èµ‹å€¼ç»™ä»»æ„ç±»å‹çš„å˜é‡</p><h3 id="unknown"><a href="#unknown" class="headerlink" title="unknown"></a>unknown</h3><p>unknownçš„å«ä¹‰æ˜¯ï¼šæœªçŸ¥ç±»å‹ã€‚</p><p>1.unknownå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªç±»å‹å®‰å…¨any,é€‚ç”¨äºï¼šä¸ç¡®å®šæ•°æ®çš„å…·ä½“ç±»å‹ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">un</span>: <span class="built_in">unknown</span></span><br><span class="line"></span><br><span class="line">un = <span class="number">99</span></span><br><span class="line">un = <span class="literal">false</span></span><br><span class="line">un = <span class="string">&#x27;hello&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">x</span>: <span class="built_in">string</span></span><br><span class="line">x = un  <span class="comment">//ä¸èƒ½å°†ç±»å‹â€œunknownâ€åˆ†é…ç»™ç±»å‹â€œstringâ€</span></span><br><span class="line"><span class="comment">//ä½†å¯ä»¥è¿›è¡Œç±»å‹æ£€æŸ¥</span></span><br></pre></td></tr></table></figure><p>2.unknownä¼šå¼ºåˆ¶å¼€å‘è€…åœ¨ä½¿ç”¨ä¹‹å‰è¿›è¡Œç±»å‹æ£€æŸ¥ï¼Œä»è€Œæä¾›æ›´å¼ºçš„ç±»å‹å®‰å…¨æ€§ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">un</span>: <span class="built_in">unknown</span></span><br><span class="line"></span><br><span class="line">un = <span class="number">99</span></span><br><span class="line">un = <span class="literal">false</span></span><br><span class="line">un = <span class="string">&#x27;hello&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> un === <span class="string">&#x27;string&#x27;</span>) &#123;</span><br><span class="line">    x=un</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">x = un <span class="keyword">as</span> <span class="built_in">string</span></span><br><span class="line">x=&lt;<span class="built_in">string</span>&gt;un</span><br></pre></td></tr></table></figure><p>3.è¯»å–anyç±»å‹æ•°æ®çš„ä»»ä½•å±æ€§éƒ½ä¸ä¼šæŠ¥é”™ï¼Œè€Œunknownæ­£å¥½ä¸ä¹‹ç›¸åã€‚</p><h3 id="never"><a href="#never" class="headerlink" title="never"></a>never</h3><p>neverçš„å«ä¹‰æ˜¯ï¼šä»»ä½•å€¼éƒ½ä¸æ˜¯ï¼Œç®€è€Œè¨€ä¹‹å°±æ˜¯ä¸èƒ½æœ‰å€¼ï¼ˆä»€ä¹ˆéƒ½ä¸è¡Œï¼‰<br>1.å‡ ä¹ä¸ç”¨neverå»ç›´æ¥é™åˆ¶å˜é‡ï¼Œå› ä¸ºæ²¡æœ‰æ„ä¹‰ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">a</span>: <span class="built_in">never</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ä»¥ä¸‹å¯¹açš„æ‰€æœ‰èµ‹å€¼éƒ½ä¼šæœ‰è­¦å‘Š</span></span><br><span class="line">a=<span class="number">1</span></span><br><span class="line">a=<span class="literal">true</span></span><br><span class="line">a=<span class="literal">undefined</span></span><br><span class="line">a=unll</span><br></pre></td></tr></table></figure><p>2.neverä¸€èˆ¬æ˜¯typescriptä¸»åŠ¨æ¨æ–­å‡ºæ¥çš„ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">a</span>: <span class="built_in">string</span></span><br><span class="line">a=<span class="string">&#x27;hello&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">typeof</span> a ==== <span class="string">&#x27;string&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(a.<span class="title function_">toUpperCase</span>())</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(a)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3.neverä¹Ÿå¯ç”¨äºé™åˆ¶å‡½æ•°çš„è¿”å›å€¼ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">throwError</span>(<span class="params">str: <span class="built_in">string</span></span>): <span class="built_in">never</span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;ç¨‹åºå¼‚å¸¸é€€å‡º&#x27;</span>+str)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="void"><a href="#void" class="headerlink" title="void"></a>void</h3><p>voidé€šå¸¸ç”¨äºå‡½æ•°è¿”å›å€¼å£°æ˜ï¼Œå«ä¹‰ã€å‡½æ•°ä¸è¿”å›ä»»ä½•å€¼ï¼Œè°ƒç”¨è€…ä¹Ÿä¸åº”è¯¥ä¾èµ–å…¶è¿”å›å€¼è¿›è¡Œä»»ä½•æ“ä½œã€‘</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">logMessage</span>(<span class="params">msg: <span class="built_in">string</span></span>): <span class="built_in">void</span>&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(msg)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">logMessage</span>(<span class="string">&#x27;youxianyu&#x27;</span>)</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šlogMessageå‡½æ•°æ˜¯æ²¡æœ‰æ˜¾ç¤ºè¿”å›å€¼çš„ï¼Œä½†ä¼šæœ‰ä¸€ä¸ªéšå¼è¿”å›å€¼ï¼Œå°±æ˜¯undefinedï¼›è®°ï¼šundefinedæ˜¯viodå¯ä»¥æ¥å—çš„ä¸€ç§â€œç©ºâ€ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">logMessage</span>(<span class="params">msg: <span class="built_in">string</span></span>): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(msg)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">logMessage1</span>(<span class="params">msg: <span class="built_in">string</span></span>): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(msg)</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">logMessage2</span>(<span class="params">msg: <span class="built_in">string</span></span>): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(msg)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">undefined</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ€»ç»“ï¼šè‹¥å‡½æ•°è¿”å›å€¼ç±»å‹ä¸ºvoid,é‚£ä¹ˆï¼š<br>1.ä»è¯­æ³•ä¸Šè®²ï¼šå‡½æ•°æ˜¯å¯ä»¥è¿”å›undefinedçš„ï¼Œè‡³äºæ˜¾ç¤ºè¿”å›ï¼Œè¿˜æ˜¯éšå¼è¿”å›ï¼Œè¿™éƒ½æ— æ‰€è°“ï¼<br>2.ä»è¯­ä¹‰ä¸Šè®²ï¼šå‡½æ•°è°ƒç”¨è€…ä¸åº”å…³å¿ƒå‡½æ•°è¿”å›çš„å€¼ï¼Œä¹Ÿä¸åº”ä¾èµ–è¿”å›å€¼è¿›è¡Œä»»ä½•æ“ä½œåŠæ—¶è¿”å›äº†undefinedå€¼ã€‚</p><h3 id="object"><a href="#object" class="headerlink" title="object"></a>object</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">o</span>: <span class="built_in">object</span> <span class="comment">//aèƒ½å­˜å‚¨çš„ç±»å‹æ˜¯ã€éåŸå§‹ç±»å‹ã€‘</span></span><br><span class="line"></span><br><span class="line">o = &#123;&#125;</span><br><span class="line">o = &#123; <span class="attr">name</span>: <span class="string">&#x27;tom&#x27;</span> &#125;</span><br><span class="line">o = [<span class="number">1</span>, <span class="number">35</span>, <span class="number">453</span>, <span class="number">23</span>, <span class="number">3</span>]</span><br><span class="line">o = <span class="keyword">function</span> (<span class="params"></span>) &#123; &#125;</span><br><span class="line">o = <span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&#x27;123&#x27;</span>)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123; &#125;</span><br><span class="line">o = <span class="keyword">new</span> <span class="title class_">Person</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä»¥ä¸‹ä»£ç ï¼Œæ˜¯å°†ã€åŸå§‹ç±»å‹ã€‘èµ‹ç»™a,æœ‰è­¦å‘Š</span></span><br><span class="line">a = <span class="number">1</span></span><br><span class="line">a = ture</span><br><span class="line">a = <span class="string">&#x27;you&#x27;</span></span><br><span class="line">a = <span class="literal">null</span></span><br><span class="line">a=<span class="literal">undefined</span></span><br></pre></td></tr></table></figure><p>Objecté™¤äº†undefinedå’Œnullçš„ä»»ä½•å€¼ã€‚</p><h3 id="å£°æ˜å¯¹è±¡ç±»å‹"><a href="#å£°æ˜å¯¹è±¡ç±»å‹" class="headerlink" title="å£°æ˜å¯¹è±¡ç±»å‹"></a>å£°æ˜å¯¹è±¡ç±»å‹</h3><p>1.å®é™…å¼€å‘ä¸­ï¼Œé™åˆ¶ä¸€èˆ¬å¯¹è±¡ï¼Œé€šå¸¸ä½¿ç”¨ä»¥ä¸‹å½¢å¼ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person1: &#123; name: <span class="built_in">string</span>, age?: number &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person3: &#123; name: <span class="built_in">string</span>; age?: number &#125;</span><br><span class="line"><span class="keyword">let</span> person2: &#123;</span><br><span class="line">    name: <span class="built_in">string</span>,</span><br><span class="line">    age?: number</span><br><span class="line">&#125;</span><br><span class="line">person1=&#123;name:<span class="string">&#x27;tom&#x27;</span>,age:<span class="number">19</span>&#125;</span><br></pre></td></tr></table></figure><p>2.ç´¢å¼•ç­¾åï¼šå…è®¸å®šä¹‰å¯¹è±¡å¯ä»¥å…·æœ‰ä»»æ„æ•°é‡çš„å±æ€§ï¼Œè¿™äº›å±æ€§çš„é”®å’Œç±»å‹æ˜¯å¯å˜çš„ï¼Œå¸¸ç”¨äºï¼šæè¿°ç±»å‹ä¸ç¡®å®šçš„å±æ€§ã€‚ï¼ˆå…·æœ‰åŠ¨æ€å±æ€§çš„å¯¹è±¡ï¼‰</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> person:&#123;</span><br><span class="line">    name:<span class="built_in">string</span></span><br><span class="line">    age?:number</span><br><span class="line">    [<span class="meta">key:string</span>]: any</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">person=&#123;</span><br><span class="line">    name:<span class="string">&#x27;youxianyu&#x27;</span>,</span><br><span class="line">    age:<span class="number">18</span>,</span><br><span class="line">    gender:<span class="string">&#x27;ç”·&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å£°æ˜å‡½æ•°ç±»å‹"><a href="#å£°æ˜å‡½æ•°ç±»å‹" class="headerlink" title="å£°æ˜å‡½æ•°ç±»å‹"></a>å£°æ˜å‡½æ•°ç±»å‹</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">count</span>:<span class="function">(<span class="params">a:<span class="built_in">number</span>,b:<span class="built_in">number</span></span>)=&gt;</span> <span class="built_in">number</span></span><br><span class="line">count = <span class="keyword">function</span>(<span class="params">x,y</span>)=&gt;&#123;</span><br><span class="line">    <span class="keyword">return</span> x+y</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>TypeScriptä¸­çš„&#x3D;&gt;åœ¨å‡½æ•°ç±»å‹å£°æ˜è¡¨ç¤ºå‡½æ•°ç±»å‹ï¼Œæè¿°å…¶å‚æ•°ç±»å‹å’Œè¿”å›å€¼ç±»å‹ã€‚<br>JavaScriptä¸­çš„&#x3D;&gt;æ˜¯ä¸€ç§å®šä¹‰å‡½æ•°çš„è¯­æ³•ï¼Œæ˜¯å…·ä½“çš„å‡½æ•°å®ç°ã€‚<br>å‡½æ•°ç±»å‹å£°æ˜è¿˜å¯ä»¥ä½¿ç”¨L:æ¥å£ï¼Œè‡ªå®šä¹‰ç±»å‹ç­‰æ–¹å¼ã€‚</p><h3 id="å£°æ˜æ•°ç»„ç±»å‹"><a href="#å£°æ˜æ•°ç»„ç±»å‹" class="headerlink" title="å£°æ˜æ•°ç»„ç±»å‹"></a>å£°æ˜æ•°ç»„ç±»å‹</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="attr">arr1</span>:<span class="built_in">string</span>[]</span><br><span class="line"><span class="keyword">let</span> <span class="attr">arr2</span>:<span class="title class_">Array</span>&lt;<span class="built_in">string</span>&gt; <span class="comment">//æ³›å‹</span></span><br><span class="line"></span><br><span class="line">arr1=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>]</span><br><span class="line">arr2=[<span class="string">&#x27;hello&#x27;</span>,<span class="string">&#x27;world&#x27;</span>]</span><br></pre></td></tr></table></figure><h3 id="tuple"><a href="#tuple" class="headerlink" title="tuple"></a>tuple</h3><p>å…ƒç»„ï¼ˆtubleï¼‰æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ•°ç»„ç±»å‹ï¼Œå¯ä»¥å­˜å‚¨å›ºå®šæ•°é‡çš„å…ƒç´ ï¼Œå¹¶ä¸”æ¯ä¸ªå…ƒç´ ç±»å‹æ˜¯å·²çŸ¥çš„ä¸”å¯ä»¥ä¸åŒï¼Œå…ƒç»„ç”¨äºç²¾ç¡®æè¿°ä¸€ç»„å€¼çš„ç±»å‹ï¼Œï¼Ÿè¡¨ç¤ºå¯é€‰å…ƒç´ ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç¬¬ä¸€ä¸ªå…ƒç´ å¿…é¡»æ˜¯stringç±»å‹ï¼Œç¬¬äºŒå…³å…ƒç´ æ˜¯numberç±»å‹ã€‚</span></span><br><span class="line"><span class="keyword">let</span> arr1=[<span class="built_in">string</span>,<span class="built_in">number</span>]</span><br><span class="line"><span class="comment">//ç¬¬ä¸€ä¸ªå…ƒç´ å¿…é¡»æ˜¯numberç±»å‹ï¼Œç¬¬äºŒä¸ªå…ƒç´ æ˜¯å¯é€‰çš„ï¼Œå¦‚æœå­˜åœ¨ï¼Œå¿…é¡»æ˜¯booleanç±»å‹ã€‚</span></span><br><span class="line"><span class="keyword">let</span> arr2=[<span class="built_in">number</span>,<span class="built_in">boolean</span>?]</span><br><span class="line"><span class="comment">//ç¬¬ä¸€ä¸ªå…ƒç´ å¿…é¡»æ˜¯numberç±»å‹ï¼Œåé¢çš„å…ƒç´ å¯ä»¥æ˜¯ä»»æ„æ•°é‡çš„stringç±»å‹ã€‚</span></span><br><span class="line"><span class="keyword">let</span> arr3=[<span class="built_in">number</span>,...<span class="built_in">string</span>[]]</span><br><span class="line"></span><br><span class="line">arr1=[<span class="string">&#x27;hello&#x27;</span>,<span class="number">123</span>]</span><br><span class="line">arr2=[<span class="number">100</span>,flase]</span><br><span class="line">arr2=[<span class="number">200</span>]</span><br><span class="line">arr3=[<span class="number">100</span>,<span class="string">&#x27;hello&#x27;</span>,<span class="string">&#x27;world&#x27;</span>]</span><br><span class="line">arr3=[<span class="number">100</span>]</span><br><span class="line"></span><br><span class="line">arr1=[<span class="string">&#x27;hello&#x27;</span>,<span class="number">123</span>,<span class="literal">false</span>]</span><br></pre></td></tr></table></figure><h3 id="enum"><a href="#enum" class="headerlink" title="enum"></a>enum</h3><p>æšä¸¾ï¼ˆenumï¼‰å¯ä»¥å®šä¹‰ä¸€ç»„å‘½åå¸¸é‡ï¼Œä»–èƒ½å¢å¼ºä»£ç çš„å¯è¯»æ€§ï¼Œä¹Ÿè®©ä»£ç æ›´å¥½ç»´æŠ¤ã€‚</p><p>å¦‚ä¸‹ä»£ç çš„åŠŸèƒ½æ˜¯ï¼šæ ¹æ®è°ƒç”¨walkæ—¶ä¼ å…¥çš„ä¸åŒå‚æ•°ï¼Œæ‰§è¡Œä¸åŒçš„é€»è¾‘ï¼Œå­˜åœ¨çš„é—®é¢˜æ˜¯è°ƒç”¨walkæ—¶ä¼ å‚æ—¶æ²¡æœ‰ä»»ä½•æç¤ºï¼Œç¼–ç è€…å¾ˆå®¹æ˜“å†™é”™å­—ç¬¦ä¸²å†…å®¹ï¼›å¹¶ä¸”ç”¨äºåˆ¤æ–­é€»è¾‘çš„upã€downã€leftã€rightæ˜¯è¿ç»­ä¸”ç›¸å…³çš„ä¸€ç»„å€¼ï¼Œé‚£æ­¤æ—¶å°±ç‰¹åˆ«é€‚åˆä½¿ç”¨æšä¸¾ï¼ˆenumï¼‰ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">walk</span>(<span class="params">str: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (str === <span class="string">&#x27;up&#x27;</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (str === <span class="string">&#x27;down&#x27;</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;sk&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (str === <span class="string">&#x27;left&#x27;</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;kn&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (str === <span class="string">&#x27;right&#x27;</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;kn&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">walk</span>(<span class="string">&#x27;up&#x27;</span>)</span><br><span class="line"><span class="title function_">walk</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line"><span class="title function_">walk</span>(<span class="string">&#x27;left&#x27;</span>)</span><br><span class="line"><span class="title function_">walk</span>(<span class="string">&#x27;right&#x27;</span>)</span><br></pre></td></tr></table></figure><p>1.æ•°å­—æšä¸¾<br>æ•°å­—æšä¸¾ä¸€ç§æœ€å¸¸ç”¨çš„æšä¸¾ç±»å‹ï¼Œå…¶æˆå‘˜çš„å€¼ä¼šè‡ªåŠ¨é€’å¢ï¼Œä¸”æ•°å­—æšä¸¾è¿˜å…·å¤‡åå‘æ˜ å°„çš„ç‰¹ç‚¹ï¼Œåœ¨ä¸‹é¢ä»£ç çš„æ‰“å°ä¸­ï¼Œå¯ä»¥é€šè¿‡åªæ¥è·å–å¯¹åº”çš„æšä¸¾æˆå‘˜åç§°ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">Direction</span>&#123;</span><br><span class="line">    up,</span><br><span class="line">    down,</span><br><span class="line">    left,</span><br><span class="line">    right</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">walk</span>(<span class="params">str: Direction</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (str === <span class="title class_">Direction</span>.<span class="property">up</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ok&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (str===<span class="title class_">Direction</span>.<span class="property">down</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;sk&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> () &#123;str===<span class="title class_">Direction</span>.<span class="property">left</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;kn&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (str === <span class="title class_">Direction</span>.<span class="property">right</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;kn&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">walk</span>(<span class="title class_">Direction</span>.<span class="property">down</span>)</span><br></pre></td></tr></table></figure><p>2.å­—ç¬¦ä¸²æšä¸¾</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> pirection&#123;</span><br><span class="line">    up=<span class="string">&#x27;up&#x27;</span>,</span><br><span class="line">    down=<span class="string">&#x27;down&#x27;</span>,</span><br><span class="line">    left=<span class="string">&#x27;left&#x27;</span>,</span><br><span class="line">    right=<span class="string">&#x27;right&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">dir</span>:<span class="title class_">Direction</span>=<span class="title class_">Direction</span>.<span class="property">up</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(dir)</span><br></pre></td></tr></table></figure><p>3.å¸¸é‡æšä¸¾</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">enum</span> <span class="title class_">Directions</span>&#123;</span><br><span class="line">    up,</span><br><span class="line">    down,</span><br><span class="line">    left,</span><br><span class="line">    right</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> x=<span class="title class_">Directions</span>.<span class="property">up</span>; </span><br></pre></td></tr></table></figure><h3 id="type"><a href="#type" class="headerlink" title="type"></a>type</h3><p>typeå¯ä»¥ä¸ºä»»æ„ç±»å‹åˆ›å»ºåˆ«åï¼Œè®©ä»£ç æ›´ç®€æ´ã€å¯è¯»æ€§æ›´å¼ºï¼ŒåŒæ—¶èƒ½æ›´æ–¹ä¾¿åœ°è¿›è¡Œç±»å‹å¤ç”¨å’Œæ‰©å±•ã€‚<br>1.åŸºæœ¬ç”¨æ³•<br>ç±»å‹åˆ«åä½¿ç”¨typeå…³é”®å­—ï¼Œtypeåè·Ÿç±»å‹åç§°</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> num=<span class="built_in">number</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="attr">price</span>:num</span><br><span class="line">price=<span class="number">100</span></span><br></pre></td></tr></table></figure><p>2.è”åˆç±»å‹<br>è”åˆç±»å‹æ˜¯ä¸€ç§é«˜çº§ç±»å‹ï¼Œä»–è¡¨ç¤ºä¸€ä¸ªå€¼å¯ä»¥æ˜¯å‡ ç§ä¸åŒç±»å‹ä¹‹ä¸€</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">Status</span> = <span class="built_in">number</span> | <span class="built_in">string</span></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Gender</span> = <span class="string">&#x27;ç”·&#x27;</span> | <span class="string">&#x27;å¥³&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">printstatus</span>(<span class="params"><span class="built_in">string</span> Status</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(status);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">logGender</span>(<span class="params">str:Gender</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(str)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">printstatus</span>(<span class="number">404</span>)</span><br><span class="line"><span class="title function_">printstatus</span>(<span class="string">&#x27;200&#x27;</span>)</span><br><span class="line"><span class="title function_">printstatus</span>(<span class="string">&#x27;501&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="title function_">logGender</span>(<span class="string">&#x27;ç”·&#x27;</span>)</span><br><span class="line"><span class="title function_">logGender</span>(<span class="string">&#x27;å¥³&#x27;</span>)</span><br></pre></td></tr></table></figure><p>3.äº¤å‰ç±»å‹</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">Area</span> = &#123;</span><br><span class="line">    <span class="attr">height</span>: <span class="built_in">number</span></span><br><span class="line">    <span class="attr">width</span>:<span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">Address</span> = &#123;</span><br><span class="line">    <span class="attr">num</span>: <span class="built_in">number</span></span><br><span class="line">    <span class="attr">cell</span>: <span class="built_in">number</span></span><br><span class="line">    <span class="attr">room</span>:<span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">House</span> = <span class="title class_">Area</span> &amp; <span class="title class_">Address</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">house</span>: <span class="title class_">House</span> = &#123;</span><br><span class="line">    <span class="attr">height</span>: <span class="number">100</span>,</span><br><span class="line">    <span class="attr">width</span>: <span class="number">120</span>,</span><br><span class="line">    <span class="attr">num</span>: <span class="number">3</span>,</span><br><span class="line">    <span class="attr">cell</span>: <span class="number">4</span>,</span><br><span class="line">    <span class="attr">room</span>: <span class="string">&#x27;702&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å¤ä¹ ç±»ç›¸å…³çŸ¥è¯†"><a href="#å¤ä¹ ç±»ç›¸å…³çŸ¥è¯†" class="headerlink" title="å¤ä¹ ç±»ç›¸å…³çŸ¥è¯†"></a>å¤ä¹ ç±»ç›¸å…³çŸ¥è¯†</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span> </span><br><span class="line">    <span class="attr">age</span>: <span class="built_in">number</span></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">name: <span class="built_in">string</span>, age: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">name</span> = name</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">age</span> = age</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">speak</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`æˆ‘å«ï¼š<span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>,ä»Šå¹´<span class="subst">$&#123;<span class="variable language_">this</span>.age&#125;</span>å²`</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> p1 = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&#x27;YOUXIANYU&#x27;</span>, <span class="number">19</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(p1)</span><br><span class="line">p1.<span class="title function_">speak</span>()</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Person</span>&#123;</span><br><span class="line">    <span class="attr">grade</span>: <span class="built_in">string</span></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">name: <span class="built_in">string</span>, age: <span class="built_in">number</span>, grade: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">        <span class="variable language_">super</span>(name, age)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">grade</span>=grade</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">study</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>`</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="title function_">speak</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`æˆ‘æ˜¯å­¦ç”Ÿï¼š<span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>,ä»Šå¹´<span class="subst">$&#123;<span class="variable language_">this</span>.age&#125;</span>å²<span class="subst">$&#123;<span class="variable language_">this</span>.grade&#125;</span>`</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> s1 = <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&#x27;youxianyu&#x27;</span>, <span class="number">19</span>, <span class="string">&#x27;å¤§ä¸€&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(s1)</span><br><span class="line">s1.<span class="title function_">study</span>()</span><br><span class="line">s1.<span class="title function_">study</span>()</span><br></pre></td></tr></table></figure><p>ç®€å†™</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>&#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"><span class="keyword">public</span> name:<span class="built_in">string</span>, <span class="keyword">public</span> age: <span class="built_in">number</span></span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æŠ½è±¡ç±»"><a href="#æŠ½è±¡ç±»" class="headerlink" title="æŠ½è±¡ç±»"></a>æŠ½è±¡ç±»</h3><p>æŠ½è±¡ç±»æ˜¯ä¸€ç§æ— æ³•è¢«å®ä¾‹åŒ–çš„ç±»ï¼Œä¸“é—¨ç”¨æ¥å®šä¹‰ç±»çš„ç»“æ„å’Œè¡Œä¸ºï¼Œç±»ä¸­å¯ä»¥å†™æŠ½è±¡æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥å†™å…·ä½“å®ç°ã€‚æŠ½è±¡ç±»ä¸»è¦ç”¨æ¥ä¸ºå…¶æ´¾ç”Ÿç±»æä¾›ä¸€ä¸ªåŸºç¡€ç»“æ„ï¼Œè¦æ±‚å…¶æ´¾ç”Ÿç±»å¿…é¡»å®ç°å…¶ä¸­çš„æŠ½è±¡æ–¹æ³•ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Package</span>&#123;</span><br><span class="line">    <span class="comment">//æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"><span class="keyword">public</span> weight: <span class="built_in">number</span></span>) &#123; &#125;</span><br><span class="line">    <span class="comment">//æŠ½è±¡æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">abstract</span> <span class="title function_">calculate</span>(): <span class="built_in">number</span></span><br><span class="line">    <span class="comment">//å…·ä½“æ–¹æ³•</span></span><br><span class="line">    <span class="title function_">printPackage</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.weight&#125;</span>,<span class="subst">$&#123;<span class="variable language_">this</span>.calculate()&#125;</span>`</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">StandardPackage</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Package</span>&#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">weight: <span class="built_in">number</span>, <span class="keyword">public</span> unitPrice: <span class="built_in">number</span></span>) &#123; <span class="variable language_">super</span>(weight) &#125;</span><br><span class="line">    <span class="title function_">calculate</span>(): <span class="built_in">number</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">weight</span>*<span class="variable language_">this</span>.<span class="property">unitPrice</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ExpressPackage</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Package</span>&#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">weight: <span class="built_in">number</span>, <span class="keyword">public</span> unitPrice: <span class="built_in">number</span>,</span></span><br><span class="line"><span class="params">        <span class="keyword">public</span> additional: <span class="built_in">number</span></span></span><br><span class="line"><span class="params">    </span>) &#123; <span class="variable language_">super</span>(weight) &#125;</span><br><span class="line">    <span class="title function_">calculate</span>(): <span class="built_in">number</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">weight</span> &gt; <span class="number">10</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">10</span>*<span class="variable language_">this</span>.<span class="property">unitPrice</span>+(<span class="variable language_">this</span>.<span class="property">weight</span>-<span class="number">10</span>)*<span class="variable language_">this</span>.<span class="property">additional</span></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">weight</span>*<span class="variable language_">this</span>.<span class="property">unitPrice</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> s2 = <span class="keyword">new</span> <span class="title class_">StandardPackage</span>(<span class="number">10</span>, <span class="number">50</span>)</span><br><span class="line">s2.<span class="title function_">printPackage</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> s3 = <span class="keyword">new</span> <span class="title class_">ExpressPackage</span>(<span class="number">10</span>, <span class="number">30</span>, <span class="number">7</span>)</span><br><span class="line">s3.<span class="title function_">printPackage</span>()</span><br></pre></td></tr></table></figure><p>æ€»ç»“ï¼šä½•æ—¶ä½¿ç”¨æŠ½è±¡ç±»<br>1.å®šä¹‰é€šç”¨æ¥å£ï¼šä¸ºä¸€ç»„ç›¸å…³çš„ç±»å®šä¹‰é€šç”¨çš„è¡Œä¸ºï¼ˆæ–¹æ³•æˆ–å±æ€§ï¼‰æ—¶ã€‚<br>2.æä¾›åŸºç¡€å®ç°ï¼šåœ¨æŠ½è±¡ç±»ä¸­æä¾›æŸäº›æ–¹æ³•æˆ–ä¸ºå…¶æä¾›åŸºç¡€å®ç°ï¼Œè¿™æ ·æ´¾ç”Ÿç±»å°±å¯ä»¥ç»§æ‰¿è¿™äº›å®ç°ã€‚<br>3.ç¡®ä¿å…³é”®å®ç°ï¼šå¼ºåˆ¶æ´¾ç”Ÿå®ç°ä¸€äº›å…³é”®è¡Œä¸ºã€‚<br>4.å…±äº«ä»£ç å’Œé€»è¾‘ï¼šå½“å¤šä¸ªç±»éœ€è¦å…±äº«éƒ¨åˆ†ä»£ç æ—¶ï¼ŒæŠ½è±¡ç±»å¯ä»¥é¿å…ä»£ç é‡å¤ã€‚</p><h3 id="interface"><a href="#interface" class="headerlink" title="interface"></a>interface</h3><p>å®šä¹‰ç±»ç»“æ„</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">PersonInterface</span>&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">    <span class="attr">age</span>: <span class="built_in">number</span></span><br><span class="line">    <span class="title function_">speak</span>(<span class="attr">n</span>:<span class="built_in">number</span>):<span class="built_in">void</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person1</span> <span class="keyword">implements</span> <span class="title class_">PersonInterface</span>&#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"><span class="keyword">public</span> name: <span class="built_in">string</span>, <span class="keyword">public</span> age: <span class="built_in">number</span></span>) &#123; &#125;</span><br><span class="line">    <span class="title function_">speak</span>(<span class="attr">n</span>: <span class="built_in">number</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>,<span class="subst">$&#123;<span class="variable language_">this</span>.age&#125;</span>`</span>) </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> p2 = <span class="keyword">new</span> <span class="title class_">Person1</span>(<span class="string">&#x27;youxianyu&#x27;</span>, <span class="number">19</span>)</span><br><span class="line">p2.<span class="title function_">speak</span>(<span class="number">4</span>)</span><br></pre></td></tr></table></figure><p>å®šä¹‰å¯¹è±¡ç»“æ„</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">UserInterface</span>&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">    <span class="keyword">readonly</span> <span class="attr">gender</span>: <span class="built_in">string</span></span><br><span class="line">    age?: <span class="built_in">number</span></span><br><span class="line">    <span class="attr">run</span>: <span class="function">(<span class="params">n: <span class="built_in">number</span></span>) =&gt;</span> <span class="built_in">void</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">user</span>: <span class="title class_">UserInterface</span> = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;you&#x27;</span>,</span><br><span class="line">    <span class="attr">gender</span>: <span class="string">&#x27;ç”·&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">19</span>,</span><br><span class="line">    <span class="title function_">run</span>(<span class="params">n</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;n&#125;</span>`</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®šä¹‰å‡½æ•°æ¥å£</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">CountInterface</span>&#123;</span><br><span class="line">    (<span class="attr">a</span>: <span class="built_in">number</span>,<span class="attr">b</span>: <span class="built_in">number</span>): <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">count</span>: <span class="title class_">CountInterface</span>=<span class="function">(<span class="params">x,y</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x+y</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ³›å‹"><a href="#æ³›å‹" class="headerlink" title="æ³›å‹"></a>æ³›å‹</h1><p>æ³›å‹å‡½æ•°</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> logData&lt;T&gt;(<span class="attr">data</span>: T) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">logData&lt;<span class="built_in">number</span>&gt;(<span class="number">100</span>)</span><br><span class="line">logData&lt;<span class="built_in">string</span>&gt;(<span class="string">&#x27;you&#x27;</span>)</span><br></pre></td></tr></table></figure><p>å¤šä¸ªæ³›å‹</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> logData&lt;T,U&gt;(<span class="attr">data1</span>: T,<span class="attr">data2</span>:U): T | U&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data1,data2)</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Data</span>.<span class="title function_">now</span>() % <span class="number">2</span> ? <span class="attr">data1</span>:data2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">logData&lt;<span class="built_in">number</span>,<span class="built_in">boolean</span>&gt;(<span class="number">100</span>,<span class="literal">true</span>)</span><br><span class="line">logData&lt;<span class="built_in">string</span>,<span class="built_in">number</span>&gt;(<span class="string">&#x27;you&#x27;</span>,<span class="number">666</span>)</span><br></pre></td></tr></table></figure><p>æ³›å‹æ¥å£</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">PersonInterface</span>&lt;T&gt;&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="built_in">number</span>,</span><br><span class="line">    <span class="attr">extraInfo</span>:T</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">JobInfo</span> = &#123;</span><br><span class="line">    <span class="attr">title</span>: <span class="built_in">string</span></span><br><span class="line">    <span class="attr">company</span>:<span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">p</span>: <span class="title class_">PersonInterface</span>&lt;<span class="title class_">JobInfo</span>&gt;=&#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="string">&#x27;you&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">19</span>,</span><br><span class="line">    <span class="attr">extraInfo</span>: &#123;</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&#x27;ç¨‹åºå‘˜&#x27;</span>,</span><br><span class="line">        <span class="attr">company</span>:<span class="string">&#x27;åŠ æ²¹&#x27;</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³›å‹ç±»</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>&lt;T&gt;&#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"></span></span><br><span class="line"><span class="params">        <span class="keyword">public</span> name: <span class="built_in">string</span>,</span></span><br><span class="line"><span class="params">        <span class="keyword">public</span> age: <span class="built_in">number</span>,</span></span><br><span class="line"><span class="params">        <span class="keyword">public</span> extraInfo: T</span></span><br><span class="line"><span class="params">    </span>) &#123; &#125;</span><br><span class="line">    <span class="title function_">speak</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span><span class="subst">$&#123;<span class="variable language_">this</span>.age&#125;</span>`</span>)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">extraInfo</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">JobInfo</span> = &#123;</span><br><span class="line">    <span class="attr">title</span>: <span class="built_in">string</span></span><br><span class="line">    <span class="attr">company</span>:<span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> p1 = <span class="keyword">new</span> <span class="title class_">Person</span>&lt;<span class="title class_">JobInfo</span>&gt;(<span class="string">&#x27;you&#x27;</span>, <span class="number">19</span>, &#123;<span class="attr">title</span>:<span class="string">&#x27;xian&#x27;</span>,<span class="attr">company</span>:<span class="string">&#x27;okoko&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure><h1 id="è£…é¥°å™¨"><a href="#è£…é¥°å™¨" class="headerlink" title="è£…é¥°å™¨"></a>è£…é¥°å™¨</h1><h2 id="ç±»è£…é¥°å™¨"><a href="#ç±»è£…é¥°å™¨" class="headerlink" title="ç±»è£…é¥°å™¨"></a>ç±»è£…é¥°å™¨</h2><h3 id="åŸºæœ¬è¯­æ³•"><a href="#åŸºæœ¬è¯­æ³•" class="headerlink" title="åŸºæœ¬è¯­æ³•"></a>åŸºæœ¬è¯­æ³•</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Demo</span>(<span class="params">target: <span class="built_in">Function</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(target)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Demo</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">    <span class="attr">age</span>: <span class="built_in">number</span></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">name: <span class="built_in">string</span>, age: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">name</span> = name</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">age</span>=age</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åº”ç”¨å®ä¾‹</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">CustomString</span>(<span class="params">target: <span class="built_in">Function</span></span>) &#123;</span><br><span class="line">    target.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="variable language_">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@CustomString</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">    <span class="attr">age</span>: <span class="built_in">number</span></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">name: <span class="built_in">string</span>, age: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">name</span> = name</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">age</span>=age</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> p1 = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&#x27;you&#x27;</span>, <span class="number">19</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(p1.<span class="title function_">toString</span>())</span><br></pre></td></tr></table></figure><h3 id="å…³äºæ„é€ ç±»å‹"><a href="#å…³äºæ„é€ ç±»å‹" class="headerlink" title="å…³äºæ„é€ ç±»å‹"></a>å…³äºæ„é€ ç±»å‹</h3><p>å£°æ˜æ„é€ ç±»å‹</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">Constructor</span> = <span class="keyword">new</span> (...<span class="attr">args</span>:<span class="built_in">any</span>[])=&gt;&#123;&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">test</span>(<span class="params">fn:Constructor</span>)&#123;&#125;</span><br><span class="line"><span class="title function_">test</span>(<span class="title class_">Person</span>)</span><br></pre></td></tr></table></figure><p>å£°æ˜æ„é€ ç±»å‹+æŒ‡å®šé™æ€å±æ€§</p>]]></content>
      
      
      <categories>
          
          <category> TS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> TypeScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ASP.NET Core Web APIå„ç§æŠ€æœ¯åŠé€‰æ‹©</title>
      <link href="/2025/04/08/asp.net%20core/ASP.NET%20Core%20Web%20API%E5%90%84%E7%A7%8D%E6%8A%80%E6%9C%AF%E9%80%89%E6%8B%A9/"/>
      <url>/2025/04/08/asp.net%20core/ASP.NET%20Core%20Web%20API%E5%90%84%E7%A7%8D%E6%8A%80%E6%9C%AF%E9%80%89%E6%8B%A9/</url>
      
        <content type="html"><![CDATA[<h1 id="æ§åˆ¶å™¨çˆ¶ç±»ç”¨å“ªä¸ª"><a href="#æ§åˆ¶å™¨çˆ¶ç±»ç”¨å“ªä¸ª" class="headerlink" title="æ§åˆ¶å™¨çˆ¶ç±»ç”¨å“ªä¸ª"></a>æ§åˆ¶å™¨çˆ¶ç±»ç”¨å“ªä¸ª</h1><p>æ§åˆ¶å™¨ç±»éƒ½æ˜¯ç»§æ‰¿è‡ªControllerBase,è€ŒASP.NET Core MVCé¡¹ç›®ä¸­çš„æ§åˆ¶å™¨ç±»é»˜è®¤ç»§æ‰¿è‡ªControllerã€‚Controllerç±»ç»§æ‰¿è‡ªControllerBase,Controllerç±»åœ¨ControllerBaseçš„åŸºç¡€ä¸Šå¢åŠ äº†å’Œè§†å›¾ç›¸å…³çš„æ–¹æ³•ï¼Œè€ŒWeb APIçš„æ¥å£ä¸æ¶‰åŠè§†å›¾ï¼Œå› æ­¤é™¤éè¯»è€…éœ€è¦åœ¨åŒä¸€ä¸ªæ§åˆ¶å™¨ä¸­åŒæ—¶æä¾›Web APIå’ŒMVCçš„åŠŸèƒ½ï¼Œå¦åˆ™Web APIçš„æ§åˆ¶å™¨ç±»ç»§æ‰¿è‡ªControllerBaseå³å¯ã€‚</p><h1 id="æ“ä½œæ–¹æ³•çš„å¼‚æ­¥ã€è¿”å›å€¼ã€çŠ¶æ€ç "><a href="#æ“ä½œæ–¹æ³•çš„å¼‚æ­¥ã€è¿”å›å€¼ã€çŠ¶æ€ç " class="headerlink" title="æ“ä½œæ–¹æ³•çš„å¼‚æ­¥ã€è¿”å›å€¼ã€çŠ¶æ€ç "></a>æ“ä½œæ–¹æ³•çš„å¼‚æ­¥ã€è¿”å›å€¼ã€çŠ¶æ€ç </h1><h3 id="ACTIONæ–¹æ³•çš„å¼‚æ­¥"><a href="#ACTIONæ–¹æ³•çš„å¼‚æ­¥" class="headerlink" title="ACTIONæ–¹æ³•çš„å¼‚æ­¥"></a>ACTIONæ–¹æ³•çš„å¼‚æ­¥</h3><p>1.Actionæ–¹æ³•æ—¢å¯ä»¥åŒæ­¥ä¹Ÿå¯ä»¥å¼‚æ­¥ã€‚<br>2.å¼‚æ­¥Actionæ–¹æ³•çš„åå­—ä¸€èˆ¬ä¸éœ€è¦ä»¥Asyncç»“å°¾ã€‚<br>3.Web APIä¸­Actionæ–¹æ³•çš„è¿”å›å€¼å¦‚æœæ˜¯æ™®é€šæ•°æ®ç±»å‹ï¼Œé‚£ä¹ˆè¿”å›å€¼å°±ä¼šé»˜è®¤è¢«åºåˆ—åŒ–ä¸ºJsonæ ¼å¼ã€‚<br>4.Web APIä¸­çš„Actionæ–¹æ³•çš„è¿”å›å€¼åŒæ ·æ”¯æŒIActionResultç±»å‹ï¼Œä¸åŒ…å«ç±»å‹ä¿¡æ¯ï¼Œå› æ­¤Swaggerç­‰æ— æ³•æ¨æ–­å‡ºç±»å‹ï¼Œæ‰€ä»¥æ¨èç”¨ActionResult&lt;T&gt;,å®ƒæ”¯æŒç±»å‹è½¬æ¢ï¼Œä»è€Œç”¨èµ·æ¥æ›´ç®€å•ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">HttpGet</span>]</span><br><span class="line"><span class="function"><span class="keyword">public</span> ActionResult&lt;<span class="built_in">string</span>&gt; <span class="title">GetXIAN</span>(<span class="params"><span class="built_in">int</span> id</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (id == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">$&quot;You are a good person&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (id == <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">$&quot;You are a bad person&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> NotFound(<span class="string">&quot;Person not found&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Actionæ–¹æ³•å‚æ•°"><a href="#Actionæ–¹æ³•å‚æ•°" class="headerlink" title="Actionæ–¹æ³•å‚æ•°"></a>Actionæ–¹æ³•å‚æ•°</h3><p>æˆ‘ä»¬å†ç»™æœåŠ¡å™¨ç«¯ä¼ é€’å‚æ•°çš„æ—¶å€™ï¼Œæœ‰URLã€QueryStringã€è¯·æ±‚æŠ¥æ–‡ä½“3ç§æ–¹å¼ã€‚</p><p>1.åœ¨[HttpGet]ã€[HttpPost]ç­‰ä¸­ä½¿ç”¨å ä½ç¬¦ï¼Œæ¯”å¦‚{schoolName},æ•æ‰è·¯å¾„ä¸­çš„å†…å®¹ï¼Œä»è€Œä¾›Actionæ–¹æ³•çš„å‚æ•°ä½¿ç”¨ã€‚åŠ å…¥è¯·æ±‚çš„è·¯å¾„ä¸º&#x2F;Students&#x2F;GetAll&#x2F;school&#x2F;MIT&#x2F;class&#x2F;A001[HttpGet(â€œschool&#x2F;{schoolName}&#x2F;class&#x2F;{classNo}â€)]<br>2.æ•æ‰çš„å€¼ä¼šè‡ªåŠ¨èµ‹å€¼ç»™Actionä¸­åŒåçš„å‚æ•°ï¼›å¦‚æœåå­—ä¸ä¸€è‡´ï¼Œå¯ä»¥ç”¨[FormRoute(Name&#x3D;â€åå­—â€)]</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">HttpGet(<span class="string">&quot;students/school/&#123;schoolName&#125;/class/&#123;classNo&#125;&quot;</span>)</span>]</span><br><span class="line"><span class="function"><span class="keyword">public</span> Person <span class="title">GetStudent</span>(<span class="params"><span class="built_in">string</span> schoolName, [FromRoute(Name =<span class="string">&quot;classNo&quot;</span></span>)]<span class="built_in">int</span> classNum)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Person &#123; Id = classNum + <span class="number">6</span>, Name = schoolName + <span class="string">&quot;çš„æ‰›æŠŠå­&quot;</span> &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ•æ‰QUERYSTRINGçš„å€¼"><a href="#æ•æ‰QUERYSTRINGçš„å€¼" class="headerlink" title="æ•æ‰QUERYSTRINGçš„å€¼"></a>æ•æ‰QUERYSTRINGçš„å€¼</h3><p>1.ä½¿ç”¨[FromQuery]æ¥è·å–QueryStringä¸­çš„å€¼ã€‚å¦‚æœåå­—ä¸€è‡´ï¼Œåªè¦ä¸ºå‚æ•°æ·»åŠ [FromQuery]å³å¯ï¼›è€Œå¦‚æœåå­—ä¸ä¸€è‡´ï¼Œ[FromQuery(Name&#x3D;åå­—)]ã€‚<br>2.QueryStringå’ŒRouteå¯ä»¥æ··ç”¨ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> ActionResult&lt;Person[]&gt; GetAll([FromQuery] <span class="built_in">string</span> paueNum, [FromQuery(Name = <span class="string">&quot;pSize&quot;</span>)] <span class="built_in">int</span> pageSize)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Person[] &#123; pageSize == <span class="number">0</span> ? <span class="keyword">new</span> Person &#123; Id = <span class="number">1</span>, Name = <span class="string">&quot;YOUXIANYU&quot;</span>, ChildenName = <span class="keyword">new</span> <span class="built_in">string</span>[] &#123; <span class="string">&quot;aaa&quot;</span>, <span class="string">&quot;bbb&quot;</span> &#125; &#125; : <span class="keyword">new</span> Person &#123; Id = <span class="number">2</span>, Name = <span class="string">&quot;YOUXIANYU&quot;</span>, ChildenName = <span class="keyword">new</span> <span class="built_in">string</span>[] &#123; <span class="string">&quot;aaa&quot;</span>, <span class="string">&quot;bbb&quot;</span> &#125; &#125; &#125;;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><h3 id="JSONæŠ¥æ–‡ä½“"><a href="#JSONæŠ¥æ–‡ä½“" class="headerlink" title="JSONæŠ¥æ–‡ä½“"></a>JSONæŠ¥æ–‡ä½“</h3><p>1.Web APIçš„å¼€å‘æ¨¡å¼ä¸‹ï¼ŒJsonæ ¼å¼çš„è¯·æ±‚ææ˜¯ä¸»æµã€‚<br>2.åªè¦å£°æ˜ä¸€ä¸ªæ¨¡å‹ç±»å’ŒJsonè¯·æ±‚çš„æ ¼å¼ä¸€è‡´å³å¯ã€‚<br>3.ä¹Ÿæ˜¯å¯ä»¥æŠŠä»URLè·å–å‚æ•°ã€ä»è¯·æ±‚æŠ¥æ–‡ä½“è·å–æ•°æ®ç­‰è¿™äº›æ··åˆä½¿ç”¨ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">HttpPost(<span class="string">&quot;classId/&#123;classId&#125;&quot;</span>)</span>]</span><br><span class="line"><span class="function"><span class="keyword">public</span> ActionResult&lt;<span class="built_in">long</span>&gt; <span class="title">AddNew</span>(<span class="params"><span class="built_in">long</span> classId,StudentModel s</span>)</span></span><br></pre></td></tr></table></figure><p>4.ä¸€å®šè¦è®¾å®šè¯·æ±‚å¤´ä¸­çš„Content-Typeä¸ºapplication&#x2F;json,è€Œä¸”æ•°æ®å¿…é¡»æ˜¯åˆæ³•çš„jsonæ ¼å¼ã€‚</p><p>è¡¨å•è¯·æ±‚ï¼šä»Content-Typeä¸ºmultipart&#x2F;form-dataçš„è¯·æ±‚ä¸­è·å–æ•°æ®çš„[FromForm]</p><p>ä»è¯·æ±‚æŠ¥æ–‡å¤´ä¸­è·å–å€¼çš„[FromHeader]ã€‚</p><h2 id="ASP-NET-Core-Web-APIå‰åç«¯åˆ†ç¦»å¼€å‘"><a href="#ASP-NET-Core-Web-APIå‰åç«¯åˆ†ç¦»å¼€å‘" class="headerlink" title="ASP.NET Core Web APIå‰åç«¯åˆ†ç¦»å¼€å‘"></a>ASP.NET Core Web APIå‰åç«¯åˆ†ç¦»å¼€å‘</h2><h3 id="å¼€å‘Web-API-åç«¯æ¥å£"><a href="#å¼€å‘Web-API-åç«¯æ¥å£" class="headerlink" title="å¼€å‘Web API åç«¯æ¥å£"></a>å¼€å‘Web API åç«¯æ¥å£</h3><p>é¦–å…ˆï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ªASP.NET Core Web ç„¶ååœ¨é¡¹ç›®ä¸­åˆ›å»ºä¸€ä¸ªæ§åˆ¶å™¨ç±»LoginControllerã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    [<span class="meta">Route(<span class="string">&quot;api/[controller]/[action]&quot;</span>)</span>]</span><br><span class="line">    [<span class="meta">ApiController</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">LoginValuesController</span> : <span class="title">ControllerBase</span></span><br><span class="line">    &#123;</span><br><span class="line">        [<span class="meta">HttpPost</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> ActionResult&lt;LoginResponse&gt; <span class="title">Login</span>(<span class="params">LoginRequest req</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="function">req <span class="title">is</span> (<span class="params"><span class="string">&quot;YOUXIANYU&quot;</span>, <span class="string">&quot;123456&quot;</span></span>))</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">var</span> items = Process.GetProcesses()</span><br><span class="line">                    .Select(p =&gt; <span class="keyword">new</span> ProcessInfo(p.Id, p.ProcessName, p.WorkingSet64));</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> LoginResponse(<span class="literal">true</span>, items.ToArray());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> LoginResponse(<span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Loginæ–¹æ³•ç”¨æ¥åˆ¤æ–­è¯·æ±‚çš„ç”¨æˆ·åã€å¯†ç æ˜¯å¦æ­£ç¡®ï¼Œå¦‚æœæ­£ç¡®çš„è¯ï¼ŒæœåŠ¡å™¨ç«¯ä¼šæŠŠå½“å‰è®¡ç®—æœºä¸Šè¿è¡Œçš„æ‰€æœ‰è¿›ç¨‹ä¿¡æ¯è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œè¿”å›çš„ä¿¡æ¯åŒ…æ‹¬è¿›ç¨‹IDã€è¿›ç¨‹åï¼ˆProcessNameï¼‰å’Œå†…å­˜å ç”¨ï¼ˆWorkingSet64ï¼‰ã€‚</p><p>å…¶ä¸­LoginResultã€LoginRequestã€ProcessInfoç±»çš„å®šä¹‰ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">record</span> <span class="title">LoginRequest</span>(<span class="params"><span class="built_in">string</span> UserName,<span class="built_in">string</span> Password</span>)</span>;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">record</span> <span class="title">ProcessInfo</span>(<span class="params"><span class="built_in">long</span> Id,<span class="built_in">string</span> Name,<span class="built_in">long</span> WorkingSet</span>)</span>;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">record</span> <span class="title">LoginResponse</span>(<span class="params"><span class="built_in">bool</span> OK,ProcessInfo[]? ProcessInfos</span>)</span>;</span><br></pre></td></tr></table></figure><p>LoginResultç±»çš„IsOKå±æ€§è¡¨ç¤ºè¯·æ±‚çš„ç”¨æˆ·åå’Œå¯†ç æ˜¯å¦æ­£ç¡®ï¼Œå¦‚æœæ­£ç¡®ï¼ŒæœåŠ¡å™¨ç«¯çš„è¿›ç¨‹ä¿¡æ¯ä¼šè¢«è®¾ç½®åˆ°Processeså±æ€§ä¸Šï¼šLoginRequestç±»ä»£è¡¨è¯·æ±‚çš„å‚æ•°ä¿¡æ¯ï¼Œå…¶ä¸­çš„UserNameä»£è¡¨ç”¨æˆ·åï¼ŒPasswordä»£è¡¨å¯†ç ï¼šProcessInfoç±»ä»£è¡¨è¿›ç¨‹ä¿¡æ¯ï¼Œå…¶ä¸­çš„Idä»£è¡¨è¿›ç¨‹IDï¼ŒProccessNameä»£è¡¨è¿›ç¨‹åï¼ŒWorkingSet64ä»£è¡¨ä¸ºè¿›ç¨‹åˆ†é…çš„ç‰©ç†å†…å­˜é‡ã€‚<br>åœ¨Swaggeré¡µé¢ä¸Šæµ‹è¯•ä¸€ä¸‹Loginæ–¹æ³•ã€‚å¦‚æœæˆ‘ä»¬é€šè¿‡è¯·æ±‚æŠ¥æ–‡ä½“è®¾ç½®çš„ç”¨æˆ·åã€å¯†ç é”™è¯¯çš„è¯ï¼ŒæœåŠ¡å™¨ç«¯çš„å“åº”å¦‚å›¾ã€‚</p><p><img src="/img%5CWEBAPI%5C4.png"></p><p><img src="/img%5CWEBAPI%5C5.png"></p><h3 id="æ­å»ºå‰ç«¯"><a href="#æ­å»ºå‰ç«¯" class="headerlink" title="æ­å»ºå‰ç«¯"></a>æ­å»ºå‰ç«¯</h3><p>1.åœ¨srcæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºviewsæ–‡ä»¶å¤¹ã€‚<br>2.å®‰è£…axios. npm i axios<br>3.åœ¨viewsæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºLogin.vueæ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    ç”¨æˆ·åï¼š&lt;input type=&quot;text&quot; v-model=&quot;state.loginData.userName&quot;/&gt;</span><br><span class="line">    å¯†ç ï¼š&lt;input type=&quot;password&quot; v-model=&quot;state.loginData.password&quot;/&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; value=&quot;ç™»å½•&quot; @click=&quot;loginSubmit&quot;/&gt;</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">        &lt;li v-for=&quot;p in state.processes&quot; :key=&quot;p.id&quot;&gt;&#123;&#123;p.id&#125;&#125;&#123;&#123; p.processName&#125;&#125;&#123;&#123;p.workingSet64&#125;&#125;</span><br><span class="line">        &lt;/li&gt;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import axios from &#x27;axios&#x27;;</span><br><span class="line">import &#123; reactive, onMounted &#125; from &#x27;vue&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">    name: &#x27;Login&#x27;,</span><br><span class="line">    setup() &#123;</span><br><span class="line">        const state = reactive(&#123; loginData: &#123;&#125;, processes: [] &#125;);</span><br><span class="line">        const loginSubmit = async() =&gt; &#123;</span><br><span class="line">            const payload = state.loginData;</span><br><span class="line">            const resp = await axios.post(&#x27;https://localhost:7105/api/Login/Login&#x27;, payload);</span><br><span class="line">            const data = resp.data;</span><br><span class="line">            if (!data.isOK) &#123;</span><br><span class="line">                alert(&quot;ç™»å½•å¤±è´¥&quot;);</span><br><span class="line">                return;</span><br><span class="line">            &#125;</span><br><span class="line">            state.processes = data.processes;</span><br><span class="line">        &#125;</span><br><span class="line">        return &#123;state,loginSubmit&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">onMounted(() =&gt; &#123;</span><br><span class="line">    alert(state);</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>4.ä½¿ç”¨vue-routeræ¥åšå‰ç«¯çš„é¡µé¢è·¯ç”±ã€‚åœ¨å‰ç«¯çš„é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œï¼š<br>npm run-router<br>5.åœ¨srcä¸‹åˆ›å»ºrouteæ–‡ä»¶å¤¹ï¼Œå¹¶ä¸”åœ¨routeæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºindex.jsæ–‡ä»¶</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createRouter, createWebHashHistory &#125; <span class="keyword">from</span> <span class="string">&quot;vue-router&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Login</span> <span class="keyword">from</span> <span class="string">&quot;@/view/Login.vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> routes = [&#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/&quot;</span>, <span class="attr">redirect</span>: <span class="string">&quot;/Login&quot;</span></span><br><span class="line">&#125;, &#123; <span class="attr">path</span>: <span class="string">&quot;/Login&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;Login&quot;</span>, <span class="attr">coponent</span>: <span class="title class_">Login</span> &#125;]</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="title function_">createRouter</span>(&#123; <span class="attr">history</span>: <span class="title function_">createWebHashHistory</span>(), <span class="attr">routes</span>: routes &#125;);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router;</span><br></pre></td></tr></table></figure><p>6.ç¼–è¾‘src&#x2F;main.js,å¢åŠ import router from â€˜.&#x2F;routeâ€™ ä»¥åŠuse(router),ä¿®æ”¹main.js:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./assets/main.css&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&#x27;./router&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">createApp</span>(<span class="title class_">App</span>).<span class="title function_">use</span>(router).<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure><p>7.src&#x2F;App.vueä¸­å¢åŠ æŒ‡å®šLoginè§†å›¾çš„é“¾æ¥ä»¥åŠæ˜¾ç¤ºè·¯ç”±è§†å›¾çš„&lt;router-view&#x2F;&gt;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup&gt;</span><br><span class="line">// import HelloWorld from &#x27;./components/HelloWorld.vue&#x27;</span><br><span class="line">// import TheWelcome from &#x27;./components/TheWelcome.vue&#x27;</span><br><span class="line">import Login from &#x27;./view/Login.vue&#x27;;</span><br><span class="line">import &#123; RouterView,RouterLink&#125; from &#x27;vue-router&#x27;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;router-link to=&quot;/Login&quot;&gt;Login&lt;/router-link&gt;&lt;router-view/&gt;</span><br><span class="line">      &lt;login/&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><h3 id="CORS"><a href="#CORS" class="headerlink" title="CORS"></a>CORS</h3><p>1.è·¨åŸŸé€šè®¯çš„é—®é¢˜ã€‚è§£å†³æ–¹æ¡ˆï¼šJSONPã€å‰ç«¯ä»£ç†åç«¯è¯·æ±‚ã€CORSç­‰ã€‚<br>2.CORSåŸç†ï¼šåœ¨æœåŠ¡å™¨çš„å“åº”æŠ¥æ–‡å¤´ä¸­é€šè¿‡access-control-allow-orignå‘Šè¯‰æµè§ˆå™¨å…è®¸è·¨åŸŸè®¿é—®çš„åŸŸåã€‚<br>3.åœ¨Program.csçš„â€œvar app&#x3D;builder.Build()â€è¿™å¥ä»£ç ä¹‹å‰æ³¨å†Œ<br>4.åœ¨Program.csçš„app.UserHttpsRedirection()è¿™å¥ä»£ç ä¹‹å‰å¢åŠ ä¸€è¡Œapp.UseCors()</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> builder = WebApplication.CreateBuilder(args);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Add services to the container.</span></span><br><span class="line"></span><br><span class="line">builder.Services.AddControllers();</span><br><span class="line"><span class="comment">// Learn more about configuring Swagger/OpenAPI at https://aka.ms/aspnetcore/swashbuckle</span></span><br><span class="line">builder.Services.AddEndpointsApiExplorer();</span><br><span class="line">builder.Services.AddSwaggerGen();</span><br><span class="line">builder.Services.AddCors(opt =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    opt.AddDefaultPolicy(b =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        b.WithOrigins(<span class="keyword">new</span> <span class="built_in">string</span>[] &#123; <span class="string">&quot;http://localhost:5173&quot;</span> &#125;)</span><br><span class="line">            .AllowAnyMethod()</span><br><span class="line">            .AllowAnyHeader()</span><br><span class="line">            .AllowCredentials();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> app = builder.Build();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Configure the HTTP request pipeline.</span></span><br><span class="line"><span class="keyword">if</span> (app.Environment.IsDevelopment())</span><br><span class="line">&#123;</span><br><span class="line">    app.UseSwagger();</span><br><span class="line">    app.UseSwaggerUI();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.UseCors();</span><br><span class="line">app.UseHttpsRedirection();</span><br><span class="line"></span><br><span class="line">app.UseAuthorization();</span><br><span class="line"></span><br><span class="line">app.MapControllers();</span><br><span class="line"></span><br><span class="line">app.Run();</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> EF Core </tag>
            
            <tag> ASP.NET Core </tag>
            
            <tag> Entity Framework Core </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ASP.NET Coreå¼€å‘Web API</title>
      <link href="/2025/04/08/asp.net%20core/ASP.NET%20Core%20Web%20API/"/>
      <url>/2025/04/08/asp.net%20core/ASP.NET%20Core%20Web%20API/</url>
      
        <content type="html"><![CDATA[<h1 id="Web-APIé¡¹ç›®çš„åˆ›å»º"><a href="#Web-APIé¡¹ç›®çš„åˆ›å»º" class="headerlink" title="Web APIé¡¹ç›®çš„åˆ›å»º"></a>Web APIé¡¹ç›®çš„åˆ›å»º</h1><p>åœ¨é¡¹ç›®æ¨¡æ¿ä¸­é€‰æ‹©ã€ASP.NET Core Web APIã€‘åˆ›å»ºé¡¹ç›®ã€‚</p><p><img src="/img%5CWEBAPI%5C1.png"></p><p>å¯ä»¥çœ‹åˆ°ï¼ŒASP.NET Core Web APIé¡¹ç›®çš„ç»“æ„å’ŒASP.NET Core MVCé¡¹ç›®çš„ç»“æ„éå¸¸ç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯ASP.NET Core Web APIé¡¹ç›®æ²¡æœ‰Viewsæ–‡ä»¶å¤¹ï¼Œå› ä¸ºWeb APIç›´æ¥è¿”å›çš„æ˜¯ç»“æ„åŒ–çš„æ•°æ®ï¼Œä¸éœ€è¦æä¾›å±•ç¤ºæ•°æ®çš„è§†å›¾ã€‚é¡¹ç›®ä¸­ç”Ÿæˆçš„æ ·æ¿ä»£ç WeatherForecastControlleræ˜¯ä¸€ä¸ªæ§åˆ¶å™¨ç±»ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">ApiController</span>]</span><br><span class="line">[<span class="meta">Route(<span class="string">&quot;[controller]&quot;</span>)</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">WeatherForecastController</span> : <span class="title">ControllerBase</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> <span class="built_in">string</span>[] Summaries = <span class="keyword">new</span>[]</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&quot;Freezing&quot;</span>, <span class="string">&quot;Bracing&quot;</span>, <span class="string">&quot;Chilly&quot;</span>, <span class="string">&quot;Cool&quot;</span>, <span class="string">&quot;Mild&quot;</span>, <span class="string">&quot;Warm&quot;</span>, <span class="string">&quot;Balmy&quot;</span>, <span class="string">&quot;Hot&quot;</span>, <span class="string">&quot;Sweltering&quot;</span>, <span class="string">&quot;Scorching&quot;</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> ILogger&lt;WeatherForecastController&gt; _logger;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">WeatherForecastController</span>(<span class="params">ILogger&lt;WeatherForecastController&gt; logger</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _logger = logger;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">HttpGet(Name = <span class="string">&quot;GetWeatherForecast&quot;</span>)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> IEnumerable&lt;WeatherForecast&gt; <span class="title">Get</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> Enumerable.Range(<span class="number">1</span>, <span class="number">5</span>).Select(index =&gt; <span class="keyword">new</span> WeatherForecast</span><br><span class="line">        &#123;</span><br><span class="line">            Date = DateOnly.FromDateTime(DateTime.Now.AddDays(index)),</span><br><span class="line">            TemperatureC = Random.Shared.Next(<span class="number">-20</span>, <span class="number">55</span>),</span><br><span class="line">            Summary = Summaries[Random.Shared.Next(Summaries.Length)]</span><br><span class="line">        &#125;)</span><br><span class="line">        .ToArray();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ§åˆ¶å™¨ç±»WeatherForecastControllerç»§æ‰¿è‡ªControllerBaseç±»ã€‚æˆ‘ä»¬æ³¨æ„åˆ°ï¼ŒASP.NET Core MVCé¡¹ç›®ä¸­æ§åˆ¶å™¨ç±»ç»§æ‰¿è‡ªControllerç±»ï¼ŒControllerç±»æ˜¯ControllerBaseç±»çš„å­ç±»ã€‚Controllerç±»ä¸­åŒ…å«Viewç­‰å’ŒMVCä¸­çš„è§†å›¾ç­‰ç›¸å…³çš„ä»£ç ï¼Œå› æ­¤æˆ‘ä»¬åœ¨ç¼–å†™Web APIçš„æ—¶å€™ï¼Œæ§åˆ¶å™¨ç±»ä¸€èˆ¬ä¸éœ€è¦ç»§æ‰¿è‡ªControllerç±»ã€‚</p><p>Web APIé¡¹ç›®ä¸­çš„æ§åˆ¶å™¨ç±»ä¸€èˆ¬éœ€è¦æ·»åŠ [ApiController]è¿™ä¸ªAttributeã€‚[Route(â€œ[controller]â€)]è¿™ä¸ªAttributeæ˜¯ç”¨æ¥è®¾ç½®è·¯ç”±çš„å¯¹&#x2F;WeatherForecastè·¯å¾„çš„è¯·æ±‚ç”±WeatherForecast Controlleræ¥å¤„ç†ã€‚</p><p>æ§åˆ¶å™¨çš„æ“ä½œæ–¹æ³•Getä¸Šæ·»åŠ [HttpGet]è¿™ä¸ªAttributeè¡¨ç¤ºï¼Œå½“å‘&#x2F;WeatherForecastè·¯å¾„å‘é€GETè¯·æ±‚çš„æ—¶å€™ï¼Œç”±Getæ–¹æ³•è¿›è¡Œå¤„ç†ã€‚ ç”±äºæ“ä½œæ–¹æ³•æ˜¯æ ¹æ®[HttpGet]è¿™ä¸ªAttributeä¸è¯·æ±‚çš„è°“è¯ï¼ˆä¹Ÿå°±æ˜¯GETã€POSTã€PUTç­‰ï¼‰è¿›è¡ŒåŒ¹é…çš„ï¼Œå› æ­¤å…¶æ“ä½œæ–¹æ³•çš„åå­—å¹¶ä¸å½±å“æ‰§è¡Œç»“æœã€‚æ€»ä¹‹ï¼Œæ§åˆ¶å™¨ç±»ä¸Šæ·»åŠ çš„[Route(â€œ[controller]â€)]åŠGetæ–¹æ³•ä¸Šæ·»åŠ çš„[HttpGet]å†³å®šäº†å®¢æˆ·ç«¯å‘&#x2F;WeatherForecastè¿™ä¸ªè·¯å¾„å‘é€GETè¯·æ±‚çš„æ—¶å€™ï¼Œç”±Getæ–¹æ³•è¿›è¡Œå¤„ç†ã€‚Getæ–¹æ³•è¿”å›çš„å¯¹è±¡ä¼šè¢«è‡ªåŠ¨è¿›è¡ŒJOSNåºåˆ—åŒ–è¿”å›å®¢æˆ·ç«¯ã€‚</p><p><img src="/img%5CWEBAPI%5C2.png"></p><h2 id="Postã€Putç­‰æ“ä½œæ–¹æ³•"><a href="#Postã€Putç­‰æ“ä½œæ–¹æ³•" class="headerlink" title="Postã€Putç­‰æ“ä½œæ–¹æ³•"></a>Postã€Putç­‰æ“ä½œæ–¹æ³•</h2><p>Web APIä¼šæ ¹æ®HTTPè¯·æ±‚çš„è°“è¯æ¥åŒ¹é…æ“ä½œæ–¹æ³•ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä¸ºæ§åˆ¶å™¨ç±»å¢åŠ ä¸€ä¸ªæ ‡æ³¨äº†[HttpPost]çš„æ“ä½œæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å°±å¯ä»¥å¤„ç†Postè¯·æ±‚äº†ï¼Œè¿™åŒæ ·é€‚ç”¨äº[HttpPut]ç­‰ã€‚<br>æ¯”å¦‚æˆ‘ä»¬ä¸ºWeatherForecastControllerå¢åŠ ä¸€ä¸ªSaveNoteæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æŠŠç”¨æˆ·æäº¤çš„å†…å®¹ä¿å­˜åˆ°æ–‡æœ¬æ–‡ä»¶ä¸­ï¼Œæ–¹æ³•çš„è¿”å›å€¼ä¸ºä¿æŒçš„æ–‡ä»¶åã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">HttpPost</span>]</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">saveNote</span>(<span class="params">SaveNoteRequest request</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> filename = <span class="string">$&quot;<span class="subst">&#123;request.Title&#125;</span>.txt&quot;</span>;</span><br><span class="line">        System.IO.File.WriteAllTextAsync(filename, request.Content);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">$&quot;Title: <span class="subst">&#123;request.Title&#125;</span>, Content: <span class="subst">&#123;request.Content&#125;</span>&quot;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>SaveNoteæ–¹æ³•æœ‰ä¸€ä¸ªSaveNoteRequestç±»çš„å‚æ•°ï¼ŒSaveNoteReauestç±»æ˜¯ä¸€ä¸ªåŒ…å«Titleï¼ˆæ ‡é¢˜ï¼‰ã€Contentï¼ˆå†…å®¹ï¼‰ä¸¤ä¸ªå±æ€§çš„ç±»ã€‚<br>è¿è¡Œé¡¹ç›®ï¼Œå¯ä»¥çœ‹åˆ°æµè§ˆå™¨ä¸­å±•ç¤ºçš„Swaggeré¡µé¢ä¸­å·²ç»å¢åŠ äº†å¯ä»¥å¤„ç†POSTè¯·æ±‚çš„é€‰é¡¹ã€‚</p><p><img src="/img%5CWEBAPI%5C3.png"></p><p>æˆ‘ä»¬ä¿®æ”¹é»˜è®¤ç”Ÿäº§çš„è¯·æ±‚æŠ¥æ–‡ä½“çš„å†…å®¹ï¼ŒæŠŠtitleå’Œcontentå±æ€§å€¼ä¿®æ”¹ä¸ºæœ‰å®é™…æ„ä¹‰çš„å€¼ã€‚</p><h1 id="Restful-reptesentational-state-transfer-è¡¨ç°å±‚çŠ¶æ€è½¬ç§»"><a href="#Restful-reptesentational-state-transfer-è¡¨ç°å±‚çŠ¶æ€è½¬ç§»" class="headerlink" title="Restful(reptesentational state transfer,è¡¨ç°å±‚çŠ¶æ€è½¬ç§»)"></a>Restful(reptesentational state transfer,è¡¨ç°å±‚çŠ¶æ€è½¬ç§»)</h1><h2 id="ä»€ä¹ˆæ˜¯Restful"><a href="#ä»€ä¹ˆæ˜¯Restful" class="headerlink" title="ä»€ä¹ˆæ˜¯Restful"></a>ä»€ä¹ˆæ˜¯Restful</h2><p>Web APIå¼€å‘æœ‰ä¸¤ç§é£æ ¼ï¼šé¢å‘è¿‡ç¨‹ï¼ˆç®€ç§°RPCï¼‰ã€é¢å‘RESTçš„ï¼ˆç®€ç§°RESTï¼‰ã€‚<br>åœ¨RPCé£æ ¼çš„Web APIä¸­ï¼Œæˆ‘ä»¬é€šè¿‡â€œæ§åˆ¶å™¨&#x2F;æ“ä½œæ–¹æ³•â€çš„å½¢å¼æ¥è°ƒç”¨æœåŠ¡å™¨ç«¯çš„æ–¹æ³•ï¼ŒæŠŠæœåŠ¡å™¨ç«¯çš„ä»£ç å½“æˆæ–¹æ³•å»è°ƒç”¨ã€‚è¿™ç§é£æ ¼çš„æ¥å£å¯èƒ½ä¼šç”¨POSTè¯·æ±‚å¤„ç†æ‰€æœ‰çš„æ“ä½œæ–¹æ³•ï¼Œæ— è®ºæ˜¯è·å–ã€æ–°å¢ã€æ›´æ–°è¿˜æ˜¯åˆ é™¤æ•°æ®ï¼Œè¿™æ ·çš„æ¥å£ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡QueryStringï¼ˆæŸ¥è¯¢å­—ç¬¦ä¸²ï¼‰æˆ–è¿™è¯·æ±‚æŠ¥æ–‡ä½“æ¥ä¸ºæœåŠ¡å™¨ä¼ é€’æ•°æ®ã€‚åªè¦æœåŠ¡å™¨ç«¯èƒ½å¤Ÿæ­£å¸¸å®Œæˆå®¢æˆ·ç«¯è¯·æ±‚çš„å¤„ç†ï¼ŒæœåŠ¡å™¨å°±ä¼šç»Ÿä¸€è¿”å›200çš„HTTPçŠ¶æ€ç ã€‚å¯¹äºé€»è¾‘ä¸Šçš„é”™è¯¯ï¼Œè¿”å›çš„HTTPçŠ¶æ€ç ä¹Ÿæ˜¯200ï¼Œåªä¸è¿‡åœ¨å“åº”æŠ¥æ–‡ä½“ä¸­é€šè¿‡ä¸åŒçš„é”™è¯¯ç æ¥è¡¨ç¤ºï¼Œæ¯”å¦‚â€œè·å–çš„ç”¨æˆ·ä¸å­˜åœ¨â€çš„é”™è¯¯ç ä¸º1ï¼Œâ€œæ²¡æœ‰æƒé™è·å–è¿™ä¸ªç”¨æˆ·â€çš„é”™è¯¯ç ä¸º2ã€‚</p><p>åœ¨RPCé£æ ¼çš„æ¥å£ä¸­ï¼Œå½“éœ€è¦åŠ è½½æ‰€æœ‰ç”¨æˆ·çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å‘&#x2F;Persons&#x2F;GetAllè¿™ä¸ªè·¯å¾„å‘é€GETè¯·æ±‚ï¼›<br>åŠ è½½id&#x3D;8,&#x2F;Persons&#x2F;GetById?id&#x3D;8<br>æ›´æ–°id&#x3D;8,&#x2F;Persons&#x2F;Update<br>æ–°å¢ç”¨æˆ·ï¼Œ&#x2F;Persons&#x2F;AddNew<br>åˆ é™¤id&#x3D;8,&#x2F;Persons&#x2F;DeleteById&#x2F;8<br>å¹¶ä¸”æŠŠæ–°ç”¨æˆ·ä¿¡æ¯ä»¥JSONæ ¼å¼æ”¾åˆ°è¯·æ±‚æŠ¥æ–‡ä½“ä¸­ï¼›<br>ç”±æ­¤å¯è§ï¼Œåœ¨RPCé£æ ¼çš„ç³»ç»Ÿä¸­ï¼ŒURLä¸­åŒ…å«ä»¥åè¯å½¢å¼æè¿°çš„èµ„æºï¼ˆæ¯”å¦‚Personsï¼‰å’Œä»¥åŠ¨è¯å½¢å¼æè¿°çš„åŠ¨ä½œï¼ˆæ¯”å¦‚AddNewï¼‰ã€‚</p><p>ä¸ä¹‹å¯¹åº”ï¼Œåœ¨RESTé£æ ¼çš„Web APIä¸­ï¼Œæ¥å£æŠŠæœåŠ¡å™¨å½“æˆèµ„æºæ¥å¤„ç†ã€‚RESTé£æ ¼çš„æ¥å£æŒ‰ç…§HTTPè®¾è®¡ä¹‹åˆçš„è¯­ä¹‰æ¥ä½¿ç”¨HTTPï¼ŒæŠŠç³»ç»Ÿä¸­çš„æ‰€ç”¨å†…å®¹éƒ½æŠ½è±¡ä¸ºèµ„æºï¼Œæ‰€æœ‰å¯¹èµ„æºçš„æ“ä½œéƒ½æ˜¯æ— çŠ¶æ€çš„ä¸”å¯ä»¥é€šè¿‡æ ‡å‡†çš„HTTPè°“è¯æ¥è¿›è¡Œã€‚</p><p>åœ¨ä¸€ä¸ªRestfulé£æ ¼çš„Web APIç³»ç»Ÿä¸­ï¼Œæ¯ä¸€ä¸ªæ§åˆ¶å™¨éƒ½æ˜¯å¯¹ä¸€ç±»èµ„æºçš„æ“ä½œçš„é›†åˆï¼Œæ¯ä¸ªæ“ä½œæ–¹æ³•éƒ½è¢«ä¸åŒçš„HTTPè°“è¯è§¦å‘ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">Route(<span class="string">&quot;api/[controller]&quot;</span>)</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">PesonsController</span> : <span class="title">ControllerBase</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">HttpGet</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> IEnumerable&lt;Person&gt; <span class="title">GetPersons</span>()</span>;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">HttpGet(<span class="string">&quot;&#123;id&#125;&quot;</span>)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Person <span class="title">GetPerson</span>(<span class="params"><span class="built_in">long</span> id</span>)</span>;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">HttpPut(<span class="string">&quot;&#123;id&#125;&quot;</span>)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">UpdatePerson</span>(<span class="params"><span class="built_in">long</span> id,Person person</span>)</span>;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">HttpPost</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SavePerson</span>(<span class="params">Person person</span>)</span>;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">HttpDelete(<span class="string">&quot;&#123;id&#125;&quot;</span>)</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">DeletePerson</span>(<span class="params"><span class="built_in">long</span> id</span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Restfulçš„ä¼˜ç¼ºç‚¹"><a href="#Restfulçš„ä¼˜ç¼ºç‚¹" class="headerlink" title="Restfulçš„ä¼˜ç¼ºç‚¹"></a>Restfulçš„ä¼˜ç¼ºç‚¹</h2><p>RESTçš„ä¼˜ç‚¹</p><p>1.é€šè¿‡URLå¯¹èµ„æºå®šä½ï¼Œè¯­ä¹‰æ›´æ¸…æ™°ï¼›<br>2.é€šè¿‡HTTPè°“è¯­è¡¨ç¤ºä¸åŒçš„æ“ä½œï¼Œæ¥å£è‡ªæè¿°ï¼›<br>3.å¯ä»¥å¯¹GETã€PUTã€DELETEè¯·æ±‚è¿›è¡Œé‡è¯•ï¼›<br>4.å¯ä»¥ç”¨GETè¯·æ±‚åšç¼“å­˜ï¼›<br>5.é€šè¿‡HTTPçŠ¶æ€ç åæ˜ æœåŠ¡å™¨ç«¯çš„å¤„ç†ç»“æœï¼ŒåŒæ ·é”™è¯¯å¤„ç†æœºåˆ¶ã€‚<br>6.ç½‘ç®¡ç­‰å¯ä»¥åˆ†æè¯·æ±‚å¤„ç†ç»“æœã€‚</p><p>RESTçš„ç¼ºç‚¹</p><p>1.çœŸæ˜¯ç³»ç»Ÿä¸­çš„èµ„æºéå¸¸å¤æ‚ï¼Œå¾ˆéš¾æ¸…æ™°è¿›è¡Œèµ„æºçš„åˆ’åˆ†ï¼Œå¯¹æŠ€æœ¯äººå‘˜çš„ä¸šåŠ¡å’ŒæŠ€æœ¯æ°´å¹³è¦æ±‚é«˜ã€‚<br>2.ä¸æ˜¯æ‰€æœ‰çš„æ“ä½œå¤šèƒ½ç®€å•åœ°å¯¹åº”åˆ°ç¡®å®šçš„HTTPè°“è¯ä¸­ã€‚<br>3.ç³»ç»Ÿçš„è¿›åŒ–å¯èƒ½ä¼šæ”¹å˜å¹‚ç­‰æ€§ã€‚<br>4.é€šè¿‡URLè¿›è¡Œèµ„æºå®šä½ä¸ç¬¦åˆä¸­æ–‡ç”¨æˆ·çš„ä¹ æƒ¯ã€‚<br>5.HTTPçŠ¶ä½“ç ä¸ªæ•°æœ‰é™ã€‚<br>6.æœ‰äº›ç¯èŠ‚ä¼šç¯¡æ”¹é200å“åº”ç çš„å“åº”æŠ¥æ–‡ã€‚<br>7.æœ‰çš„å®¢æˆ·ç«¯ä¸æ”¯æŒPUTã€DELETEè¯·æ±‚ã€‚</p><h2 id="Resufulä¸­å¦‚ä½•ä¼ é€’å‚æ•°"><a href="#Resufulä¸­å¦‚ä½•ä¼ é€’å‚æ•°" class="headerlink" title="Resufulä¸­å¦‚ä½•ä¼ é€’å‚æ•°"></a>Resufulä¸­å¦‚ä½•ä¼ é€’å‚æ•°</h2><p>HTTPä¼ é€’å‚æ•°çš„ä¸‰ç§æ–¹å¼</p><p>URLï¼šé€‚åˆå®šä½ï¼›é•¿åº¦é™åˆ¶ã€‚&#x2F;<br>QueryStringï¼šçµæ´»ï¼›é•¿åº¦é™åˆ¶ã€‚<br>è¯·æ±‚æŠ¥æ–‡ä½“ï¼šçµæ´»ï¼›é•¿åº¦ä¸é™åˆ¶ï¼›ä¸æ”¯æŒGETã€Deleteã€‚</p><p>ä¸åŒè¯­ä¹‰<br>URLï¼šèµ„æºå®šä½ã€‚<br>QueryStringï¼šURLä¹‹å¤–çš„é¢å¤–æ•°æ®ã€‚<br>è¯·æ±‚æŠ¥æ–‡ä½“ï¼šä¾›PUTã€POSTæä¾›æ•°æ®ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> EF Core </tag>
            
            <tag> ASP.NET Core </tag>
            
            <tag> Entity Framework Core </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ASP.NET Core MVCå…¥é—¨</title>
      <link href="/2025/04/07/asp.net%20core/ASP.NET%20Core%20MVC%E5%85%A5%E9%97%A8/"/>
      <url>/2025/04/07/asp.net%20core/ASP.NET%20Core%20MVC%E5%85%A5%E9%97%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="ASP-NET-Core-MVCä»‹ç»"><a href="#ASP-NET-Core-MVCä»‹ç»" class="headerlink" title="ASP.NET Core MVCä»‹ç»"></a>ASP.NET Core MVCä»‹ç»</h1><p>Wbeåº”ç”¨æ˜¯.NET Coreå¼€å‘ä¸­å¸¸è§çš„é¡¹ç›®ç±»å‹ï¼Œæ— è®ºæ˜¯ç½‘ç«™è¿˜æ˜¯HTTPæœåŠ¡æ¥å£ï¼Œéƒ½æœ‰æä¾›å¯¹å¤–Webè®¿é—®çš„èƒ½åŠ›ï¼Œè€Œ.NET Coreä¸­è¿›è¡ŒWebåº”ç”¨å¼€å‘çš„æ ¸å¿ƒåº•å±‚æŠ€æœ¯æ˜¯ASP.NET Coreã€‚<br>åœ¨ASP.NET Coreè¿™ä¸ªåº•å±‚åŸºç¡€ä¸Šï¼Œå¾®è½¯å¼€å‘äº†ASP.NET Coreå’ŒASP.NET Core APIè¿™ä¸¤ä¸ªæ¡†æ¶ã€‚éšç€è½¯ä»¶é¡¹ç›®å¤æ‚åº¦çš„å¢åŠ åŠè½¯ä»¶é¡¹ç›®åˆ†å·¥çš„ç»†åŒ–ï¼Œå‰åç«¯åˆ†ç¦»å·²ç»æˆä¸ºä¸»æµå¼€å‘æ¨¡å¼ï¼Œåç«¯å¼€å‘äººå‘˜ä½¿ç”¨ASP.NET Core Web APIå¼€å‘æœåŠ¡æ¥å£ï¼Œç•Œé¢äº¤äº’ç­‰æœ‰å‰ç«¯å¼€å‘äººå‘˜ä½¿ç”¨Vueç­‰å‰ç«¯æ¡†æ¶æ¥å®Œæˆã€‚åœ¨ASP.NET Core MVCè¿™ç§å¼€å‘æ¨¡å¼ä¸‹ï¼Œåç«¯å¼€å‘äººå‘˜ä¹Ÿä»ç„¶è¦ç¼–å†™ä¸€éƒ¨åˆ†å‰ç«¯çš„ä»£ç ï¼Œè€Œåœ¨å‰åç«¯åˆ†ç¦»çš„å¼€å‘æ¨¡å¼ä¸‹ï¼Œåç«¯å¼€å‘äººå‘˜ä¸åœ¨éœ€è¦å¤„ç†ä»»ä½•ç•Œé¢é€»è¾‘ï¼Œè€Œåªæ˜¯éœ€è¦ç¼–å†™ASP.NET Core Web APIã€‚</p><h2 id="ç¼–å†™ç¬¬ä¸€ä¸ªMVCç¨‹åº"><a href="#ç¼–å†™ç¬¬ä¸€ä¸ªMVCç¨‹åº" class="headerlink" title="ç¼–å†™ç¬¬ä¸€ä¸ªMVCç¨‹åº"></a>ç¼–å†™ç¬¬ä¸€ä¸ªMVCç¨‹åº</h2><p>ASP.NET Core MVCé‡‡ç”¨MVCæ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯æŠŠé¡µé¢äº¤äº’çš„ä»£ç åˆ†ä¸ºæ¨¡å‹ï¼ˆmodelï¼‰ã€è§†å›¾ï¼ˆviewï¼‰å’Œæ§åˆ¶å™¨ï¼ˆcontrollerï¼‰3ä¸ªéƒ¨åˆ†ã€‚è§†å›¾è´Ÿè´£å†…å®¹çš„å±•ç°ï¼Œä¹Ÿå°±ç”¨æ¥æ˜¾ç¤ºHTMLç½‘é¡µï¼›æ§åˆ¶å™¨è´Ÿè´£å¤„ç†ç”¨æˆ·çš„è¯·æ±‚åŠä¸ºè§†å›¾å‡†å¤‡æ•°æ®ï¼›æ¨¡å‹è´Ÿè´£åœ¨è§†å›¾å’Œæ§åˆ¶å™¨ä¹‹é—´ä¼ é€’æ•°æ®ã€‚</p><p><img src="/img%5CHello%5CMVC.png"></p><p>åœ¨MVCæ¨¡å¼ä¸­ï¼Œè¯•å¬å’Œæ§åˆ¶å™¨ä¸ç›´æ¥äº¤æ¢ã€ä¸äº’ç›¸ä¾èµ–ï¼Œå½¼æ­¤ä¹‹é—´é€šè¿‡æ¨¡å‹è¿›è¡Œæ•°æ®ä¼ è¾“ã€‚ä½¿ç”¨MVCæ¨¡å¼çš„ä¼˜ç‚¹æ˜¯è§†å›¾å’Œæ§åˆ¶å™¨é™ä½äº†è€¦åˆï¼Œç³»ç»Ÿçš„ç»“æ„æ›´æ¸…æ™°ã€‚</p><h3 id="é¡¹ç›®ç»“æ„"><a href="#é¡¹ç›®ç»“æ„" class="headerlink" title="é¡¹ç›®ç»“æ„"></a>é¡¹ç›®ç»“æ„</h3><p>1.æ§åˆ¶å™¨ç”±Controllerç±»å®ç°ï¼Œè¯•å›¾ä¸€èˆ¬æ˜¯æ‰©å±•åä¸ºcshtmlçš„æ–‡ä»¶ï¼Œè€Œæ¨¡å‹åˆ™æ˜¯åªæœ‰å±æ€§çš„æ™®é€šC#ç±»ã€‚</p><p>2.æ§åˆ¶å™¨ç±»çš„åå­—ä¸€èˆ¬ä»¥Controllerç»“å°¾ï¼Œå¹¶ä¸”è¢«æ”¾åœ¨Controlleræ–‡ä»¶å¤¹ä¸‹ã€‚æ§åˆ¶å™¨çš„åå­—å¾®æ§åˆ¶å™¨çš„ç±»åå»æ‰Controllerã€‚</p><p>3.è§†å›¾ä¸€èˆ¬è¢«æ”¾åˆ°Viewsæ–‡ä»¶å¤¹ä¸‹çš„æ§åˆ¶å™¨åå­—çš„æ–‡ä»¶å¤¹ä¸‹ã€‚</p><p>4.è§†å›¾-&gt;æµè§ˆå™¨å…¨æäº¤çš„è¯·æ±‚-&gt;æ¨¡å‹-&gt;æ§åˆ¶å™¨-&gt;å¤„ç†-&gt;æ¨¡å‹-&gt;è§†å›¾ã€‚æ¸²æŸ“ï¼šRenderã€‚</p><p>ä¸‹é¢æ¼”ç¤ºä¸€ä¸ªåœ¨æ§åˆ¶å™¨ä¸­æŸ¥è¯¢æ•°æ®ï¼Œç„¶åæŠŠæ•°æ®ä¼ é€’ç»™è§†å›¾è¿›è¡Œæ¸²æŸ“çš„æ¡ˆä¾‹ã€‚</p><p>ç¬¬ä¸€æ­¥ï¼Œåœ¨Modelsæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ªPresonç±»ï¼Œè¿™ä¸ªç±»åŒ…å«ä»£è¡¨å§“åçš„Nameå±æ€§ï¼Œä»£è¡¨æ˜¯å¦ä¸ºVIPçš„IsVIPå±æ€§ï¼Œä»¥åŠä»£è¡¨åˆ›å»ºæ—¥æœŸçš„CreatedTimeå±æ€§ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">record</span> <span class="title">Person</span>(<span class="params"><span class="built_in">string</span> Name,<span class="built_in">bool</span> IsVIP,DateTime CreatedDateTime</span>)</span>;</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒæ­¥ï¼Œåœ¨Controllersæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ªç»§æ‰¿è‡ªControllerç±»çš„TestControllerç±»ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TestController</span> : <span class="title">Controller</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> IActionResult <span class="title">Demo1</span>() <span class="comment">//Action æ–¹æ³•ï¼šæ“ä½œæ–¹æ³•</span></span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//return View();</span></span><br><span class="line">        Person p1=<span class="keyword">new</span> Person(<span class="string">&quot;YOUXIANYU&quot;</span>, <span class="literal">true</span>, DateTime.Now);</span><br><span class="line">        <span class="keyword">return</span> View(p1);    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ§åˆ¶å™¨ä¸­æ–¹æ³•çš„è¿”å›å€¼ä¸€èˆ¬æ˜¯IActionResultç±»å‹çš„ï¼Œæ§åˆ¶å™¨ç±»ä¸­è¢«å¤–ç•Œç›´æ¥è®¿é—®çš„æ–¹æ³•å«ä½œâ€œæ“ä½œæ–¹æ³•â€ã€‚</p><p>Demo1æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†Personç±»çš„å¯¹è±¡ï¼Œå¹¶ä¸”ä¸ºäº†å¯¹è±¡çš„å±æ€§èµ‹äºˆäº†åˆå§‹å€¼ï¼Œæœ€åé€šè¿‡return Viewï¼ˆmode1ï¼‰æ–¹æ³•å‘Šè¯‰æ¡†æ¶â€œè¯·æŠŠmode1è¿™ä¸ªå¯¹è±¡ä¼ é€’ç»™ä¸æ“ä½œæ–¹æ³•åŒåçš„è§†å›¾â€ï¼Œå› æ­¤ç‹‚å°±ä¼šæŠŠmode1å¯¹è±¡ä¼ é€’ç»™åä¸ºDemo1.cshtmlçš„è§†å›¾æ–‡ä»¶ã€‚</p><p>ç¬¬ä¸‰æ­¥ï¼Œåœ¨Viewsæ–‡ä»¶ä¸‹åˆ›å»ºå’ŒTestControlleråç§°å¯¹åº”çš„Testæ–‡ä»¶å¤¹ï¼Œç„¶ååœ¨Testæ–‡ä»¶å¤¹ä¸Šå³å‡»ï¼Œé€‰æ‹©æ·»åŠ Razorè§†å›¾-ç©ºè¿™ä¸ªé¡¹ç›®æ¨¡æ¿ï¼Œæ–‡ä»¶åå¡«å†™Demo1.cshtmlæ–‡ä»¶ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@model WebApplication1.Models.Person</span><br><span class="line">&lt;div&gt;å§“åï¼š@Model.Name&lt;/div&gt;</span><br><span class="line">&lt;div&gt;æ˜¯å¦VIP:@Model.IsVIP&lt;/div&gt;</span><br><span class="line">&lt;div&gt;@Model.CreatedDateTime&lt;/div&gt;</span><br></pre></td></tr></table></figure><p><img src="/img%5CHello%5Clj.png"></p><h3 id="çƒ­é‡è½½"><a href="#çƒ­é‡è½½" class="headerlink" title="çƒ­é‡è½½"></a>çƒ­é‡è½½</h3><p>åœ¨ä»¥è°ƒè¯•æ¨¡å¼è¿è¡ŒASP.NET Coreé¡¹ç›®çš„æ—¶å€™ï¼Œå¦‚æœæˆ‘ä»¬ä¿®æ”¹äº†æœåŠ¡å™¨ç«¯çš„ä»£ç ï¼Œå¿…é¡»ç»ˆæ­¢å¹¶é‡æ–°è¿è¡Œç¨‹åºï¼Œä¿®æ”¹åçš„ä»£ç æ‰èƒ½ç”Ÿæ•ˆã€‚å†æ¯”è¾ƒå¤æ‚çš„é¡¹ç›®ä¸­ï¼Œè¿™æ ·çš„å¼€å‘æµç¨‹éå¸¸éº»çƒ¦ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦é‡æ–°æ‰“å¼€æµè§ˆå™¨ã€é‡æ–°æ‰§è¡Œè¦æµ‹è¯•è¯·æ±‚ã€‚</p><p>å¯ä»¥ç”¨ã€å¯åŠ¨ï¼ˆä¸è°ƒè¯•ï¼‰ã€‘æ–¹æ³•è¿è¡Œé¡¹ç›®ï¼Œç„¶åå†ä¿®æ”¹ä»£ç åï¼Œé‡æ–°ç”Ÿæˆè§£å†³æ–¹æ¡ˆï¼Œè¿™æ ·ä»£ç å°±ç”Ÿæ•ˆäº†ï¼Œä¸éœ€è¦é‡å¯æµè§ˆå™¨ã€‚ä¸è¿‡åœ¨è¿™ç§æ–¹å¼ä¸‹è¿è¡Œç¨‹åºï¼Œæˆ‘ä»¬æ— æ³•è¿›è¡Œè®¾ç½®æ–­ç‚¹ã€æŸ¥çœ‹å˜é‡çš„å€¼ç­‰è°ƒè¯•æ“ä½œã€‚</p><p>è€Œ.NET6å¼€å§‹ï¼Œ.NETä¸­å¢åŠ äº†çƒ­é‡è½½åŠŸèƒ½ï¼Œå®ƒå…è®¸æˆ‘ä»¬åœ¨ä»¥è°ƒè¯•æ–¹å¼è¿è¡Œç¨‹åºçš„æ—¶å€™ï¼Œä¹Ÿæ— é¡»é‡å¯ç¨‹åºè€Œè®©ä¿®æ”¹çš„ä»£ç ç”Ÿæ•ˆã€‚å®ƒçš„ç”¨æ³•å¾ˆç®€å•ï¼Œåªè¦åœ¨ä¿®æ”¹å®Œä»£ç ä»¥åå•å‡»Visual Studioå·¥å…·æ ä¸­çš„çƒ­é‡è½½ã€‚</p><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥å•å‡»çƒ­é‡è½½çš„ä¸‹æ‹‰åˆ—è¡¨ï¼Œå‹¾é€‰ã€æ–‡ä»¶ä¿å­˜æ—¶çƒ­é‡è½½ã€‘ï¼Œè¿™æ ·å½“æˆ‘ä»¬ä¿®æ”¹å®Œä»£ç å¹¶ä¿å­˜æ–‡ä»¶åï¼ŒVisual Studioä¼šè‡ªåŠ¨æ‰§è¡Œçƒ­é‡è½½ï¼Œå¼€å‘å°±æ›´æ–¹ä¾¿ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> EF Core </tag>
            
            <tag> ASP.NET Core </tag>
            
            <tag> Entity Framework Core </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>EF Coreè¡¨è¾¾å¼æ ‘</title>
      <link href="/2025/04/05/asp.net%20core/EFCore%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%A0%91/"/>
      <url>/2025/04/05/asp.net%20core/EFCore%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<h1 id="è¡¨è¾¾å¼æ ‘"><a href="#è¡¨è¾¾å¼æ ‘" class="headerlink" title="è¡¨è¾¾å¼æ ‘"></a>è¡¨è¾¾å¼æ ‘</h1><h2 id="ä»€ä¹ˆæ˜¯è¡¨è¾¾å¼æ ‘"><a href="#ä»€ä¹ˆæ˜¯è¡¨è¾¾å¼æ ‘" class="headerlink" title="ä»€ä¹ˆæ˜¯è¡¨è¾¾å¼æ ‘"></a>ä»€ä¹ˆæ˜¯è¡¨è¾¾å¼æ ‘</h2><p>è¡¨è¾¾å¼æ ‘ï¼ˆexpression treeï¼‰æ˜¯ç”¨æ ‘å½¢æ•°æ®ç»“æ„æ¥è¡¨ç¤ºä»£ç é€»è¾‘è¿ç®—çš„æŠ€æœ¯ï¼Œä»–è®©æˆ‘ä»¬å¯ä»¥åœ¨è¿è¡Œæ—¶è®¿é—®é€»è¾‘è¿ç®—çš„ç»“æ„ã€‚è¡¨è¾¾å¼æ ‘åœ¨.NETä¸­å¯¹åº”Expression&lt;TDelegate&gt;ç±»å‹ã€‚æˆ‘ä»¬æ—¢å¯ä»¥è®©C#ç¼–è¯‘å™¨å¸®æˆ‘ä»¬ä»Lambdaè¡¨è¾¾å¼ç”Ÿæˆè¡¨è¾¾å¼æ ‘ï¼Œä¹Ÿå¯ä»¥åœ¨è¿è¡Œæ—¶é€šè¿‡APIåŠ¨æ€åˆ›å»ºè¡¨è¾¾å¼æ ‘ã€‚</p><p>Lambdaè¡¨è¾¾å¼ç”Ÿæˆè¡¨è¾¾å¼æ ‘ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Expression&lt;Func&lt;House, <span class="built_in">bool</span>&gt;&gt; expression = h =&gt; h.Price &gt; <span class="number">5</span>;</span><br><span class="line">Expression&lt;Func&lt;House, House,<span class="built_in">double</span>&gt;&gt;h2 = h2=(b1,b2)=&gt;b1.Price + b2.Price;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘å™¨ä¼šæŠŠ&#x3D;&gt;b.Price&gt;5è¿™ä¸ªè¡¨è¾¾å¼æ„å»ºæˆExpressionå¯¹è±¡ï¼ˆè¡¨è¾¾å¼æ ‘å¯¹è±¡ï¼‰ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªè¡¨è¾¾å¼æ ‘å¯¹è±¡è¿›è¡Œæ•°æ®æŸ¥è¯¢äº†ã€‚</p><h2 id="Expressionå’Œå§”æ‰˜çš„å…³ç³»"><a href="#Expressionå’Œå§”æ‰˜çš„å…³ç³»" class="headerlink" title="Expressionå’Œå§”æ‰˜çš„å…³ç³»"></a>Expressionå’Œå§”æ‰˜çš„å…³ç³»</h2><p>æŠŠExpression&lt;Func&lt;House,bool&gt;&gt;æ¢æˆFunc&lt;House,bool&gt;,å†™æˆä¸‹é¢çš„ç‰ˆæœ¬ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Func&lt;House,<span class="built_in">bool</span>&gt; func = h =&gt; h.Price &gt; <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">db.Houses.Where(func).ToList();</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹SQLè¯­å¥</p><p>Expression<br><img src="/img%5CHello%5Cai.png"></p><p>Func<br><img src="/img%5CHello%5Cai.png"></p><p>æˆ‘ä»¬å‘ç°æŸ¥è¯¢Funcç”Ÿæˆçš„SQLè¯­å¥æ²¡æœ‰b.Price&gt;5è¿™ä¸ªé€»è¾‘çš„ï¼Œè¯´æ˜è¿™ä¸ªç‰ˆæœ¬æ˜¯é€šè¿‡å®¢æˆ·ç«¯è¯„ä¼°å®Œæˆçš„ã€‚å› æ­¤ï¼Œä¸ºäº†èƒ½å¤Ÿæ­£å¸¸åœ°ä½¿ç”¨EF Core,æˆ‘ä»¬ä¸€å®šè¦ä½¿ç”¨Expression&lt;TDelegate&gt;ç±»å‹ã€‚</p><p>Expressionå¯¹è±¡å­˜å‚¨äº†è¿ç®—é€»è¾‘ï¼Œä»–æŠŠè¿ç®—é€»è¾‘ä¿å­˜æˆæŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰ï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€è·å–è¿ç®—é€»è¾‘ã€‚è€Œæ™®é€šå§”æ‰˜æ²¡æœ‰ã€‚</p><p>å¤ªéš¾äº†ï¼Œä»¥åå†å­¦</p>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> EF Core </tag>
            
            <tag> ASP.NET Core </tag>
            
            <tag> Entity Framework Core </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>EF Coreå¹¶å‘æ§åˆ¶</title>
      <link href="/2025/04/04/asp.net%20core/EF%20Core%E7%9A%84%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E5%88%A9%E5%99%A8/"/>
      <url>/2025/04/04/asp.net%20core/EF%20Core%E7%9A%84%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E5%88%A9%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="EF-Coreä¼˜åŒ–ä¹‹AsNoTracking"><a href="#EF-Coreä¼˜åŒ–ä¹‹AsNoTracking" class="headerlink" title="EF Coreä¼˜åŒ–ä¹‹AsNoTracking"></a>EF Coreä¼˜åŒ–ä¹‹AsNoTracking</h1><p>EF Coreé»˜è®¤ä¼šå¯¹é€šè¿‡ä¸Šä¸‹æ–‡æŸ¥è¯¢å‡ºæ¥çš„æ‰€æœ‰å®ä½“ç±»è¿›è¡Œè·Ÿè¸ªï¼Œä»¥ä¾¿äºåœ¨æ‰§è¡ŒSaveChangesçš„æ—¶å€™æŠŠå®ä½“ç±»çš„æ”¹å˜åŒæ­¥åˆ°æ•°æ®åº“ä¸­ã€‚ä¸Šä¸‹æ–‡ä¸ä»…ä¼šè·Ÿè¸ªå¯¹è±¡çš„çŠ¶æ€æ”¹å˜ï¼Œè¿˜ä¼šé€šè¿‡å¿«ç…§çš„æ–¹å¼è®°å½•å®ä½“ç±»çš„åŸå§‹å€¼ï¼Œè¿™æ˜¯æ¯”è¾ƒæ¶ˆè€—èµ„æºçš„ã€‚<br>å› æ­¤ï¼Œå¦‚æœå¼€å‘äººå‘˜èƒ½å¤Ÿç¡®è®¤é€šè¿‡ä¸Šä¸‹æ–‡æŸ¥è¯¢å‡ºæ¥çš„å¯¹è±¡åªæ˜¯ç”¨æ¥å±•ç¤ºï¼Œä¸ä¼šå‘ç”ŸçŠ¶æ€æ”¹å˜ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨AsNoTrackingæ–¹æ³•å‘Šè¯‰IQueryableåœ¨æŸ¥è¯¢çš„æ—¶å€™â€œç¦ç”¨è·Ÿè¸ªâ€ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Blog[] blogs = ctx.Blogs.AsNoTracking().Take(<span class="number">3</span>).ToArray();</span><br><span class="line">Blog b1 = blogs[<span class="number">0</span>];</span><br><span class="line">b1.Id = <span class="number">100</span>;</span><br><span class="line">EntityEntry entry1=ctx.Entry(b1);</span><br><span class="line">Console.WriteLine(entry1.State);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç çš„æ‰§è¡Œç»“æœæ˜¯â€œDetachedâ€,ä¹Ÿå°±è¯´ä½¿ç”¨AsNoTrackingæŸ¥è¯¢å‡ºæ¥çš„å®ä½“ç±»æ˜¯ä¸è¢«ä¸Šä¸‹æ–‡è·Ÿè¸ªçš„ã€‚<br>å› æ­¤ï¼Œåœ¨é¡¹ç›®å¼€å‘ä¸­ï¼Œå¦‚æœæˆ‘ä»¬æŸ¥è¯¢å‡ºæ¥çš„å¯¹è±¡ä¸ä¼šè¢«ä¿®æ”¹ã€åˆ é™¤ç­‰ï¼Œé‚£ä¹ˆåœ¨æŸ¥è¯¢çš„æ—¶å€™ï¼Œå¯ä»¥å¯ç”¨AsNoTrackingï¼Œè¿™æ ·å°±èƒ½é™ä½EF Coreçš„èµ„æºå ç”¨ã€‚</p><h1 id="EF-Coreä¸­æ‰¹é‡åˆ é™¤å’Œæ›´æ–°æ•°æ®"><a href="#EF-Coreä¸­æ‰¹é‡åˆ é™¤å’Œæ›´æ–°æ•°æ®" class="headerlink" title="EF Coreä¸­æ‰¹é‡åˆ é™¤å’Œæ›´æ–°æ•°æ®"></a>EF Coreä¸­æ‰¹é‡åˆ é™¤å’Œæ›´æ–°æ•°æ®</h1><p>åˆ é™¤ Age å¤§äº 10 çš„æ•°æ®</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">await</span>Â <span class="keyword">using</span>Â <span class="keyword">var</span>Â dbÂ =Â <span class="keyword">new</span>Â MyDbContext();</span><br><span class="line"><span class="keyword">await</span>Â db.MyEntities.Where(<span class="keyword">static</span>Â xÂ =&gt;Â x.AgeÂ &gt;Â <span class="number">10</span>).ExecuteDeleteAsync();</span><br></pre></td></tr></table></figure><p>æ‰€æœ‰å‘˜å·¥çš„å·¥èµ„å¢åŠ  1000</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">await</span> context.Employees.ExecuteUpdateAsync</span><br><span class="line">(s =&gt; s.SetProperty(e =&gt; e.Salary, e =&gt; e.Salary + <span class="number">1000</span>));</span><br></pre></td></tr></table></figure><h1 id="å…¨å±€æŸ¥è¯¢ç­›é€‰å™¨"><a href="#å…¨å±€æŸ¥è¯¢ç­›é€‰å™¨" class="headerlink" title="å…¨å±€æŸ¥è¯¢ç­›é€‰å™¨"></a>å…¨å±€æŸ¥è¯¢ç­›é€‰å™¨</h1><p>EF Coreæ”¯æŒåœ¨é…ç½®å®ä½“ç±»çš„æ—¶å€™ï¼Œä¸ºå®ä½“ç±»è®¾ç½®å…¨å±€æŸ¥è¯¢ç­›é€‰å™¨ï¼ŒEF Coreä¼šè‡ªåŠ¨å°†å…¨å±€æŸ¥è¯¢ç­›é€‰å™¨åº”ç”¨äºæ¶‰åŠè¿™ä¸ªå®ä½“ç±»å‹çš„æ‰€æœ‰LINQæŸ¥è¯¢ã€‚è¿™ä¸ªåŠŸèƒ½å¸¸è§çš„åº”ç”¨åœºæ™¯æœ‰â€œè½¯åˆ é™¤â€å’Œâ€œå¤šç§Ÿæˆ·â€ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ç»™å¯¹åº”å®ä½“ç±»è®¾ç½®ä¸€ä¸ªå…¨å±€ç­›é€‰å™¨ï¼Œè¿™æ ·æ‰€æœ‰çš„æŸ¥è¯¢éƒ½ä¼šè‡ªåŠ¨å¢åŠ å…¨å±€æŸ¥è¯¢ç­›å™¨ï¼Œè¢«è½¯åˆ é™¤çš„æ•°æ®å°±ä¼šè‡ªåŠ¨ä»æŸ¥è¯¢ç»“æœä¸­è¿‡æ»¤æ‰ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬ç»™å®ä½“ç±»å¢åŠ ä¸€ä¸ªboolç±»å‹çš„å±æ€§IsDeleted,å¦‚æœå¯¹åº”çš„æ•°æ®è¢«æ ‡è®°ä¸ºå·²åˆ é™¤ï¼Œé‚£ä¹ˆIsDeletedçš„å€¼å°±ä¼štrueï¼Œå¦åˆ™å°±æ˜¯falseã€‚<br>åœ¨å®ä½“ç±»çš„Fluent APIä¸­å¢åŠ ä¸€å¥ä»£ç ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnModelCreating</span>(<span class="params">ModelBuilder modelBuilder</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    modelBuilder.Entity&lt;Blog&gt;().ToTable(<span class="string">&quot;Blog&quot;</span>)</span><br><span class="line">        .HasQueryFilter(b =&gt; b.IsDeleted == <span class="literal">false</span>)<span class="comment">//å…¨å±€ç­›é€‰å™¨</span></span><br><span class="line">        .HasMany(b =&gt; b.Posts)</span><br><span class="line">        .WithOne(p =&gt; p.Blog)</span><br><span class="line">        .HasForeignKey(p =&gt; p.BlogId);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ‚²è§‚å¹¶å‘æ§åˆ¶"><a href="#æ‚²è§‚å¹¶å‘æ§åˆ¶" class="headerlink" title="æ‚²è§‚å¹¶å‘æ§åˆ¶"></a>æ‚²è§‚å¹¶å‘æ§åˆ¶</h1><p>EF Coreæ²¡æœ‰å°è£…æ‚²è§‚å¹¶å‘æ§åˆ¶çš„ä½¿ç”¨ï¼Œéœ€è¦å¼€å‘äººå‘˜ç¼–å†™åŸç”ŸSQLè¯­å¥æ¥ä½¿ç”¨æ‚²è§‚å¹¶å‘æ§åˆ¶ã€‚ä¸åŒæ•°æ®åº“çš„è¯­æ³•ä¸ä¸€æ ·ã€‚<br>MySQL</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">Console.WriteLine(<span class="string">&quot;è¯·è¾“å…¥æ‚¨çš„å§“å&quot;</span>);</span><br><span class="line"><span class="built_in">string</span> name = Console.ReadLine();</span><br><span class="line"><span class="keyword">using</span> MyDbContext ctx = <span class="keyword">new</span> MyDbContext();</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">var</span> tx = <span class="keyword">await</span> ctx.Database.BeginTransactionAsync();<span class="comment">//äº‹åŠ¡</span></span><br><span class="line">Console.WriteLine(<span class="string">&quot;å‡†å¤‡Select &quot;</span> + DateTime.Now.TimeOfDay);</span><br><span class="line"><span class="keyword">var</span> h1 = <span class="keyword">await</span> ctx.Houses.FromSqlInterpolated(<span class="string">$&quot;select * from T_Houses where Id=1 for update&quot;</span>)</span><br><span class="line">.SingleAsync();</span><br><span class="line">Console.WriteLine(<span class="string">&quot;å®ŒæˆSelect &quot;</span> + DateTime.Now.TimeOfDay);</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrEmpty(h1.Owner))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">await</span> Task.Delay(<span class="number">5000</span>);</span><br><span class="line">h1.Owner = name;</span><br><span class="line"><span class="keyword">await</span> ctx.SaveChangesAsync();</span><br><span class="line">Console.WriteLine(<span class="string">&quot;æŠ¢åˆ°æ‰‹äº†&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (h1.Owner == name)</span><br><span class="line">&#123;</span><br><span class="line">Console.WriteLine(<span class="string">&quot;è¿™ä¸ªæˆ¿å­å·²ç»æ˜¯ä½ çš„äº†ï¼Œä¸ç”¨æŠ¢&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">Console.WriteLine(<span class="string">$&quot;è¿™ä¸ªæˆ¿å­å·²ç»è¢«<span class="subst">&#123;h1.Owner&#125;</span>æŠ¢èµ°äº†&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">await</span> tx.CommitAsync();</span><br><span class="line">Console.ReadKey();</span><br></pre></td></tr></table></figure><h1 id="ä¹è§‚å¹¶å‘æ§åˆ¶"><a href="#ä¹è§‚å¹¶å‘æ§åˆ¶" class="headerlink" title="ä¹è§‚å¹¶å‘æ§åˆ¶"></a>ä¹è§‚å¹¶å‘æ§åˆ¶</h1><p>ä¸¤ç§æ–¹æ¡ˆï¼šå¹¶å‘ä»¤ç‰Œã€RowVersion<br>å¦‚æœæœ‰ä¸€ä¸ªç¡®å®šçš„å­—æ®µè¦è¢«è¿›è¡Œå¹¶å‘æ§åˆ¶ï¼Œé‚£ä¹ˆä½¿ç”¨IsConcurrencyToken()æŠŠè¿™ä¸ªå­—æ®µè®¾ç½®ä¸ºå¹¶å‘ä»¤ç‰Œå³å¯ï¼›<br>å¦‚æœæ— æ³•ç¡®å®šä¸€ä¸ªå”¯ä¸€çš„å¹¶å‘ä»¤ç‰Œåˆ—ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¼•å…¥ä¸€ä¸ªé¢å¤–çš„å±æ€§è®¾ç½®ä¸ºå¹¶å‘ä»¤ç‰Œï¼Œå¹¶ä¸”åœ¨æ¯æ¬¡æ›´æ–°æ•°æ®çš„æ—¶å€™ï¼Œæ‰‹åŠ¨æ›´æ–°è¿™ä¸€åˆ—çš„å€¼ã€‚å¦‚æœç”¨çš„æ˜¯SQLServeræ•°æ®åº“ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥é‡‡ç”¨RowVersionåˆ—ï¼Œè¿™æ ·å°±ä¸ç”¨å¼€å‘è€…æ‰‹åŠ¨æ¥åœ¨æ¯æ¬¡æ›´æ–°æ•°æ®çš„æ—¶å€™ï¼Œæ‰‹åŠ¨æ›´æ–°å¹¶å‘ä»¤ç‰Œçš„å€¼äº†ã€‚</p><p>ä¹è§‚å¹¶å‘æ§åˆ¶çš„åŸç†</p><blockquote><p>Update T_Houses set Owner&#x3D;æ–°å€¼<br>where Id&#x3D;i and Owner&#x3D;æ—§å€¼</p></blockquote><p>ä¸¾ä¾‹å­ï¼šå½“Updateçš„æ—¶å€™ï¼Œå¦‚æœæ•°æ®åº“ä¸­çš„Ownerå€¼å·²ç»è¢«å…¶ä»–æ“ä½œè€…æ›´æ–°ä¸ºå…¶ä»–å€¼äº†ï¼Œé‚£ä¹ˆwhereè¯­å¥çš„å€¼å°±ä¼šä¸ºfalse,å› æ­¤è¿™ä¸ªUpdateè¯­å¥å½±å“çš„è¡Œæ•°å°±æ˜¯0ï¼ŒEF Coreå°±çŸ¥é“â€œå‘ç”Ÿå¹¶å‘å†²çªâ€äº†ï¼Œå› æ­¤SaveChanges()æ–¹æ³•å°±ä¼šæŠ›å‡ºDbUpateConcurrencyExceptionå¼‚å¸¸ã€‚</p><p>1.æŠŠè¢«å¹¶å‘ä¿®æ”¹çš„å±æ€§ä½¿ç”¨IsConcurrencyToken()è®¾ç½®ä¸ºå¹¶å‘ä»¤ç‰Œã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">modelBuilder.Entity&lt;Blog&gt;().ToTable(<span class="string">&quot;Blog&quot;</span>)</span><br><span class="line">    .Property(e =&gt; e.Owner).IsConcurrencyToken();</span><br></pre></td></tr></table></figure><p>MySQL</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">Console.WriteLine(<span class="string">&quot;è¯·è¾“å…¥æ‚¨çš„å§“å&quot;</span>);</span><br><span class="line"><span class="built_in">string</span> name = Console.ReadLine();</span><br><span class="line"><span class="keyword">using</span> MyDbConfigText ctx = <span class="keyword">new</span> MyDbConfigText() ;</span><br><span class="line"><span class="keyword">var</span> h1 = <span class="keyword">await</span> ctx.Blogs.SingleAsync(h =&gt; h.Id == <span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrEmpty(h1.Owner))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">await</span> Task.Delay(<span class="number">5000</span>);</span><br><span class="line">    h1.Owner = name;</span><br><span class="line">    <span class="keyword">try</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">await</span> ctx.SaveChangesAsync();</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;æŠ¢åˆ°æ‰‹äº†&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (DbUpdateConcurrencyException ex)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> entry = ex.Entries.First();</span><br><span class="line">        <span class="keyword">var</span> dbValues = <span class="keyword">await</span> entry.GetDatabaseValuesAsync();</span><br><span class="line">        <span class="built_in">string</span> newOwner = dbValues.GetValue&lt;<span class="built_in">string</span>&gt;(<span class="keyword">nameof</span>(Blog.Owner));</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;å¹¶å‘å†²çªï¼Œè¢«<span class="subst">&#123;newOwner&#125;</span>æå‰æŠ¢èµ°äº†&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (h1.Owner == name)</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;è¿™ä¸ªæˆ¿å­å·²ç»æ˜¯ä½ çš„äº†ï¼Œä¸ç”¨æŠ¢&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;è¿™ä¸ªæˆ¿å­å·²ç»è¢«<span class="subst">&#123;h1.Owner&#125;</span>æŠ¢èµ°äº†&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">Console.ReadLine();</span><br></pre></td></tr></table></figure><h3 id="SQLServerçš„ROWVERSION"><a href="#SQLServerçš„ROWVERSION" class="headerlink" title="SQLServerçš„ROWVERSION"></a>SQLServerçš„ROWVERSION</h3><p>SQLServeræ•°æ®åº“å¯ä»¥ç”¨ä¸€ä¸ªbyte[]ç±»å‹çš„å±æ€§åšå¹¶å‘ä»¤ç‰Œå±æ€§ï¼Œç„¶åä½¿ç”¨IsRowVersion()æŠŠè¿™ä¸ªå±æ€§è®¾ç½®ä¸ºRowVersionç±»å‹ï¼Œè¿™æ ·è¿™ä¸ªå±æ€§å¯¹åº”çš„æ•°æ®åº“åˆ—å°±ä¼šè¢«è®¾ç½®ä¸ºROWVERSIONç±»å‹ã€‚å¯¹äºROWVERSIONç±»å‹çš„åˆ—ï¼Œåœ¨æ¯æ¬¡æ’å…¥æˆ–æ›´æ–°è¡Œæ—¶ï¼Œæ•°æ®åº“ä¼šè‡ªåŠ¨ä¸ºè¿™ä¸€è¡Œçš„ROWVERSIONç±»å‹çš„åˆ—å…¶ç”Ÿæˆæ–°å€¼ã€‚<br>åœ¨SQLServerä¸­ï¼Œtimestampå’Œrowversionæ˜¯åŒä¸€ç§ç±»å‹çš„ä¸åŒåˆ«åè€Œå·²ã€‚</p><p>æˆ‘ä»¬å…ˆå®šä¹‰ä¸€ä¸ªbyte[]ç±»å‹å±æ€§çš„Houseç±»</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">House</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Owner &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">byte</span>[] RowVer &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹Houseå®ä½“ç±»è¿›è¡Œé…ç½®ï¼Œå¯¹RowVerå±æ€§è®¾ç½®IsRowVersionã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">EntityTypeBuilder&lt;House&gt; builder</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    builder.ToTable(<span class="string">&quot;T_Houses&quot;</span>);</span><br><span class="line">    builder.Property(h =&gt; h.Name).IsRequired();</span><br><span class="line">    <span class="comment">//builder.Property(h=&gt;h.Owner).IsConcurrencyToken();</span></span><br><span class="line">    builder.Property(h =&gt; h.RowVer).IsRowVersion();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> EF Core </tag>
            
            <tag> ASP.NET Core </tag>
            
            <tag> Entity Framework Core </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>EF CoreåŸç†æ­ç§˜</title>
      <link href="/2025/04/03/asp.net%20core/EF%20Core%E9%AB%98%E7%BA%A7%E6%8A%80%E6%9C%AF/"/>
      <url>/2025/04/03/asp.net%20core/EF%20Core%E9%AB%98%E7%BA%A7%E6%8A%80%E6%9C%AF/</url>
      
        <content type="html"><![CDATA[<h1 id="EF-CoreåŸç†æ­ç§˜"><a href="#EF-CoreåŸç†æ­ç§˜" class="headerlink" title="EF CoreåŸç†æ­ç§˜"></a>EF CoreåŸç†æ­ç§˜</h1><h2 id="æ—¢ç”ŸIEnumerable-ä½•ç”ŸIQueryable"><a href="#æ—¢ç”ŸIEnumerable-ä½•ç”ŸIQueryable" class="headerlink" title="æ—¢ç”ŸIEnumerable,ä½•ç”ŸIQueryable"></a>æ—¢ç”ŸIEnumerable,ä½•ç”ŸIQueryable</h2><p>å¯ä»¥ä½¿ç”¨LINQä¸­çš„Whereç­‰æ–¹æ³•å¯¹æ™®é€šé›†åˆè¿›è¡Œå¤„ç†ã€‚æ¯”å¦‚ä¸‹é¢çš„C#ä»£ç å¯ä»¥æŠŠintæ•°ç»„ä¸­å¤§äº10çš„æ•°æ®å–å‡ºæ¥ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span>[] nums=&#123;<span class="number">3</span>,<span class="number">5</span>,<span class="number">933</span>,<span class="number">2</span>,<span class="number">69</span>,<span class="number">69</span>,<span class="number">11</span>&#125;;</span><br><span class="line">IEnumerable&lt;<span class="built_in">int</span>&gt; items=nums.Where(n=&gt;n&gt;<span class="number">10</span>);</span><br></pre></td></tr></table></figure><p>Whereæ–¹æ³•ä¸­ï¼Œè½¬åˆ°å®šä¹‰ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œè°ƒç”¨çš„Whereæ–¹æ³•æ˜¯Enumerableç±»ä¸­çš„æ‰©å±•æ–¹æ³•ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">IEnumerable</span>&lt;<span class="title">TSource</span>&gt; <span class="title">Where</span>&lt;<span class="title">TSource</span>&gt;(<span class="params"><span class="keyword">this</span> IEnumerable&lt;TSource&gt; source,Func&lt;TSoure,<span class="built_in">bool</span>&gt; predicate</span>)</span>;</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥åœ¨EF Coreçš„DbSetç±»å‹ä¸Šè°ƒç”¨Whereä¹‹ç±»çš„æ–¹æ³•è¿›è¡Œæ•°æ®çš„ç­›é€‰ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IQueryable&lt;Book&gt; books=ctx.Books.Where(b=&gt;b.Price&gt;<span class="number">1.1</span>);</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹è¿™é‡Œè°ƒç”¨çš„Whereæ–¹æ³•çš„å£°æ˜ï¼Œæˆ‘ä»¬ä¼šå‘ç°å®ƒæ˜¯å®šä¹‰åœ¨Querybleç±»ä¸­çš„æ‰©å±•æ–¹æ³•</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">IQueryable</span>&lt;<span class="title">TSource</span>&gt; <span class="title">Where</span>&lt;<span class="title">TSource</span>&gt;(<span class="params"><span class="keyword">this</span> IQueryable&lt;TSource&gt; source,EXpression&lt;Func&lt;TSource,<span class="built_in">bool</span>&gt;&gt; predicate</span>)</span>;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªWhereæ–¹æ³•æ˜¯ä¸€ä¸ªIQueryable&lt;TSource&gt;ç±»å‹çš„æ‰©å±•æ–¹æ³•ï¼Œè¿”å›å€¼æ˜¯IQueryable<TSource>ç±»å‹ã€‚IQueryableå…¶å®å°±æ˜¯ä¸€ä¸ªç»§æ‰¿äº†IEnumerableæ¥å£çš„æ¥å£ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IQuryable</span>&lt;<span class="keyword">out</span> <span class="title">T</span>&gt;:<span class="title">IEnumerable</span>&lt;<span class="title">T</span>&gt;,<span class="title">IEnumerable</span>,<span class="title">IQueryable</span>&#123;&#125;</span><br></pre></td></tr></table></figure><p>IQuryableæ¥å£å°±æ˜¯ç»§æ‰¿è‡ªIEnumerableæ¥å£çš„ï¼›IQueryableç±»ä¸­çš„Whereæ–¹æ³•é™¤äº†å‚æ•°å’Œè¿”å›å€¼çš„ç±»å‹æ˜¯IQueryable,å…¶ä»–ç”¨æ³•å’ŒI&#x2F;Enumerableç±»å‹çš„Whereæ–¹æ³•æ²¡æœ‰ä»€ä¹ˆä¸åŒã€‚<br>Whereæ–¹æ³•ä¼šåœ¨å†…å­˜ä¸­å¯¹æ¯æ¡æ•°æ®è¿›è¡Œè¿‡æ»¤ï¼Œè€ŒEF Coreå¦‚æœä¹ŸæŠŠå…¨éƒ¨æ•°æ®éƒ½åœ¨å†…å­˜ä¸­è¿›è¡Œè¿‡æ»¤ï¼Œå¦‚æœæ•°æ®é‡éå¸¸å¤§ï¼Œå°±ä¼šæœ‰æ€§èƒ½é—®é¢˜ã€‚å› æ­¤EF Coreä¸­çš„Whereå®ç°å¿…é¡»æœ‰ä¸€å¥—â€œæŠŠWhereæ¡ä»¶è½¬æ¢ä¸ºSQLè¯­å¥â€çš„æœºåˆ¶ï¼Œè®©æ•°æ®çš„ç­›é€‰åœ¨æ•°æ®åº“æœåŠ¡å™¨ä¸Šæ‰§è¡Œã€‚<br>Enumerableç±»ä¸­å®šä¹‰çš„ä¾›æ™®é€šé›†åˆç”¨çš„Whereç­‰æ–¹æ³•éƒ½æ˜¯â€œå®¢æˆ·ç«¯è¯„ä¼°â€ï¼Œå› æ­¤å¾®è½¯åˆ›é€ äº†IQueryableç±»å‹ï¼Œå¹¶ä¸”åœ¨Queryableç­‰ç±»ä¸­å®šä¹‰äº†å’ŒEnumerableç±»ä¸­ç±»ä¼¼çš„Whereç­‰æ–¹æ³•ã€‚Queryableä¸­å®šä¹‰çš„Whereæ–¹æ³•æ”¯æŒæŠŠLINQæŸ¥è¯¢è½¬åŒ–ä¸ºSQLè¯­å¥ã€‚æˆ‘ä»¬å°½é‡è°ƒç”¨IQueryableç‰ˆæœ¬çš„æ–¹æ³•ã€‚</p><h2 id="IQueryableçš„å»¶è¿Ÿæ‰§è¡Œ"><a href="#IQueryableçš„å»¶è¿Ÿæ‰§è¡Œ" class="headerlink" title="IQueryableçš„å»¶è¿Ÿæ‰§è¡Œ"></a>IQueryableçš„å»¶è¿Ÿæ‰§è¡Œ</h2><p> IQueryableä¸ä»…å¯ä»¥å¸¦æ¥â€œæœåŠ¡å™¨æ®µè¯„ä¼°â€è¿™ä¸ªåŠŸèƒ½ï¼Œè€Œä¸”æä¾›äº†å»¶è¿Ÿæ‰§è¡Œçš„åŠŸèƒ½ã€‚</p><p> æ²¡æœ‰éå†çš„æŸ¥è¯¢<br> <figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">IQueryable&lt;Article&gt; articles = ctx.Articles.Include(a =&gt; a.Comments);</span><br><span class="line">Console.WriteLine(articles);</span><br></pre></td></tr></table></figure><br>ä»æ—¥å¿—ç»“æœè¾“å‡ºå¯ä»¥çœ‹å‡ºï¼Œä¸Šé¢çš„ä»£ç ç«Ÿç„¶æ²¡æœ‰æ‰§è¡ŒSQLè¯­å¥ï¼Œè€Œæˆ‘ä»¬æ˜æ˜æ‰§è¡Œäº†Whereæ–¹æ³•è¿›è¡Œæ•°æ®çš„è¿‡æ»¤æŸ¥è¯¢ã€‚</p><p>éå†æŸ¥è¯¢</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Console.WriteLine(<span class="string">&quot;1.Whereä¹‹å‰&quot;</span>);</span><br><span class="line">IQueryable&lt;Article&gt; articles1 = ctx.Articles.Where(b =&gt; b.Id &gt; <span class="number">2</span>);</span><br><span class="line">Console.WriteLine(<span class="string">&quot;2.éå†Whereä¹‹å‰&quot;</span>);</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> b <span class="keyword">in</span> articles1)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(b.Title+<span class="string">&quot;:&quot;</span>+b.Id);</span><br><span class="line">&#125;</span><br><span class="line">Console.WriteLine(<span class="string">&quot;3.éå†Whereä¹‹å&quot;</span>);</span><br></pre></td></tr></table></figure><p>ä»”ç»†è§‚å¯Ÿä¸Šé¢çš„ç¨‹åºçš„æ—¥å¿—è¾“å‡ºç»“æœçš„SQLè¯­å¥ã€â€œ2.éå†Whereä¹‹å‰â€å’Œâ€œ3.éå†Whereä¹‹åâ€çš„è¾“å‡ºé¡ºåºã€‚æŒ‰ç…§C#ä¸­çš„ä»£ç ï¼ŒWhereè°ƒç”¨çš„ä»£ç åœ¨â€œ2.éå†Whereä¹‹å‰â€çš„å‰é¢æ‰§è¡Œï¼Œä½†æ˜¯åœ¨æ‰§è¡Œç»“æœä¸­ï¼ŒSQLè¯­å¥åè€Œåœ¨â€œ2.éå†Whereä¹‹å‰â€çš„åé¢æ‰§è¡Œï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ<br>IQueryableåªæ˜¯ä»£è¡¨â€œå¯ä»¥æ”¾åˆ°æ•°æ®åº“æœåŠ¡å™¨ä¸­æ‰§è¡Œçš„æŸ¥è¯¢â€ï¼Œä»–æ²¡æœ‰ç«‹å³æ‰§è¡Œï¼Œåªæ˜¯â€œå¯ä»¥è¢«æ‰§è¡Œâ€è€Œå·²ã€‚å…¶å®å¯ä»¥ä»IQueryableç±»å‹çš„è‹±æ–‡å«ä¹‰çœ‹å‡ºæ¥ï¼Œâ€œIQueryableâ€çš„æ„æ€æ˜¯â€œå¯æŸ¥è¯¢çš„â€ï¼Œå¯ä»¥æŸ¥è¯¢ï¼Œä½†æ˜¯æ²¡æœ‰æ‰§è¡ŒæŸ¥è¯¢ï¼ŒæŸ¥è¯¢çš„æ‰§è¡Œè¢«å»¶è¿Ÿäº†ã€‚</p><p>é‚£ä¹ˆIQueryableä»€ä¹ˆæ—¶å€™æ‰ä¼šæ‰§è¡ŒæŸ¥è¯¢å‘¢ï¼Ÿä¸€ä¸ªåŸåˆ™å°±æ˜¯ï¼šå¯¹äºIQueryableæ¥å£ï¼Œè°ƒç”¨â€œéç«‹å³æ‰§è¡Œâ€æ–¹æ³•çš„æ—¶å€™ä¸ä¼šæ‰§è¡ŒæŸ¥è¯¢ï¼Œè€Œè°ƒç”¨â€œç«‹å³æŸ¥è¯¢â€æ–¹æ³•çš„æ—¶å€™åˆ™ä¼šç«‹å³æ‰§è¡ŒæŸ¥è¯¢ã€‚åˆ¤æ–­ä¸€ä¸ªæ–¹æ³•æ˜¯å¦æ˜¯ç«‹å³æ‰§è¡Œæ–¹æ³•çš„ç®€å•æ–¹å¼æ˜¯ï¼šä¸€ä¸ªæ–¹æ³•çš„è¿”å›å€¼ç±»å‹å¦‚æœæ˜¯IQueryableç±»å‹ï¼Œè¿™ä¸ªæ–¹æ³•ä¸€èˆ¬å°±æ˜¯éç«‹å³æ‰§è¡ŒæŸ¥è¯¢æ–¹æ³•ï¼Œå¦åˆ™è¿™ä¸ªæ–¹æ³•å°±æ˜¯ç«‹å³æ‰§è¡Œæ–¹æ³•ã€‚</p><h3 id="åˆ†å¸ƒæ„å»ºIQueryable"><a href="#åˆ†å¸ƒæ„å»ºIQueryable" class="headerlink" title="åˆ†å¸ƒæ„å»ºIQueryable"></a>åˆ†å¸ƒæ„å»ºIQueryable</h3><p>EF Coreä¸ºä»€ä¹ˆè¦å®ç°â€œIQueryableå»¶è¿Ÿæ‰§è¡Œâ€è¿™æ ·å¤æ‚çš„æœºåˆ¶å‘¢ï¼Ÿå› ä¸ºæˆ‘ä»¬å¯ä»¥å…ˆä½¿ç”¨IQueryableæ‹¼æ¥å‡ºå¤æ‚çš„æŸ¥è¯¢æ¡ä»¶ï¼Œå†å»æ‰§è¡ŒæŸ¥è¯¢ã€‚<br>æ¯”å¦‚ï¼šå®šä¹‰ä¸€ä¸ªæ–¹æ³•æ ¹æ®ç»™å®šçš„å…³é”®å­—srarchWordsæŸ¥è¯¢åŒ¹é…çš„ä¹¦ï¼›å¦‚æœsearchAllå‚æ•°æ˜¯trueï¼Œåˆ™ä¹¦åæˆ–è€…ä½œè€…åä¸­å«æœ‰ç»™å®šçš„searchWordséƒ½åŒ¹é…ï¼Œå¦åˆ™åªåŒ¹é…ä¹¦åï¼›å¦‚æœorderByPriceå‚æ•°ä¸ºtrueï¼Œåˆ™æŒ‰ç…§ä»·æ ¼æ’åºï¼Œå¦è€…å°±è‡ªç„¶æ’åºï¼›upperPriceå‚æ•°ä»£è¡¨ä»·æ ¼ä¸Šé™ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">QueryBooks</span>(<span class="params"><span class="built_in">string</span> searchWords,<span class="built_in">bool</span> searchAll,<span class="built_in">bool</span> orderByPirce,<span class="built_in">double</span> upperPrice</span>)</span></span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">QueryBooks(<span class="string">&quot;çˆ±&quot;</span>,<span class="literal">true</span>,<span class="literal">true</span>,<span class="number">30</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">QueryBooks</span>(<span class="params"><span class="built_in">string</span> searchWords,<span class="built_in">bool</span> searchAll,<span class="built_in">bool</span> orderByPrice,<span class="built_in">double</span> upperPrice</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">using</span> TestDbContext ctx=<span class="keyword">new</span> TestDbContext();</span><br><span class="line">    IQueryable&lt;Book&gt; books=ctx.Books.Where(b=&gt;b.Price&lt;=upperPrice);</span><br><span class="line">    <span class="keyword">if</span>(searchAll)</span><br><span class="line">    &#123;</span><br><span class="line">        books=books.Where(b=&gt;b.Title.Contains(searchWords)||b.AuthorName.Contains(searchWords));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        books=books.Where(b=&gt;b.Title.Contains(searchWhords));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(orderByPice)</span><br><span class="line">    &#123;</span><br><span class="line">        books=books.OrderBy(b=&gt;b.Price);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">foreach</span>(Book b <span class="keyword">in</span> books)</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;<span class="subst">&#123;b.Id&#125;</span>,<span class="subst">&#123;b.Title&#125;</span>,<span class="subst">&#123;b.Price&#125;</span>,<span class="subst">&#123;b.AuthorName&#125;</span>&quot;</span>);    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="EF-Coreåˆ†é¡µæŸ¥è¯¢"><a href="#EF-Coreåˆ†é¡µæŸ¥è¯¢" class="headerlink" title="EF Coreåˆ†é¡µæŸ¥è¯¢"></a>EF Coreåˆ†é¡µæŸ¥è¯¢</h2><p>å¦‚æœæ•°æ®åº“è¡¨ä¸­å›½çš„æ•°æ®æ¯”è¾ƒå¤šï¼Œå†æŠŠæŸ¥è¯¢ç»“æœå±•ç°åˆ°å‰ç«¯çš„æ—¶å€™ï¼Œæˆ‘ä»¬é€šå¸¸è¦å¯¹æ•°æ®è¿›è¡Œåˆ†é¡µå±•ç¤ºã€‚</p><p>åœ¨å­¦ä¹ LINQçš„æ—¶å€™ï¼Œæˆ‘ä»¬çŸ¥é“å¯ä»¥ä½¿ç”¨Skip(n)æ–¹æ³•å®ç°â€œè·³è¿‡næ¡æ•°æ®â€ï¼Œå¯ä»¥ä½¿ç”¨Take(n)æ–¹æ³•å®ç°â€œå–æœ€å¤šnæ¡æ•°æ®â€ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•é…åˆèµ·æ¥å°±å¯ä»¥åˆ†é¡µè·å–æ•°æ®ï¼Œæ¯”å¦‚Skip(3).Take(8)å°±æ˜¯â€œè·å–ä»ç¬¬3æ¡å¼€å§‹çš„æœ€å¤š8æ¡æ•°æ®â€ã€‚åœ¨EF Coreä¸­ä¹ŸåŒæ ·æ”¯æŒè¿™ä¸¤ä¸ªæ–¹æ³•ã€‚<br>åœ¨å®ç°åˆ†é¡µçš„æ—¶å€™ï¼Œä¸ºäº†æ˜¾ç¤ºé¡µç æ¡ï¼Œæˆ‘ä»¬éœ€è¦ç›´åˆ°æ»¡è¶³æ¡ä»¶çš„æ•°æ®çš„æ€»æ¡æ•°æ˜¯å¤šå°‘ã€‚å¯ä»¥ä½¿ç”¨IQueryableçš„å¤ç”¨ï¼Œåˆ†åˆ«å®ç°æ•°æ®çš„åˆ†é¡µæŸ¥è¯¢å’Œè·å–æ»¡è¶³æ¡ä»¶æ•°æ®æ€»æ¡æ•°è¿™ä¸¤ä¸ªæŸ¥è¯¢æ“ä½œã€‚</p><p>å°è£…ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨æ¥è¾“å‡ºæ ‡é¢˜ä¸åŒ…å«â€œå¼ ä¸‰â€çš„ç¬¬né¡µï¼ˆé¡µç ä»1å¼€å§‹ï¼‰çš„å†…å®¹ï¼Œå¹¶ä¸”è¾“å‡ºæ€»é¡µæ•°ï¼Œæ¯é¡µæœ€å¤šæ˜¾ç¤º5æ¡æ•°æ®ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">OutputPage(<span class="number">1</span>,<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">OutputPage</span>(<span class="params"><span class="built_in">int</span> pageIndex,<span class="built_in">int</span> pageSize</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">using</span> TestDbContext ctx = <span class="keyword">new</span> TestDbContext();</span><br><span class="line">    IQueryable&lt;Book&gt; books =ctx.Books.Where(b =&gt; !b.Title.Contains(<span class="string">&quot;å¼ ä¸‰&quot;</span>));</span><br><span class="line">    <span class="built_in">long</span> count = books.LongCount();</span><br><span class="line">    <span class="built_in">long</span> pageCount = (<span class="built_in">long</span>)Math.Ceiling(count*<span class="number">1.0</span>/pageSize);</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;é¡µæ•°ï¼š&quot;</span>+pageCount);</span><br><span class="line">    <span class="keyword">var</span> pagedBooks = books.Skip((pageIndex<span class="number">-1</span>)*pageSize).Take(pageSize);</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="keyword">var</span> b <span class="keyword">in</span> pagedBooks)</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WiteLine(b.Id+<span class="string">&quot;,&quot;</span>b.Title);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘çŸ¥é“ï¼ŒADO.NETä¸­æœ‰DataReaderå’ŒDataTableä¸¤ç§è¯»å–æ•°æ®åº“æŸ¥è¯¢ç»“æœçš„æ–¹å¼ã€‚å¦‚æœæŸ¥è¯¢ç»“æœæœ‰å¾ˆå¤šæ¡æ•°æ®ï¼ŒDataReaderåˆ™ä¼šåˆ†æ‰¹ä»æ•°æ®åº“æœåŠ¡å™¨è¯»å–æ•°æ®ã€‚DataReaderçš„ä¼˜ç‚¹æ˜¯å®¢æˆ·ç«¯å†…å­˜å ç”¨å°ï¼Œç¼ºç‚¹æ˜¯å¦‚æœéå†è¯»å–æ•°æ®å¹¶è¿›è¡Œå¤„ç†çš„è¿‡ç¨‹ç¼“æ…¢çš„è¯ï¼Œä¼šå¯¼è‡´ç¨‹åºå ç”¨æ•°æ®åº“è¿æ¥çš„æ—¶é—´è¾ƒé•¿ï¼Œä»è€Œé™ä½æ•°æ®åº“æœåŠ¡å™¨çš„å¹¶å‘è¿æ¥èƒ½åŠ›ï¼›DataTableçš„ä¼˜ç‚¹æ˜¯æ•°æ®åº“è¢«å¿«é€Ÿåœ°åŠ è½½åˆ°äº†å®¢æˆ·ç«¯å†…å­˜ä¸­ï¼Œå› æ­¤ä¸ä¼šè¾ƒé•¿æ—¶é—´åœ°å ç”¨æ•°æ®åº“è¿æ¥ï¼Œç¼ºç‚¹æ˜¯å¦‚æœæ•°æ®é‡å¤§çš„è¯ï¼Œå®¢æˆ·ç«¯çš„å†…å­˜å ç”¨ä¼šæ¯”è¾ƒå¤§ã€‚</p><p>IQueryableéå†è¯»å–æ•°æ®çš„æ—¶å€™ï¼Œç”¨çš„æ˜¯ç±»ä¼¼DataReaderçš„æ–¹å¼è¿˜æ˜¯ç±»ä¼¼DataTableçš„æ–¹å¼å‘¢ï¼Ÿ</p><p>åœ¨éå†æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæˆ‘ä»¬å…³é—­SQL ServeræœåŠ¡å™¨æˆ–è€…æ–­å¼€æœåŠ¡å™¨çš„ç½‘ç»œï¼Œç¨‹åºå°±ä¼šå‡ºé”™ï¼Œè¿™è¯´æ˜IQueryableçš„æ–¹å¼è¯»å–æŸ¥è¯¢ç»“æœçš„ã€‚å…¶å®IQueryableå†…éƒ¨çš„éå†å°±æ˜¯åœ¨è°ƒç”¨DataReaderè¿›è¡Œæ•°æ®è¯»å–ã€‚å› æ­¤ï¼Œåœ¨éå†IQueryableçš„è¿‡ç¨‹ä¸­ï¼Œå®ƒéœ€è¦å ç”¨ä¸€ä¸ªæ•°æ®åº“è¿æ¥ã€‚<br>å¦‚æœéœ€è¦ä¸€æ¬¡æ€§æŠŠæ‰€æœ‰æ•°æ®éƒ½è¯»å–åˆ°å®¢æˆ·ç«¯å†…å­˜ä¸­ï¼Œå¯ä»¥ç”¨IQueryableçš„ToArrayã€ToArrayAsyncã€ToListã€ToListAsyncç­‰æ–¹æ³•ã€‚</p><p>åœ¨éå†æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæˆ‘ä»¬å…³é—­SQL ServeræœåŠ¡å™¨æˆ–æ–­å¼€æœåŠ¡å™¨çš„ç½‘ç»œï¼Œç¨‹åºæ˜¯å¯ä»¥æ­£å¸¸è¿è¡Œçš„ï¼Œè¿™è¯´æ˜ToListAsyncæ–¹æ³•æŠŠæŸ¥è¯¢ç»“æœåŠ è½½åˆ°å®¢æˆ·ç«¯å†…å­˜ä¸­äº†ã€‚</p><h3 id="ä½•æ—¶éœ€è¦ä¸€æ¬¡æ€§åŠ è½½"><a href="#ä½•æ—¶éœ€è¦ä¸€æ¬¡æ€§åŠ è½½" class="headerlink" title="ä½•æ—¶éœ€è¦ä¸€æ¬¡æ€§åŠ è½½"></a>ä½•æ—¶éœ€è¦ä¸€æ¬¡æ€§åŠ è½½</h3><p>1.éå†IQueryableå¹¶ä¸”è¿›è¡Œæ•°æ®å¤„ç†çš„è¿‡ç¨‹å¾ˆè€—æ—¶ã€‚</p><p>2.å¦‚æœæ–¹æ³•éœ€è¦è¿”å›æŸ¥è¯¢ç»“æœï¼Œå¹¶ä¸”åœ¨æ–¹æ³•é‡Œé”€æ¯DbContextçš„è¯ï¼Œæ˜¯ä¸èƒ½è¿”å›IQueryableçš„ã€‚å¿…é¡»ä¸€æ¬¡æ€§åŠ è½½è¿”å›ã€‚</p><p>3.å¤šä¸ªIQueryableçš„éå†åµŒå¥—ã€‚å¾ˆå¤šæ•°æ®åº“çš„ADO.NET Core Provideræ˜¯ä¸æ”¯æŒå¤šä¸ªDataReaderåŒæ—¶æ‰§è¡Œçš„ã€‚æŠŠè¿æ¥å­—ç¬¦ä¸²ä¸­çš„MultipleActiveResultSets&#x3D;trueåˆ æ‰ï¼Œå…¶ä»–æ•°æ®åº“ä¸æ”¯æŒè¿™ä¸ªã€‚</p><h2 id="EF-Coreä¸­çš„å¼‚æ­¥æ–¹æ³•"><a href="#EF-Coreä¸­çš„å¼‚æ­¥æ–¹æ³•" class="headerlink" title="EF Coreä¸­çš„å¼‚æ­¥æ–¹æ³•"></a>EF Coreä¸­çš„å¼‚æ­¥æ–¹æ³•</h2><p>å¼‚æ­¥ç¼–ç¨‹é€šå¸¸èƒ½ç‹—æå‡ç³»ç»Ÿçš„ååé‡ï¼Œå› æ­¤å¦‚æœå®ç°æŸä¸ªåŠŸèƒ½çš„æ–¹æ³•å³æœ‰åŒæ­¥æ–¹æ³•åˆæœ‰å¼‚æ­¥æ–¹æ³•ï¼Œæˆ‘ä»¬ä¸€èˆ¬åº”è¯¥ä¼˜å…ˆä½¿ç”¨å¼‚æ­¥æ–¹æ³•ã€‚</p><blockquote><p>IQueryableçš„å¼‚æ­¥æ–¹æ³•æœ‰AllAsyncã€AnyAsyncã€AverageAsyncã€ContainsAsyncã€CountAsyncã€FirstAsyncã€FirstOrDefaultAsyncã€ForEachAsyncã€LongCountAsyncã€MaxAsyncã€MinAsyncã€SingleAsyncã€SingleOrDefaultAsyncã€SumAsyncç­‰ã€‚</p></blockquote><p>IQueryableçš„è¿™äº›å¼‚æ­¥æ–¹æ³•çš„æ‰©å±•æ–¹æ³•éƒ½æ˜¯ç«‹å³æ‰§è¡Œæ–¹æ³•ï¼Œè€ŒGroupByã€OrderByã€Joinã€Whereç­‰éç«‹å³æ‰§è¡Œæ–¹æ³•åˆ™æ²¡æœ‰å¯¹åº”çš„å¼‚æ­¥æ–¹æ³•ã€‚å› ä¸ºè¿™äº›éç«‹å³æ‰§è¡Œæ–¹æ³•å¹¶æ²¡æœ‰å®é™…æ‰§è¡ŒSQLè¯­å¥ï¼Œå¹¶ä¸æ˜¯æ¶ˆè€—I&#x2F;Oçš„æ“ä½œï¼Œå› æ­¤ä¸éœ€è¦å®šä¹‰è¿™äº›æ–¹æ³•çš„å¼‚æ­¥ç‰ˆæœ¬ã€‚</p><h2 id="å¦‚ä½•æ‰§è¡ŒåŸç”ŸSQLè¯­å¥"><a href="#å¦‚ä½•æ‰§è¡ŒåŸç”ŸSQLè¯­å¥" class="headerlink" title="å¦‚ä½•æ‰§è¡ŒåŸç”ŸSQLè¯­å¥"></a>å¦‚ä½•æ‰§è¡ŒåŸç”ŸSQLè¯­å¥</h2><p>å°½ç®¡EF Coreå·²ç»éå¸¸å¼ºå¤§ï¼Œä½†æ˜¯ä»ç„¶å­˜åœ¨æ— æ³•è¢«å†™æˆæ ‡å‡†EF Coreè°ƒç”¨æ–¹æ³•çš„SQLè¯­å¥ï¼Œå› æ­¤åœ¨å°‘æ•°åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬ä¾ç„¶éœ€è¦åœ¨EF Coreä¸­æ‰§è¡ŒåŸç”ŸSQLè¯­å¥ã€‚</p><h3 id="æ‰§è¡ŒSQLéæŸ¥è¯¢è¯­å¥"><a href="#æ‰§è¡ŒSQLéæŸ¥è¯¢è¯­å¥" class="headerlink" title="æ‰§è¡ŒSQLéæŸ¥è¯¢è¯­å¥"></a>æ‰§è¡ŒSQLéæŸ¥è¯¢è¯­å¥</h3><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡dbCtx.Database.ExecuteSqlInterpolatedæˆ–è€…å¼‚æ­¥çš„dbCtx.Database.ExecuteSqlInterpolatedAsyncæ–¹æ³•æ‰§è¡ŒåŸç”Ÿçš„SQLéæŸ¥è¯¢è¯­å¥ã€‚<br>insert intoâ€¦selectäºæ³•æ˜¯ä¸€ç§â€œå…ˆæŸ¥è¯¢å‡ºæ•°æ®ï¼Œå†æŠŠæŸ¥è¯¢ç»“æœæ’å…¥æ•°æ®åº“è¡¨â€çš„è¯­æ³•ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    Console.WriteLine(<span class="string">&quot;Hello, World!&quot;</span>);</span><br><span class="line">    <span class="built_in">double</span> price = <span class="built_in">double</span>.Parse(Console.ReadLine());</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;è¯·è¾“å…¥å§“å&quot;</span>);</span><br><span class="line">    <span class="built_in">string</span> aName = Console.ReadLine();</span><br><span class="line">    <span class="built_in">int</span> rows = <span class="keyword">await</span> ctx.Database.ExecuteSqlInterpolatedAsync(<span class="string">$@&quot;insert into T_Books (Title,PubTime,Price,AuthorName)</span></span><br><span class="line"><span class="string">select Title,PubTime,Price,<span class="subst">&#123;aName&#125;</span> from T_Books where Price&gt;<span class="subst">&#123;price&#125;</span>&quot;</span>);</span><br></pre></td></tr></table></figure><p>è¿™æ ·çš„å­—ç¬¦ä¸²ä¸ä¼šæœ‰SQLæ³¨å…¥æ”»å‡»æ¼æ´ã€‚</p><h3 id="æ‰§è¡Œå®ä½“ç±»SQLæŸ¥è¯¢è¯­å¥"><a href="#æ‰§è¡Œå®ä½“ç±»SQLæŸ¥è¯¢è¯­å¥" class="headerlink" title="æ‰§è¡Œå®ä½“ç±»SQLæŸ¥è¯¢è¯­å¥"></a>æ‰§è¡Œå®ä½“ç±»SQLæŸ¥è¯¢è¯­å¥</h3><p>å¦‚æœæˆ‘ä»¬è¦æ‰§è¡Œçš„SQLè¯­å¥æ˜¯ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ï¼Œå¹¶ä¸”æŸ¥è¯¢çš„ç»“æœä¹Ÿèƒ½å¯¹åº”ä¸€ä¸ªå®ä½“ç±»ï¼Œå°±å¯ä»¥è°ƒç”¨å¯¹åº”å®ä½“ç±»çš„DbSetçš„FromSqlInterpolatedæ–¹æ³•æ‰§è¡Œä¸€ä¸ªSQLæŸ¥è¯¢è¯­å¥ï¼Œæ–¹æ³•çš„å‚æ•°æ˜¯FormattbleStringç±»å‹ï¼Œå› æ­¤åŒæ ·å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²å†…æ’å…¥ä¼ é€’å‚æ•°ã€‚<br>ç¼–å†™ä¸€ä¸ªç¨‹åºè¦æ±‚ç”¨æˆ·è¾“å…¥ä¸€ä¸ªå¹´ä»½ï¼Œç„¶åä½¿ç”¨SQLé¢„è®¡è·å–å‡ºç‰ˆå¹´ä»½å¤§äºæŒ‡å®šå¹´ä»½çš„ä¹¦ï¼Œå¹¶ä¸”ä½¿ç”¨order by newid()è¿™ä¸ªSQL Serverçš„ç‰¹æœ‰ç”¨æ³•è¿›è¡Œéšæœºæ’åºã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Console.WriteLine(<span class="string">&quot;è¯·è¾“å…¥å¹´ä»½&quot;</span>);</span><br><span class="line"><span class="built_in">int</span> year = <span class="built_in">int</span>.Parse(Console.ReadLine());</span><br><span class="line">IQueryable&lt;Blog&gt; books=ctx.Blogs.FromSqlInterpolated(<span class="string">$@&quot;select * from T_Books where DatePart(year,PubTime)&gt;<span class="subst">&#123;year&#125;</span> order by newid()&quot;</span>);</span><br><span class="line"><span class="keyword">foreach</span>(<span class="keyword">var</span> book <span class="keyword">in</span> books)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(book.Id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>FromSqlInterpolatedæ–¹æ³•çš„è¿”å›å€¼æ˜¯IQueryableç±»å‹çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨å®é™…æ‰§è¡ŒIQueryableä¹‹å‰ï¼Œå¯¹IQueryableè¿›è¡Œè¿›ä¸€æ­¥çš„å¤„ç†ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Console.WriteLine(<span class="string">&quot;è¯·è¾“å…¥å¹´ä»½&quot;</span>);</span><br><span class="line"><span class="built_in">int</span> year = <span class="built_in">int</span>.Parse(Console.ReadLine());</span><br><span class="line">IQueryable&lt;Blog&gt; books=ctx.Blogs.FromSqlInterpolated(<span class="string">$@&quot;select * from T_Books where DatePart(year,PubTime)&gt;<span class="subst">&#123;year&#125;</span>&quot;</span>);</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> book <span class="keyword">in</span> books<span class="comment">/*.OrderBy(a=&gt;price)*/</span>.Skip(<span class="number">3</span>).Take(<span class="number">6</span>))</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(book.Id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>FromSqlInterpolatedçš„ä½¿ç”¨å±€é™æ€§<br>1.SQLæŸ¥è¯¢å¿…é¡»è¿”å›å®ä½“ç±»å‹å¯¹åº”æ•°æ®åº“è¡¨çš„æ‰€æœ‰åˆ—ã€‚<br>2.æŸ¥è¯¢ç»“æœé›†ä¸­çš„åˆ—åå¿…é¡»ä¸å±æ€§æ˜ å°„åˆ°çš„åˆ—ååŒ¹é…ã€‚<br>3.SQLè¯­å¥åªèƒ½è¿›è¡Œå•è¡¨æŸ¥è¯¢ï¼Œä¸èƒ½ä½¿ç”¨Joinè¯­å¥è¿›è¡Œå…³è”æŸ¥è¯¢ï¼Œä½†æ˜¯å¯ä»¥åœ¨æŸ¥è¯¢åé¢ä½¿ç”¨Includeæ–¹æ³•è¿›è¡Œå…³è”æ•°æ®çš„è·å–ã€‚</p></blockquote><h3 id="æ‰§è¡Œä»»æ„SQLæŸ¥è¯¢è¯­å¥"><a href="#æ‰§è¡Œä»»æ„SQLæŸ¥è¯¢è¯­å¥" class="headerlink" title="æ‰§è¡Œä»»æ„SQLæŸ¥è¯¢è¯­å¥"></a>æ‰§è¡Œä»»æ„SQLæŸ¥è¯¢è¯­å¥</h3><p>é€šè¿‡ctx.Databse.GetDbConnectionè·å¾—ä¸€ä¸ªæ•°æ®åº“è¿æ¥ï¼Œç„¶åå°±å¯ä»¥ç›´æ¥è°ƒç”¨ADO.NETçš„ç›¸å…³æ–¹æ³•æ‰§è¡Œä»»æ„çš„SQLè¯­å¥äº†ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> items=ctx.Databse.GetDbConnection().Query&lt;GroupArticleByPrice&gt;(<span class="string">&quot;select Price,Count(*) PCount from T_Articles group by Price&quot;</span>);</span><br><span class="line"><span class="keyword">foreach</span>(<span class="keyword">var</span> item <span class="keyword">in</span> items)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(item.Price+<span class="string">&quot;:&quot;</span>+item.PCount);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> EF Core </tag>
            
            <tag> ASP.NET Core </tag>
            
            <tag> Entity Framework Core </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>EF Coreå…³ç³»é…ç½®</title>
      <link href="/2025/03/30/asp.net%20core/%E5%85%B3%E7%B3%BB%E9%85%8D%E7%BD%AE/"/>
      <url>/2025/03/30/asp.net%20core/%E5%85%B3%E7%B3%BB%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<h1 id="å…³ç³»é…ç½®"><a href="#å…³ç³»é…ç½®" class="headerlink" title="å…³ç³»é…ç½®"></a>å…³ç³»é…ç½®</h1><p>æ¨èIDE:JetBrains Rider </p><h2 id="ä¸€å¯¹å¤š"><a href="#ä¸€å¯¹å¤š" class="headerlink" title="ä¸€å¯¹å¤š"></a>ä¸€å¯¹å¤š</h2><p>ä¸€å¯¹å¤šæ˜¯æœ€å¸¸è§çš„å®ä½“ç±»çš„å…³ç³»ã€‚æ¯”å¦‚æ–‡ç« å’Œè¯„è®ºçš„å…³ç³»å°±æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ï¼Œä¹Ÿå°±æ˜¯ä¸€ç¯‡æ–‡ç« å¯¹åº”å¤šæ¡è¯„è®ºã€‚</p><p>æ–‡ç« </p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Article</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; <span class="comment">//ä¸»é”®</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Title &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; <span class="comment">//æ ‡é¢˜</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Massage &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; <span class="comment">//å†…å®¹</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Comment&gt; Comments &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;= <span class="keyword">new</span> List&lt;Comment&gt;(); <span class="comment">//æ­¤è¯„è®ºçš„å¤šæ¡è¯„è®º</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯„è®º</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Comment</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; <span class="comment">//ä¸»é”®</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Massage &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; <span class="comment">//è¯„è®ºå±äºå“ªç¯‡æ–‡ç« </span></span><br><span class="line">    <span class="keyword">public</span> Article TheArticle &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; <span class="comment">//è¯„è®ºå†…å®¹</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>EF Coreä¸­å®ä½“ç±»ä¹‹é—´å…³ç³»çš„é…ç½®é‡‡ç”¨å¦‚ä¸‹çš„æ¨¡å¼ï¼šHasXXX(â€¦).WithYYY(â€¦);<br>Hasåœ¨è‹±è¯­ä¸­æ˜¯â€œæœ‰â€çš„æ„æ€ï¼ŒWithåœ¨è‹±è¯­ä¸­æ˜¯â€œå¸¦æœ‰â€çš„æ„æ€ï¼Œå› æ­¤HasXXX(â€¦).WithYYY(â€¦)å°±ä»£è¡¨â€œAå®ä½“ç±»å¯¹è±¡æœ‰XXXä¸ªBå®ä½“ç±»å¯¹è±¡ï¼ŒBå®ä½“ç±»å¯¹è±¡å¸¦æœ‰YYYä¸ªAå®ä½“ç±»å¯¹è±¡â€ã€‚å…¶ä¸­HasXXX(â€¦)ç”¨æ¥è®¾ç½®å½“å‰è¿™ä¸ªå®ä½“ç±»å’Œå…³è”çš„å¦ä¸€ä¸ªå®ä½“ç±»çš„å…³ç³»ï¼ŒWithYYY(â€¦)ç”¨æ¥åå‘é…ç½®å®ä½“ç±»çš„å…³ç³»ã€‚XXXã€YYYæœ‰Oneå’ŒManyè¿™ä¸¤ä¸ªå¯é€‰å€¼ã€‚</p><p>æˆ‘ä»¬åœ¨Aå®ä½“ç±»ä¸­é…ç½®builder.HasOne&lt;B&gt;(â€¦).WithMany(â€¦)å°±è¡¨ç¤ºAå’ŒBæ˜¯â€œä¸€å¯¹å¤šâ€çš„å…³ç³»ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªAå®ä½“ç±»çš„å¯¹è±¡å¯¹åº”ä¸€ä¸ªBå®ä½“ç±»çš„å¯¹è±¡ï¼Œè€Œä¸€ä¸ªBå®ä½“ç±»çš„å¯¹è±¡æœ‰å¤šä¸ªAå®ä½“ç±»çš„å¯¹è±¡ä¸ä¹‹å¯¹åº”ï¼›å¦‚æœåœ¨Aå®ä½“ç±»ä¸­é…ç½®builder.HasOne&lt;B&gt;(â€¦).WithOne(â€¦)å°±è¡¨ç¤ºAå’ŒBæ˜¯â€œä¸€å¯¹ä¸€â€çš„å…³ç³»ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªAå®ä½“ç±»çš„å¯¹è±¡å¯¹åº”ä¸€ä¸ªBå®ä½“ç±»å¯¹è±¡ï¼Œè€Œä¸€ä¸ªBå®ä½“ç±»çš„å¯¹è±¡ä¹Ÿæœ‰ä¸€ä¸ªAå®ä½“ç±»çš„å¯¹è±¡ä¸ä¹‹å¯¹åº”ï¼›å¦‚æœAå®ä½“ç±»ä¸­é…ç½®builder.HasMany&lt;B&gt;(â€¦).WithMany(â€¦)å°±è¡¨ç¤ºAå’ŒBæ˜¯â€œå¤šå¯¹å¤šâ€çš„å…³ç³»ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªAå®ä½“ç±»çš„å¯¹è±¡å¯¹åº”å¤šä¸ªBå®ä½“ç±»çš„å¯¹è±¡ï¼Œè€Œä¸€ä¸ªBå®ä½“ç±»çš„å¯¹è±¡ä¹Ÿæœ‰å¤šä¸ªAå®ä½“ç±»çš„å¯¹è±¡ä¸ä¹‹å¯¹åº”ã€‚</p><p>ä½¿ç”¨Fluent APIå°±è¡Œå…³ç³»çš„é…ç½®ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">ArticleConfig</span>:<span class="title">IEntityTypeConfiguration</span>&lt;<span class="title">Article</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">EntityTypeBuilder&lt;Article&gt; builder</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        builder.ToTable(<span class="string">&quot;T_Article&quot;</span>);</span><br><span class="line">        builder.Property(a=&gt;a.Title).HasMaxLength(<span class="number">100</span>).IsUnicode().IsRequired();</span><br><span class="line">        builder.Property(a =&gt; a.Massage).IsUnicode().IsRequired();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">CommentConfig</span> : <span class="title">IEntityTypeConfiguration</span>&lt;<span class="title">Comment</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">EntityTypeBuilder&lt;Comment&gt; builder</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        builder.ToTable(<span class="string">&quot;T_Comment&quot;</span>);</span><br><span class="line">        builder.Property(a=&gt;a.Massage).IsUnicode().IsRequired();</span><br><span class="line">        builder.HasOne&lt;Article&gt;(c =&gt; c.TheArticle).WithMany(a=&gt;a.Comments).IsRequired();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">MyDbContext</span>: <span class="title">DbContext</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> DbSet&lt;Article&gt; Articles &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> DbSet&lt;Comment&gt; Comments &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnConfiguring</span>(<span class="params">DbContextOptionsBuilder optionsBuilder</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">base</span>.OnConfiguring(optionsBuilder);</span><br><span class="line">        <span class="built_in">string</span> connstr=<span class="string">&quot;Server=localhost;Database=T_dome;Trusted_Connection=True;MultipleActiveResultSets=true;Encrypt=false;&quot;</span>;</span><br><span class="line">        optionsBuilder.UseSqlServer(connstr);</span><br><span class="line">        optionsBuilder.LogTo(Console.WriteLine);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnModelCreating</span>(<span class="params">ModelBuilder modelBuilder</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">base</span>.OnModelCreating(modelBuilder);</span><br><span class="line">        modelBuilder.ApplyConfigurationsFromAssembly(<span class="keyword">this</span>.GetType().Assembly);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">builder.HasOne&lt;Article&gt;(c =&gt; c.TheArticle).WithMany(a=&gt;a.Comments).IsRequired();</span><br></pre></td></tr></table></figure><p>è¿™è¡Œä»£ç çš„æ„æ€å°±æ˜¯â€œä¸€æ¡è¯„è®ºå¯¹åº”ä¸€ç¯‡æ–‡ç« ï¼Œä¸€ç¯‡æ–‡ç« æœ‰å¤šæ¡è¯„è®ºâ€ã€‚</p><p>HasOne&lt;Article&gt;(c&#x3D;&gt;c.Article)ä¸­çš„Lambdaè¡¨è¾¾å¼c&#x3D;&gt;c.Articleè¡¨ç¤ºCommentç±»çš„Articleå±æ€§æ˜¯æŒ‡å‘Articleå®ä½“ç±»å‹ã€‚</p><p>WithMany(a&#x3D;&gt;a.Comments)è¡¨ç¤ºä¸€ä¸ªArticleå¯¹åº”å¤šä¸ªComment,å¹¶ä¸”åœ¨Articleä¸­å¯ä»¥é€šè¿‡Commentså±æ€§è®¿é—®åˆ°ç›¸å…³çš„Commentå¯¹è±¡ã€‚</p><p>IsRequiredè¡¨ç¤ºCommentä¸­çš„Articleå±æ€§æ˜¯ä¸å¯ä¸ºç©ºçš„ã€‚</p><p><img src="/img%5CHello%5CSHU.png"></p><p>å…¶ä¸­T_Commentè¡¨çš„Articleidåˆ—æ˜¯ä¸€ä¸ªæŒ‡å‘T_Articlesè¡¨Idåˆ—çš„å¤–é”®ã€‚</p><p>æ’å…¥æ•°æ®</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> (MyDbContext ctx=<span class="keyword">new</span> MyDbContext())</span><br><span class="line">&#123;</span><br><span class="line">    Article article = <span class="keyword">new</span> Article();</span><br><span class="line">    article.Title = <span class="string">&quot;EF Core&quot;</span>;</span><br><span class="line">    article.Massage = <span class="string">&quot;EF Core is good&quot;</span>;</span><br><span class="line"></span><br><span class="line">    Comment comment1 = <span class="keyword">new</span> Comment &#123; Massage=<span class="string">&quot;å¤ªå¥½äº†&quot;</span>&#125;;</span><br><span class="line">    Comment comment2 = <span class="keyword">new</span> Comment &#123; Massage = <span class="string">&quot;å¤ªæ£’äº†&quot;</span> &#125;;</span><br><span class="line">    article.Comments.Add(comment1);</span><br><span class="line">    article.Comments.Add(comment2);</span><br><span class="line">    </span><br><span class="line">    ctx.Articles.Add(article);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> ctx.SaveChangesAsync();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å…³è”æ•°æ®çš„è·å–"><a href="#å…³è”æ•°æ®çš„è·å–" class="headerlink" title="å…³è”æ•°æ®çš„è·å–"></a>å…³è”æ•°æ®çš„è·å–</h2><p>EF Coreçš„å…³ç³»é…ç½®ä¸ä»…èƒ½å¸®æˆ‘ä»¬ç®€åŒ–æ•°æ®çš„æ’å…¥ï¼Œä¹Ÿå¯ä»¥ç®€åŒ–æ•°æ®çš„è·å–ã€‚æŠŠId&#x3D;&#x3D;1çš„æ–‡ç« åŠè¯„è®ºè¾“å‡ºã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Article a=ctx.Articles.Include(a=&gt;a.Comments).Single(a =&gt; a.Id == <span class="number">1</span>);</span><br><span class="line">Console.WriteLine(a.Title);</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> a.Comments)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(item.Id+<span class="string">&quot;;&quot;</span>+item.Massage);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>![](img\Hello\å±å¹•æˆªå›¾ 2025-03-31 094530.png)<br><img src="/img%5CHello%5CSQLGUAN.png"></p><h2 id="å•é¡¹å¯¼èˆªå±æ€§"><a href="#å•é¡¹å¯¼èˆªå±æ€§" class="headerlink" title="å•é¡¹å¯¼èˆªå±æ€§"></a>å•é¡¹å¯¼èˆªå±æ€§</h2><p>ä¸Šé¢çš„å…³ç³»é…ç½®çš„ä¾‹å­ä¸­ï¼Œåœ¨Articleç±»ä¸­å£°æ˜äº†Commentå±æ€§æŒ‡å‘Commentç±»ï¼Œè¿™æ ·æˆ‘ä»¬ä¸ä»…å¯ä»¥é€šè¿‡Commentç±»çš„Articleå±æ€§è·å–è¯„è®ºå¯¹åº”çš„æ–‡ç« ä¿¡æ¯ï¼Œè¿˜å¯ä»¥é€šè¿‡Articleç±»çš„Commentså±æ€§è·å–æ–‡ç« çš„æ‰€æœ‰è¯„è®ºä¿¡æ¯ã€‚è¿™æ ·çš„å…³ç³»å«ä½œâ€œåŒå‘å¯¼èˆªâ€ã€‚</p><p>åŒå‘å¯¼èˆªè®©æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»»æ„ä¸€æ–¹çš„å¯¹è±¡è·å–å¯¹æ–¹çš„ä¿¡æ¯ï¼Œä½†æ˜¯æœ‰æ—¶å€™æˆ‘ä»¬ä¸æ–¹ä¾¿å£°æ˜åŒå‘å¯¼èˆªã€‚<br>æ¯”å¦‚åŸºç¡€çš„â€œç”¨æˆ·â€å®ä½“ç±»ä¼šè¢«éå¸¸å¤šçš„å…¶ä»–å®ä½“ç±»å¼•ç”¨ï¼Œæ¯”å¦‚â€œè¯·å‡å•â€ä¸­ä¼šæœ‰â€œç”³è¯·è€…â€â€œæ‰¹å‡†è€…â€ç­‰â€œç”¨æˆ·â€å®ä½“ç±»å‹çš„å±æ€§ã€‚å› æ­¤ç³»ç»Ÿä¸­ä¼šæœ‰å‡ åä¸ªç”šè‡³ä¸Šç™¾ä¸ªå®ä½“ç±»éƒ½æœ‰â€œç”¨æˆ·â€å®ä½“ç±»çš„å±æ€§ï¼Œä½†æ˜¯â€œç”¨æˆ·â€å®ä½“ç±»ä¸éœ€è¦ä¸ºæ¯ä¸ªå®ä½“ç±»éƒ½å£°æ˜ä¸€ä¸ªå¯¼èˆªå±æ€§ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°±éœ€è¦ä¸€ç§åªåœ¨â€œå¤šç«¯â€å£°æ˜å¯¼èˆªå±æ€§ï¼Œè€Œä¸éœ€è¦åœ¨â€œä¸€ç«¯â€å£°æ˜å¯¼èˆªå±æ€§çš„å•é¡¹å¯¼èˆªæœºåˆ¶ã€‚</p><p>è¿™ç§å•é¡¹å¯¼èˆªå±æ€§çš„é…ç½®åªè¦åœ¨WithMany()æ–¹æ³•ä¸­ä¸æŒ‡å®šå±æ€§å³å¯ã€‚</p><p>åˆ›å»ºå®ä½“ç±»</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">User</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; <span class="comment">//ä¸»é”®</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; <span class="comment">//ç”¨æˆ·å</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">ConsoleApp4</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Leave</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; <span class="comment">//ä¸»é”®</span></span><br><span class="line">    <span class="keyword">public</span> User Requester &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; <span class="comment">//è¯·å‡äºº</span></span><br><span class="line">    <span class="keyword">public</span> User? Approver &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; <span class="comment">//å®¡æ‰¹äºº</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Remark &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; <span class="comment">//è¯·å‡äº‹ç”±</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å£°æ˜å®ä½“ç±»çš„å±æ€§</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyDbContext</span>:<span class="title">DbContext</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> DbSet&lt;User&gt; Users &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> DbSet&lt;Leave&gt; Leaves  &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnConfiguring</span>(<span class="params">DbContextOptionsBuilder optionsBuilder</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> connStr =</span><br><span class="line">            <span class="string">&quot;Server=localhost;Database=T_dome;Trusted_Connection=True;MultipleActiveResultSets=true;Encrypt=false;&quot;</span>;</span><br><span class="line">        optionsBuilder.UseSqlServer(connStr);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnModelCreating</span>(<span class="params">ModelBuilder modelBuilder</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">base</span>.OnModelCreating(modelBuilder);</span><br><span class="line">        modelBuilder.ApplyConfigurationsFromAssembly(<span class="keyword">this</span>.GetType().Assembly);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–å†™Leaveç±»çš„é…ç½®</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">LeaveConfig</span>: <span class="title">IEntityTypeConfiguration</span>&lt;<span class="title">Leave</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">EntityTypeBuilder&lt;Leave&gt; builder</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        builder.HasOne&lt;User&gt;(l =&gt; l.Requester).WithMany().IsRequired();</span><br><span class="line">        builder.HasOne&lt;User&gt;(l =&gt; l.Approver).WithMany();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ’å…¥æ•°æ®åˆ°æ•°æ®åº“</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> (MyDbContext db = <span class="keyword">new</span> MyDbContext())</span><br><span class="line">&#123;</span><br><span class="line">    User user = <span class="keyword">new</span> User&#123;Name= <span class="string">&quot;John&quot;</span>&#125;;</span><br><span class="line"></span><br><span class="line">    Leave u1=<span class="keyword">new</span> Leave&#123;Remark = <span class="string">&quot;Holiday&quot;</span>,Requester = user&#125;;</span><br><span class="line">    db.Leaves.Add(u1);</span><br><span class="line">    db.SaveChangesAsync();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¸€å¯¹ä¸€"><a href="#ä¸€å¯¹ä¸€" class="headerlink" title="ä¸€å¯¹ä¸€"></a>ä¸€å¯¹ä¸€</h2><p>å‡è®¾å®ç°ä¸€ä¸ªç”µå•†ç½‘ç«™ï¼Œé‚£ä¹ˆâ€œè®¢å•â€å’Œâ€œå¿«é€’ä¿¡æ¯â€å¯ä»¥å®šä¹‰ä¸¤ä¸ªå®ä½“ç±»ï¼Œè¿™ä¸¤ä¸ªå®ä½“ç±»ä¹‹é—´å°±æ˜¯ä¸€å¯¹ä¸€çš„å…³ç³»ï¼šä¸€ä¸ªè®¢å•å¯¹åº”ä¸€ä¸ªå¿«é€’ä¿¡æ¯ï¼Œä¸€ä¸ªå¿«é€’ä¿¡æ¯å¯¹åº”ä¸€ä¸ªè®¢å•ã€‚</p><p>è®¢å•å®ä½“ç±»Order</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Order</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;<span class="comment">//è®¢å•ç¼–å·</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;<span class="comment">//è®¢å•åç§°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Address &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;<span class="comment">//è®¢å•åœ°å€</span></span><br><span class="line">    <span class="keyword">public</span> Delivery? Delivery &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;<span class="comment">//è®¢å•çš„é…é€ä¿¡æ¯</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¿«é€’ä¿¡æ¯å®ä½“ç±»Delivery</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Delivery</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;<span class="comment">//é…é€ç¼–å·</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> CompanName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;<span class="comment">//é…é€å…¬å¸åç§°/*895632./85ã€        public string Number &#123; get; set; &#125;//é…é€å•å·</span></span><br><span class="line">    <span class="keyword">public</span> Order? Order &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;<span class="comment">//é…é€çš„è®¢å•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> OrderId &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;<span class="comment">//é…é€çš„è®¢å•ç¼–å·</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äºä¸€å¯¹ä¸€å…³ç³»ï¼Œç”±äºåŒæ–¹æ˜¯â€œå¹³ç­‰â€çš„å…³ç³»ï¼Œå¤–é”®åˆ—å¯ä»¥å»ºåœ¨ä»»æ„ä¸€æ–¹ï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»æ˜¾å¼åœ°åœ¨å…¶ä¸­ä¸€ä¸ªå®ä½“ç±»ä¸­å£°æ˜ä¸€ä¸ªå¤–é”®å±æ€§ã€‚å°±åƒä¸Šé¢çš„å®ä½“ç±»å®šä¹‰ä¸­ï¼ŒDeliveryç±»ä¸­å£°æ˜äº†ä¸€ä¸ªå¤–é”®å±æ€§OrderId,å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥æ”¹æˆåœ¨Orderç±»ä¸­å£°æ˜ä¸€ä¸ªå¤–é”®å±æ€§DeliveryId,æ•ˆæœä¸€æ ·çš„ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">class</span> <span class="title">OrderConfig</span> : <span class="title">IEntityTypeConfiguration</span>&lt;<span class="title">Order</span>&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">EntityTypeBuilder&lt;Order&gt; builder</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            builder.ToTable(<span class="string">&quot;T_Order&quot;</span>);</span><br><span class="line">            builder.Property(o=&gt;o.Address).IsRequired();</span><br><span class="line">            builder.Property(o =&gt; o.Name).IsRequired();</span><br><span class="line">            builder.HasOne&lt;Delivery&gt;(o=&gt;o.Delivery).WithOne(d=&gt;d.Order).HasForeignKey&lt;Delivery&gt;(d =&gt; d.OrderId);</span><br><span class="line">*<span class="number">-9</span>+<span class="number">6</span></span><br><span class="line"><span class="number">3</span>        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">OrderConfig</span> : <span class="title">IEntityTypeConfiguration</span>&lt;<span class="title">Order</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">EntityTypeBuilder&lt;Order&gt; builder</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        builder.ToTable(<span class="string">&quot;T_Order&quot;</span>);</span><br><span class="line">        builder.Property(o=&gt;o.Address).IsRequired();</span><br><span class="line">        builder.Property(o =&gt; o.Name).IsRequired();</span><br><span class="line">        builder.HasOne&lt;Delivery&gt;(o=&gt;o.Delivery).WithOne(d=&gt;d.Order).HasForeignKey&lt;Delivery&gt;(d =&gt; d.OrderId);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å’Œä¸€å¯¹å¤šå…³ç³»ç±»ä¼¼ï¼Œåœ¨ä¸€å¯¹ä¸€å…³ç³»ä¸­ï¼ŒæŠŠå…³ç³»æ”¾åˆ°å“ªä¸€æ–¹çš„å®ä½“ç±»çš„é…ç½®ä¸­éƒ½å¯ä»¥ã€‚</p><p>æ’å…¥æ•°æ®åŠæŸ¥è¯¢</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> (MyDbContext db = <span class="keyword">new</span> MyDbContext())</span><br><span class="line">&#123;</span><br><span class="line">    db.Database.EnsureDeleted();</span><br><span class="line">    db.Database.EnsureCreated();</span><br><span class="line">    Order order = <span class="keyword">new</span> Order</span><br><span class="line">    &#123;</span><br><span class="line">        Name = <span class="string">&quot;è®¢å•1&quot;</span>,</span><br><span class="line">        Address = <span class="string">&quot;åœ°å€1&quot;</span>,</span><br><span class="line">        Delivery = <span class="keyword">new</span> Delivery</span><br><span class="line">        &#123;</span><br><span class="line">            CompanName = <span class="string">&quot;å…¬å¸1&quot;</span>,</span><br><span class="line">            Number = <span class="string">&quot;123456&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    db.Add(order);</span><br><span class="line">    db.SaveChanges();</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;æ·»åŠ æˆåŠŸ&quot;</span>);</span><br><span class="line">    Order order1 = db.Set&lt;Order&gt;().Include(o =&gt; o.Delivery).FirstOrDefault();</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;è®¢å•åç§°:<span class="subst">&#123;order1.Name&#125;</span>,è®¢å•åœ°å€:<span class="subst">&#123;order1.Address&#125;</span>,é…é€å…¬å¸:<span class="subst">&#123;order1.Delivery?.CompanName&#125;</span>,é…é€å•å·:<span class="subst">&#123;order1.Delivery?.Number&#125;</span>&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¤šå¯¹å¤š"><a href="#å¤šå¯¹å¤š" class="headerlink" title="å¤šå¯¹å¤š"></a>å¤šå¯¹å¤š</h2><p>å¤šå¯¹å¤šæŒ‡çš„æ˜¯Aå®ä½“ç±»çš„ä¸€ä¸ªå¯¹è±¡å¯ä»¥è¢«å¤šä¸ªBå®ä½“ç±»çš„å¯¹è±¡å¼•ç”¨ï¼ŒBå®ä½“ç±»çš„ä¸€ä¸ªå¯¹è±¡ä¹Ÿå¯ä»¥è¢«å¤šä¸ªAå®ä½“ç±»çš„å¯¹è±¡å¼•ç”¨ã€‚<br>ä¸€ä¸ªè€å¸ˆå¯¹åº”å¤šä¸ªå­¦ç”Ÿï¼Œä¸€ä¸ªå­¦ç”Ÿå¯¹åº”å¤šä¸ªè€å¸ˆï¼Œå› æ­¤è€å¸ˆå’Œå­¦ç”Ÿä¹‹é—´çš„å…³ç³»å°±æ˜¯å¤šå¯¹å¤šã€‚</p><p>å£°æ˜å­¦ç”Ÿç±»Studentå’Œè€å¸ˆç±»Teacherä¸¤ä¸ªå®ä½“ç±»ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Student</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> List&lt;Teacher&gt; Teachers &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Teacher</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> List&lt;Student&gt; Students &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œå­¦ç”Ÿç±»Studentä¸­æœ‰ä¸€ä¸ªListç±»å‹çš„Teachersä»£è¡¨è¿™ä¸ªå­¦ç”Ÿçš„æ‰€æœ‰è€å¸ˆï¼ŒåŒæ ·çš„ ï¼Œè€å¸ˆç±»Teacherä¸­ä¹Ÿæœ‰ä¸€ä¸ªListç±»å‹çš„Studentä»£è¡¨è¿™ä¸ªè€å¸ˆçš„æ‰€æœ‰å­¦ç”Ÿã€‚</p><p>å®ä½“ç±»é…ç½®</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">TeacherConfig</span> : <span class="title">IEntityTypeConfiguration</span>&lt;<span class="title">Teacher</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">EntityTypeBuilder&lt;Teacher&gt; builder</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        builder.ToTable(<span class="string">&quot;Teacher&quot;</span>);</span><br><span class="line">        builder.Property(s=&gt;s.Name).IsUnicode().HasMaxLength(<span class="number">50</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">SudentConfig</span> : <span class="title">IEntityTypeConfiguration</span>&lt;<span class="title">Student</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">EntityTypeBuilder&lt;Student&gt; builder</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        builder.ToTable(<span class="string">&quot;T_Student&quot;</span>);</span><br><span class="line">        builder.Property(s=&gt;s.Name).IsUnicode().HasMaxLength(<span class="number">50</span>);</span><br><span class="line">        builder.HasMany&lt;Teacher&gt;(s =&gt; s.Teachers).WithMany(t =&gt; t.Students).UsingEntity(j=&gt;j.ToTable(<span class="string">&quot;T_StudentTeacher&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨å¤šå¯¹å¤šå…³ç³»ä¸­ï¼Œæˆ‘ä»¬å¿…é¡»å¼•å…¥ä¸€å¼ é¢å¤–çš„æ•°æ®åº“è¡¨å­˜ä¸¤å¼ è¡¨ä¹‹é—´çš„å¯¹åº”å…³ç³»ã€‚åœ¨EFCoreä¸­ï¼Œä½¿ç”¨UsingEntity(j&#x3D;&gt;j.ToTable(â€œT_StudentTeacherâ€))çš„æ–¹å¼é…ç½®ä¸­é—´è¡¨ã€‚</p><p>æ’å…¥ï¼ŒæŸ¥è¯¢æ•°æ®</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> (TestDbConText db = <span class="keyword">new</span> TestDbConText())</span><br><span class="line">&#123;</span><br><span class="line">    db.Database.EnsureDeleted();</span><br><span class="line">    db.Database.EnsureCreated();</span><br><span class="line">    Student student = <span class="keyword">new</span> Student</span><br><span class="line">    &#123;</span><br><span class="line">        Name = <span class="string">&quot;å­¦ç”Ÿ1&quot;</span>,</span><br><span class="line">        Teachers = <span class="keyword">new</span> List&lt;Teacher&gt;</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">new</span> Teacher&#123;Name=<span class="string">&quot;è€å¸ˆ1&quot;</span>&#125;,</span><br><span class="line">            <span class="keyword">new</span> Teacher&#123;Name=<span class="string">&quot;è€å¸ˆ2&quot;</span>&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    db.Add(student);</span><br><span class="line">    db.SaveChanges();</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;æ·»åŠ æˆåŠŸ&quot;</span>);</span><br><span class="line">    Student student1 = db.Set&lt;Student&gt;().Include(s =&gt; s.Teachers).FirstOrDefault();</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;å­¦ç”Ÿåç§°:<span class="subst">&#123;student1.Name&#125;</span>&quot;</span>);</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> student1.Teachers)</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;è€å¸ˆåç§°:<span class="subst">&#123;item.Name&#125;</span>&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> EF Core </tag>
            
            <tag> ASP.NET Core </tag>
            
            <tag> Entity Framework Core </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>EF Coreå…¥é—¨</title>
      <link href="/2025/03/28/asp.net%20core/EF%20Core%E5%85%A5%E9%97%A8/"/>
      <url>/2025/03/28/asp.net%20core/EF%20Core%E5%85%A5%E9%97%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="EF-Coreå…¥é—¨"><a href="#EF-Coreå…¥é—¨" class="headerlink" title="EF Coreå…¥é—¨"></a>EF Coreå…¥é—¨</h1><p>ä¸åŒçš„EF Coreæ•°æ®åº“æä¾›çš„è´¨é‡å‚æ¬¡ä¸é½ï¼Œé™¤äº†å¾®è½¯å®˜æ–¹çš„Microsoft SQL Serverçš„EF Coreæ•°æ®åº“æä¾›ç¨‹åºä¹‹å¤–ï¼Œè¿˜å­˜åœ¨ç€å¾ˆå¤šç¬¬ä¸‰æ–¹çš„EF Coreæ•°æ®åº“æä¾›ç¨‹åºï¼Œå®ƒä»¬å¯¹äºEF Coreçš„æ”¯æŒå¤§éƒ¨åˆ†æ˜¯ä¸€è‡´çš„ï¼Œä½†æ˜¯ä¼šæœ‰ç»†å¾®çš„å·®åˆ«ã€‚</p><h2 id="EF-Coreç¯å¢ƒæ­å»º"><a href="#EF-Coreç¯å¢ƒæ­å»º" class="headerlink" title="EF Coreç¯å¢ƒæ­å»º"></a>EF Coreç¯å¢ƒæ­å»º</h2><p>æ— è®ºæ˜¯åœ¨æ§åˆ¶å°é¡¹ç›®ä¸­è¿˜æ˜¯åœ¨ASP.NET Coreé¡¹ç›®ä¸­ï¼ŒEF Coreçš„ç”¨æ³•éƒ½æ˜¯ä¸€æ ·çš„ã€‚<br>EF Coreç”¨äºå°†å¯¹è±¡å’Œæ•°æ®åº“ä¸­çš„è¡¨è¿›è¡Œæ˜ å°„ï¼Œå› æ­¤åœ¨è¿›è¡ŒEF Coreå¼€å‘çš„æ—¶å€™ï¼Œéœ€è¦åˆ›å»ºC#ç±»ï¼ˆä¹Ÿå«ä½œå®ä½“ç±»ï¼‰å’Œæ•°æ®åº“è¡¨ä¸¤é¡¹å†…å®¹ã€‚<br>åœ¨ç»å…¸çš„EF Coreä½¿ç”¨åœºæ™¯ä¸‹ï¼Œç”±å¼€å‘äººå‘˜ç¼–å†™å®ä½“ç±»ï¼Œç„¶åEF Coreå¯ä»¥æ ¹æ®å®ä½“ç±»æ•°æ®åº“è¡¨ã€‚</p><h3 id="åˆ›å»ºä¸€ä¸ª-NET-Coreæ§åˆ¶å°é¡¹ç›®ï¼Œç„¶åå†é¡¹ç›®ä¸­åˆ›å»ºBookå®ä½“ç±»ã€‚"><a href="#åˆ›å»ºä¸€ä¸ª-NET-Coreæ§åˆ¶å°é¡¹ç›®ï¼Œç„¶åå†é¡¹ç›®ä¸­åˆ›å»ºBookå®ä½“ç±»ã€‚" class="headerlink" title="åˆ›å»ºä¸€ä¸ª.NET Coreæ§åˆ¶å°é¡¹ç›®ï¼Œç„¶åå†é¡¹ç›®ä¸­åˆ›å»ºBookå®ä½“ç±»ã€‚"></a>åˆ›å»ºä¸€ä¸ª.NET Coreæ§åˆ¶å°é¡¹ç›®ï¼Œç„¶åå†é¡¹ç›®ä¸­åˆ›å»ºBookå®ä½“ç±»ã€‚</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Book</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;<span class="comment">//ä¸»é”®</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Title &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;<span class="comment">//æ ‡é¢˜</span></span><br><span class="line">    <span class="keyword">public</span> DateTime PubTime &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;<span class="comment">//å‘å¸ƒæ—¥æœŸ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> Price &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;<span class="comment">//å•ä»·</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> ä¸ºé¡¹ç›®å®‰è£…NuGetåŒ…</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Microsoft.EntityFrameworkCore.SqlServer</span><br></pre></td></tr></table></figure><h3 id="æˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªå®ç°äº†IEntityTypeConfigurationæ¥å£çš„å®ç°ç±»çš„é…ç½®ç±»BookEntityConfig-å®ƒç”¨äºé…ç½®å®ä½“ç±»å’Œæ•°æ®åº“è¡¨çš„å¯¹åº”å…³ç³»ã€‚"><a href="#æˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªå®ç°äº†IEntityTypeConfigurationæ¥å£çš„å®ç°ç±»çš„é…ç½®ç±»BookEntityConfig-å®ƒç”¨äºé…ç½®å®ä½“ç±»å’Œæ•°æ®åº“è¡¨çš„å¯¹åº”å…³ç³»ã€‚" class="headerlink" title="æˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªå®ç°äº†IEntityTypeConfigurationæ¥å£çš„å®ç°ç±»çš„é…ç½®ç±»BookEntityConfig,å®ƒç”¨äºé…ç½®å®ä½“ç±»å’Œæ•°æ®åº“è¡¨çš„å¯¹åº”å…³ç³»ã€‚"></a>æˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªå®ç°äº†IEntityTypeConfigurationæ¥å£çš„å®ç°ç±»çš„é…ç½®ç±»BookEntityConfig,å®ƒç”¨äºé…ç½®å®ä½“ç±»å’Œæ•°æ®åº“è¡¨çš„å¯¹åº”å…³ç³»ã€‚</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">BookConfig</span>:<span class="title">IEntityTypeConfiguration</span>&lt;<span class="title">Book</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">EntityTypeBuilder&lt;Book&gt; builder</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        builder.ToTable(<span class="string">&quot;T_Books&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬é€šè¿‡æ¥å£ç±»å‹IEntityTypeConfiguration&lt;T&gt;çš„æ³›å‹å‚æ•°ç±»æŒ‡å®šè¿™ä¸ªç±»è¦å¯¹å“ªä¸ªå®ä½“ç±»è¿›è¡Œé…ç½®ï¼Œç„¶åå†Configureæ–¹æ³•ä¸­å¯¹å®ä½“ç±»å’Œæ•°æ®åº“è¡¨çš„å…³ç³»åšè¯¦ç»†çš„é…ã€‚<br>å…¶ä¸­builder.ToTable(â€œT_Booksâ€)è¡¨ç¤ºè¿™ä¸ªå®ä½“ç±»å¯¹åº”æ•°æ®åº“ä¸­çš„åå­—ä¸ºT_Booksçš„è¡¨ã€‚<br>è¿™é‡Œæ²¡æœ‰é…ç½®å„ä¸ªå±æ€§åœ¨æ•°æ®åº“ä¸­çš„åˆ—åå’Œæ•°æ®åº“ç±»å‹ï¼ŒEF Coreå°†ä¼šé»˜è®¤æŠŠå±æ€§çš„åå­—ä½œä¸ºåˆ—åï¼Œå¹¶ä¸”æ ¹æ®å±æ€§çš„ç±»å‹æ¥æ¨æ–­æ•°æ®åº“è¡¨ä¸­å„åˆ—çš„æ•°æ®åº“è¡¨ä¸­å„åˆ—çš„æ•°æ®åº“ç±»å‹ã€‚</p><h3 id="åˆ›å»ºä¸€ä¸ªç»§æ‰¿è‡ªDbContextç±»çš„MyDbContextç±»"><a href="#åˆ›å»ºä¸€ä¸ªç»§æ‰¿è‡ªDbContextç±»çš„MyDbContextç±»" class="headerlink" title="åˆ›å»ºä¸€ä¸ªç»§æ‰¿è‡ªDbContextç±»çš„MyDbContextç±»"></a>åˆ›å»ºä¸€ä¸ªç»§æ‰¿è‡ªDbContextç±»çš„MyDbContextç±»</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">EF_Core</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">MyDbContext</span>:<span class="title">DbContext</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">public</span> DbSet&lt;Book&gt; Books &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> DbSet&lt;Person&gt; Persons &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnConfiguring</span>(<span class="params">DbContextOptionsBuilder optionsBuilder</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//è¿æ¥æ•°æ®åº“</span></span><br><span class="line">            <span class="keyword">base</span>.OnConfiguring(optionsBuilder);</span><br><span class="line">            <span class="built_in">string</span> connstr = <span class="string">&quot;Server=localhost;Database=student;Trusted_Connection=True;MultipleActiveResultSets=true;Encrypt=false;&quot;</span>;</span><br><span class="line">            optionsBuilder.UseSqlServer(connstr);</span><br><span class="line">  </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnModelCreating</span>(<span class="params">ModelBuilder modelBuilder</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//ä»å½“å‰ç¨‹åºé›†ä¸­åŠ è½½æ‰€æœ‰çš„IEntityTypeConfiguration</span></span><br><span class="line">            <span class="keyword">base</span>.OnModelCreating(modelBuilder);</span><br><span class="line">            modelBuilder.ApplyConfigurationsFromAssembly(<span class="keyword">this</span>.GetType().Assembly);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>MyDbContextä¸­çš„Bookså±æ€§å¯¹åº”æ•°æ®åº“ä¸­çš„T_Booksè¡¨ï¼Œå¯¹Booksçš„æ“ä½œä¼šååº”åˆ°æ•°æ®åº“çš„T_Booksè¡¨ä¸­ã€‚è¿™æ ·ç»§æ‰¿è‡ªDbContextçš„ç±»å«ä½œâ€œä¸Šä¸‹æ–‡â€ã€‚</p><h3 id="å¼€å§‹åˆ›å»ºç¨‹åºå¯¹åº”çš„æ•°æ®åº“å’Œæ•°æ®åº“è¡¨"><a href="#å¼€å§‹åˆ›å»ºç¨‹åºå¯¹åº”çš„æ•°æ®åº“å’Œæ•°æ®åº“è¡¨" class="headerlink" title="å¼€å§‹åˆ›å»ºç¨‹åºå¯¹åº”çš„æ•°æ®åº“å’Œæ•°æ®åº“è¡¨"></a>å¼€å§‹åˆ›å»ºç¨‹åºå¯¹åº”çš„æ•°æ®åº“å’Œæ•°æ®åº“è¡¨</h3><p>EF Coreè¿™ç§æ ¹æ®å®ä½“ç±»ç”Ÿæˆæ•°æ®åº“è¡¨çš„æ“ä½œä¹Ÿè¢«å«ä½œâ€œè¿ç§»â€ï¼ˆmigrationï¼‰ã€‚<br>ä¸ºäº†ä½¿ç”¨EF Coreç”Ÿæˆæ•°æ®åº“çš„å·¥å…·ï¼Œé€šè¿‡NuGetä¸ºé¡¹ç›®å®‰è£…ä¹‹å</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Microsoft.EntityFrameworkCore.Tools</span><br></pre></td></tr></table></figure><p>å†ã€ç¨‹åºåŒ…ç®¡ç†å™¨æ§åˆ¶å°ã€‘ä¸­æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Add-Migration åˆç†çš„å˜é‡å</span><br></pre></td></tr></table></figure><p>Add-Migrationä¼šè‡ªåŠ¨å†é¡¹ç›®çš„Migrationsæ–‡ä»¶å¤¹ä¸­ç”Ÿæˆ</p><p>æ‰“å¼€<br><img src="/img%5CHello%5CEF.png"></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">EF_Core.Migrations</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;inheritdoc /&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">partial</span> <span class="keyword">class</span> <span class="title">InitialCreate</span> : <span class="title">Migration</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;inheritdoc /&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Up</span>(<span class="params">MigrationBuilder migrationBuilder</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            migrationBuilder.CreateTable(</span><br><span class="line">                name: <span class="string">&quot;T_Books&quot;</span>,</span><br><span class="line">                columns: table =&gt; <span class="keyword">new</span></span><br><span class="line">                &#123;</span><br><span class="line">                    Id = table.Column&lt;<span class="built_in">long</span>&gt;(type: <span class="string">&quot;bigint&quot;</span>, nullable: <span class="literal">false</span>)</span><br><span class="line">                        .Annotation(<span class="string">&quot;SqlServer:Identity&quot;</span>, <span class="string">&quot;1, 1&quot;</span>),</span><br><span class="line">                    Title = table.Column&lt;<span class="built_in">string</span>&gt;(type: <span class="string">&quot;nvarchar(max)&quot;</span>, nullable: <span class="literal">false</span>),</span><br><span class="line">                    PubTime = table.Column&lt;DateTime&gt;(type: <span class="string">&quot;datetime2&quot;</span>, nullable: <span class="literal">false</span>),</span><br><span class="line">                    Price = table.Column&lt;<span class="built_in">double</span>&gt;(type: <span class="string">&quot;float&quot;</span>, nullable: <span class="literal">false</span>)</span><br><span class="line">                &#125;,</span><br><span class="line">                constraints: table =&gt;</span><br><span class="line">                &#123;</span><br><span class="line">                    table.PrimaryKey(<span class="string">&quot;PK_T_Books&quot;</span>, x =&gt; x.Id);</span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line">            migrationBuilder.CreateTable(</span><br><span class="line">                name: <span class="string">&quot;T_Persons&quot;</span>,</span><br><span class="line">                columns: table =&gt; <span class="keyword">new</span></span><br><span class="line">                &#123;</span><br><span class="line">                    Id = table.Column&lt;<span class="built_in">int</span>&gt;(type: <span class="string">&quot;int&quot;</span>, nullable: <span class="literal">false</span>)</span><br><span class="line">                        .Annotation(<span class="string">&quot;SqlServer:Identity&quot;</span>, <span class="string">&quot;1, 1&quot;</span>),</span><br><span class="line">                    Name = table.Column&lt;<span class="built_in">string</span>&gt;(type: <span class="string">&quot;nvarchar(max)&quot;</span>, nullable: <span class="literal">false</span>),</span><br><span class="line">                    Age = table.Column&lt;<span class="built_in">int</span>&gt;(type: <span class="string">&quot;int&quot;</span>, nullable: <span class="literal">false</span>)</span><br><span class="line">                &#125;,</span><br><span class="line">                constraints: table =&gt;</span><br><span class="line">                &#123;</span><br><span class="line">                    table.PrimaryKey(<span class="string">&quot;PK_T_Persons&quot;</span>, x =&gt; x.Id);</span><br><span class="line">                &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;inheritdoc /&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Down</span>(<span class="params">MigrationBuilder migrationBuilder</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            migrationBuilder.DropTable(</span><br><span class="line">                name: <span class="string">&quot;T_Books&quot;</span>);</span><br><span class="line"></span><br><span class="line">            migrationBuilder.DropTable(</span><br><span class="line">                name: <span class="string">&quot;T_Persons&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªæ–‡ä»¶ä¸­åŒ…å«ç”¨æ¥åˆ›å»ºæ•°æ®åº“è¡¨çš„è¡¨åã€åˆ—åã€åˆ—æ•°æ®ç±»å‹ã€ä¸»é”®ç­‰çš„ä»£ç ã€‚<br>ä¸Šé¢çš„ä»£ç è¿˜æ²¡æœ‰æ‰§è¡Œï¼Œä»–ä»¬éœ€è¦è¢«æ‰§è¡Œåæ‰ä¼šåº”ç”¨åˆ°æ•°æ®åº“ï¼Œå› æ­¤æˆ‘ä»¬æ¥ç€åœ¨ã€ç¨‹åºåŒ…ç®¡ç†å™¨æ§åˆ¶å°ã€‘ä¸­æ‰§è¡ŒUpdate-databaseæ‰§è¡Œæ•°æ®åº“è¿ç§»ä»£ç ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Update-database</span><br></pre></td></tr></table></figure><h3 id="SQLServeræ•°æ®åº“"><a href="#SQLServeræ•°æ®åº“" class="headerlink" title="SQLServeræ•°æ®åº“"></a>SQLServeræ•°æ®åº“</h3><p>æŸ¥çœ‹SQLServeræ•°æ®åº“ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°æ•°æ®åº“studentåŠæ•°æ®åº“è¡¨T_Books,T_PersonT_Books,T_Personså·²ç»åˆ›å»ºæˆåŠŸï¼Œæ•°æ®åº“è¡¨T_Booksçš„ç»“æ„ä¹Ÿå’Œå®ä½“ç±»ä¸­é…ç½®çš„ä¸€è‡´ã€‚</p><p><img src="/img%5CHello%5Csjk.png"></p><p>å¯ä»¥æ ¹æ®éœ€è¦ä¿®æ”¹å®ä½“ç±»çš„é…ç½®ï¼Œè¿›è€Œä¿®æ”¹æ•°æ®åº“ä¸­çš„è¡¨ã€‚<br>ç”Ÿæˆçš„T_Booksè¡¨ä¸­Titleå­—æ®µçš„ç±»å‹ä¸ºnvarchar(MAX),æƒ³æŠŠå®ƒä¿®æ”¹ä¸ºnvarchar(50),æŠŠTitleå­—æ®µè®¾åˆ™ä¸ºâ€œä¸å¯ä¸ºç©ºâ€ï¼Œå¹¶ä¸”æƒ³å¢åŠ ä¸€ä¸ªä¸ä¸ºç©ºä¸”æœ€å¤§é•¿åº¦ä¸º20çš„AuthorNameå­—ç¬¦ä¸²ç±»å‹çš„å±æ€§ï¼Œå¯ä»¥ä¿®æ”¹Bookå®ä½“ç±»ï¼Œä¸ºå…¶å¢åŠ ä¸€ä¸ªAuthorNameå±æ€§ï¼Œä¸ºå…¶æ·»åŠ ä¸€ä¸ªAuthorNameå±æ€§ï¼Œç„¶åä¿®æ”¹BookEntityConfigçš„Configureæ–¹æ³•ã€‚</p><p>æ·»åŠ AuthorNameå±æ€§</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Book</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;<span class="comment">//ä¸»é”®</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Title &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;<span class="comment">//æ ‡é¢˜</span></span><br><span class="line">    <span class="keyword">public</span> DateTime PubTime &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;<span class="comment">//å‘å¸ƒæ—¥æœŸ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> Price &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;<span class="comment">//å•ä»·</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> AuthorName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;<span class="comment">//ä½œè€…</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">BookConfig</span>:<span class="title">IEntityTypeConfiguration</span>&lt;<span class="title">Book</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">EntityTypeBuilder&lt;Book&gt; builder</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        builder.ToTable(<span class="string">&quot;T_Books&quot;</span>);</span><br><span class="line">        builder.Property(e=&gt;e.Title).HasMaxLength(<span class="number">50</span>).IsRequired();</span><br><span class="line">        builder.Property(e=&gt;e.AuthorName).HasMaxLength(<span class="number">20</span>).IsRequired();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­HasMaxLength(50)ç”¨æ¥é…ç½®å±æ€§çš„æœ€å¤§é•¿åº¦ä¸º50ï¼ŒIsRequiredç”¨æ¥é…ç½®å±æ€§çš„å€¼ä¸ºâ€œä¸å¯ä¸ºç©ºâ€ã€‚</p><p>å®Œæˆä¿®æ”¹åï¼Œå†æ‰§è¡ŒAdd-Migration AddAuthorName_ModifyTitle<br>ç”±äºæˆ‘ä»¬æŠŠç°åœ¨çš„Titleåˆ—çš„å­—æ®µé•¿åº¦ä»MAXä¿®æ”¹ä¸ºäº†50ï¼Œå› æ­¤å¯èƒ½ä¼šé€ æˆæ•°æ®åº“ä¸­æ—§æ•°æ®çš„ä¸¢å¤±ï¼ŒAdd-Migrationå‘½ä»¤ç»™å‡ºäº†â€œAn operation was scaffolded that may result in the loss of data.â€è¿™ä¸ªè­¦å‘Šã€‚<br>ä¸Šé¢çš„å‘½ä»¤æ‰§è¡Œå®Œåï¼Œåœ¨é¡¹ç›®æ–‡ä»¶å¤¹ä¸‹åˆç”Ÿæˆäº†ä¸€ä¸ªæ–°çš„.csæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶åŒ…å«äº†ä¿®æ”¹T_Booksè¡¨çš„Titleåˆ—çš„é•¿åº¦ã€æ–°å¢AuthorNameåˆ—ç­‰çš„ä»£ç ã€‚</p><h2 id="æ’å…¥æ•°æ®"><a href="#æ’å…¥æ•°æ®" class="headerlink" title="æ’å…¥æ•°æ®"></a>æ’å…¥æ•°æ®</h2><p>TestDbContextç±»ä¸­çš„Bookså±æ€§å¯¹åº”æ•°æ®åº“ä¸­çš„T_Booksè¡¨ï¼ŒBookså±æ€§æ˜¯DbSet&lt;Book&gt;ç±»å‹çš„ã€‚<br>å› æ­¤æˆ‘ä»¬åªè¦æ“çºµBookså±æ€§ï¼Œå°±å¯ä»¥å‘æ•°æ®åº“ä¸­å¢åŠ æ•°æ®ï¼Œä½†æ˜¯é€šè¿‡C#ä»£ç ä¿®æ”¹Bookså±æ€§ä¸­çš„æ•°æ®åªæ˜¯ä¿®æ”¹äº†å†…å­˜ä¸­çš„æ•°æ®ï¼Œå¯¹Bookså±æ€§åšä¿®æ”¹åï¼Œè¿˜éœ€è¦è°ƒç”¨å¼‚æ­¥æ–¹æ³•<code>SaveChangesAsyncæŠŠä¿®æ”¹ä¿å­˜åˆ°æ•°æ®åº“ã€‚å…¶å®DbContextä¸­ä¹Ÿæœ‰åŒæ­¥çš„ä¿å­˜æ–¹æ³•SaveChanges,ä½†æ˜¯é‡‡ç”¨å¼‚æ­¥æ–¹æ³•é€šå¸¸èƒ½æå‡ç³»ç»Ÿçš„å¹¶å‘å¤„ç†èƒ½åŠ›ï¼Œå› æ­¤æˆ‘ä»¬æ¨èä½¿ç”¨å¼‚æ­¥æ–¹æ³•ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> EF_Core;</span><br><span class="line"><span class="comment">//Console.WriteLine(&quot;Hello World!&quot;);</span></span><br><span class="line"><span class="comment">//ctx = é€»è¾‘ä¸Šçš„æ•°æ®åº“</span></span><br><span class="line"><span class="keyword">using</span> (MyDbContext ctx = <span class="keyword">new</span> MyDbContext())</span><br><span class="line">&#123;</span><br><span class="line">    Dog d = <span class="keyword">new</span> Dog();</span><br><span class="line">    d.Name = <span class="string">&quot;Trump&quot;</span>;</span><br><span class="line">    ctx.Dogs.Add(d);<span class="comment">//æŠŠdå¯¹è±¡åŠ å…¥åˆ°Dogsè¿™ä¸ªé€»è¾‘ä¸Šçš„åˆ—è¡¨ä¸­</span></span><br><span class="line"></span><br><span class="line">    ctx.Dogs.Add(d);<span class="comment">//æŠŠdå¯¹è±¡åŠ å…¥åˆ°Dogsè¿™ä¸ªé€»è¾‘ä¸Šçš„åˆ—è¡¨ä¸­</span></span><br><span class="line">    <span class="keyword">await</span> ctx.SaveChangesAsync();<span class="comment">//æŠŠé€»è¾‘ä¸Šçš„æ•°æ®åº“çš„å˜åŒ–åº”ç”¨åˆ°ç‰©ç†æ•°æ®åº“ä¸­</span></span><br><span class="line"></span><br><span class="line">    Dog d2 = <span class="keyword">new</span> Dog();</span><br><span class="line">    d2.Name = <span class="string">&quot;Biden&quot;</span>;</span><br><span class="line">    ctx.Dogs.Add(d2);</span><br><span class="line"></span><br><span class="line">    Book book = <span class="keyword">new</span> Book();</span><br><span class="line">    book.Title = <span class="string">&quot;C#&quot;</span>;</span><br><span class="line">    book.AuthorName = <span class="string">&quot;Bill&quot;</span>;</span><br><span class="line">    book.Price = <span class="number">100</span>;</span><br><span class="line">    book.PubTime = DateTime.Now;</span><br><span class="line">    ctx.Books.Add(book);</span><br><span class="line">    <span class="keyword">await</span> ctx.SaveChangesAsync();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·æˆ‘ä»¬å°±å®ç°äº†ä¸ç”¨ç¼–ç¨‹å†™SQLè¯­å¥ï¼Œè€Œæ˜¯é€šè¿‡åˆ›å»ºå¯¹è±¡å’Œä¸ºå¯¹è±¡èµ‹å€¼çš„æ–¹å¼å®Œæˆå¯¹æ•°æ®åº“çš„æ“ä½œã€‚</p><h2 id="æŸ¥è¯¢æ•°æ®"><a href="#æŸ¥è¯¢æ•°æ®" class="headerlink" title="æŸ¥è¯¢æ•°æ®"></a>æŸ¥è¯¢æ•°æ®</h2><p>Bookså±æ€§å’Œæ•°æ®åº“ä¸­çš„T_Booksè¡¨å¯¹åº”ï¼ŒBookså±æ€§æ˜¯DbSet<Book>ç±»å‹çš„ï¼Œè€ŒDbSetå®ç°äº†IEnumerable&lt;T&gt;æ¥å£ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨LINQæ“ä½œå¯¹DbSetè¿›è¡Œæ•°æ®æŸ¥è¯¢ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">//var b1 = new Book &#123; AuthorName = &quot;YOUXIANYU&quot;, Title = &quot;é›¶åŸºç¡€å­¦c#&quot;, Price = 100, PubTime = new DateTime(2019, 3, 1) &#125;;</span></span><br><span class="line"> <span class="comment">//var b2 = new Book &#123; AuthorName =&quot;Almngao&quot;, Title = &quot;é›¶åŸºç¡€å­¦c++&quot;, Price = 90, PubTime = new DateTime(2018, 3, 1) &#125;;</span></span><br><span class="line"> <span class="comment">//var b3 = new Book &#123; AuthorName = &quot;you&quot;, Title = &quot;é›¶åŸºç¡€å­¦c&quot;, Price = 50, PubTime = new DateTime(2016, 3, 1) &#125;;</span></span><br><span class="line"> <span class="comment">//var b4 = new Book &#123; AuthorName = &quot;yu&quot;, Title = &quot;é›¶åŸºç¡€å­¦java&quot;, Price = 80, PubTime = new DateTime(2015, 3, 1) &#125;;</span></span><br><span class="line"> <span class="comment">//var b5 = new Book &#123; AuthorName = &quot;xi&quot;, Title = &quot;é›¶åŸºç¡€å­¦python&quot;, Price = 60, PubTime = new DateTime(2014, 3, 1) &#125;;</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">//ctx.Books.AddRange(b1);</span></span><br><span class="line"> <span class="comment">//ctx.Books.AddRange(b2);</span></span><br><span class="line"> <span class="comment">//ctx.Books.AddRange(b3);</span></span><br><span class="line"> <span class="comment">//ctx.Books.AddRange(b4);</span></span><br><span class="line"> <span class="comment">//ctx.Books.AddRange(b5);</span></span><br><span class="line"> <span class="comment">//await ctx.SaveChangesAsync();</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="keyword">var</span> books = ctx.Books.Where(b =&gt; b.Price &gt; <span class="number">80</span>);</span><br><span class="line"> <span class="keyword">foreach</span> (<span class="keyword">var</span> b <span class="keyword">in</span> books)</span><br><span class="line"> &#123;</span><br><span class="line">     Console.WriteLine(b.Title);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">var</span> book=ctx.Books.Single(b=&gt;b.Title == <span class="string">&quot;é›¶åŸºç¡€å­¦c#&quot;</span>);</span><br><span class="line"> Console.WriteLine(book.AuthorName);</span><br><span class="line"></span><br><span class="line"> <span class="keyword">var</span> book1 = ctx.Books.OrderBy(b =&gt; b.Price);</span><br><span class="line"> <span class="keyword">foreach</span> (<span class="keyword">var</span> b <span class="keyword">in</span> book1)</span><br><span class="line"> &#123;</span><br><span class="line">     Console.WriteLine(b.Title+<span class="string">&quot;,&quot;</span>+b.Price);</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> book2 = ctx.Books.GroupBy(b =&gt; b.AuthorName).Select(g =&gt; <span class="keyword">new</span></span><br><span class="line">&#123;</span><br><span class="line">    Name = g.Key,</span><br><span class="line">    BooksCount = g.Count(),</span><br><span class="line">    MaxPrice = g.Max(b =&gt; b.Price)</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> e <span class="keyword">in</span> book2)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(e.Name + <span class="string">&quot;,&quot;</span> + e.BooksCount + <span class="string">&quot;,&quot;</span> + e.MaxPrice);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="ä¿®æ”¹å’Œåˆ é™¤æ•°æ®"><a href="#ä¿®æ”¹å’Œåˆ é™¤æ•°æ®" class="headerlink" title="ä¿®æ”¹å’Œåˆ é™¤æ•°æ®"></a>ä¿®æ”¹å’Œåˆ é™¤æ•°æ®</h2><p>ä½¿ç”¨EF Core,è¿˜å¯ä»¥å¯¹å·²æœ‰çš„æ•°æ®è¿›è¡Œä¿®æ”¹ã€åˆ é™¤æ“ä½œã€‚å¸¸è§„æ¥è®²ï¼Œå¦‚æœè¦å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦æŠŠè¦ä¿®æ”¹çš„æ•°æ®æŸ¥è¯¢åˆæ¥ï¼Œç„¶åå¯¹æŸ¥è¯¢å‡ºæ¥çš„æ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œå†æ‰§è¡ŒSaveChangesAsyncä¿å­˜ä¿®æ”¹å³å¯ã€‚</p><p>åŒæ ·ï¼Œè¦å¯¹æ•°æ®è¿›è¡Œåˆ é™¤ï¼Œæˆ‘ä»¬è¦å…ˆæŠŠå¾…åˆ é™¤çš„æ•°æ®æŸ¥è¯¢å‡ºæ¥ï¼Œç„¶åè°ƒç”¨DbSetæˆ–è€…DbContextdçš„Removeæ–¹æ³•æŠŠæ•°æ®åˆ é™¤ï¼Œå†æ‰§è¡ŒSaveChangesAsyncæ–¹æ³•ä¿å­˜ç»“æœåˆ°æ•°æ®åº“ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> b = ctx.Books.Single(b =&gt; b.Title == <span class="string">&quot;é›¶åŸºç¡€å­¦java&quot;</span>);</span><br><span class="line">b.AuthorName = <span class="string">&quot;youxianyu&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> d=ctx.Dogs.Single(b =&gt; b.Id == <span class="number">3</span>);</span><br><span class="line">ctx.Dogs.Remove(d);</span><br><span class="line"><span class="keyword">await</span> ctx.SaveChangesAsync();</span><br></pre></td></tr></table></figure><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ— è®ºæ˜¯ä¸Šé¢çš„ä¿®æ”¹æ•°æ®çš„ä»£ç è¿˜æ˜¯åˆ é™¤æ•°æ®çš„ä»£ç ï¼Œéƒ½æ˜¯è¦å…ˆæ‰§è¡Œæ•°æ®çš„æŸ¥è¯¢æ“ä½œï¼ŒæŠŠæ•°æ®æŸ¥è¯¢å‡ºæ¥ï¼Œå†æ‰§è¡Œä¿®æ”¹æˆ–åˆ é™¤æ“ä½œã€‚è¿™æ ·åœ¨EF Coreçš„åº•å±‚å…¶å®å‘ç”Ÿäº†å…ˆæ‰§è¡ŒSelectçš„SQLè¯­å¥ï¼Œç„¶åæ‰§è¡ŒUpdateæˆ–è€…Deleteçš„SQLè¯­å¥ã€‚</p><p>æ‰¹é‡åˆ é™¤</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åˆ é™¤ç»™å®šçš„æ•°æ®</span></span><br><span class="line"><span class="keyword">await</span> ctx.Books.Where(<span class="keyword">static</span> x=&gt;x.Id==<span class="number">1</span>).ExecuteDeleteAsync();</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ é™¤æ‰€æœ‰ä»·æ ¼å¤§äº10çš„æ•°æ®</span></span><br><span class="line"><span class="keyword">await</span> ctx.Books.Where(b =&gt; b.Price &gt; <span class="number">10</span>).ExecuteDeleteAsync();</span><br><span class="line"><span class="comment">//æ‰¹é‡æ›´æ–°</span></span><br><span class="line"><span class="keyword">await</span> ctx.Books</span><br><span class="line">    .Where(b =&gt; b.Title == <span class="string">&quot;é›¶åŸºç¡€å­¦&quot;</span>)</span><br><span class="line">    .ExecuteUpdateAsync(e =&gt; e.SetProperty(d =&gt; d.Price, d =&gt; d.Price + <span class="number">10</span>)</span><br><span class="line">    .SetProperty(d =&gt; d.Title, d =&gt; d.Title + <span class="string">&quot;C#&quot;</span>));</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> EF Core </tag>
            
            <tag> ASP.NET Core </tag>
            
            <tag> Entity Framework Core </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>EF Coreå®ä½“ç±»é…ç½®</title>
      <link href="/2025/03/28/asp.net%20core/EF%20Core%E7%9A%84%E5%AE%9E%E4%BD%93%E7%B1%BB%E9%85%8D%E7%BD%AE/"/>
      <url>/2025/03/28/asp.net%20core/EF%20Core%E7%9A%84%E5%AE%9E%E4%BD%93%E7%B1%BB%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<h1 id="EF-Coreå®ä½“ç±»é…ç½®"><a href="#EF-Coreå®ä½“ç±»é…ç½®" class="headerlink" title="EF Coreå®ä½“ç±»é…ç½®"></a>EF Coreå®ä½“ç±»é…ç½®</h1><h2 id="çº¦å®šå¤§äºé…ç½®"><a href="#çº¦å®šå¤§äºé…ç½®" class="headerlink" title="çº¦å®šå¤§äºé…ç½®"></a>çº¦å®šå¤§äºé…ç½®</h2><p>ä¸»è¦çš„çº¦å®šè§„åˆ™<br>è§„åˆ™1ï¼šæ•°æ®åº“è¡¨åé‡‡ç”¨ä¸Šä¸‹æ–‡ç±»ä¸­å¯¹åº”çš„DbSetçš„å±æ€§åã€‚<br>è§„åˆ™2ï¼šæ•°æ®åº“è¡¨åˆ—çš„åå­—é‡‡ç”¨å®ä½“ç±»å±æ€§çš„åå­—ï¼Œåˆ—çš„æ•°æ®åº“ç±»å‹é‡‡ç”¨å’Œå®ä½“ç±»å±æ€§ç±»å‹å…¼å®¹çš„ç±»å‹ã€‚æ¯”å¦‚åœ¨SQL Serverä¸­ï¼Œstringç±»å‹å¯¹åº”nvarchar,longç±»å‹å¯¹åº”bigint.<br>è§„åˆ™3ï¼šæ•°æ®åº“è¡¨åˆ—å°”å¯ç©ºæ€§å–å†³äºå¯¹åº”å®ä½“ç±»ç†Ÿæ‚‰çš„å¯ç©ºæ€§ã€‚<br>è§„åˆ™4ï¼šåå­—ä¸ºIdçš„å±æ€§ä¸ºä¸»é”®ï¼Œå¦‚æœä¸»é”®ä¸ºshortã€intæˆ–è€…longç±»å‹ï¼Œåˆ™ä¸»é”®é»˜è®¤é‡‡ç”¨è‡ªåŠ¨å¢é•¿ç±»å‹çš„åˆ—ã€‚</p><h2 id="Data-Annotationï¼ˆæ•°æ®æ³¨è§£ï¼‰"><a href="#Data-Annotationï¼ˆæ•°æ®æ³¨è§£ï¼‰" class="headerlink" title="Data Annotationï¼ˆæ•°æ®æ³¨è§£ï¼‰"></a>Data Annotationï¼ˆæ•°æ®æ³¨è§£ï¼‰</h2><p>Data AnnotationæŒ‡çš„æ˜¯å¯ä»¥ä½¿ç”¨.NETæä¾›çš„Attributeå¯¹å®ä½“ç±»ã€å±æ€§ç­‰è¿›è¡Œæ ‡æ³¨çš„æ–¹å¼æ¥å®ç°å®ä½“ç±»é…ç½®ã€‚æ¯”å¦‚é€šè¿‡[Table(â€œT_Booksâ€)]ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ä½“ç±»å¯¹åº”çš„è¡¨åé…ç½®ä¸ºT_Books;</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æŒ‡å®šè¡¨å</span></span><br><span class="line">[<span class="meta">Table(<span class="string">&quot;T_Cats&quot;</span>)</span>]</span><br><span class="line"><span class="keyword">class</span> <span class="title">Cat</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;<span class="comment">//ä¸»é”®</span></span><br><span class="line">    [<span class="meta">Required</span>]<span class="comment">//éç©º</span></span><br><span class="line">    [<span class="meta">MaxLength(20)</span>]<span class="comment">//æœ€å¤§é•¿åº¦</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;<span class="comment">//å§“å</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¼˜ç‚¹ï¼šç®€å• | ç¼ºç‚¹ï¼šè€¦åˆ</p><h2 id="Fluent-API"><a href="#Fluent-API" class="headerlink" title="Fluent API"></a>Fluent API</h2><p>Fluent APIå±äºå®˜æ–¹çš„æ¨èç”¨æ³•</p><p>Fluent APIèƒ½å¤Ÿæ›´å¥½åœ°è¿›è¡ŒèŒè´£åˆ†ç¦»ã€‚å®ä½“ç±»åªèƒ½è´Ÿè´£è¿›è¡ŒæŠ½è±¡åœ°æè¿°ï¼Œä¸æ¶‰åŠä¸æ•°æ®åº“ç›¸å…³çš„ç»†èŠ‚ï¼Œæ‰€æœ‰å’Œæ•°æ®åº“ç›¸å…³çš„ç»†èŠ‚è¢«æ”¾åˆ°é…ç½®ç±»ä¸­ï¼Œè¿™æ ·æˆ‘ä»¬èƒ½æ›´æ–¹ä¾¿åœ°è¿›è¡Œå¤§å‹é¡¹ç›®çš„ç®¡ç†ã€‚</p><p>2.Fluent APIçš„åŠŸèƒ½æ›´å¼ºå¤§ã€‚Fluent APIå‡ ä¹èƒ½å®ç°Data Annotationçš„æ‰€æœ‰åŠŸèƒ½ï¼Œè€ŒData Annotationåˆ™ä¸æ”¯æŒFluent APIçš„ä¸€äº›åŠŸèƒ½ã€‚</p><h2 id="Fluent-API-åŸºæœ¬é…ç½®"><a href="#Fluent-API-åŸºæœ¬é…ç½®" class="headerlink" title="Fluent API åŸºæœ¬é…ç½®"></a>Fluent API åŸºæœ¬é…ç½®</h2><h3 id="è§†å›¾ä¸å®ä½“ç±»æ˜ å°„"><a href="#è§†å›¾ä¸å®ä½“ç±»æ˜ å°„" class="headerlink" title="è§†å›¾ä¸å®ä½“ç±»æ˜ å°„"></a>è§†å›¾ä¸å®ä½“ç±»æ˜ å°„</h3><p>å¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç æŠŠblogsViewè¿™ä¸ªæ•°æ®åº“ä¸­çš„è§†å›¾å’ŒBlogå®ä½“ç±»è¿›è¡Œæ˜ å°„ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">modelBuilder.Entity&lt;Blog&gt;().ToView(<span class="string">&quot;blogView&quot;</span>);</span><br></pre></td></tr></table></figure><h3 id="æ’é™¤å±æ€§æ˜ å°„"><a href="#æ’é™¤å±æ€§æ˜ å°„" class="headerlink" title="æ’é™¤å±æ€§æ˜ å°„"></a>æ’é™¤å±æ€§æ˜ å°„</h3><p>ä¸€ä¸ªå®ä½“ç±»çš„æ‰€æœ‰å±æ€§éƒ½ä¼šæ˜ å°„åˆ°æ•°æ®åº“è¡¨ä¸­ï¼Œå¦‚æœæƒ³è®©EF Coreå¿½ç•¥ä¸€ä¸ªå±æ€§ï¼Œå°±å¯ä»¥ç”¨lgnoreé…ç½®ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">modelBuilder.Entity&lt;Blog&gt;().Ignore(b=&gt;b.Name2);</span><br></pre></td></tr></table></figure><h3 id="æ•°æ®åº“è¡¨åˆ—å"><a href="#æ•°æ®åº“è¡¨åˆ—å" class="headerlink" title="æ•°æ®åº“è¡¨åˆ—å"></a>æ•°æ®åº“è¡¨åˆ—å</h3><p>æ•°æ®åº“è¡¨ä¸­çš„åˆ—åé»˜è®¤å’Œå±æ€§åä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨HasColumnNameæ–¹æ³•é…ç½®ä¸€ä¸ªä¸åŒçš„åˆ—åã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">modelBuilder.Entity&lt;Blog&gt;().Property(b=&gt;b.BlogId).HasColumnName(<span class="string">&quot;blog_id&quot;</span>);</span><br></pre></td></tr></table></figure><h3 id="åˆ—æ•°æ®ç±»å‹"><a href="#åˆ—æ•°æ®ç±»å‹" class="headerlink" title="åˆ—æ•°æ®ç±»å‹"></a>åˆ—æ•°æ®ç±»å‹</h3><p>EF Coreé»˜è®¤ä¼šæ ¹æ®å®ä½“ç±»çš„å±æ€§ç±»å‹ã€æœ€å¤§é•¿åº¦ç­‰ç¡®å®šå­—æ®µçš„æ•°æ®ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨HasColumnTypeä¸ºåˆ—æŒ‡å®šæ•°æ®ç±»å‹ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">builder.Property(e=&gt;e.Tilte).HasColumnType(<span class="string">&quot;nvarchar(200)&quot;</span>);</span><br></pre></td></tr></table></figure><h3 id="ä¸»é”®"><a href="#ä¸»é”®" class="headerlink" title="ä¸»é”®"></a>ä¸»é”®</h3><p>EF Coreé»˜è®¤æŠŠåå­—ä¸ºIdæˆ–è€…â€œå®ä½“ç±»å‹+idâ€çš„å±æ€§ä½œä¸ºä¸»é”®ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨HasKeyé…ç½®å…¶ä»–å±æ€§ä½œä¸ºä¸»é”®ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">modelBuilder.Entity&lt;Student&gt;().HasKey(c=&gt;c.Number);</span><br></pre></td></tr></table></figure><h3 id="ç´¢å¼•"><a href="#ç´¢å¼•" class="headerlink" title="ç´¢å¼•"></a>ç´¢å¼•</h3><p>EF Coreä¸­å¯ç”¨HasIdexæ–¹æ³•é…ç½®ç´¢å¼•ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">modelBuilder.Entity&lt;Blog&gt;().HasIndex(b=&gt;b.Url);</span><br></pre></td></tr></table></figure><p>EF Coreä¹Ÿæ”¯æŒå¤šä¸ªå±æ€§ç»„æˆçš„å¤åˆç´¢å¼•ï¼Œåªè¦ç»™HasIndexæ–¹æ³•ä¼ é€’ç”±ä¸€ä¸ªæˆ–å¤šä¸ªå±æ€§çš„åå­—ç»„æˆçš„åŒ¿åç±»å¯¹è±¡å³å¯ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">modelBuilder.Entity&lt;Person&gt;().HasIndex(p=&gt;<span class="keyword">new</span>&#123;p.FirstName,p.LastName&#125;);</span><br></pre></td></tr></table></figure><p>EF Coreä¸­å®šä¹‰çš„ç´¢å¼•ä¸æ˜¯å”¯ä¸€ç´¢å¼•ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨IsUniqueæ–¹æ³•æŠŠç´¢å¼•é…ç½®ä¸ºå”¯ä¸€ç´¢å¼•ã€‚æˆ‘ä»¬è¿˜å¯ä»¥ç”¨IsClusteredæ–¹æ³•æŠŠç´¢å¼•è®¾ç½®ä¸ºèšé›†ç´¢å¼•ã€‚</p><h2 id="ä¸»é”®ç±»å‹é€‰æ‹©å¹¶ä¸ç®€å•"><a href="#ä¸»é”®ç±»å‹é€‰æ‹©å¹¶ä¸ç®€å•" class="headerlink" title="ä¸»é”®ç±»å‹é€‰æ‹©å¹¶ä¸ç®€å•"></a>ä¸»é”®ç±»å‹é€‰æ‹©å¹¶ä¸ç®€å•</h2><p>åœ¨æ•°æ®åº“è®¾è®¡ä¸­ï¼Œå¯¹äºä¸»é”®ç±»å‹æ¥è®²ï¼Œæœ‰è‡ªåŠ¨è‡ªå¢ï¼ˆç®€ç§°è‡ªå¢ï¼‰çš„longç±»å‹å’ŒGuidç±»å‹ä¸¤ç§å¸¸ç”¨çš„æ–¹æ¡ˆã€‚</p><h3 id="æ™®é€šè‡ªå¢"><a href="#æ™®é€šè‡ªå¢" class="headerlink" title="æ™®é€šè‡ªå¢"></a>æ™®é€šè‡ªå¢</h3><p>è‡ªå¢longç±»å‹çš„ä½¿ç”¨éå¸¸ç®€å•ï¼Œæ‰€æœ‰ä¸»æµæ•°æ®åº“ç³»ç»Ÿéƒ½å†…ç½®äº†å¯¹è‡ªå¢åˆ—çš„æ”¯æŒï¼Œæ–°æ’å…¥çš„æ•°æ®åº“ä¼šç”±æ•°æ®åº“è‡ªåŠ¨èµ‹äºˆä¸€ä¸ªæ–°å¢çš„ã€ä¸é‡å¤çš„ä¸»é”®å€¼ã€‚è‡ªå¢longç±»å‹å ç”¨ç£ç›˜ç©ºé—´å°ï¼Œå¯è¯»æ€§å¼ºï¼Œä½†æ˜¯è‡ªå¢longç±»å‹çš„ä¸»é”®åœ¨æ•°æ®åº“è¿ç§»ä»¥åŠåˆ†å¸ƒå¼ç³»ç»Ÿï¼ˆåˆ†å¸ƒè¡¨ã€æ•°æ®åº“é›†ç¾¤ï¼‰ä¸­ä½¿ç”¨èµ·æ¥æ¯”è¾ƒéº»çƒ¦ï¼Œè€Œä¸”åœ¨é«˜å¹¶å‘æ’å…¥çš„æ—¶å€™æ€§èƒ½æ¯”è¾ƒå·®ã€‚<br>ç”±äºè‡ªå¢åˆ—çš„å€¼ä¸€èˆ¬éƒ½æ˜¯ç”±æ•°æ®åº“ç”Ÿæˆçš„ï¼Œå› æ­¤æ— æ³•æå‰è·å¾—æ–°å¢æ•°æ®è¡Œçš„ä¸»é”®å€¼ï¼Œæˆ‘ä»¬éœ€è¦æŠŠæ•°æ®ä¿å­˜åˆ°æ•°æ®åº“ä¹‹åæ‰èƒ½è·å¾—ä¸»é”®çš„å€¼ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Dog dog=<span class="keyword">new</span> Dog();</span><br><span class="line">       dog.Name = <span class="string">&quot;Trump&quot;</span>;</span><br><span class="line">       Console.WriteLine(dog.Id);</span><br><span class="line">       ctx.Dogs.Add(dog);</span><br><span class="line">       <span class="keyword">await</span> ctx.SaveChangesAsync();</span><br><span class="line">       Console.WriteLine(dog.Id);</span><br></pre></td></tr></table></figure><h3 id="Guidç®—æ³•"><a href="#Guidç®—æ³•" class="headerlink" title="Guidç®—æ³•"></a>Guidç®—æ³•</h3><p>Guidç®—æ³•ä½¿ç”¨ç½‘å¡çš„MACåœ°å€ï¼Œæ—¶é—´æˆ³ç­‰ä¿¡æ¯ç”Ÿæˆä¸€ä¸ªå…¨çƒå”¯ä¸€çš„IDã€‚ç”±äºGuidçš„å…¨çƒå”¯ä¸€æ€§ï¼Œå®ƒé€‚ç”¨äºåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œåœ¨è¿›è¡Œå¤šæ•°æ®åº“æ•°æ®åˆå¹¶çš„æ—¶å€™å¾ˆæ–¹ä¾¿ï¼Œå› æ­¤æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨Guidç±»å‹ä½œä¸ºä¸»é”®ã€‚<br>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç”±äºGuidç®—æ³•ç”Ÿæˆçš„å€¼æ˜¯ä¸è¿ç»­çš„ï¼Œï¼ˆå³ä½¿æ˜¯SQLServerä¸­NewSequentialIdå‡½æ•°ç”Ÿæˆçš„Guidä¹Ÿä¸èƒ½æ ¹æœ¬è§£å†³è¿™ä¸ªé—®é¢˜ï¼‰ï¼Œå› æ­¤æˆ‘ä»¬åœ¨ä½¿ç”¨Guidç±»å‹ä½œä¸ºä¸»é”®çš„æ—¶å€™ï¼Œä»–å°†ä¼šå¯¼è‡´æ–°æ’å…¥çš„æ¯æ¡æ•°æ®éƒ½è¦ç»å†æŸ¥æ‰¾ä½•æ—¶æ’å…¥ä½ç½®çš„è¿‡ç¨‹ï¼Œåœ¨æ•°æ®é‡å¤§çš„æ—¶å€™å°†ä¼šå¯¼è‡´éå¸¸ç³Ÿç³•çš„æ•°æ®æ’å…¥æ€§èƒ½ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Rebbit r = <span class="keyword">new</span> Rebbit();</span><br><span class="line">r.Id = Guid.NewGuid();</span><br><span class="line">r.Name = <span class="string">&quot;YOUXIANYU&quot;</span>;</span><br><span class="line">Console.WriteLine(r.Id);</span><br><span class="line">ctx.Rebbits.Add(r);</span><br><span class="line">Console.WriteLine(r.Id);</span><br><span class="line"><span class="keyword">await</span> ctx.SaveChangesAsync();</span><br><span class="line">Console.WriteLine(r.Id);</span><br></pre></td></tr></table></figure><h2 id="å…¶ä»–æ•°æ®åº“è¿ç§»å‘½ä»¤"><a href="#å…¶ä»–æ•°æ®åº“è¿ç§»å‘½ä»¤" class="headerlink" title="å…¶ä»–æ•°æ®åº“è¿ç§»å‘½ä»¤"></a>å…¶ä»–æ•°æ®åº“è¿ç§»å‘½ä»¤</h2><h3 id="Update-database-å…¶ä»–å‚æ•°"><a href="#Update-database-å…¶ä»–å‚æ•°" class="headerlink" title="Update-database å…¶ä»–å‚æ•°"></a>Update-database å…¶ä»–å‚æ•°</h3><p>å¯ä»¥ç”¨Update-database XXX æŠŠæ•°æ®åº“å›æ»šåˆ°XXXè¿ç§»è„šæœ¬ä¹‹åçš„çŠ¶æ€ã€‚æ³¨æ„ï¼Œè¿™ä¸ªå‘½ä»¤åªèƒ½æŠŠå½“å‰è¿æ¥çš„æ•°æ®åº“è¿›è¡Œå›æ»šï¼Œå› æ­¤è¿ç§»è„šæœ¬ä»ç„¶å­˜åœ¨ã€‚</p><h3 id="åˆ é™¤è¿ç§»è„šæœ¬"><a href="#åˆ é™¤è¿ç§»è„šæœ¬" class="headerlink" title="åˆ é™¤è¿ç§»è„šæœ¬"></a>åˆ é™¤è¿ç§»è„šæœ¬</h3><p>å¯ä»¥ç”¨Remove-migrationå‘½ä»¤åˆ é™¤æœ€åä¸€æ¬¡çš„è¿ç§»è„šæœ¬ã€‚</p><h3 id="ç”Ÿäº§è¿ç§»è„šæœ¬"><a href="#ç”Ÿäº§è¿ç§»è„šæœ¬" class="headerlink" title="ç”Ÿäº§è¿ç§»è„šæœ¬"></a>ç”Ÿäº§è¿ç§»è„šæœ¬</h3><p>EF Coreä¸­æä¾›äº†Script-Migrationå‘½ä»¤æ¥æ ¹æ®è¿ç§»ä»£ç ç”ŸæˆSQLè„šæœ¬ï¼Œåœ¨ã€ç¨‹åºåŒ…ç®¡ç†å™¨æ§åˆ¶å°ã€‘ä¸­è¾“å…¥Script-Migrationå¹¶æ‰§è¡Œï¼Œä¸€ä¸ªåŒ…å«å®Œæ•´çš„æ•°æ®åº“æ“ä½œè„šæœ¬çš„SQLæ–‡ä»¶å°±ä¼šè¢«åˆ›å»ºå’Œæ‰“å¼€ã€‚</p><p>å¦‚æœç”Ÿäº§æ•°æ®åº“å·²ç»å¤„äºæŸä¸ªè¿ç§»ç‰ˆæœ¬çš„çŠ¶æ€ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”Ÿæˆè¿™ä¸ªç‰ˆæœ¬Dåˆ°ç‰ˆæœ¬Fçš„SQLè„šæœ¬ï¼šScript-Migration D Fã€‚</p><p>è¿˜å¯ä»¥ä½¿ç”¨context.Database.Migrate()ä»£ç æ¥å¯¹ç¨‹åºå½“å‰è¿æ¥çš„æ•°æ®åº“è¿›è¡Œè¿ç§»ã€‚è¿™ç§æ–¹å¼æ˜¯ç›´æ¥åœ¨ä»£ç ä¸­å®Œæˆæ•°æ®åº“è¿ç§»ï¼Œå¾ˆå¤šå…¬å¸çš„å®‰å…¨å®¡è®¡è¦æ±‚æä¾›çš„æ˜¯æ˜æ–‡çš„SQLè¯­å¥ã€‚</p><h2 id="æŸ¥è¯¢EF-Coreç”Ÿæˆçš„SQLè¯­å¥"><a href="#æŸ¥è¯¢EF-Coreç”Ÿæˆçš„SQLè¯­å¥" class="headerlink" title="æŸ¥è¯¢EF Coreç”Ÿæˆçš„SQLè¯­å¥"></a>æŸ¥è¯¢EF Coreç”Ÿæˆçš„SQLè¯­å¥</h2><h3 id="ä½¿ç”¨ç®€å•æ—¥å¿—æŸ¥çœ‹SQLè¯­å¥"><a href="#ä½¿ç”¨ç®€å•æ—¥å¿—æŸ¥çœ‹SQLè¯­å¥" class="headerlink" title="ä½¿ç”¨ç®€å•æ—¥å¿—æŸ¥çœ‹SQLè¯­å¥"></a>ä½¿ç”¨ç®€å•æ—¥å¿—æŸ¥çœ‹SQLè¯­å¥</h3><p>åªè¦åœ¨ä¸Šä¸‹æ–‡çš„OnConfiguringæ–¹æ³•ä¸­è°ƒç”¨optionsBuilderç±»çš„LogToæ–¹æ³•ï¼ŒæŸ¥è¯¢SQLè¯­å¥ï¼Œè¾“å‡ºåˆ°æ§åˆ¶å°ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnConfiguring</span>(<span class="params">DbContextOptionsBuilder optionsBuilder</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//è¿æ¥æ•°æ®åº“</span></span><br><span class="line">    <span class="keyword">base</span>.OnConfiguring(optionsBuilder);</span><br><span class="line">    <span class="built_in">string</span> connstr = <span class="string">&quot;Server=localhost;Database=student;Trusted_Connection=True;MultipleActiveResultSets=true;Encrypt=false;&quot;</span>;</span><br><span class="line">    optionsBuilder.UseSqlServer(connstr).LogTo(Console.WriteLine);</span><br><span class="line">    optionsBuilder.LogTo(message =&gt;  Console.WriteLine(message),LogLevel.Information);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è®°å½•åˆ°æ–‡ä»¶</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">readonly</span> StreamWriter _logStream = <span class="keyword">new</span> StreamWriter(<span class="string">&quot;mylog.txt&quot;</span>, append: <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnConfiguring</span>(<span class="params">DbContextOptionsBuilder optionsBuilder</span>)</span></span><br><span class="line">    =&gt; optionsBuilder.LogTo(_logStream.WriteLine);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Dispose</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">base</span>.Dispose();</span><br><span class="line">    _logStream.Dispose();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">async</span> ValueTask <span class="title">DisposeAsync</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">await</span> <span class="keyword">base</span>.DisposeAsync();</span><br><span class="line">    <span class="keyword">await</span> _logStream.DisposeAsync();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> EF Core </tag>
            
            <tag> ASP.NET Core </tag>
            
            <tag> Entity Framework Core </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ—¥å¿—</title>
      <link href="/2025/03/24/asp.net%20core/%E6%97%A5%E5%BF%97/"/>
      <url>/2025/03/24/asp.net%20core/%E6%97%A5%E5%BF%97/</url>
      
        <content type="html"><![CDATA[<h1 id="æ—¥å¿—"><a href="#æ—¥å¿—" class="headerlink" title="æ—¥å¿—"></a>æ—¥å¿—</h1><p>æ—¥å¿—ï¼ˆloggingï¼‰æ˜¯ç¨‹åºè¿è¡Œä¸­çš„â€œé»‘åŒ£å­â€ï¼Œåœ¨ç¨‹å‡ºç°é—®é¢˜ä»¥åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ†ææ—¥å¿—æ¥æŸ¥è¯¢é—®é¢˜ã€‚</p><h2 id="NET-Coreæ—¥å­åŸºæœ¬ä½¿ç”¨"><a href="#NET-Coreæ—¥å­åŸºæœ¬ä½¿ç”¨" class="headerlink" title=".NET Coreæ—¥å­åŸºæœ¬ä½¿ç”¨"></a>.NET Coreæ—¥å­åŸºæœ¬ä½¿ç”¨</h2><p>.NET Coreä¸­çš„æ—¥å¿—ç³»ç»Ÿå¯ä»¥æŠŠæ—¥å¿—è®°å½•åˆ°æ§åˆ¶å°ã€äº‹ä»¶æ—¥å¿—ã€è°ƒè¯•çª—å£ç­‰åœ°æ–¹ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹æ—¥å¿—æä¾›ç¨‹åºæŠŠæ—¥å¿—è®°å½•åˆ°æ–‡ä»¶ã€æ—¥å¿—æœåŠ¡å™¨ç­‰åœ°æ–¹ã€‚å’Œé…ç½®ç³»ç»Ÿä¸€æ ·ï¼Œ.NET Coreä¸­çš„æ—¥å¿—æä¾›äº†æ ‡å‡†æ¥å£åŠå®˜æ–¹çš„ä¸€äº›å®ç°ï¼ŒåŒæ—¶å…è®¸å¼€å‘äººå‘˜ç¼–å†™ç¬¬ä¸‰æ–¹å®ç°ã€‚<br>äº›ç®€å•çš„æŠŠæ—¥å¿—è¾“å‡ºåˆ°æ§åˆ¶å°çš„ä½¿ç”¨æ–¹å¼ã€‚<br>NuGetå®‰è£…åŒ…<br>æ—¥å¿—ç³»ç»Ÿæ ¸å¿ƒçš„å¼€å‘åŒ…</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Microsoft.Extensions.Logging</span><br></pre></td></tr></table></figure><p>æ§åˆ¶å°è¾“å‡ºæ—¥å¿—åŒ…</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Microsoft.Extensions.Logging.Console</span><br></pre></td></tr></table></figure><p>å£°æ˜ä¸€ä¸ªç±»</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Recording</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> ILogger&lt;Recording&gt;logger;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Recording</span>(<span class="params">ILogger&lt;Recording&gt; logger</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.logger = logger;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Record</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        logger.LogDebug(<span class="string">&quot;å¼€å§‹æ‰§è¡Œæ•°æ®åº“åŒæ­¥&quot;</span>);</span><br><span class="line">        logger.LogDebug(<span class="string">&quot;è¿æ¥æ•°æ®åº“æˆåŠŸ&quot;</span>);</span><br><span class="line">        logger.LogWarning(<span class="string">&quot;æ•°æ®åº“è¿æ¥è¶…æ—¶ï¼Œé‡è¯•ç¬¬ä¸€æ¬¡&quot;</span>);</span><br><span class="line">        <span class="comment">//Â·Â·Â·Â·Â·Â·</span></span><br><span class="line">        logger.LogWarning(<span class="string">&quot;æ•°æ®åº“è¿æ¥è¶…æ—¶ï¼Œé‡è¯•ç¬¬äºŒæ¬¡&quot;</span>);</span><br><span class="line">        logger.LogError(<span class="string">&quot;æ•°æ®åº“è¿æ¥è¶…æ—¶ï¼Œé‡è¯•å¤±è´¥&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            File.ReadAllText(<span class="string">&quot;E:/temp/3.txt&quot;</span>);</span><br><span class="line">            logger.LogDebug(<span class="string">&quot;è¯»å–æ–‡ä»¶æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span>(Exception ex)</span><br><span class="line">        &#123;</span><br><span class="line">            logger.LogError(ex, <span class="string">&quot;æ•°æ®åº“åŒæ­¥å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> LoggingDemo;</span><br><span class="line"><span class="keyword">using</span> Microsoft.Extensions.DependencyInjection;</span><br><span class="line"><span class="keyword">using</span> Microsoft.Extensions.Logging;</span><br><span class="line"><span class="keyword">using</span> Microsoft.Extensions.Logging.Console;</span><br><span class="line"><span class="keyword">using</span> NLog.Fluent;</span><br><span class="line"><span class="comment">//DI</span></span><br><span class="line">ServiceCollection services = <span class="keyword">new</span> ServiceCollection();</span><br><span class="line">services.AddLogging(logBuilder =&gt; &#123;</span><br><span class="line">    logBuilder.AddConsole();</span><br><span class="line">    <span class="comment">//æœ€ä½è¾“å‡ºæ—¥å¿—çº§åˆ«</span></span><br><span class="line">    logBuilder.SetMinimumLevel(LogLevel.Trace);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">services.AddScoped&lt;Recording&gt;();</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> (<span class="keyword">var</span> sp=services.BuildServiceProvider())</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> recording = sp.GetRequiredService&lt;Recording&gt;();</span><br><span class="line">    recording.Record();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ–‡æœ¬æ—¥å¿—æä¾›ç¨‹åºNLog"><a href="#æ–‡æœ¬æ—¥å¿—æä¾›ç¨‹åºNLog" class="headerlink" title="æ–‡æœ¬æ—¥å¿—æä¾›ç¨‹åºNLog"></a>æ–‡æœ¬æ—¥å¿—æä¾›ç¨‹åºNLog</h2><p>.NETæ²¡æœ‰å†…ç½®æ–‡æœ¬æ—¥å¿—æä¾›è€…ã€‚ç¬¬ä¸‰æ–¹Log4Netã€NLogã€Serilogç­‰ã€‚<br>NLog,NuGetå®‰è£…ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NLog.Extensions.Logging</span><br></pre></td></tr></table></figure><p>(using NLog.Extensions.Logging;)ã€‚é¡¹ç›®æ ¹ç›®å½•ä¸‹å»ºnlog.congig,æ³¨æ„æ–‡ä»¶å¤§å°å†™ï¼ˆè€ƒè™‘Linuxï¼‰ã€‚<br>ä¹Ÿå¯ä»¥æ˜¯å…¶ä»–æ–‡ä»¶åï¼Œä½†æ˜¯éœ€è¦å•ç‹¬é…ç½®ã€‚<br>å¢åŠ logBuilder.AddNLog()</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> LoggingDemo;</span><br><span class="line"><span class="keyword">using</span> Microsoft.Extensions.DependencyInjection;</span><br><span class="line"><span class="keyword">using</span> Microsoft.Extensions.Logging;</span><br><span class="line"><span class="keyword">using</span> Microsoft.Extensions.Logging.Console;</span><br><span class="line"><span class="keyword">using</span> NLog.Extensions.Logging;</span><br><span class="line"><span class="keyword">using</span> NLog.Fluent;</span><br><span class="line"><span class="keyword">using</span> Microsoft.AspNetCore.Hosting;</span><br><span class="line"><span class="keyword">using</span> Microsoft.Extensions.Hosting;</span><br><span class="line"><span class="keyword">using</span> NLog.Web;</span><br><span class="line"><span class="comment">//DI</span></span><br><span class="line">ServiceCollection services = <span class="keyword">new</span> ServiceCollection();</span><br><span class="line">services.AddLogging(logBuilder =&gt; &#123;</span><br><span class="line">    logBuilder.AddConsole();</span><br><span class="line">    logBuilder.AddEventLog();</span><br><span class="line">    logBuilder.AddNLog();</span><br><span class="line">    <span class="comment">//æœ€ä½è¾“å‡ºæ—¥å¿—çº§åˆ«</span></span><br><span class="line">    logBuilder.SetMinimumLevel(LogLevel.Trace);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">services.AddScoped&lt;Recording&gt;();</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> (<span class="keyword">var</span> sp=services.BuildServiceProvider())</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> recording = sp.GetRequiredService&lt;Recording&gt;();</span><br><span class="line">    recording.Record();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨é¡¹ç›®å†…æ–°å»ºé¡¹æ‰¾åˆ°æ–‡æœ¬æ–‡ä»¶å‘½åä¸ºnlog.config<br>å±æ€§è®¾ä¸ºè¾ƒæ–°å¤å€¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;</span><br><span class="line">&lt;nlog xmlns=&quot;http://www.nlog-project.org/schemas/NLog.xsd&quot;</span><br><span class="line">      xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">      autoReload=&quot;true&quot;</span><br><span class="line">      throwConfigExceptions=&quot;true&quot;</span><br><span class="line">      internalLogLevel=&quot;info&quot;</span><br><span class="line">      internalLogFile=&quot;E:\log\internal-nlog.txt&quot;&gt;</span><br><span class="line">&lt;!--autoReloadï¼šä¿®æ”¹åè‡ªåŠ¨åŠ è½½ï¼Œå¯èƒ½ä¼šæœ‰å»¶è¿Ÿ--&gt;</span><br><span class="line">&lt;!--throwConfigExceptionsï¼šNLogæ—¥å¿—ç³»ç»ŸæŠ›å‡ºå¼‚å¸¸--&gt;</span><br><span class="line">&lt;!--internalLogLevelï¼šå†…éƒ¨æ—¥å¿—çš„çº§åˆ«--&gt;</span><br><span class="line">&lt;!--internalLogFileï¼šå†…éƒ¨æ—¥å¿—ä¿å­˜è·¯å¾„ï¼Œæ—¥å¿—çš„å†…å®¹å¤§æ¦‚å°±æ˜¯NLogçš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œé…ç½®æ–‡ä»¶çš„åœ°å€ç­‰ç­‰--&gt;</span><br><span class="line">&lt;!--è¾“å‡ºæ—¥å¿—çš„é…ç½®ï¼Œç”¨äºrulesè¯»å–--&gt;</span><br><span class="line">&lt;targets&gt;</span><br><span class="line">&lt;!--write logs to file--&gt;</span><br><span class="line">&lt;!--å°†æ—¥å¿—å†™å…¥æ–‡ä»¶ä¸­,fileNameå¯ä»¥æŒ‡å®šæ—¥å¿—ç”Ÿæˆçš„è·¯å¾„--&gt;</span><br><span class="line">&lt;target xsi:type=&quot;File&quot; name=&quot;allfile&quot; fileName=&quot;D:\Log\nlog-all-$&#123;shortdate&#125;.log&quot;</span><br><span class="line"> layout=&quot;$&#123;longdate&#125;|$&#123;logger&#125;|$&#123;uppercase:$&#123;level&#125;&#125;|$&#123;message&#125; $&#123;exception&#125;&quot; /&gt;</span><br><span class="line">&lt;!--åŒæ ·æ˜¯å°†æ–‡ä»¶å†™å…¥æ—¥å¿—ä¸­ï¼Œå†™å…¥çš„å†…å®¹æœ‰æ‰€å·®åˆ«ï¼Œå·®åˆ«åœ¨layoutå±æ€§ä¸­ä½“ç°ã€‚å†™å…¥æ—¥å¿—çš„æ•°é‡æœ‰å·®åˆ«ï¼Œå·®åˆ«åœ¨è·¯ç”±é€»è¾‘ä¸­ä½“ç°--&gt;</span><br><span class="line">&lt;target xsi:type=&quot;File&quot; name=&quot;ownFile-web&quot; fileName=&quot;D:\Log\nlog-my-$&#123;shortdate&#125;.log&quot;</span><br><span class="line"> layout=&quot;$&#123;longdate&#125;|$&#123;logger&#125;|$&#123;uppercase:$&#123;level&#125;&#125;|$&#123;message&#125; $&#123;exception&#125;&quot; /&gt;</span><br><span class="line">&lt;target xsi:type=&quot;Null&quot; name=&quot;blackhole&quot; /&gt;</span><br><span class="line">&lt;/targets&gt;</span><br><span class="line">&lt;rules&gt;</span><br><span class="line">&lt;!--è·¯ç”±é¡ºåºä¼šå¯¹æ—¥å¿—æ‰“å°äº§ç”Ÿå½±å“ã€‚è·¯ç”±åŒ¹é…é€»è¾‘ä¸ºé¡ºåºåŒ¹é…ã€‚--&gt;</span><br><span class="line">&lt;!--All logs, including from Microsoft--&gt;</span><br><span class="line">&lt;logger name=&quot;*&quot; minlevel=&quot;Trace&quot; writeTo=&quot;allfile&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--Skip Microsoft logs and so log only own logs--&gt;</span><br><span class="line">&lt;!--ä»¥Microsoftæ‰“å¤´çš„æ—¥å¿—å°†è¿›å…¥æ­¤è·¯ç”±ï¼Œç”±äºæ­¤è·¯ç”±æ²¡æœ‰writeToå±æ€§ï¼Œæ‰€æœ‰ä¼šè¢«å¿½ç•¥--&gt;</span><br><span class="line">&lt;!--ä¸”æ­¤è·¯ç”±è®¾ç½®äº†finalï¼Œæ‰€ä»¥å½“æ­¤è·¯ç”±è¢«åŒ¹é…åˆ°æ—¶ã€‚ä¸ä¼šå†åŒ¹é…æ­¤è·¯ç”±ä¸‹é¢çš„è·¯ç”±ã€‚æœªåŒ¹é…åˆ°æ­¤è·¯ç”±æ—¶æ‰ä¼šç»§ç»­åŒ¹é…ä¸‹ä¸€ä¸ªè·¯ç”±--&gt;</span><br><span class="line">&lt;logger name=&quot;Microsoft.*&quot; minlevel=&quot;Trace&quot;  final=&quot;true&quot; /&gt;</span><br><span class="line">&lt;!--ä¸Šæ–¹å·²ç»è¿‡æ»¤äº†æ‰€æœ‰Microsoft.*çš„æ—¥å¿—ï¼Œæ‰€ä»¥æ­¤å¤„çš„æ—¥å¿—åªä¼šæ‰“å°é™¤Microsoft.*å¤–çš„æ—¥å¿—--&gt;</span><br><span class="line">&lt;logger name=&quot;*&quot; minlevel=&quot;Trace&quot; writeTo=&quot;ownFile-web&quot; /&gt;</span><br><span class="line">&lt;/rules&gt;</span><br><span class="line">&lt;/nlog&gt;</span><br></pre></td></tr></table></figure><p>åœ¨è®¾å®šçš„è·¯å¾„æ‰¾åˆ°æ—¥å¿—<br>â€œD:\Log\nlog-my-${shortdate}.logâ€<br>â€œD:\Log\nlog-all-${shortdate}.logâ€</p><h2 id="æ—¥å¿—åˆ†ç±»ã€è¿‡æ»¤"><a href="#æ—¥å¿—åˆ†ç±»ã€è¿‡æ»¤" class="headerlink" title="æ—¥å¿—åˆ†ç±»ã€è¿‡æ»¤"></a>æ—¥å¿—åˆ†ç±»ã€è¿‡æ»¤</h2><p>NLogå®˜æ–¹ç½‘å€ï¼š<a href="https://nlog-project.org/%E5%AF%B9%E4%BD%BF%E7%94%A8NLog%E6%9C%89%E8%AF%A6%E7%BB%86%E7%9A%84%E8%AF%B4%E6%98%8E">https://nlog-project.org/å¯¹ä½¿ç”¨NLogæœ‰è¯¦ç»†çš„è¯´æ˜</a></p><p>é…ç½®nlog.config</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;</span><br><span class="line">&lt;nlog xmlns=&quot;http://www.nlog-project.org/schemas/NLog.xsd&quot;</span><br><span class="line">      xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">      autoReload=&quot;true&quot;</span><br><span class="line">      throwConfigExceptions=&quot;true&quot;</span><br><span class="line">  internalLogFile=&quot;console-example-internal.log&quot;</span><br><span class="line">      internalLogLevel=&quot;off&quot;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;!-- enable asp.net core layout renderers --&gt;</span><br><span class="line">&lt;extensions&gt;</span><br><span class="line">&lt;add assembly=&quot;NLog.Web.AspNetCore&quot;/&gt;</span><br><span class="line">&lt;/extensions&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- the targets to write to --&gt;</span><br><span class="line">&lt;targets&gt;</span><br><span class="line">&lt;!-- File Target for all log messages with basic details --&gt;</span><br><span class="line">&lt;target xsi:type=&quot;File&quot; name=&quot;LoggingDemo&quot; fileName=&quot;logs/log-$&#123;shortdate&#125;.log&quot;</span><br><span class="line">layout=&quot;$&#123;longdate&#125;|$&#123;event-properties:item=EventId:whenEmpty=0&#125;|$&#123;level:uppercase=true&#125;|$&#123;logger&#125;|$&#123;message&#125; $&#123;exception:format=tostring&#125;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- File Target for own log messages with extra web details using some ASP.NET core renderers --&gt;</span><br><span class="line">&lt;target xsi:type=&quot;File&quot; name=&quot;SytemServices&quot; fileName=&quot;logs/sysFile-$&#123;shortdate&#125;.log&quot; archiveAboveSize=&quot;1000&quot; maxArchiveFiles=&quot;3&quot;</span><br><span class="line">layout=&quot;$&#123;longdate&#125;|$&#123;event-properties:item=EventId:whenEmpty=0&#125;|$&#123;level:uppercase=true&#125;|$&#123;logger&#125;|$&#123;message&#125; $&#123;exception:format=tostring&#125;|url: $&#123;aspnet-request-url&#125;|action: $&#123;aspnet-mvc-action&#125;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--Console Target for hosting lifetime messages to improve Docker / Visual Studio startup detection --&gt;</span><br><span class="line">&lt;target xsi:type=&quot;Console&quot; name=&quot;logconsole&quot; layout=&quot;$&#123;MicrosoftConsoleLayout&#125;&quot; /&gt;</span><br><span class="line">&lt;/targets&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- rules to map from logger name to target --&gt;</span><br><span class="line">&lt;rules&gt;</span><br><span class="line">&lt;!-- All logs, including from Microsoft --&gt;</span><br><span class="line">&lt;logger name=&quot;*&quot; minlevel=&quot;Warn&quot; maxlevel=&quot;Fatal&quot; writeTo=&quot;logconsole&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- Suppress output from Microsoft framework when non-critical --&gt;</span><br><span class="line">&lt;logger name=&quot;SytemServices.*&quot; minlevel=&quot;Trace&quot; writeTo=&quot;SytemServices&quot; final=&quot;true&quot; /&gt;</span><br><span class="line">&lt;!-- Keep output from Microsoft.Hosting.Lifetime to console for fast startup detection --&gt;</span><br><span class="line">&lt;logger name=&quot;*&quot; minLevel=&quot;Trace&quot; writeTo=&quot;LoggingDemo&quot; /&gt;</span><br><span class="line">&lt;/rules&gt;</span><br><span class="line">&lt;/nlog&gt;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºåæ¬¡</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">ServiceCollection services = <span class="keyword">new</span> ServiceCollection();</span><br><span class="line">services.AddLogging(logBuilder =&gt; &#123;</span><br><span class="line">    <span class="comment">//logBuilder.AddConsole();</span></span><br><span class="line">    <span class="comment">//logBuilder.AddEventLog();</span></span><br><span class="line">    logBuilder.AddNLog();</span><br><span class="line">    <span class="comment">//æœ€ä½è¾“å‡ºæ—¥å¿—çº§åˆ«</span></span><br><span class="line">    <span class="comment">//logBuilder.SetMinimumLevel(LogLevel.Trace);</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">services.AddScoped&lt;Recording&gt;();</span><br><span class="line">services.AddScoped&lt;Test1&gt;();</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> (<span class="keyword">var</span> sp=services.BuildServiceProvider())</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">var</span> recording = sp.GetRequiredService&lt;Recording&gt;();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> test1 = sp.GetRequiredService&lt;Test1&gt;();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        recording.Record();</span><br><span class="line">        test1.Record();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/%5Cimg%5CHello%5CNLOG.png"></p><h2 id="é›†ä¸­åŒ–æ—¥å¿—"><a href="#é›†ä¸­åŒ–æ—¥å¿—" class="headerlink" title="é›†ä¸­åŒ–æ—¥å¿—"></a>é›†ä¸­åŒ–æ—¥å¿—</h2><p>NLogä¹Ÿå¯ä»¥é…ç½®ç»“æ„åŒ–æ—¥å¿—ï¼Œä¸è¿‡é…ç½®éº»çƒ¦ï¼Œæ¨èç”¨Serilogã€‚</p><p>NuGetå®‰è£…ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">using Serilog.Formatting.Json;</span><br><span class="line">using Serilog;</span><br><span class="line">Serilog.AspNetCore</span><br></pre></td></tr></table></figure><p>é…ç½®</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Serilog.Log.Logger = <span class="keyword">new</span> LoggerConfiguration()</span><br><span class="line">.MinimumLevel.Debug()</span><br><span class="line">.Enrich.FromLogContext()</span><br><span class="line">.WriteTo.Console(<span class="keyword">new</span> JsonFormatter())</span><br><span class="line">.CreateLogger();</span><br><span class="line">logBuilder.AddSerilog();</span><br></pre></td></tr></table></figure><p>è¦è®°å½•çš„ç»“æ„åŒ–æ•°æ®é€šè¿‡å ä½ç¬¦æ¥è¾“å‡ºï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">logger.LogWarning(<span class="string">&quot;æ–°å¢ç”¨æˆ·&#123;@person&#125;&quot;</span>,<span class="keyword">new</span> &#123;Id=<span class="number">3</span>,Name=<span class="string">&quot;zack&quot;</span>&#125;);</span><br></pre></td></tr></table></figure><p>åŒæ ·å¯ä»¥è¾“å‡ºåˆ°æ–‡ä»¶ã€æ•°æ®åº“ã€MongoDBç­‰ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ASP.NET Core </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­¦ä¹ XML</title>
      <link href="/2025/03/23/asp.net%20core/xml/"/>
      <url>/2025/03/23/asp.net%20core/xml/</url>
      
        <content type="html"><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯XML"><a href="#ä»€ä¹ˆæ˜¯XML" class="headerlink" title="ä»€ä¹ˆæ˜¯XML"></a>ä»€ä¹ˆæ˜¯XML</h1><p>XML æŒ‡çš„æ˜¯ï¼Œå¯æ‰©å±•æ€§æ ‡è®°è¯­è¨€<br>XMLè¢«å‘æ˜çš„ç›®çš„æ˜¯ä¼ è¾“å’Œå­˜å‚¨æ•°æ®ï¼Œè€Œä¸æ˜¯å±•ç¤ºæ•°æ®;<br>XMLçš„æ ‡ç­¾å¿…é¡»è‡ªå®šä¹‰ï¼Œä½†æ˜¯åœ¨å†™æ ‡ç­¾åçš„æ—¶å€™ä¸€å®šè¦æœ‰å«ä¹‰; XMLæ˜¯W3Cæ¨ä¸¾çš„æ•°æ®ä¼ è¾“æ ¼å¼;</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">root</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">user</span>&gt;</span>123<span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">msg</span>&gt;</span>å“ˆå“ˆ<span class="tag">&lt;/<span class="name">msg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="XMLåŸºæœ¬è¯­æ³•è¯¦è§£"><a href="#XMLåŸºæœ¬è¯­æ³•è¯¦è§£" class="headerlink" title="XMLåŸºæœ¬è¯­æ³•è¯¦è§£"></a>XMLåŸºæœ¬è¯­æ³•è¯¦è§£</h1><p>XMLï¼ˆExtensible Markup Languageï¼‰æ˜¯åŸºäºæ ‡ç­¾çš„è¯­è¨€ï¼Œç”¨äºè¡¨ç¤ºç»“æ„åŒ–çš„ä¿¡æ¯ã€‚å®ƒä½¿ç”¨æ ‡ç­¾æ¥å®šä¹‰ã€ç»„ç»‡å’Œå¼•ç”¨æ•°æ®ï¼Œæ”¯æŒåµŒå¥—å…³ç³»ï¼Œä½¿æ–‡æ¡£ç»“æ„æ¸…æ™°æ˜äº†ã€‚</p><p>ä»¥ä¸‹æ˜¯XMLçš„åŸºæœ¬è¯­æ³•åŠå…¶ç»„æˆéƒ¨åˆ†ï¼š</p><ol><li>opening element<br>XMLæ–‡ä»¶ä»¥ä¸€ä¸ªç‰¹å®šçš„å¼€å§‹æ ‡ç­¾å¼€å¤´ï¼Œé€šå¸¸ä¸º&lt;root&gt;ï¼Œå…¶ä¸­â€rootâ€æ˜¯è‡ªå®šä¹‰çš„æ ‡ç­¾åç§°ã€‚æ ¹æ ‡ç­¾æ ‡è¯†æ•´ä¸ªæ–‡æ¡£çš„å¼€å§‹ï¼Œå¹¶ä¸”å¿…é¡»æ˜¯ä¸€ä¸ªæœ‰æ•ˆä¸”å”¯ä¸€çš„åå­—ã€‚</li></ol><p>ç¤ºä¾‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">root</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- å†…å®¹ --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>Tag names<br>XMLä¸­çš„æ¯ä¸ªå…ƒç´ ç”±ä¸€ä¸ªæ ‡ç­¾ç»„æˆï¼Œé€šå¸¸åŒ…å«åç§°å’Œå†…å®¹ä¸¤éƒ¨åˆ†ã€‚tag nameè¡¨ç¤ºå…ƒç´ çš„ç±»å‹æˆ–åç§°ã€‚</li></ol><p>å‘½åè§„åˆ™ï¼š</p><p>tag nameå¿…é¡»æ˜¯ASCIIå­—ç¬¦ã€‚<br>æœ€å¤šå¯ä»¥åŒ…å«30ä¸ªå­—ç¬¦ï¼ˆå­—ç¬¦ç¼–ç ä¸ºUTF-8ï¼‰ã€‚<br>å¯¹äºå‘½åç©ºé—´ä¸­çš„æ ‡ç­¾ï¼Œåº”ä½¿ç”¨ xmlns&#x3D;â€â€¦â€è¿›è¡Œå£°æ˜ã€‚<br>ç¤ºä¾‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">element1</span>&gt;</span>å†… å®¹<span class="tag">&lt;/<span class="name">element1</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="3"><li>æ ‡ç­¾åµŒå¥—<br>XMLæ”¯æŒåµŒå¥—å…³ç³»ï¼Œå…è®¸åœ¨ä¸€ä¸ªå…ƒç´ å†…éƒ¨åŒ…å«å…¶ä»–å…ƒç´ ã€‚è¿™ç§ç»“æ„é€šè¿‡åµŒå¥—çš„æ ‡ç­¾æ¥è¡¨ç¤ºã€‚</li></ol><p>ç¤ºä¾‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">child</span>&gt;</span>å­å†…å®¹<span class="tag">&lt;/<span class="name">child</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="4"><li>å‘½åç©ºé—´<br>ä¸ºé¿å…æ ‡ç­¾å†²çªï¼ˆå¤šä¸ªä¸åŒå…ƒç´ å…·æœ‰ç›¸åŒçš„åç§°ï¼‰ï¼ŒXMLå¼•å…¥äº†å‘½åç©ºé—´çš„æ¦‚å¿µã€‚ä½¿ç”¨ xmlns&#x3D;â€â€¦â€æŒ‡å®šä¸€ä¸ªå”¯ä¸€çš„æ ‡ç­¾é›†åˆï¼Œæ”¯æŒè·¨å‘½åç©ºé—´çš„å¼•ç”¨ã€‚</li></ol><p>ç¤ºä¾‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;http://example.com/ns#element1&gt;æ ¹å†…å®¹&lt;/http://example.com/ns#element1&gt;</span><br></pre></td></tr></table></figure><ol start="5"><li>è‡ªå®šä¹‰æ ‡ç­¾<br>XMLå…è®¸åˆ›å»ºè‡ªå®šä¹‰çš„æ–°æ ‡ç­¾åç§°ã€‚è¿™äº›æ ‡ç­¾å¿…é¡»åœ¨æ–‡ä»¶å¤–éƒ¨å£°æ˜ï¼Œå¹¶ä¸”é€šè¿‡ xmlns&#x3D;â€â€¦â€æŒ‡å®šã€‚</li></ol><p>ç¤ºä¾‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ns:root</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ns:child</span>&gt;</span>å­å†…å®¹<span class="tag">&lt;/<span class="name">ns:child</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ns:root</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="6"><li>æ³¨é‡Š<br>æ³¨é‡Šç”¨äºåœ¨æ–‡æ¡£ä¸­æ·»åŠ æ— å…³ç´§è¦çš„è§£é‡Šæ€§è¯´æ˜ï¼Œå¸¸è§äºç¤ºä¾‹æˆ–è¯¦ç»†è¯´æ˜ã€‚</li></ol><p>å•è¡Œæ³¨é‡Š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- è¿™æ˜¯ä¸€ä¸ªå•è¡Œæ³¨é‡Š --&gt;</span></span><br></pre></td></tr></table></figure><p>å¤šè¡Œæ³¨é‡Šï¼ˆä»…é™äºXMLlightï¼‰</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- è¿™æ˜¯ä¸€æ®µå¤šè¡Œæ³¨é‡Š --&gt;</span></span><br></pre></td></tr></table></figure><ol start="7"><li>è‡ªå®šä¹‰å±æ€§<br>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ name&#x3D;â€valueâ€çš„å½¢å¼æ¥é™„åŠ ä¿¡æ¯åˆ°æ ‡ç­¾ä¸Šã€‚</li></ol><p>ç¤ºä¾‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">element</span> <span class="attr">name</span>=<span class="string">&quot;value&quot;</span>&gt;</span>å†…å®¹<span class="tag">&lt;/<span class="name">element</span>&gt;</span></span><br></pre></td></tr></table></figure><p>XMLä¸HTMLçš„åŒºåˆ«<br>XMLæ˜¯æ ‡å‡†åŒ–çš„ç»“æ„åŒ–æ•°æ®æ ¼å¼ï¼Œå¸¸ç”¨äºAPIå¼€å‘å’Œæ•°æ®äº¤æ¢ã€‚<br>HTMLä¸»è¦ç”¨äºç½‘é¡µçš„æ˜¾ç¤ºå¸ƒå±€ï¼Œå¼ºè°ƒå†…å®¹å¯è§æ€§ã€‚<br>XMLåœ¨ç»“æ„ä¸Šæ›´çµæ´»ï¼Œå¯ä»¥åµŒå…¥å…¶ä»–æ•°æ®ç±»å‹ã€‚<br>æ€»ç»“ï¼šXMLé€šè¿‡æ ‡ç­¾å®šä¹‰å…ƒç´ ã€åµŒå¥—å…³ç³»å’Œç»“æ„ï¼Œæä¾›æ¸…æ™°çš„æ•°æ®ç»„ç»‡æ–¹å¼ã€‚å®ƒæ”¯æŒæ‰©å±•æ€§å’Œçµæ´»æ€§ï¼Œé€‚ç”¨äºå„ç§æ•°æ®å¤„ç†åœºæ™¯ã€‚</p><p>&lt;[CDATA]&gt;ç‰¹æ®Šå­—ç¬¦å®ä½“åŒ–</p><p>éå†XMLæ•°æ®</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">foreach($x-&gt;man as $v)&#123;</span><br><span class="line">    echo $v-&gt;name</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ·»åŠ èŠ‚ç‚¹</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//åˆ›å»ºèŠ‚ç‚¹</span><br><span class="line">$man=$x-&gt;addChild(&#x27;man&#x27;);</span><br><span class="line">//æ·»åŠ å†…å®¹</span><br><span class="line">$man=$x-&gt;addChild(&#x27;name&#x27;,&#x27;you&#x27;);</span><br><span class="line">$man=$x-&gt;addChild(&#x27;age&#x27;,&#x27;19&#x27;);</span><br><span class="line"></span><br><span class="line">varâ€”â€”dump($x)</span><br><span class="line">//å†™å…¥æ–‡ä»¶</span><br><span class="line">$x-&gt;asXML(.xml);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> XML </category>
          
      </categories>
      
      
        <tags>
            
            <tag> XML </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>.NET Coreé…ç½®ç³»ç»Ÿ</title>
      <link href="/2025/03/22/asp.net%20core/%E9%85%8D%E7%BD%AE%E7%8E%AF%E5%A2%83/"/>
      <url>/2025/03/22/asp.net%20core/%E9%85%8D%E7%BD%AE%E7%8E%AF%E5%A2%83/</url>
      
        <content type="html"><![CDATA[<h1 id="é…ç½®ç³»ç»Ÿ"><a href="#é…ç½®ç³»ç»Ÿ" class="headerlink" title="é…ç½®ç³»ç»Ÿ"></a>é…ç½®ç³»ç»Ÿ</h1><p>.NET Coreä¸­æä¾›äº†éå¸¸å¼ºå¤§çš„é…ç½®ç³»ç»Ÿä»¥ç®€åŒ–é…ç½®ç›¸å…³ä»£ç çš„ç¼–å†™æ–¹æ³•ã€‚</p><h2 id="é…ç½®ç³»ç»Ÿçš„åŸºæœ¬ä½¿ç”¨"><a href="#é…ç½®ç³»ç»Ÿçš„åŸºæœ¬ä½¿ç”¨" class="headerlink" title="é…ç½®ç³»ç»Ÿçš„åŸºæœ¬ä½¿ç”¨"></a>é…ç½®ç³»ç»Ÿçš„åŸºæœ¬ä½¿ç”¨</h2><p>.NET Coreä¸­çš„é…ç½®ç³»ç»Ÿæ”¯æŒéå¸¸ä¸°å¯Œçš„é…ç½®æºï¼ŒåŒ…æ‹¬æ–‡ä»¶ï¼ˆJSONã€XMLã€INIç­‰ï¼‰ã€æ³¨å†Œè¡¨ã€ç¯å¢ƒå˜é‡ã€å‘½ä»¤è¡Œã€Azure Key Vaultç­‰ï¼Œ<br>é…ç½®ç³»ç»Ÿè¿˜æ”¯æŒè‡ªå®šä¹‰é…ç½®æºã€‚<br>.NET Coreä¸­è¯»å–é…ç½®æœ‰å¾ˆå¤šç§æ–¹å¼ï¼Œæ—¢å¯ä»¥é€šè¿‡IConfigurationRootè¯»å–é…ç½®ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç»‘å®šçš„æ–¹å¼æŠŠé…ç½®è¯»å–ä¸ºä¸€ä¸ªC#å¯¹è±¡ã€‚</p><p>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ·»åŠ ä¸€ä¸ªJSONæ–‡ä»¶ï¼Œå‘½åä¸ºï¼šconfig.json</p><p>å› ä¸ºç¨‹åºåœ¨è¿è¡Œçš„æ—¶å€™é»˜è®¤åŠ è½½EXEæ–‡ä»¶åŒæ–‡ä»¶å¤¹ä¸‹çš„é…ç½®æ–‡ä»¶ï¼Œè€Œä¸æ˜¯é¡¹ç›®ä¸­çš„config.jsonæ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æŠŠconfig.jsonæ–‡ä»¶è®¾ç½®ä¸ºç”Ÿæˆé¡¹ç›®çš„æ—¶å€™è‡ªåŠ¨è¢«å¤åˆ¶åˆ°ç”Ÿæˆç›®å½•ã€‚</p><p>.NET Coreä¸­é…ç½®ç³»ç»Ÿçš„åŸºç¡€å¼€å‘åŒ…æ˜¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Microsoft.Extensions.Configuration,</span><br></pre></td></tr></table></figure><p>è€Œè¯»å–JSONæ–‡ä»¶çš„å¼€å‘åŒ…æ˜¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Microsoft.Extensions.Configuration.Json</span><br></pre></td></tr></table></figure><p>,ç”¨NuGetå®‰è£…è¿™ä¸¤ä¸ªåŒ…ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;YOUXIANYU&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;age&quot;</span><span class="punctuation">:</span> <span class="string">&quot;19&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Almango&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;proxy&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;address&quot;</span><span class="punctuation">:</span> <span class="string">&quot;255.255.255.255&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;port&quot;</span><span class="punctuation">:</span> <span class="string">&quot;80&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>æ”¶åˆ°è¯»å–ä»£ç </p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Microsoft.Extensions.Configuration;</span><br><span class="line"><span class="keyword">using</span> Microsoft.Extensions.Configuration.Json;</span><br><span class="line"></span><br><span class="line">ConfigurationBuilder configurationBuilder=<span class="keyword">new</span> ConfigurationBuilder();</span><br><span class="line">configurationBuilder.AddJsonFile(<span class="string">&quot;config.json&quot;</span>,optional:<span class="literal">false</span>,reloadOnChange:<span class="literal">true</span>);</span><br><span class="line">IConfigurationRoot configRoot= configurationBuilder.Build();</span><br><span class="line"><span class="built_in">string</span> name=configRoot[<span class="string">&quot;name&quot;</span>];</span><br><span class="line">Console.WriteLine(<span class="string">$&quot;name=<span class="subst">&#123;name&#125;</span>&quot;</span>);</span><br><span class="line"><span class="built_in">string</span> <span class="keyword">add</span>=configRoot.GetSection(<span class="string">&quot;proxy:address&quot;</span>).Value;</span><br><span class="line">Console.WriteLine(<span class="string">$&quot;address=<span class="subst">&#123;<span class="keyword">add</span>&#125;</span>&quot;</span>);</span><br><span class="line">Console.ReadKey();</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç»‘å®šè¯»å–é…ç½®ï¼ˆ*ï¼‰<br>å¯ä»¥ç»‘å®šä¸€ä¸ªç±»ï¼Œè‡ªåŠ¨å®Œæˆé…ç½®çš„è¯»å–</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ConfigurationBuilder configurationBuilder=<span class="keyword">new</span> ConfigurationBuilder();</span><br><span class="line">configurationBuilder.AddJsonFile(<span class="string">&quot;config.json&quot;</span>,optional:<span class="literal">false</span>,reloadOnChange:<span class="literal">true</span>);</span><br><span class="line">IConfigurationRoot configRoot= configurationBuilder.Build();</span><br><span class="line"><span class="comment">/*string name=configRoot[&quot;name&quot;];</span></span><br><span class="line"><span class="comment">Console.WriteLine($&quot;name=&#123;name&#125;&quot;);</span></span><br><span class="line"><span class="comment">string add=configRoot.GetSection(&quot;proxy:address&quot;).Value;</span></span><br><span class="line"><span class="comment">Console.WriteLine($&quot;address=&#123;add&#125;&quot;);*/</span></span><br><span class="line"><span class="comment">/*Proxy proxy= configRoot.GetSection(&quot;proxy&quot;).Get&lt;Proxy&gt;();</span></span><br><span class="line"><span class="comment">Console.WriteLine($&quot;&#123;proxy.Address&#125;,&#123;proxy.Port&#125;&quot;);*/</span></span><br><span class="line">Config config = configRoot.Get&lt;Config&gt;();</span><br><span class="line">Console.WriteLine(config.Name);</span><br><span class="line">Console.WriteLine(config.Proxy.Port);</span><br><span class="line">Console.ReadKey();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Config</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Add &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Address &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> Proxy Proxy &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">Proxy</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Address &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Port &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ConfigurationBuilderæ·»åŠ äº†ä¸€ä¸ªå¾…è§£æçš„é…ç½®æ–‡ä»¶ã€‚optionalå‚æ•°è¡¨ç¤ºè¿™ä¸ªæ–‡ä»¶æ˜¯å¦å¯é€‰ï¼Œå¦‚æœå®ƒçš„å€¼ä¸ºtrun,åˆ™å½“é…ç½®æ–‡ä»¶ä¸å­˜åœ¨çš„æ—¶å€™ï¼Œç¨‹åºä¸ä¼šæŠ¥é”™ï¼›å¦‚æœå®ƒçš„å€¼ä¸ºfalse,å½“é…ç½®æ–‡ä»¶ä¸å­˜åœ¨çš„æ—¶å€™ï¼Œç¨‹åºä¼šæŠ¥é”™ã€‚</p><p>IConfigurationRootå¯¹è±¡ï¼Œæˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡ä»–è¯»å–é…ç½®é¡¹ï¼Œå¦‚æœé…ç½®åˆ†çº§ï¼Œä¹Ÿå¯ä»¥ç”¨â€œproxyï¼šaddressâ€è¿™ç§å†’å·åˆ†éš”çš„æ–¹å¼è¯»å–é…ç½®é¡¹ã€‚</p><p>IConfigurationRootä¸­æœ‰ä¸€ä¸ªGetConnectionString(string name)æ–¹æ³•ç”¨äºè·å–è¿æ¥å­—ç¬¦ä¸²ï¼Œä»–è¯»å–â€œConnectionStringsâ€èŠ‚ç‚¹ä¸‹çš„åä¸ºnameçš„å€¼ä½œä¸ºè¿æ¥å­—ç¬¦ä¸²ã€‚â€œConnectionStringsâ€åªæ˜¯ä¸€ä¸ªå»ºè®®ï¼Œä¸æ˜¯.NET Coreè¦æ±‚å¿…é¡»ä½¿ç”¨è¿™ä¸ªèŠ‚ç‚¹ä¿å­˜æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²ã€‚</p><h2 id="ä½¿ç”¨é€‰é¡¹æ–¹å¼è¯»å–é…ç½®"><a href="#ä½¿ç”¨é€‰é¡¹æ–¹å¼è¯»å–é…ç½®" class="headerlink" title="ä½¿ç”¨é€‰é¡¹æ–¹å¼è¯»å–é…ç½®"></a>ä½¿ç”¨é€‰é¡¹æ–¹å¼è¯»å–é…ç½®</h2><p>ä½¿ç”¨é€‰é¡¹æ–¹å¼è¯»å–é…ç½®æ˜¯.NET Coreä¸­æ¨èçš„æ–¹å¼ï¼Œå› ä¸ºä»–ä¸åŠå’Œä¾èµ–æ³¨å…¥æœºåˆ¶ç»“åˆçš„æ›´å¥½ï¼Œè€Œä¸”å®ƒå¯ä»¥å®ç°é…ç½®ä¿®æ”¹åè‡ªåŠ¨æ›´æ–°ï¼Œç”¨èµ·æ¥æ›´æ–¹ä¾¿ã€‚</p><blockquote><p>ä½¿ç”¨é€‰é¡¹æ–¹å¼è¯»å–ï¼Œå’ŒDIç»“åˆæ›´å¥½ï¼Œä¸”æ›´å¥½åˆ©ç”¨â€œreloadonchangeâ€æœºåˆ¶ã€‚<br>è¯»å–é…ç½®çš„æ—¶å€™ï¼ŒDIè¦å£°æ˜IOptions&lt;T&gt;ã€IOptionsMonitor&lt;T&gt;ã€IOptionsSnapshot&lt;T&gt;ç­‰ç±»å‹ã€‚IOptions&lt;T&gt;ä¸ä¼šè¯»å–åˆ°æ–°çš„å€¼ï¼›å’ŒIOptionsMonitorç›¸æ¯”ï¼ŒIOptionsSnapshotä¼šåœ¨åŒä¸€ä¸ªèŒƒå›´å†…ï¼ˆæ¯”å¦‚ASP.NET Coreä¸€ä¸ªè¯·æ±‚ä¸­ï¼‰ä¿æŒä¸€è‡´ã€‚å»ºè®®ç”¨IOptionsSnapshotã€‚</p></blockquote><p>ä½¿ç”¨é€‰é¡¹æ–¹å¼è¯»å–é…ç½®éœ€è¦é€šè¿‡NuGetä¸ºé¡¹ç›®å®‰è£…</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Microsoft.Extensions.Options</span><br></pre></td></tr></table></figure><p>ç”±äºè¿™ç§æ–¹å¼æ˜¯å¯¹ç»‘å®šæ–¹å¼çš„å°è£…ï¼Œå› æ­¤æˆ‘ä»¬ä»»ç„¶éœ€è¦åŒæ—¶å®‰è£…åŒ…</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Microsoft.Extensions.Configuration.Binder</span><br></pre></td></tr></table></figure><p>åœ¨è¯»å–é…ç½®çš„åœ°æ–¹ï¼Œç”¨IOptionsSnapshot&lt;T&gt;æ³¨å…¥ã€‚ä¸è¦åœ¨æ„é€ å‡½æ•°é‡Œç›´æ¥è¯»å–IOptionsSnapshot.Value,è€Œæ˜¯åˆ°ç”¨åˆ°çš„åœ°æ–¹åœ¨è¯»å–ï¼Œå¦åˆ™æ— æ³•æ›´æ–°å˜åŒ–ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;Logging&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span> <span class="attr">&quot;LogLevel&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span> <span class="attr">&quot;Default&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Warning&quot;</span> <span class="punctuation">&#125;</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;DB&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;DbType&quot;</span><span class="punctuation">:</span> <span class="string">&quot;SQLServre&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ConnectionString&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Data Source=.;Initial Catalog=DemoDB; Integrated Security=Ture&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;Smtp&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;Server&quot;</span><span class="punctuation">:</span> <span class="string">&quot;youxianyu.cn&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;UserName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;zeng&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;Password&quot;</span><span class="punctuation">:</span> <span class="string">&quot;123456&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="attr">&quot;AllowedHosts&quot;</span><span class="punctuation">:</span> <span class="string">&quot;*&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>è¯»å–â€œDBâ€å’Œâ€œSmtpâ€è¿™ä¸¤éƒ¨åˆ†<br>å»ºç«‹å¯¹åº”é…ç½®é¡¹çš„ä¸¤ä¸ªæ¨¡å‹ç±»</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">DbSettings</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> DbType &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> ConnectionString &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">SmtpSettings</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Server &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Username &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Password &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±äºä½¿ç”¨é€‰é¡¹æ–¹å¼è¯»å–é…ç½®çš„æ—¶å€™ï¼Œéœ€è¦å’Œä¾èµ–æ³¨å…¥ä¸€èµ·ä½¿ç”¨ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªç±»ç”¨äºè·å–æ³¨å…¥çš„é€‰é¡¹å€¼ã€‚<br>å£°æ˜æ¥æ”¶é€‰é¡¹æ³¨å…¥çš„å¯¹è±¡çš„ç±»å‹ä¸èƒ½ç›´æ¥ä½¿ç”¨DbSettingsã€SmtpSettingsï¼Œè€Œè¦ä½¿ç”¨IOptions&lt;T&gt;ã€IOptionsMonitor&lt;T&gt;ã€IOptionsSnapshot&lt;T&gt;ç­‰æ³›å‹æ¥å£ç±»å‹ï¼Œå¯ä»¥å¸®æˆ‘ä»¬å¤„ç†å®¹å™¨ç”Ÿå‘½å‘¨æœŸã€é…ç½®åˆ·æ–°ç­‰ã€‚<br>IOptions&lt;T&gt;åœ¨é…ç½®æ”¹å˜åï¼Œæˆ‘ä»¬ä¸èƒ½è¯»åˆ°æ–°çš„å€¼ï¼Œå¿…é¡»é‡å¯ç¨‹åºæ‰å¯ä»¥è¯»åˆ°æ–°çš„å€¼ï¼›<br>IOptionsMonitor&lt;T&gt;åœ¨é…ç½®æ”¹å˜åï¼Œæˆ‘ä»¬èƒ½è¯»åˆ°æ–°çš„å€¼ï¼›IOptionsSnapshot&lt;T&gt;ä¹Ÿæ˜¯åœ¨é…ç½®æ”¹å˜åï¼Œæˆ‘ä»¬èƒ½è¯»åˆ°æ–°çš„å€¼ï¼Œå’ŒIOptionsMonitor&lt;T&gt;ä¸åŒçš„æ˜¯ï¼Œåœ¨åŒä¸€ä¸ªèŒƒå›´å†…IOptionsMonitor&lt;T&gt;ä¼šä¿æŒä¸€è‡´æ€§ã€‚</p><p>ç”±äºIOptions&lt;T&gt;ä¸ç›‘å¬é…ç½®çš„æ”¹å˜ï¼Œå› æ­¤å®ƒçš„èµ„æºå ç”¨ä¼šæ¯”è¾ƒå°‘ï¼Œé€‚ç”¨ä¸å¯¹æœåŠ¡å¯åŠ¨åå°±ä¸ä¼šæ”¹å˜çš„å€¼è¿›è¡Œè¯»å–ã€‚ç”±äºIOptionsMonitor&lt;T&gt;å¯èƒ½ä¼šå¯¼è‡´ç”¨ä¸€ä¸ªè¯·æ±‚è¿‡ç¨‹ä¸­ï¼Œé…ç½®çš„æ”¹å˜ä½¿è¯»å–åŒä¸€ä¸ªé€‰é¡¹çš„å€¼ä¸ä¸€è‡´ï¼Œä»è€Œå¯¼è‡´ç¨‹åºå‡ºé”™ï¼Œå› æ­¤å¦‚æœæˆ‘ä»¬éœ€è¦åœ¨ç¨‹åºè¿è¡Œä¸­è¯»å–ä¿®æ”¹åçš„å€¼ï¼Œå»ºè®®ä½¿ç”¨IOptionsSnapshot&lt;T&gt;ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Demo</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> IOptionsSnapshot&lt;DbSettings&gt; optDbSettings;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> IOptionsSnapshot&lt;SmtpSettings&gt; optSmtpSettings;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Demo</span>(<span class="params">IOptionsSnapshot&lt;DbSettings&gt; optDbSettings, IOptionsSnapshot&lt;SmtpSettings&gt; optSmtpSettings</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.optDbSettings = optDbSettings;</span><br><span class="line">        <span class="keyword">this</span>.optSmtpSettings = optSmtpSettings;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Test</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> db=optDbSettings.Value;</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;æ•°æ®åº“ï¼š<span class="subst">&#123;db.DbType&#125;</span>,<span class="subst">&#123;db.ConnectionString&#125;</span>&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> smtp = optSmtpSettings.Value;</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;SMTPï¼š<span class="subst">&#123;smtp.Server&#125;</span>,<span class="subst">&#123;smtp.Username&#125;</span>,<span class="subst">&#123;smtp.Password&#125;</span>&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œï¼Œé€šè¿‡æ„é€ æ–¹æ³•æ³¨å…¥IOptionsSnapshot<DbSettings>ã€IOptionsSnapshot<SmtpSettings>ä¸¤ä¸ªæœåŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡IOptionsSnapshot&lt;T&gt;çš„Valueå±æ€§è·å–DbSettingsã€SmtpSettingsç­‰å…·ä½“é…ç½®æ¨¡å‹å¯¹è±¡çš„å€¼ã€‚</p><p>ç¼–å†™æ³¨å…¥æœåŠ¡åˆ°å®¹å™¨çš„ä»£ç </p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Microsoft.Extensions.Configuration;</span><br><span class="line"><span class="keyword">using</span> Microsoft.Extensions.DependencyInjection;</span><br><span class="line"><span class="keyword">using</span> Microsoft.Extensions.Options;</span><br><span class="line"><span class="keyword">using</span> Microsoft.Extensions.Configuration.Json;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> é€‰é¡¹æ–¹å¼è¯»å–é…ç½®_ID;</span><br><span class="line"></span><br><span class="line">ConfigurationBuilder configBuilder= <span class="keyword">new</span> ConfigurationBuilder();</span><br><span class="line">configBuilder.AddJsonFile(<span class="string">&quot;config.json&quot;</span>, optional: <span class="literal">false</span>, reloadOnChange: <span class="literal">true</span>);</span><br><span class="line">IConfigurationRoot config = configBuilder.Build();</span><br><span class="line">ServiceCollection services = <span class="keyword">new</span> ServiceCollection();</span><br><span class="line">services.AddOptions().Configure&lt;DbSettings&gt;(e=&gt;config.GetSection(<span class="string">&quot;DB&quot;</span>).Bind(e))</span><br><span class="line">    .Configure&lt;SmtpSettings&gt;(e=&gt; config.GetSection(<span class="string">&quot;SMTP&quot;</span>).Bind(e));</span><br><span class="line">services.AddSingleton&lt;Demo&gt;();</span><br><span class="line"><span class="keyword">using</span> (<span class="keyword">var</span> sp = services.BuildServiceProvider())</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">using</span> (<span class="keyword">var</span> scope = sp.CreateScope())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> spScope = scope.ServiceProvider;</span><br><span class="line">            <span class="keyword">var</span> demo = spScope.GetRequiredService&lt;Demo&gt;();</span><br><span class="line">            demo.Test();</span><br><span class="line">        &#125;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;æŒ‰ä»»æ„é”®ç»§ç»­...&quot;</span>);</span><br><span class="line">        Console.ReadKey();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ç¬¬2è¡Œä»£ç ä¸­ï¼ŒæŠŠæ–¹æ³•çš„reloadOnChangeå‚æ•°è®¾å®šä¸ºtrue,ä»¥å¯åŠ¨â€œä¿®æ”¹åé‡æ–°åŠ è½½é…ç½®â€çš„åŠŸèƒ½ï¼›åœ¨ç¬¬5è¡Œä»£ç ä¸­ï¼Œé€šè¿‡AddOptionsæ–¹æ³•æ³¨å†Œä¸é€‰é¡¹ç›¸å…³çš„æœåŠ¡ï¼Œç„¶åä½¿ç”¨ç¬¬å…­è¡Œä»£ç æŠŠDBèŠ‚ç‚¹çš„å†…å®¹ç»‘å®šåˆ°DbSettingsç±»å‹çš„æ¨¡å‹å¯¹è±¡ä¸Šã€‚<br>ç”±äºIOptionsSnapshot&lt;T&gt;çš„ç”Ÿå‘½å‘¨æœŸä¸ºâ€œèŒƒå›´â€ï¼Œå› æ­¤Demoè¿™ä¸ªç”¨ä¸è¯»å–é…ç½®çš„ç±»çš„ç”Ÿå‘½å‘¨æœŸä¸èƒ½æ˜¯å•ä¾‹ï¼Œæˆ‘ä»¬åœ¨ç¬¬8è¡Œä»£ç ä¸­æŠŠDemoæ³¨å†Œä¸ºç¬æ€æœåŠ¡ã€‚</p><h1 id="å…¶ä»–é…ç½®æä¾›è€…"><a href="#å…¶ä»–é…ç½®æä¾›è€…" class="headerlink" title="å…¶ä»–é…ç½®æä¾›è€…"></a>å…¶ä»–é…ç½®æä¾›è€…</h1><h2 id="å‘½ä»¤è¡Œè¯»å–é…ç½®"><a href="#å‘½ä»¤è¡Œè¯»å–é…ç½®" class="headerlink" title="å‘½ä»¤è¡Œè¯»å–é…ç½®"></a>å‘½ä»¤è¡Œè¯»å–é…ç½®</h2><p>é…ç½®æ¡†æ¶è¿˜æ”¯æŒä»å‘½ä»¤è¡Œå‚æ•°ã€ç¯å¢ƒå˜é‡ç­‰åœ°æ–¹è¯»å–ã€‚<br>NuGetå®‰è£…ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Microsoft.Extensions.Configuration.CommandLine</span><br></pre></td></tr></table></figure><p>configBuilder.AddCommandLine(args)<br>å‚æ•°æ”¯æŒå¤šç§æ ¼å¼ï¼Œæ¯”å¦‚ï¼šserver&#x3D;127ã€â€“server&#x3D;127.0.0.1ã€â€“server 127.0.0ã€ï¼ˆæ³¨æ„åœ¨é”®å€¼ä¹‹é—´åŠ ç©ºæ ¼ï¼‰ã€&#x2F;server&#x3D;127.0.0.1ã€&#x2F;server 127.0.0.1ï¼ˆä¸»è¦åœ¨é”®å€¼ä¹‹é—´åŠ ç©ºæ ¼ï¼‰ã€‚æ ¼å¼ä¸èƒ½æ··ç”¨ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Microsoft.Extensions.Configuration;</span><br><span class="line"><span class="keyword">using</span> Microsoft.Extensions.DependencyInjection;</span><br><span class="line"><span class="keyword">using</span> Microsoft.Extensions.Options;</span><br><span class="line"><span class="keyword">using</span> Microsoft.Extensions.Configuration.Json;</span><br><span class="line"><span class="keyword">using</span> Microsoft.Extensions.Configuration.CommandLine;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> é€‰é¡¹æ–¹å¼è¯»å–é…ç½®_ID;</span><br><span class="line">ServiceCollection services = <span class="keyword">new</span> ServiceCollection();</span><br><span class="line">services.AddSingleton&lt;Demo&gt;();</span><br><span class="line">ConfigurationBuilder configBuilder= <span class="keyword">new</span> ConfigurationBuilder();</span><br><span class="line"></span><br><span class="line"><span class="comment">//configBuilder.AddJsonFile(&quot;config.json&quot;, optional: false, reloadOnChange: true);</span></span><br><span class="line">configBuilder.AddCommandLine(args);</span><br><span class="line">IConfigurationRoot config = configBuilder.Build();</span><br><span class="line">services.AddOptions().Configure&lt;DbSettings&gt;(e=&gt;config.GetSection(<span class="string">&quot;DB&quot;</span>).Bind(e))</span><br><span class="line">    .Configure&lt;SmtpSettings&gt;(e=&gt; config.GetSection(<span class="string">&quot;SMTP&quot;</span>).Bind(e));</span><br><span class="line">services.AddOptions().Configure&lt;nameSettings&gt;(e =&gt;config.Bind(e));</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> (<span class="keyword">var</span> sp = services.BuildServiceProvider())</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">using</span> (<span class="keyword">var</span> scope = sp.CreateScope())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> spScope = scope.ServiceProvider;</span><br><span class="line">            <span class="keyword">var</span> demo = spScope.GetRequiredService&lt;Demo&gt;();</span><br><span class="line">            demo.Test();</span><br><span class="line">        &#125;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;æŒ‰ä»»æ„é”®ç»§ç»­...&quot;</span>);</span><br><span class="line">        Console.ReadKey();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åœ¨é¡¹ç›®çš„å±æ€§çš„<b>è°ƒè¯•</b>ä¸­è®¾ç½®å‘½ä»¤è¡Œå‚æ•°ï¼Œè¿™æ ·Visual Studioä¸­è°ƒè¯•ã€è¿è¡Œç¨‹åºçš„æ—¶å€™ï¼ŒVisual Studioä¼šè‡ªåŠ¨æŠŠè¿™é‡Œè®¾å®šçš„å‚æ•°ä»¥å‘½ä»¤è¡Œå‚æ•°çš„å½¢å¼ä¼ é€’ç»™ç¨‹åºã€‚</p><h2 id="ä»ç¯å¢ƒå˜é‡è¯»å–é…ç½®"><a href="#ä»ç¯å¢ƒå˜é‡è¯»å–é…ç½®" class="headerlink" title="ä»ç¯å¢ƒå˜é‡è¯»å–é…ç½®"></a>ä»ç¯å¢ƒå˜é‡è¯»å–é…ç½®</h2><p>.NET Coreä¸­ä»ç¯å¢ƒå˜é‡è¯»å–é…ç½®éœ€è¦å®‰è£…ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Microsoft.Extensions.Configuration.EnvironmentVariables</span><br></pre></td></tr></table></figure><p>ç„¶åè°ƒç”¨AddEnvironmentVariablesæ–¹æ³•è¿›è¡Œæ³¨å†Œå³å¯ã€‚AddEnvironmentVariablesæ–¹æ³•å­˜åœ¨æ— å‚æ•°å’Œæœ‰prefixå‚æ•°ä¸¤ä¸ªé‡è½½ç‰ˆæœ¬ï¼Œæ— å‚æ•°ç‰ˆæœ¬ä¼šå°†æ‰€æœ‰ç¯å¢ƒå˜é‡éƒ½åŠ è½½è¿›æ¥ï¼Œå› æ­¤ä½¿ç”¨prefixå‚æ•°çš„AddEnvironmentVartablesé‡è½½æ–¹æ³•è¿›è¡Œæ³¨å†Œã€‚<br>prefixæŒ‡çš„æ˜¯ç¯å¢ƒå˜é‡åå­—çš„å‰ç¼€ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ConfigurationBuilder configBuilder= <span class="keyword">new</span> ConfigurationBuilder();</span><br><span class="line">configBuilder.AddEnvironmentVariables(<span class="string">&quot;TEST_&quot;</span>);</span><br><span class="line">IConfigurationRoot configRoot=configBuilder.Build();</span><br><span class="line"><span class="built_in">string</span> name =configRoot[<span class="string">&quot;Name&quot;</span>];</span><br><span class="line">Console.WriteLine(name);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ASP.NET Core </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LINQå­¦ä¹ </title>
      <link href="/2025/03/19/asp.net%20core/LINQ/"/>
      <url>/2025/03/19/asp.net%20core/LINQ/</url>
      
        <content type="html"><![CDATA[<h1 id="LINQ"><a href="#LINQ" class="headerlink" title="LINQ"></a>LINQ</h1><p>LINQæ˜¯.NET Coreä¸­æä¾›çš„ç®€åŒ–æ•°æ®æŸ¥è¯¢çš„æŠ€æœ¯ã€‚ä½¿ç”¨LINQæŠ€æœ¯ï¼Œå¯ä»¥ç”¨å‡ è¡Œä»£ç å°±å®ç°å¤æ‚çš„æ•°æ®æŸ¥è¯¢ã€‚LINQä¸ä»…å¯ä»¥å¯¹æ™®é€šçš„.NETé›†åˆè¿›è¡ŒæŸ¥è¯¢ï¼Œè€Œä¸”åœ¨Entity Frameword Coreä¸­åº”ç”¨å¹¿æ³›ï¼Œå› æ­¤å¿…é¡»ç†Ÿç»ƒæŒæ¡LINQã€‚</p><p>è¦æƒ³ç†Ÿæ‚‰æŒæ¡LINQå°±çš„ç†Ÿæ‚‰æŒæ¡å§”æ‰˜â€”â€”&gt;Lambdaâ€”â€”&gt;LINQ</p><p>å§”æ‰˜çš„ç”¨æ³•<br>å§”æ‰˜ç±»å‹è§„å®šäº†æ–¹æ³•çš„è¿”å›å€¼å’Œå‚æ•°çš„ç±»å‹</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">MyDelegate d1 = SayEnglish;</span><br><span class="line"><span class="built_in">string</span> s1 = d1(<span class="number">3</span>);</span><br><span class="line">Console.WriteLine(s1); <span class="comment">// Hello 3</span></span><br><span class="line">d1 = SayChinese;</span><br><span class="line"><span class="built_in">string</span> s2 = d1(<span class="number">10</span>);</span><br><span class="line">Console.WriteLine(s2); <span class="comment">// ä½ å¥½ 10</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="built_in">string</span> <span class="title">SayEnglish</span>(<span class="params"><span class="built_in">int</span> age</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">$&quot;Hello <span class="subst">&#123;age&#125;</span>&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="built_in">string</span> <span class="title">SayChinese</span>(<span class="params"><span class="built_in">int</span> age</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">$&quot;ä½ å¥½ <span class="subst">&#123;age&#125;</span>&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="built_in">delegate</span> <span class="built_in">string</span> <span class="title">MyDelegate</span>(<span class="params"><span class="built_in">int</span> n</span>)</span>;</span><br></pre></td></tr></table></figure><p>å§”æ‰˜ç±»å‹MyDelegateçš„å˜é‡d1å¯ä»¥æŒ‡å‘ä¸MyDelegateç±»å‹ç›¸å®¹çš„æ–¹æ³•ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥åƒè°ƒç”¨æ–¹æ³•ä¸€æ ·è°ƒç”¨å§”æ‰˜ç±»å‹çš„å˜é‡ã€‚è°ƒç”¨å§”æ‰˜å˜é‡çš„æ—¶å€™æ‰§è¡Œçš„å°±æ˜¯å˜é‡æŒ‡å‘çš„æ–¹æ³•ã€‚</p><p>åœ¨.NETä¸­å®šä¹‰äº†æœ€å¤šå¯è¾¾16ä¸ªå‚æ•°çš„æ³›å‹ç±»å‹å§”æ‰˜Action(æ— è¿”å›å€¼)å’ŒFnc(æœ‰è¿”å›å€¼)ï¼Œå› æ­¤ä¸€èˆ¬æˆ‘ä»¬ä¸éœ€è¦è‡ªå®šä¹‰å§”æ‰˜ç±»å‹ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨Actionæˆ–è€…Funcè¿™ä¸¤ä¸ªå§”æ‰˜ç±»å‹ã€‚<br>å§”æ‰˜å˜é‡ä¸ä»…å¯ä»¥æŒ‡å‘æ™®é€šæ–¹æ³•ï¼Œä¹Ÿå¯ä»¥æŒ‡å‘åŒ¿åæ–¹æ³•</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Func&lt;<span class="built_in">int</span>,<span class="built_in">int</span>,<span class="built_in">string</span>&gt; f1= <span class="built_in">delegate</span>(<span class="built_in">int</span> il, <span class="built_in">int</span> i2)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">$&quot;<span class="subst">&#123;il&#125;</span>+<span class="subst">&#123;i2&#125;</span>=<span class="subst">&#123;il + i2&#125;</span>&quot;</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">string</span> s=f1(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">Console.WriteLine(s);</span><br></pre></td></tr></table></figure><p>å®šä¹‰åŒ¿åæ–¹æ³•ä¹Ÿå¯ä»¥é‡‡ç”¨Lambdaè¡¨è¾¾å¼çš„è¯­æ³•ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Func&lt;<span class="built_in">int</span>,<span class="built_in">int</span>,<span class="built_in">string</span>&gt; f1= (il, i2) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">$&quot;<span class="subst">&#123;il&#125;</span>+<span class="subst">&#123;i2&#125;</span>=<span class="subst">&#123;il + i2&#125;</span>&quot;</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ä¿©æ®µä»£ç ä¸­,ä½¿ç”¨Lambdaè¡¨è¾¾å¼,å»æ‰äº†delegateå…³é”®å­—ï¼Œå¹¶ä¸”çœç•¥äº†å‚æ•°çš„æ•°æ®ç±»å‹ï¼Œå› ä¸ºç¼–è¯‘å™¨èƒ½æ ¹æ®å§”æ‰˜ç±»å‹æ¨æ–­å‡ºå‚æ•°çš„ç±»å‹ï¼Œç„¶åç”¨&#x3D;&gt;ä½œä¸ºå®šä¹‰æ–¹æ³•ä½“çš„å…³é”®å­—ã€‚</p><p>ä½†è¿™æ®µä»£ç è¿˜å¯ä»¥è¿›ä¸€æ­¥ç®€åŒ–è¿™äº›ä»£ç ã€‚å¦‚æœ&#x3D;&gt;ä¹‹åæ–¹æ³•ä½“åªæœ‰ä¸€è¡Œä»£ç ï¼Œå¹¶ä¸”æ–¹æ³•æœ‰è¿”å›å€¼ï¼Œé‚£ä¹ˆè¿˜å¯ä»¥çœç•¥æ–¹æ³•ä½“çš„èŠ±æ‹¬å·åŠreturnå…³é”®å­—ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Func&lt;<span class="built_in">int</span>,<span class="built_in">int</span>,<span class="built_in">string</span>&gt; f1=(il,i2)=&gt;<span class="string">$&quot;<span class="subst">&#123;il&#125;</span>+<span class="subst">&#123;i2&#125;</span>=<span class="subst">&#123;il + i2&#125;</span>&quot;</span>;</span><br></pre></td></tr></table></figure><p>æ–¹æ³•æ²¡æœ‰è¿”å›å€¼ï¼Œæ–¹æ³•ä½“åªæœ‰ä¸€ä¸ªä»£ç å¯ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Action&lt;<span class="built_in">int</span>,<span class="built_in">string</span>&gt; a1=(age,name)=&gt;Console.WriteLine(<span class="string">$&quot;å¹´é¾„<span class="subst">&#123;age&#125;</span>,å§“å<span class="subst">&#123;name&#125;</span>&quot;</span>);</span><br></pre></td></tr></table></figure><p>å¦‚æœåªæœ‰ä¸€ä¸ªæ–¹æ³•åªæœ‰ä¸€ä¸ªå‚æ•°å¯ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Func&lt;<span class="built_in">int</span>,<span class="built_in">int</span>&gt; f1=il=&gt;il*<span class="number">2</span>;</span><br></pre></td></tr></table></figure><p>Lambdaè¡¨è¾¾å¼ä¾‹å­</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span>[] arrays=&#123;<span class="number">2</span>,<span class="number">8</span>,<span class="number">29</span>,<span class="number">19</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">99</span>,<span class="number">89</span>,<span class="number">105</span>,<span class="number">108</span>,<span class="number">81</span>&#125;;</span><br><span class="line"><span class="keyword">var</span> nums2=MyWhere(arrays,n=&gt;n&gt;<span class="number">30</span>);</span><br><span class="line">Console.WriteLine(<span class="built_in">string</span>.Join(<span class="string">&quot;,&quot;</span>,nums2));</span><br><span class="line"><span class="keyword">var</span> nums3 = MyWhere(arrays, n =&gt; n % <span class="number">2</span> == <span class="number">0</span>);</span><br><span class="line">Console.WriteLine(<span class="built_in">string</span>.Join(<span class="string">&quot;,&quot;</span>,nums3));</span><br><span class="line"><span class="function"><span class="keyword">static</span> IEnumerable&lt;<span class="built_in">int</span>&gt; <span class="title">MyWhere</span>(<span class="params">IEnumerable&lt;<span class="built_in">int</span>&gt; nums, Func&lt;<span class="built_in">int</span>, <span class="built_in">bool</span>&gt; filter</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="built_in">int</span> n <span class="keyword">in</span> nums)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (filter(n)) <span class="keyword">yield</span> <span class="keyword">return</span> n;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœä¸ç”¨Lambdaè¡¨è¾¾å¼ï¼Œç”¨åŒ¿åæ–¹æ³•çš„å†™æ³•ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Func&lt;<span class="built_in">int</span>,<span class="built_in">bool</span>&gt; f1= <span class="built_in">delegate</span>(<span class="built_in">int</span> n)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> n &gt; <span class="number">30</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> nums2=MyWhere(arrays,f1);</span><br></pre></td></tr></table></figure><p>å¯è§Lambdaè¡¨è¾¾å¼è®©æˆ‘ä»¬ç¼–å†™åŒ¿åæ–¹æ³•æ›´ç®€å•ã€‚</p><h1 id="LINQ-å¸¸ç”¨æ‰©å±•æ–¹æ³•"><a href="#LINQ-å¸¸ç”¨æ‰©å±•æ–¹æ³•" class="headerlink" title="LINQ å¸¸ç”¨æ‰©å±•æ–¹æ³•"></a>LINQ å¸¸ç”¨æ‰©å±•æ–¹æ³•</h1><p>LINQä¸­æä¾›ç±»ä¼¼Whereçš„æ‰©å±•æ–¹æ³•ï¼Œç®€åŒ–æ•°æ®å¤„ç†ã€‚</p><h2 id="Whereæ–¹æ³•"><a href="#Whereæ–¹æ³•" class="headerlink" title="Whereæ–¹æ³•"></a>Whereæ–¹æ³•</h2><p>Whereæ–¹æ³•ï¼šæ¯ä¸€é¡¹æ•°æ®éƒ½ä¼šç»è¿‡predicateçš„æµ‹è¯•ï¼Œå¦‚æœé’ˆå¯¹ä¸€ä¸ªå…ƒç´ ï¼Œpredicateæ‰§è¡Œçš„è¿”å›å€¼ä¸ºtrue,é‚£ä¹ˆè¿™ä¸ªå…ƒç´ å°±ä¼šæ”¾åˆ°è¿”å›å€¼ä¸­ã€‚<br>Whereå‚æ•°æ˜¯ä¸€ä¸ªlambdaè¡¨è¾¾å¼æ ¼å¼çš„åŒ¿åæ–¹æ³•ï¼Œæ–¹æ³•çš„å‚æ•°eè¡¨ç¤ºå½“å‰åˆ¤æ–­çš„å…ƒç´ å¯¹è±¡ã€‚å‚æ•°çš„åå­—ä¸ä¸€å®šéè¦å«eï¼Œä¸è¿‡ä¸€èˆ¬lambdaè¡¨è¾¾å¼ä¸­çš„å˜é‡åé•¿åº¦éƒ½ä¸é•¿ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Employee&gt; employees = <span class="keyword">new</span> List&lt;Employee&gt;();</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">1</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">28</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">10000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">2</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">18</span>, Gender = <span class="literal">false</span>, Salary = <span class="number">20000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">3</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">20</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">30000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">4</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">22</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">40000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">5</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">24</span>, Gender = <span class="literal">false</span>, Salary = <span class="number">50000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">6</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">26</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">60000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">7</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">27</span>, Gender = <span class="literal">false</span>, Salary = <span class="number">70000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">8</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">19</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">80000</span> &#125;);</span><br><span class="line">IEnumerable&lt;Employee&gt; items1 = employees.Where(e =&gt; e.Age &gt; <span class="number">25</span>);</span><br><span class="line"><span class="keyword">foreach</span> (Employee e <span class="keyword">in</span> items1)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(e);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">Employee</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Age &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">bool</span> Gender &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Salary &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">string</span> <span class="title">ToString</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">$&quot;Id:<span class="subst">&#123;Id&#125;</span>,Name:<span class="subst">&#123;Name&#125;</span>,Age:<span class="subst">&#123;Age&#125;</span>,Gender=<span class="subst">&#123;Gender&#125;</span>,Salary=<span class="subst">&#123;Salary&#125;</span>&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Count-æ–¹æ³•ï¼šè·å–æ•°æ®æ¡æ•°"><a href="#Count-æ–¹æ³•ï¼šè·å–æ•°æ®æ¡æ•°" class="headerlink" title="Count()æ–¹æ³•ï¼šè·å–æ•°æ®æ¡æ•°"></a>Count()æ–¹æ³•ï¼šè·å–æ•°æ®æ¡æ•°</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Employee&gt; employees = <span class="keyword">new</span> List&lt;Employee&gt;();</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">1</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">28</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">10000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">2</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">18</span>, Gender = <span class="literal">false</span>, Salary = <span class="number">20000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">3</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">20</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">30000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">4</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">22</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">40000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">5</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">24</span>, Gender = <span class="literal">false</span>, Salary = <span class="number">50000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">6</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">26</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">60000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">7</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">27</span>, Gender = <span class="literal">false</span>, Salary = <span class="number">70000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">8</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">19</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">80000</span> &#125;);</span><br><span class="line">IEnumerable&lt;Employee&gt; items1 = employees.Where(e =&gt; e.Age &gt; <span class="number">25</span>);</span><br><span class="line"><span class="keyword">foreach</span> (Employee e <span class="keyword">in</span> items1)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(e);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Console.WriteLine(employees.Count());</span><br><span class="line">Console.WriteLine(employees.Count(e=&gt;e.Age&gt;<span class="number">25</span>&amp;&amp;e.Salary&gt;<span class="number">50000</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Employee</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Age &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">bool</span> Gender &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Salary &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">string</span> <span class="title">ToString</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">$&quot;Id:<span class="subst">&#123;Id&#125;</span>,Name:<span class="subst">&#123;Name&#125;</span>,Age:<span class="subst">&#123;Age&#125;</span>,Gender=<span class="subst">&#123;Gender&#125;</span>,Salary=<span class="subst">&#123;Salary&#125;</span>&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Any-æ–¹æ³•ï¼šæ˜¯å¦è‡³å°‘æœ‰ä¸€æ¡æ•°æ®"><a href="#Any-æ–¹æ³•ï¼šæ˜¯å¦è‡³å°‘æœ‰ä¸€æ¡æ•°æ®" class="headerlink" title="Any()æ–¹æ³•ï¼šæ˜¯å¦è‡³å°‘æœ‰ä¸€æ¡æ•°æ®"></a>Any()æ–¹æ³•ï¼šæ˜¯å¦è‡³å°‘æœ‰ä¸€æ¡æ•°æ®</h2><p>æ»¡è¶³æ¡ä»¶è¿”å›true,ä¸æ»¡è¶³è¿”å›false</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Console.WriteLine(employees.Any(e=&gt;e.Salary&gt;<span class="number">80000</span>))</span><br><span class="line">Console.WriteLine(employees.Any(e=&gt;e.Salary&lt;<span class="number">10000</span>))</span><br></pre></td></tr></table></figure><h2 id="è·å–ä¸€æ¡æ•°æ®-LINQä¸­æœ‰4ç»„è·å–ä¸€æ¡æ•°æ®çš„æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯Singleã€SingleOrDefaultã€Firstå’ŒFirstOrDefaultã€‚"><a href="#è·å–ä¸€æ¡æ•°æ®-LINQä¸­æœ‰4ç»„è·å–ä¸€æ¡æ•°æ®çš„æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯Singleã€SingleOrDefaultã€Firstå’ŒFirstOrDefaultã€‚" class="headerlink" title="è·å–ä¸€æ¡æ•°æ® LINQä¸­æœ‰4ç»„è·å–ä¸€æ¡æ•°æ®çš„æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯Singleã€SingleOrDefaultã€Firstå’ŒFirstOrDefaultã€‚"></a>è·å–ä¸€æ¡æ•°æ® LINQä¸­æœ‰4ç»„è·å–ä¸€æ¡æ•°æ®çš„æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯Singleã€SingleOrDefaultã€Firstå’ŒFirstOrDefaultã€‚</h2><p>Single:å¦‚æœç¡®è®¤æœ‰ä¸”åªæœ‰ä¸€æ¡æ»¡è¶³è¦æ±‚çš„æ•°æ®ï¼Œé‚£ä¹ˆå°±ç”¨Singleæ–¹æ³•ã€‚å¦‚æœæ²¡æœ‰æ»¡è¶³æ¡ä»¶çš„æ•°æ®ï¼Œæˆ–æ¡ä»¶çš„æ•°æ®å¤šäºä¸€æ¡ï¼ŒSingleæ–¹æ³•å°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p><p>SingleOrDefault:å¦‚æœç¡®è®¤æœ€å¤šåªæœ‰ä¸€æ¡æ»¡è¶³è¦æ±‚çš„æ•°æ®ï¼Œé‚£ä¹ˆå°±ç”¨SingleOrDefaultæ–¹æ³•ã€‚å¦‚æœæ²¡æœ‰æ»¡è¶³æ¡ä»¶çš„æ•°æ®ï¼ŒSingleOrDefaultæ–¹æ³•å°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p><p>First:å¦‚æœæ»¡è¶³æ¡ä»¶çš„æ•°æ®æœ‰ä¸€æ¡æˆ–å¤šæ¡ï¼ŒFirstæ–¹æ³•å°±ä¼šè¿”å›ç¬¬ä¸€æ¡æ•°æ®ï¼›å¦‚æœæ²¡æœ‰æ»¡è¶³æ¡ä»¶çš„æ•°æ®ï¼ŒFirstæ–¹æ³•å°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p><p>FirstOrDefault:å¦‚æœæ»¡è¶³æ¡ä»¶çš„æ•°æ®æœ‰ä¸€æ¡æˆ–è€…å¤šæ¡ï¼ŒFirstOrDefaultæ–¹æ³•å°±ä¼šè¿”å›ç¬¬ä¸€æ¡æ•°æ®ï¼›å¦‚æœæ²¡æœ‰æ»¡è¶³æ¡ä»¶çš„æ•°æ®ï¼ŒFirstOrDefaultæ–¹æ³•å°±ä¼šè¿”å›ç±»å‹çš„é»˜è®¤å€¼ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Employee&gt; employees = <span class="keyword">new</span> List&lt;Employee&gt;();</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">1</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">28</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">10000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">2</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">18</span>, Gender = <span class="literal">false</span>, Salary = <span class="number">20000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">3</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">20</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">30000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">4</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">22</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">40000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">5</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">24</span>, Gender = <span class="literal">false</span>, Salary = <span class="number">50000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">6</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">26</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">60000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">7</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">27</span>, Gender = <span class="literal">false</span>, Salary = <span class="number">70000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">8</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">19</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">80000</span> &#125;);</span><br><span class="line"></span><br><span class="line">Employee e1 = employees.Single(e =&gt; e.Id == <span class="number">6</span>);</span><br><span class="line">Console.WriteLine(e1);</span><br><span class="line">Employee? e2 = employees.SingleOrDefault(e =&gt; e.Id == <span class="number">9</span>);</span><br><span class="line"><span class="keyword">if</span>(e2==<span class="literal">null</span>) Console.WriteLine(<span class="string">&quot;æ²¡æœ‰Id==9çš„æ•°æ®&quot;</span>);</span><br><span class="line"><span class="keyword">else</span> Console.WriteLine(e2);</span><br><span class="line">Employee e3 = employees.First(e =&gt; e.Age &gt; <span class="number">24</span>);</span><br><span class="line">Console.WriteLine(e3);</span><br><span class="line">Employee? e4 = employees.FirstOrDefault(e =&gt; e.Age &gt; <span class="number">30</span>);</span><br><span class="line"><span class="keyword">if</span> (e4 == <span class="literal">null</span>) Console.WriteLine(<span class="string">&quot;æ²¡æœ‰å¤§äº30å²çš„æ•°æ®&quot;</span>);</span><br><span class="line"><span class="keyword">else</span> Console.WriteLine(e4);</span><br><span class="line">Employee e5 = employees.First(e =&gt; e.Salary &gt; <span class="number">99999</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Employee</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Age &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">bool</span> Gender &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Salary &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">string</span> <span class="title">ToString</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">$&quot;Id:<span class="subst">&#123;Id&#125;</span>,Name:<span class="subst">&#123;Name&#125;</span>,Age:<span class="subst">&#123;Age&#125;</span>,Gender=<span class="subst">&#123;Gender&#125;</span>,Salary=<span class="subst">&#123;Salary&#125;</span>&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ’åº"><a href="#æ’åº" class="headerlink" title="æ’åº"></a>æ’åº</h2><p>OrderByæ–¹æ³•å¯ä»¥å¯¹æ•°æ®è¿›è¡Œæ­£å‘æ’åºï¼Œè€ŒOrderByDescendingæ–¹æ³•åˆ™å¯ä»¥å¯¹æ•°æ®ç»§ç»­é€†å‘æ’åº</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Employee&gt; employees = <span class="keyword">new</span> List&lt;Employee&gt;();</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">1</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">28</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">10000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">2</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">18</span>, Gender = <span class="literal">false</span>, Salary = <span class="number">20000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">3</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">20</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">30000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">4</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">22</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">40000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">5</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">24</span>, Gender = <span class="literal">false</span>, Salary = <span class="number">50000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">6</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">26</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">60000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">7</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">27</span>, Gender = <span class="literal">false</span>, Salary = <span class="number">70000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">8</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">19</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">80000</span> &#125;);</span><br><span class="line"></span><br><span class="line">Console.WriteLine(<span class="string">&quot;--------æŒ‰ç…§å¹´é¾„æ­£åºæ’åˆ—---------&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> orderedItems1 = employees.OrderBy(e =&gt; e.Age);</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> orderedItems1)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(item);</span><br><span class="line">&#125;</span><br><span class="line">Console.WriteLine(<span class="string">&quot;--------å®‰ç…§å·¥èµ„å€’åºæ’åˆ—---------&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> orderedIdems2 = employees.OrderByDescending(e =&gt; e.Salary);</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> orderedIdems2)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(item);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Employee</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Age &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">bool</span> Gender &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Salary &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">string</span> <span class="title">ToString</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">$&quot;Id:<span class="subst">&#123;Id&#125;</span>,Name:<span class="subst">&#123;Name&#125;</span>,Age:<span class="subst">&#123;Age&#125;</span>,Gender=<span class="subst">&#123;Gender&#125;</span>,Salary=<span class="subst">&#123;Salary&#125;</span>&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é™åˆ¶ç»“æœé›†"><a href="#é™åˆ¶ç»“æœé›†" class="headerlink" title="é™åˆ¶ç»“æœé›†"></a>é™åˆ¶ç»“æœé›†</h2><p>é™åˆ¶ç»“æœé›†ç”¨æ¥ä»é›†åˆä¸­è·å–éƒ¨åˆ†æ•°æ®ï¼Œå…¶ä¸»è¦åº”ç”¨åœºæ™¯æ˜¯åˆ†é¡µæŸ¥è¯¢ï¼Œæ¯”å¦‚ä»ç¬¬äºŒé¡µå¼€å§‹è·å–3æ¡æ•°æ®ã€‚<br>Skip(n)æ–¹æ³•ç”¨äºè·³è¿‡næ¡æ•°æ®ï¼ŒTake(n)æ–¹æ³•ç”¨äºè·å–næ¡æ•°æ®ã€‚</p><p>Skipã€Takeæ–¹æ³•ä¹Ÿå¯ä»¥å•ç‹¬ä½¿ç”¨ï¼Œemployees.Skip(2)ç”¨äºè·³è¿‡2æ¡æ•°æ®,ç›´åˆ°è·å–æœ€åä¸€æ¡æ•°æ®ï¼Œåä¹‹employees.Take(2)è·å–å‰2æ¡æ•°æ®ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Employee&gt; employees = <span class="keyword">new</span> List&lt;Employee&gt;();</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">1</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">28</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">10000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">2</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">18</span>, Gender = <span class="literal">false</span>, Salary = <span class="number">20000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">3</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">20</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">30000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">4</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">22</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">40000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">5</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">24</span>, Gender = <span class="literal">false</span>, Salary = <span class="number">50000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">6</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">26</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">60000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">7</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">27</span>, Gender = <span class="literal">false</span>, Salary = <span class="number">70000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">8</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">19</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">80000</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> orderedItems3 = employees.Skip(<span class="number">2</span>);</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> orderedItems3)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(item);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> orderdItems4 = employees.Take(<span class="number">3</span>);</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> orderdItems4)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(item);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> orderdItems5 = employees.Skip(<span class="number">2</span>).Take(<span class="number">3</span>);</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> orderdItems5)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(item);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Employee</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Age &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">bool</span> Gender &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Salary &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">string</span> <span class="title">ToString</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">$&quot;Id:<span class="subst">&#123;Id&#125;</span>,Name:<span class="subst">&#123;Name&#125;</span>,Age:<span class="subst">&#123;Age&#125;</span>,Gender=<span class="subst">&#123;Gender&#125;</span>,Salary=<span class="subst">&#123;Salary&#125;</span>&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="èšåˆå‡½æ•°"><a href="#èšåˆå‡½æ•°" class="headerlink" title="èšåˆå‡½æ•°"></a>èšåˆå‡½æ•°</h2><p>åœ¨SQLä¸­Maxã€Minã€Avgã€Sumã€Countçš„èšåˆå‡½æ•°ã€‚LINQä¸­ä¹Ÿæœ‰å¯¹åº”çš„æ–¹æ³•ï¼Œå®ƒä»¬çš„åå­—åˆ†åˆ«æ˜¯Maxã€Minã€Averageã€Sumã€Count,è¿™äº›æ–¹æ³•ä¹Ÿå¯ä»¥å’ŒWhereã€Skipã€Takeç­‰æ–¹æ³•ä¸€èµ·ä½¿ç”¨ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Employee&gt; employees = <span class="keyword">new</span> List&lt;Employee&gt;();</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">1</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">28</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">10000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">2</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">18</span>, Gender = <span class="literal">false</span>, Salary = <span class="number">20000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">3</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">20</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">30000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">4</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">22</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">40000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">5</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">24</span>, Gender = <span class="literal">false</span>, Salary = <span class="number">50000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">6</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">26</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">60000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">7</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">27</span>, Gender = <span class="literal">false</span>, Salary = <span class="number">70000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">8</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">19</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">80000</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> maxAge = employees.Max(e =&gt; e.Age);</span><br><span class="line">Console.WriteLine(<span class="string">$&quot;æœ€å¤§å¹´é¾„ï¼š<span class="subst">&#123;maxAge&#125;</span>&quot;</span>);</span><br><span class="line"><span class="built_in">long</span> minId = employees.Min(e =&gt; e.Id);</span><br><span class="line">Console.WriteLine(<span class="string">$&quot;æœ€å°Idï¼š<span class="subst">&#123;minId&#125;</span>&quot;</span>);</span><br><span class="line"><span class="built_in">double</span> avgSalary = employees.Average(e =&gt; e.Salary);</span><br><span class="line">Console.WriteLine(<span class="string">$&quot;å¹³å‡å·¥èµ„ï¼š<span class="subst">&#123;avgSalary&#125;</span>&quot;</span>);</span><br><span class="line"><span class="built_in">double</span> sumSalary = employees.Sum(e =&gt; e.Salary);</span><br><span class="line">Console.WriteLine(<span class="string">$&quot;å·¥èµ„æ€»å’Œï¼š<span class="subst">&#123;sumSalary&#125;</span>&quot;</span>);</span><br><span class="line"><span class="built_in">int</span> count = employees.Count();</span><br><span class="line">Console.WriteLine(<span class="string">$&quot;æ€»æ¡æ•°ï¼š<span class="subst">&#123;count&#125;</span>&quot;</span>);</span><br><span class="line"><span class="built_in">int</span> minSalary2 = employees.Where(e =&gt; e.Age &gt; <span class="number">30</span>).Min(e =&gt; e.Salary);</span><br><span class="line">Console.WriteLine(<span class="string">$&quot;å¤§äº30å²çš„äººç¾¤ä¸­çš„æœ€ä½å·¥èµ„ï¼š<span class="subst">&#123;minSalary2&#125;</span>&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Employee</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Age &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">bool</span> Gender &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Salary &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">string</span> <span class="title">ToString</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">$&quot;Id:<span class="subst">&#123;Id&#125;</span>,Name:<span class="subst">&#123;Name&#125;</span>,Age:<span class="subst">&#123;Age&#125;</span>,Gender=<span class="subst">&#123;Gender&#125;</span>,Salary=<span class="subst">&#123;Salary&#125;</span>&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœé›†åˆæ˜¯intç­‰å€¼ç±»å‹å’Œé›†åˆï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨æ²¡æœ‰å‚æ•°çš„èšåˆå‡½æ•°ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span>[] scores = &#123; <span class="number">61</span>, <span class="number">90</span>, <span class="number">100</span>, <span class="number">99</span>, <span class="number">18</span>, <span class="number">22</span>, <span class="number">38</span>, <span class="number">66</span>, <span class="number">80</span>, <span class="number">93</span>, <span class="number">55</span>, <span class="number">50</span>, <span class="number">89</span> &#125;;</span><br><span class="line"><span class="built_in">int</span> minScore = scores.Min();</span><br><span class="line">Console.WriteLine(<span class="string">$&quot;æœ€ä½æˆç»©ï¼š<span class="subst">&#123;minScore&#125;</span>&quot;</span>);</span><br><span class="line"><span class="built_in">double</span> avgScore1 = scores.Where(i =&gt; i &gt; <span class="number">60</span>).Average();</span><br><span class="line">Console.WriteLine(<span class="string">$&quot;åˆæ ¼æˆç»©ä¸­çš„å¹³å±€æ°´å¹³ï¼š<span class="subst">&#123;avgSalary&#125;</span>&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="åˆ†ç»„"><a href="#åˆ†ç»„" class="headerlink" title="åˆ†ç»„"></a>åˆ†ç»„</h2><p>LINQä¸­æ”¯æŒç±»ä¼¼äºSQLä¸­çš„GroupByå®ç°åˆ†ç»„æ“ä½œã€‚GroupByæ–¹æ³•ç”¨æ¥è¿›è¡Œåˆ†ç»„ã€‚<br>å¯¹åºåˆ—ä¸­çš„å…ƒç´ è¿›è¡Œåˆ†ç»„ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;IGrouping&lt;TKey, TSource&gt;&gt; GroupBy&lt;TSource, TKey&gt;(<span class="keyword">this</span> IEnumerable&lt;TSource&gt; source, Func&lt;TSource, TKey&gt; keySelector);</span><br></pre></td></tr></table></figure><p>GroupByæ–¹æ³•çš„å‚æ•°keySelectoræ˜¯åˆ†ç»„æ¡ä»¶è¡¨è¾¾å¼ï¼ŒGroupByæ–¹æ³•çš„è¿”å›å€¼ä¸ºIGrouping&lt;TKey, TSource&gt;ç±»å‹çš„æ³›å‹IEnumerableã€‚IGroupingæ˜¯ä¸€ä¸ªç»§æ‰¿è‡ªIEnumerableçš„æ¥å£ï¼ŒIGroupingä¸­å”¯ä¸€çš„æˆå‘˜å°±æ˜¯Keyå±æ€§ï¼Œè¡¨ç¤ºè¿™ä¸€ç»„çš„æ•°æ®é¡¹ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Employee&gt; employees = <span class="keyword">new</span> List&lt;Employee&gt;();</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">1</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">28</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">10000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">2</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">18</span>, Gender = <span class="literal">false</span>, Salary = <span class="number">20000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">3</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">20</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">30000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">4</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">22</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">40000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">5</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">24</span>, Gender = <span class="literal">false</span>, Salary = <span class="number">50000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">6</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">26</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">60000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">7</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">27</span>, Gender = <span class="literal">false</span>, Salary = <span class="number">70000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">8</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">19</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">80000</span> &#125;);</span><br><span class="line"></span><br><span class="line">IEnumerable&lt;IGrouping&lt;<span class="built_in">int</span>, Employee&gt;&gt; items = employees.GroupBy(e =&gt; e.Age);</span><br><span class="line"><span class="keyword">foreach</span> (IGrouping&lt;<span class="built_in">int</span>, Employee&gt; item <span class="keyword">in</span> items)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span> age = item.Key;</span><br><span class="line">    <span class="built_in">int</span> count = item.Count();</span><br><span class="line">    <span class="built_in">int</span> maxSalary = item.Max(e =&gt; e.Salary);</span><br><span class="line">    <span class="built_in">double</span> avgSalary = item.Average(e =&gt; e.Salary);</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;å¹´é¾„ï¼š<span class="subst">&#123;item.Key&#125;</span>,äººæ•°ï¼š<span class="subst">&#123;count&#125;</span>,æœ€é«˜å·¥èµ„ï¼š<span class="subst">&#123;maxSalary&#125;</span>,å¹³å‡å·¥èµ„ï¼š<span class="subst">&#123;avgSalary&#125;</span>&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Employee</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Age &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">bool</span> Gender &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Salary &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">string</span> <span class="title">ToString</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">$&quot;Id:<span class="subst">&#123;Id&#125;</span>,Name:<span class="subst">&#123;Name&#125;</span>,Age:<span class="subst">&#123;Age&#125;</span>,Gender=<span class="subst">&#123;Gender&#125;</span>,Salary=<span class="subst">&#123;Salary&#125;</span>&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ¹æ®æ€§åˆ«è¿›è¡Œåˆ†ç»„</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> items = employees.GroupBy(e =&gt; e.Gender);</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> items)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">bool</span> gender = item.Key;</span><br><span class="line">    <span class="built_in">int</span> count = item.Count();</span><br><span class="line">    <span class="built_in">double</span> avgSalary = item.Average(e =&gt; e.Salary);</span><br><span class="line">    <span class="built_in">int</span> minAge = item.Min(e =&gt; e.Age);</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;æ€§åˆ«ï¼š<span class="subst">&#123;gender&#125;</span>,äººæ•°ï¼š<span class="subst">&#123;count&#125;</span>,å¹³å‡å€¼ï¼š<span class="subst">&#123;avgSalary:F&#125;</span>,æœ€ä¸‹å¹´é¾„ï¼š<span class="subst">&#123;minAge&#125;</span>&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±äºåˆ†ç»„æ¡ä»¶è¡¨è¾¾å¼ç”¨çš„boolç±»å‹çš„Genderå±æ€§ï¼Œintem.Keyå°±æ˜¯boolç±»å‹ã€‚</p><h2 id="æŠ•å½±"><a href="#æŠ•å½±" class="headerlink" title="æŠ•å½±"></a>æŠ•å½±</h2><p>å¯ä»¥å¯¹é›†åˆä½¿ç”¨Selectæ–¹æ³•è¿›è¡ŒæŠ•å½±æ“ä½œï¼Œé€šä¿—æ¥è¯´å°±æ˜¯æŠŠé›†åˆä¸­çš„æ¯ä¸€é¡¹é€é¡¹è½¬æ¢ä¸ºå¦å¤–ä¸€ç§ç±»å‹ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Employee&gt; employees = <span class="keyword">new</span> List&lt;Employee&gt;();</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">1</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">28</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">10000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">2</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">18</span>, Gender = <span class="literal">false</span>, Salary = <span class="number">20000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">3</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">20</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">30000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">4</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">22</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">40000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">5</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">24</span>, Gender = <span class="literal">false</span>, Salary = <span class="number">50000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">6</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">26</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">60000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">7</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">27</span>, Gender = <span class="literal">false</span>, Salary = <span class="number">70000</span> &#125;);</span><br><span class="line">employees.Add(<span class="keyword">new</span> Employee &#123; Id = <span class="number">8</span>, Name = <span class="string">&quot;Tim&quot;</span>, Age = <span class="number">19</span>, Gender = <span class="literal">true</span>, Salary = <span class="number">80000</span> &#125;);</span><br><span class="line"></span><br><span class="line">IEnumerable&lt;<span class="built_in">int</span>&gt; ages = employees.Select(e =&gt; e.Age);</span><br><span class="line">Console.WriteLine(String.Join(<span class="string">&quot;,&quot;</span>,ages));</span><br><span class="line">IEnumerable&lt;<span class="built_in">string</span>&gt; names = employees.Select(e =&gt; e.Gender ? <span class="string">&quot;ç”·&quot;</span> : <span class="string">&quot;å¥³&quot;</span>);</span><br><span class="line">Console.WriteLine(<span class="built_in">string</span>.Join(<span class="string">&quot;,&quot;</span>,names));</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Employee</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Age &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">bool</span> Gender &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Salary &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">string</span> <span class="title">ToString</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">$&quot;Id:<span class="subst">&#123;Id&#125;</span>,Name:<span class="subst">&#123;Name&#125;</span>,Age:<span class="subst">&#123;Age&#125;</span>,Gender=<span class="subst">&#123;Gender&#125;</span>,Salary=<span class="subst">&#123;Salary&#125;</span>&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Selectæ–¹æ³•ä¸­ä½¿ç”¨åŒ¿åç±»å‹<br>ä½¿ç”¨Selectæ–¹æ³•ä»employeesçš„æ¯ä¸€é¡¹æå–å‡ºNameã€Ageå±æ€§çš„å€¼ï¼Œå¹¶ä¸”æŠŠGenderè½¬æ¢ä¸ºå­—ç¬¦ä¸²,Selectæ–¹æ³•çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªåŒ¿åç±»å‹çš„IEnumerableç±»å‹ï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»ç”¨varå£°æ˜å˜é‡ç±»å‹ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> items = employees.Select(e =&gt; <span class="keyword">new</span> &#123;e.Name, e.Age, XingBie = e.Gender ? <span class="string">&quot;ç”·&quot;</span> : <span class="string">&quot;å¥³&quot;</span>&#125;);</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> items)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> name = item.Name;</span><br><span class="line">    <span class="built_in">int</span> age = item.Age;</span><br><span class="line">    <span class="built_in">string</span> xingbie = item.XingBie;</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;åå­—=<span class="subst">&#123;name&#125;</span>,å¹´é¾„=<span class="subst">&#123;age&#125;</span>,æ€§åˆ«=<span class="subst">&#123;xingbie&#125;</span>&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é›†åˆè½¬æ¢"><a href="#é›†åˆè½¬æ¢" class="headerlink" title="é›†åˆè½¬æ¢"></a>é›†åˆè½¬æ¢</h2><p>é›†åˆæ“ä½œçš„æ‰©å±•æ–¹æ³•çš„è¿”å›å€¼å¤§éƒ¨åˆ†éƒ½æ˜¯IEnumnerable&lt;T&gt;ç±»å‹ï¼Œä½†æ˜¯æœ‰ä¸€äº›åœ°æ–¹éœ€è¦æ•°ç»„ç±»å‹æˆ–è€…List&lt;T&gt;ç±»å‹çš„å˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ToArrayå’ŒToListæ–¹æ³•åˆ†åˆ«æŠŠIEnumerable&lt;T&gt;è½¬æ¢ä¸ºæ•°ç»„ç±»å‹å’ŒList&lt;T&gt;ç±»å‹ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Employee[] items1 = employees.Where(e =&gt; e.Salary &gt; <span class="number">30000</span>).ToArray();</span><br><span class="line">List&lt;Employee&gt; items2 = employees.Where(e =&gt; e.Salary &gt; <span class="number">3000</span>).ToList();</span><br></pre></td></tr></table></figure><h2 id="LINQæ‰©å±•æ–¹æ³•çš„é“¾å¼è°ƒç”¨"><a href="#LINQæ‰©å±•æ–¹æ³•çš„é“¾å¼è°ƒç”¨" class="headerlink" title="LINQæ‰©å±•æ–¹æ³•çš„é“¾å¼è°ƒç”¨"></a>LINQæ‰©å±•æ–¹æ³•çš„é“¾å¼è°ƒç”¨</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> items = employees.Where(e =&gt; e.Id &gt; <span class="number">2</span>).GroupBy(e =&gt; e.Age).OrderBy(g =&gt; g.Key).Take(<span class="number">3</span>)</span><br><span class="line">    .Select(g =&gt; <span class="keyword">new</span> &#123; Age = g.Key, Count = g.Count(), AvgSalary = g.Average(e =&gt; e.Salary) &#125;);</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> items)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;å¹´é¾„ï¼š<span class="subst">&#123;item.Age&#125;</span>,äººæ•°ï¼š<span class="subst">&#123;item.Count&#125;</span>,å¹³å‡å·¥èµ„ï¼š<span class="subst">&#123;item.AvgSalary&#125;</span>&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æŸ¥è¯¢è¯­å¥"><a href="#æŸ¥è¯¢è¯­å¥" class="headerlink" title="æŸ¥è¯¢è¯­å¥"></a>æŸ¥è¯¢è¯­å¥</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> items1=employees.Where(e =&gt; e.Salary &gt; <span class="number">30000</span>).OrderBy(e=&gt;e.Age)</span><br><span class="line">    .Select(e =&gt; <span class="keyword">new</span> &#123;e.Name, e.Age, Gender = e.Gender ? <span class="string">&quot;ç”·&quot;</span> : <span class="string">&quot;å¥³&quot;</span>&#125;);</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æŸ¥è¯¢è¯­æ³•ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> items2 = <span class="keyword">from</span> e <span class="keyword">in</span> employees</span><br><span class="line">    <span class="keyword">where</span> e.Salary &gt; <span class="number">3000</span></span><br><span class="line">    <span class="keyword">orderby</span> e.Age</span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">new</span> &#123; e.Name, e.Age, Gender = e.Gender ? <span class="string">&quot;ç”·&quot;</span> : <span class="string">&quot;å¥³&quot;</span> &#125;;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ASP.NET Core </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¼‚æ­¥ç¼–ç¨‹å­¦ä¹ ç¬”è®°</title>
      <link href="/2025/03/15/asp.net%20core/%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B/"/>
      <url>/2025/03/15/asp.net%20core/%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å¼‚æ­¥ç¼–ç¨‹"><a href="#ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å¼‚æ­¥ç¼–ç¨‹" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å¼‚æ­¥ç¼–ç¨‹"></a>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å¼‚æ­¥ç¼–ç¨‹</h1><p>æ€§èƒ½ä¼˜åŒ–ï¼š</p><p>ä¸»çº¿ç¨‹åˆ©ç”¨ç‡ï¼šå¼‚æ­¥ç¼–ç¨‹å…è®¸ä¸»çº¿ç¨‹æŒç»­è¿è¡Œå¤šä¸ªä»»åŠ¡ï¼Œé¿å…å› å­çº¿ç¨‹é˜»å¡è€Œé™ä½æ€§èƒ½ã€‚<br>I&#x2F;Oå¯†é›†å‹ä»»åŠ¡å¤„ç†ï¼šå¼‚æ­¥ç¼–ç¨‹ç‰¹åˆ«é€‚åˆå¤„ç†å¤§é‡I&#x2F;Oæ“ä½œçš„ä»»åŠ¡ï¼Œå¦‚æ–‡ä»¶è¯»å†™ã€æ•°æ®åº“æŸ¥è¯¢ç­‰ï¼Œè¿™äº›æ“ä½œå¯ä»¥ç‹¬ç«‹äºä¸»çº¿ç¨‹è¿è¡Œï¼Œæå‡åº”ç”¨å“åº”é€Ÿåº¦ã€‚<br>å¯æ‰©å±•æ€§ï¼š</p><p>å¤šå¤„ç†å™¨æ”¯æŒï¼šå¼‚æ­¥ç¼–ç¨‹èƒ½å¤Ÿå……åˆ†åˆ©ç”¨å¤šå¤„ç†å™¨èµ„æºï¼Œæ¯ä¸ªCPUæ ¸åŒæ—¶å¤„ç†ä¸åŒçš„ä»»åŠ¡ï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„æ€§èƒ½å’Œç¨³å®šæ€§ã€‚<br>é«˜è´Ÿè½½è¯·æ±‚å¤„ç†ï¼šåœ¨å¤„ç†å¤§é‡å¹¶å‘è¯·æ±‚æ—¶ï¼ŒåŒæ­¥ç¼–ç¨‹å¯èƒ½å¯¼è‡´ä¸»çº¿ç¨‹è¢«é˜»å¡ï¼Œè€Œå¼‚æ­¥ç¼–ç¨‹åˆ™èƒ½å¤Ÿæœ‰æ•ˆåœ°åˆ†æ‹…å‹åŠ›ã€‚<br>ç°ä»£Webå¼€å‘è¶‹åŠ¿ï¼š</p><p>æŠ€æœ¯å…¼å®¹æ€§ï¼šä¸ä¸»æµWebæ¡†æ¶ï¼ˆå¦‚Reactã€Vueï¼‰çš„é›†æˆæ›´åŠ é¡ºç•…ï¼Œä½¿ç”¨async&#x2F;awaitå…³é”®å­—å¯ä»¥ç®€åŒ–ä»£ç ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚<br>ç”¨æˆ·ä½“éªŒæå‡ï¼šå¼‚æ­¥ç¼–ç¨‹é€šè¿‡å»¶è¿ŸåŠ è½½ç­‰æŠ€æœ¯å‡å°‘ç”¨æˆ·ç­‰å¾…æ—¶é—´ï¼Œæå‡åº”ç”¨ä½“éªŒã€‚<br>èµ„æºåˆ©ç”¨æ•ˆç‡ï¼š</p><p>å¤šä»»åŠ¡å¹¶è¡Œå¤„ç†ï¼šä¸»çº¿ç¨‹å¯ä»¥é€šè¿‡å¤šçº¿ç¨‹æˆ–å ordinates æ‰§è¡Œå¤šä¸ªä»»åŠ¡ï¼Œé¿å…èµ„æºæµªè´¹ï¼Œæé«˜ç³»ç»Ÿçš„ååé‡ã€‚<br>è¶‹åŠ¿é€‚åº”æ€§ï¼š</p><p>å¼‚æ­¥ç¼–ç¨‹çš„æµè¡Œï¼šåœ¨ç°ä»£åº”ç”¨å¼€å‘ä¸­ï¼Œå¼‚æ­¥ç¼–ç¨‹å› å…¶ç®€æ´æ€§å’Œé«˜æ•ˆæ€§è€Œå¤‡å—é’çï¼Œé‡‡ç”¨è¯¥æ¨¡å¼å¯ä»¥ä¸ç°æœ‰æŠ€æœ¯æ ˆæ›´å¥½åœ°ç»“åˆã€‚</p><h1 id="åˆ›å»ºå¼‚æ­¥æ–¹æ³•"><a href="#åˆ›å»ºå¼‚æ­¥æ–¹æ³•" class="headerlink" title="åˆ›å»ºå¼‚æ­¥æ–¹æ³•"></a>åˆ›å»ºå¼‚æ­¥æ–¹æ³•</h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="keyword">await</span> DownloadHTmlAsync(<span class="string">&quot;http://www.ptpress.com.cn&quot;</span>, <span class="string">@&quot;E:\temp\1.txt&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task <span class="title">DownloadHTmlAsync</span>(<span class="params"><span class="built_in">string</span> url,<span class="built_in">string</span> filename</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">using</span> (HttpClient httpClient = <span class="keyword">new</span> HttpClient())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> html = <span class="keyword">await</span> httpClient.GetStringAsync(url);</span><br><span class="line">        <span class="keyword">await</span> File.WriteAllTextAsync(filename, html);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¸¦è¿”å›å€¼çš„<br>è·å–é•¿åº¦</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span> I = <span class="keyword">await</span> DownloadHTmlAsync(<span class="string">&quot;http://www.ptpress.com.cn&quot;</span>, <span class="string">@&quot;E:\temp\1.txt&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task&lt;<span class="built_in">int</span>&gt; <span class="title">DownloadHTmlAsync</span>(<span class="params"><span class="built_in">string</span> url,<span class="built_in">string</span> filename</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">using</span> (HttpClient httpClient = <span class="keyword">new</span> HttpClient())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> html = <span class="keyword">await</span> httpClient.GetStringAsync(url);</span><br><span class="line">        <span class="keyword">await</span> File.WriteAllTextAsync(filename, html);</span><br><span class="line">        <span class="keyword">return</span> html.Length;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>HttpClient: æä¾›ä¸€ä¸ªç±»ï¼Œç”¨äºä» URI æ ‡è¯†çš„èµ„æºå‘é€ HTTP è¯·æ±‚å’Œæ¥æ”¶ HTTP å“åº”ã€‚<br>Flie: æä¾›ç”¨äºåˆ›å»ºã€å¤åˆ¶ã€åˆ é™¤ã€ç§»åŠ¨å’Œæ‰“å¼€å•ä¸ªæ–‡ä»¶çš„é™æ€æ–¹æ³•ï¼Œå¹¶æœ‰åŠ©äºåˆ›å»º FileStream å¯¹è±¡ã€‚<br>GetStringAsync: å°† GET è¯·æ±‚å‘é€åˆ°æŒ‡å®š URI å¹¶åœ¨å¼‚æ­¥æ“ä½œä¸­ä»¥å­—ç¬¦ä¸²çš„å½¢å¼è¿”å›å“åº”æ­£æ–‡ã€‚</p></blockquote><blockquote><p>åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„å¼‚æ­¥ä»»åŠ¡ç±»ï¼š<br>åˆ›å»ºä¸€ä¸ªç»§æ‰¿è‡ªTask&lt; T &gt;çš„ç±»ï¼Œå¹¶åœ¨æ–¹æ³•ä¸­æ·»åŠ [System.Threading.Await]æˆ–ä½¿ç”¨asyncå…³é”®å­—ã€‚</p></blockquote><blockquote><p>ä¸‹è½½HTMLå†…å®¹ï¼š<br>åœ¨å¼‚æ­¥æ–¹æ³•ä¸­ï¼Œä½¿ç”¨HttpClientæ¥è·å–æŒ‡å®šURLçš„HTMLå†…å®¹ã€‚è¿™ä¸€æ­¥æ˜¯éé˜»å¡æ“ä½œï¼Œä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹ã€‚</p></blockquote><blockquote><p>å°†HTMLå†…å®¹ä¿å­˜åˆ°æ–‡ä»¶ï¼š<br>ä½¿ç”¨File.WriteAllTextAsyncå°†è·å–åˆ°çš„HTMLå†…å®¹å†™å…¥æŒ‡å®šçš„ç›®æ ‡æ–‡ä»¶è·¯å¾„ï¼Œå¹¶ç¡®ä¿èµ„æºè¢«æ­£ç¡®å…³é—­ã€‚</p></blockquote><h1 id="async-çº¿ç¨‹åˆ‡æ¢"><a href="#async-çº¿ç¨‹åˆ‡æ¢" class="headerlink" title="async çº¿ç¨‹åˆ‡æ¢"></a>async çº¿ç¨‹åˆ‡æ¢</h1><p>ç†è§£å…³é”®å­—â€œasyncâ€ä¸â€œawaitâ€ï¼š</p><p>asyncç”¨äºå®šä¹‰ä¸€ä¸ªå¯ä»¥æ‰§è¡Œå¼‚æ­¥æ“ä½œçš„ä»»åŠ¡ã€‚<br>awaitç”¨äºç­‰å¾…è¯¥ä»»åŠ¡çš„å®Œæˆã€‚<br>çº¿ç¨‹åˆ‡æ¢çš„åŸºæœ¬æ¦‚å¿µï¼š</p><p>çº¿ç¨‹åˆ‡æ¢æ˜¯ç¨‹åºè¿è¡Œæ—¶ä»ä¸€ä¸ªçº¿ç¨‹åˆ‡æ¢åˆ°å¦ä¸€ä¸ªçº¿ç¨‹çš„è¿‡ç¨‹ã€‚<br>ä½¿ç”¨â€œasyncâ€å’Œâ€œawaitâ€ï¼ŒC#åœ¨ä¸»çº¿ç¨‹å’Œå¼‚æ­¥ä»»åŠ¡ä¹‹é—´è‡ªåŠ¨è¿›è¡Œçº¿ç¨‹åˆ‡æ¢ã€‚<br>awaitè§¦å‘çš„çº¿ç¨‹åˆ‡æ¢è¿‡ç¨‹ï¼š</p><p>å½“è°ƒç”¨å¸¦æœ‰asyncå…³é”®å­—çš„ä»»åŠ¡ï¼Œå¹¶ä½¿ç”¨awaitç­‰å¾…å…¶å®Œæˆæ—¶ï¼ŒC#ä¼šæš‚åœä¸»çº¿ç¨‹ã€‚<br>åˆ›å»ºä¸€ä¸ªæ–°çš„åå°çº¿ç¨‹æ¥æ‰§è¡Œè¯¥å¼‚æ­¥ä»»åŠ¡ã€‚<br>ç›´åˆ°è¯¥åå°çº¿ç¨‹å®Œæˆæˆ–æŠ›å‡ºå¼‚å¸¸ï¼Œä¸»çº¿ç¨‹æ‰ä¼šé‡æ–°å¯åŠ¨ã€‚<br>åµŒå¥—ä½¿ç”¨â€œawaitâ€çš„æƒ…å†µï¼š</p><p>åœ¨ä¸€ä¸ªasyncä»»åŠ¡å†…éƒ¨å†æ¬¡è°ƒç”¨å¦ä¸€ä¸ªå¸¦æœ‰asyncå’Œawaitçš„ä»»åŠ¡æ—¶ï¼ŒC#ä¼šåˆ›å»ºæ–°çš„çº¿ç¨‹å¹¶åˆ‡æ¢ä¸»ä»çº¿ç¨‹ã€‚<br>è¿™ç§å¤šå±‚åµŒå¥—å¢å¼ºäº†ä»£ç çš„å¯è¯»æ€§å’Œçµæ´»æ€§ã€‚<br>åŒæ­¥ä¸é”™è¯¯å¤„ç†ï¼š</p><p>awaitæ“ä½œä¼šé˜»å¡ä¸»çº¿ç¨‹ç›´åˆ°æ‰€æœ‰ç­‰å¾…çš„ä»»åŠ¡å®Œæˆæˆ–å‡ºç°å¼‚å¸¸ã€‚<br>å¦‚æœæŸä¸ªä»»åŠ¡æŠ›å‡ºå¼‚å¸¸ï¼Œåç»­çš„æ‰€æœ‰awaitæ“ä½œéƒ½ä¼šç»ˆæ­¢ï¼Œå¹¶æŒ‰ç…§é”™è¯¯å¤„ç†æœºåˆ¶è¿›è¡Œã€‚<br>æ½œåœ¨çš„é—®é¢˜ä¸ä¼˜åŒ–ï¼š</p><p>å½“å¤šä¸ªä»»åŠ¡éœ€è¦é˜»å¡ä¸»çº¿ç¨‹æ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¸»çº¿ç¨‹è¢«é¢‘ç¹åˆ‡æ¢ï¼Œå½±å“æ€§èƒ½ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨å¼‚æ­¥é˜Ÿåˆ—æˆ–å…¶ä»–ç»“æ„æ¥æé«˜æ•ˆç‡ã€‚<br>ä½¿ç”¨é€‚å½“çš„åŒæ­¥å’Œé”™è¯¯å¤„ç†æœºåˆ¶å¯ä»¥é¿å…èµ„æºæ³„æ¼å’Œå…¶ä»–æ½œåœ¨é—®é¢˜ã€‚<br>æ€»ç»“ï¼š</p><p>â€œasyncâ€ä¸â€œawaitâ€é€šè¿‡è‡ªåŠ¨ç®¡ç†çº¿ç¨‹åˆ‡æ¢ï¼Œç®€åŒ–äº†ç¼–å†™å¼‚æ­¥æ“ä½œçš„ä»£ç ï¼Œæé«˜äº†å¼€å‘æ•ˆç‡ã€‚<br>æ­£ç¡®ç†è§£å’Œä½¿ç”¨è¿™äº›å…³é”®å­—èƒ½å¤Ÿæœ‰æ•ˆæå‡ç¨‹åºçš„æ€§èƒ½å’Œå¯ç»´æŠ¤æ€§ã€‚</p><blockquote><p>awaitè°ƒç”¨çš„ç­‰å¾…æœŸé—´ï¼Œ.NETä¼šæŠŠå½“å‰çš„çº¿ç¨‹è¿”å›ç»™çº¿ç¨‹æ± ï¼Œç­‰å¼‚æ­¥æ–¹æ³•è°ƒç”¨æ‰§è¡Œå®Œæ¯•åï¼Œæ¡†æ¶ä¼šä»çº¿ç¨‹æ± å†å–å‡ºæ¥ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œåç»­ä»£ç ï¼ˆä¸ä¸€å®šæ—¶åŒä¸€ä¸ªçº¿ç¨‹æ± ï¼‰</p></blockquote><p>éªŒè¯ï¼šåœ¨è€—æ—¶å¼‚æ­¥ï¼ˆå†™å…¥æ‰“å­—ç¬¦ä¸²ï¼‰æ“ä½œå‰ååˆ†åˆ«æ‰“å°çº¿ç¨‹Id</p><p>Thread.CurrentThread.ManagedThreadIdè·å¾—å½“å‰çº¿ç¨‹Idã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(Thread.CurrentThread.ManagedThreadId);</span><br><span class="line">    StringBuilder sb= <span class="keyword">new</span> StringBuilder();</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10000</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        sb.Append(<span class="string">&quot;youxianyu&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">await</span> File.WriteAllTextAsync(<span class="string">@&quot;E:\temp\1.txt&quot;</span>, sb.ToString());</span><br><span class="line">    Console.WriteLine(Thread.CurrentThread.ManagedThreadId);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">8</span><br></pre></td></tr></table></figure><p>æ€»ç»“ï¼šç¼–è¯‘å™¨æŠŠasyncæ‹†åˆ†æˆå¤šæ¬¡æ–¹æ³•è°ƒç”¨ï¼Œç¨‹åºåœ¨è¿è¡Œçš„æ—¶å€™ä¼šé€šè¿‡çº¿ç¨‹æ± ä¸­å–å‡ºç©ºé—²çº¿ç¨‹æ‰§è¡Œä¸åŒMoveNextè°ƒç”¨çš„æ–¹æ³•æ¥é¿å…çº¿ç¨‹çš„â€œç©ºç­‰â€ï¼Œä»è€Œæå‡ç³»ç»Ÿçš„å¹¶å‘å¤„ç†èƒ½åŠ›ã€‚</p><h1 id="å¼‚æ­¥æ–¹æ³•ä¸ç­‰äºå¤šçº¿ç¨‹"><a href="#å¼‚æ­¥æ–¹æ³•ä¸ç­‰äºå¤šçº¿ç¨‹" class="headerlink" title="å¼‚æ­¥æ–¹æ³•ä¸ç­‰äºå¤šçº¿ç¨‹"></a>å¼‚æ­¥æ–¹æ³•ä¸ç­‰äºå¤šçº¿ç¨‹</h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;ä¹‹å‰ï¼š&quot;</span> + Thread.CurrentThread.ManagedThreadId);</span><br><span class="line">    <span class="built_in">double</span> r=<span class="keyword">await</span> CalcAsync(<span class="number">500</span>);</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;r=<span class="subst">&#123;r&#125;</span>&quot;</span>);</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;ä¹‹åï¼š&quot;</span> + Thread.CurrentThread.ManagedThreadId);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">async</span> Task&lt;<span class="built_in">double</span>&gt; <span class="title">CalcAsync</span>(<span class="params"><span class="built_in">int</span> n</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">   </span><br><span class="line">        Console.WriteLine(<span class="string">&quot;CalcAsync:&quot;</span> + Thread.CurrentThread.ManagedThreadId);</span><br><span class="line">        <span class="built_in">double</span> result = <span class="number">0</span>;</span><br><span class="line">        Random rand = <span class="keyword">new</span> Random();</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; n * n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            result += rand.NextDouble();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¼‚æ­¥æ–¹æ³•çš„ä»£ç å¹¶ä¸ä¼šè‡ªåŠ¨åœ¨æ–°çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œé™¤éæŠŠä»£ç æ”¾åˆ°æ–°çº¿ç¨‹ä¸­æ‰§è¡Œã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;ä¹‹å‰ï¼š&quot;</span> + Thread.CurrentThread.ManagedThreadId);</span><br><span class="line">    <span class="built_in">double</span> r=<span class="keyword">await</span> CalcAsync(<span class="number">500</span>);</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;r=<span class="subst">&#123;r&#125;</span>&quot;</span>);</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;ä¹‹åï¼š&quot;</span> + Thread.CurrentThread.ManagedThreadId);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">async</span> Task&lt;<span class="built_in">double</span>&gt; <span class="title">CalcAsync</span>(<span class="params"><span class="built_in">int</span> n</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">await</span> Task.Run(() =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;CalcAsync:&quot;</span> + Thread.CurrentThread.ManagedThreadId);</span><br><span class="line">        <span class="built_in">double</span> result = <span class="number">0</span>;</span><br><span class="line">        Random rand = <span class="keyword">new</span> Random();</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; n * n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            result += rand.NextDouble();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>å¯ä»¥çœ‹åˆ°Task.Runçš„çº¿ç¨‹IDå’ŒMainæ–¹æ³•ä¸­çš„çº¿ç¨‹IDä¸åŒï¼Œè¿™è¯´æ˜Task.Runä¸­çš„ä»£ç è¢«æ”¾åˆ°æ–°çº¿ç¨‹ä¸­æ‰§è¡Œäº†ã€‚</p></blockquote><h1 id="ä¸ºä»€ä¹ˆæœ‰çš„å¼‚æ­¥æ–¹æ³•æ²¡æ ‡async"><a href="#ä¸ºä»€ä¹ˆæœ‰çš„å¼‚æ­¥æ–¹æ³•æ²¡æ ‡async" class="headerlink" title="ä¸ºä»€ä¹ˆæœ‰çš„å¼‚æ­¥æ–¹æ³•æ²¡æ ‡async"></a>ä¸ºä»€ä¹ˆæœ‰çš„å¼‚æ­¥æ–¹æ³•æ²¡æ ‡async</h1><p>æœ‰async</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> s1=<span class="keyword">await</span> ReadFileAsync(<span class="number">1</span>);</span><br><span class="line">    Console.WriteLine(s1);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task&lt;<span class="built_in">string</span>&gt; <span class="title">ReadFileAsync</span>(<span class="params"><span class="built_in">int</span> num</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">switch</span> (num)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">await</span> File.ReadAllTextAsync(<span class="string">&quot;e:/temp/1.txt&quot;</span>);</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">await</span> File.ReadAllTextAsync(<span class="string">&quot;e:/temp/2.txt&quot;</span>);</span><br><span class="line">        <span class="literal">default</span>:</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;numå‚æ•°ä¸æ­£ç¡®&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ²¡æœ‰async<br> <figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> Task <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> s1=<span class="keyword">await</span> ReadFileAsync(<span class="number">1</span>);</span><br><span class="line">    Console.WriteLine(s1);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">static</span> Task&lt;<span class="built_in">string</span>&gt; <span class="title">ReadFileAsync</span>(<span class="params"><span class="built_in">int</span> num</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">switch</span> (num)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> File.ReadAllTextAsync(<span class="string">&quot;e:/temp/1.txt&quot;</span>);</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> File.ReadAllTextAsync(<span class="string">&quot;e:/temp/2.txt&quot;</span>);</span><br><span class="line">        <span class="literal">default</span>:</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException(<span class="string">&quot;numå‚æ•°ä¸æ­£ç¡®&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>åŒºåˆ«ï¼š<br>ç”±äºReadFileAsyncæ–¹æ³•æ²¡æœ‰ç”¨asyncå…³é”®å­—ä¿®é¥°ï¼Œå› æ­¤æˆ‘ä»¬æ²¡æœ‰çœ‹åˆ°ReadFileAsyncæ–¹æ³•çš„ä»£ç ç¼–è¯‘ç”Ÿæˆçš„ç±»ï¼ŒReadFileAsyncå†…éƒ¨ä¹Ÿä¸åƒasyncæ–¹æ³•é‚£æ ·å¤æ‚ï¼Œè€Œåªæ˜¯ç®€å•åœ°è°ƒç”¨File.ReadAllTextAsyncæ–¹æ³•ã€‚ReadFileAsyncæ–¹æ³•æ²¡æœ‰ç¼–è¯‘ç”Ÿæˆç±»ï¼Œå› æ­¤ä¸ä¼šå¢åŠ ç¨‹åºé›†çš„å°ºå¯¸ï¼Œè€Œä¸”è¿è¡Œæ•ˆç‡æ›´é«˜ã€‚å› æ­¤ï¼Œå¦‚æœä¸€ä¸ªå¼‚æ­¥æ–¹æ³•åªæ˜¯å¯¹åˆ«çš„å¼‚æ­¥æ–¹æ³•è¿›è¡Œç®€å•çš„è°ƒç”¨ï¼Œå¹¶æ²¡æœ‰å¤ªå¤šå¤æ‚çš„é€»è¾‘ï¼Œæ¯”å¦‚è·å–å¼‚æ­¥æ–¹æ³•çš„è¿”å›å€¼åå†åšè¿›ä¸€æ­¥çš„å¤„ç†ï¼Œå°±å¯ä»¥å»æ‰asyncã€awaitå…³é”®å­—ã€‚</p><h2 id="ä¸è¦ç”¨sleep"><a href="#ä¸è¦ç”¨sleep" class="headerlink" title="ä¸è¦ç”¨sleep"></a>ä¸è¦ç”¨sleep</h2><p>å¦‚æœæƒ³åœ¨å¼‚æ­¥ç¼–ç¨‹æ–¹æ³•ä¸­æš‚åœä¸€æ®µæ—¶é—´ï¼Œä¸è¦ç”¨Thread.Sleep(),å› ä¸ºå®ƒä¼šé˜»å¡è°ƒç”¨çº¿ç¨‹ï¼Œè€Œè¦ç”¨await Task.Delay()ã€‚</p><p><img src="/img%5Cyouxin%5Casync.png"></p><h2 id="å°è£…ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•ï¼Œä¸‹è½½ç»™æŒ‡å®šç½‘å€ï¼Œå¦‚æœä¸‹è½½å¤±è´¥ï¼Œåˆ™ç¨ç­‰500mså†é‡è¯•ï¼Œå¦‚æœé‡è¯•ä¸‰æ¬¡ä»ç„¶å¤±è´¥ï¼Œåˆ™æŠ›å¼‚å¸¸â€œä¸‹è½½å¤±è´¥â€"><a href="#å°è£…ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•ï¼Œä¸‹è½½ç»™æŒ‡å®šç½‘å€ï¼Œå¦‚æœä¸‹è½½å¤±è´¥ï¼Œåˆ™ç¨ç­‰500mså†é‡è¯•ï¼Œå¦‚æœé‡è¯•ä¸‰æ¬¡ä»ç„¶å¤±è´¥ï¼Œåˆ™æŠ›å¼‚å¸¸â€œä¸‹è½½å¤±è´¥â€" class="headerlink" title="å°è£…ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•ï¼Œä¸‹è½½ç»™æŒ‡å®šç½‘å€ï¼Œå¦‚æœä¸‹è½½å¤±è´¥ï¼Œåˆ™ç¨ç­‰500mså†é‡è¯•ï¼Œå¦‚æœé‡è¯•ä¸‰æ¬¡ä»ç„¶å¤±è´¥ï¼Œåˆ™æŠ›å¼‚å¸¸â€œä¸‹è½½å¤±è´¥â€"></a>å°è£…ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•ï¼Œä¸‹è½½ç»™æŒ‡å®šç½‘å€ï¼Œå¦‚æœä¸‹è½½å¤±è´¥ï¼Œåˆ™ç¨ç­‰500mså†é‡è¯•ï¼Œå¦‚æœé‡è¯•ä¸‰æ¬¡ä»ç„¶å¤±è´¥ï¼Œåˆ™æŠ›å¼‚å¸¸â€œä¸‹è½½å¤±è´¥â€</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span> sum = <span class="keyword">await</span> ReadFileAsync(<span class="string">&quot;http://www.baidu.com&quot;</span>);</span><br><span class="line">        Console.WriteLine(sum);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">public</span> <span class="keyword">async</span> Task&lt;<span class="built_in">string</span>&gt; <span class="title">ReadFileAsync</span>(<span class="params"><span class="built_in">string</span> url, <span class="built_in">int</span> <span class="keyword">init</span>=<span class="number">0</span></span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">using</span> (<span class="keyword">var</span> httpClient = <span class="keyword">new</span> HttpClient())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">var</span> html = <span class="keyword">await</span> httpClient.GetStringAsync(url);</span><br><span class="line">                <span class="keyword">return</span> html;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Exception e)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">init</span>++;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">init</span> &gt;= <span class="number">3</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">&quot;è¯·æ±‚å¤±è´¥&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">await</span> Task.Delay(<span class="number">5000</span>);</span><br><span class="line">            <span class="keyword">await</span> ReadFileAsync(url, <span class="keyword">init</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;ä¸‹è½½å¤±è´¥&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="ç”¨äºè·å¾—æå‰ç»ˆæ­¢æ‰§è¡Œçš„ä¿¡å·"><a href="#ç”¨äºè·å¾—æå‰ç»ˆæ­¢æ‰§è¡Œçš„ä¿¡å·" class="headerlink" title="ç”¨äºè·å¾—æå‰ç»ˆæ­¢æ‰§è¡Œçš„ä¿¡å·"></a>ç”¨äºè·å¾—æå‰ç»ˆæ­¢æ‰§è¡Œçš„ä¿¡å·</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    CancellationTokenSource cts = <span class="keyword">new</span> CancellationTokenSource();</span><br><span class="line">    cts.CancelAfter(<span class="number">3000</span>);</span><br><span class="line">    CancellationToken cToken= cts.Token;</span><br><span class="line">    <span class="keyword">await</span> DownLoadAsync(<span class="string">&quot;http://www.baidu.com&quot;</span>, <span class="number">10</span>,cts.Token);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task <span class="title">DownLoadAsync</span>(<span class="params"><span class="built_in">string</span> url, <span class="built_in">int</span> n, CancellationToken cancellationToken</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">using</span> (HttpClient client = <span class="keyword">new</span> HttpClient())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">string</span> html = <span class="keyword">await</span> client.GetStringAsync(url);</span><br><span class="line">            Console.WriteLine(<span class="string">$&quot;<span class="subst">&#123;DateTime.Now&#125;</span>:<span class="subst">&#123;html&#125;</span>&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (cancellationToken.IsCancellationRequested)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;è¯·æ±‚è¢«å–æ¶ˆ&quot;</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>CancellationTokenSource:å‘ CancellationToken å‘å‡ºåº”å–æ¶ˆçš„ä¿¡å·ã€‚<br>CancelAfter:åœ¨æ­¤ CancellationTokenSource ä¸Šè®¡åˆ’å–æ¶ˆæ“ä½œã€‚<br>CancellationToken:ä¼ æ’­åº”å–æ¶ˆä½œçš„é€šçŸ¥ã€‚<br>IsCancellationRequested:è·å–æ˜¯å¦å·²ä¸ºæ­¤ä»¤ç‰Œè¯·æ±‚å–æ¶ˆã€‚</p></blockquote><h2 id="whenAll"><a href="#whenAll" class="headerlink" title="whenAll"></a>whenAll</h2><p>åˆ›å»ºä¸€ä¸ªä»»åŠ¡ï¼Œè¯¥ä»»åŠ¡å°†åœ¨æ‰€æœ‰æä¾›çš„ä»»åŠ¡å®Œæˆæ—¶å®Œæˆã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//Task&lt;string&gt; t1= File.ReadAllTextAsync(@&quot;E:\temp\1.txt&quot;);</span></span><br><span class="line">    <span class="comment">//Task&lt;string&gt; t2 = File.ReadAllTextAsync(@&quot;E:\temp\2.txt&quot;);</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//string[] strs = await Task.WhenAll(t1, t2);</span></span><br><span class="line">    <span class="comment">//string a1= strs[0];</span></span><br><span class="line">    <span class="comment">//string a2 = strs[1];</span></span><br><span class="line">    <span class="comment">//Console.WriteLine(a1);</span></span><br><span class="line">    <span class="comment">//Console.WriteLine(a2);</span></span><br><span class="line">    <span class="built_in">string</span>[] files=Directory.GetFiles(<span class="string">@&quot;E:\temp&quot;</span>);</span><br><span class="line">    Task&lt;<span class="built_in">int</span>&gt;[] countTasks=<span class="keyword">new</span> Task&lt;<span class="built_in">int</span>&gt;[files.Length];</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; files.Length; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> filename = files[i];</span><br><span class="line">        Task&lt;<span class="built_in">int</span>&gt; t= ReadCharsCount(filename);</span><br><span class="line">        countTasks[i] = t;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">int</span>[] counts=<span class="keyword">await</span> Task.WhenAll(countTasks);</span><br><span class="line">    <span class="built_in">int</span> c=counts.Sum();<span class="comment">//æ±‚å’Œ</span></span><br><span class="line">    Console.WriteLine(c);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task&lt;<span class="built_in">int</span>&gt; <span class="title">ReadCharsCount</span>(<span class="params"><span class="built_in">string</span> filename</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> s=<span class="keyword">await</span> File.ReadAllTextAsync(filename);</span><br><span class="line">    <span class="keyword">return</span> s.Length;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>GetFiles:è¿”å›æ»¡è¶³æŒ‡å®šæ¡ä»¶çš„æ–‡ä»¶çš„åç§°ã€‚<br>Directory:å…¬å¼€ç”¨äºé€šè¿‡ç›®å½•å’Œå­ç›®å½•è¿›è¡Œåˆ›å»ºã€ç§»åŠ¨å’Œæšä¸¾çš„é™æ€æ–¹æ³•ã€‚ æ­¤ç±»ä¸èƒ½è¢«ç»§æ‰¿ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> NET </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ASP.NET Core </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Web-APIäº‹ä»¶</title>
      <link href="/2025/03/08/JavaScript/%E4%BA%8B%E4%BB%B6/"/>
      <url>/2025/03/08/JavaScript/%E4%BA%8B%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="äº‹ä»¶ç›‘å¬"><a href="#äº‹ä»¶ç›‘å¬" class="headerlink" title="äº‹ä»¶ç›‘å¬"></a>äº‹ä»¶ç›‘å¬</h1><p>ç†è§£äº‹ä»¶ç›‘å¬çš„åŸºæœ¬æ¦‚å¿µ</p><p>äº‹ä»¶ç›‘å¬æ˜¯åŸºäºDOMèŠ‚ç‚¹çš„äº‹ä»¶å¤„ç†æœºåˆ¶ï¼Œå…è®¸åœ¨ç‰¹å®šæ¡ä»¶ä¸‹è§¦å‘ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ã€‚<br>å­¦ä¹ äº‹ä»¶ç›‘å¬çš„ä¸‰è¦ç´ </p><p>è§¦å‘æºï¼šäº‹ä»¶å‘ç”Ÿçš„åŸå› æˆ–æ¡ä»¶ã€‚ä¾‹å¦‚ï¼Œâ€œclickâ€äº‹ä»¶è¡¨ç¤ºæŒ‰é’®è¢«ç‚¹å‡»ã€‚<br>è§¦å‘å™¨ï¼šå…·ä½“è§¦å‘äº‹ä»¶çš„é‚£ä¸ªDOMèŠ‚ç‚¹ã€‚ä¾‹å¦‚ï¼Œåœ¨document.getElementById(â€˜myButtonâ€™)ä¸­ï¼Œâ€™myButtonâ€™æ˜¯è§¦å‘å™¨ã€‚<br>ç›‘å¬æ“ä½œè€…ï¼šå“åº”ç‰¹å®šäº‹ä»¶çš„ä»£ç æˆ–å‡½æ•°ã€‚ä¾‹å¦‚ï¼Œç»‘å®šåœ¨â€œclickâ€äº‹ä»¶ä¸Šçš„å›è°ƒå‡½æ•°ã€‚<br>å®è·µå®ç°äº‹ä»¶ç›‘å¬</p><p>åˆ›å»ºä¸€ä¸ªæŒ‰é’®å…ƒç´ å¹¶ç»‘å®šäº‹ä»¶ç›‘å¬ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myButton = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;myButton&#x27;</span>);</span><br><span class="line">myButton.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æŒ‰é’®è¢«ç‚¹å‡»äº†ï¼&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="é¼ æ ‡äº‹ä»¶"><a href="#é¼ æ ‡äº‹ä»¶" class="headerlink" title="é¼ æ ‡äº‹ä»¶"></a>é¼ æ ‡äº‹ä»¶</h2><p>clickäº‹ä»¶ï¼š</p><p>è§¦å‘æ¡ä»¶ï¼šç”¨æˆ·ç‚¹å‡»æŒ‰é’®ã€é“¾æ¥æˆ–å…¶ä»–å…ƒç´ ã€‚<br>åº”ç”¨åœºæ™¯ï¼šå®ç°æŒ‰é’®ç‚¹å‡»åŠŸèƒ½ã€ç½‘é¡µå¯¼èˆªç­‰ã€‚</p><p>doubleClickäº‹ä»¶ï¼š</p><p>è§¦å‘æ¡ä»¶ï¼šç”¨æˆ·åŒå‡»æŒ‰é’®æˆ–å…ƒç´ ã€‚<br>åº”ç”¨åœºæ™¯ï¼šåœ¨éœ€è¦åŒºåˆ†å•å‡»å’ŒåŒå‡»çš„åœºæ™¯ä¸­ä½¿ç”¨ï¼Œå¦‚æŸäº›æŒ‰é’®è®¾è®¡è¦æ±‚ä¸åŒçš„æ“ä½œååº”ã€‚</p><p>mousedownã€mouseupã€mouseupäº‹ä»¶ï¼š</p><p>è§¦å‘æ¡ä»¶ï¼šé”®ç›˜æŒ‰ä¸‹ã€ä¿æŒæŒ‰å‹ä»¥åŠé‡Šæ”¾é”®ã€‚<br>åº”ç”¨åœºæ™¯ï¼šå¤„ç†é”®ç›˜å¿«æ·é”®æ“ä½œæˆ–ç‰¹å®šçš„è¾“å…¥äº‹ä»¶ã€‚</p><p>mousemoveå’Œmouseleaveäº‹ä»¶ï¼š</p><p>è§¦å‘æ¡ä»¶ï¼šé¼ æ ‡æ‚¬åœåœ¨æˆ–ç¦»å¼€æŸä¸ªå…ƒç´ ä¸Šã€‚<br>åº”ç”¨åœºæ™¯ï¼šæ˜¾ç¤ºæç¤ºæ¡†ã€çªå‡ºæ˜¾ç¤ºç›®æ ‡å…ƒç´ ç­‰ã€‚</p><p>mouseupäº‹ä»¶ï¼š</p><p>è§¦å‘æ¡ä»¶ï¼šç”¨æˆ·ä»é”®ç›˜ä¸Šé‡Šæ”¾æŒ‰é’®ã€‚<br>åº”ç”¨åœºæ™¯ï¼šé€‚åˆå¤„ç†éœ€è¦åœ¨ç‰¹å®šé”®é‡Šæ”¾åæ‰§è¡Œçš„æ“ä½œï¼Œå¦‚åŠ è½½å›¾ç‰‡æˆ–åˆå§‹åŒ–æŸäº›åŠŸèƒ½ã€‚<br>é€šè¿‡ç»‘å®šè¿™äº›é¼ æ ‡äº‹ä»¶å’Œå›è°ƒå‡½æ•°ï¼Œå¯ä»¥å®ç°å¤šç§ç”¨æˆ·äº¤äº’æ•ˆæœã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> button = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;myButton&#x27;</span>);</span><br><span class="line">button.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&#x27;æŒ‰é’®è¢«ç‚¹å‡»äº†ï¼&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">button.<span class="title function_">addEventListener</span>(<span class="string">&#x27;doubleClick&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&#x27;æŒ‰é’®è¢«åŒå‡»äº†ï¼&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¿™æ ·ï¼Œç‚¹å‡»æŒ‰é’®æ—¶ä¼šæ˜¾ç¤ºâ€œæŒ‰é’®è¢«ç‚¹å‡»äº†ï¼â€ï¼Œè€ŒåŒå‡»åˆ™æ˜¾ç¤ºâ€œæŒ‰é’®è¢«åŒå‡»äº†ï¼â€ã€‚</p><h2 id="ç„¦ç‚¹äº‹ä»¶"><a href="#ç„¦ç‚¹äº‹ä»¶" class="headerlink" title="ç„¦ç‚¹äº‹ä»¶"></a>ç„¦ç‚¹äº‹ä»¶</h2><p>ç„¦ç‚¹äº‹ä»¶ç±»å‹<br>ç„¦ç‚¹å¼€å§‹ï¼ˆfocusï¼‰ï¼š</p><p>è§¦å‘æ¡ä»¶ï¼šç”¨æˆ·ç‚¹å‡»æŸä¸ªå…ƒç´ å¹¶å¼€å§‹ç¼–è¾‘å®ƒã€‚<br>åº”ç”¨åœºæ™¯ï¼šçªå‡ºæ˜¾ç¤ºç›®æ ‡å…ƒç´ ï¼Œå¦‚åœ¨æ–‡æœ¬æ¡†ä¸ŠæŒ‰ä¸‹å›è½¦é”®æ—¶ï¼Œå…‰æ ‡ä¼šç§»è‡³å½“å‰å­—æ®µã€‚</p><p>ç„¦ç‚¹ç»“æŸï¼ˆblurï¼‰ï¼š</p><p>è§¦å‘æ¡ä»¶ï¼šç”¨æˆ·å®Œæˆååœæ­¢å¯¹å®ƒçš„ç¼–è¾‘æˆ–è€…é€€å‡ºé¡µé¢ã€‚<br>åº”ç”¨åœºæ™¯ï¼šå–æ¶ˆé«˜äº®æ˜¾ç¤ºï¼Œä¾‹å¦‚åœ¨è¾“å…¥å­—æ®µæœ«å°¾æŒ‰å›è½¦é”®åï¼Œå…‰æ ‡ä¼šç§»åˆ°ä¸‹ä¸ªå­—æ®µæˆ–é¡µé¢çš„æŸä¸ªåœ°æ–¹ã€‚</p><p>ç„¦ç‚¹æœ‰æ•ˆæ€§ï¼ˆvalidï¼‰ï¼š</p><p>è§¦å‘æ¡ä»¶ï¼šç„¦ç‚¹ä¸¢å¤±å‰æ£€æŸ¥å…ƒç´ æ˜¯å¦ä¾ç„¶æœ‰æ•ˆã€‚<br>åº”ç”¨åœºæ™¯ï¼šåœ¨è¡¨å•æäº¤æ—¶ï¼Œç¡®ä¿æ‰€æœ‰å­—æ®µéƒ½å·²å¡«å†™å®Œæ•´å¹¶æœ‰æ•ˆã€‚</p><p>ä½¿ç”¨ç„¦ç‚¹äº‹ä»¶<br>é€šè¿‡ç»‘å®šè¿™äº›äº‹ä»¶ï¼Œå¯ä»¥å®ç°å¤šç§ç”¨æˆ·äº¤äº’æ•ˆæœã€‚ä¾‹å¦‚ï¼š</p><p>ç¤ºä¾‹ 1ï¼šé»˜è®¤çš„ç„¦ç‚¹æ ·å¼</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;textInput&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ 2ï¼šç»‘å®šç„¦ç‚¹å¼€å§‹äº‹ä»¶</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> input = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;textInput&#x27;</span>);</span><br><span class="line">input.<span class="title function_">addEventListener</span>(<span class="string">&#x27;focus&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">backgroundColor</span> = <span class="string">&#x27;#ff99cc&#x27;</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ 3ï¼šç»‘å®šç„¦ç‚¹ç»“æŸäº‹ä»¶</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> input = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;textInput&#x27;</span>);</span><br><span class="line">input.<span class="title function_">addEventListener</span>(<span class="string">&#x27;blur&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">backgroundColor</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ 4ï¼šç»‘å®šç„¦ç‚¹æœ‰æ•ˆæ€§äº‹ä»¶</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> input = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;textInput&#x27;</span>);</span><br><span class="line">input.<span class="title function_">addEventListener</span>(<span class="string">&#x27;valid&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">style</span>.<span class="property">backgroundColor</span> = <span class="string">&#x27;#ff99cc&#x27;</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>æ³¨æ„äº‹é¡¹<br>å…¼å®¹æ€§ï¼šä¸åŒæµè§ˆå™¨å¯¹ç„¦ç‚¹äº‹ä»¶çš„æ”¯æŒå¯èƒ½å­˜åœ¨å·®å¼‚ã€‚ç¡®ä¿åœ¨å¤šæµè§ˆå™¨ç¯å¢ƒä¸­æµ‹è¯•ä»£ç ã€‚<br>æ€§èƒ½ï¼šé¢‘ç¹ç»‘å®šå’Œå–æ¶ˆäº‹ä»¶ç›‘å¬å¯èƒ½ä¼šå½±å“æ€§èƒ½ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤§é‡å…ƒç´ åŒæ—¶æ‹¥æœ‰ç„¦ç‚¹çš„æƒ…å†µä¸‹ã€‚</p><h1 id="é”®ç›˜äº‹ä»¶"><a href="#é”®ç›˜äº‹ä»¶" class="headerlink" title="é”®ç›˜äº‹ä»¶"></a>é”®ç›˜äº‹ä»¶</h1><p>ä¸ºäº†å®ç°ç”¨æˆ·ç‚¹å‡»æŒ‰é’®åï¼Œåœ¨çŸ­æ—¶é—´å†…æ˜¾ç¤ºè¾“å…¥å­—æ®µçš„å€¼å¹¶æŒç»­å‡ ç§’çš„æ•ˆæœï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨é”®ç›˜äº‹ä»¶å’ŒsetIntervalå‡½æ•°ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†çš„æ­¥éª¤ï¼š</p><p>åˆ›å»ºHTMLç»“æ„ï¼š<br>åˆ›å»ºä¸€ä¸ªç®€å•çš„ç½‘é¡µï¼ŒåŒ…å«ä¸€ä¸ªæ–‡æœ¬è¾“å…¥æ¡†å’Œä¸€ä¸ªæŒ‰é’®ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;textInput&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;showInput()&quot;</span>&gt;</span>ç‚¹å‡»æˆ‘çœ‹çœ‹<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç»‘å®šé”®ç›˜äº‹ä»¶ï¼š<br>ä½¿ç”¨addEventListenerç»‘å®škeydownäº‹ä»¶åˆ°è¾“å…¥å­—æ®µã€‚åœ¨äº‹ä»¶å¤„ç†å‡½æ•°ä¸­ï¼Œè·å–ç”¨æˆ·å½“å‰è¾“å…¥çš„å€¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;textInput&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;keydown&#x27;</span>, <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> input = <span class="variable language_">this</span>;</span><br><span class="line">    input.<span class="property">value</span> += e.<span class="property">key</span>; <span class="comment">// ä¾‹å¦‚åŠ ç²—ç©ºæ ¼é”®ä¼šå¢åŠ ä¸€ä¸ªç©ºæ ¼</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ç»‘å®šæŒ‰é’®ç‚¹å‡»äº‹ä»¶ï¼š<br>åœ¨æŒ‰é’®çš„onclickäº‹ä»¶ä¸­ï¼Œè°ƒç”¨æ–°çš„å‡½æ•°showInput()ï¼Œè¯¥å‡½æ•°è´Ÿè´£æ˜¾ç¤ºå½“å‰è¾“å…¥å€¼å¹¶è®¾ç½®æ—¶é—´é—´éš”ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;button&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, showInput);</span><br></pre></td></tr></table></figure><p>å®ç°å³æ—¶åé¦ˆï¼š<br>åˆ›å»ºä¸€ä¸ªåä¸ºshowInputçš„å‡½æ•°ï¼Œå®ƒä¼šä½¿ç”¨setIntervalæ¯éš”1ç§’è°ƒç”¨è‡ªå·±ä»¥æ›´æ–°å’Œæ˜¾ç¤ºè¾“å…¥å†…å®¹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">showInput</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> input = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;textInput&#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> inputValue = input.<span class="property">value</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">updateInput</span>(<span class="params"></span>) &#123;</span><br><span class="line">        input.<span class="property">value</span> = inputValue;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">// è®¾ç½®æ—¶é—´é—´éš”ä¸º1000æ¯«ç§’ï¼Œä¹Ÿå°±æ˜¯1ç§’</span></span><br><span class="line">            <span class="built_in">setInterval</span>(updateInput, <span class="number">1000</span>);</span><br><span class="line">        &#125;, <span class="number">50</span>); <span class="comment">// æ¯æ¬¡æ›´æ–°åç­‰å¾…50msï¼Œé¿å…é¢‘ç¹è°ƒç”¨å¯¼è‡´æ€§èƒ½é—®é¢˜</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">updateInput</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®Œæ•´çš„è„šæœ¬ï¼š<br>å°†ä¸Šè¿°æ­¥éª¤æ•´åˆåˆ°ä¸€ä¸ªJavaScriptæ–‡ä»¶ä¸­ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;textInput&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;keydown&#x27;</span>, <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> input = <span class="variable language_">this</span>;</span><br><span class="line">    input.<span class="property">value</span> += e.<span class="property">key</span>; <span class="comment">// æ·»åŠ è¾“å…¥å­—ç¬¦</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;button&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, showInput);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showInput</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> input = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;textInput&#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> inputValue = input.<span class="property">value</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">updateInput</span>(<span class="params"></span>) &#123;</span><br><span class="line">        input.<span class="property">value</span> = inputValue;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">setInterval</span>(updateInput, <span class="number">1000</span>);</span><br><span class="line">        &#125;, <span class="number">50</span>); <span class="comment">// ç­‰å¾…50msåè®¾ç½®é—´éš”</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">updateInput</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œæµ‹è¯•ï¼š</p><p>æ‰“å¼€HTMLæ–‡ä»¶ã€‚<br>ç”¨æˆ·è¾“å…¥ä¸€äº›å­—ç¬¦ï¼Œä¾‹å¦‚â€œHelloâ€ç„¶åå›è½¦ã€‚<br>ç‚¹å‡»æŒ‰é’®â€œç‚¹å‡»æˆ‘çœ‹çœ‹â€ï¼Œåº”è¯¥çœ‹åˆ°è¾“å…¥å­—æ®µåœ¨1ç§’å†…è‡ªåŠ¨æ›´æ–°å¹¶æ˜¾ç¤ºâ€œHelloâ€ã€‚<br>ä¼˜åŒ–æ€§èƒ½ï¼š<br>åœ¨æ¯æ¬¡è°ƒç”¨setIntervalæ—¶è®¾ç½®ä¸€ä¸ª50æ¯«ç§’çš„å»¶è¿Ÿï¼Œé¿å…é¢‘ç¹è°ƒç”¨å¯¼è‡´æµè§ˆå™¨æ€§èƒ½é—®é¢˜ã€‚</p><p>æµ‹è¯•å¼‚å¸¸æƒ…å†µï¼š</p><p>æ£€æŸ¥å¤šä¸ªç”¨æˆ·çš„è¿ç»­è¾“å…¥æ˜¯å¦ä¼šç´¯ç§¯å½±å“é—´éš”ã€‚<br>ç¡®ä¿å³ä½¿åœ¨è¾“å…¥åœæ­¢åï¼Œæ—¶é—´é—´éš”ä¹Ÿèƒ½æ­£ç¡®é‡Šæ”¾ã€‚</p><h1 id="æ–‡æœ¬äº‹ä»¶"><a href="#æ–‡æœ¬äº‹ä»¶" class="headerlink" title="æ–‡æœ¬äº‹ä»¶"></a>æ–‡æœ¬äº‹ä»¶</h1><p>æ–‡æœ¬äº‹ä»¶ç±»å‹<br>æ ¹æ®MDNWeb Docsï¼ŒtextEvents æ¥å£å®šä¹‰äº†ä»¥ä¸‹å››ç§äº‹ä»¶ï¼š</p><p>focusï¼š</p><p>è§¦å‘æ¡ä»¶ï¼šå½“æŸä¸ªå…ƒç´ çš„ç„¦ç‚¹è¢«è·å–ï¼ˆå³ç”¨æˆ·ç‚¹å‡»è¯¥å…ƒç´ ï¼‰ã€‚<br>ç”¨é€”ï¼šåœ¨å•ä¸ªæ–‡æœ¬è¾“å…¥å­—æ®µä¸­å¿«é€Ÿåˆ‡æ¢ç„¦ç‚¹ã€‚<br>blurï¼š</p><p>è§¦å‘æ¡ä»¶ï¼šå½“æŸä¸ªå…ƒç´ çš„æ¨¡ç³Šæ¡†æ¶ˆå¤±æˆ–ç„¦ç‚¹ç¦»å¼€æ—¶ã€‚<br>ç”¨é€”ï¼šåœ¨å•ä¸ªæ–‡æœ¬è¾“å…¥å­—æ®µä¸­å¿«é€Ÿå–æ¶ˆç„¦ç‚¹ã€‚<br>inputï¼š</p><p>è§¦å‘æ¡ä»¶ï¼šå½“ç”¨æˆ·å¼€å§‹è¾“å…¥å­—ç¬¦ï¼ˆç©ºæ ¼é”®åä¼šç«‹å³æ¿€æ´»ï¼‰ã€‚<br>ç”¨é€”ï¼šæ•è·ç”¨æˆ·æ‰‹åŠ¨è¾“å…¥çš„å­—ç¬¦åºåˆ—ã€‚<br>outputï¼š</p><p>è§¦å‘æ¡ä»¶ï¼šå½“æ–‡æœ¬è¢«å¤åˆ¶åˆ°å‰ªè´´æ¿æˆ–è¾“å‡ºåˆ°æŒ‡å®šä½ç½®æ—¶ã€‚<br>ç”¨é€”ï¼šæ•è·ç”¨æˆ·ç²˜è´´çš„å†…å®¹ã€‚<br>å®é™…åº”ç”¨ç¤ºä¾‹<br>å‡è®¾æœ‰ä¸€ä¸ªç®€å•çš„HTMLé¡µé¢ï¼ŒåŒ…å«ä¸€ä¸ªæ–‡æœ¬è¾“å…¥æ¡†å’Œä¸€ä¸ªæŒ‰é’®ã€‚å½“ç”¨æˆ·ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œä½ ä¼šåœ¨è¾“å…¥å­—æ®µä¸­æ˜¾ç¤ºå½“å‰è¾“å…¥çš„å€¼ï¼Œå¹¶æ¯éš”ä¸€æ®µæ—¶é—´é‡å¤ä¸€æ¬¡æ•ˆæœï¼ˆå¦‚ä¸Šæ–‡ä¸­çš„â€œé”®ç›˜äº‹ä»¶â€éƒ¨åˆ†ï¼‰ã€‚è¿™é‡Œå¯ä»¥ä½¿ç”¨æ–‡æœ¬äº‹ä»¶æ¥å®ç°å³æ—¶åé¦ˆã€‚</p><p>åˆ›å»ºHTMLç»“æ„</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;zh-CN&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>æ–‡æœ¬äº‹ä»¶ç¤ºä¾‹<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;textInput&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;è¾“å…¥æ‚¨çš„å†…å®¹...&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;showText()&quot;</span>&gt;</span>æ˜¾ç¤ºæ–‡æœ¬<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åˆ›å»ºJavaScriptè„šæœ¬</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;textInput&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;input&#x27;</span>, showText);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showText</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> text = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;textInput&#x27;</span>);</span><br><span class="line">    <span class="comment">// ä½¿ç”¨setIntervalæ¯éš”1ç§’è°ƒç”¨å‡½æ•°</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">updateText</span>(<span class="params"></span>) &#123;</span><br><span class="line">        text.<span class="property">value</span> += <span class="string">&#x27; è¾“å…¥å†…å®¹ï¼š&#x27;</span>;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">setInterval</span>(updateText, <span class="number">500</span>);</span><br><span class="line">        &#125;, <span class="number">50</span>); <span class="comment">// æ¯æ¬¡æ›´æ–°åç­‰å¾…50msï¼Œé¿å…é¢‘ç¹è°ƒç”¨å¯¼è‡´æ€§èƒ½é—®é¢˜</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">updateText</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> å®Œæ•´ä»£ç <br>å°†ä¸Šè¿°æ­¥éª¤æ•´åˆåˆ°ä¸€ä¸ªå®Œæ•´çš„JavaScriptæ–‡ä»¶ä¸­ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;textInput&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;input&#x27;</span>, showText);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showText</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> text = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;textInput&#x27;</span>);</span><br><span class="line">    <span class="comment">// ä½¿ç”¨setIntervalæ¯éš”1ç§’è°ƒç”¨å‡½æ•°</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">updateText</span>(<span class="params"></span>) &#123;</span><br><span class="line">        text.<span class="property">value</span> += <span class="string">&#x27; è¾“å…¥å†…å®¹ï¼š&#x27;</span>;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="built_in">setInterval</span>(updateText, <span class="number">50</span>); <span class="comment">// æ¯æ¬¡æ›´æ–°åç­‰å¾…50msï¼Œé¿å…é¢‘ç¹è°ƒç”¨å¯¼è‡´æ€§èƒ½é—®é¢˜</span></span><br><span class="line">        &#125;, <span class="number">50</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">updateText</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–äº‹ä»¶ç›‘å¬</span></span><br><span class="line"><span class="title function_">showText</span>();</span><br></pre></td></tr></table></figure><p> æµ‹è¯•æ•ˆæœ<br>ç”¨æˆ·è¾“å…¥ä¸€äº›å­—ç¬¦ï¼ˆä¾‹å¦‚â€œHelloâ€ï¼‰ï¼Œç„¶åæŒ‰å›è½¦é”®ã€‚<br>ç‚¹å‡»æŒ‰é’®ï¼Œâ€œæ˜¾ç¤ºæ–‡æœ¬â€æŒ‰é’®ç‚¹å‡»æ—¶ï¼Œä¼šåœ¨è¾“å…¥å­—æ®µä¸­çœ‹åˆ°å³æ—¶åé¦ˆï¼Œå¹¶æ¯éš”1ç§’é‡å¤ä¸€æ¬¡ã€‚</p><h1 id="äº‹ä»¶å¯¹è±¡"><a href="#äº‹ä»¶å¯¹è±¡" class="headerlink" title="äº‹ä»¶å¯¹è±¡"></a>äº‹ä»¶å¯¹è±¡</h1><p>è·å–äº‹ä»¶å¯¹è±¡çš„æ­¥éª¤<br>æ•è·äº‹ä»¶ï¼š<br>ä½¿ç”¨é€‚å½“çš„äº‹ä»¶ç›‘å¬å™¨æ¥æ•è·ç‰¹å®šç±»å‹çš„äº‹ä»¶ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ onInputã€onClick ç­‰å›è°ƒå‡½æ•°ã€‚</p><p>ä¼ é€’äº‹ä»¶å¯¹è±¡åˆ°å›è°ƒå‡½æ•°ï¼š<br>å½“äº‹ä»¶å‘ç”Ÿæ—¶ï¼ŒJavaScript ä¼šå°†ä¸€ä¸ªåŒ…å«äº‹ä»¶ä¿¡æ¯çš„å®ä¾‹ä¼ é€’ç»™ç»‘å®šçš„å›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ã€‚è¿™ä¸ªå‚æ•°å³ä¸ºäº‹ä»¶å¯¹è±¡ã€‚</p><p>è®¿é—®äº‹ä»¶å±æ€§ï¼š<br>ä½¿ç”¨äº‹ä»¶å¯¹è±¡çš„æ–¹æ³•å’Œå±æ€§æ¥è·å–äº‹ä»¶çš„å…·ä½“ä¿¡æ¯ã€‚</p><p>ç¤ºä¾‹ï¼šä½¿ç”¨é”®ç›˜äº‹ä»¶è·å–äº‹ä»¶å¯¹è±¡<br>å‡è®¾ä½ æœ‰ä¸€ä¸ª keydown äº‹ä»¶ç›‘å¬å™¨ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">handleKeyPress</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// e æ˜¯ä¸€ä¸ªé”®ç›˜äº‹ä»¶å¯¹è±¡ï¼ŒåŒ…å«ä»¥ä¸‹å±æ€§ï¼š</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æŒ‰ä¸‹é”®çš„å­—ç¬¦ï¼š&#x27;</span>, e.<span class="property">key</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æŒ‰ä¸‹é”®çš„æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ï¼š&#x27;</span>, e.<span class="property">time</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æŒ‰ä¸‹é”®çš„Unicodeç ç‚¹ï¼š&#x27;</span>, eunicodeCodePoint);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>const input &#x3D; document.getElementById(â€˜inputâ€™);<br>input.addEventListener(â€˜keydownâ€™, handleKeyPress);<br>ç¤ºä¾‹ï¼šä½¿ç”¨æ–‡æœ¬äº‹ä»¶è·å–äº‹ä»¶å¯¹è±¡<br>å‡è®¾ä½ æœ‰ä¸€ä¸ª textInput çš„è¾“å…¥å­—æ®µï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;textInput&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;input&#x27;</span>, handleInput);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleInput</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="comment">// e æ˜¯ä¸€ä¸ª TextEvent å¯¹è±¡ï¼ŒåŒ…å«ä»¥ä¸‹å±æ€§ï¼š</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;å½“å‰è¾“å…¥å†…å®¹ä¸ºï¼š&#x27;</span>, e.<span class="property">target</span>.<span class="property">value</span>);  <span class="comment">// è¾“å‡ºå½“å‰æ˜¾ç¤ºçš„æ–‡æœ¬å†…å®¹</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;è§¦å‘äº‹ä»¶çš„æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ï¼š&#x27;</span>, e.<span class="property">time</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;äº‹ä»¶æ¥æºçš„DOMå…ƒç´ ï¼š&#x27;</span>, e.<span class="property">target</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è·å–äº‹ä»¶å¯¹è±¡çš„æ–¹æ³•<br>é€šè¿‡å›è°ƒå‡½æ•°ä¼ é€’äº‹ä»¶å¯¹è±¡ï¼š<br>åœ¨å›è°ƒå‡½æ•°ä¸­ï¼Œäº‹ä»¶å‚æ•°å³ä¸ºäº‹ä»¶å¯¹è±¡ã€‚ä½ å¯ä»¥ç›´æ¥ä½¿ç”¨å®ƒæ¥è®¿é—®ç›¸å…³çš„å±æ€§å’Œæ–¹æ³•ã€‚</p><p>åœ¨äº‹ä»¶ç›‘å¬å™¨ä¸­è·å–äº‹ä»¶å¯¹è±¡ï¼š<br>æœ‰äº›äº‹ä»¶ç›‘å¬å™¨çš„æ„é€ å‡½æ•°ï¼ˆç”¨äºåˆå§‹åŒ–äº‹ä»¶ï¼‰å¯ä»¥è¿”å›äº‹ä»¶å¯¹è±¡ã€‚ä¾‹å¦‚ï¼Œåœ¨ addEventListener ä¸­ï¼Œä¼ å…¥çš„å›è°ƒå‡½æ•°æœ¬èº«å°±æ˜¯ä¸€ä¸ªäº‹ä»¶ç›‘å¬å™¨ï¼Œå®ƒæ¥æ”¶å¹¶å¤„ç†è§¦å‘äº‹ä»¶æ—¶ç”Ÿæˆçš„äº‹ä»¶å®ä¾‹ã€‚</p><p>ç¤ºä¾‹ï¼šä½¿ç”¨äº‹ä»¶å±æ€§å’Œæ–¹æ³•<br>å‡è®¾ä½ æœ‰ä¸€ä¸ª click äº‹ä»¶ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> div = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">div.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ç‚¹å‡»ä½ç½®:&#x27;</span>, e.<span class="property">clientX</span>, <span class="string">&#x27;ï¼Œ&#x27;</span>ï¼Œe.<span class="property">clientY</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;è§¦å‘äº‹ä»¶çš„DOMå…ƒç´ :&#x27;</span>, e.<span class="property">target</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;äº‹ä»¶æ—¶é—´:&#x27;</span>, e.<span class="property">time</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>æ€»ç»“<br>é€šè¿‡åœ¨å›è°ƒå‡½æ•°ä¸­ä¼ é€’äº‹ä»¶å¯¹è±¡ï¼Œä½ å¯ä»¥åˆ©ç”¨ JavaScript æä¾›çš„å„ç§å±æ€§å’Œæ–¹æ³•æ¥è·å–å’Œåˆ†æä¸äº‹ä»¶ç›¸å…³çš„è¯¦ç»†ä¿¡æ¯ã€‚è¿™å¯¹äºç¼–å†™æ›´å¤æ‚çš„äº’åŠ¨åº”ç”¨éå¸¸æœ‰ç”¨ã€‚</p><p>æ–‡æœ¬äº‹ä»¶ä¸­çš„äº‹ä»¶å¯¹è±¡æä¾›äº†ä»¥ä¸‹å¸¸ç”¨å±æ€§ï¼š</p><p>timeï¼š</p><p>è·å–äº‹ä»¶å‘ç”Ÿçš„æ¯«ç§’å€¼ã€‚<br>valueï¼ˆä»…é€‚ç”¨äº input äº‹ä»¶ï¼‰ï¼š</p><p>è¿”å›å½“å‰æ˜¾ç¤ºçš„æ–‡æœ¬å†…å®¹ã€‚<br>sourceElementï¼š</p><p>å¯¹åº”è§¦å‘äº‹ä»¶çš„å…·ä½“å…ƒç´ ï¼Œå¦‚ç‚¹å‡»æˆ–ç„¦ç‚¹å˜åŒ–æ—¶ä½¿ç”¨çš„å…ƒç´ ã€‚<br>blurEvent.sourceElementï¼š</p><p>å½“æ¨¡ç³Šæ¡†æ¶ˆå¤±æˆ–ç„¦ç‚¹ç¦»å¼€æ—¶çš„è§¦å‘å…ƒç´ ã€‚<br>textï¼ˆä»…é€‚ç”¨äº output äº‹ä»¶ï¼‰ï¼š</p><p>ç²˜è´´åˆ°å‰ªè´´æ¿çš„å†…å®¹ã€‚<br>è¿™äº›å±æ€§å¯ä»¥é€šè¿‡åœ¨å›è°ƒå‡½æ•°ä¸­ä¼ é€’äº‹ä»¶å¯¹è±¡æ¥è®¿é—®å’Œåˆ†æï¼Œä»è€Œå®ç°å¯¹æ–‡æœ¬è¾“å…¥ã€ç„¦ç‚¹ç®¡ç†å’Œè¾“å‡ºæ“ä½œçš„è¯¦ç»†ç›‘æ§å’Œå“åº”ã€‚</p><h1 id="ç¯å¢ƒå¯¹è±¡"><a href="#ç¯å¢ƒå¯¹è±¡" class="headerlink" title="ç¯å¢ƒå¯¹è±¡"></a>ç¯å¢ƒå¯¹è±¡</h1><p>ç›®æ ‡ï¼šèƒ½å¤Ÿåˆ†æåˆ¤æ–­è¿è¡Œåœ¨ä¸åŒç¯å¢ƒä¸­thisæ‰€æŒ‡ä»£çš„å¯¹è±¡</p><p>ç¯å¢ƒå¯¹è±¡ï¼šæŒ‡çš„æ˜¯å‡½æ•°å†…éƒ¨ç‰¹æ®Šçš„å˜é‡thisï¼Œå®ƒä»£è¡¨ç€å½“å‰å‡½æ•°è¿è¡Œæ—¶æ‰€å¤„çš„ç¯å¢ƒ</p><p>ä½œç”¨ï¼šå¼„æ¸…æ¥šthisçš„æŒ‡å‘ï¼Œå¯ä»¥è®©æˆ‘ä»¬ä»£ç æ›´ç®€æ´</p><h1 id="äº‹ä»¶æµ"><a href="#äº‹ä»¶æµ" class="headerlink" title="äº‹ä»¶æµ"></a>äº‹ä»¶æµ</h1><p>äº‹ä»¶æµï¼ˆEvent Flowï¼‰ æ˜¯ä¸€ç§ç¨‹åºæ‰§è¡Œçš„æ¨¡å¼ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤æ‚æ“ä½œæ—¶ã€‚å®ƒæ˜¯å°†ä»»åŠ¡åˆ†è§£ä¸ºä¸€ç³»åˆ—äº‹ä»¶çš„ä¼ é€’è·¯å¾„ï¼Œç¡®ä¿æ¯ä¸ªæ­¥éª¤æŒ‰é¡ºåºæ‰§è¡Œï¼Œå¹¶ä¸”èƒ½å¤Ÿæœ‰æ•ˆåœ°ç®¡ç†å¹¶è¡Œæ“ä½œã€‚</p><p>å®šä¹‰</p><p>äº‹ä»¶æµæŒ‡çš„æ˜¯åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼ŒæŒ‰ç…§ç‰¹å®šçš„é¡ºåºä¼ é€’äº‹ä»¶æˆ–ä»»åŠ¡ï¼Œä»¥ä¾¿å„ä¸ªéƒ¨åˆ†æŒ‰éœ€æ±‚å®Œæˆå…¶å·¥ä½œã€‚å®ƒé€šè¿‡å°†ä»»åŠ¡åˆ†è§£ä¸ºç‹¬ç«‹çš„äº‹ä»¶å¤„ç†ï¼Œä½¿ç¨‹åºæ›´åŠ çµæ´»å’Œæ˜“äºç®¡ç†ã€‚</p><p>æ ¸å¿ƒæ€æƒ³</p><p>é¡ºåºæ€§ï¼šæ¯ä¸ªäº‹ä»¶å¿…é¡»æŒ‰é¡ºåºæ‰§è¡Œã€‚<br>å¹¶è¡Œæ€§ï¼šå…è®¸åœ¨å®Œæˆå½“å‰äº‹ä»¶åï¼Œç«‹å³å¯åŠ¨ä¸‹ä¸€ä¸ªäº‹ä»¶ã€‚<br>å¯é¢„æµ‹æ€§ï¼šç¡®ä¿äº‹ä»¶ä¼ é€’çš„è·¯å¾„æ˜¯å·²çŸ¥ä¸”å›ºå®šçš„ã€‚</p><p>å·¥ä½œåŸç†</p><p>äº‹ä»¶æµå°†ä»»åŠ¡åˆ†è§£ä¸ºå¤šä¸ªé˜¶æ®µï¼Œæ¯ä¸ªé˜¶æ®µå¯¹åº”ä¸€ä¸ªäº‹ä»¶ã€‚ç¨‹åºæ ¹æ®äº‹ä»¶æµçš„é¡ºåºæ‰§è¡Œè¿™äº›é˜¶æ®µï¼Œç¡®ä¿æ¯ä¸ªé˜¶æ®µå®Œæˆåæ‰è¿›è¡Œä¸‹ä¸€é˜¶æ®µçš„æ“ä½œã€‚</p><p>åº”ç”¨åœºæ™¯</p><p>å¤æ‚ç³»ç»Ÿè®¾è®¡ï¼šåœ¨å¤„ç†å¤§é‡å¹¶è¡Œä»»åŠ¡æ—¶ï¼Œäº‹ä»¶æµèƒ½å¤Ÿæœ‰æ•ˆåœ°ç®¡ç†ä»»åŠ¡è°ƒåº¦ã€‚<br>ç”¨æˆ·ç•Œé¢ç¼–ç¨‹ï¼šç”¨äºåˆ†æ­¥å®Œæˆæ“ä½œï¼Œæé«˜ç”¨æˆ·ä½“éªŒã€‚<br>ç½‘ç»œè¯·æ±‚å¤„ç†ï¼šå°†é•¿ä»»åŠ¡åˆ†è§£ä¸ºå¤šä¸ªé˜¶æ®µï¼Œç¡®ä¿èµ„æºçš„é«˜æ•ˆåˆ©ç”¨ã€‚</p><p>ä¼˜åŠ¿</p><p>æå‡æ•ˆç‡ï¼šé€šè¿‡æ˜ç¡®çš„ä»»åŠ¡é¡ºåºï¼Œä¼˜åŒ–èµ„æºåˆ†é…ã€‚<br>å¢å¼ºçµæ´»æ€§ï¼šæ”¯æŒä»»åŠ¡çš„ä¸­æ–­å’Œæ¢å¤ã€‚<br>ç®€åŒ–ç®¡ç†ï¼šæ¯ä¸ªäº‹ä»¶ç‹¬ç«‹å¤„ç†ï¼Œä¾¿äºè°ƒè¯•å’Œç»´æŠ¤ã€‚</p><p>å®ç°æ–¹å¼</p><p>åœ¨ç¼–ç¨‹ä¸­ï¼Œå¯ä»¥ä½¿ç”¨å¾ªç¯æˆ–é€’å½’ç»“æ„æ¥æ¨¡æ‹Ÿäº‹ä»¶æµã€‚æ¯æ¬¡å®Œæˆä¸€ä¸ªé˜¶æ®µåï¼Œè‡ªåŠ¨å¯åŠ¨ä¸‹ä¸€ä¸ªé˜¶æ®µï¼Œç›´åˆ°æ‰€æœ‰ä»»åŠ¡å®Œæˆã€‚</p><p>æ€»ç»“</p><p>äº‹ä»¶æµæ˜¯ä¸€ç§é«˜æ•ˆçš„ç¨‹åºè®¾è®¡æ¨¡å¼ï¼Œé€šè¿‡å°†ä»»åŠ¡åˆ†è§£ä¸ºç‹¬ç«‹çš„äº‹ä»¶å¤„ç†ï¼Œç¡®ä¿é¡ºåºæ‰§è¡Œçš„åŒæ—¶ï¼Œæ”¯æŒå¹¶è¡Œæ“ä½œå’Œçµæ´»ç®¡ç†ã€‚å®ƒå¹¿æ³›åº”ç”¨äºå¤æ‚ç³»ç»Ÿçš„è®¾è®¡ä¸å®ç°ä¸­ï¼Œæœ‰æ•ˆæå‡äº†ç¨‹åºçš„æ•ˆç‡å’Œå¯é æ€§ã€‚</p><h2 id="äº‹ä»¶å†’æ³¡"><a href="#äº‹ä»¶å†’æ³¡" class="headerlink" title="äº‹ä»¶å†’æ³¡"></a>äº‹ä»¶å†’æ³¡</h2><p>äº‹ä»¶å†’æ³¡ï¼šå…¨é¢è§£æä¸åº”ç”¨</p><p>å®šä¹‰ä¸åŸºæœ¬æ¦‚å¿µ</p><p>äº‹ä»¶å†’æ³¡æ˜¯æŒ‡åœ¨äº‹ä»¶å¤„ç†è¿‡ç¨‹ä¸­ï¼Œä¸€ä¸ªäº‹ä»¶èƒ½å¤Ÿå½±å“åˆ°æ¯”å®ƒæ›´æ—©è§¦å‘çš„äº‹ä»¶ã€‚è¿™ç§æœºåˆ¶å…è®¸æˆ‘ä»¬åœ¨å¤„ç†å½“å‰äº‹ä»¶çš„åŒæ—¶ï¼Œå›æº¯å¹¶å½±å“ä¹‹å‰çš„äº‹ä»¶ï¼Œä»è€Œå®ç°æ›´åŠ çµæ´»å’ŒåŠ¨æ€çš„äº¤äº’ã€‚</p><p>äº‹ä»¶å†’æ³¡çš„ä½œç”¨æœºåˆ¶</p><p>äº‹ä»¶ä¼ æ’­ï¼šäº‹ä»¶å¯ä»¥ä¼ é€’ç»™çˆ¶å…ƒç´ æˆ–ä¸Šå±‚ç»„ä»¶ï¼Œå…è®¸åœ¨å¤šä¸ªå±‚çº§ä¹‹é—´å…±äº«çŠ¶æ€ã€‚<br>äº‹ä»¶ä¼˜å…ˆçº§ï¼šæµè§ˆå™¨æ ¹æ®äº‹ä»¶çš„æ—¶é—´æˆ³å¤„ç†äº‹ä»¶ï¼Œç¡®ä¿å…ˆå‘ç”Ÿçš„äº‹ä»¶å…ˆè¢«å¤„ç†ã€‚<br>äº‹ä»¶å›è°ƒï¼šé€šè¿‡å›è°ƒå‡½æ•°ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªäº‹ä»¶å¤„ç†å®Œæˆåï¼Œè§¦å‘å¦ä¸€ä¸ªäº‹ä»¶çš„å¤„ç†ã€‚<br>åº”ç”¨åœºæ™¯</p><p>åŠ¨æ€å¸ƒå±€è°ƒæ•´ï¼šåœ¨å“åº”å¼è®¾è®¡ä¸­ï¼Œé€šè¿‡äº‹ä»¶å†’æ³¡å¯ä»¥å®æ—¶è°ƒæ•´é¡µé¢å¸ƒå±€ã€‚<br>ç”¨æˆ·äº¤äº’ä¼˜åŒ–ï¼šä¾‹å¦‚ï¼Œåœ¨æ»‘åŠ¨è¿‡ç¨‹ä¸­å®æ—¶æ›´æ–°ç›¸å…³å…ƒç´ çš„çŠ¶æ€æˆ–ä¿¡æ¯ã€‚<br>ç»„ä»¶é—´åä½œï¼šå¤šä¸ªç»„ä»¶ä¹‹é—´é€šè¿‡äº‹ä»¶å†’æ³¡ä¼ é€’çŠ¶æ€å’Œæ§åˆ¶ï¼Œå®ç°ååŒå·¥ä½œã€‚</p><p>å®ç°ç¤ºä¾‹</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">handleScroll</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// å½“å‰äº‹ä»¶</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;å½“å‰äº‹ä»¶:&#x27;</span>, <span class="variable language_">window</span>.<span class="property">event</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å›æº¯åˆ°çˆ¶äº‹ä»¶</span></span><br><span class="line">    <span class="keyword">let</span> event = <span class="variable language_">window</span>.<span class="property">event</span>;</span><br><span class="line">    <span class="keyword">while</span> (event.<span class="property">parentElement</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (event.<span class="property">parentElement</span>.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&#x27;myElement&#x27;</span>)) &#123;</span><br><span class="line">            event.<span class="property">parentElement</span>.<span class="property">style</span>æ”¹å˜ï¼›</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        event = event.<span class="property">parentElementEvent</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;å¤„ç†åçš„äº‹ä»¶:&#x27;</span>, event);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ€»ç»“<br>äº‹ä»¶å†’æ³¡æ˜¯ä¸€ç§å¼ºå¤§çš„æœºåˆ¶ï¼Œä½¿å¾—å‰ç«¯å¼€å‘å˜å¾—æ›´åŠ çµæ´»å’Œé«˜æ•ˆã€‚é€šè¿‡ç†è§£å…¶åŸºæœ¬åŸç†å’Œåº”ç”¨åœºæ™¯ï¼Œå¼€å‘è€…å¯ä»¥æ›´å¥½åœ°è®¾è®¡å“åº”å¼å’Œäº¤äº’ä¸°å¯Œçš„ç½‘é¡µç•Œé¢ã€‚</p><h1 id="äº‹ä»¶å§”æ‰˜"><a href="#äº‹ä»¶å§”æ‰˜" class="headerlink" title="äº‹ä»¶å§”æ‰˜"></a>äº‹ä»¶å§”æ‰˜</h1><p>äº‹ä»¶å§”æ‰˜ï¼šå…¨é¢è§£æä¸åº”ç”¨</p><p>å®šä¹‰ä¸åŸºæœ¬æ¦‚å¿µ</p><p>â€œäº‹ä»¶å§”æ‰˜â€æ˜¯æŒ‡ä¸€ä¸ªç»„ä»¶æˆ–è„šæœ¬å°†æŸä¸ªäº‹ä»¶çš„å¤„ç†æƒäº¤ç»™å¦ä¸€ä¸ªç»„ä»¶ã€æœåŠ¡å™¨ç«¯æˆ–å…¶ä»–å¤„ç†é€»è¾‘ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¯ä»¥åœ¨ä¸åŒçš„å±‚çº§ä¹‹é—´å…±äº«å’Œä¼ é€’äº‹ä»¶ï¼Œå®ç°æ›´ä¸ºçµæ´»å’Œå¤æ‚çš„äº¤äº’ã€‚</p><p>äº‹ä»¶å§”æ‰˜çš„ä½œç”¨æœºåˆ¶</p><p>äº‹ä»¶è½¬å‘ï¼šå°†å½“å‰äº‹ä»¶çš„å¤„ç†è´£ä»»è½¬ç§»ç»™å¦ä¸€ä¸ªç»„ä»¶æˆ–æœåŠ¡ã€‚<br>åä½œå¤„ç†ï¼šåœ¨å¤šä¸ªç»„ä»¶ååŒå·¥ä½œæ—¶ï¼Œé€šè¿‡äº‹ä»¶å§”æ‰˜å®ç°ä¿¡æ¯å…±äº«å’ŒååŒæ“ä½œã€‚<br>å»¶è¿Ÿå“åº”ï¼šåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œäº‹ä»¶è¢«å§”æ‰˜åï¼Œåœ¨åç»­çš„äº¤äº’ä¸­å†è¿›è¡Œå¤„ç†ã€‚</p><p>åº”ç”¨åœºæ™¯</p><p>åŠ¨æ€å¸ƒå±€è°ƒæ•´ï¼šåœ¨å“åº”å¼è®¾è®¡ä¸­ï¼Œæ ¹æ®ç”¨æˆ·è¡Œä¸ºæˆ–ç³»ç»ŸçŠ¶æ€å®æ—¶è°ƒæ•´é¡µé¢å¸ƒå±€ã€‚<br>ç”¨æˆ·äº¤äº’ä¼˜åŒ–ï¼šä¾‹å¦‚ï¼Œåœ¨æ»‘åŠ¨è¿‡ç¨‹ä¸­å®æ—¶æ›´æ–°ç›¸å…³å…ƒç´ çš„çŠ¶æ€æˆ–ä¿¡æ¯ã€‚<br>ç»„ä»¶é—´åä½œï¼šå¤šä¸ªç»„ä»¶ä¹‹é—´é€šè¿‡äº‹ä»¶å§”æ‰˜ä¼ é€’çŠ¶æ€å’Œæ§åˆ¶ï¼Œå®ç°ååŒå·¥ä½œã€‚</p><p>å®ç°ç¤ºä¾‹</p><p>åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ­¥éª¤å®ç°äº‹ä»¶å§”æ‰˜ï¼š</p><p>å®šä¹‰éœ€è¦è½¬å‘çš„äº‹ä»¶ç±»å‹ã€‚<br>åœ¨ç›®æ ‡ç»„ä»¶æˆ–æœåŠ¡ä¸Šæ³¨å†Œè¯¥äº‹ä»¶çš„å¤„ç†å‡½æ•°ã€‚<br>åœ¨åŸç»„ä»¶æˆ–æœåŠ¡ä¸­è§¦å‘æ­¤äº‹ä»¶ã€‚</p><h1 id="å…¶ä»–äº‹ä»¶"><a href="#å…¶ä»–äº‹ä»¶" class="headerlink" title="å…¶ä»–äº‹ä»¶"></a>å…¶ä»–äº‹ä»¶</h1><p>é€‰æ‹©äº‹ä»¶ (querySelectorEvent)<br>å®šä¹‰ï¼šç”¨äºå®šä½çˆ¶å…ƒç´ çš„ç¬¬ä¸€ä¸ªå­å…ƒç´ ã€‚<br>ä½œç”¨ï¼šåœ¨å•å‡»æŸä¸ªå…ƒç´ æ—¶ï¼Œå¿«é€Ÿæ‰¾åˆ°å…¶ç¬¬ä¸€ä¸ªåŒ¹é…çš„å­å…ƒç´ ï¼Œé€šå¸¸ç”¨äºé«˜é˜¶é€‰æ‹©æ“ä½œï¼ˆå¦‚å¤šé€‰æ¡†ï¼‰ã€‚</p><p>ç¤ºä¾‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> options = &#123;</span><br><span class="line">  <span class="attr">once</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">3000</span>, <span class="comment">// 3ç§’è¶…æ—¶åæ”¾å¼ƒæŸ¥æ‰¾</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> selection = <span class="variable language_">document</span>.<span class="title function_">querySelectorEvent</span>(<span class="string">&#x27;div&#x27;</span>, <span class="string">&#x27;select&#x27;</span>, options);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (selection) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;é€‰ä¸­å­å…ƒç´ :&#x27;</span>, selection);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>äº‹ä»¶å»¶è¿Ÿï¼ˆdelayedEventï¼‰<br>å®šä¹‰ï¼šç”¨äºå°†äº‹ä»¶çš„å¤„ç†å»¶è¿Ÿåˆ°åç»­æ“ä½œå®Œæˆåã€‚<br>ä½œç”¨ï¼šåœ¨æŸä¸ªæ“ä½œå®Œæˆåæ‰è§¦å‘äº‹ä»¶ï¼Œé¿å…é‡å¤æˆ–æ— æ•ˆäº‹ä»¶ã€‚<br>ç¤ºä¾‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> timer = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// è¿™é‡Œçš„ event å°†è¢«å»¶è¿Ÿåˆ° timer å®Œæˆåè§¦å‘</span></span><br><span class="line">&#125;, <span class="number">500</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;button&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (timer === <span class="literal">undefined</span> || <span class="built_in">clearTimeout</span>(timer)) &#123;</span><br><span class="line">    e.<span class="title function_">preventDefault</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>äº‹ä»¶ç»„åˆï¼ˆeventCombinationï¼‰<br>å®šä¹‰ï¼šç”¨äºå°†å¤šä¸ªäº‹ä»¶åˆå¹¶ä¸ºä¸€ä¸ªå•ä¸€äº‹ä»¶ã€‚<br>ä½œç”¨ï¼šç®€åŒ–é€»è¾‘ï¼Œå‡å°‘é‡å¤ç»‘å®šå’Œå¤„ç†ã€‚</p><p>ç¤ºä¾‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> event1 = <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, handleClick);</span><br><span class="line"><span class="keyword">const</span> event2 = <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseover&#x27;</span>, onMouseOver);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleClick</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ç‚¹å‡»äº‹ä»¶å·²å¤„ç†&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">onMouseOver</span>(<span class="params">e</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;é¼ æ ‡è¿‡ä¸Šäº‹ä»¶å·²å¤„ç†&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯ä»¥å°†ä¸¤ä¸ªäº‹ä»¶åˆå¹¶ä¸ºä¸€ä¸ª</span></span><br><span class="line">event1.<span class="title function_">handleCombination</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;åŒæ—¶ç‚¹å‡»å’Œç§»åŠ¨é¼ æ ‡äº‹ä»¶å·²å¤„ç†&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>äº‹ä»¶é‡æ”¾ï¼ˆreplayEventï¼‰<br>å®šä¹‰ï¼šç”¨äºå°†ç‰¹å®šäº‹ä»¶é‡æ–°è§¦å‘ï¼Œé€šå¸¸åœ¨æ¨¡æ‹Ÿç”¨æˆ·æ“ä½œæ—¶ä½¿ç”¨ã€‚<br>ä½œç”¨ï¼šåœ¨æŸä¸ªå…ƒç´ å¤±å»ç„¦ç‚¹æˆ–å…¶ä»–çŠ¶æ€åï¼Œé‡æ–°è§¦å‘åŸå§‹äº‹ä»¶ã€‚</p><p>ç¤ºä¾‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> event = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;button&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, handleClick);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleClick</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// æ‰§è¡Œç‚¹å‡»æ“ä½œçš„é€»è¾‘</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æŒ‰é’®ç‚¹å‡»äº‹ä»¶å·²å¤„ç†&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨å¤±å»ç„¦ç‚¹æ—¶é‡æ”¾äº‹ä»¶</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;button&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;losefocus&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  event.<span class="title function_">replay</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ol start="5"><li>äº‹ä»¶å»¶è¿Ÿä¸é˜»æ­¢ï¼ˆdelayedBlockï¼‰<br>å®šä¹‰ï¼šç”¨äºå°†äº‹ä»¶å»¶è¿Ÿåˆ°æŸä¸ªæ“ä½œå®Œæˆåï¼Œå¹¶åœ¨ç‰¹å®šæ¡ä»¶ä¸‹é˜»æ­¢äº‹ä»¶çš„è§¦å‘ã€‚<br>ä½œç”¨ï¼šé¿å…æŸäº›åŠ¨ä½œè¿‡æ—©åœ°å“åº”ç”¨æˆ·æ“ä½œï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚</li></ol><p>ç¤ºä¾‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> timer = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// è¿™ä¸ªäº‹ä»¶å°†åœ¨ timer å®Œæˆåè¢«é˜»æ­¢</span></span><br><span class="line">&#125;, <span class="number">500</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;button&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (timer === <span class="literal">undefined</span> || <span class="built_in">clearTimeout</span>(timer)) &#123;</span><br><span class="line">    e.<span class="title function_">preventDefault</span>();</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (e.<span class="property">target</span>.<span class="property">value</span> === <span class="string">&#x27;æŒ‰ä¸‹&#x27;</span>) &#123;</span><br><span class="line">    e.<span class="title function_">stopPropagation</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>äº‹ä»¶è¿‡æ»¤ï¼ˆeventFilterï¼‰</p><p>å®šä¹‰ï¼šç”¨äºåˆ¤æ–­äº‹ä»¶æ˜¯å¦éœ€è¦è¢«å¤„ç†ã€‚<br>ä½œç”¨ï¼šåœ¨ç‰¹å®šæ¡ä»¶ä¸‹é¿å…è§¦å‘äº‹ä»¶ï¼Œé˜²æ­¢ä¸å¿…è¦çš„æ“ä½œæˆ–å¼‚å¸¸ã€‚<br>ç¤ºä¾‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> event = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;button&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, handleClick);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleClick</span>(<span class="params">e</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (e.<span class="property">target</span>.<span class="property">value</span> !== <span class="string">&#x27;æŒ‰ä¸‹&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æŒ‰é’®ç‚¹å‡»äº‹ä»¶å·²å¤„ç†&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ filter é˜»æ­¢å…¶ä»–æ“ä½œ</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;button&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">  e.<span class="title function_">preventDefault</span>();</span><br><span class="line">  <span class="keyword">const</span> result = <span class="title function_">eFilter</span>(e);</span><br><span class="line">  <span class="keyword">if</span> (result) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">// å¤„ç†äº‹ä»¶</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// ä¸å¤„ç†äº‹ä»¶</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">event.<span class="property">filter</span> = <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;è¿‡æ»¤å™¨è§¦å‘&#x27;</span>);</span><br><span class="line">  <span class="keyword">return</span> !<span class="variable language_">this</span>.<span class="property">target</span>.<span class="property">value</span>; <span class="comment">// æŒ‰ä¸‹æŒ‰é’®æ‰å¤„ç†äº‹ä»¶</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>äº‹ä»¶è·Ÿè¸ªï¼ˆeventTrackingï¼‰</p><p>å®šä¹‰ï¼šç”¨äºåœ¨ DOM ç»“æ„å˜åŒ–æ—¶åŠ¨æ€ç»‘å®šäº‹ä»¶ã€‚<br>ä½œç”¨ï¼šé¿å…å› å…ƒç´ ç»“æ„å˜åŒ–è€Œå¯¼è‡´çš„äº‹ä»¶ä¸¢å¤±æˆ–å»¶è¿Ÿã€‚</p><p>ç¤ºä¾‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> el = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ·»åŠ è·Ÿè¸ªå™¨</span></span><br><span class="line">el.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, handleClick, &#123;</span><br><span class="line">  <span class="attr">once</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">targets</span>: [<span class="string">&#x27;button&#x27;</span>]</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleClick</span>(<span class="params">e</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ç‚¹å‡»äº‹ä»¶å·²å¤„ç†&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»“æ„å˜åŒ–è§¦å‘äº‹ä»¶</span></span><br><span class="line">el.<span class="property">innerHTML</span> = <span class="string">&#x27;&lt;button&gt;æŒ‰é’®å†…å®¹&lt;/button&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">el.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ç»“æ„å˜åŒ–åçš„æ–°ç‚¹å‡»äº‹ä»¶å·²å¤„ç†&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>äº‹ä»¶ç»„åˆä¸å»¶è¿Ÿï¼ˆeventCombinationAndDelayï¼‰<br>å®šä¹‰ï¼šç”¨äºå°†å¤šä¸ªäº‹ä»¶å’Œå»¶è¿Ÿäº‹ä»¶åˆå¹¶ä¸ºä¸€ä¸ªå•ä¸€çš„äº‹ä»¶å¤„ç†é€»è¾‘ã€‚<br>ä½œç”¨ï¼šç®€åŒ–ä»£ç ï¼Œé¿å…é‡å¤ç»‘å®šå’Œå¤„ç†ã€‚</p><p>ç¤ºä¾‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> timer = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// å»¶è¿Ÿäº‹ä»¶</span></span><br><span class="line">&#125;, <span class="number">500</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;button&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (timer === <span class="literal">undefined</span> || <span class="built_in">clearTimeout</span>(timer)) &#123;</span><br><span class="line">    e.<span class="title function_">preventDefault</span>();</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æŒ‰é’®ç‚¹å‡»äº‹ä»¶å·²å¤„ç†&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> eventCombination = <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ç»„åˆäº‹ä»¶è§¦å‘&#x27;</span>);</span><br><span class="line">  timer = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// å…¶ä»–é€»è¾‘</span></span><br><span class="line">  &#125;, <span class="number">3000</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;button&#x27;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span>(<span class="params">e</span>) &#123;</span><br><span class="line">  <span class="title function_">eventCombinationAndDelay</span>(e, <span class="function">() =&gt;</span> &#123; <span class="comment">// è¿Ÿå»¶äº‹ä»¶çš„å¤„ç†</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ç»„åˆä¸å»¶è¿Ÿäº‹ä»¶å·²å¤„ç†&#x27;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>æ€»ç»“<br>â€œå…¶ä»–äº‹ä»¶â€ä¸»è¦æŒ‡é™¤äº† DOM äº‹ä»¶ å¤–çš„äº‹ä»¶ç±»å‹ï¼Œä¸»è¦ç”¨äºæ›´å¤æ‚çš„äº¤äº’é€»è¾‘æˆ–ç‰¹å®šåœºæ™¯çš„å¤„ç†ã€‚æŒæ¡è¿™äº›äº‹ä»¶å¯ä»¥å¸®åŠ©å¼€å‘è€…æ›´å¥½åœ°æ§åˆ¶ç”¨æˆ·æ“ä½œã€ä¼˜åŒ–ç”¨æˆ·ä½“éªŒï¼Œå¹¶å®ç°è·¨ç»„ä»¶çš„åä½œåŠŸèƒ½ã€‚</p><p>é€‰æ‹©äº‹ä»¶ï¼šç”¨äºé«˜é˜¶é€‰æ‹©æ“ä½œã€‚<br>å»¶è¿Ÿäº‹ä»¶ï¼šç”¨äºå»¶è¿Ÿäº‹ä»¶å¤„ç†ã€‚<br>äº‹ä»¶ç»„åˆï¼šç”¨äºåˆå¹¶å¤šä¸ªäº‹ä»¶ä¸ºä¸€ä¸ªã€‚<br>äº‹ä»¶é‡æ”¾ï¼šç”¨äºåœ¨å¤±å»ç„¦ç‚¹æ—¶é‡æ–°è§¦å‘äº‹ä»¶ã€‚<br>äº‹ä»¶è¿‡æ»¤ï¼šç”¨äºåœ¨ç‰¹å®šæ¡ä»¶ä¸‹é¿å…è§¦å‘äº‹ä»¶ã€‚<br>äº‹ä»¶è·Ÿè¸ªï¼šç”¨äºåŠ¨æ€ç»‘å®šäº‹ä»¶ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> JS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Web-APIå­¦ä¹ ä¸€</title>
      <link href="/2025/03/06/JavaScript/APIs/"/>
      <url>/2025/03/06/JavaScript/APIs/</url>
      
        <content type="html"><![CDATA[<h1 id="Web-API-åŸºæœ¬è®¤çŸ¥"><a href="#Web-API-åŸºæœ¬è®¤çŸ¥" class="headerlink" title="Web API åŸºæœ¬è®¤çŸ¥"></a>Web API åŸºæœ¬è®¤çŸ¥</h1><h3 id="ä½œç”¨å’Œåˆ†ç±»"><a href="#ä½œç”¨å’Œåˆ†ç±»" class="headerlink" title="ä½œç”¨å’Œåˆ†ç±»"></a>ä½œç”¨å’Œåˆ†ç±»</h3><p>ä½œç”¨ï¼šå°±æ˜¯ä½¿ç”¨JSå»æ“ä½œHTMLå’Œæµè§ˆå™¨</p><p>åˆ†ç±»ï¼šDOMï¼ˆæ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼‰ã€BOMï¼ˆæµè§ˆå™¨å¯¹è±¡æ¨¡å‹ï¼‰</p><h3 id="ä»€ä¹ˆæ˜¯DOM"><a href="#ä»€ä¹ˆæ˜¯DOM" class="headerlink" title="ä»€ä¹ˆæ˜¯DOM"></a>ä»€ä¹ˆæ˜¯DOM</h3><p>DOMï¼ˆDocument Object Modelâ€”â€”â€”â€” æ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼‰æ˜¯ç”¨æ¥å‘ˆç°ä»¥åŠä»»æ„HTMLæˆ–XMLæ–‡æ¡£äº¤äº’çš„API</p><p>ç™½è¯æ–‡ï¼šDOMæ˜¯æµè§ˆå™¨æä¾›çš„ä¸€å¥—ä¸“é—¨ç”¨æ¥æ“ä½œç½‘é¡µå†…å®¹çš„åŠŸèƒ½<br>å¼€å‘ç½‘é¡µå†…å®¹ç‰¹æ•ˆå’Œå®ç°ç”¨æˆ·äº¤äº’</p><h3 id="DOMæ ‘"><a href="#DOMæ ‘" class="headerlink" title="DOMæ ‘"></a>DOMæ ‘</h3><p><img src="/img%5Cjs%5CDOM.png"></p><h3 id="DOMå¯¹è±¡ï¼ˆé‡è¦ï¼‰"><a href="#DOMå¯¹è±¡ï¼ˆé‡è¦ï¼‰" class="headerlink" title="DOMå¯¹è±¡ï¼ˆé‡è¦ï¼‰"></a>DOMå¯¹è±¡ï¼ˆé‡è¦ï¼‰</h3><p><b>DOMå¯¹è±¡ï¼šæµè§ˆå™¨æ ¹æ®htmlæ ‡ç­¾ç”Ÿæˆçš„JSå¯¹è±¡</b></p><p>æ‰€æœ‰çš„æ ‡ç­¾å±æ€§éƒ½å¯ä»¥åœ¨è¿™ä¸ªå¯¹è±¡ä¸Šé¢æ‰¾åˆ°<br>ä¿®æ”¹è¿™ä¸ªå¯¹è±¡çš„å±æ€§ä¼šè‡ªåŠ¨æ˜ å°„åˆ°æ ‡ç­¾èº«ä¸Š</p><p><b>DOMçš„æ ¸å¿ƒæ€æƒ³</b></p><p>æŠŠç½‘é¡µå†…å®¹å½“åšå¯¹è±¡æ¥å¤„ç†</p><p><b>documentå¯¹è±¡</b></p><p>æ˜¯DOMé‡Œæä¾›çš„ä¸€ä¸ªå¯¹è±¡<br>æ‰€ä»¥å®ƒæä¾›çš„å±æ€§å’Œæ–¹æ³•éƒ½æ˜¯æ¥è®¿é—®å’Œæ“ä½œç½‘é¡µå†…å®¹çš„<br>ç½‘é¡µæ‰€æœ‰å†…å®¹éƒ½åœ¨documenté‡Œé¢</p><h1 id="è·å–DOMå…ƒç´ "><a href="#è·å–DOMå…ƒç´ " class="headerlink" title="è·å–DOMå…ƒç´ "></a>è·å–DOMå…ƒç´ </h1><h3 id="æ ¹æ®CSSé€‰æ‹©å™¨æ¥è·å–DOMå…ƒç´ "><a href="#æ ¹æ®CSSé€‰æ‹©å™¨æ¥è·å–DOMå…ƒç´ " class="headerlink" title="æ ¹æ®CSSé€‰æ‹©å™¨æ¥è·å–DOMå…ƒç´ "></a>æ ¹æ®CSSé€‰æ‹©å™¨æ¥è·å–DOMå…ƒç´ </h3><p>æŸ¥è¯¢ç‰¹å®šæˆ–æ‰€æœ‰DOMèŠ‚ç‚¹ï¼š</p><p>ä½¿ç”¨querySelectoræ–¹æ³•æŸ¥æ‰¾ç‰¹å®šæ ‡ç­¾çš„èŠ‚ç‚¹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> headingNode = dom.<span class="title function_">querySelector</span>(<span class="string">&#x27;h1&#x27;</span>);</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨querySelectorAllæ–¹æ³•è·å–æ‰€æœ‰DOMèŠ‚ç‚¹ï¼Œé€‚ç”¨äºéœ€è¦éå†å’Œå¤„ç†å¤šä¸ªèŠ‚ç‚¹çš„æƒ…å†µã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> allElements = dom.<span class="title function_">querySelectorAll</span>();</span><br></pre></td></tr></table></figure><p>å‚æ•°ï¼š<br>åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæœ‰æ•ˆçš„CSSé€‰æ‹©å™¨å­—ç¬¦ä¸²</p><p>è¿”å›å€¼ï¼š<br>CSSé€‰æ‹©å™¨åŒ¹é…çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œä¸€ä¸ªHTMLElementå¯¹è±¡ã€‚</p><h1 id="æ“ä½œå…ƒç´ å†…å®¹"><a href="#æ“ä½œå…ƒç´ å†…å®¹" class="headerlink" title="æ“ä½œå…ƒç´ å†…å®¹"></a>æ“ä½œå…ƒç´ å†…å®¹</h1><p>èƒ½å¤Ÿä¿®æ”¹å…ƒç´ çš„æ–‡æœ¬æ›´æ¢å†…å®¹</p><p>DOMå¯¹è±¡éƒ½æ˜¯æ ¹æ®æ ‡ç­¾ç”Ÿæˆçš„ï¼Œæ‰€ä»¥æ“ä½œæ ‡ç­¾ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯æ“ä½œDOMå¯¹è±¡<br>å°±æ˜¯æ“ä½œå¯¹è±¡ä½¿ç”¨çš„ç‚¹è¯­è¨€</p><p><b>.innerTextå±æ€§</b></p><p>å°†æ–‡æœ¬å†…å®¹æ·»åŠ &#x2F;æ›´æ–°åˆ°ä»»æ„æ ‡ç­¾ä½ç½®<br>æ˜¾ç¤ºçº¯æ–‡æœ¬ï¼Œä¸è§£ææ ‡ç­¾</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">    &lt;title&gt;<span class="title class_">Document</span>&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span>æˆ‘æ˜¯æ–‡å­—å†…å®¹<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//1.è·å–å…ƒç´ </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">const</span> box =<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.box&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//2.ä¿®æ”¹æ–‡å­—å†…å®¹ å¯¹è±¡ã€‚innerText å±æ€§</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="variable language_">console</span>.<span class="title function_">log</span>(box.<span class="property">innerText</span>) <span class="comment">//è·å–æ–‡å­—å†…å®¹</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    box.<span class="property">innerText</span>=<span class="string">&#x27;æˆ‘æ˜¯ä¸€ä¸ªç›’å­&#x27;</span><span class="comment">//ä¿®æ”¹æ–‡å­—å†…å®¹</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p><b>.innerHTMLå±æ€§</b></p><p>innerHTML å±æ€§<br>è·å–å…ƒç´ å†…å®¹æœ€ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨ innerHTML å±æ€§ã€‚<br>innerHTML å±æ€§å¯ç”¨äºè·å–æˆ–æ›¿æ¢ HTML å…ƒç´ çš„å†…å®¹ã€‚<br>innerHTML å±æ€§å¯ç”¨äºè·å–æˆ–æ”¹å˜ä»»ä½• HTML å…ƒç´ ï¼ŒåŒ…æ‹¬ <html> å’Œ <body>ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;/head&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span>æˆ‘æ˜¯æ–‡å­—å†…å®¹<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//1.è·å–å…ƒç´ </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">const</span> box =<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.box&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// //2.ä¿®æ”¹æ–‡å­—å†…å®¹ å¯¹è±¡ã€‚innerText å±æ€§</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// console.log(box.innerText) //è·å–æ–‡å­—å†…å®¹</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// box.innerText=&#x27;æˆ‘æ˜¯ä¸€ä¸ªç›’å­&#x27;//ä¿®æ”¹æ–‡å­—å†…å®¹</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//3.innerHTML è§£ææ ‡ç­¾</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="variable language_">console</span>.<span class="title function_">log</span>(box.<span class="property">innerHTML</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    box.<span class="property">innerHTML</span>=<span class="string">&#x27;&lt;b&gt;æˆ‘è¦æ›´æ¢&lt;/b&gt;&#x27;</span> </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h3 id="æ“ä½œå…ƒç´ å¸¸ç”¨å±æ€§"><a href="#æ“ä½œå…ƒç´ å¸¸ç”¨å±æ€§" class="headerlink" title="æ“ä½œå…ƒç´ å¸¸ç”¨å±æ€§"></a>æ“ä½œå…ƒç´ å¸¸ç”¨å±æ€§</h3><p>è¿˜å¯ä»¥é€šè¿‡JSè®¾ç½®&#x2F;ä¿®æ”¹æ ‡ç­¾å…ƒç´ å±æ€§ï¼Œæ¯”å¦‚é€šè¿‡srcæ›´æ¢å›¾ç‰‡<br>æœ€å¸¸è§çš„å±æ€§æ¯”å¦‚ï¼šhrefã€titleã€srcç­‰</p><p>è¯­æ³•ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.è·å–å…ƒç´ </span></span><br><span class="line"><span class="keyword">const</span> pic=<span class="variable language_">document</span>.<span class="title function_">querSelector</span>(<span class="string">&#x27;img&#x27;</span>)</span><br><span class="line"><span class="comment">//2.æ“ä½œå…ƒç´ </span></span><br><span class="line">pic.<span class="property">src</span>=<span class="string">&#x27;&#x27;</span></span><br><span class="line">pic.<span class="property">tltle</span>=<span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>é¡µé¢éšæœºè·å–å›¾ç‰‡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;./&quot;</span><span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">//å–åˆ°N~Mçš„éšæœºæ•´æ•°</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">function</span> <span class="title function_">getRandom</span>(<span class="params">N,M</span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>()*(M-N+<span class="number">1</span>))+N</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">//1.è·å–å›¾ç‰‡å¯¹è±¡</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">const</span> img =<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;img&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">//2.éšæœºå¾—åˆ°åºå·</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">const</span> random =<span class="title function_">getRandom</span>(<span class="number">1</span>,<span class="number">6</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">//3.æ›´æ¢è·¯å¾„</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        img.<span class="property">src</span>=<span class="string">`./<span class="subst">$&#123;random&#125;</span>`</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h3 id="æ“ä½œå…ƒç´ æ ·å¼å±æ€§"><a href="#æ“ä½œå…ƒç´ æ ·å¼å±æ€§" class="headerlink" title="æ“ä½œå…ƒç´ æ ·å¼å±æ€§"></a>æ“ä½œå…ƒç´ æ ·å¼å±æ€§</h3><p>è¿˜å¯ä»¥é€šè¿‡JSè®¾ç½®&#x2F;ä¿®æ”¹æ ‡ç­¾å…ƒç´ çš„æ ·å¼å±æ€§<br>æ¯”å¦‚é€šè¿‡æ»šè½®å›¾å°åœ†ç‚¹è‡ªåŠ¨æ›´æ¢é¢œè‰²æ ·å¼</p><p><b>é€šè¿‡styleå±æ€§æ“ä½œCSS</b></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">    &lt;style&gt;</span><br><span class="line">        .<span class="property">box</span>&#123;</span><br><span class="line">            <span class="attr">width</span>: 200px;</span><br><span class="line">            <span class="attr">height</span>: 200px;</span><br><span class="line">            background-<span class="attr">color</span>: aqua;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">//1.è·å–å…ƒç´ </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">const</span> box=<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.box&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">//2.ä¿®æ”¹æ ·å¼å±æ€§ å¯¹è±¡.style.æ ·å¼å±æ€§=&#x27;å€¼+å•ä½&#x27; </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        box.<span class="property">style</span>.<span class="property">width</span>=<span class="string">&#x27;300px&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        box.<span class="property">style</span>.<span class="property">height</span>=<span class="string">&#x27;300px&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">//å¤šç»„å•è¯çš„é‡‡å– å°é©¼å³°å‘½åæ³•</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        box.<span class="property">style</span>.<span class="property">backgroundColor</span>=<span class="string">&#x27;hotpink&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        box.<span class="property">style</span>.<span class="property">border</span>=<span class="string">&#x27;2px solid blue&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p><b>æ“ä½œç±»åï¼ˆclassNameï¼‰æ“ä½œCSS</b></p><p>æ“ä½œç±»åï¼ˆclassNameï¼‰æ“ä½œCSS<br>å¦‚æœä¿®æ”¹çš„æ ·å¼æ¯”è¾ƒå¤šï¼Œç›´æ¥é€šè¿‡styleå±æ€§ä¿®æ”¹æ¯”è¾ƒç¹çï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å€ŸåŠ©äºcssç±»åçš„å½¢å¼</p><p>æ³¨æ„ï¼š<br>ç”±äºclassæ˜¯å…³é”®å­—ï¼Œæ‰€ä»¥ä½¿ç”¨classNameå»ä»£æ›¿<br>classNameæ˜¯ä½¿ç”¨æ–°å€¼æ¢æ—§å€¼ï¼Œå¦‚æœéœ€è¦æ·»åŠ ä¸€ä¸ªç±»ï¼Œéœ€è¦ä¿ç•™ä¹‹å‰çš„ç±»å</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">    &lt;style&gt;</span><br><span class="line">        div&#123;</span><br><span class="line">            <span class="attr">width</span>: 200px;</span><br><span class="line">            <span class="attr">height</span>: 200px;</span><br><span class="line">        &#125;</span><br><span class="line">        .<span class="property">box</span>&#123;</span><br><span class="line">            <span class="attr">width</span>: 300px;</span><br><span class="line">            <span class="attr">height</span>: 300px;</span><br><span class="line">            background-<span class="attr">color</span>: aqua;</span><br><span class="line">            <span class="attr">margin</span>: 100px auto;</span><br><span class="line">            <span class="attr">padding</span>: 10px;</span><br><span class="line">            <span class="attr">border</span>: 1px solid #<span class="number">000</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">//1.è·å–å…ƒç´ </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">const</span> div =<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;div&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">//2.æ·»åŠ ç±»å  class æ˜¯å…³é”®å­— </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        div.<span class="property">className</span>=<span class="string">&#x27;box&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p><b>é€šè¿‡classLidtæ“ä½œç±»æ§åˆ¶CSS</b></p><p>ä¸ºäº†è§£å†³classNameå®¹æ˜“è¦†ç›–ä»¥å‰çš„ç±»åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡classListæ–¹å¼è¿½åŠ å’Œåˆ é™¤ç±»å</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">    &lt;style&gt;</span><br><span class="line">        .<span class="property">box</span>&#123;</span><br><span class="line">            <span class="attr">width</span>: 200px;</span><br><span class="line">            <span class="attr">height</span>: 200px;</span><br><span class="line">            <span class="attr">color</span>: aqua;</span><br><span class="line">        &#125;</span><br><span class="line">        .<span class="property">active</span>&#123;</span><br><span class="line">            <span class="attr">color</span>: aquamarine;</span><br><span class="line">            background-<span class="attr">color</span>: bisque;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">//é€šè¿‡classListæ·»åŠ </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">//1.è·å–å…ƒç´ </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">const</span> box = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.box&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">//2.ä¿®æ”¹æ ·å¼</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">//è¿½åŠ ç±»add()  ç±»åä¸åŠ ç‚¹ï¼Œå¹¶ä¸”æ˜¯å­—ç¬¦ä¸²</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        box.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;active&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">//åˆ é™¤ç±» remove() ç±»åä¸åŠ ç‚¹ï¼Œå¹¶ä¸”æ˜¯å­—ç¬¦ä¸²</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        box.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;box&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="comment">//åˆ‡æ¢ç±» toggle() æœ‰å°±åˆ æ‰ï¼Œæ²¡æœ‰å°±åŠ ä¸Š</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        box.<span class="property">classList</span>.<span class="title function_">toggle</span>(<span class="string">&#x27;active&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h3 id="æ“ä½œè¡¨å•å…ƒç´ -å±æ€§"><a href="#æ“ä½œè¡¨å•å…ƒç´ -å±æ€§" class="headerlink" title="æ“ä½œè¡¨å•å…ƒç´  å±æ€§"></a>æ“ä½œè¡¨å•å…ƒç´  å±æ€§</h3><p>è¡¨å•å¾ˆå¤šæƒ…å†µå—ï¼Œä¹Ÿéœ€è¦ä¿®æ”¹å±æ€§ï¼Œæ¯”å¦‚ç‚¹å‡»çœ¼ç›ï¼Œå¯ä»¥çœ‹åˆ°å¯†ç ï¼Œæœ¬è´¨æ˜¯æŠŠè¡¨å•ç±»å‹è½¬æ¢ä¸ºæ–‡æœ¬æ¡†<br>æ­£å¸¸çš„æœ‰å±æ€§æœ‰å–å€¼çš„ è·Ÿå…¶ä»–çš„æ ‡ç­¾å±æ€§æ²¡æœ‰ä»»ä½•åŒºåˆ«</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ç”µè„‘&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//1.è·å–å…ƒç´ </span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">const</span> uname=<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;input&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//2.è·å–å€¼ è·å–è¡¨å•é‡Œé¢çš„å€¼ ç”¨çš„ uname.value</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="variable language_">console</span>.<span class="title function_">log</span>(uname.<span class="property">value</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">//3.è®¾ç½®è¡¨å•çš„å€¼</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    uname.<span class="property">value</span>= <span class="string">&#x27;&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    uname.<span class="property">type</span>=<span class="string">&#x27;password&#x27;</span>     </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>å¤é€‰æ¡†<br>æ¯”å¦‚ï¼šdisabledã€checkedã€selected</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">&quot;checked&quot;</span> name=<span class="string">&quot;&quot;</span> id=<span class="string">&quot;&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ipt = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;input&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ipt.<span class="property">checked</span>=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> button = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;button&#x27;</span>)</span><br><span class="line"></span><br><span class="line">button.<span class="property">disabled</span>=<span class="literal">true</span></span><br></pre></td></tr></table></figure><h3 id="è‡ªå®šä¹‰å±æ€§"><a href="#è‡ªå®šä¹‰å±æ€§" class="headerlink" title="è‡ªå®šä¹‰å±æ€§"></a>è‡ªå®šä¹‰å±æ€§</h3><p><b>è‡ªå®šä¹‰å±æ€§ï¼š</b><br>åœ¨html5ä¸­æ¨å‡ºæ¥äº†ä¸“é—¨çš„data-è‡ªå®šä¹‰å±æ€§<br>åœ¨æ ‡ç­¾ä¸Šä¸€å¾‹ä»¥datasetå¯¹è±¡æ–¹å¼è·å–</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">data-id</span>=<span class="string">&quot;1&quot;</span> <span class="attr">data-spm</span>=<span class="string">&quot;youxianyu&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">data-id</span>=<span class="string">&quot;2&quot;</span>&gt;</span>2<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">data-id</span>=<span class="string">&quot;3&quot;</span>&gt;</span>3<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">data-id</span>=<span class="string">&quot;4&quot;</span>&gt;</span>4<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">data-id</span>=<span class="string">&quot;5&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">const</span> one = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;div&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">console</span>.<span class="title function_">log</span>(one.<span class="property">dataset</span>.<span class="property">id</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">console</span>.<span class="title function_">log</span>(one.<span class="property">dataser</span>.<span class="property">spm</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure><h3 id="é—´æ­‡å‡½æ•°"><a href="#é—´æ­‡å‡½æ•°" class="headerlink" title="é—´æ­‡å‡½æ•°"></a>é—´æ­‡å‡½æ•°</h3><p>å®šæ—¶å™¨å‡½æ•°å¯ä»¥å¼€å¯å’Œå…³é—­å®šæ—¶å™¨</p><p>1.å¼€å¯å®šæ—¶å™¨</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setInterval</span>(å‡½æ•°ï¼Œé—´éš”æ—¶é—´)</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">repeat</span>(<span class="params"></span>)&#123;</span><br><span class="line">    consoloe.<span class="title function_">log</span>(<span class="string">&#x27;youxianyu&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">setInterval</span>(repeat,<span class="number">1000</span>)</span><br><span class="line">========================</span><br><span class="line"><span class="built_in">setInterval</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;youxianyu&#x27;</span>)</span><br><span class="line">&#125;,<span class="number">1000</span>)</span><br></pre></td></tr></table></figure><p>2.å…³é—­å®šæ—¶å™¨</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> timer=<span class="built_in">setInterval</span>(å‡½æ•°ï¼Œé—´éš”æ—¶é—´)</span><br><span class="line"><span class="built_in">clearInterval</span>(å˜é‡å)</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> timer = <span class="built_in">setInterval</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;youxianyu&#x27;</span>)</span><br><span class="line">&#125;,<span class="number">1000</span>)</span><br><span class="line"><span class="built_in">clearInterval</span>(timer)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> JS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScriptåŸºç¡€é˜¶æ®µä¸‰</title>
      <link href="/2025/03/03/JavaScript/%E5%87%BD%E6%95%B0/"/>
      <url>/2025/03/03/JavaScript/%E5%87%BD%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="å‡½æ•°çš„æ¦‚å¿µä¸ä½œç”¨"><a href="#å‡½æ•°çš„æ¦‚å¿µä¸ä½œç”¨" class="headerlink" title="å‡½æ•°çš„æ¦‚å¿µä¸ä½œç”¨"></a>å‡½æ•°çš„æ¦‚å¿µä¸ä½œç”¨</h1><p>å‡½æ•°æ˜¯ç¨‹åºä¸­çš„ä¸€ç§åŸºæœ¬ç»“æ„ï¼Œå®ƒå…è®¸æˆ‘ä»¬æŠŠä¸€ç»„ä»£ç å°è£…æˆä¸€ä¸ªç‹¬ç«‹çš„å•ä½ï¼Œå¹¶é€šè¿‡ç‰¹å®šçš„åç§°è°ƒç”¨è¿™ä¸ªå•å…ƒã€‚å‡½æ•°çš„ä½œç”¨ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š</p><p>æé«˜ä»£ç å¤ç”¨æ€§: å°†é‡å¤æˆ–ç›¸ä¼¼çš„æ“ä½œå°è£…åˆ°ä¸€ä¸ªå‡½æ•°ä¸­ï¼Œå¯ä»¥é¿å…ä»£ç å†—ä½™ã€‚<br>å¢å¼ºé€»è¾‘æ¸…æ™°åº¦: é€šè¿‡å°†å…·ä½“æ“ä½œæŠ½è±¡ä¸ºå‡½æ•°ï¼Œå¯ä»¥æ›´æ¸…æ¥šåœ°è¡¨è¾¾ç¨‹åºçš„åŠŸèƒ½ã€‚<br>ç»„ç»‡ä»£ç ç»“æ„: å¤æ‚çš„é€»è¾‘å¯ä»¥é€šè¿‡å¤šä¸ªå‡½æ•°çš„è°ƒç”¨æ¥å®ç°ã€‚</p><p>å‡½æ•°çš„åŸºæœ¬å®šä¹‰</p><p>åœ¨JavaScriptä¸­ï¼Œå‡½æ•°å¯ä»¥é€šè¿‡functionå…³é”®å­—å®šä¹‰ã€‚ä¸€ä¸ªåŸºæœ¬çš„å‡½æ•°å®šä¹‰å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">functionName</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// å‡½æ•°ä½“å†…çš„æ“ä½œä»£ç </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">greet</span>(<span class="params">name</span>) &#123;  <span class="comment">// å®šä¹‰ä¸€ä¸ªæ¥å—å‚æ•° `name` çš„å‡½æ•°</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Hello, <span class="subst">$&#123;name&#125;</span>`</span>);  <span class="comment">// æ‰§è¡Œç‰¹å®šæ“ä½œ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‡½æ•°çš„è°ƒç”¨</p><p>ä¸€æ—¦å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°ï¼Œå°±å¯ä»¥é€šè¿‡è°ƒç”¨æ¥æ‰§è¡Œå…¶ä¸­çš„æ“ä½œã€‚è°ƒç”¨æ–¹å¼å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">greet</span>(<span class="string">&quot;Alice&quot;</span>);  <span class="comment">// è°ƒç”¨ `greet` å‡½æ•°ï¼Œå¹¶ä¼ é€’å‚æ•° `&quot;Alice&quot;`</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„äº‹é¡¹:</p><p>å¿…é¡»åœ¨å‡½æ•°å®šä¹‰ä¹‹å‰è°ƒç”¨å‡½æ•°ã€‚<br>è°ƒç”¨æ—¶å¯ä»¥ä¸æä¾›å‚æ•°ï¼ˆå¦‚æœå‡½æ•°æ²¡æœ‰é»˜è®¤å‚æ•°ï¼‰ï¼Œä½†å¿…é¡»éµå¾ªå‡½æ•°çš„å®šä¹‰ã€‚<br>å‡½æ•°çš„ä½œç”¨åŸŸä¸å˜é‡</p><p>JavaScriptä¸­çš„å‡½æ•°å±äºå…¨å±€ä½œç”¨åŸŸï¼Œè¿™æ„å‘³ç€å‡½æ•°ä½“å†…ä½¿ç”¨çš„å˜é‡ä¼šè¢«è§†ä¸ºå…¨å±€å˜é‡ã€‚ä¸è¿‡ï¼Œä¸ºäº†æ›´å¥½åœ°ç®¡ç†ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼š</p><p>ä½¿ç”¨æ‹¬å·()å¼ºåˆ¶è°ƒç”¨: è¿™å¯ä»¥é¿å…æŸäº›ç‰¹æ®Šæƒ…å†µä¸‹å…¨å±€ä½œç”¨åŸŸçš„è¯†åˆ«ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span> <span class="title function_">greet</span>(<span class="params">name</span>)) &#123;  <span class="comment">// ä½¿ç”¨æ‹¬å·å¼ºåˆ¶è°ƒç”¨å‡½æ•°</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Hello, <span class="subst">$&#123;name&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ˜ç¡®æŒ‡å®šä½œç”¨åŸŸ: ä½¿ç”¨constæˆ–letå…³é”®å­—å®šä¹‰å˜é‡æ—¶ï¼Œå¯ä»¥æŒ‡å®šå…¶ä½œç”¨åŸŸã€‚</p><p>å‡½æ•°çš„å‚æ•°ä¸è¿”å›å€¼<br>å‚æ•°ä¼ é€’<br>å‡½æ•°å¯ä»¥é€šè¿‡æ¥å—å‚æ•°æ¥æ¥æ”¶å¤–éƒ¨çš„æ•°æ®ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">greet</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Hello, <span class="subst">$&#123;name&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è°ƒç”¨æ—¶ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">greet</span>(<span class="string">&quot;Alice&quot;</span>);  <span class="comment">// è¾“å‡º: &quot;Hello, Alice&quot;</span></span><br></pre></td></tr></table></figure><p>å¦‚æœå‡½æ•°æ²¡æœ‰å®šä¹‰å‚æ•°ï¼Œä¹Ÿå¯ä»¥ç›´æ¥è°ƒç”¨ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">greet</span>();  <span class="comment">// è¾“å‡º: &quot;Hello, &quot;</span></span><br></pre></td></tr></table></figure><p>è¿”å›å€¼<br>JavaScriptçš„é»˜è®¤è¿”å›å€¼æ˜¯undefinedã€‚è¦è®©å‡½æ•°è¿”å›ç‰¹å®šå€¼ï¼Œå¯ä»¥ä½¿ç”¨returnå…³é”®å­—ã€‚</p><p>ç¤ºä¾‹:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">multiply</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> a * b;  <span class="comment">// è¿”å›ä¸¤ä¸ªæ•°ç›¸ä¹˜çš„ç»“æœ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è°ƒç”¨æ—¶ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> result = <span class="title function_">multiply</span>(<span class="number">3</span>, <span class="number">4</span>);  <span class="comment">// ç»“æœä¸º `12`</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result);          <span class="comment">// è¾“å‡º: &quot;12&quot;</span></span><br></pre></td></tr></table></figure><p>å‡½æ•°çš„é«˜çº§ç‰¹æ€§<br>é™¤äº†åŸºæœ¬åŠŸèƒ½ï¼ŒJavaScriptè¿˜æ”¯æŒä¸€äº›æ›´é«˜çº§çš„åŠŸèƒ½ï¼š</p><ol><li>é»˜è®¤å‚æ•°<br>å¯ä»¥åœ¨å‡½æ•°å®šä¹‰ä¸­ä¸ºå‚æ•°æä¾›é»˜è®¤å€¼ã€‚</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">greet</span>(<span class="params">name = <span class="string">&quot;World&quot;</span></span>) &#123;  <span class="comment">// å¦‚æœæ²¡æœ‰ä¼ é€’å‚æ•°ï¼Œåˆ™ `name` çš„å€¼ä¸º `&quot;World&quot;`</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Hello, <span class="subst">$&#123;name&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è°ƒç”¨æ—¶ï¼š</p><p>è°ƒç”¨ä¸€æ¬¡ï¼Œä¸ä¼ å‚æ•°ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">greet</span>();  <span class="comment">// è¾“å‡º: &quot;Hello, World&quot;</span></span><br></pre></td></tr></table></figure><p>è°ƒç”¨ä¸¤æ¬¡ï¼Œä¼ å‚æ•°ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">greet</span>(<span class="string">&quot;Alice&quot;</span>);  <span class="comment">// è¾“å‡º: &quot;Hello, Alice&quot;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>å¯é€‰å‚æ•°<br>å¯ä»¥å®šä¹‰å‡½æ•°æ¥å—ä»»æ„æ•°é‡çš„å‚æ•°ã€‚</li></ol><p>ä½¿ç”¨â€¦argsæ¥æ”¶å¤šä½™å‚æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">acceptAnyArgs</span>(<span class="params">...args</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(args.<span class="property">length</span> + <span class="string">&#x27; arguments passed&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è°ƒç”¨æ—¶ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">acceptAnyArgs</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);  <span class="comment">// è¾“å‡º: &quot;3 arguments passed&quot;</span></span><br></pre></td></tr></table></figure><ol start="3"><li>å‡½æ•°çš„è¡¨è¾¾å¼å½¢å¼<br>å¯ä»¥å°†å‡½æ•°ç›´æ¥å†™æˆä¸€ä¸ªè¡¨è¾¾å¼ï¼š</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="title function_">multiply</span> = (<span class="params">a, b</span>) =&gt; a * b;  <span class="comment">// å®šä¹‰ä¸€ä¸ªä¹˜æ³•å‡½æ•°</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">multiply</span>(<span class="number">2</span>, <span class="number">3</span>));      <span class="comment">// è¾“å‡º: 6</span></span><br></pre></td></tr></table></figure><ol start="4"><li>é—­åŒ…<br>é—­åŒ…æ˜¯æŒ‡ä¸€ä¸ªå‡½æ•°åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­èƒ½å¤Ÿè®¿é—®å¤–éƒ¨å˜é‡æˆ–å†…éƒ¨å˜é‡çš„æŠ€æœ¯ã€‚</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">outer</span>(<span class="params">x</span>) &#123;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">inner</span>(<span class="params">n</span>) &#123;  <span class="comment">// å†…éƒ¨å‡½æ•°å¯ä»¥è®¿é—® `x`</span></span><br><span class="line">        <span class="keyword">return</span> x + n;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> inner;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> result = <span class="title function_">outer</span>(<span class="number">5</span>)(<span class="number">3</span>);  <span class="comment">// è¾“å‡º: &quot;8&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result);       <span class="comment">// è¾“å‡º: undefined (å› ä¸º result å·²è¢«èµ‹å€¼ï¼Œå®é™…åº”è¾“å‡º &quot;8&quot;)</span></span><br></pre></td></tr></table></figure><p>å‡½æ•°çš„å¸¸è§ä½¿ç”¨åœºæ™¯<br>å¤„ç†é‡å¤ä»»åŠ¡</p><p>å¦‚æœéœ€è¦å¤šæ¬¡æ‰§è¡Œç›¸åŒçš„æ“ä½œï¼Œå¯ä»¥é€šè¿‡å‡½æ•°å°†ä»£ç å°è£…èµ·æ¥ã€‚<br>æ•°æ®è½¬æ¢</p><p>å¯¹è¾“å…¥æ•°æ®è¿›è¡ŒæŸç§å˜æ¢æˆ–è®¡ç®—ï¼Œä¾‹å¦‚æ’åºã€ç»Ÿè®¡ç­‰ã€‚<br>å¼‚æ­¥æ“ä½œ</p><p>ä½¿ç”¨ Promises æˆ– async&#x2F;awaitå…³é”®å­—æ—¶ï¼Œé€šå¸¸ä¼šå®šä¹‰ä¸º async function å¹¶ä½¿ç”¨awaitå…³é”®å­—è°ƒç”¨ã€‚<br>æ¨¡å—åŒ–ä»£ç </p><p>å°†é€»è¾‘æ‹†åˆ†æˆå¤šä¸ªå‡½æ•°ï¼Œä½¿å¾—ä»£ç æ›´æ˜“ç»´æŠ¤ã€‚<br>æ€»ç»“<br>å‡½æ•°æ˜¯ JavaScript ç¼–ç¨‹ä¸­éå¸¸é‡è¦çš„åŸºç¡€æ¦‚å¿µã€‚æŒæ¡å¦‚ä½•å®šä¹‰å’Œè°ƒç”¨å‡½æ•°ï¼Œèƒ½å¤Ÿæ˜¾è‘—æé«˜ä»£ç çš„å¯è¯»æ€§å’Œå¤ç”¨æ€§ã€‚é€šè¿‡ç†è§£å‡½æ•°çš„åŸºæœ¬çŸ¥è¯†å’Œé«˜çº§ç‰¹æ€§ï¼Œä½ å¯ä»¥æ›´å¥½åœ°ç¼–å†™é«˜æ•ˆçš„ä»£ç ã€‚</p><p>åŒ¿åå‡½æ•°çš„åŸºæœ¬æ¦‚å¿µ<br>åŒ¿åå‡½æ•°å¯ä»¥ç”¨æ¥è§£å†³ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š</p><p>ä¸éœ€è¦ä¸ºå‡½æ•°å‘½åï¼šå½“ä¸€ä¸ªå‡½æ•°åªéœ€è¦åœ¨éå¸¸çŸ­çš„æ—¶é—´å†…ä½¿ç”¨æ—¶ï¼Œæ²¡æœ‰å¿…è¦å®šä¹‰ä¸€ä¸ªå‘½åå‡½æ•°ã€‚<br>é¿å…åç§°å†²çªï¼šé€šè¿‡ä¸å®šä¹‰åå­—ï¼Œå¯ä»¥é¿å…ä¸å…¶ä»–å‡½æ•°æˆ–å˜é‡äº§ç”Ÿå‘½åå†²çªã€‚<br>å¤„ç†å›è°ƒå‡½æ•°ï¼šåŒ¿åå‡½æ•°ç‰¹åˆ«é€‚åˆç”¨äºå¤„ç†éœ€è¦ä¼ é€’çš„å›è°ƒå‡½æ•°ï¼ˆCallbackï¼‰ã€‚<br>åŒ¿åå‡½æ•°çš„è¯­æ³•<br>åŒ¿åå‡½æ•°å¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸¤ç§æ–¹å¼å®šä¹‰ï¼š</p><ol><li>ä½¿ç”¨ function å…³é”®å­—<br>æœ€ä¼ ç»Ÿçš„å®šä¹‰åŒ¿åå‡½æ•°çš„æ–¹å¼æ˜¯ä½¿ç”¨ function å…³é”®å­—ï¼š</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> greeting = <span class="keyword">function</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Hello, <span class="subst">$&#123;name&#125;</span>`</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„ greeting å‡½æ•°æ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œæ²¡æœ‰åç§°ã€‚</p><ol start="2"><li>ä½¿ç”¨ ES6 å¼•æ“çš„ç®­å¤´å‡½æ•°è¯­æ³•<br>ç°ä»£ JavaScript æä¾›äº†ä¸€ç§æ›´ç®€æ´çš„æ–¹å¼æ¥å®šä¹‰åŒ¿åå‡½æ•°ï¼Œè¿™å°±æ˜¯ ES6 å¼•å…¥çš„ ç®­å¤´å‡½æ•°ï¼ˆarrow functionï¼‰ï¼š</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">greeting</span> = (<span class="params">name</span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Hello, <span class="subst">$&#123;name&#125;</span>`</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>åŒ¿åå‡½æ•°çš„ä¼˜åŠ¿<br>æ— éœ€å£°æ˜å‡½æ•°åç§°ï¼šåŒ¿åå‡½æ•°ä¸éœ€è¦ä¸ºå‡½æ•°èµ·åå­—ï¼Œå› æ­¤å¯ä»¥é¿å…å‘½åå†²çªã€‚<br>çµæ´»æ€§é«˜ï¼šåŒ¿åå‡½æ•°å¯ä»¥ç«‹å³å®šä¹‰å¹¶æ‰§è¡Œï¼Œé€‚åˆå¤„ç†å¤æ‚æˆ–åŠ¨æ€ç”Ÿæˆçš„é€»è¾‘ã€‚<br>å®‰å…¨ï¼šåŒ¿åå‡½æ•°ä¸ä¼šæ±¡æŸ“å‘½åç©ºé—´ï¼Œé¿å…å…¨å±€å˜é‡çš„ä½¿ç”¨é—®é¢˜ã€‚<br>åŒ¿åå‡½æ•°çš„å¸¸è§ç”¨é€”<br>å›è°ƒå‡½æ•°ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">func</span> = (<span class="params">a, b</span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`The sum is <span class="subst">$&#123;a + b&#125;</span>`</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> result = <span class="title function_">func</span>(<span class="number">3</span>, <span class="number">5</span>); <span class="comment">// è¾“å‡ºï¼š8</span></span><br></pre></td></tr></table></figure><p>å¤„ç†å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">add</span> = (<span class="params">a, b=<span class="number">0</span></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">add</span>(<span class="number">2</span>)); <span class="comment">// è¾“å‡ºï¼š2</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">add</span>(<span class="number">2</span>, <span class="number">3</span>)); <span class="comment">// è¾“å‡ºï¼š5</span></span><br></pre></td></tr></table></figure><p>åŒ¿åå‡½æ•°çš„å‘½åç©ºé—´é—®é¢˜<br>å› ä¸ºåŒ¿åå‡½æ•°æ²¡æœ‰æ˜¾å¼çš„åç§°ï¼Œæ‰€ä»¥åœ¨ declare è¯­å¥ä¸­ä¸ä¼šè¢«è®°å½•åˆ°å‘½åç©ºé—´ä¸­ã€‚å®ƒä»¬ä¼šè¢«æ‰§è¡Œæ—¶çš„å½“å‰ä½œç”¨åŸŸæ‰€éš”ç¦»ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">outer</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Outer function: &#x27;</span> + outer2); <span class="comment">// æŠ¥é”™ï¼šCannot read property &#x27;outer2&#x27; of null</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">inner</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Inner function: &#x27;</span> + inner.<span class="property">name</span>); <span class="comment">// æŠ¥é”™ï¼šCannot read property &#x27;name&#x27; of null</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> anonymous = <span class="keyword">function</span>(<span class="params"></span>) &#123; </span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Anonymous function: &#x27;</span> + (anonymous.<span class="property">name</span> || <span class="string">&#x27;No name&#x27;</span>)); </span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">anonymous = <span class="title function_">outer</span>(); <span class="comment">// è¾“å‡ºï¼šAnonymous function: No name</span></span><br></pre></td></tr></table></figure><p>æ€»ç»“<br>åŒ¿åå‡½æ•° æ˜¯ä¸€ç§éå¸¸çµæ´»ä¸”æœ‰ç”¨çš„å·¥å…·ï¼Œç‰¹åˆ«é€‚åˆåœ¨å¤„ç†å›è°ƒå‡½æ•°æˆ–éœ€è¦ä¸´æ—¶å®šä¹‰çš„å‡½æ•°æ—¶ä½¿ç”¨ã€‚<br>ä½¿ç”¨ç®­å¤´å‡½æ•°å¯ä»¥è®©åŒ¿åå‡½æ•°æ›´ç®€æ´ã€é«˜æ•ˆã€‚<br>åŒ¿åå‡½æ•°ä¸ä¼šæ±¡æŸ“å‘½åç©ºé—´ï¼Œå› æ­¤åœ¨å¤æ‚çš„åœºæ™¯ä¸­å¯ä»¥æ›´å¥½åœ°æ§åˆ¶ä½œç”¨åŸŸé—®é¢˜ã€‚</p><h1 id="å¯¹è±¡"><a href="#å¯¹è±¡" class="headerlink" title="å¯¹è±¡"></a>å¯¹è±¡</h1><p>ç†è§£å¯¹è±¡çš„æ¦‚å¿µï¼š</p><p>å¯¹è±¡æ˜¯å°†å¤šç§æ•°æ®ä»¥é”®å€¼å¯¹çš„å½¢å¼å°è£…åœ¨ä¸€èµ·çš„æ•°æ®ç»“æ„ã€‚ä¾‹å¦‚ï¼Œå­¦ç”Ÿå¯¹è±¡åŒ…å«äº†å­¦å·ã€å§“åå’Œæˆç»©ç­‰ä¿¡æ¯ã€‚<br>åˆ›å»ºå¯¹è±¡çš„æ–¹æ³•ï¼š</p><p>ä½¿ç”¨å¤§æ‹¬å·åˆå§‹åŒ–ï¼šconst obj &#x3D; { name: â€œå¼ ä¸‰â€, age: 18 };<br>é”®å¿…é¡»åœ¨å€¼å‰é¢ï¼Œä»¥åŒºåˆ†é”®åå’Œå€¼ï¼Œå¹¶ç¡®ä¿è¯­æ³•æ­£ç¡®ã€‚<br>å¢åˆ æŸ¥æ”¹æ“ä½œï¼š</p><p>å¢ï¼š</p><p>ä½¿ç”¨ obj[newKey] &#x3D; value; æ¥æ·»åŠ æ–°å±æ€§ã€‚ä¾‹å¦‚ï¼šperson.name &#x3D; â€œå°æ˜â€;<br>æŸ¥ï¼š</p><p>ç›´æ¥è®¿é—®å±æ€§ï¼šobj.keyName<br>å¼•ç”¨è®¿é—®å±æ€§ï¼šobj[â€˜keyNameâ€™]ï¼Œåè€…æ›´çµæ´»ï¼Œé€‚ç”¨äºå­—ç¬¦ä¸²é”®åçš„å˜æ›´ã€‚<br>åˆ ï¼š</p><p>ä½¿ç”¨ delete obj[key]; æˆ–è€… obj[key] &#x3D; undefined; æ¥åˆ é™¤å±æ€§ã€‚åˆ é™¤åéœ€é‡æ–°èµ‹å€¼ä»¥æ¢å¤å±æ€§ã€‚<br>æ”¹ï¼š</p><p>ç›´æ¥èµ‹å€¼ï¼šobj[key] &#x3D; value<br>èµ‹å€¼æ–°å¯¹è±¡ï¼šobj[key] &#x3D; { â€¦ }; é€‚ç”¨äºåµŒå¥—ç»“æ„ã€‚<br>å®ä¾‹åº”ç”¨ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> student = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;å¼ ä¸‰&quot;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">18</span>,</span><br><span class="line">    <span class="attr">score</span>: [<span class="number">90</span>, <span class="number">85</span>, <span class="number">76</span>]</span><br><span class="line">&#125;;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(student.<span class="property">name</span>); <span class="comment">// è¾“å‡ºï¼šå¼ ä¸‰</span></span><br><span class="line"><span class="keyword">delete</span> student.<span class="property">score</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(student.<span class="property">score</span>); <span class="comment">// è¾“å‡ºï¼šundefined</span></span><br><span class="line">student.<span class="property">address</span> = &#123; <span class="attr">street</span>: <span class="string">&quot;åŒ—äº¬&quot;</span>, <span class="attr">house</span>: <span class="string">&quot;ä¸œç›´é—¨&quot;</span> &#125;;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> JS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScriptåŸºç¡€é˜¶æ®µä¸€</title>
      <link href="/2025/03/01/JavaScript/%E7%AE%80%E4%BB%8B/"/>
      <url>/2025/03/01/JavaScript/%E7%AE%80%E4%BB%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="JavaScriptä»‹ç»"><a href="#JavaScriptä»‹ç»" class="headerlink" title="JavaScriptä»‹ç»"></a>JavaScriptä»‹ç»</h1><h2 id="JavaScriptï¼ˆæ˜¯ä»€ä¹ˆï¼Ÿï¼‰"><a href="#JavaScriptï¼ˆæ˜¯ä»€ä¹ˆï¼Ÿï¼‰" class="headerlink" title="JavaScriptï¼ˆæ˜¯ä»€ä¹ˆï¼Ÿï¼‰"></a>JavaScriptï¼ˆæ˜¯ä»€ä¹ˆï¼Ÿï¼‰</h2><p>æ˜¯ä¸€ç§è¿è¡Œåœ¨å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰çš„ç¼–ç¨‹è¯­è¨€ï¼Œå®ç°äººæœºäº¤äº’æ•ˆæœã€‚</p><h2 id="ä½œç”¨ï¼ˆåšä»€ä¹ˆï¼Ÿï¼‰"><a href="#ä½œç”¨ï¼ˆåšä»€ä¹ˆï¼Ÿï¼‰" class="headerlink" title="ä½œç”¨ï¼ˆåšä»€ä¹ˆï¼Ÿï¼‰"></a>ä½œç”¨ï¼ˆåšä»€ä¹ˆï¼Ÿï¼‰</h2><p>â€”â€” ç½‘é¡µç‰¹æ•ˆï¼ˆç›‘å¬ç”¨æˆ·çš„ä¸€äº›è¡Œä¸ºè®©ç½‘é¡µä½œå‡ºå¯¹åº”çš„å‘é¦ˆï¼‰<br>â€”â€” è¡¨å•éªŒè¯ï¼ˆé’ˆå¯¹è¡¨å•æ•°æ®çš„åˆæ³•æ€§è¿›è¡Œåˆ¤æ–­ï¼‰<br>â€”â€” æ•°æ®äº¤äº’ï¼ˆè·å–åå°çš„æ•°æ®ï¼Œæ¸²æŸ“åˆ°å‰ç«¯ï¼‰</p><h2 id="jsåˆä½“éªŒ"><a href="#jsåˆä½“éªŒ" class="headerlink" title="jsåˆä½“éªŒ"></a>jsåˆä½“éªŒ</h2><p><img src="/img%5Cjs%5CSnipaste_2025-02-27_18-47-48.png"></p><p><b>JavaScriptçš„ä¹¦å†™ä½ç½®</b></p><blockquote><p>JavaScriptå¯ä»¥æ”¾åœ¨bodyéƒ¨åˆ†ä¹Ÿå¯ä»¥æ”¾åœ¨headéƒ¨åˆ†</p></blockquote><p><b>å¤–éƒ¨ JavaScript çš„ä¼˜åŠ¿</b></p><blockquote><p>åœ¨å¤–éƒ¨æ–‡ä»¶ä¸­æ”¾ç½®è„šæœ¬æœ‰å¦‚ä¸‹ä¼˜åŠ¿ï¼š<br>åˆ†ç¦»äº† HTML å’Œä»£ç <br>ä½¿ HTML å’Œ JavaScript æ›´æ˜“äºé˜…è¯»å’Œç»´æŠ¤<br>å·²ç¼“å­˜çš„ JavaScript æ–‡ä»¶å¯åŠ é€Ÿé¡µé¢åŠ è½½</p></blockquote><h2 id="å®ä¾‹æ–¹æ³•"><a href="#å®ä¾‹æ–¹æ³•" class="headerlink" title="å®ä¾‹æ–¹æ³•"></a>å®ä¾‹æ–¹æ³•</h2><p>Window.alert(messageï¼ˆè¿”å›å€¼ï¼‰)æ–¹æ³•</p><p><b>å‚æ•°ï¼šmessage</b><br>æ˜¾ç¤ºåœ¨å¯¹è¯æ¡†ä¸­çš„å­—ç¬¦ä¸²ï¼Œä¼ å…¥å…¶ä»–ç±»å‹å€¼ï¼Œä¹Ÿä¼šè½¬ä¼šæˆå­—ç¬¦ä¸²</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="title function_">alert</span>(<span class="string">&#x27;Hello workd!&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¤–éƒ¨å¼•ç”¨</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    <span class="comment">//å¤–éƒ¨å¼•ç”¨</span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./js/My.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹</p><p><img src="/img%5Cjs%5CSnipaste_2025-02-27_20-47-30.png"></p><h2 id="JavaScript-æ˜¾ç¤ºæ–¹æ¡ˆ"><a href="#JavaScript-æ˜¾ç¤ºæ–¹æ¡ˆ" class="headerlink" title="JavaScript æ˜¾ç¤ºæ–¹æ¡ˆ"></a>JavaScript æ˜¾ç¤ºæ–¹æ¡ˆ</h2><p>JavaScript èƒ½å¤Ÿä»¥ä¸åŒæ–¹å¼â€œæ˜¾ç¤ºâ€æ•°æ®ï¼š</p><p>ä½¿ç”¨ window.alert() å†™å…¥è­¦å‘Šæ¡†<br>ä½¿ç”¨ document.write() å†™å…¥ HTML è¾“å‡º<br>ä½¿ç”¨ innerHTML å†™å…¥ HTML å…ƒç´ <br>ä½¿ç”¨ console.log() å†™å…¥æµè§ˆå™¨æ§åˆ¶å°</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&#x27;&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">```HTML</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;&#x27;</span>).<span class="property">innerHtml</span>=<span class="string">&#x27;&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="JavaScript-å…³é”®è¯"><a href="#JavaScript-å…³é”®è¯" class="headerlink" title="JavaScript å…³é”®è¯"></a>JavaScript å…³é”®è¯</h1><p>JavaScript è¯­å¥å¸¸å¸¸é€šè¿‡æŸä¸ªå…³é”®è¯æ¥æ ‡è¯†éœ€è¦æ‰§è¡Œçš„ JavaScript åŠ¨ä½œã€‚</p><p><img src="/img%5Cjs%5CSnipaste_2025-02-28_12-34-10.png"></p><h1 id="JavaScript-å˜é‡"><a href="#JavaScript-å˜é‡" class="headerlink" title="JavaScript å˜é‡"></a>JavaScript å˜é‡</h1><ol><li>å˜é‡å£°æ˜<br>åœ¨ JavaScript ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ letã€const å’Œ var å…³é”®å­—æ¥å£°æ˜å˜é‡ã€‚</li></ol><p>let: è¿™æ˜¯æœ€å¸¸è§çš„å…³é”®å­—ï¼Œç”¨äºä¸´æ—¶å£°æ˜å˜é‡ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> age = <span class="number">25</span>; <span class="comment">// å˜é‡ name æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„å€¼ 25</span></span><br></pre></td></tr></table></figure><p>const: è¯¥å…³é”®å­—ç”¨äºæœ€ç»ˆå£°æ˜å˜é‡ã€‚ä¸€æ—¦èµ‹å€¼ç»™ constï¼Œæ‚¨å°±ä¸èƒ½å†ä¿®æ”¹è¯¥å˜é‡çš„å€¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">PI</span> = <span class="number">3.14159</span>; <span class="comment">// å˜é‡ PI æ˜¯ä¸€ä¸ªæ•°å­—ç±»å‹çš„å€¼ 3.14159</span></span><br></pre></td></tr></table></figure><p>var: è¯¥å…³é”®å­—ç”¨äºå£°æ˜å…¨å±€å˜é‡ã€‚ä¸è¿‡ï¼Œç”±äº var çš„ä½¿ç”¨é¢‘ç‡éå¸¸é«˜ï¼Œç°åœ¨å¾ˆå°‘ä½¿ç”¨å®ƒã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> greeting = <span class="string">&quot;Hello, World!&quot;</span>; <span class="comment">// å˜é‡ greeting æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„å€¼ Hello, World!</span></span><br></pre></td></tr></table></figure><ol start="2"><li>å˜é‡ç±»å‹</li></ol><p>JavaScript ä¸å¼ºåˆ¶æŒ‡å®šå˜é‡çš„ç±»å‹ã€‚æ‚¨å¯ä»¥åœ¨å£°æ˜æ—¶ç›´æ¥èµ‹å€¼ç»™å˜é‡ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> num = <span class="number">10</span>; <span class="comment">// num æ˜¯æ•°å­—ç±»å‹</span></span><br><span class="line"><span class="keyword">let</span> name = <span class="string">&quot;Alice&quot;</span>; <span class="comment">// name æ˜¯å­—ç¬¦ä¸²ç±»å‹</span></span><br></pre></td></tr></table></figure><p>å¦‚æœåœ¨æ²¡æœ‰æ˜ç¡®ç±»å‹çš„æƒ…å†µä¸‹ï¼ŒJavaScript ä¼šæ ¹æ®èµ‹å€¼çš„å†…å®¹æ¨æ–­å˜é‡çš„ç±»å‹ã€‚</p><ol start="3"><li>å˜é‡çš„ä½œç”¨åŸŸ<br>å…¨å±€å˜é‡: ä½¿ç”¨ let æˆ– var å£°æ˜çš„å˜é‡å±äºå…¨å±€ä½œç”¨åŸŸã€‚</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a); <span class="comment">// è¾“å‡ºæ˜¯ 10</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å±€éƒ¨å˜é‡: ä½¿ç”¨ let å’Œå‡½æ•°æ‹¬å· () å£°æ˜çš„å˜é‡å±äºè¯¥å‡½æ•°çš„ä½œç”¨åŸŸï¼ˆå±€éƒ¨ä½œç”¨åŸŸï¼‰ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> a = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a); <span class="comment">// è¾“å‡ºæ˜¯ 10</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å—çº§å˜é‡: ä½¿ç”¨ const å£°æ˜çš„å˜é‡å±äºè¯¥å—çº§å…ƒç´ çš„ä½œç”¨åŸŸï¼ˆå—çº§ä½œç”¨åŸŸï¼‰ã€‚</p><ol start="4"><li>å˜é‡çš„èµ‹å€¼</li></ol><p>JavaScript æä¾›å¤šç§æ–¹å¼æ¥èµ‹å€¼ç»™å˜é‡ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç›´æ¥èµ‹å€¼</span></span><br><span class="line"><span class="keyword">let</span> a = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ“ä½œæ•°è¿ç®—ç¬¦</span></span><br><span class="line"><span class="keyword">let</span> b = a; <span class="comment">// b å’Œ a æ˜¯åŒä¸€ä¸ªå˜é‡</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> c = a + <span class="number">5</span>; <span class="comment">// c = 15</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> d = <span class="literal">undefined</span>; <span class="comment">// å˜é‡æœªè¢«èµ‹å€¼ï¼Œé»˜è®¤ä¸º `undefined`</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> e = <span class="literal">null</span>; <span class="comment">// ç‰¹æ®Šæƒ…å†µï¼Œè¡¨ç¤ºç©ºå¯¹è±¡æˆ–ç©ºå€¼</span></span><br></pre></td></tr></table></figure><ol start="5"><li>æ³¨æ„äº‹é¡¹</li></ol><p>JavaScript çš„å˜é‡æ˜¯å¼±å¼•ç”¨ï¼Œè¿™æ„å‘³ç€å®ƒä»¬å­˜å‚¨çš„æ˜¯å†…å­˜åœ°å€ï¼Œè€Œä¸æ˜¯ç›´æ¥çš„å€¼ã€‚å¦‚æœä¸»çº¿ç¨‹ä¸­çš„è„šæœ¬é€€å‡ºï¼Œè¿™äº›å˜é‡ä¼šä¸¢å¤±ã€‚</p><p>ä½¿ç”¨ let å’Œ const å£°æ˜å˜é‡æ—¶ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¼šåœ¨å…¨å±€ä½œç”¨åŸŸæˆ–å½“å‰å—çº§ä¸­å£°æ˜å˜é‡ã€‚</p><p>ç¤ºä¾‹ä»£ç </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å˜é‡å£°æ˜å’Œèµ‹å€¼ç¤ºä¾‹</span></span><br><span class="line"><span class="keyword">let</span> age = <span class="number">25</span>; <span class="comment">// å…¨å±€å˜é‡</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PI</span> = <span class="number">3.14159</span>; <span class="comment">// æœ€ç»ˆå£°æ˜å˜é‡</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">example</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> name = <span class="string">&quot;Alice&quot;</span>; <span class="comment">// å±€éƒ¨å˜é‡</span></span><br><span class="line">    <span class="keyword">const</span> greeting = <span class="string">&quot;Hello!&quot;</span>; <span class="comment">// å—çº§å¸¸é‡</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">example</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(age); <span class="comment">// è¾“å‡ºï¼š25</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable constant_">PI</span>);   <span class="comment">// è¾“å‡ºï¼š3.14159</span></span><br></pre></td></tr></table></figure><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>JavaScript çš„å˜é‡ç³»ç»Ÿéå¸¸çµæ´»ï¼Œå…è®¸æ‚¨åœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°å£°æ˜å’Œä¿®æ”¹å˜é‡ã€‚ä½¿ç”¨ let å’Œ const æ˜¯ç°ä»£ JavaScript å¼€å‘ä¸­å¸¸ç”¨çš„å®è·µï¼Œå®ƒä»¬åˆ†åˆ«ç”¨äºä¸´æ—¶å˜é‡å’Œæœ€ç»ˆå£°æ˜å˜é‡ã€‚</p><h2 id="JavaScript-æ•°ç»„"><a href="#JavaScript-æ•°ç»„" class="headerlink" title="JavaScript æ•°ç»„"></a>JavaScript æ•°ç»„</h2><h3 id="ä¸€ã€æ•°ç»„çš„åˆ›å»ºä¸åˆå§‹åŒ–"><a href="#ä¸€ã€æ•°ç»„çš„åˆ›å»ºä¸åˆå§‹åŒ–" class="headerlink" title="ä¸€ã€æ•°ç»„çš„åˆ›å»ºä¸åˆå§‹åŒ–"></a>ä¸€ã€æ•°ç»„çš„åˆ›å»ºä¸åˆå§‹åŒ–</h3><p>ç©ºæ•°ç»„<br>åˆå§‹åŒ–ä¸€ä¸ªç©ºæ•°ç»„éå¸¸ç®€å•ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = []; <span class="comment">// åˆ›å»ºä¸€ä¸ªç©ºæ•°ç»„</span></span><br></pre></td></tr></table></figure><p>åˆå§‹åŒ–æ•°ç»„</p><p>ä½¿ç”¨[]æ„é€ å‡½æ•°åˆå§‹åŒ–æ•°ç»„ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [](); <span class="comment">// åˆå§‹åŒ–ä¸€ä¸ªç©ºæ•°ç»„</span></span><br></pre></td></tr></table></figure><p>å°†å¤šä¸ªå…ƒç´ æ”¾å…¥æ•°ç»„ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> fruits = [<span class="string">&#x27;è‹¹æœ&#x27;</span>, <span class="string">&#x27;é¦™è•‰&#x27;</span>, <span class="string">&#x27;æ©˜å­&#x27;</span>]; <span class="comment">// ç›´æ¥å°†å…ƒç´ èµ‹å€¼ç»™æ•°ç»„</span></span><br></pre></td></tr></table></figure><p>åˆ©ç”¨å­—ç¬¦ä¸²æ‹†åˆ†<br>å¯ä»¥é€šè¿‡split()æ–¹æ³•å°†ä¸€ä¸ªå­—ç¬¦ä¸²æŒ‰æŒ‡å®šåˆ†éš”ç¬¦åˆ†å‰²æˆå¤šä¸ªå…ƒç´ ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> str = <span class="string">&quot;one,two,three&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> arr = str.<span class="title function_">split</span>(<span class="string">&#x27;,&#x27;</span>); <span class="comment">// ç»“æœï¼š[&quot;one&quot;, &quot;two&quot;, &quot;three&quot;]</span></span><br></pre></td></tr></table></figure><p>æ¨ã€å¼¹å‡ºå’Œåˆ é™¤æ•°ç»„</p><p>ä½¿ç”¨push()å‘æ•°ç»„æœ«å°¾æ·»åŠ å…ƒç´ ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr.<span class="title function_">push</span>(<span class="string">&#x27;apple&#x27;</span>);</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨pop()ç§»é™¤å¹¶è¿”å›æ•°ç»„æœ€åä¸€ä¸ªå…ƒç´ ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> lastElement = arr.<span class="title function_">pop</span>(); <span class="comment">// è¿”å›&#x27;apple&#x27;</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨unshift()ç§»é™¤å¹¶è¿”å›æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆåªèƒ½æ·»åŠ åˆ°æ•°ç»„å¤´éƒ¨ï¼‰ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> firstElement = arr.<span class="title function_">unshift</span>(<span class="string">&#x27;banana&#x27;</span>); <span class="comment">// ç»“æœï¼š[&#x27;banana&#x27;, &#x27;one&#x27;]</span></span><br></pre></td></tr></table></figure><p>æ•°ç»„é•¿åº¦å±æ€§<br>è·å–æˆ–è®¾ç½®æ•°ç»„çš„é•¿åº¦ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr.<span class="property">length</span>); <span class="comment">// è¾“å‡ºå½“å‰æ•°ç»„é•¿åº¦</span></span><br><span class="line">arr.<span class="property">length</span> = <span class="number">3</span>; <span class="comment">// å°†æ•°ç»„é•¿åº¦è®¾ä¸º3</span></span><br></pre></td></tr></table></figure><p>å¤„ç†è¶…å‡ºç´¢å¼•èŒƒå›´çš„æƒ…å†µ</p><p>ä½¿ç”¨arr[undefined]æˆ–arr[number outside of bounds]æ—¶ä¼šè¿”å›undefinedï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr[<span class="number">10</span>]); <span class="comment">// è¾“å‡ºundefinedï¼ˆå‡è®¾arræœ‰3ä¸ªå…ƒç´ ï¼‰</span></span><br></pre></td></tr></table></figure><p>è¦é¿å…è¿™æ ·çš„é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨forâ€¦ofå¾ªç¯æˆ–è€…æ£€æŸ¥ç´¢å¼•çš„æœ‰æ•ˆæ€§ã€‚</p><h3 id="äºŒã€æ•°ç»„çš„éå†ä¸æ“ä½œ"><a href="#äºŒã€æ•°ç»„çš„éå†ä¸æ“ä½œ" class="headerlink" title="äºŒã€æ•°ç»„çš„éå†ä¸æ“ä½œ"></a>äºŒã€æ•°ç»„çš„éå†ä¸æ“ä½œ</h3><p>ä½¿ç”¨forâ€¦inå¾ªç¯<br>å¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªé”®è¿›è¡Œéå†ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> arr) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(key); <span class="comment">// è¾“å‡ºï¼š0, 1, 2ç­‰æ•°å­—ç´¢å¼•</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨forEach()æ–¹æ³•<br>éå†å¹¶æ‰§è¡ŒæŸä¸ªå‡½æ•°æ“ä½œï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">arr.<span class="title function_">forEach</span>(<span class="function">(<span class="params">element, index</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`ç¬¬<span class="subst">$&#123;index&#125;</span>ä¸ªå…ƒç´ æ˜¯ï¼š<span class="subst">$&#123;element&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>æ¡ä»¶éå†ä¸è¿‡æ»¤</p><p>ä½¿ç”¨filter()åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„ï¼ŒåŒ…å«æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> evenNumbers = arr.<span class="title function_">filter</span>(<span class="function"><span class="params">num</span> =&gt;</span> num % <span class="number">2</span> === <span class="number">0</span>); <span class="comment">// ç­›é€‰å‡ºå¶æ•°</span></span><br></pre></td></tr></table></figure><p>find()å’ŒfindIndex()æ–¹æ³•ç”¨äºæŸ¥æ‰¾æ»¡è¶³æ¡ä»¶çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> firstEven = arr.<span class="title function_">find</span>(<span class="function"><span class="params">num</span> =&gt;</span> num % <span class="number">2</span> === <span class="number">0</span>);</span><br></pre></td></tr></table></figure><p>é«˜é˜¶æ•°ç»„æ“ä½œ</p><p>map()ï¼šåˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œå°†åŸæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ è½¬æ¢æˆæ–°çš„å½¢å¼ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> squaredNumbers = arr.<span class="title function_">map</span>(<span class="function"><span class="params">num</span> =&gt;</span> num * num); <span class="comment">// ç­›é€‰å‡ºå¹³æ–¹åçš„æ•°</span></span><br></pre></td></tr></table></figure><p>reduce()ï¼ˆæˆ–foldï¼‰ï¼šå°†æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ ä¾æ¬¡ç´¯ç§¯ï¼Œå¾—åˆ°ä¸€ä¸ªå•ä¸€çš„è¿”å›å€¼ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sum = arr.<span class="title function_">reduce</span>(<span class="function">(<span class="params">acc, current</span>) =&gt;</span> acc + current, <span class="number">0</span>);</span><br></pre></td></tr></table></figure><p>éå†ç´¢å¼•ä¸å€¼å¯¹</p><p>ä½¿ç”¨indexOf()å’ŒlastIndexOf()æ–¹æ³•æŸ¥æ‰¾ç‰¹å®šå€¼çš„ä½ç½®ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> index = arr.<span class="title function_">indexOf</span>(<span class="string">&#x27;apple&#x27;</span>); <span class="comment">// æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå‡ºç°çš„&#x27;apple&#x27;</span></span><br><span class="line"><span class="keyword">let</span> lastIndex = arr.<span class="title function_">lastIndexOf</span>(<span class="string">&#x27;banana&#x27;</span>); <span class="comment">// æŸ¥æ‰¾æœ€åä¸€ä¸ªå‡ºç°çš„&#x27;banana&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="ä¸‰ã€æ•°ç»„çš„æ‰©å±•ä¸è£å‰ª"><a href="#ä¸‰ã€æ•°ç»„çš„æ‰©å±•ä¸è£å‰ª" class="headerlink" title="ä¸‰ã€æ•°ç»„çš„æ‰©å±•ä¸è£å‰ª"></a>ä¸‰ã€æ•°ç»„çš„æ‰©å±•ä¸è£å‰ª</h3><p>æ•°ç»„æ‰©å±•</p><p>ä½¿ç”¨unshift()å°†å…ƒç´ æ·»åŠ åˆ°æ•°ç»„å¤´éƒ¨ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr.<span class="title function_">unshift</span>(<span class="string">&#x27;new element&#x27;</span>);</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨push()æˆ–ç›´æ¥èµ‹å€¼çš„æ–¹å¼åœ¨æ•°ç»„æœ«å°¾å¢åŠ å…ƒç´ ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr.<span class="title function_">push</span>(<span class="string">&#x27;add element&#x27;</span>); <span class="comment">// æˆ–è€… arr = [1,2,3];</span></span><br></pre></td></tr></table></figure><p>æ•°ç»„è£å‰ª<br>é€šè¿‡æˆªå–æ“ä½œç¬¦ï¼ˆâ€¦ï¼‰ç§»é™¤æ•°ç»„ä¸­çš„æŸäº›å…ƒç´ ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> newArr = [...arr, <span class="string">&#x27;a&#x27;</span>, ...arr]; <span class="comment">// åœ¨åŸæ•°ç»„æœ«å°¾æ·»åŠ ä¸ä¹‹ç›¸åŒçš„å…ƒç´ </span></span><br></pre></td></tr></table></figure><p>åˆ é™¤é‡å¤é¡¹<br>ä½¿ç”¨unique()æ–¹æ³•å»é™¤æ•°ç»„ä¸­æ‰€æœ‰é‡å¤çš„å€¼ï¼Œä¿ç•™ç¬¬ä¸€ä¸ªå‡ºç°çš„ä½ç½®ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> uniqueArray = arr.<span class="title function_">unique</span>(); <span class="comment">// å»é™¤é‡å¤é¡¹å¹¶è¿”å›æ–°æ•°ç»„</span></span><br></pre></td></tr></table></figure><h3 id="å››ã€å¤„ç†ç‰¹æ®Šæƒ…å†µ"><a href="#å››ã€å¤„ç†ç‰¹æ®Šæƒ…å†µ" class="headerlink" title="å››ã€å¤„ç†ç‰¹æ®Šæƒ…å†µ"></a>å››ã€å¤„ç†ç‰¹æ®Šæƒ…å†µ</h3><p>ç©ºå€¼å’Œæ— æ•ˆç´¢å¼•</p><p>ä½¿ç”¨hasOwnProperty()æ£€æŸ¥æ˜¯å¦æ˜¯è‡ªå·±å…·æœ‰çš„å±æ€§ï¼Œé¿å…è®¿é—®ä¸å­˜åœ¨çš„å…ƒç´ ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (arr.<span class="title function_">hasOwnProperty</span>(<span class="string">&#x27;index&#x27;</span>)) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(arr[index]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨forâ€¦ofå¾ªç¯éå†æ•°ç»„<br>å¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ è¿›è¡Œå¤„ç†ï¼Œè¾ƒä¸ºç®€æ´å’Œé«˜æ•ˆçš„æ–¹å¼ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> element <span class="keyword">of</span> arr) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(element);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è§£å†³NaNç±»å‹çš„é—®é¢˜<br>é‡åˆ°æ— æ³•è¢«è½¬æ¢ä¸ºæ•°å­—çš„å­—ç¬¦ä¸²æ—¶ï¼Œä½¿ç”¨Number()å‡½æ•°æˆ–å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> num = <span class="title class_">Number</span>(<span class="string">&#x27;apple&#x27;</span>); <span class="comment">// ç»“æœï¼šNaNï¼ˆè¡¨ç¤ºæ— æ•ˆï¼‰</span></span><br></pre></td></tr></table></figure><p>é¿å…æ•°ç»„æœªåˆå§‹åŒ–é—®é¢˜<br>ä½¿ç”¨|| nullå¼ºåˆ¶è¿›è¡Œç±»å‹è½¬æ¢å’Œèµ‹å€¼ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> element = <span class="literal">undefined</span> || arr[<span class="literal">undefined</span>] ? <span class="string">&#x27;é»˜è®¤å€¼&#x27;</span> : <span class="literal">undefined</span>;</span><br></pre></td></tr></table></figure><h3 id="äº”ã€ä¼˜åŒ–ä¸æ€§èƒ½è€ƒè™‘"><a href="#äº”ã€ä¼˜åŒ–ä¸æ€§èƒ½è€ƒè™‘" class="headerlink" title="äº”ã€ä¼˜åŒ–ä¸æ€§èƒ½è€ƒè™‘"></a>äº”ã€ä¼˜åŒ–ä¸æ€§èƒ½è€ƒè™‘</h3><p>é¿å…é‡å¤è®¡ç®—<br>åœ¨é¢‘ç¹æ“ä½œæ•°ç»„æ—¶ï¼Œå°½é‡æå‰å¤„ç†æ•°æ®æˆ–ç¼“å­˜ç»“æœï¼Œå‡å°‘ä¸å¿…è¦çš„è®¡ç®—ã€‚</p><p>ä½¿ç”¨å†…ç½®æ–¹æ³•ä»£æ›¿å¾ªç¯<br>å¯¹äºéœ€è¦éå†å’Œæ“ä½œçš„æƒ…å†µï¼Œä¼˜å…ˆä½¿ç”¨forEach(), map(), filter()ç­‰å†…ç½®æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•ç»è¿‡ä¼˜åŒ–ï¼Œæ¯”è‡ªå®šä¹‰å¾ªç¯æ›´é«˜æ•ˆã€‚</p><p>é¿å…ä¸å¿…è¦çš„æ•°ç»„åˆ›å»º<br>å¤šæ¬¡ä½¿ç”¨push()æˆ–unshift()ä¼šå¯¼è‡´å¤šä¸ªå°æ•°ç»„åˆå¹¶æˆä¸€ä¸ªå¤§æ•°ç»„ï¼Œå¯ä»¥è€ƒè™‘ä¸€æ¬¡æ€§å®Œæˆæ‰€æœ‰æ“ä½œã€‚</p><p>å¤„ç†å¤šç»´æ•°ç»„æ—¶çš„æ€§èƒ½ä¼˜åŒ–<br>å¦‚æœé¢‘ç¹æ“ä½œäºŒç»´æˆ–ä¸‰ç»´æ•°ç»„ï¼Œå¯ä»¥å°è¯•å°†å®ƒä»¬è½¬æ¢ä¸ºå•ç»´æ•°ç»„å¤„ç†ï¼Œå¹¶æ ¹æ®å…·ä½“éœ€æ±‚è¿›è¡Œåˆ†æå’Œä¼˜åŒ–ã€‚</p><h3 id="å…­ã€æ€»ç»“"><a href="#å…­ã€æ€»ç»“" class="headerlink" title="å…­ã€æ€»ç»“"></a>å…­ã€æ€»ç»“</h3><p>åˆ›å»ºä¸åˆå§‹åŒ–ï¼šçµæ´»ä½¿ç”¨[], push(), unshift()ç­‰æ–¹æ³•ã€‚<br>éå†ï¼šåˆ©ç”¨forâ€¦in, forEach(), indexOf(), lastIndexOf()ç­‰æ–¹æ³•é«˜æ•ˆå¤„ç†æ•°ç»„å…ƒç´ ã€‚<br>é«˜é˜¶æ“ä½œï¼šç†Ÿç»ƒè¿ç”¨map(), filter(), reduce(), find()å’ŒfindIndex()è¿›è¡Œå¤æ‚çš„æ•°æ®è½¬æ¢ä¸æŸ¥è¯¢ã€‚<br>æ‰©å±•ä¸è£å‰ªï¼šåˆç†ä½¿ç”¨æ•°ç»„æ‰©å±•å’Œè£å‰ªæ–¹æ³•ï¼Œé¿å…ä¸å¿…è¦çš„é‡å¤è®¡ç®—ã€‚</p><h2 id="ä½¿ç”¨-const-å…³é”®å­—å£°æ˜å˜é‡"><a href="#ä½¿ç”¨-const-å…³é”®å­—å£°æ˜å˜é‡" class="headerlink" title="ä½¿ç”¨ const å…³é”®å­—å£°æ˜å˜é‡"></a>ä½¿ç”¨ const å…³é”®å­—å£°æ˜å˜é‡</h2><p>ä½¿ç”¨ const å…³é”®å­—å£°æ˜çš„å˜é‡æ˜¯ä¸å¯å˜çš„ï¼Œä¸€æ—¦èµ‹å€¼åä¸èƒ½å†è¢«ä¿®æ”¹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">PI</span> = <span class="number">3.14</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable constant_">PI</span>); <span class="comment">// è¾“å‡º: 3.14</span></span><br><span class="line"></span><br><span class="line"><span class="variable constant_">PI</span> = <span class="string">&quot;2&quot;</span>; <span class="comment">// è¿™æ¡è¯­å¥ä¼šæŠ¥é”™ï¼Œå› ä¸º `const` Â·Â· declare immutable variable</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ !+ è¿ç®—ç¬¦å’Œ let å…³é”®å­—<br>ä½¿ç”¨ !+ è¿ç®—ç¬¦å¯ä»¥å¼ºåˆ¶å˜é‡ä¸ºæ•°å€¼ç±»å‹ï¼Œä½†ä»ç„¶å¯ä»¥é€šè¿‡åç»­èµ‹å€¼æ¥ä¿®æ”¹å…¶å€¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> greeting = !+ <span class="string">&quot;Hello&quot;</span>; <span class="comment">// å°†å­—ç¬¦ä¸²è½¬ä¸ºæ•°å­—å¹¶å­˜å‚¨åˆ° `greeting` å˜é‡ä¸­ã€‚</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(greeting); <span class="comment">// è¾“å‡º: 72ï¼ˆ&#x27;H&#x27;çš„ASCIIç ï¼‰</span></span><br><span class="line"></span><br><span class="line">greeting = !+ <span class="string">&quot;World&quot;</span>; <span class="comment">// å¯ä»¥ä¿®æ”¹å˜é‡å€¼</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(greeting); <span class="comment">// è¾“å‡º: 87</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ var å…³é”®å­—<br>ä½¿ç”¨ var å…³é”®å­—å£°æ˜çš„å˜é‡åœ¨ç°ä»£JavaScriptä¸­ä¸è¢«æ¨èï¼Œå› ä¸ºå®ƒå¯èƒ½å¯¼è‡´ä»£ç ä¸å¯å˜ã€‚å»ºè®®ä½¿ç”¨ const æˆ– letã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="variable constant_">PI</span> = <span class="number">3.14</span>; <span class="comment">// è¿™æ¡è¯­å¥ä¼šæŠ¥é”™ï¼Œå› ä¸º `var` declare immutable variable</span></span><br></pre></td></tr></table></figure><h3 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h3><p>åœ¨JavaScriptä¸­ï¼Œâ€œå¸¸é‡â€é€šå¸¸æŒ‡çš„æ˜¯ä½¿ç”¨ const å…³é”®å­—å£°æ˜çš„ä¸å¯å˜å˜é‡ã€‚<br>ä½¿ç”¨ !+ è¿ç®—ç¬¦å¯ä»¥åœ¨å½“å‰è¯­å¢ƒä¸‹å¼ºåˆ¶å˜é‡ä¸ºæ•°å€¼ç±»å‹ï¼Œä½†å¹¶ä¸é˜»æ­¢åç»­èµ‹å€¼ä¿®æ”¹è¯¥å˜é‡çš„å€¼ã€‚</p><h2 id="jsæ•°æ®ç±»å‹åˆ†ä¸ºä¸¤å¤§ç±»"><a href="#jsæ•°æ®ç±»å‹åˆ†ä¸ºä¸¤å¤§ç±»" class="headerlink" title="jsæ•°æ®ç±»å‹åˆ†ä¸ºä¸¤å¤§ç±»"></a>jsæ•°æ®ç±»å‹åˆ†ä¸ºä¸¤å¤§ç±»</h2><p>Primitive ç±»å‹ï¼š</p><p>è¿™äº›æ˜¯ä¸å¯å˜çš„æ•°æ®ç±»å‹ï¼ŒåŒ…æ‹¬ï¼š<br>numberï¼ˆæ•°å­—ï¼‰<br>stringï¼ˆå­—ç¬¦ä¸²ï¼‰<br>booleanï¼ˆå¸ƒå°”å€¼ï¼‰<br>null<br>undefined<br>symbolï¼ˆç¬¦å·å€¼ï¼‰<br>mapï¼ˆæ˜ å°„ï¼‰<br>Object å¯¹è±¡ï¼š</p><p>è¿™äº›æ˜¯å¯å˜çš„ï¼Œå¯ä»¥åŒ…å«å±æ€§ï¼Œå¹¶ä¸”åœ¨è¿è¡Œæ—¶å¯ä»¥è¢«ä¿®æ”¹ã€‚æ„é€ å‡ºæ¥çš„å¯¹è±¡å±äºè¿™ä¸€ç±»ã€‚<br>è¯¦ç»†è¯´æ˜ï¼š<br>Primitive ç±»å‹ï¼šè¿™äº›æ˜¯ä¸å¯å˜çš„å€¼ï¼Œä¸€æ—¦èµ‹å€¼åæ— æ³•å†æ”¹å˜ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> num = <span class="number">5</span>; <span class="comment">// åŸå§‹æ•°å€¼ç±»å‹</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> num); <span class="comment">// è¾“å‡º: &quot;number&quot;</span></span><br></pre></td></tr></table></figure><p>Object å¯¹è±¡ï¼šè¿™äº›æ˜¯å¯ä»¥è¢«ä¿®æ”¹å’Œæ‰©å±•çš„å¯¹è±¡ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;&#125;;</span><br><span class="line">obj.<span class="property">name</span> = <span class="string">&quot;John&quot;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">name</span>); <span class="comment">// è¾“å‡º: &quot;John&quot;</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„äº‹é¡¹ï¼š<br>null å’Œ undefined æ˜¯ä¸¤ç§ä¸åŒçš„å€¼ï¼Œnull è¡¨ç¤ºæ²¡æœ‰å€¼ï¼Œè€Œ undefined è¡¨ç¤ºå˜é‡æœªè¢«èµ‹å€¼ã€‚<br>symbol ç±»å‹ä¸»è¦ç”¨äºæ€§èƒ½ä¼˜åŒ–å’Œä¸å¯å˜å±æ€§çš„å®ç°ã€‚</p><h2 id="æ¨¡æ¿å­—ç¬¦ä¸²"><a href="#æ¨¡æ¿å­—ç¬¦ä¸²" class="headerlink" title="æ¨¡æ¿å­—ç¬¦ä¸²"></a>æ¨¡æ¿å­—ç¬¦ä¸²</h2><p>æ¨¡æ¿å­—ç¬¦ä¸²ï¼ˆTemplate Literalsï¼‰</p><p>å®šä¹‰ï¼šä¸€ç§è¯­æ³•ç³–ï¼Œå…è®¸åœ¨å­—ç¬¦ä¸²å†…ç›´æ¥åµŒå…¥è¡¨è¾¾å¼æˆ–å˜é‡ï¼Œè€Œæ— éœ€ä½¿ç”¨æ‹¼æ¥ç¬¦æˆ–å…¶ä»–æ–¹æ³•æ‰‹åŠ¨æ‹¼æ¥ã€‚<br>è¯­æ³•ç»“æ„ï¼šä½¿ç”¨åæ–œæ \$å¼€å§‹æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œå¹¶åœ¨å…¶å†…éƒ¨æ’å…¥å˜é‡æˆ–è¡¨è¾¾å¼çš„è®¡ç®—ç»“æœã€‚</p><p>ç¤ºä¾‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> name = <span class="string">&quot;Alice&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> age = <span class="number">30</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨æ¨¡æ¿å­—ç¬¦ä¸²æ‹¼æ¥è¾“å‡º</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Name is <span class="subst">$&#123;name&#125;</span> and age is <span class="subst">$&#123;age&#125;</span>`</span>); <span class="comment">// è¾“å‡º: Nameæ˜¯Aliceï¼Œageæ˜¯30</span></span><br></pre></td></tr></table></figure><p>ä¼˜åŠ¿ï¼šç®€åŒ–æ‰‹åŠ¨æ‹¼æ¥å­—ç¬¦ä¸²çš„æ“ä½œï¼Œæé«˜ä»£ç çš„ç®€æ´æ€§å’Œå¯è¯»æ€§ã€‚</p><p>æ³¨æ„äº‹é¡¹ï¼š</p><p>åæ–œæ å‰é¢è¦åŠ åæ–œæ ï¼ˆå¦‚\$ï¼‰ä»¥è¡¨ç¤ºæ¨¡æ¿å­—ç¬¦ä¸²å¼€å§‹ã€‚<br>å¿½ç•¥ç¬¦å·é—®é¢˜æ—¶ï¼Œè®°å¾—æ£€æŸ¥å¼•å·å’Œåæ–œæ æ˜¯å¦åŒ¹é…ã€‚</p><h2 id="ç±»å‹è½¬æ¢"><a href="#ç±»å‹è½¬æ¢" class="headerlink" title="ç±»å‹è½¬æ¢"></a>ç±»å‹è½¬æ¢</h2><p>JavaScript å¯ä»¥å°†ä¸åŒç±»å‹çš„æ•°æ®ç›¸äº’è½¬æ¢ï¼š</p><p>ä½¿ç”¨ typeof æ“ä½œç¬¦å¯ä»¥è·å–å˜é‡çš„ç±»å‹ã€‚<br>ä½¿ç”¨å¸ƒå°”å€¼ (true&#x2F;false) å¯ä»¥å¼ºåˆ¶ç±»å‹è½¬æ¢ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> str = <span class="string">&quot;42&quot;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">typeof</span> str); <span class="comment">// è¾“å‡º: &quot;string&quot;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str === <span class="number">42</span>); <span class="comment">// è¾“å‡º: true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> num = <span class="string">&quot;3.14&quot;</span>; <span class="comment">// å­—ç¬¦ä¸²åˆ°æ•°å­—</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(num + <span class="string">&quot; + 5 = &quot;</span> + (num + <span class="number">5</span>)); <span class="comment">// è¾“å‡º: 8.14</span></span><br></pre></td></tr></table></figure><ol start="3"><li>å¸ƒå°”å€¼å’Œ NaN<br>NaN è¡¨ç¤ºâ€œä¸æ˜¯ä¸€ä¸ªæ•°å­—â€ï¼Œå®ƒæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ•°å€¼ç±»å‹ã€‚<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">NaN</span>); <span class="comment">// è¾“å‡º: NaN</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">NaN</span> === <span class="title class_">NaN</span>); <span class="comment">// è¾“å‡º: false (å› ä¸ºNaNä¸èƒ½æ¯”è¾ƒ)</span></span><br></pre></td></tr></table></figure>å¸ƒå°”å€¼ (true&#x2F;false) æ˜¯ç‰¹æ®Šç±»å‹çš„å˜é‡ï¼Œå®ƒä»¬æ˜¯ boolean ç±»å‹ã€‚</li></ol><p>éšå¼è½¬æ¢ï¼ˆImplicit Conversionï¼‰å’Œæ˜¾å¼è½¬æ¢ï¼ˆExplicit Conversionï¼‰æ˜¯JavaScriptä¸­å¤„ç†æ•°æ®ç±»å‹æ—¶çš„ä¸¤ç§æ–¹å¼ã€‚ä»¥ä¸‹æ˜¯å®ƒä»¬çš„åŒºåˆ«åŠç¤ºä¾‹ï¼š</p><h3 id="éšå¼è½¬æ¢ï¼š"><a href="#éšå¼è½¬æ¢ï¼š" class="headerlink" title="éšå¼è½¬æ¢ï¼š"></a>éšå¼è½¬æ¢ï¼š</h3><p>å®šä¹‰ï¼š éšå¼è½¬æ¢æ˜¯æŒ‡åœ¨ç¼–ç¨‹è¿‡ç¨‹ä¸­ï¼Œä¸åŒæ•°æ®ç±»å‹çš„å˜é‡æˆ–å€¼ä¼šè‡ªåŠ¨åœ°è½¬æ¢ä¸ºç›¸åŒçš„æ•°æ®ç±»å‹ï¼Œä»¥ä¾¿è¿›è¡Œè¿ç®—æˆ–æ“ä½œã€‚<br>ä¾‹å­ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// éšå¼è½¬æ¢ç¤ºä¾‹ 1: å­—ç¬¦ä¸²å’Œæ•°å­—ç›¸åŠ </span></span><br><span class="line"><span class="keyword">let</span> a = <span class="string">&quot;5&quot;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a + <span class="number">3</span>); <span class="comment">// è¾“å‡ºæ˜¯&quot;8&quot;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œï¼Œâ€œ5â€è¢«éšå¼åœ°è½¬æ¢ä¸ºæ•°å­—5ï¼Œç„¶åä¸3ç›¸åŠ ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// éšå¼è½¬æ¢ç¤ºä¾‹ 2: å­—ç¬¦ä¸²æ¯”è¾ƒ</span></span><br><span class="line"><span class="keyword">let</span> b = <span class="string">&quot;apple&quot;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(b &gt; <span class="string">&quot;banana&quot;</span>); <span class="comment">// è¾“å‡ºæ˜¯false</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œï¼Œâ€œappleâ€è¢«éšå¼åœ°è½¬æ¢ä¸ºå­—ç¬¦ä¸²â€œappleâ€ï¼Œä¸â€œbananaâ€è¿›è¡Œæ¯”è¾ƒã€‚</p><h3 id="æ˜¾å¼è½¬æ¢ï¼š"><a href="#æ˜¾å¼è½¬æ¢ï¼š" class="headerlink" title="æ˜¾å¼è½¬æ¢ï¼š"></a>æ˜¾å¼è½¬æ¢ï¼š</h3><p>å®šä¹‰ï¼š æ˜¾å¼è½¬æ¢æ˜¯æŒ‡é€šè¿‡ç‰¹å®šçš„å‡½æ•°æˆ–è¿ç®—ç¬¦å°†æ•°æ®ä»ä¸€ç§ç±»å‹å¼ºåˆ¶è½¬æ¢åˆ°å¦ä¸€ç§ç±»å‹ã€‚</p><p>ç¤ºä¾‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ˜¾å¼è½¬æ¢ç¤ºä¾‹ 1: ä½¿ç”¨Number()å‡½æ•°å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—</span></span><br><span class="line"><span class="keyword">let</span> c = <span class="string">&quot;7&quot;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Number</span>(c)); <span class="comment">// è¾“å‡ºæ˜¯7</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ˜¾å¼è½¬æ¢ç¤ºä¾‹ 2: ä½¿ç”¨å¼ºåˆ¶ç±»å‹è½¬æ¢è¿ç®—ç¬¦++</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(+â€œ<span class="number">5</span>â€); <span class="comment">// è¾“å‡ºæ˜¯5</span></span><br><span class="line"><span class="variable constant_">JAVASCRIPT</span></span><br><span class="line"><span class="comment">// æ˜¾å¼è½¬æ¢ç¤ºä¾‹ 3: ä½¿ç”¨parseInt()å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•´æ•°</span></span><br><span class="line"><span class="keyword">let</span> d = <span class="string">&quot;10&quot;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="built_in">parseInt</span>(d, <span class="number">10</span>)); <span class="comment">// è¾“å‡ºæ˜¯10</span></span><br></pre></td></tr></table></figure><p>æ€»ç»“ï¼š</p><p>éšå¼è½¬æ¢åœ¨ç¼–ç¨‹è¿‡ç¨‹ä¸­è‡ªåŠ¨å‘ç”Ÿï¼Œæ— éœ€é¢å¤–çš„ä»£ç ã€‚å®ƒé€‚ç”¨äºè¿ç®—å’Œæ¯”è¾ƒæ“ä½œã€‚<br>æ˜¾å¼è½¬æ¢éœ€è¦é€šè¿‡ç‰¹å®šå‡½æ•°æˆ–è¿ç®—ç¬¦æ¥å®Œæˆï¼Œå¯ä»¥æ›´ç²¾ç¡®åœ°æ§åˆ¶æ•°æ®ç±»å‹ï¼Œä½†å¯èƒ½å¢åŠ ä»£ç å¤æ‚æ€§ã€‚</p><h2 id="é€»è¾‘è¿ç®—ç¬¦ä¸ä¼˜å…ˆçº§"><a href="#é€»è¾‘è¿ç®—ç¬¦ä¸ä¼˜å…ˆçº§" class="headerlink" title="é€»è¾‘è¿ç®—ç¬¦ä¸ä¼˜å…ˆçº§"></a>é€»è¾‘è¿ç®—ç¬¦ä¸ä¼˜å…ˆçº§</h2><h3 id="å€¼è§£é‡Šï¼ˆValue-Interpretationï¼‰"><a href="#å€¼è§£é‡Šï¼ˆValue-Interpretationï¼‰" class="headerlink" title="å€¼è§£é‡Šï¼ˆValue Interpretationï¼‰"></a>å€¼è§£é‡Šï¼ˆValue Interpretationï¼‰</h3><p>åœ¨ JavaScript ä¸­ï¼Œè®¸å¤šæ“ä½œéƒ½ä¼šæ¶‰åŠå¯¹ä¸åŒç±»å‹çš„å€¼è¿›è¡Œâ€œå€¼è§£é‡Šâ€ã€‚è¿™ç§è§£é‡Šè¿‡ç¨‹ç¡®ä¿è¿ç®—å¯ä»¥åœ¨ç»Ÿä¸€çš„æ•°æ®ç±»å‹ä¸‹æ‰§è¡Œã€‚</p><p>ç¤ºä¾‹ï¼š</p><p>æ¯”è¾ƒè¿ç®—ç¬¦ï¼šå½“ä½¿ç”¨ &#x3D;&#x3D; æˆ– &#x3D;&#x3D;&#x3D; è¿›è¡Œæ¯”è¾ƒæ—¶ï¼ŒJavaScript ä¼šå°†ä¸¤ä¸ªæ“ä½œæ•°è½¬æ¢ä¸ºç›¸åŒçš„æ•°æ®ç±»å‹ï¼ˆé€šå¸¸æ˜¯æ•°å€¼æˆ–å­—ç¬¦ä¸²ï¼‰åå†è¿›è¡Œæ¯”è¾ƒã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;5&quot;</span> == <span class="number">5</span>); <span class="comment">// è¾“å‡ºï¼štrue (å€¼è§£é‡Š)</span></span><br></pre></td></tr></table></figure><p>å­—ç¬¦ä¸²æ‹¼æ¥ï¼šå½“ä½¿ç”¨ + è¿ç®—ç¬¦å°†ä¸€ä¸ªæ•°å€¼å’Œä¸€ä¸ªå­—ç¬¦ä¸²ç›¸åŠ æ—¶ï¼ŒJavaScript ä¼šå°†æ•°å€¼è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">3</span> + <span class="string">&quot;2&quot;</span>); <span class="comment">// è¾“å‡ºï¼š&quot;5&quot;</span></span><br></pre></td></tr></table></figure><p>å¸ƒå°”è¿ç®—ï¼šåœ¨æ¡ä»¶è¿ç®—ä¸­ï¼ˆå¦‚ &amp;&amp;, ||, å’Œ !ï¼‰ï¼ŒJavaScript ä¼šå°†æŸäº›å€¼è§£é‡Šä¸ºå¸ƒå°”å€¼ã€‚ä¾‹å¦‚ï¼Œæ•°å­—ã€ç©ºå­—ç¬¦ä¸²ã€æ•°ç»„ç­‰ä¼šè¢«è½¬æ¢ä¸º true æˆ– falseã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">0</span> || <span class="string">&quot;hello&quot;</span>); <span class="comment">// è¾“å‡ºï¼š&quot;hello&quot;</span></span><br></pre></td></tr></table></figure><p>æ€»ç»“ï¼š</p><p>å€¼è§£é‡Šç¡®ä¿è¿ç®—å¯ä»¥åœ¨ä¸€è‡´çš„æ•°æ®ç±»å‹ä¸‹æ‰§è¡Œã€‚<br>ä¸åŒç±»å‹çš„å€¼åœ¨è¿ç®—ä¸­ä¼šè‡ªåŠ¨è½¬æ¢ï¼Œä½†è¿™ç§è½¬æ¢æ˜¯éšå¼çš„ï¼Œä¸æ˜¯æ˜¾å¼çš„ã€‚</p><h3 id="é€»è¾‘è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§"><a href="#é€»è¾‘è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§" class="headerlink" title="é€»è¾‘è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§"></a>é€»è¾‘è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§</h3><p>JavaScript çš„é€»è¾‘è¿ç®—ç¬¦ (&amp;&amp;, ||, å’Œ !) çš„ä¼˜å…ˆçº§ä½äºç®—æœ¯ã€æ¯”è¾ƒå’Œå­—ç¬¦ä¸²æ“ä½œç¬¦ã€‚ç†è§£è¿™ä¸€ç‚¹å¯ä»¥å¸®åŠ©ä½ å‡†ç¡®é¢„æµ‹è¡¨è¾¾å¼çš„æ‰§è¡Œé¡ºåºã€‚</p><p>ç¤ºä¾‹ï¼š<br>ä»¥ä¸‹è¡¨è¾¾å¼ä¸­ï¼Œtypeof null å’Œ typeof undefined åˆ†åˆ«ä¼šè¢«è®¡ç®—ä¸º â€œobjectâ€ å’Œ â€œundefinedâ€ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typeof</span> <span class="literal">null</span> === <span class="string">&#x27;object&#x27;</span> &amp;&amp; <span class="keyword">typeof</span> <span class="literal">undefined</span> === <span class="string">&#x27;undefined&#x27;</span>; <span class="comment">// è¾“å‡ºï¼štrue</span></span><br></pre></td></tr></table></figure><p>è¿ç®—ç¬¦ä¼˜å…ˆçº§æ€»ç»“ï¼ˆä»é«˜åˆ°ä½ï¼‰ï¼š<br>ç®—æœ¯è¿ç®—ç¬¦ (+, -, *, &#x2F;, %, ** ç­‰)<br>æ¯”è¾ƒè¿ç®—ç¬¦ (&gt;, &lt;, &#x3D;&#x3D;, &#x3D;&#x3D;&#x3D;, !&#x3D;, !&#x3D;&#x3D;)<br>è¿ç®—ç¬¦ (&amp;, |, ^, ~)<br>å­—ç¬¦ä¸²æ“ä½œç¬¦ ([], ., () ç­‰)<br>é€»è¾‘è¿ç®—ç¬¦ (&amp;&amp;, ||, !)<br>æ‹¬å·</p><p>ç¤ºä¾‹ï¼š</p><p>ä»¥ä¸‹è¡¨è¾¾å¼çš„æ‰§è¡Œé¡ºåºéµå¾ªè¿ç®—ç¬¦çš„ä¼˜å…ˆçº§ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span> + <span class="number">3</span> &gt; <span class="number">5</span> &amp;&amp; <span class="string">&quot;10&quot;</span> &lt; <span class="string">&quot;2&quot;</span>); <span class="comment">// è¾“å‡ºï¼šfalse</span></span><br></pre></td></tr></table></figure><p>é¦–å…ˆè®¡ç®— 2 + 3ï¼ˆç»“æœä¸º 5ï¼‰ã€‚<br>ç„¶åæ¯”è¾ƒ 5 &gt; 5ï¼Œç»“æœä¸º falseã€‚<br>æœ€åæ‰§è¡Œé€»è¾‘ä¸è¿ç®— (&amp;&amp;)ï¼Œå› ä¸ºå‰ä¸€ä¸ªæ¡ä»¶ä¸º falseï¼Œæ•´ä¸ªè¡¨è¾¾å¼çš„ç»“æœä¸º falseã€‚</p><h3 id="è¿ç®—ç¬¦ä¼˜å…ˆçº§æ€»ç»“"><a href="#è¿ç®—ç¬¦ä¼˜å…ˆçº§æ€»ç»“" class="headerlink" title="è¿ç®—ç¬¦ä¼˜å…ˆçº§æ€»ç»“"></a>è¿ç®—ç¬¦ä¼˜å…ˆçº§æ€»ç»“</h3><p>ä»¥ä¸‹æ˜¯ JavaScript ä¸­ä¸»è¦è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§ï¼ˆä»é«˜åˆ°ä½ï¼‰ï¼š</p><p>ç®—æœ¯è¿ç®—ç¬¦ï¼š<br>+, -, *, &#x2F;, %, **<br>æ¯”è¾ƒè¿ç®—ç¬¦ï¼š<br>&lt;, &gt;, &#x3D;&#x3D;, &#x3D;&#x3D;&#x3D;, !&#x3D;, !&#x3D;&#x3D;<br>è¿ç®—ç¬¦ï¼š<br>&amp;, |, ^, ~, &lt;&lt;, &gt;&gt;, &gt;&gt;&gt;,<br>å­—ç¬¦ä¸²æ“ä½œç¬¦ï¼š<br>[], ., ()<br>é€»è¾‘è¿ç®—ç¬¦ï¼š<br>&amp;&amp;, ||  !<br>æ‹¬å· (())ï¼šç”¨äºæ”¹å˜æ‰§è¡Œé¡ºåº</p><p>ç¤ºä¾‹ï¼š</p><p>ä»¥ä¸‹è¡¨è¾¾å¼ä¸­ï¼Œtypeof null &#x3D;&#x3D;&#x3D; â€˜objectâ€™ &amp;&amp; typeof undefined &#x3D;&#x3D;&#x3D; â€˜undefinedâ€™ çš„ä¼˜å…ˆçº§å¦‚ä¸‹ï¼š</p><p>é¦–å…ˆè®¡ç®— typeof nullï¼ˆç»“æœä¸º â€œobjectâ€ï¼‰ã€‚<br>ç„¶åè®¡ç®— typeof undefinedï¼ˆç»“æœä¸º â€œundefinedâ€ï¼‰ã€‚<br>æœ€åæ‰§è¡Œé€»è¾‘ä¸è¿ç®— (&amp;&amp;)ã€‚</p><h3 id="å¸¸è§é—®é¢˜"><a href="#å¸¸è§é—®é¢˜" class="headerlink" title="å¸¸è§é—®é¢˜"></a>å¸¸è§é—®é¢˜</h3><p>é—®é¢˜1ï¼šä¸ºä»€ä¹ˆ null || undefined çš„ç»“æœæ˜¯ undefinedï¼Ÿ<br>è¿™æ˜¯å› ä¸ºé€»è¾‘æˆ–è¿ç®—ç¬¦ (||) åœ¨é‡åˆ° falseï¼ˆæˆ–ç©ºå€¼ï¼‰æ—¶ä¼šä¼˜å…ˆè¿”å›åé¢çš„å€¼ã€‚åœ¨ JavaScript ä¸­ï¼š</p><p>typeof null &#x3D;&#x3D;&#x3D; â€˜objectâ€™ï¼Œä½†åœ¨é€»è¾‘è¿ç®—ä¸­ä¼šè¢«è§£é‡Šä¸º falseã€‚<br>typeof undefined &#x3D;&#x3D;&#x3D; â€˜undefinedâ€™ã€‚</p><p>å› æ­¤ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">null</span> || <span class="literal">undefined</span>; <span class="comment">// è¾“å‡ºï¼šundefined</span></span><br></pre></td></tr></table></figure><p>é—®é¢˜2ï¼šä¸ºä»€ä¹ˆ â€œ5â€ + â€œ6â€ çš„ç»“æœæ˜¯ â€œ11â€ï¼Ÿ<br>è¿™æ˜¯å› ä¸ºå­—ç¬¦ä¸²æ‹¼æ¥çš„ä¼˜å…ˆçº§ä½äºç®—æœ¯åŠ æ³•ã€‚JavaScript ä¼šå°†ä¸¤ä¸ªå­—ç¬¦ä¸²ç›¸åŠ ï¼Œè€Œä¸æ˜¯å°è¯•å°†å®ƒä»¬è½¬æ¢ä¸ºæ•°å€¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;5&quot;</span> + <span class="string">&quot;6&quot;</span>); <span class="comment">// è¾“å‡ºï¼š&quot;11&quot;</span></span><br></pre></td></tr></table></figure><p>é—®é¢˜3ï¼šä¸ºä»€ä¹ˆ 0 || â€œâ€ çš„ç»“æœæ˜¯ â€œâ€ï¼Ÿ<br>è¿™æ˜¯å› ä¸ºé€»è¾‘æˆ–è¿ç®—ç¬¦ (||) åœ¨é‡åˆ° falseï¼ˆæˆ–ç©ºå€¼ï¼‰æ—¶ä¼šä¼˜å…ˆè¿”å›åé¢çš„å€¼ã€‚åœ¨è¿™é‡Œï¼š</p><p>0 è¢«è§†ä¸º falseã€‚<br>â€œ â€œ è¢«è§†ä¸ºéç©ºå­—ç¬¦ä¸²ï¼Œå› æ­¤ä¼šè¢«è¿”å›ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">0</span> || <span class="string">&quot;&quot;</span>); <span class="comment">// è¾“å‡ºï¼š&quot;&quot;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> JS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScriptåŸºç¡€é˜¶æ®µäºŒ</title>
      <link href="/2025/03/01/JavaScript/%E5%88%86%E6%94%AF%E4%B8%8E%E5%BE%AA%E7%8E%AF/"/>
      <url>/2025/03/01/JavaScript/%E5%88%86%E6%94%AF%E4%B8%8E%E5%BE%AA%E7%8E%AF/</url>
      
        <content type="html"><![CDATA[<h1 id="åˆ†æ”¯è¯­å¥å’Œå¾ªç¯è¯­å¥"><a href="#åˆ†æ”¯è¯­å¥å’Œå¾ªç¯è¯­å¥" class="headerlink" title="åˆ†æ”¯è¯­å¥å’Œå¾ªç¯è¯­å¥"></a>åˆ†æ”¯è¯­å¥å’Œå¾ªç¯è¯­å¥</h1><h2 id="é€æ­¥è§£å†³æ–¹æ¡ˆ"><a href="#é€æ­¥è§£å†³æ–¹æ¡ˆ" class="headerlink" title="é€æ­¥è§£å†³æ–¹æ¡ˆ"></a>é€æ­¥è§£å†³æ–¹æ¡ˆ</h2><p>æ­¥éª¤ 1ï¼šç†è§£åˆ†æ”¯è¯­å¥</p><p>æ¡ä»¶åˆ¤æ–­ï¼šä½¿ç”¨ if å’Œ else if è¿›è¡Œå¤šå±‚æ¡ä»¶åˆ¤æ–­ã€‚<br>åµŒå¥—ç»“æ„ï¼šå¯ä»¥å°†åˆ†æ”¯è¯­å¥åµŒå…¥åˆ°å…¶ä»–åˆ†æ”¯ä¸­ï¼Œå®ç°å¤æ‚çš„é€»è¾‘ã€‚</p><p>æ­¥éª¤ 2ï¼šç†è§£å¾ªç¯è¯­å¥<br>é‡å¤æ‰§è¡Œï¼šä½¿ç”¨ for, while æˆ– doâ€¦while å¾ªç¯æ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæ¬¡æ•°ã€‚<br>æ¡ä»¶åˆ¤æ–­ï¼šæ ¹æ®ç‰¹å®šæ¡ä»¶å†³å®šæ˜¯å¦ç»§ç»­æ‰§è¡Œå¾ªç¯ä½“ã€‚</p><p>æ­¥éª¤ 3ï¼šç»“åˆåˆ†æ”¯ä¸å¾ªç¯<br>åµŒå¥—ç»“æ„ï¼šå°†åˆ†æ”¯è¯­å¥åµŒå…¥åˆ°å¾ªç¯ä½“å†…ï¼Œæˆ–è€…åè¿‡æ¥ä½¿ç”¨å¾ªç¯æ¥å¤„ç†åˆ†æ”¯ä¸­çš„é€»è¾‘ã€‚</p><p>æ­¥éª¤ 4ï¼šåº”ç”¨ç¤ºä¾‹ - è®¡ç®—æœ€å¤§å…¬çº¦æ•°ï¼ˆGCDï¼‰</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">gcd</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">    <span class="keyword">while</span> (b !== <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> temp = b;</span><br><span class="line">        b = a % b;</span><br><span class="line">        a = temp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ˜¾ç¤ºå…¨éƒ¨ (9)<br>æ­¥éª¤ 5ï¼šåº”ç”¨ç¤ºä¾‹ - ç»Ÿè®¡å…ƒéŸ³å­—æ¯æ•°é‡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">countVowels</span>(<span class="params">str</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> vowels = <span class="keyword">new</span> <span class="title class_">Set</span>([<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;u&#x27;</span>]);</span><br><span class="line">    <span class="keyword">let</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> char <span class="keyword">of</span> str) &#123;</span><br><span class="line">        <span class="keyword">if</span> (vowels.<span class="title function_">has</span>(char)) &#123;</span><br><span class="line">            count++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ˜¾ç¤ºå…¨éƒ¨ (11)<br>æ­¥éª¤ 6ï¼šåº”ç”¨ç¤ºä¾‹ - è®¡ç®—é˜¶ä¹˜</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">factorial</span>(<span class="params">n</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;Factorial not defined for negative values.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> result = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        result *= i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ˜¾ç¤ºå…¨éƒ¨ (11)<br>æœ€ç»ˆç­”æ¡ˆ<br>é€šè¿‡æŒæ¡åˆ†æ”¯è¯­å¥å’Œå¾ªç¯è¯­å¥çš„ä½¿ç”¨ï¼Œå¯ä»¥æœ‰æ•ˆåœ°è§£å†³é—®é¢˜ã€‚ä»¥ä¸‹æ˜¯å¯¹é—®é¢˜çš„é€æ­¥è§£ç­”ï¼š</p><p>åˆ†æ”¯è¯­å¥ï¼šç”¨äºåœ¨ç¨‹åºè¿è¡Œä¸­æ ¹æ®æ¡ä»¶æ‰§è¡Œä¸åŒçš„ä»£ç å—ã€‚<br>å¾ªç¯è¯­å¥ï¼šç”¨äºé‡å¤æ‰§è¡ŒåŒä¸€æ®µä»£ç ï¼Œç›´åˆ°æ»¡è¶³ç‰¹å®šæ¡ä»¶ã€‚<br>åµŒå¥—ç»“æ„ï¼šå°†åˆ†æ”¯å’Œå¾ªç¯åµŒå…¥åˆ°å…¶ä»–ç»“æ„ä¸­ï¼Œå®ç°å¤æ‚çš„é€»è¾‘æ§åˆ¶ã€‚</p><h2 id="switch"><a href="#switch" class="headerlink" title="switch"></a>switch</h2><p>ä»€ä¹ˆæ˜¯ Switch è¯­å¥ï¼Ÿ</p><p>Switch è¯­å¥æ˜¯ä¸€ç§æ§åˆ¶ç»“æ„ï¼Œç”¨äºæ ¹æ®ä¸€ä¸ªè¡¨è¾¾å¼çš„ç»“æœæ¥æ‰§è¡Œä¸åŒçš„ä»£ç å—ã€‚å®ƒç±»ä¼¼äºå…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸­çš„å¤šè·¯é€‰æ‹©ï¼ˆå¦‚ C è¯­è¨€çš„ switch-caseï¼‰ã€‚</p><p>åŸºæœ¬è¯­æ³•</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> (expression) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="attr">value1</span>:</span><br><span class="line">        <span class="comment">// æ‰§è¡Œçš„ä»£ç å—</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="attr">value2</span>:</span><br><span class="line">        <span class="comment">// æ‰§è¡Œçš„ä»£ç å—</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">        <span class="comment">// é»˜è®¤æ‰§è¡Œçš„ä»£ç å—</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŠŸèƒ½è¯´æ˜<br>expressionï¼šä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå…¶ç»“æœå†³å®šäº†æ‰§è¡Œå“ªä¸ª caseã€‚<br>value1, value2 ç­‰ï¼šå¯èƒ½æ˜¯ä¸€ä¸ªå…·ä½“çš„å€¼æˆ–ä¸€ä¸ªæ¨¡å¼åŒ¹é…çš„ç»“æœã€‚<br>break;ï¼šç»“æŸå½“å‰çš„ caseï¼Œå¹¶æ‰§è¡Œä¸‹ä¸€ä¸ªä»£ç å—ã€‚<br>ä¸ if-else çš„åŒºåˆ«<br>Switch è¯­å¥å…è®¸å¤šä¸ª caseï¼Œå¹¶ä¸”æ¯ä¸ª case å¯ä»¥æœ‰å¤æ‚çš„æ¨¡å¼åŒ¹é…ï¼ˆå¦‚æ­£åˆ™è¡¨è¾¾å¼ï¼‰ã€‚æ­¤å¤–ï¼Œswitch è¯­å¥è¿˜èƒ½ä½¿ç”¨ default æ ‡è¯†ç¬¦æ¥å¤„ç†æ‰€æœ‰æœªåŒ¹é…çš„æƒ…å†µã€‚</p><p>ç¤ºä¾‹ 1ï¼šç®€å• switch è¯­å¥</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> age = <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span> (age) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>-<span class="number">19</span>:</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å°äº20å²çš„äºº&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">20</span>-<span class="number">29</span>:</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;20å²åˆ°29å²çš„å¹´è½»äºº&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å…¶ä»–äºº&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><p>TEXT<br>20å²åˆ°29å²çš„å¹´è½»äºº<br>ç¤ºä¾‹ 2ï¼šä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> str = <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span>(str) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="regexp">/^H/</span>:</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ä»¥Hå¼€å¤´çš„å­—ç¬¦ä¸²&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ä¸ä»¥Hå¼€å¤´çš„å­—ç¬¦ä¸²&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><p>TEXT<br>ä»¥Hå¼€å¤´çš„å­—ç¬¦ä¸²<br>ç¤ºä¾‹ 3ï¼šç»„åˆ switch å’Œ if</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> score = <span class="number">85</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span>(score) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">100</span>:</span><br><span class="line">    <span class="keyword">case</span> <span class="number">90</span>-<span class="number">100</span>:</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;æ»¡åˆ†&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">80</span>-<span class="number">89</span>:</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ä¼˜ç§€&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ä¸€èˆ¬&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (score &gt;= <span class="number">60</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;åŠæ ¼&quot;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ä¸åŠæ ¼&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ 4ï¼šä½¿ç”¨ switch å¤„ç†ä¸åŒç±»å‹çš„æ•°æ®</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> data = <span class="string">&quot;integer&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span>(data) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;integer&#x27;</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;float&#x27;</span>:</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;æ•°æ®ç±»å‹ä¸º number&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;string&#x27;</span>:</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;æ•°æ®ç±»å‹ä¸º string&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;æœªçŸ¥çš„æ•°æ®ç±»å‹&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ•°æ®ç±»å‹ä¸º number</span><br></pre></td></tr></table></figure><p>æ€»ç»“</p><p>Switch è¯­å¥éå¸¸é€‚åˆå¤„ç†éœ€è¦æ ¹æ®å¤šä¸ªæ¡ä»¶æ‰§è¡Œä¸åŒä»£ç å—çš„åœºæ™¯ï¼Œå°¤å…¶æ˜¯å½“è¿™äº›æ¡ä»¶å¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æˆ–å¤æ‚çš„æ¨¡å¼åŒ¹é…æ—¶ã€‚å®ƒä½¿å¾—ä»£ç æ›´åŠ æ¸…æ™°å’Œæ˜“äºç»´æŠ¤ã€‚</p><p>åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œswitch è¯­å¥é€šå¸¸ç”¨äºï¼š</p><p>æ ¹æ®æ•°æ®ç±»å‹ï¼ˆå¦‚ number, string, object ç­‰ï¼‰è¿›è¡Œåˆ†ç±»ã€‚<br>æ ¹æ®è¾“å…¥çš„å€¼èŒƒå›´ï¼ˆå¦‚å¹´é¾„ã€åˆ†æ•°ç­‰ï¼‰è¿›è¡Œåˆ†ç»„å¤„ç†ã€‚<br>å¤„ç†éœ€è¦å¤šä¸ªåˆ†æ”¯æ¡ä»¶çš„æƒ…å†µï¼Œä¸”è¿™äº›æ¡ä»¶å¯ä»¥å¤ç”¨ã€‚</p><h2 id="ä¸‰å…ƒè¿ç®—ç¬¦"><a href="#ä¸‰å…ƒè¿ç®—ç¬¦" class="headerlink" title="ä¸‰å…ƒè¿ç®—ç¬¦"></a>ä¸‰å…ƒè¿ç®—ç¬¦</h2><p>ä¸‰å…ƒè¿ç®—ç¬¦æ˜¯ä¸€ç§åœ¨JavaScriptä¸­ç”¨äºåœ¨ä¸¤ç§æƒ…å†µä¹‹é—´é€‰æ‹©ä¸€ä¸ªå€¼çš„è¿ç®—ç¬¦ã€‚å®ƒæ˜¯ä¸€ç§ç®€æ´çš„æ¡ä»¶è¡¨è¾¾å¼ï¼Œå¯ä»¥å°†ä¸€ä¸ª if è¯­å¥å‹ç¼©ä¸ºä¸€è¡Œä»£ç ã€‚</p><p>è¯­æ³•</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">condition ? expression_if_true : expression_if_false</span><br></pre></td></tr></table></figure><p>conditionï¼šä¸€ä¸ªéœ€è¦è¿›è¡Œåˆ¤æ–­çš„è¡¨è¾¾å¼ï¼ˆé€šå¸¸æ˜¯å¸ƒå°”å€¼ï¼‰ã€‚<br>expression_if_trueï¼šå¦‚æœ condition ä¸ºçœŸæ—¶æ‰§è¡Œçš„è¡¨è¾¾å¼ã€‚<br>expression_if_falseï¼šå¦‚æœ condition ä¸ºå‡æ—¶æ‰§è¡Œçš„è¡¨è¾¾å¼ã€‚</p><p>åŠŸèƒ½</p><p>ä¸‰å…ƒè¿ç®—ç¬¦å¯ä»¥å°†ä¸€ä¸ªå¤æ‚çš„ ifâ€¦else ç»“æ„ç®€åŒ–ä¸ºä¸€è¡Œä»£ç ï¼ŒåŒæ—¶ä¿æŒé€»è¾‘æ¸…æ™°ã€‚</p><p>ä½¿ç”¨ç¤ºä¾‹<br>ç®€å•æ¡ä»¶åˆ¤æ–­ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="number">5</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a &gt; <span class="number">0</span> ? <span class="string">&quot;a is positive&quot;</span> : <span class="string">&quot;a is not positive&quot;</span>); <span class="comment">// è¾“å‡ºï¼š&quot;a is positive&quot;</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„äº‹é¡¹<br>ä¼˜å…ˆçº§ï¼šä¸‰å…ƒè¿ç®—ç¬¦çš„ä¼˜å…ˆçº§ä½äºç®—æœ¯è¿ç®—ç¬¦ï¼ˆå¦‚ +, -, *, &#x2F; ç­‰ï¼‰ï¼Œä½†é«˜äºæ¯”è¾ƒè¿ç®—ç¬¦ã€‚å› æ­¤ï¼Œåœ¨å¤æ‚çš„è¡¨è¾¾å¼ä¸­ï¼Œå¯èƒ½éœ€è¦ä½¿ç”¨æ‹¬å·æ¥æ˜ç¡®è¿ç®—é¡ºåºã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">3</span> + <span class="number">5</span> &gt; <span class="number">2</span> ? <span class="string">&quot;çœŸ&quot;</span> : <span class="string">&quot;å‡&quot;</span>); <span class="comment">// è¾“å‡ºï¼š&quot;çœŸ&quot;</span></span><br></pre></td></tr></table></figure><p>ç®€æ´æ€§ï¼šè™½ç„¶ä¸‰å…ƒè¿ç®—ç¬¦å¯ä»¥ç®€åŒ–ä»£ç ï¼Œä½†å®ƒå¹¶ä¸æ€»æ˜¯æ›´é€‚åˆæ‰€æœ‰æƒ…å†µã€‚åœ¨å¤æ‚çš„é€»è¾‘ä¸­ï¼Œifâ€¦else ç»“æ„å¯èƒ½æ›´æ¸…æ™°æ˜“è¯»ã€‚</p><p>æ€»ç»“</p><p>ä¸‰å…ƒè¿ç®—ç¬¦æ˜¯ä¸€ç§éå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬å°† ifâ€¦else ç»“æ„å‹ç¼©ä¸ºä¸€è¡Œä»£ç ï¼Œå¹¶ä¸”ä¿æŒé€»è¾‘æ¸…æ™°ã€‚å®ƒç‰¹åˆ«é€‚åˆç®€å•çš„æ¡ä»¶åˆ¤æ–­åœºæ™¯ï¼Œä½†åœ¨å¤„ç†å¤æ‚çš„é€»è¾‘æ—¶ï¼Œå¯èƒ½ä¼šæ˜¾å¾—ä¸å¤Ÿç›´è§‚ã€‚å› æ­¤ï¼Œåœ¨ä½¿ç”¨ä¸‰å…ƒè¿ç®—ç¬¦æ—¶ï¼Œè¯·æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š</p><p>ä½¿ç”¨æ‹¬å·æ˜ç¡®è¿ç®—é¡ºåºã€‚<br>åœ¨å¤æ‚çš„é€»è¾‘ä¸­ï¼Œä¼˜å…ˆé€‰æ‹©æ¸…æ™°çš„ ifâ€¦else ç»“æ„ã€‚<br>ä¸‰å…ƒè¿ç®—ç¬¦å¯ä»¥ä¸æ•°ç»„æˆ–å¯¹è±¡è¿›è¡Œç»“åˆï¼ˆå¦‚ç»ƒä¹ é¢˜ä¸­çš„ map æˆ– filter æ–¹æ³•ï¼‰ã€‚</p><h2 id="éå†æ•°ç»„"><a href="#éå†æ•°ç»„" class="headerlink" title="éå†æ•°ç»„"></a>éå†æ•°ç»„</h2><h3 id="å¾ªç¯éå†"><a href="#å¾ªç¯éå†" class="headerlink" title="å¾ªç¯éå†"></a>å¾ªç¯éå†</h3><p>ä½¿ç”¨å¾ªç¯ç»“æ„é€ä¸ªè®¿é—®æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ã€‚</p><p>æ­¥éª¤ï¼š</p><p>åˆå§‹åŒ–ä¸€ä¸ªå˜é‡ä½œä¸ºç´¢å¼•ï¼Œé€šå¸¸ä»0å¼€å§‹ã€‚<br>ç¡®å®šå¾ªç¯ç»“æŸæ¡ä»¶ï¼Œé€šå¸¸æ˜¯ç´¢å¼•å°äºæ•°ç»„é•¿åº¦ã€‚<br>åœ¨æ¯æ¬¡è¿­ä»£ä¸­ï¼Œè®¿é—®å½“å‰ç´¢å¼•å¯¹åº”çš„å…ƒç´ ï¼Œå¹¶æ‰§è¡Œéœ€è¦çš„æ“ä½œã€‚<br>æ›´æ–°ç´¢å¼•å€¼ï¼Œç»§ç»­ä¸‹ä¸€ä¸ªå¾ªç¯ã€‚<br>ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> array = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; array.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(array[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é€’å½’éå†"><a href="#é€’å½’éå†" class="headerlink" title="é€’å½’éå†"></a>é€’å½’éå†</h3><p>é€šè¿‡å‡½æ•°è‡ªèº«è°ƒç”¨æ¥é€å±‚å¤„ç†æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ã€‚</p><p>æ­¥éª¤ï¼š</p><p>å®šä¹‰ä¸€ä¸ªé€’å½’å‡½æ•°ï¼Œæ¥å—æ•°ç»„å’Œå½“å‰ç´¢å¼•ä½œä¸ºå‚æ•°ã€‚<br>åœ¨å‡½æ•°ä¸­æ£€æŸ¥æ˜¯å¦å®Œæˆäº†æ‰€æœ‰å…ƒç´ çš„éå†ï¼ˆç»“æŸæ¡ä»¶ï¼‰ã€‚<br>å¦‚æœæœªå®Œæˆï¼Œæ‰§è¡Œå½“å‰æ“ä½œï¼Œå¹¶é€’å½’è°ƒç”¨è‡ªå·±ï¼Œå¤„ç†ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚<br>æ›´æ–°é€’å½’æ—¶ä½¿ç”¨çš„ç´¢å¼•å€¼ã€‚<br>ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">recursiveLoop</span>(<span class="params">array, index = <span class="number">0</span></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (index &gt;= array.<span class="property">length</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(array[index]);</span><br><span class="line">    <span class="title function_">recursiveLoop</span>(array, index + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> array = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="title function_">recursiveLoop</span>(array);</span><br></pre></td></tr></table></figure><p>æ€»ç»“<br>å¾ªç¯éå†é€‚åˆå¤„ç†å¤§éƒ¨åˆ†æ•°ç»„æ“ä½œï¼Œå› ä¸ºå®ƒç®€å•ä¸”æ•ˆç‡é«˜ã€‚è€Œé€’å½’éå†é€‚ç”¨äºéœ€è¦é€å±‚å¤„ç†æˆ–åˆ†é˜¶æ®µå®Œæˆä»»åŠ¡çš„æƒ…å†µï¼Œä½†éœ€æ³¨æ„é¿å…æ ˆæº¢å‡ºé—®é¢˜ã€‚</p><p>é€šè¿‡ç†è§£å’Œå®è·µè¿™ä¸¤ç§æ–¹æ³•ï¼Œå¯ä»¥æ›´å¥½åœ°æŒæ¡æ•°ç»„éå†çš„å®ç°ä¸åº”ç”¨ã€‚</p><h2 id="å¢åˆ æ”¹æŸ¥"><a href="#å¢åˆ æ”¹æŸ¥" class="headerlink" title="å¢åˆ æ”¹æŸ¥"></a>å¢åˆ æ”¹æŸ¥</h2><ol><li>å¢ï¼ˆInsertï¼‰<br>push(): å°†å…ƒç´ æ·»åŠ åˆ°æ•°ç»„æœ«å°¾ã€‚</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">arr.<span class="title function_">push</span>(<span class="number">4</span>); <span class="comment">// ç°åœ¨arræ˜¯[1, 2, 3, 4]</span></span><br></pre></td></tr></table></figure><p>unshift(): å°†å…ƒç´ æ’å…¥åˆ°æ•°ç»„æœ€å‰é¢ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">arr.<span class="title function_">unshift</span>(<span class="number">0</span>); <span class="comment">// ç°åœ¨arræ˜¯[0, 1, 2, 3]</span></span><br></pre></td></tr></table></figure><p>splice(index, [number]): åˆ é™¤æŒ‡å®šç´¢å¼•å¤„çš„å…ƒç´ ï¼Œå¹¶å°†æ–°å…ƒç´ æ’å…¥åˆ°è¯¥ä½ç½®ä¹‹å‰çš„ä½ç½®ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">arr.<span class="title function_">splice</span>(<span class="number">1</span>, <span class="number">0</span>, <span class="number">4</span>); <span class="comment">// ç°åœ¨arræ˜¯[1, 4, 2, 3]</span></span><br></pre></td></tr></table></figure><ol start="2"><li>åˆ ï¼ˆDeleteï¼‰<br>pop(): åˆ é™¤å¹¶è¿”å›æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ ã€‚</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">poppedValue = arr.<span class="title function_">pop</span>(); <span class="comment">// poppedValueæ˜¯3ï¼Œç°åœ¨arræ˜¯[1, 2]</span></span><br></pre></td></tr></table></figure><p>indexOf(element): è¿”å›æŒ‡å®šå…ƒç´ çš„ç¬¬ä¸€ä¸ªç´¢å¼•ä½ç½®ã€‚å¦‚æœæ‰¾ä¸åˆ°è¯¥å…ƒç´ ï¼Œåˆ™è¿”å›-1ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">index = arr.<span class="title function_">indexOf</span>(<span class="number">2</span>); <span class="comment">// indexæ˜¯1</span></span><br></pre></td></tr></table></figure><p>splice(index, removeItemCount&#x3D;0): åˆ é™¤æŒ‡å®šç´¢å¼•å¤„çš„å…ƒç´ ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">arr.<span class="title function_">splice</span>(<span class="number">0</span>, <span class="number">1</span>); <span class="comment">// ç°åœ¨arræ˜¯[2, 3]</span></span><br></pre></td></tr></table></figure><ol start="3"><li>æ”¹ï¼ˆUpdateï¼‰<br>ç›´æ¥èµ‹å€¼: è®¿é—®æ•°ç»„ä¸­ç‰¹å®šç´¢å¼•çš„ä½ç½®å¹¶å°†å…¶å€¼ä¿®æ”¹ã€‚</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">arr[<span class="number">0</span>] = <span class="number">4</span>; <span class="comment">// ç°åœ¨arræ˜¯[4, 2, 3]</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨slice()å’Œconcat(): å¤åˆ¶æ•°ç»„çš„ä¸€éƒ¨åˆ†ï¼Œä¿®æ”¹åçš„å†…å®¹å†åˆå¹¶å›åŸæ•°ç»„ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> updatedPart = arr.<span class="title function_">slice</span>(<span class="number">0</span>, <span class="number">1</span>); <span class="comment">// å–å‰ä¸¤ä¸ªå…ƒç´ </span></span><br><span class="line">updatedPart[<span class="number">0</span>] = <span class="number">5</span>; <span class="comment">// ä¿®æ”¹ç¬¬ä¸€ä¸ªå…ƒç´ ä¸º5</span></span><br></pre></td></tr></table></figure><p>arr &#x3D; updatedPart.concat(arr.slice(1)); &#x2F;&#x2F; ç°åœ¨arræ˜¯[5, 3]</p><ol start="4"><li>æŸ¥ï¼ˆSearchï¼‰</li></ol><p>indexOf(element): è¿”å›æŒ‡å®šå…ƒç´ çš„ç¬¬ä¸€ä¸ªç´¢å¼•ä½ç½®ï¼Œæˆ–-1è¡¨ç¤ºä¸å­˜åœ¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">index = arr.<span class="title function_">indexOf</span>(<span class="number">2</span>); <span class="comment">// indexæ˜¯1</span></span><br></pre></td></tr></table></figure><p>includes(element): è¿”å›å¸ƒå°”å€¼ï¼Œåˆ¤æ–­æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨è¯¥å…ƒç´ ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr.<span class="title function_">includes</span>(<span class="number">4</span>)); <span class="comment">// è¾“å‡ºfalse</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡è¿™äº›æ–¹æ³•çš„å­¦ä¹ å’Œå®è·µï¼Œå¯ä»¥é«˜æ•ˆåœ°è¿›è¡Œæ•°ç»„çš„å¢åˆ æ”¹æŸ¥æ“ä½œã€‚é€‰æ‹©åˆé€‚çš„æ–¹æ³•æ ¹æ®å…·ä½“éœ€æ±‚ï¼Œæ—¢èƒ½æé«˜ä»£ç æ•ˆç‡ï¼Œä¹Ÿèƒ½è®©ä»£ç æ›´åŠ ç®€æ´æ˜“æ‡‚ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> JS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ³›å‹ï¼Œpartialç±»ï¼Œæšä¸¾ï¼Œç»“æ„</title>
      <link href="/2025/02/21/csharp%E5%85%A5%E9%97%A8%E8%AF%A6%E8%A7%A3/%E6%B3%9B%E5%9E%8B%EF%BC%8Cpartial%E7%B1%BB%EF%BC%8C%E6%9E%9A%E4%B8%BE%EF%BC%8C%E7%BB%93%E6%9E%84/"/>
      <url>/2025/02/21/csharp%E5%85%A5%E9%97%A8%E8%AF%A6%E8%A7%A3/%E6%B3%9B%E5%9E%8B%EF%BC%8Cpartial%E7%B1%BB%EF%BC%8C%E6%9E%9A%E4%B8%BE%EF%BC%8C%E7%BB%93%E6%9E%84/</url>
      
        <content type="html"><![CDATA[<h1 id="æ³›å‹ï¼ˆgenericï¼‰æ— å¤„ä¸åœ¨"><a href="#æ³›å‹ï¼ˆgenericï¼‰æ— å¤„ä¸åœ¨" class="headerlink" title="æ³›å‹ï¼ˆgenericï¼‰æ— å¤„ä¸åœ¨"></a>æ³›å‹ï¼ˆgenericï¼‰æ— å¤„ä¸åœ¨</h1><p>ä¸ºä»€ä¹ˆéœ€è¦æ³›å‹ï¼šé¿å…æˆå‘˜è†¨èƒ€æˆ–è€…ç±»å‹è†¨èƒ€<br>æ­£äº¤æ€§ï¼šæ³›å‹ç±»å‹ï¼ˆç±»&#x2F;æ¥å£&#x2F;å§”æ‰˜&#x2F;Â·Â·Â·ï¼‰ã€æ³›å‹æˆå‘˜ï¼ˆå±æ€§&#x2F;æ–¹æ³•&#x2F;å­—æ®µ&#x2F;Â·Â·Â·ï¼‰<br>ç±»å‹æ–¹æ³•çš„å‚æ•°æ¨æ–­<br>æ³›å‹ä¸å§”æ‰˜ã€lambdaè¡¨è¾¾å¼</p><p>æ³›å‹åŸºæœ¬ä½¿ç”¨<br><img src="/img%5CHello%5CSnipaste_2025-02-21_13-19-57.png"></p><h2 id="æ³›å‹æ¥å£"><a href="#æ³›å‹æ¥å£" class="headerlink" title="æ³›å‹æ¥å£"></a>æ³›å‹æ¥å£</h2><p>æ³›å‹æœ‰è‰¯å¥½çš„æ­£äº¤æ€§</p><p><img src="/img%5CHello%5CSnipaste_2025-02-21_13-34-30.png"></p><h2 id="æ³›å‹æ•°ç»„"><a href="#æ³›å‹æ•°ç»„" class="headerlink" title="æ³›å‹æ•°ç»„"></a>æ³›å‹æ•°ç»„</h2><p><img src="/img%5CHello%5CSnipaste_2025-02-21_13-45-15.png"></p><h2 id="æ³›å‹å§”æ‰˜"><a href="#æ³›å‹å§”æ‰˜" class="headerlink" title="æ³›å‹å§”æ‰˜"></a>æ³›å‹å§”æ‰˜</h2><p><img src="/img%5CHello%5CSnipaste_2025-02-21_14-50-02.png"></p><h1 id="partialç±»"><a href="#partialç±»" class="headerlink" title="partialç±»"></a>partialç±»</h1><p>å‡å°‘ç±»çš„æ´¾ç”Ÿ<br>partialç±»ä¸Entity Framework<br>partialç±»ä¸Windows Forms,WPF,ASP.NET Core</p><p>æ­¥éª¤ä¸€ï¼šç†è§£â€œPartialâ€åœ¨ç¼–ç¨‹ä¸­çš„å¸¸è§ç”¨æ³•</p><p>â€œPartialâ€é€šå¸¸ç”¨äºè¡¨ç¤ºæŸç§éƒ¨åˆ†æ€§ã€ä¸å®Œæ•´æˆ–åå¯¼æ•°çš„æ¦‚å¿µã€‚åœ¨æ•°å­¦ä¸­ï¼Œåå¯¼æ•°æŒ‡çš„æ˜¯å¤šå˜é‡å‡½æ•°å¯¹å…¶ä¸­ä¸€ä¸ªå˜é‡çš„å¯¼æ•°ã€‚<br>æ­¥éª¤äºŒï¼šæŸ¥æ‰¾C#ä¸­çš„ç›¸å…³ç±»å‹å’Œå‘½åconventions</p><p>åœ¨C#æ ‡å‡†åº“ä¸­ï¼Œæ²¡æœ‰åä¸ºâ€œPartialâ€çš„å†…ç½®ç±»å‹ã€‚<br>ç¬¬ä¸‰æ–¹åº“æˆ–è‡ªå®šä¹‰é¡¹ç›®å¯èƒ½ä¼šå¼•å…¥åä¸ºâ€œPartialâ€çš„ç±»æˆ–ç»“æ„ã€‚<br>æ­¥éª¤ä¸‰ï¼šæ¨æµ‹â€œPartialâ€ç±»å¯èƒ½çš„åŠŸèƒ½</p><p>å‡è®¾è¿™æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„æ•°æ®ç»“æ„ï¼Œç”¨äºè¡¨ç¤ºæŸç§éƒ¨åˆ†çŠ¶æ€ã€è®°å½•å˜åŒ–æˆ–è€…å­˜å‚¨ä¸­é—´ç»“æœã€‚<br>å¯èƒ½ä¸å¤šçº¿ç¨‹ã€äº‹ä»¶å¤„ç†æˆ–å…¶ä»–éœ€è¦éƒ¨åˆ†æ‰§è¡Œçš„ç»“æœç›¸å…³ã€‚<br>æ­¥éª¤å››ï¼šéªŒè¯å‡è®¾</p><p>æŸ¥æ‰¾é¡¹ç›®æ–‡æ¡£æˆ–ä»£ç åº“ä¸­çš„å®šä¹‰ï¼Œç¡®è®¤â€œPartialâ€ç±»çš„å…·ä½“ç”¨é€”å’Œå®ç°ç»†èŠ‚ã€‚<br>å¦‚æœæ‰¾ä¸åˆ°æ˜ç¡®çš„å®šä¹‰ï¼Œå¯èƒ½éœ€è¦è¿›ä¸€æ­¥è¯¢é—®å¼€å‘è€…æˆ–æŸ¥çœ‹ä½¿ç”¨åœºæ™¯ã€‚<br>æ€»ç»“ï¼š</p><p>åœ¨C#ä¸­ï¼Œâ€œPartialâ€ä½œä¸ºä¸€ä¸ªç±»åé€šå¸¸æ²¡æœ‰æ ‡å‡†çš„æ„ä¹‰ã€‚å®ƒå¯èƒ½æ˜¯è‡ªå®šä¹‰çš„ã€ç”¨äºç‰¹å®šä¸šåŠ¡é€»è¾‘çš„æ•°æ®ç»“æ„ã€‚ä¸ºäº†ç¡®åˆ‡ç†è§£å®ƒçš„ä½œç”¨ï¼Œè¯·å‚è€ƒé¡¹ç›®æ–‡æ¡£æˆ–ç›¸å…³ä»£ç ã€‚</p><h1 id="æšä¸¾ç±»å‹"><a href="#æšä¸¾ç±»å‹" class="headerlink" title="æšä¸¾ç±»å‹"></a>æšä¸¾ç±»å‹</h1><p>äººä¸ºé™å®šå–å€¼èŒƒå›´çš„æ•´æ•°<br>æ•´æ•°å€¼çš„å¯¹åº”<br>æ¯”ç‰¹ä½å¼ç”¨æ³•</p><p><img src="/img%5CHello%5CSnipaste_2025-02-21_15-32-17.png"></p><h1 id="ç»“æ„ä½“ï¼ˆstructï¼‰"><a href="#ç»“æ„ä½“ï¼ˆstructï¼‰" class="headerlink" title="ç»“æ„ä½“ï¼ˆstructï¼‰"></a>ç»“æ„ä½“ï¼ˆstructï¼‰</h1><p>å€¼ç±»å‹ï¼Œå¯è£…&#x2F;æ‹†ç®±<br>å¯å®ç°æ¥å£ï¼Œä¸èƒ½æ´¾ç”Ÿè‡ªç±»&#x2F;ç»“æ„ä½“<br>ä¸èƒ½æœ‰æ˜¾ç¤ºæ— å‚æ„é€ å™¨</p><p><img src="/img%5CHello%5CSnipaste_2025-02-21_15-47-39.png"></p>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Visual Studio 2022 </tag>
            
            <tag> charpç¼–ç¨‹åŸºç¡€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Csharpå…¥é—¨è¯¦è§£å­¦ä¹ ç¬”è®°</title>
      <link href="/2025/02/08/csharp%E5%85%A5%E9%97%A8%E8%AF%A6%E8%A7%A3/csharp%E5%85%A5%E9%97%A8%E8%AF%A6%E8%A7%A3/"/>
      <url>/2025/02/08/csharp%E5%85%A5%E9%97%A8%E8%AF%A6%E8%A7%A3/csharp%E5%85%A5%E9%97%A8%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h1 id="ç”¨C-ç¼–å†™çš„å„ç±»åº”ç”¨ç¨‹åºï¼Œç”¨Visual-Studioå†™å‡ºHello-word"><a href="#ç”¨C-ç¼–å†™çš„å„ç±»åº”ç”¨ç¨‹åºï¼Œç”¨Visual-Studioå†™å‡ºHello-word" class="headerlink" title="ç”¨C#ç¼–å†™çš„å„ç±»åº”ç”¨ç¨‹åºï¼Œç”¨Visual Studioå†™å‡ºHello word!!!."></a>ç”¨C#ç¼–å†™çš„å„ç±»åº”ç”¨ç¨‹åºï¼Œç”¨Visual Studioå†™å‡ºHello word!!!.</h1><h1 id="ç¬¬ä¸€ä¸ªï¼šConsole"><a href="#ç¬¬ä¸€ä¸ªï¼šConsole" class="headerlink" title="ç¬¬ä¸€ä¸ªï¼šConsole"></a>ç¬¬ä¸€ä¸ªï¼šConsole</h1><p>æ‰“å¼€Visual Studioæ–°å»ºé¡¹ç›®é€‰æ‹©<b>æ§åˆ¶å°åº”ç”¨</b><br>ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬ç”Ÿæˆæœ€åŸºæœ¬çš„C#çš„Mainæ–¹æ³•ï¼Œåœ¨Mainä¸­è¾“å…¥Console.WrinteLine(â€œHello World!â€);æŒ‰ctrl+F5è¿›è¡Œè°ƒå¼ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">namespace</span> <span class="title">Console_Hello_world</span></span><br><span class="line"> &#123;</span><br><span class="line">   <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">   &#123;</span><br><span class="line">       <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">       &#123;</span><br><span class="line">           Console.WrinteLine(<span class="string">&quot;Hello World!&quot;</span>);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="ç¬¬äºŒä¸ªï¼šWindows-Forms-Old"><a href="#ç¬¬äºŒä¸ªï¼šWindows-Forms-Old" class="headerlink" title="ç¬¬äºŒä¸ªï¼šWindows Forms(Old)"></a>ç¬¬äºŒä¸ªï¼šWindows Forms(Old)</h1><p>æ‰“å¼€Visual Studioæ–°å»ºé¡¹ç›®é€‰æ‹©<b>Windowsçª—ä½“åº”ç”¨(.NET Framework)</b><br>ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªForm1çš„çª—å£<br>å¦‚ä¸‹ï¼š<br><img src="/img%5CHello%5CForm-helloworld.png"></p><p>åœ¨å·¥å…·ç®±ä¸­æœç´¢buttonå’ŒTextboxï¼Œå°†å…¶æ‹–åˆ°çª—ä½“ä¸Šã€‚</p><p><img src="/img%5CHello%5CForm-helloworld-2.png"></p><p>å·¦è¾¹æ²¡æœ‰å·¥å…·ç®±ï¼Œåœ¨èœå•æ ä¸­é€‰æ‹©è§†å›¾é€‰é€‰å¡ï¼Œåœ¨ä¸‹æ‹‰åˆ—è¡¨ä¸­é€‰ç€å·¥å…·ç®±ã€‚</p><p>å±æ€§é¢æ¿ä¸­å¯ä»¥çœ‹åˆ°æŒ‰é’®çš„å„ç§å±æ€§ï¼Œé€‰æ‹©buttonï¼Œåœ¨å±æ€§é¢æ¿ä¸­å°†Textæ”¹ä¸ºâ€œClick Me!â€ </p><p><img src="/img%5CHello%5CForm-helloworld-3.png"></p><p>åœ¨å±æ€§é¢æ¿ä¸­é€‰æ‹©äº‹ä»¶æŒ‰é’®</p><p><img src="/img%5CHello%5CForm-helloworld-4.png"></p><p>åŒå‡»æŒ‰é’®çš„â€œClickâ€äº‹ä»¶<br><img src="/img%5CHello%5CForm-helloworld-5.png"></p><p>VSä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æ–¹æ³•ä¸­è¾“å…¥Console.WriteLine(â€œHello World!â€);å³å¯ã€‚</p><p><img src="/img%5CHello%5CForm-helloworld-6.png"></p><p>è¿è¡Œç¨‹åºï¼Œç‚¹å‡»æŒ‰é’®ï¼ŒForm1ä¼šæ˜¾ç¤ºâ€œHello World!â€</p><p><img src="/img%5CHello%5CForm-helloworld-7.png"></p><h1 id="ç¬¬ä¸‰ä¸ªï¼šWPF-Windows-Presentation-Foundation"><a href="#ç¬¬ä¸‰ä¸ªï¼šWPF-Windows-Presentation-Foundation" class="headerlink" title="ç¬¬ä¸‰ä¸ªï¼šWPF(Windows Presentation Foundation)"></a>ç¬¬ä¸‰ä¸ªï¼šWPF(Windows Presentation Foundation)</h1><p>WPFæ˜¯å¾®è½¯æ¨å‡ºçš„åŸºäº.NET Frameworkçš„å¯è§†åŒ–å¼€å‘æ¡†æ¶ï¼Œå¯ä»¥ç”¨æ¥å¼€å‘æ¡Œé¢åº”ç”¨ç¨‹åºã€ç§»åŠ¨åº”ç”¨ç¨‹åºã€Webåº”ç”¨ç¨‹åºã€æ¸¸æˆç­‰ã€‚</p><p>æ‰“å¼€Visual Studioæ–°å»ºé¡¹ç›®é€‰æ‹©<b>WPFåº”ç”¨ç¨‹åº(.NET Framework)</b><br>ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªMainWindowçš„çª—å£<br>åœ¨å·¥å…·ç®±ä¸­æœç´¢buttonå’ŒTextboxï¼Œå°†å…¶æ‹–åˆ°çª—ä½“ä¸Šã€‚<br>æ­¥éª¤å’ŒFrameWork Formsç±»ä¼¼ </p><p><img src="/img%5CHello%5CWPF-helloworld.png"></p><p><img src="/img%5CHello%5CWPF-helloworld-2.png"></p><p><img src="/img%5CHello%5CWPF-helloworld-3.png"></p><p><img src="/img%5CHello%5CWPF-helloworld-4.png"></p><p><img src="/img%5CHello%5CWPF-helloworld-5.png"></p><h1 id="ç¬¬å››ä¸ªï¼šASP-NET-Web-FormS-Old"><a href="#ç¬¬å››ä¸ªï¼šASP-NET-Web-FormS-Old" class="headerlink" title="ç¬¬å››ä¸ªï¼šASP.NET Web FormS(Old)"></a>ç¬¬å››ä¸ªï¼šASP.NET Web FormS(Old)</h1><p>æ‰“å¼€Visual Studioæ–°å»ºé¡¹ç›®é€‰æ‹©<b>ASP.NET Web Forms åº”ç”¨ç¨‹åº</b></p><p>é€‰æ‹©ç©ºæ¨¡æ¿ï¼Œå‹¾é€‰webçª—ä½“ï¼Œç‚¹å‡»ç¡®å®šã€‚</p><p>å³å‡»é¡¹ç›®ï¼Œé€‰æ‹©æ·»åŠ æ–°é¡¹ï¼Œé€‰æ‹©Webçª—ä½“ï¼Œå‘½åä¸ºâ€œDefault.aspxâ€ï¼Œç‚¹å‡»æ·»åŠ ã€‚<br><img src="/img%5CHello%5CNET-Web-helloworld.png"></p><p>å°±å¯ä»¥ä½¿ç”¨HTMLã€CSSã€JavaScriptæ¥ç¼–å†™ç½‘é¡µäº†ã€‚<br><img src="/img%5CHello%5CFramework-web-helloworld.png"></p><h1 id="ç¬¬äº”ä¸ªï¼šASP-NET-MVC-Model-View-Controller"><a href="#ç¬¬äº”ä¸ªï¼šASP-NET-MVC-Model-View-Controller" class="headerlink" title="ç¬¬äº”ä¸ªï¼šASP.NET MVC(Model-View-Controller)"></a>ç¬¬äº”ä¸ªï¼šASP.NET MVC(Model-View-Controller)</h1><p>æ‰“å¼€Visual Studioæ–°å»ºé¡¹ç›®é€‰æ‹©<b>ASP.NET MVC åº”ç”¨(æ¨¡å‹-è§†å›¾-æ§åˆ¶å™¨)</b></p><p>é€‰æ‹©è‡ªå¸¦çš„æ¨¡æ¿HomeController.cs,åœ¨indexè§†å›¾ä¸­è¾“å…¥â€œHello World!â€</p><p>ä¹Ÿå¯ä»¥zipä¸‹è½½æ¨¡æ¿ï¼Œè§£å‹åæ‰“å¼€è§£å†³æ–¹æ¡ˆï¼Œæ‰¾åˆ°HomeController.csï¼Œåœ¨indexè§†å›¾ä¸­è¾“å…¥â€œHello World!â€<br><img src="/img%5CHello%5CMVC-helloworld.png"></p><p><img src="/img%5CHello%5CMVC-helloworld-2.png"></p><p><img src="/img%5CHello%5CMVC-helloworld-5.png"></p><p><img src="/img%5CHello%5CMVC-helloworld-4.png"></p><h1 id="ç±»åº“çš„å¼•ç”¨"><a href="#ç±»åº“çš„å¼•ç”¨" class="headerlink" title="ç±»åº“çš„å¼•ç”¨"></a>ç±»åº“çš„å¼•ç”¨</h1><li>ç±»åº“å¼•ç”¨æ˜¯ä½¿ç”¨å‘½åç©ºé—´çš„ç‰©ç†åŸºç¡€ã€‚åœ¨C#ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä»£ç åˆ†æˆå¤šä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½æœ‰è‡ªå·±çš„å‘½åç©ºé—´ã€‚å½“æˆ‘ä»¬éœ€è¦ä½¿ç”¨æŸä¸ªç±»åº“æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å¼•ç”¨å®ƒçš„å‘½åç©ºé—´ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨System.IOå‘½åç©ºé—´ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å†™ï¼šusing System.IO;ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ç¨‹åºä¸­ä½¿ç”¨System.IOå‘½åç©ºé—´ä¸­çš„ç±»å’Œæ–¹æ³•äº†ã€‚</li><li>ä¸åŒæŠ€æœ¯ç±»å‹çš„é¡¹ç›®ä¼šé»˜è®¤å¼•ç”¨ä¸åŒçš„ç±»åº“ï¼Œå¦‚Windows Formsé¡¹ç›®é»˜è®¤å¼•ç”¨System.Windows.Formså‘½åç©ºé—´ï¼ŒWPFé¡¹ç›®é»˜è®¤å¼•ç”¨System.Windowså‘½åç©ºé—´ï¼ŒASP.NET Web Formsé¡¹ç›®é»˜è®¤å¼•ç”¨System.Webå‘½åç©ºé—´ï¼ŒASP.NET MVCé¡¹ç›®é»˜è®¤å¼•ç”¨System.Web.Mvcå‘½åç©ºé—´ã€‚</li><li>DLLå¼•ç”¨(é»‘æ²³å¼•ç”¨ï¼Œæ— æºä»£ç )</li><ol><li>å®šä¹‰ä¸ä½œç”¨<br>DLL æ˜¯ä¸€ä¸ªç”¨äºå­˜å‚¨ä»£ç å’Œæ•°æ®èµ„æºçš„æ–‡ä»¶ï¼Œèƒ½å¤Ÿåœ¨ä¸åŒåº”ç”¨ç¨‹åºä¹‹é—´åŠ¨æ€åœ°å…±äº«ä»£ç ã€‚<br>å®ƒç±»ä¼¼äº C# ç±»åº“ï¼ˆå¦‚ System.Collections.Genericï¼‰ï¼Œä½†é€šå¸¸ç”¨äºå¤–éƒ¨è°ƒç”¨æˆ–æ¡†æ¶ã€‚</li><li>åŠŸèƒ½ç‰¹ç‚¹<br>äºŒè¿›åˆ¶æ–‡ä»¶ï¼šDLL æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼ŒåŒ…å«ç±»å‹ã€é™æ€æˆå‘˜å’Œæ–¹æ³•çš„äºŒè¿›åˆ¶è¡¨ç¤ºã€‚<br>åŠ¨æ€é“¾æ¥ï¼šDLL å…è®¸åº”ç”¨ç¨‹åºåœ¨è¿è¡Œæ—¶åŠ¨æ€åŠ è½½å…¶ä»£ç ï¼Œè€Œä¸å¿…å°†å…¶ä½œä¸ºå¯æ‰§è¡Œæ–‡ä»¶ç›´æ¥ç¼–è¯‘ã€‚</li><li>ç±»å‹ä¸ç»“æ„<br>DLL æ–‡ä»¶é€šå¸¸ä»¥ .dll æ‰©å±•åæ ‡è¯†ï¼Œå¹¶ç”±ä¸€ä¸ªæˆ–å¤šä¸ª assembly ç»„æˆã€‚<br>ç±»å‹å’Œæ–¹æ³•æ˜¯é€šè¿‡ DLL ä¸­çš„ç±»å‹è¡¨å®ç°çš„ï¼Œå…è®¸åœ¨ C# ç¨‹åºä¸­å¼•ç”¨å¤–éƒ¨åº“ã€‚</li><li>å¸¸è§ç”¨é€”<br>è°ƒç”¨å¤–éƒ¨åº“ï¼šDLL æ˜¯å¤§å¤šæ•° .NET æ¡†æ¶ï¼ˆå¦‚ mscorlibã€System.Webï¼‰çš„é»˜è®¤å½¢å¼ã€‚ä¾‹å¦‚ï¼Œmscorlib.dll åŒ…å«åŸºç¡€æ•°æ®ç±»å‹å’Œæ–¹æ³•ã€‚<br>æ¡†æ¶ä¸ç»„ä»¶ï¼šè®¸å¤šæ¡†æ¶æä¾› DLL æ–‡ä»¶ï¼Œå…è®¸ C# ç¨‹åºè°ƒç”¨å…¶åŠŸèƒ½ã€‚</li><li>ç®¡ç†ä¸ä½¿ç”¨<br>ç¼–è¯‘ä¸åŠ è½½ï¼šDLL æ˜¯é€šè¿‡ç¼–è¯‘å™¨åœ¨è¿è¡Œæ—¶åŠ¨æ€åŠ è½½çš„ã€‚C# ç¼–è¯‘å™¨ä¼šå°†ç±»åº“ç¼–è¯‘ä¸º DLLã€‚<br>å¼•ç”¨æ–¹å¼ï¼šåœ¨ C# ä»£ç ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ using è¯­å¥æˆ–åç§°ç©ºé—´æ¥å¼•ç”¨ DLL æä¾›çš„åŠŸèƒ½ã€‚</li><li>å¸¸è§é—®é¢˜<br>å¦‚æœé¡¹ç›®æ— æ³•æ‰¾åˆ° DLL æ–‡ä»¶ï¼Œé€šå¸¸è¡¨ç¤ºè·¯å¾„é”™è¯¯æˆ–ä¾èµ–çš„ DLL ç¼ºå°‘ã€‚æ£€æŸ¥è·¯å¾„å’Œæ›´æ–°ä¾èµ–æ˜¯å¸¸è§çš„è§£å†³æ–¹æ¡ˆã€‚<br>DLL æ–‡ä»¶çš„å®‰å…¨æ€§é€šå¸¸è¾ƒä½ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥åœ¨ç³»ç»Ÿä¸­åŠ è½½ä»»ä½•ä»£ç ã€‚å› æ­¤ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­åº”è°¨æ…å¤„ç†ã€‚<br>æ€»ç»“<br>DLL æ˜¯ C# ç¨‹åºä¸­è°ƒç”¨å¤–éƒ¨åº“æˆ–æ¡†æ¶çš„æ ¸å¿ƒå·¥å…·ï¼Œé€šè¿‡äºŒè¿›åˆ¶æ–‡ä»¶å­˜å‚¨ä»£ç å’Œæ•°æ®èµ„æºï¼Œå¹¶åœ¨è¿è¡Œæ—¶åŠ¨æ€åŠ è½½ã€‚ç†è§£ DLL çš„ä½œç”¨å¯¹äºç¼–å†™é«˜æ•ˆçš„ .NET åº”ç”¨ç¨‹åºè‡³å…³é‡è¦ã€‚</li></ol><li>NuGet åŒ…ç®¡ç†å™¨</li><p>NuGet æ˜¯ Microsoft æä¾›çš„ .NET åŒ…ç®¡ç†å™¨ï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬è½»æ¾åœ°å®‰è£…ã€æ›´æ–°å’Œå¼•ç”¨ç¬¬ä¸‰æ–¹ç±»åº“ã€‚</p><ol><li>å®šä¹‰ä¸ä½œç”¨<br>NuGet æ˜¯ Microsoft æä¾›çš„ .NET åŒ…ç®¡ç†å™¨ï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬è½»æ¾åœ°å®‰è£…ã€æ›´æ–°å’Œå¼•ç”¨ç¬¬ä¸‰æ–¹ç±»åº“ã€‚NuGet åŒ…ç®¡ç†å™¨å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç®¡ç† .NET é¡¹ç›®çš„ä¾èµ–é¡¹ï¼ŒåŒ…æ‹¬ NuGet åŒ…ã€‚</li><li>åŠŸèƒ½ç‰¹ç‚¹<br>NuGet åŒ…ç®¡ç†å™¨å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç®¡ç† .NET é¡¹ç›®çš„ä¾èµ–é¡¹ï¼ŒåŒ…æ‹¬ NuGet åŒ…ã€‚<br>NuGet åŒ…å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿã€è½»æ¾åœ°å®‰è£…ã€æ›´æ–°å’Œå¼•ç”¨ç¬¬ä¸‰æ–¹ç±»åº“ã€‚<br>NuGet åŒ…å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç®¡ç† NuGet åŒ…çš„ç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ NuGet åŒ…ä¾èµ–é¡¹ã€‚</li><li>å¸¸è§ç”¨é€”<br>NuGet åŒ…ç®¡ç†å™¨å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç®¡ç† .NET é¡¹ç›®çš„ä¾èµ–é¡¹ï¼ŒåŒ…æ‹¬ NuGet åŒ…ã€‚<br>NuGet åŒ…å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿã€è½»æ¾åœ°å®‰è£…ã€æ›´æ–°å’Œå¼•ç”¨ç¬¬ä¸‰æ–¹ç±»åº“ã€‚<br>NuGet åŒ…å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç®¡ç† NuGet åŒ…çš„ç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ NuGet åŒ…ä¾èµ–é¡¹ã€‚</li><li>ç®¡ç†ä¸ä½¿ç”¨<br>NuGet åŒ…ç®¡ç†å™¨å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç®¡ç† .NET é¡¹ç›®çš„ä¾èµ–é¡¹ï¼ŒåŒ…æ‹¬ NuGet åŒ…ã€‚<br>NuGet åŒ…å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿã€è½»æ¾åœ°å®‰è£…ã€æ›´æ–°å’Œå¼•ç”¨ç¬¬ä¸‰æ–¹ç±»åº“ã€‚<br>NuGet åŒ…å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç®¡ç† NuGet åŒ…çš„ç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ NuGet åŒ…ä¾èµ–é¡¹ã€‚</li><li>å¸¸è§é—®é¢˜<br>NuGet åŒ…ç®¡ç†å™¨çš„å®‰è£…ä¸ä½¿ç”¨éœ€è¦ä¸€å®šçš„æ—¶é—´ï¼Œä½†éšç€ NuGet åŒ…çš„å¢å¤šï¼Œå®ƒçš„ä½¿ç”¨æ•ˆç‡ä¼šè¶Šæ¥è¶Šé«˜ã€‚<br>NuGet åŒ…ç®¡ç†å™¨çš„ä¾èµ–é¡¹ç®¡ç†åŠŸèƒ½å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç®¡ç† NuGet åŒ…çš„ç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ NuGet åŒ…ä¾èµ–é¡¹ã€‚  </li><li>æ€»ç»“<br>NuGet åŒ…ç®¡ç†å™¨æ˜¯ Microsoft æä¾›çš„ .NET åŒ…ç®¡ç†å™¨ï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬è½»æ¾åœ°å®‰è£…ã€æ›´æ–°å’Œå¼•ç”¨ç¬¬ä¸‰æ–¹ç±»åº“ã€‚NuGet åŒ…ç®¡ç†å™¨çš„å®‰è£…ä¸ä½¿ç”¨éœ€è¦ä¸€å®šçš„æ—¶é—´ï¼Œä½†éšç€ NuGet åŒ…çš„å¢å¤šï¼Œå®ƒçš„ä½¿ç”¨æ•ˆç‡ä¼šè¶Šæ¥è¶Šé«˜ã€‚NuGet åŒ…ç®¡ç†å™¨çš„ä¾èµ–é¡¹ç®¡ç†åŠŸèƒ½å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç®¡ç† NuGet åŒ…çš„ç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ NuGet åŒ…ä¾èµ–é¡¹ã€‚</li></ol><li>é¡¹ç›®å¼•ç”¨(ç™¾ç›’å¼•ç”¨ï¼Œæœ‰æºä»£ç )</li><ol><li>å®šä¹‰ä¸ä½œç”¨<br>é¡¹ç›®å¼•ç”¨æ˜¯æŒ‡åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­å¼•ç”¨å¦ä¸€ä¸ªé¡¹ç›®çš„è¾“å‡ºæ–‡ä»¶ã€‚</li><li>åŠŸèƒ½ç‰¹ç‚¹<br>é¡¹ç›®å¼•ç”¨å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­è°ƒç”¨å¦ä¸€ä¸ªé¡¹ç›®çš„åŠŸèƒ½ã€‚</li><li>å¸¸è§ç”¨é€”<br>é¡¹ç›®å¼•ç”¨å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­è°ƒç”¨å¦ä¸€ä¸ªé¡¹ç›®çš„åŠŸèƒ½ã€‚</li><li>ç®¡ç†ä¸ä½¿ç”¨<br>é¡¹ç›®å¼•ç”¨å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­è°ƒç”¨å¦ä¸€ä¸ªé¡¹ç›®çš„åŠŸèƒ½ã€‚</li><li>å¸¸è§é—®é¢˜<br>é¡¹ç›®å¼•ç”¨çš„ç®¡ç†ä¸ä½¿ç”¨éœ€è¦ä¸€å®šçš„æ—¶é—´ï¼Œä½†éšç€é¡¹ç›®çš„å¢å¤šï¼Œå®ƒçš„ä½¿ç”¨æ•ˆç‡ä¼šè¶Šæ¥è¶Šé«˜ã€‚</li><li>æ€»ç»“<br>é¡¹ç›®å¼•ç”¨æ˜¯æŒ‡åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­å¼•ç”¨å¦ä¸€ä¸ªé¡¹ç›®çš„è¾“å‡ºæ–‡ä»¶ã€‚é¡¹ç›®å¼•ç”¨å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­è°ƒç”¨å¦ä¸€ä¸ªé¡¹ç›®çš„åŠŸèƒ½ã€‚é¡¹ç›®å¼•ç”¨çš„ç®¡ç†ä¸ä½¿ç”¨éœ€è¦ä¸€å®šçš„æ—¶é—´ï¼Œä½†éšç€é¡¹ç›®çš„å¢å¤šï¼Œå®ƒçš„ä½¿ç”¨æ•ˆç‡ä¼šè¶Šæ¥è¶Šé«˜ã€‚</li></ol><li>ä¾èµ–å…³ç³»ç®¡ç†(é«˜å†…èšä½è€¦åˆ) </li><p>ä¾èµ–å…³ç³»ç®¡ç†æ˜¯æŒ‡ç®¡ç†é¡¹ç›®ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼ŒåŒ…æ‹¬ NuGet åŒ…ä¾èµ–é¡¹ã€é¡¹ç›®ä¾èµ–é¡¹å’Œå¤–éƒ¨ DLL ä¾èµ–é¡¹ã€‚</p><ol><li>å®šä¹‰ä¸ä½œç”¨<br>ä¾èµ–å…³ç³»ç®¡ç†æ˜¯æŒ‡ç®¡ç†é¡¹ç›®ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼ŒåŒ…æ‹¬ NuGet åŒ…ä¾èµ–é¡¹ã€é¡¹ç›®ä¾èµ–é¡¹å’Œå¤–éƒ¨ DLL ä¾èµ–é¡¹ã€‚</li><li>åŠŸèƒ½ç‰¹ç‚¹<br>ä¾èµ–å…³ç³»ç®¡ç†å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç®¡ç†é¡¹ç›®ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚</li><li>å¸¸è§ç”¨é€”<br>ä¾èµ–å…³ç³»ç®¡ç†å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç®¡ç†é¡¹ç›®ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚</li><li>ç®¡ç†ä¸ä½¿ç”¨<br>ä¾èµ–å…³ç³»ç®¡ç†å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç®¡ç†é¡¹ç›®ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚</li><li>å¸¸è§é—®é¢˜<br>ä¾èµ–å…³ç³»ç®¡ç†çš„ç®¡ç†ä¸ä½¿ç”¨éœ€è¦ä¸€å®šçš„æ—¶é—´ï¼Œä½†éšç€é¡¹ç›®çš„å¢å¤šï¼Œå®ƒçš„ä½¿ç”¨æ•ˆç‡ä¼šè¶Šæ¥è¶Šé«˜ã€‚</li><li>æ€»ç»“</li></ol><h1 id="ç±»çš„ä¸‰å¤§æˆå‘˜"><a href="#ç±»çš„ä¸‰å¤§æˆå‘˜" class="headerlink" title="ç±»çš„ä¸‰å¤§æˆå‘˜"></a>ç±»çš„ä¸‰å¤§æˆå‘˜</h1><li>å±æ€§(Properties)</li><p>å±æ€§æ˜¯ç±»çš„æˆå‘˜ï¼Œå®ƒå¯ä»¥è·å–æˆ–è®¾ç½®ç±»çš„çŠ¶æ€ã€‚    </p><ol><li>å®šä¹‰ä¸ä½œç”¨<br>å±æ€§æ˜¯ç±»çš„æˆå‘˜ï¼Œå®ƒå¯ä»¥è·å–æˆ–è®¾ç½®ç±»çš„çŠ¶æ€ã€‚</li><li>åŠŸèƒ½ç‰¹ç‚¹<br>å±æ€§å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨ç±»çš„å¤–éƒ¨è®¿é—®ç±»çš„çŠ¶æ€ã€‚</li><li>å¸¸è§ç”¨é€”<br>å±æ€§å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨ç±»çš„å¤–éƒ¨è®¿é—®ç±»çš„çŠ¶æ€ã€‚</li><li>ç®¡ç†ä¸ä½¿ç”¨<br>å±æ€§çš„ç®¡ç†ä¸ä½¿ç”¨éœ€è¦ä¸€å®šçš„æ—¶é—´ï¼Œä½†éšç€ç±»çš„å¢å¤šï¼Œå®ƒçš„ä½¿ç”¨æ•ˆç‡ä¼šè¶Šæ¥è¶Šé«˜ã€‚</li><li>å¸¸è§é—®é¢˜<br>å±æ€§çš„ç®¡ç†ä¸ä½¿ç”¨éœ€è¦ä¸€å®šçš„æ—¶é—´ï¼Œä½†éšç€ç±»çš„å¢å¤šï¼Œå®ƒçš„ä½¿ç”¨æ•ˆç‡ä¼šè¶Šæ¥è¶Šé«˜ã€‚</li><li>æ€»ç»“<br>å±æ€§æ˜¯ç±»çš„æˆå‘˜ï¼Œå®ƒå¯ä»¥è·å–æˆ–è®¾ç½®ç±»çš„çŠ¶æ€ã€‚å±æ€§å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨ç±»çš„å¤–éƒ¨è®¿é—®ç±»çš„çŠ¶æ€ã€‚å±æ€§çš„ç®¡ç†ä¸ä½¿ç”¨éœ€è¦ä¸€å®šçš„æ—¶é—´ï¼Œä½†éšç€ç±»çš„å¢å¤šï¼Œå®ƒçš„ä½¿ç”¨æ•ˆç‡ä¼šè¶Šæ¥è¶Šé«˜ã€‚</li></ol><li>æ–¹æ³•(Methods)</li>æ–¹æ³•æ˜¯ç±»çš„æˆå‘˜ï¼Œå®ƒå¯ä»¥æ‰§è¡Œä¸€äº›æ“ä½œã€‚               <ol><li>å®šä¹‰ä¸ä½œç”¨<br>æ–¹æ³•æ˜¯ç±»çš„æˆå‘˜ï¼Œå®ƒå¯ä»¥æ‰§è¡Œä¸€äº›æ“ä½œã€‚</li><li>åŠŸèƒ½ç‰¹ç‚¹<br>æ–¹æ³•å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨ç±»çš„å¤–éƒ¨æ‰§è¡Œä¸€äº›æ“ä½œã€‚</li><li>å¸¸è§ç”¨é€”<br>æ–¹æ³•å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨ç±»çš„å¤–éƒ¨æ‰§è¡Œä¸€äº›æ“ä½œã€‚</li><li>ç®¡ç†ä¸ä½¿ç”¨<br>æ–¹æ³•çš„ç®¡ç†ä¸ä½¿ç”¨éœ€è¦ä¸€å®šçš„æ—¶é—´ï¼Œä½†éšç€ç±»çš„å¢å¤šï¼Œå®ƒçš„ä½¿ç”¨æ•ˆç‡ä¼šè¶Šæ¥è¶Šé«˜ã€‚</li><li>å¸¸è§é—®é¢˜<br>æ–¹æ³•çš„ç®¡ç†ä¸ä½¿ç”¨éœ€è¦ä¸€å®šçš„æ—¶é—´ï¼Œä½†éšç€ç±»çš„å¢å¤šï¼Œå®ƒçš„ä½¿ç”¨æ•ˆç‡ä¼šè¶Šæ¥è¶Šé«˜ã€‚</li><li>æ€»ç»“<br>æ–¹æ³•æ˜¯ç±»çš„æˆå‘˜ï¼Œå®ƒå¯ä»¥æ‰§è¡Œä¸€äº›æ“ä½œã€‚æ–¹æ³•å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨ç±»çš„å¤–éƒ¨æ‰§è¡Œä¸€äº›æ“ä½œã€‚æ–¹æ³•çš„ç®¡ç†ä¸ä½¿ç”¨éœ€è¦ä¸€å®šçš„æ—¶é—´ï¼Œä½†éšç€ç±»çš„å¢å¤šï¼Œå®ƒçš„ä½¿ç”¨æ•ˆç‡ä¼šè¶Šæ¥è¶Šé«˜ã€‚</li></ol><li>äº‹ä»¶(Events)</li>äº‹ä»¶æ˜¯ç±»çš„æˆå‘˜ï¼Œå®ƒå¯ä»¥é€šçŸ¥å…¶ä»–å¯¹è±¡å‘ç”Ÿäº†æŸäº›äº‹ä»¶ã€‚               <ol><li>å®šä¹‰ä¸ä½œç”¨<br>äº‹ä»¶æ˜¯ç±»çš„æˆå‘˜ï¼Œå®ƒå¯ä»¥é€šçŸ¥å…¶ä»–å¯¹è±¡å‘ç”Ÿäº†æŸäº›äº‹ä»¶ã€‚</li><li>åŠŸèƒ½ç‰¹ç‚¹<br>äº‹ä»¶å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨ç±»çš„å¤–éƒ¨é€šçŸ¥å…¶ä»–å¯¹è±¡å‘ç”Ÿäº†æŸäº›äº‹ä»¶ã€‚</li><li>å¸¸è§ç”¨é€”<br>äº‹ä»¶å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨ç±»çš„å¤–éƒ¨é€šçŸ¥å…¶ä»–å¯¹è±¡å‘ç”Ÿäº†æŸäº›äº‹ä»¶ã€‚</li><li>ç®¡ç†ä¸ä½¿ç”¨<br>äº‹ä»¶çš„ç®¡ç†ä¸ä½¿ç”¨éœ€è¦ä¸€å®šçš„æ—¶é—´ï¼Œä½†éšç€ç±»çš„å¢å¤šï¼Œå®ƒçš„ä½¿ç”¨æ•ˆç‡ä¼šè¶Šæ¥è¶Šé«˜ã€‚</li><li>å¸¸è§é—®é¢˜<br>äº‹ä»¶çš„ç®¡ç†ä¸ä½¿ç”¨éœ€è¦ä¸€å®šçš„æ—¶é—´ï¼Œä½†éšç€ç±»çš„å¢å¤šï¼Œå®ƒçš„ä½¿ç”¨æ•ˆç‡ä¼šè¶Šæ¥è¶Šé«˜ã€‚</li><li>æ€»ç»“<br>äº‹ä»¶æ˜¯ç±»çš„æˆå‘˜ï¼Œå®ƒå¯ä»¥é€šçŸ¥å…¶ä»–å¯¹è±¡å‘ç”Ÿäº†æŸäº›äº‹ä»¶ã€‚äº‹ä»¶å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨ç±»çš„å¤–éƒ¨é€šçŸ¥å…¶ä»–å¯¹è±¡å‘ç”Ÿäº†æŸäº›äº‹ä»¶ã€‚äº‹ä»¶çš„ç®¡ç†ä¸ä½¿ç”¨éœ€è¦ä¸€å®šçš„æ—¶é—´ï¼Œä½†éšç€ç±»çš„å¢å¤šï¼Œå®ƒçš„ä½¿ç”¨æ•ˆç‡ä¼šè¶Šæ¥è¶Šé«˜ã€‚</li></ol><h1 id="æ„æˆC-è¯­è¨€çš„åŸºæœ¬å…ƒç´ "><a href="#æ„æˆC-è¯­è¨€çš„åŸºæœ¬å…ƒç´ " class="headerlink" title="æ„æˆC#è¯­è¨€çš„åŸºæœ¬å…ƒç´ "></a>æ„æˆC#è¯­è¨€çš„åŸºæœ¬å…ƒç´ </h1><li>å…³é”®å­—(Keywords)</li>å…³é”®å­—æ˜¯C#è¯­è¨€çš„åŸºæœ¬å…ƒç´ ï¼Œå®ƒæ˜¯C#è¯­è¨€çš„æ ¸å¿ƒã€‚å…³é”®å­—æ˜¯C#è¯­è¨€çš„åŸºæœ¬è¯­æ³•å•ä½ï¼Œå®ƒæ˜¯C#è¯­è¨€çš„æ„å»ºå—ã€‚å…³é”®å­—çš„ä½œç”¨æ˜¯ç”¨æ¥å®šä¹‰ç¨‹åºçš„ç»“æ„ã€æ§åˆ¶æµã€æ•°æ®ç±»å‹ã€æ–¹æ³•ã€å˜é‡ã€å¸¸é‡ã€è¿ç®—ç¬¦ã€å‘½åç©ºé—´ã€ç±»ã€æ¥å£ã€ç»“æ„ã€æšä¸¾ã€å§”æ‰˜ç­‰ã€‚<b>åœ¨MSDNæ–‡æ¡£æœ‰å¯¹å…³é”®å­—çš„è¯¦ç»†ä»‹ç»ã€‚</b>             <li>è¿ç®—ç¬¦(Operators)</li>è¿ç®—ç¬¦æ˜¯C#è¯­è¨€çš„åŸºæœ¬å…ƒç´ ï¼Œå®ƒæ˜¯C#è¯­è¨€çš„æ ¸å¿ƒã€‚è¿ç®—ç¬¦æ˜¯C#è¯­è¨€çš„åŸºæœ¬è¯­æ³•å•ä½ï¼Œå®ƒæ˜¯C#è¯­è¨€çš„æ„å»ºå—ã€‚è¿ç®—ç¬¦çš„ä½œç”¨æ˜¯ç”¨æ¥æ‰§è¡Œå„ç§æ“ä½œï¼Œå¦‚ç®—æœ¯è¿ç®—ã€èµ‹å€¼è¿ç®—ã€é€»è¾‘è¿ç®—ã€æ¯”è¾ƒè¿ç®—ã€ä½è¿ç®—ã€æ¡ä»¶è¿ç®—ç­‰ã€‚<b>åœ¨MSDNæ–‡æ¡£æœ‰å¯¹è¿ç®—ç¬¦çš„è¯¦ç»†ä»‹ç»ã€‚</b><li>æ ‡è¯†ç¬¦(Identifiers)</li><ol><li>ä»€ä¹ˆæ˜¯åˆæ³•æ ‡è¯†ç¬¦ï¼Ÿ<br>æ ‡è¯†ç¬¦æ˜¯ä¸èƒ½å’Œå…³é”®å­—é‡ç»„ï¼ˆå…³é”®å­—å·²ç»è¢«èµ‹äºˆäº†ç‰¹æ®Šçš„å«ä¹‰ï¼‰ã€ä¸èƒ½ä»¥æ•°å­—å¼€å¤´ã€ä¸èƒ½åŒ…å«ç‰¹æ®Šå­—ç¬¦ã€‚<br>æ ‡è¯†ç¬¦å¯ä»¥ç”±å­—æ¯ã€ä¸‹åˆ’çº¿æˆ–è€…æ±‰å­—ï¼ˆä½†ä¸å»ºè®®ä½¿ç”¨æ±‰å­—ï¼‰å¼€å¤´ã€‚<br>æ ‡è¯†ç¬¦çš„å‘½åè§„èŒƒï¼š</li></ol><ul><li>æ ‡è¯†ç¬¦çš„å‘½åå¿…é¡»éµå¾ªé©¼å³°å‘½åæ³•ã€‚</li><li>æ ‡è¯†ç¬¦çš„å‘½åå¿…é¡»è§åçŸ¥æ„ã€‚</li><li>æ ‡è¯†ç¬¦çš„å‘½åå¿…é¡»ç®€çŸ­ã€æ˜“äºç†è§£ã€‚</li></ul><li>æ ‡ç‚¹ç¬¦å·(Punctuation)</li>æ ‡ç‚¹ç¬¦å·æ˜¯C#è¯­è¨€çš„åŸºæœ¬å…ƒç´ ï¼Œå®ƒæ˜¯C#è¯­è¨€çš„æ ¸å¿ƒã€‚æ ‡ç‚¹ç¬¦å·æ˜¯C#è¯­è¨€çš„åŸºæœ¬è¯­æ³•å•ä½ï¼Œå®ƒæ˜¯C#è¯­è¨€çš„æ„å»ºå—ã€‚æ ‡ç‚¹ç¬¦å·çš„ä½œç”¨æ˜¯ç”¨æ¥å®šä¹‰ç¨‹åºçš„è¯­æ³•ç»“æ„ã€‚<b>åœ¨MSDNæ–‡æ¡£æœ‰å¯¹æ ‡ç‚¹ç¬¦å·çš„è¯¦ç»†ä»‹ç»ã€‚</b><li>æ–‡æœ¬(Text)</li><li>æ³¨é‡Šä¸ç©ºç™½(Comments and Whitespace)</li>![](img\Hello\tokne.png)<h1 id="åˆå§‹ç±»å‹ã€å˜é‡å’Œæ–¹æ³•"><a href="#åˆå§‹ç±»å‹ã€å˜é‡å’Œæ–¹æ³•" class="headerlink" title="åˆå§‹ç±»å‹ã€å˜é‡å’Œæ–¹æ³•"></a>åˆå§‹ç±»å‹ã€å˜é‡å’Œæ–¹æ³•</h1><li>åˆå§‹ç±»å‹(Primitive Types)</li><p><img src="/img%5CHello%5Ctype.png"></p><li>å˜é‡(Variables)</li><p>å˜é‡çš„å£°æ˜<br>å˜é‡çš„ä½¿ç”¨</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> x;</span><br><span class="line">x = <span class="number">10</span>;</span><br></pre></td></tr></table></figure><li>æ–¹æ³•(Methods)</li><p>æ–¹æ³•çš„å£°æ˜<br>æ–¹æ³•çš„è°ƒç”¨</p><p><img src="/img%5CHello%5Cfangfa.png"></p><li>ç¨‹åº=æ•°æ®+ç®—æ³•</li><p><b>æœ‰äº†å˜é‡å’Œæ–¹æ³•ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç¼–å†™æœ‰æ„ä¹‰çš„ç¨‹åºäº†ã€‚</b></p><h1 id="C-è¯­è¨€çš„ç±»å‹ç³»ç»Ÿ"><a href="#C-è¯­è¨€çš„ç±»å‹ç³»ç»Ÿ" class="headerlink" title="C#è¯­è¨€çš„ç±»å‹ç³»ç»Ÿ"></a>C#è¯­è¨€çš„ç±»å‹ç³»ç»Ÿ</h1><h2 id="C-çš„äº”å¤§æ•°æ®ç±»å‹"><a href="#C-çš„äº”å¤§æ•°æ®ç±»å‹" class="headerlink" title="C#çš„äº”å¤§æ•°æ®ç±»å‹"></a>C#çš„äº”å¤§æ•°æ®ç±»å‹</h2><li>ç±»ï¼ˆClassï¼‰ï¼šå¦‚Windowsã€Formã€Consoleã€Stringç­‰</li><li>ç»“æ„ä½“ï¼ˆStructuresï¼‰ï¼šå¦‚Int32ã€Int64ã€Singleã€Doubleç­‰</li><li>æšä¸¾ï¼ˆEnumerationsï¼‰ï¼šå¦‚HorizontalAlignmentã€Visibilityç­‰</li><li>æ¥å£ï¼ˆInterfacesï¼‰ï¼šå¦‚IEnumerableã€IDisposableç­‰</li><li>å§”æ‰˜ï¼ˆDelegatesï¼‰ï¼šå¦‚EventHandlerã€Funcç­‰</li><h2 id="C-ç±»å‹çš„æ´¾ç”Ÿè°±ç³»"><a href="#C-ç±»å‹çš„æ´¾ç”Ÿè°±ç³»" class="headerlink" title="C#ç±»å‹çš„æ´¾ç”Ÿè°±ç³»"></a>C#ç±»å‹çš„æ´¾ç”Ÿè°±ç³»</h2><p><img src="/img%5CHello%5CObject.png"></p><h1 id="å˜é‡ã€å¯¹è±¡ä¸å†…å­˜"><a href="#å˜é‡ã€å¯¹è±¡ä¸å†…å­˜" class="headerlink" title="å˜é‡ã€å¯¹è±¡ä¸å†…å­˜"></a>å˜é‡ã€å¯¹è±¡ä¸å†…å­˜</h1><h2 id="ä»€ä¹ˆæ˜¯å˜é‡"><a href="#ä»€ä¹ˆæ˜¯å˜é‡" class="headerlink" title="ä»€ä¹ˆæ˜¯å˜é‡"></a>ä»€ä¹ˆæ˜¯å˜é‡</h2><blockquote><p>å˜é‡&#x3D;ä»¥å˜é‡åæ‰€å¯¹åº”çš„å†…å­˜åœ°å€ä¸ºèµ·ç‚¹ã€ä»¥å…¶ä»–æ•°æ®ç±»å‹æ‰€è¦æ±‚çš„å­˜å‚¨ç©ºé—´ä¸ºé•¿åº¦çš„ä¸€å—å†…å­˜åŒºåŸŸ</p></blockquote><li>è¡¨é¢ä¸Šæ¥çœ‹ï¼Œå˜é‡çš„ç”¨é€”æ˜¯å­˜å‚¨æ•°æ®</li><li>å®é™…ä¸Šï¼Œå˜é‡è¡¨ç¤ºäº†å­˜å‚¨ä½ç½®ï¼Œå¹¶ä¸”æ¯ä¸ªå˜é‡éƒ½æœ‰ä¸€ä¸ªç±»å‹ï¼Œä¸å†³å®šä»€ä¹ˆæ ·çš„å€¼èƒ½ä¾›å­˜å…¥å˜é‡</li><li>å˜é‡ä¸€å…±æœ‰7ç§</li>é™æ€å˜é‡ã€å®ä¾‹å˜é‡(æˆå‘˜å˜é‡ã€å­—æ®µ)ã€æ•°ç»„å…ƒç´ ã€å€¼å‚æ•°ã€(ref)å¼•ç”¨å‚æ•°ã€(out)è¾“å‡ºå‚æ•°ã€å±€éƒ¨å‚æ•°<li>ç‹­ä¹‰çš„å˜é‡æŒ‡å±€éƒ¨å˜é‡ã€å› ä¸ºå…¶å®ƒç§ç±»çš„å˜é‡éƒ½æœ‰è‡ªå·±çš„çº¦å®šåç§°ï¼ˆå±€éƒ¨å˜é‡å°±æ˜¯æ–¹æ³•ä½“é‡Œçš„å£°æ˜çš„å˜é‡ï¼‰</li><li>å˜é‡çš„å£°æ˜</li>æœ‰æ•ˆçš„ä¿®é¥°ç¬¦ç»„åˆoptç±»å‹å˜é‡ååˆå§‹åŒ–å™¨opt<h2 id="å€¼ç±»å‹çš„å˜é‡"><a href="#å€¼ç±»å‹çš„å˜é‡" class="headerlink" title="å€¼ç±»å‹çš„å˜é‡"></a>å€¼ç±»å‹çš„å˜é‡</h2><li>ä»¥byte/sbtye/short/ushort/ä¸ºä¾‹</li><li>å€¼ç±»å‹æ²¡æœ‰å®ä¾‹ã€æ‰€è°“çš„â€œå®ä¾‹â€ä¸å˜é‡åˆè€Œä¸ºä¸€</li><h2 id="å¼•ç”¨ç±»å‹çš„å˜é‡"><a href="#å¼•ç”¨ç±»å‹çš„å˜é‡" class="headerlink" title="å¼•ç”¨ç±»å‹çš„å˜é‡"></a>å¼•ç”¨ç±»å‹çš„å˜é‡</h2><li>å¼•ç”¨ç±»å‹å˜é‡ä¸å®ä¾‹çš„å…³ç³»ï¼šå¼•ç”¨ç±»å‹å˜é‡é‡Œå­˜å‚¨çš„æ•°æ®æ˜¯å¯¹è±¡çš„å†…å­˜åœ°å€<h1 id="è£…ç®±ä¸æ‹†ç®±ï¼ˆBoxing-Unboxingï¼‰"><a href="#è£…ç®±ä¸æ‹†ç®±ï¼ˆBoxing-Unboxingï¼‰" class="headerlink" title="è£…ç®±ä¸æ‹†ç®±ï¼ˆBoxing&amp;Unboxingï¼‰"></a>è£…ç®±ä¸æ‹†ç®±ï¼ˆBoxing&amp;Unboxingï¼‰</h1><li>è£…ç®±ï¼šå°†å€¼ç±»å‹è½¬æ¢ä¸ºå¼•ç”¨ç±»å‹</li><li>æ‹†ç®±ï¼šå°†å¼•ç”¨ç±»å‹è½¬æ¢ä¸ºå€¼ç±»å‹</li><h1 id="æ“ä½œç¬¦"><a href="#æ“ä½œç¬¦" class="headerlink" title="æ“ä½œç¬¦"></a>æ“ä½œç¬¦</h1><p>æ“ä½œç¬¦é¢„è§ˆï¼š<br><img src="/img%5CHello%5CCAHOZUOFU.png"></p><p>æ“ä½œç¬¦ä¼˜å…ˆçº§ä»ä¸Šå¾€ä¸‹ä¾æ¬¡é™ä½ï¼ŒåŒä¸€è¡Œçš„æ“ä½œç¬¦ä¼˜å…ˆçº§ç›¸åŒã€‚<br>ç›¸åŒæ“ä½œç¬¦åœ¨è¡¨è¾¾å¼ä¸­è¿ç®—é¡ºåºæ˜¯ä»å·¦å¾€å³å†³å®šã€‚</p><p>ä½†èµ‹å€¼å’Œlanbdaè¡¨è¾¾å¼çš„ä¼˜å…ˆçº§ä¸åŒã€‚<br>ä»–æ˜¯ä»å³å¾€å·¦è¿ç®—çš„ã€‚</p><h1 id="Typeofæ“ä½œç¬¦"><a href="#Typeofæ“ä½œç¬¦" class="headerlink" title="Typeofæ“ä½œç¬¦:"></a>Typeofæ“ä½œç¬¦:</h1><p><img src="/img%5CHello%5CSnipaste_2025-02-11_11-48-57.png"></p><h1 id="varå’Œnewçš„ç»„åˆ"><a href="#varå’Œnewçš„ç»„åˆ" class="headerlink" title="varå’Œnewçš„ç»„åˆ"></a>varå’Œnewçš„ç»„åˆ</h1><p>å°† var å’Œ new ç»“åˆä½¿ç”¨åœ¨ C# ä¸­æ˜¯ä¸€ç§å¸¸è§çš„è¯­æ³•ç³–ï¼Œæä¾›äº†æ›´åŠ ç®€æ´å’Œæ¸…æ™°çš„ä»£ç å†™æ³•ã€‚å…·ä½“æ¥è¯´ï¼š</p><p>è¯­ä¹‰ä¸Šçš„ä¼˜åŒ–ï¼š</p><p>ä½¿ç”¨ var new Type obj &#x3D; new Type(); å¯ä»¥è®©ç¼–è¯‘å™¨æ›´æ¸…æ¥šåœ°ç†è§£å˜é‡æ˜¯åœ¨åˆå§‹åŒ–å“ªä¸ªå¯¹è±¡æˆ–æ•°ç»„ä¸­ã€‚<br>ä¿æŒä¸€è‡´æ€§ï¼š</p><p>è¿™ç§ç»„åˆä½¿å¾—åœ¨å®šä¹‰å’Œåˆå§‹åŒ–å¯¹è±¡æ—¶çš„ä»£ç é£æ ¼ä¸€è‡´ï¼Œæœ‰åŠ©äºæé«˜å¯è¯»æ€§å’Œç»´æŠ¤æ€§ã€‚<br>å¤šæ€æ€§çš„æ”¯æŒï¼š</p><p>å½“ç›®æ ‡ç±»å‹æ˜¯å¤šæ€ç±»å‹æ—¶ï¼Œç»“åˆ var å’Œ new å¯ä»¥æ›´è‡ªç„¶åœ°å¤„ç†ç»§æ‰¿æˆ–æ¥å£å®ç°çš„æƒ…å†µã€‚<br>æ‰©å±•æ€§å’Œçµæ´»æ€§ï¼š</p><p>è¿™ç§è¯­æ³•ç³–å…è®¸åœ¨åˆå§‹åŒ–å¤æ‚çš„å¯¹è±¡ã€æ•°ç»„æˆ–å…¶ä»–ç»“æ„æ—¶ä¿æŒä»£ç çš„ç®€æ´å’Œå¯è¯»æ€§ã€‚</p><h1 id="checkedæ“ä½œç¬¦"><a href="#checkedæ“ä½œç¬¦" class="headerlink" title="checkedæ“ä½œç¬¦"></a>checkedæ“ä½œç¬¦</h1><p><img src="/img%5CHello%5CSnipaste_2025-02-11_13-04-03.png"></p><h1 id="é€»è¾‘â€œä¸â€ã€â€œXORâ€ã€â€œORâ€è¿ç®—ç¬¦"><a href="#é€»è¾‘â€œä¸â€ã€â€œXORâ€ã€â€œORâ€è¿ç®—ç¬¦" class="headerlink" title="é€»è¾‘â€œä¸â€ã€â€œXORâ€ã€â€œORâ€è¿ç®—ç¬¦"></a>é€»è¾‘â€œä¸â€ã€â€œXORâ€ã€â€œORâ€è¿ç®—ç¬¦</h1><p> <img src="/img%5CHello%5CSnipaste_2025-02-11_15-28-48.png"></p><p> <img src="/img%5CHello%5CSnipaste_2025-02-11_15-34-07.png"></p><p> <img src="/img%5CHello%5CSnipaste_2025-02-11_15-38-04.png"></p><h1 id="nullåˆå¹¶è¿ç®—ç¬¦"><a href="#nullåˆå¹¶è¿ç®—ç¬¦" class="headerlink" title="nullåˆå¹¶è¿ç®—ç¬¦"></a>nullåˆå¹¶è¿ç®—ç¬¦</h1><p><img src="/img%5CHello%5CSnipaste_2025-02-11_15-58-53.png"></p><h1 id="æ¡ä»¶æ“ä½œç¬¦"><a href="#æ¡ä»¶æ“ä½œç¬¦" class="headerlink" title="æ¡ä»¶æ“ä½œç¬¦"></a>æ¡ä»¶æ“ä½œç¬¦</h1><p><img src="/img%5CHello%5CSnipaste_2025-02-11_16-08-30.png"></p><h1 id="æ“ä½œç¬¦çš„æœ¬è´¨"><a href="#æ“ä½œç¬¦çš„æœ¬è´¨" class="headerlink" title="æ“ä½œç¬¦çš„æœ¬è´¨"></a>æ“ä½œç¬¦çš„æœ¬è´¨</h1><li>æ“ä½œç¬¦ä¸èƒ½è„±ç¦»ä¸å®ƒå…³è”çš„æ•°æ®ç±»å‹</li>å¯ä»¥è¯´æ“ä½œç¬¦å°±æ˜¯ä¸å›ºå®šæ•°æ®ç±»å‹ç›¸å…³è”çš„ä¸€å¥—åŸºæœ¬ç®—æ³•çš„ç®€è®°æ³•ä¸ºè‡ªå®šä¹‰æ•°æ®ç±»å‹åˆ›é€ æ“ä½œç¬¦<p><img src="/img%5CHello%5Ccao.png"></p><p><img src="/img%5CHello%5CSnipaste.png"></p><h1 id="ç±»å‹è½¬æ¢"><a href="#ç±»å‹è½¬æ¢" class="headerlink" title="ç±»å‹è½¬æ¢"></a>ç±»å‹è½¬æ¢</h1><li>éšå¼ç±»å‹è½¬æ¢</li>ä¸ä¸¢å¤±ç²¾åº¦çš„è½¬æ¢<p><img src="/img%5CHello%5CSnipaste_2025-02-11_14-11-41.png"></p><p>å­ç±»å‘çˆ¶ç±»çš„è½¬æ¢</p><p>è£…ç®±</p><li>æ˜¾å¼ç±»å‹è½¬æ¢</li>æœ‰å¯èƒ½ä¸¢å¤±ç²¾åº¦ï¼ˆç”šè‡³å‘ç”Ÿé”™è¯¯ï¼‰æ‹†ç®±ä½¿ç”¨Convertç±»ToString()æ–¹æ³•ä¸å„æ•°æ®ç±»å‹çš„Parse/TryParseæ–¹æ³•<h1 id="è¡¨è¾¾å¼çš„å®šä¹‰"><a href="#è¡¨è¾¾å¼çš„å®šä¹‰" class="headerlink" title="è¡¨è¾¾å¼çš„å®šä¹‰"></a>è¡¨è¾¾å¼çš„å®šä¹‰</h1><li>ç®—æ³•é€»è¾‘çš„æœ€åŸºæœ¬ï¼ˆæœ€å°ï¼‰å•å…ƒï¼Œè¡¨è¾¾ä¸€å®šçš„ç®—æ³•æ„å›¾</li><li>å› ä¸ºæ“ä½œç¬¦æœ‰ä¼˜å…ˆçº§ï¼Œæ‰€ä»¥è¡¨è¾¾å¼ä¹Ÿæœ‰ä¼˜å…ˆçº§</li><h1 id="C-è¯­è¨€ä¸­è¡¨è¾¾å¼çš„åˆ†ç±»"><a href="#C-è¯­è¨€ä¸­è¡¨è¾¾å¼çš„åˆ†ç±»" class="headerlink" title="C#è¯­è¨€ä¸­è¡¨è¾¾å¼çš„åˆ†ç±»"></a>C#è¯­è¨€ä¸­è¡¨è¾¾å¼çš„åˆ†ç±»</h1><li>A value.Every value has an associated type.ä»»ä½•èƒ½å¾—åˆ°å€¼çš„è¿ç®—ï¼ˆå›é¡¾æ“ä½œç¬¦å’Œç»“æœç±»å‹ï¼‰</li><li>A variable.Every variable has an associated type.</li><li>A namespace</li><li>A type.</li><li>A method group. ä¾‹å¦‚ï¼šConsole.WriteLine,è¿™æ˜¯ä¸€ç»„æ–¹æ³•ï¼Œé‡è½½å†³ç­–å†³å®šå…·ä½“è°ƒç”¨å“ªä¸ªæ–¹æ³•</li><li>A null literal.</li><li>An anonymous function.</li><li>A property access.</li><li>An event access.</li><li>An indexer access.</li><li>Nothing.å¯¹è¿”å›å€¼ä¸ºvoidçš„æ–¹æ³•çš„è°ƒç”¨</li><h1 id="ç¬¦åˆè¡¨è¾¾å¼çš„æ±‚å€¼"><a href="#ç¬¦åˆè¡¨è¾¾å¼çš„æ±‚å€¼" class="headerlink" title="ç¬¦åˆè¡¨è¾¾å¼çš„æ±‚å€¼"></a>ç¬¦åˆè¡¨è¾¾å¼çš„æ±‚å€¼</h1><p>æ“ä½œç¬¦çš„ä¼˜å…ˆçº§å’ŒåŒä¼˜å…ˆçº§æ“ä½œç¬¦çš„è¿ç®—æ–¹å‘</p><h1 id="C-è¯­è¨€å¯¹è¯­å¥çš„å®šä¹‰"><a href="#C-è¯­è¨€å¯¹è¯­å¥çš„å®šä¹‰" class="headerlink" title="C#è¯­è¨€å¯¹è¯­å¥çš„å®šä¹‰"></a>C#è¯­è¨€å¯¹è¯­å¥çš„å®šä¹‰</h1><li>C#è¯­è¨€çš„è¯­å¥é™¤äº†èƒ½å¤Ÿè®©ç¨‹åºå‘˜â€œé¡ºåºåœ°ï¼ˆsequentiallyï¼‰â€è¡¨è¾¾ç®—æ³•æ€æƒ³ï¼Œè¿˜èƒ½é€šè¿‡æ¡ä»¶åˆ¤æ–­ã€è·³è½¬å’Œå¾ªç¯ç­‰æ–¹æ³•æ§åˆ¶ç¨‹åºé€»è¾‘çš„èµ°å‘</li><li>ç®€è¨€ä¹‹å°±æ˜¯ï¼šé™ˆè¿°ç®—æ³•æ€æƒ³ï¼Œæ§åˆ¶é€»è¾‘èµ°å‘ï¼Œå®Œæˆæœ‰æ„ä¹‰çš„åŠ¨ä½œï¼ˆactionï¼‰</li><li>C#è¯­è¨€çš„è¯­å¥ç”±åˆ†å·ï¼ˆ;ï¼‰ç»“å°¾ï¼Œä½†ç”±åˆ†å·ç»“å°¾çš„ä¸ä¸€å®šéƒ½æ˜¯è¯­å¥</li><li>è¯­å¥ä¸€å®šæ˜¯å‡ºç°åœ¨æ–¹æ³•ä½“é‡Œ</li><h1 id="ä»€ä¹ˆæ˜¯å­—æ®µ"><a href="#ä»€ä¹ˆæ˜¯å­—æ®µ" class="headerlink" title="ä»€ä¹ˆæ˜¯å­—æ®µ"></a>ä»€ä¹ˆæ˜¯å­—æ®µ</h1><p>å­—æ®µæ˜¯ç±»å‹çš„æˆå‘˜ï¼Œå†™åœ¨ç±»é‡Œé¢çš„æ‰æ˜¯å­—æ®µï¼Œå†™åœ¨å‡½æ•°é‡Œé¢å«å±€éƒ¨å˜é‡</p><p>å­—æ®µï¼ˆfieldï¼‰æ˜¯ä¸€ç§è¡¨ç¤ºä¸å¯¹è±¡æˆ–ç±»å‹ï¼ˆç±»ä¸ç»“æ„ä½“ï¼‰å…³è”çš„å˜é‡<br>å­—æ®µæ˜¯ç±»å‹çš„æˆå‘˜ï¼Œä¹Ÿå«â€œæˆå‘˜å˜é‡â€<br>ä¸å¯¹è±¡å…³è”çš„å­—æ®µäº¦ç§°â€œå®ä¾‹å­—æ®µâ€<br>ä¸ç±»ç›¸å…³è”çš„å­—æ®µç§°ä¸ºâ€œé™æ€å­—æ®µâ€ï¼Œç”±staticä¿®é¥°</p><h1 id="å­—æ®µçš„åˆå§‹åŒ–"><a href="#å­—æ®µçš„åˆå§‹åŒ–" class="headerlink" title="å­—æ®µçš„åˆå§‹åŒ–"></a>å­—æ®µçš„åˆå§‹åŒ–</h1><p>æ— æ˜¾ç¤ºåˆå§‹åŒ–æ—¶ï¼Œå­—æ®µè·å¾—å…¶ç±»å‹çš„é»˜è®¤å€¼ï¼Œæ‰€ä»¥å­—æ®µâ€œæ°¸è¿œéƒ½ä¸ä¼šè¢«åˆå§‹åŒ–â€<br>å®ä¾‹å­—æ®µåˆå§‹åŒ–çš„æ—¶æœºâ€”â€”â€”â€”å¯¹è±¡åˆ›å»ºæ—¶<br>é™æ€å­—æ®µåˆå§‹åŒ–çš„æ—¶æœºâ€”â€”â€”â€”ç±»å‹è¢«åŠ è½½ï¼ˆloadï¼‰æ—¶</p><h1 id="readonly-åªè¯»å­—æ®µ"><a href="#readonly-åªè¯»å­—æ®µ" class="headerlink" title="readonly(åªè¯»å­—æ®µ)"></a>readonly(åªè¯»å­—æ®µ)</h1><p><b>â€œreadonlyâ€å­—æ®µåœ¨C#ç¼–ç¨‹ä¸­æœ‰ç€å¹¿æ³›çš„åº”ç”¨ä»·å€¼ã€‚å®ƒä¸ä»…æœ‰åŠ©äºæé«˜ä»£ç çš„è´¨é‡å’Œå¯ç»´æŠ¤æ€§ï¼Œè¿˜èƒ½æœ‰æ•ˆä¿éšœæ•°æ®çš„ä¸€è‡´æ€§å’Œå®‰å…¨æ€§ï¼Œé€‚ç”¨äºå¤šä¸ªé¢†åŸŸå’ŒæŠ€æœ¯æ ˆä¸­çš„å¼€å‘å®è·µã€‚</b></p><p>å£°æ˜ä¸Šä¸‹æ–‡ </p><p>åªèƒ½åœ¨æ¨¡å—çº§åˆ«ä½¿ç”¨ ReadOnlyã€‚ è¿™æ„å‘³ç€ ReadOnly å…ƒç´ çš„å£°æ˜ä¸Šä¸‹æ–‡å¿…é¡»æ˜¯ç±»ã€ç»“æ„æˆ–æ¨¡å—ï¼Œä¸èƒ½æ˜¯æºæ–‡ä»¶ã€å‘½åç©ºé—´æˆ–è¿‡ç¨‹ã€‚</p><p>ç»„åˆä¿®é¥°ç¬¦</p><p>ä¸èƒ½åœ¨åŒä¸€è¿‡ç¨‹å£°æ˜ä¸­åŒæ—¶æŒ‡å®š ReadOnly å’Œ Staticã€‚</p><p>èµ‹å€¼</p><p>ä½¿ç”¨ ReadOnly å±æ€§çš„ä»£ç æ— æ³•è®¾ç½®å…¶å€¼ã€‚ ä½†èƒ½å¤Ÿè®¿é—®åŸºç¡€å­˜å‚¨çš„ä»£ç å¯éšæ—¶èµ‹å€¼æˆ–æ›´æ”¹å€¼ã€‚<br>åªèƒ½åœ¨ ReadOnly å˜é‡çš„å£°æ˜ä¸­æˆ–åœ¨å®šä¹‰å®ƒçš„ç±»æˆ–ç»“æ„çš„æ„é€ å‡½æ•°ä¸­ä¸ºå…¶èµ‹å€¼</p><p><img src="/img%5CHello%5CSnipaste_2025-02-15_21-00-06.png"></p><h1 id="å±æ€§"><a href="#å±æ€§" class="headerlink" title="å±æ€§"></a>å±æ€§</h1><p><img src="/img%5CHello%5CSnipaste_2025-02-15_22-54-28.png"></p><p>ä»€ä¹ˆæ˜¯å±æ€§<br><img src="/img%5CHello%5CSnipaste_2025-02-15_22-33-04.png"></p><p><img src="/img%5CHello%5CSnipaste_2025-02-15_22-33-00.png"></p><p>å±æ€§çš„å£°æ˜</p><p><img src="/img%5CHello%5CSnipaste_2025-02-15_22-32-53.png"></p><p>åŠ¨æ€å±æ€§</p><p><img src="/img%5CHello%5CSnipaste_2025-02-15_22-53-36.png"></p><h1 id="å¸¸é‡ï¼ˆconstï¼‰"><a href="#å¸¸é‡ï¼ˆconstï¼‰" class="headerlink" title="å¸¸é‡ï¼ˆconstï¼‰"></a>å¸¸é‡ï¼ˆconstï¼‰</h1><p><img src="/img%5CHello%5CSnipaste_2025-02-15_23-07-18.png"></p><h1 id="å¼•ç”¨å‚æ•°"><a href="#å¼•ç”¨å‚æ•°" class="headerlink" title="å¼•ç”¨å‚æ•°"></a>å¼•ç”¨å‚æ•°</h1><p> å¼•ç”¨å‚æ•°æ˜¯ç”¨refä¿®é¥°ç¬¦å£°æ˜çš„å½¢å‚ã€‚ä¸å€¼å½¢å‚ä¸åŒï¼Œå¼•ç”¨å½¢å‚å¹¶ä¸åˆ›å»ºæ–°çš„å­˜å‚¨ä½ç½®ã€‚ç›¸åï¼Œå¼•ç”¨å½¢å‚è¡¨ç¤ºçš„å­˜å‚¨ä½ç½®æ°æ˜¯æ–¹æ³•è°ƒç”¨ä¸­ä½œä¸ºå®å‚ç»™å‡ºçš„é‚£ä¸ªå˜é‡æ‰€è¡¨ç¤ºçš„å­˜å‚¨ä½ç½®ã€‚</p><p> å½“å½¢å‚ä¸ºå¼•ç”¨å½¢å‚æ—¶ï¼Œæ–¹æ³•è°ƒç”¨ä¸­çš„å¯¹åº”å®å‚å¿…é¡»ç”±å…³é”®å­—refå¹¶åæ¥ä¸€ä¸ªä¸å½¢å‚ç±»å‹ç›¸åŒçš„variable-referenceï¼ˆå˜é‡å¼•ç”¨ï¼‰ç»„æˆã€‚å˜é‡åœ¨å¯ä»¥ä½œä¸ºå¼•ç”¨å½¢å‚ä¼ é€’ä¹‹å‰ï¼Œå¿…é¡»å…ˆæ˜ç¡®èµ‹å€¼ã€‚</p><p> åœ¨æ–¹æ³•å†…éƒ¨ï¼Œå¼•ç”¨å½¢å‚å§‹ç»ˆè¢«è®¤ä¸ºæ˜¯æ˜ç¡®èµ‹å€¼çš„ã€‚<br> å£°æ˜ä¸ºè¿­ä»£å™¨çš„æ–¹æ³•ä¸èƒ½æœ‰å¼•ç”¨å½¢å‚ã€‚</p><p> <img src="/img%5CHello%5CSnipaste_2025-02-16_10-35-37.png"></p><p> <img src="/img%5CHello%5CSnipaste_2025-02-16_10-52-51.png"></p><p> ä¸åˆ›å»ºæ–°å¯¹è±¡åªæ”¹å˜å¯¹è±¡å€¼</p><h1 id="è¾“å‡ºå‚æ•°"><a href="#è¾“å‡ºå‚æ•°" class="headerlink" title="è¾“å‡ºå‚æ•°"></a>è¾“å‡ºå‚æ•°</h1><p> ç”¨outä¿®é¥°ç¬¦å£°æ˜çš„å½¢å‚æ˜¯è¾“å‡ºå½¢å‚ã€‚ç±»ä¼¼äºå¼•ç”¨å½¢å‚ï¼Œè¾“å‡ºå½¢å‚ä¸åˆ›å»ºæ–°çš„å†…å­˜ä½ç½®ã€‚ç›¸åï¼Œè¾“å‡ºå½¢å‚è¡¨çš„å­˜å‚¨ä½ç½®æ°æ˜¯åœ¨è¯¥æ–¹æ³•è°ƒç”¨ä¸­ä½œä¸ºå®å‚ç»™å‡ºçš„é‚£ä¸ªå˜é‡æ‰€è¡¨ç¤ºçš„å­˜å‚¨ä½ç½®ã€‚</p><p> å½“å½¢å‚ä¸ºè¾“å‡ºå½¢å‚æ—¶ï¼Œæ–¹æ³•è°ƒç”¨ä¸­çš„ç›¸åº”å®å‚å¿…é¡»ç”±å…³é”®å­—outå¹¶åæ¥ä¸€ä¸ªä¸å½¢å‚ç±»å‹ç›¸åŒçš„varable-referenceç»„æˆã€‚å˜é‡åœ¨å¯ä»¥ä½œä¸ºè¾“å‡ºå½¢å‚ä¼ é€’ä¹‹å‰ä¸ä¸€å®šéœ€è¦æ˜ç¡®èµ‹å€¼ï¼Œä½†æ˜¯åœ¨å°†å˜é‡ä½œä¸ºè¾“å‡ºå½¢å‚ä¼ é€’çš„è°ƒç”¨ä¹‹åï¼Œè¯¥å˜é‡è¢«è®¤ä¸ºæ˜¯æ˜ç¡®èµ‹å€¼çš„ã€‚</p><p> åœ¨æ–¹æ³•å†…éƒ¨ï¼Œä¸å±€éƒ¨å˜é‡ç›¸åŒï¼Œè¾“å‡ºå½¢å‚æœ€åˆè¢«è®¤ä¸ºæ˜¯æœªèµ‹å€¼çš„ï¼Œå› è€Œå¿…é¡»åœ¨ä½¿ç”¨å®ƒçš„å€¼ä¹‹å‰æ˜ç¡®èµ‹å€¼ã€‚</p><p> åœ¨æ–¹æ³•è¿”å›ä¹‹å‰ï¼Œè¯¥æ–¹æ³•çš„æ¯ä¸ªè¾“å‡ºå½¢å‚éƒ½å¿…é¡»æ˜ç¡®èµ‹å€¼ã€‚</p><p> å£°æ˜ä¸ºéƒ¨åˆ†æ–¹æ³•æˆ–è¿­ä»£å™¨çš„æ–¹æ³•ä¸èƒ½æœ‰è¾“å‡ºå½¢å‚ã€‚</p><p> <img src="/img%5CHello%5CSnipaste_2025-02-16_11-34-04.png"></p><p> å¦‚ä½•ä½¿ç”¨å¼•ç”¨ç±»å‹å‚æ•°<br> <img src="/img%5CHello%5CSnipaste_2025-02-16_12-05-39.png"></p><h1 id="æ•°ç»„å‚æ•°"><a href="#æ•°ç»„å‚æ•°" class="headerlink" title="æ•°ç»„å‚æ•°"></a>æ•°ç»„å‚æ•°</h1><p> <img src="/img%5CHello%5CSnipaste_2025-02-16_13-16-35.png"></p><h1 id="å…·åå‚æ•°"><a href="#å…·åå‚æ•°" class="headerlink" title="å…·åå‚æ•°"></a>å…·åå‚æ•°</h1><p> <img src="/img%5CHello%5CSnipaste_2025-02-16_13-30-20.png"></p><h1 id="æ‰©å±•æ–¹æ³•ï¼ˆthiså‚æ•°ï¼‰"><a href="#æ‰©å±•æ–¹æ³•ï¼ˆthiså‚æ•°ï¼‰" class="headerlink" title="æ‰©å±•æ–¹æ³•ï¼ˆthiså‚æ•°ï¼‰"></a>æ‰©å±•æ–¹æ³•ï¼ˆthiså‚æ•°ï¼‰</h1><p> æ–¹æ³•å¿…é¡»æ˜¯å…¬æœ‰ã€é™æ€çš„ã€å³è¢«public staticæ‰€ä¿®é¥°<br> å¿…éœ€æ˜¯å½¢å‚åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªï¼Œç”±thisä¿®é¥°<br> å¿…éœ€ç”±ä¸€ä¸ªé™æ€ç±»ï¼ˆä¸€èˆ¬ç±»åä¸ºSomeTypeExtensionï¼‰æ¥ç»Ÿä¸€æ”¶çº³å¯¹SomeTypeç±»å‹çš„æ‰©å±•æ–¹æ³•</p><p> <img src="/img%5CHello%5CSnipaste_2025-02-16_15-23-17.png"></p><h1 id="ä»€ä¹ˆæ˜¯å§”æ‰˜"><a href="#ä»€ä¹ˆæ˜¯å§”æ‰˜" class="headerlink" title="ä»€ä¹ˆæ˜¯å§”æ‰˜"></a>ä»€ä¹ˆæ˜¯å§”æ‰˜</h1><p> å§”æ‰˜ï¼ˆdelegateï¼‰æ˜¯å‡½æ•°æŒ‡é’ˆçš„â€œå‡çº§ç‰ˆâ€</p><p> ä¸€åˆ‡çš†åœ°å€<br> å˜é‡ï¼ˆæ•°æ®ï¼‰æ˜¯ä»¥æŸä¸ªåœ°å€ä¸ºèµ·ç‚¹çš„ä¸€æ®µå†…å­˜ä¸­æ‰€å­˜å‚¨çš„å€¼<br> å‡½æ•°ï¼ˆç®—æ³•ï¼‰æ˜¯ä»¥æŸä¸ªåœ°å€ä¸ºèµ·ç‚¹çš„ä¸€æ®µå†…å­˜ä¸­æ‰€å­˜å‚¨çš„ä¸€ç»„æœºå™¨è¯­è¨€æŒ‡ä»¤</p><p> ç›´æ¥è°ƒç”¨ä¸é—´æ¥è°ƒç”¨<br> ç›´æ¥è°ƒç”¨ï¼šé€šè¿‡å‡½æ•°åæ¥è°ƒç”¨å‡½æ•°ï¼ŒCPUé€šè¿‡å‡½æ•°åç›´æ¥è·å¾—å‡½æ•°æ‰€åœ¨åœ°å€å¹¶å¼€å§‹æ‰§è¡Œ,è¿”å›<br> é—´æ¥è°ƒç”¨ï¼šé€šè¿‡å‡½æ•°æŒ‡é’ˆæ¥è°ƒç”¨å‡½æ•°ï¼ŒCPUé€šè¿‡è¯»å–å‡½æ•°æŒ‡é’ˆå­˜å‚¨çš„å€¼è·å¾—å‡½æ•°æ‰€åœ¨åœ°å€å¹¶å¼€å§‹æ‰§è¡Œï¼Œè¿”å›</p><p> Actionå§”æ‰˜</p><p> <img src="/img%5CHello%5CSnipaste_2025-02-16_16-18-04.png"></p><p> Funcå§”æ‰˜</p><p> <img src="/img%5CHello%5CSnipaste_2025-02-16_16-29-37.png"></p><h1 id="å§”æ‰˜çš„å£°æ˜ï¼ˆè‡ªå®šä¹‰å§”æ‰˜ï¼‰"><a href="#å§”æ‰˜çš„å£°æ˜ï¼ˆè‡ªå®šä¹‰å§”æ‰˜ï¼‰" class="headerlink" title="å§”æ‰˜çš„å£°æ˜ï¼ˆè‡ªå®šä¹‰å§”æ‰˜ï¼‰"></a>å§”æ‰˜çš„å£°æ˜ï¼ˆè‡ªå®šä¹‰å§”æ‰˜ï¼‰</h1><p> å§”æ‰˜æ˜¯ä¸€ç§ç±»ï¼ˆclassï¼‰,ç±»æ˜¯æ•°æ®ç±»å‹æ‰€ä»¥å§”æ‰˜ä¹Ÿæ˜¯ä¸€ç§æ•°æ®ç±»å‹<br> å®ƒçš„å£°æ˜æ–¹å¼ä¸ä¸€èˆ¬çš„ç±»ä¸åŒï¼Œä¸»è¦æ˜¯ä¸ºäº†ç…§é¡¾å¯è¯»æ€§å’ŒC&#x2F;C++ä¼ ç»Ÿ<br> æ³¨æ„å£°æ˜å§”æ‰˜çš„ä½ç½®<br> å§”æ‰˜ä¸æ‰€å°è£…çš„æ–¹æ³•å¿…éœ€â€œç±»å‹å…¼å®¹â€</p><p><img src="/img%5CHello%5CSnipaste_2025-02-16_19-14-44.png"></p><h1 id="å§”æ‰˜çš„ä¸€èˆ¬ä½¿ç”¨"><a href="#å§”æ‰˜çš„ä¸€èˆ¬ä½¿ç”¨" class="headerlink" title="å§”æ‰˜çš„ä¸€èˆ¬ä½¿ç”¨"></a>å§”æ‰˜çš„ä¸€èˆ¬ä½¿ç”¨</h1><p> å®ä¾‹ï¼šæŠŠæ–¹æ³•å½“ä½œå‚æ•°ä¼ ç»™å¦ä¸€ä¸ªæ–¹æ³•<br> æ­£ç¡®ä½¿ç”¨1ï¼šæ¨¡æ¿æ–¹æ³•ï¼Œâ€œå€Ÿç”¨â€æŒ‡å®šçš„å¤–éƒ¨æ–¹æ³•æ¥äº§ç”Ÿç»“æœ<br> ç›¸å½“äºâ€œå¡«ç©ºé¢˜â€<br> å¸¸ä½äºä»£ç ä¸­éƒ¨<br> å§”æ‰˜æœ‰è¿”å›å€¼</p><p> æ­£ç¡®ä½¿ç”¨2ï¼šå›è°ƒï¼ˆcallbackï¼‰æ–¹æ³•ï¼Œè°ƒç”¨æŒ‡å®šçš„å¤–éƒ¨æ–¹æ³•<br> ç›¸å½“äºâ€œæµæ°´çº¿â€<br> å¸¸ä½äºä»£ç æœ«å°¾<br> å§”æ‰˜æ— è¿”å›å€¼</p><p> <img src="/img%5CHello%5CSnipaste_2025-02-16_22-18-32.png"></p><p> <img src="/img%5CHello%5CSnipaste_2025-02-16_22-18-44.png"></p><p> <img src="/img%5CHello%5CSnipaste_2025-02-16_22-18-56.png"></p><h1 id="å§”æ‰˜çš„é«˜çº§ä½¿ç”¨"><a href="#å§”æ‰˜çš„é«˜çº§ä½¿ç”¨" class="headerlink" title="å§”æ‰˜çš„é«˜çº§ä½¿ç”¨"></a>å§”æ‰˜çš„é«˜çº§ä½¿ç”¨</h1><p> <img src="/img%5CHello%5CSnipaste_2025-02-16_22-17-11.png"></p><p> <img src="/img%5CHello%5CSnipaste_2025-02-16_22-16-05.png"></p><p> åŒæ­¥</p><p> <img src="/img%5CHello%5CSnipaste_2025-02-16_22-28-48.png"></p><p> é—´æ¥åŒæ­¥<br> <img src="/img%5CHello%5CSnipaste_2025-02-16_22-32-52.png"></p><p> å¤šæ’­çš„å¤šæ’­</p><p> ä¸€ä¸ªä¸»å§”æ‰˜å¯¹è±¡å¯ä»¥å®¹çº³å¤šä¸ªå…¶ä»–çš„å­å§”æ‰˜å¯¹è±¡ï¼Œå½“è°ƒç”¨ä¸»å§”æ‰˜å¯¹è±¡ï¼Œä¼šå°†æ‰€æœ‰å­å§”æ‰˜å…¨éƒ¨æŒ‰åºè¿è¡Œ</p><p> å¼‚æ­¥</p><p> éšå¼å¼‚æ­¥</p><p> <img src="/img%5CHello%5CSnipaste_2025-02-16_22-39-00.png"></p><h1 id="äº‹ä»¶"><a href="#äº‹ä»¶" class="headerlink" title="äº‹ä»¶"></a>äº‹ä»¶</h1><h2 id="äº‹ä»¶ä¸“ç”¨å§”æ‰˜å®šä¹‰"><a href="#äº‹ä»¶ä¸“ç”¨å§”æ‰˜å®šä¹‰" class="headerlink" title="äº‹ä»¶ä¸“ç”¨å§”æ‰˜å®šä¹‰"></a>äº‹ä»¶ä¸“ç”¨å§”æ‰˜å®šä¹‰</h2> <figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">delegate</span> <span class="keyword">void</span> <span class="title">EventHandler</span>(<span class="params">Object? sender,EventArgs e</span>)</span>;</span><br></pre></td></tr></table></figure><h2 id="ä¸ºäº†èƒ½å¤Ÿæ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼š"><a href="#ä¸ºäº†èƒ½å¤Ÿæ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼š" class="headerlink" title="ä¸ºäº†èƒ½å¤Ÿæ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼š"></a>ä¸ºäº†èƒ½å¤Ÿæ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼š</h2><p> äº‹ä»¶å¯¹åº”çš„å§”æ‰˜ï¼Œä¸åº”è¯¥è¢«ç±»å¤–ç•Œè°ƒç”¨ï¼Œåªèƒ½ç”±æŸä¸ªæ“ä½œè§¦å‘<br> äº‹ä»¶å¯¹åº”çš„å§”æ‰˜ï¼Œä¸åº”è¯¥è¢«ç±»å¤–ç•Œç›´æ¥èµ‹å€¼ï¼Œåªèƒ½å¤Ÿé€šè¿‡+ã€-å¢å‡å§”æ‰˜æ–¹æ³•<br> <figure class="highlight csharp"><figcaption><span>äº‹ä»¶æœ€ç»ˆå†™æ³•</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Player</span></span><br><span class="line">&#123;</span><br><span class="line">      <span class="keyword">public</span> evnet EventHandler OnAttack = unll;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br> æ€»ç»“ï¼šç±»å†…å®šä¹‰ã€ç±»å†…è§¦å‘ã€åªèƒ½åŠ å‡ã€ä¸å¯èµ‹å€¼</p><p> äº‹ä»¶æ˜¯åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­è§¦å‘çš„ç‰¹å®šåŠ¨ä½œã€‚å®ƒå¯ä»¥æ˜¯ç”¨æˆ·æ“ä½œï¼ˆå¦‚ç‚¹å‡»æŒ‰é’®ï¼‰å¼•èµ·çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯æ•°æ®å¤„ç†ã€é›†åˆéå†ç­‰å¼•èµ·çš„ã€‚<br> æ¯ä¸ªäº‹ä»¶åŒ…å«ä¸€ä¸ªäº‹ä»¶è§¦å‘å™¨å’Œç›¸åº”çš„å“åº”ä»£ç ã€‚</p><p> <img src="/img%5CHello%5CSnipaste_2025-02-17_10-39-58.png"></p><p>äº‹ä»¶çš„è¿ç”¨</p><p><b>äº‹ä»¶å¯¹åº”çš„å§”æ‰˜ï¼Œä¸åº”è¯¥è¢«ç±»å¤–ç•Œç›´æ¥èµ‹å€¼ï¼Œåªèƒ½å¤Ÿé€šè¿‡+ã€-å¢å‡å§”æ‰˜æ–¹æ³•</b></p><p> ![]  (img\Hello\Snipaste_20 25-02-17_11-56-33.png)</p><p> ç¬¬ä¸€ç§ï¼šâœ¨<br> äº‹ä»¶å“åº”è€…å’Œäº‹ä»¶æ‹¥æœ‰è€…æ˜¯å®Œå…¨åˆ†å¼€çš„<br> ç”±äº‹ä»¶å¤„ç†å™¨è®¢é˜…äº‹ä»¶<br> <img src="/img%5CHello%5CSnipaste_2025-02-17_12-49-52.png"></p><p> <img src="/img%5CHello%5CSnipaste_2025-02-17_12-47-14.png"></p><p> ç¬¬äºŒç§ï¼šâœ¨âœ¨</p><p> äº‹ä»¶çš„æ‹¥æœ‰è€…åŒæ—¶ä¹Ÿæ˜¯äº‹ä»¶çš„å“åº”è€…<br> <img src="/img%5CHello%5CSnipaste_2025-02-17_12-59-06.png"></p><p> <img src="/img%5CHello%5CSnipaste_2025-02-17_13-16-43.png"></p><p> ç¬¬ä¸‰ç§ï¼šâœ¨âœ¨âœ¨</p><p> <img src="/img%5CHello%5CSnipaste_2025-02-17_13-19-28.png"></p><p> <img src="/img%5CHello%5CSnipaste_2025-02-17_13-37-12.png"></p>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Visual Studio 2022 </tag>
            
            <tag> charpç¼–ç¨‹åŸºç¡€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C#&#92;WPFåˆ†å¸ƒç±»å’Œæ–¹æ³•</title>
      <link href="/2025/02/02/csharp%E5%88%86%E5%B8%83%E7%B1%BB%E5%92%8C%E6%96%B9%E6%B3%95/"/>
      <url>/2025/02/02/csharp%E5%88%86%E5%B8%83%E7%B1%BB%E5%92%8C%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h1 id="åˆ†å¸ƒç±»å’Œæ–¹æ³•"><a href="#åˆ†å¸ƒç±»å’Œæ–¹æ³•" class="headerlink" title="åˆ†å¸ƒç±»å’Œæ–¹æ³•"></a>åˆ†å¸ƒç±»å’Œæ–¹æ³•</h1><h2 id="åˆ†éƒ¨ç±»ï¼ˆPartial-Classï¼‰"><a href="#åˆ†éƒ¨ç±»ï¼ˆPartial-Classï¼‰" class="headerlink" title="åˆ†éƒ¨ç±»ï¼ˆPartial Classï¼‰"></a>åˆ†éƒ¨ç±»ï¼ˆPartial Classï¼‰</h2><p><b>å®šä¹‰ï¼š</b></p><blockquote><p>åˆ†éƒ¨ç±»æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œç”¨äºå°†ä¸€ä¸ªå¤§å‹çš„ã€å¤æ‚çš„ç±»æ‹†åˆ†æˆå¤šä¸ªè¾ƒå°çš„éƒ¨åˆ†ã€‚è¿™äº›éƒ¨åˆ†å¯ä»¥æ˜¯åŠŸèƒ½æ¨¡å—ã€æ•°æ®é€»è¾‘æˆ–è¡Œä¸ºé›†ç­‰ã€‚</p></blockquote><p><b>ç‰¹ç‚¹ï¼š</b></p><li>ä»£ç å¯è¯»æ€§ï¼šé€šè¿‡å°†å¤§ç±»åˆ†å‰²æˆå°ç±»ï¼Œä»£ç æ›´åŠ ç®€æ´æ˜“æ‡‚ã€‚</li><li>å¤ç”¨æ€§ï¼šä¸åŒåˆ†éƒ¨ç±»å¯ä»¥è¢«å…¶ä»–åœ°æ–¹ä½¿ç”¨ï¼Œæé«˜ä»£ç çš„å¤ç”¨æ€§ã€‚</li><li>æ‰©å±•æ€§ï¼šå¦‚æœéœ€è¦æ–°å¢åŠŸèƒ½æˆ–ä¿®æ”¹ç°æœ‰é€»è¾‘ï¼Œåªéœ€åœ¨ç›¸åº”çš„åˆ†éƒ¨ç±»ä¸­è¿›è¡Œæ”¹åŠ¨ã€‚</li><p><b>ç¤ºä¾‹ï¼š</b></p><p>å‡è®¾æœ‰ä¸€ä¸ª Person ç±»ï¼Œè¡¨ç¤ºä¸€ä¸ªäººçš„å±æ€§å’Œè¡Œä¸ºã€‚å°†å…¶åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªåˆ†éƒ¨ç±»ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Person</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span> name;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">partial</span> PartialName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">partial</span> PartialAge &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SetValue</span>(<span class="params"><span class="built_in">string</span> newName, <span class="built_in">int</span> newAge</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        name = newName;</span><br><span class="line">        age = newAge;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><b>è¿™é‡Œï¼ŒPartialName å’Œ PartialAge æ˜¯åˆ†éƒ¨ç±»ï¼Œåˆ†åˆ«å¯¹åº” name å’Œ age å±æ€§ã€‚</b></p><h2 id="WPF-ä¸­çš„åˆ†éƒ¨ç±»"><a href="#WPF-ä¸­çš„åˆ†éƒ¨ç±»" class="headerlink" title="WPF ä¸­çš„åˆ†éƒ¨ç±»"></a>WPF ä¸­çš„åˆ†éƒ¨ç±»</h2><p>åœ¨ WPF ä¸­ï¼Œåˆ†éƒ¨ç±»çš„æ¦‚å¿µä¸ç›´æ¥å­˜åœ¨ã€‚ä½†å¯ä»¥é€šè¿‡è‡ªå®šä¹‰æ§ä»¶æˆ–é€»è¾‘æ¥å®ç°ç±»ä¼¼çš„åŠŸèƒ½ã€‚ä¾‹å¦‚ï¼š</p><p>å°†ä¸€ä¸ªå¤æ‚çš„åŠ¨ç”»é€»è¾‘æ‹†åˆ†ä¸ºå¤šä¸ªåˆ†éƒ¨ç±»ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">AnimationPart1</span> : <span class="title">IAnimationSegment</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> StartTime &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> EndTime &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">float</span> <span class="title">ValueAt</span>(<span class="params"><span class="built_in">double</span> time</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (time &lt; StartTime) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (time &gt; EndTime) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="comment">// å…¶ä»–é€»è¾‘</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="C-ä¸­çš„åˆ†éƒ¨ç±»"><a href="#C-ä¸­çš„åˆ†éƒ¨ç±»" class="headerlink" title="C# ä¸­çš„åˆ†éƒ¨ç±»"></a>C# ä¸­çš„åˆ†éƒ¨ç±»</h2><p><b>åœ¨ C# ä¸­ï¼Œåˆ†éƒ¨ç±»æ˜¯å®Œå…¨æ”¯æŒçš„è®¾è®¡æ¨¡å¼ã€‚é€šè¿‡å°†ä¸€ä¸ªå¤§çš„ç±»æ‹†åˆ†æˆå¤šä¸ªå°çš„ç±»ï¼Œå¯ä»¥æé«˜ä»£ç çš„ç»„ç»‡æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ†éƒ¨ç±» 1ï¼šPersonName</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">partial</span> <span class="keyword">class</span> <span class="title">PartialName</span> : <span class="title">INameSegment</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">double</span> <span class="title">ValueAt</span>(<span class="params"><span class="built_in">double</span> time</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å®ç°ç‰¹å®šçš„è¡Œä¸ºæˆ–å±æ€§</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ†éƒ¨ç±» 2ï¼šPersonAge</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">partial</span> <span class="keyword">class</span> <span class="title">PartialAge</span> : <span class="title">IAgeSegment</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">double</span> <span class="title">ValueAt</span>(<span class="params"><span class="built_in">double</span> time</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å®ç°ç‰¹å®šçš„è¡Œä¸ºæˆ–å±æ€§</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h2><p><b>å®šä¹‰ï¼š</b></p><blockquote><p>æ–¹æ³•æ˜¯ç¨‹åºè®¾è®¡ä¸­çš„ä¸€ç§åŸºæœ¬ç»“æ„ï¼Œç”¨äºå°†ä¸€ç»„é€»è¾‘æ“ä½œæŠ½è±¡ä¸ºä¸€ä¸ªåç§°ï¼Œå¯ä»¥è¢«å…¶ä»–ä»£ç è°ƒç”¨ã€‚</p></blockquote><p><b>ç‰¹ç‚¹ï¼š</b></p><li>ä»£ç å¤ç”¨æ€§ï¼šå°†é‡å¤çš„é€»è¾‘æå–ä¸ºæ–¹æ³•ã€‚</li><li>å¯è¯»æ€§ï¼šé€šè¿‡å‘½åå’Œæ³¨é‡Šæé«˜ä»£ç çš„å¯è¯»æ€§ã€‚</li><li>å‚æ•°ä¼ é€’ï¼šæ”¯æŒä¼ å…¥é›¶ä¸ªæˆ–å¤šä¸ªå‚æ•°ï¼Œå¹¶è¿”å›ç»“æœã€‚</li><p><b>ç¤ºä¾‹ï¼š</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">drawCircle</span>(<span class="params"><span class="built_in">int</span> radius</span>) <span class="comment">// ä½¿ç”¨æ–¹æ³•ç»˜åˆ¶åœ†</span></span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ç»˜åˆ¶åœ†çš„é€»è¾‘</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">drawRectangle</span>(<span class="params"><span class="built_in">int</span> width, <span class="built_in">int</span> height</span>) <span class="comment">// ä½¿ç”¨æ–¹æ³•ç»˜åˆ¶çŸ©å½¢</span></span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ç»˜åˆ¶çŸ©å½¢çš„é€»è¾‘</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="WPF-ä¸­çš„æ–¹æ³•"><a href="#WPF-ä¸­çš„æ–¹æ³•" class="headerlink" title="WPF ä¸­çš„æ–¹æ³•"></a>WPF ä¸­çš„æ–¹æ³•</h2><p>åœ¨ WPF ä¸­ï¼Œæ–¹æ³•ä¹Ÿæ˜¯å¸¸ç”¨çš„ç¼–ç¨‹å·¥å…·ã€‚ä¾‹å¦‚ï¼š</p><p>é€šè¿‡ç¼–å†™è‡ªå®šä¹‰åŠ¨ç”»æˆ–é€»è¾‘ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">PartialKey</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">StartValue</span>&gt;</span>0<span class="tag">&lt;/<span class="name">StartValue</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">EndValue</span>&gt;</span>1<span class="tag">&lt;/<span class="name">EndValue</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TimeSpan</span>&gt;</span>0,1<span class="tag">&lt;/<span class="name">TimeSpan</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">InterpolationModeLinear</span>&gt;</span><span class="tag">&lt;/<span class="name">InterpolationModeLinear</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">PartialKey</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="C-ä¸­çš„æ–¹æ³•"><a href="#C-ä¸­çš„æ–¹æ³•" class="headerlink" title="C# ä¸­çš„æ–¹æ³•"></a>C# ä¸­çš„æ–¹æ³•</h2><p>åœ¨ C# ä¸­ï¼Œæ–¹æ³•æ˜¯å®ç°åŠŸèƒ½çš„æ ¸å¿ƒã€‚ä¾‹å¦‚ï¼š</p><p>ä½¿ç”¨é‡è½½ï¼ˆOverloadingï¼‰æ¥æ”¯æŒä¸åŒçš„å‚æ•°ç»„åˆã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">DrawCircle</span>(<span class="params"><span class="built_in">int</span> radius</span>) <span class="comment">// å•å‚ç‰ˆæœ¬</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// é€»è¾‘</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">DrawEllipse</span>(<span class="params"><span class="built_in">int</span> width, <span class="built_in">int</span> height</span>) <span class="comment">// åŒå‚ç‰ˆæœ¬</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// é€»è¾‘</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åˆ†éƒ¨ç±»å’Œæ–¹æ³•çš„å…³ç³»"><a href="#åˆ†éƒ¨ç±»å’Œæ–¹æ³•çš„å…³ç³»" class="headerlink" title="åˆ†éƒ¨ç±»å’Œæ–¹æ³•çš„å…³ç³»"></a>åˆ†éƒ¨ç±»å’Œæ–¹æ³•çš„å…³ç³»</h2><table>    <tr>        <th>æ¯”è¾ƒé¡¹ç›®</th>        <th>åˆ†éƒ¨ç±»</th>        <th>æ–¹æ³•</th>    </tr>    <tr>        <td>åŠŸèƒ½</td>        <td>æ‹†åˆ†å¤§å‹ç±»çš„åŠŸèƒ½</td>        <td>å®ç°å•ä¸ªé€»è¾‘åŠŸèƒ½</td>    </tr>    <tr>        <td>åº”ç”¨åœºæ™¯</td>        <td>ç±»å‹åŒ–é—®é¢˜ï¼ˆå±æ€§ã€è¡Œä¸ºç­‰ï¼‰</td>        <td>ç»„åˆå¼é—®é¢˜ï¼ˆé€»è¾‘æ­¥éª¤ï¼‰</td>    </tr>    <tr>        <td>çµæ´»æ€§</td>        <td>æœ‰ï¼Œå¯ä»¥æ ¹æ®éœ€è¦è®¾è®¡</td>        <td>æœ‰ï¼Œå¯ä»¥é€šè¿‡é‡è½½å®ç°å¤šç§é€»è¾‘</td>    </tr>    <tr>        <td>å¤ç”¨æ€§</td>        <td>é«˜ï¼Œå…¶ä»–åœ°æ–¹å¯ä»¥ä½¿ç”¨</td>        <td>é«˜ï¼Œæ–¹æ³•å‚æ•°å¯ä¼ é€’ä¿¡æ¯</td>    </tr>    </table>        <h2 id="WPF-å’Œ-C-ä¸­çš„åˆ†éƒ¨ç±»å’Œæ–¹æ³•çš„åŒºåˆ«"><a href="#WPF-å’Œ-C-ä¸­çš„åˆ†éƒ¨ç±»å’Œæ–¹æ³•çš„åŒºåˆ«" class="headerlink" title="WPF å’Œ C# ä¸­çš„åˆ†éƒ¨ç±»å’Œæ–¹æ³•çš„åŒºåˆ«"></a>WPF å’Œ C# ä¸­çš„åˆ†éƒ¨ç±»å’Œæ–¹æ³•çš„åŒºåˆ«</h2><li>WPF æ˜¯åŸºäºXAMLå’ŒXMLé…ç½®çš„è¯­è¨€ï¼Œä¸»è¦ä¾èµ–äºè‡ªå®šä¹‰å±æ€§ï¼ˆ&lt;PartialKey&gt;ï¼‰å’ŒåŠ¨ç”»åˆ†æ®µï¼ˆ&lt;key&gt;, &lt;keyPosition&gt;ï¼‰ç­‰ç‰¹æ€§æ¥å®ç°å¤æ‚çš„åŠ¨ç”»æ•ˆæœã€‚</li>åˆ†éƒ¨ç±»åœ¨WPF ä¸­å¹¶ä¸ç›´æ¥å­˜åœ¨ï¼Œè€Œæ˜¯é€šè¿‡è‡ªå®šä¹‰å±æ€§æˆ–é€»è¾‘æ¥å®ç°éƒ¨åˆ†åŠŸèƒ½ã€‚<li>C# æ˜¯ä¸€ç§é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œæ”¯æŒä¼ ç»Ÿçš„åˆ†éƒ¨ç±»è®¾è®¡æ¨¡å¼å’Œæ–¹æ³•å¼€å‘ã€‚åœ¨C# ä¸­ï¼Œåˆ†éƒ¨ç±»å’Œæ–¹æ³•æ˜¯æ ‡å‡†çš„ç¼–ç¨‹å·¥å…·ï¼Œé€‚ç”¨äºå¤šç§åœºæ™¯ã€‚</li>    <h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><li>åˆ†éƒ¨ç±» å’Œ æ–¹æ³• éƒ½æ˜¯ä¸€ç§å°†å¤§å‹æˆ–å¤æ‚çš„é€»è¾‘æ‹†åˆ†æˆæ›´å°ã€æ›´æ˜“ç®¡ç†çš„æ–¹å¼ã€‚</li><li>åˆ†éƒ¨ç±»é€‚åˆåœ¨ C# ç­‰é¢å‘å¯¹è±¡çš„è¯­è¨€ä¸­ä½¿ç”¨ï¼Œè€Œ WPF åˆ™ä¾èµ–äº XML å’Œè‡ªå®šä¹‰å±æ€§æ¥å®ç°ç±»ä¼¼çš„åŠŸèƒ½ã€‚</li><li>åœ¨WPF ä¸­ï¼Œéƒ¨åˆ†åŠŸèƒ½å¯ä»¥é€šè¿‡ PartialKey æˆ–åŠ¨ç”»åˆ†æ®µï¼ˆå¦‚ keyPositionï¼‰æ¥å®ç°ï¼›è€Œåœ¨C# ä¸­ï¼Œåˆ™å¯ä»¥åˆ©ç”¨åˆ†éƒ¨ç±»å’Œæ–¹æ³•æ¥å®ç°æ›´å¤æ‚çš„é€»è¾‘ã€‚</li>]]></content>
      
      
      <categories>
          
          <category> WPF </category>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Visual Studio 2022 </tag>
            
            <tag> WPF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WPFè¡¨ç¤ºæ¨¡å¼ä¸æ¡†æ¶æ¨¡å¼ | MVC&#92;MVVM</title>
      <link href="/2025/02/01/WPF/%E8%A1%A8%E7%A4%BA%E6%A8%A1%E5%BC%8F%E4%B8%8E%E6%A1%86%E6%9E%B6%E6%A8%A1%E5%BC%8F/"/>
      <url>/2025/02/01/WPF/%E8%A1%A8%E7%A4%BA%E6%A8%A1%E5%BC%8F%E4%B8%8E%E6%A1%86%E6%9E%B6%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="è¡¨è±¡æ¨¡å¼-æ„æ¶æ¨¡å¼-è®¾è®¡æ¨¡å¼"><a href="#è¡¨è±¡æ¨¡å¼-æ„æ¶æ¨¡å¼-è®¾è®¡æ¨¡å¼" class="headerlink" title="è¡¨è±¡æ¨¡å¼ | æ„æ¶æ¨¡å¼ | è®¾è®¡æ¨¡å¼"></a>è¡¨è±¡æ¨¡å¼ | æ„æ¶æ¨¡å¼ | è®¾è®¡æ¨¡å¼</h1><h2 id="è¡¨è±¡æ¨¡å¼ï¼ˆPresentation-Modeï¼‰"><a href="#è¡¨è±¡æ¨¡å¼ï¼ˆPresentation-Modeï¼‰" class="headerlink" title="è¡¨è±¡æ¨¡å¼ï¼ˆPresentation Modeï¼‰"></a>è¡¨è±¡æ¨¡å¼ï¼ˆPresentation Modeï¼‰</h2><p><b>å®šä¹‰ï¼š</b><br>è¡¨ç°æ¨¡å¼çš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†æ•°æ®çš„å±•ç¤ºé€»è¾‘ä¸ä¸šåŠ¡é€»è¾‘åˆ†ç¦»ï¼Œé€šè¿‡ç‹¬ç«‹çš„â€œè¡¨ç°å±‚â€æ¥ç»Ÿä¸€æ˜¾ç¤ºä¸šåŠ¡å¯¹è±¡çš„ä¿¡æ¯ã€‚</p><p><b>ç›®æ ‡ï¼š</b></p><p>å°†å¯¹æ•°æ®çš„å¤„ç†å’Œæ˜¾ç¤ºé€»è¾‘ç‹¬ç«‹å‡ºæ¥ã€‚<br>æé«˜ä»£ç çš„å¤ç”¨æ€§ã€‚<br>æ˜¾ç°æ•°æ®çš„ä¸€è‡´æ€§å’Œå®Œæ•´æ€§ã€‚</p><p><b>ä¸»è¦ç‰¹ç‚¹ï¼š</b></p><p>æ•°æ®ä¸­ç«‹ï¼šè¡¨ç°æ¨¡å¼ä¸å…³å¿ƒæ•°æ®å¦‚ä½•å­˜å‚¨æˆ–ä¼ è¾“ï¼Œåªè´Ÿè´£å°†æ•°æ®ä»¥ç”¨æˆ·å‹å¥½çš„æ–¹å¼å±•ç¤ºã€‚<br>äº‹åŠ¡éš”ç¦»ï¼šä¸šåŠ¡é€»è¾‘ä¸æ˜¾ç¤ºé€»è¾‘åˆ†ç¦»ï¼Œé¿å…äº‹åŠ¡å¤„ç†å¯¹æ˜¾ç¤ºé€»è¾‘çš„å¹²æ‰°ã€‚<br>å¢å¼ºå¯è¯»æ€§ï¼šé€šè¿‡ç»Ÿä¸€çš„æ•°æ®æ ¼å¼å’Œå¸ƒå±€ï¼Œæé«˜ä»£ç çš„å¯è¯»æ€§å’Œç»´æŠ¤æ€§ã€‚</p><p><b>ç¤ºä¾‹ï¼š</b></p><p>å‡è®¾æœ‰ä¸€ä¸ªè®¢å•åˆ—è¡¨é¡µé¢ï¼Œè¡¨ç°æ¨¡å¼ä¼šè´Ÿè´£å¦‚ä½•æ˜¾ç¤ºè®¢å•ä¿¡æ¯ã€‚å®ƒå¯èƒ½åŒ…æ‹¬ä»¥ä¸‹æ“ä½œï¼š<br>æ˜¾ç¤ºè®¢å•çš„åŸºæœ¬ä¿¡æ¯ï¼ˆå¦‚ç¼–å·ã€å®¢æˆ·åç§°ã€é‡‘é¢ï¼‰ã€‚<br>æ ¼å¼åŒ–è®¢å•æ—¥æœŸä¸ºâ€œå¹´&#x2F;æœˆ&#x2F;æ—¥â€æ ¼å¼ã€‚<br>æ˜¾ç¤ºè®¢å•çš„å›¾ç‰‡ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ã€‚</p><h2 id="æ„æ¶æ¨¡å¼ï¼ˆFramework-Patternï¼‰"><a href="#æ„æ¶æ¨¡å¼ï¼ˆFramework-Patternï¼‰" class="headerlink" title="æ„æ¶æ¨¡å¼ï¼ˆFramework Patternï¼‰"></a>æ„æ¶æ¨¡å¼ï¼ˆFramework Patternï¼‰</h2><p><b>å®šä¹‰ï¼š</b><br>æ„æ¶æ¨¡å¼æ˜¯ä¸€ç§é€šç”¨çš„è®¾è®¡æ¨¡å¼ï¼Œç”¨äºå°†ç³»ç»Ÿçš„ç»„ä»¶åˆ†è§£ä¸ºç‹¬ç«‹çš„éƒ¨åˆ†ï¼Œå¹¶é€šè¿‡è¿™äº›éƒ¨åˆ†æ¥å®ç°ç³»ç»Ÿçš„åŠŸèƒ½ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯æ¨¡å—åŒ–å¼€å‘ï¼Œæ¯ä¸ªæ¨¡å—è´Ÿè´£ç‰¹å®šçš„åŠŸèƒ½ã€‚</p><p><b>ç›®æ ‡ï¼š</b></p><p>æé«˜ç³»ç»Ÿçš„å¯æ‰©å±•æ€§ã€‚<br>æ˜¾ç°ç³»ç»Ÿçš„å„ä¸ªåŠŸèƒ½éƒ¨åˆ†ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚<br>ä¾¿äºæµ‹è¯•å’Œç»´æŠ¤ã€‚</p><p><b>ç‰¹ç‚¹ï¼š</b></p><p>æ¨¡å—åŒ–è®¾è®¡ï¼šå°†ç³»ç»Ÿåˆ’åˆ†ä¸ºç‹¬ç«‹çš„åŠŸèƒ½æ¨¡å—ï¼Œæ¯ä¸ªæ¨¡å—è´Ÿè´£ç‰¹å®šçš„åŠŸèƒ½ã€‚<br>ç»„ä»¶åŒ–å¼€å‘ï¼šå„ä¸ªæ¨¡å—å¯ä»¥çµæ´»åœ°ç»„åˆå’Œé…ç½®ï¼Œä»¥é€‚åº”ä¸åŒçš„éœ€æ±‚ã€‚<br>æ¸…æ™°çš„æ¥å£å®šä¹‰ï¼šé€šè¿‡æ˜ç¡®çš„æ¥å£å®šä¹‰æ¨¡å—ä¹‹é—´çš„äº¤äº’æ–¹å¼ï¼Œæé«˜ç³»ç»Ÿçš„å¯æ‰©å±•æ€§å’Œç»´æŠ¤æ€§ã€‚</p><p><b>ç¤ºä¾‹ï¼š</b></p><p>åœ¨æ„å»ºä¸€ä¸ªå¤æ‚çš„è®¢å•ç®¡ç†ç³»ç»Ÿæ—¶ï¼Œæ„æ¶æ¨¡å¼å¯èƒ½ä¼šå°†ç³»ç»Ÿåˆ†è§£ä¸ºä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š</p><p>è®¢å•ç®¡ç†æ¨¡å—ï¼šè´Ÿè´£å¤„ç†è®¢å•çš„å¢åˆ æ”¹æŸ¥æ“ä½œã€‚<br>å®¢æˆ·ç®¡ç†æ¨¡å—ï¼šè´Ÿè´£ç®¡ç†å®¢æˆ·çš„ registration å’Œä¿¡æ¯æ›´æ–°ã€‚<br>æ”¯ä»˜ gateway æ¨¡å—ï¼šè´Ÿè´£å¤„ç†è®¢å•çš„æ”¯ä»˜æµç¨‹ã€‚<br>ç»Ÿè®¡ä¸æŠ¥å‘Šæ¨¡å—ï¼šè´Ÿè´£ç”Ÿæˆé”€å”®ç»Ÿè®¡æŠ¥è¡¨ã€‚</p><h2 id="è®¾è®¡æ¨¡å¼ï¼ˆDesign-Patternï¼‰"><a href="#è®¾è®¡æ¨¡å¼ï¼ˆDesign-Patternï¼‰" class="headerlink" title="è®¾è®¡æ¨¡å¼ï¼ˆDesign Patternï¼‰"></a>è®¾è®¡æ¨¡å¼ï¼ˆDesign Patternï¼‰</h2><p><b>å®šä¹‰ï¼š</b><br>è®¾è®¡æ¨¡å¼æ˜¯ä¸€ä¸ªæŠ½è±¡çš„æ¦‚å¿µï¼ŒæŒ‡ä¸€ç»„ä¸ºäº†è§£å†³æŸä¸€ç±»é—®é¢˜çš„å¸¸ç”¨ç»“æ„ã€‚å®ƒæ˜¯è½¯ä»¶å·¥ç¨‹ä¸­çš„ä¸€ä¸ªé‡è¦æ¦‚å¿µï¼Œå¹¿æ³›åº”ç”¨äºé¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ã€‚</p><p><b>ç‰¹ç‚¹ï¼š</b></p><p>æ ‡å‡†åŒ–çš„å‘½åå’Œè¡¨è¾¾ï¼šæ¯ä¸ªæ¨¡å¼éƒ½æœ‰ä¸€ä¸ªæ ‡å‡†åç§°å’ŒæŠ½è±¡çš„è¡Œä¸ºæè¿°ã€‚<br>è§£å†³å¸¸è§é—®é¢˜ï¼šè®¾è®¡æ¨¡å¼é€šå¸¸ç”¨äºè§£å†³ç‰¹å®šç±»å‹çš„é—®é¢˜ï¼ˆå¦‚åˆ›å»ºå¯¹è±¡ã€å¯¹è±¡è·å–ã€äº‹åŠ¡éš”ç¦»ç­‰ï¼‰ã€‚<br>å¯æ‰©å±•æ€§ï¼šåœ¨éµå¾ªæ¨¡å¼çš„å‰æä¸‹ï¼Œç³»ç»Ÿå¯ä»¥çµæ´»åœ°æ·»åŠ åŠŸèƒ½ã€‚</p><p><b>å¸¸è§çš„è®¾è®¡æ¨¡å¼ï¼š</b></p><p>å·¥å‚æ¨¡å¼ï¼ˆFactory Patternï¼‰<br>æ„é€ æ¨¡å¼ï¼ˆConstructor Patternï¼‰<br>è¡¨ç°æ¨¡å¼ï¼ˆPresentation Modeï¼‰<br>è¡Œä¸ºæ¨¡å¼ï¼ˆBehavioral Patternï¼‰<br>ç­–ç•¥æ¨¡å¼ï¼ˆStrategy Patternï¼‰<br>æ¨¡æ¿æ¨¡å¼ï¼ˆTemplate Patternï¼‰<br>é€‚é…å™¨æ¨¡å¼ï¼ˆAdapter Patternï¼‰</p><p><b>è¡¨ç°æ¨¡å¼ä¸æ„æ¶æ¨¡å¼çš„åŒºåˆ«</b></p><table>    <tr>        <th>ç‰¹æ€§</th>        <th>è¡¨ç°æ¨¡å¼</th>        <th>æ„æ¶æ¨¡å¼</th>    </tr>    <tr>        <td>åŠŸèƒ½åˆ†ç¦»</td>        <td>æ•°æ®å±•ç¤ºä¸ä¸šåŠ¡é€»è¾‘åˆ†ç¦»</td>        <td>ç³»ç»ŸåŠŸèƒ½æ¨¡å—åŒ–ï¼Œç‹¬ç«‹å¼€å‘</td>    </tr>    <tr>        <td>ç›®æ ‡</td>        <td>æé«˜ä»£ç å¤ç”¨æ€§å’Œæ•°æ®ä¸€è‡´æ€§</td>        <td>æé«˜ç³»ç»Ÿçš„å¯æ‰©å±•æ€§ã€æµ‹è¯•æ€§å’Œç»´æŠ¤æ€§</td>    </tr>    <tr>        <td>ä¾èµ–å…³ç³»</td>        <td>å¼ºè°ƒäº‹åŠ¡éš”ç¦»å’Œæ•°æ®çš„ä¸€è‡´æ€§</td>        <td>é€šè¿‡æ˜ç¡®çš„æ¥å£å®šä¹‰åŠŸèƒ½æ¨¡å—ä¹‹é—´çš„å…³ç³»</td>    </tr>    <tr>        <td>å®ç°æ–¹å¼</td>        <td>ä½¿ç”¨â€œè¡¨ç°å±‚â€æˆ–â€œæ•°æ®ç»‘å®šå±‚â€æ¥ç®¡ç†æ˜¾ç¤ºé€»è¾‘</td>        <td>é€šè¿‡åˆ›å»ºåŠŸèƒ½æ¨¡å—ï¼Œå°†ç³»ç»Ÿåˆ†è§£ä¸ºç‹¬ç«‹çš„éƒ¨åˆ†</td>    </tr>    </table><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¡¨ç°æ¨¡å¼ä¸»è¦ç”¨äºåˆ†ç¦»æ•°æ®å±•ç¤ºå’Œä¸šåŠ¡é€»è¾‘ï¼Œæé«˜ä»£ç çš„å¤ç”¨æ€§å’Œå¯è¯»æ€§ã€‚<br>æ„æ¶æ¨¡å¼åˆ™ç”¨äºç³»ç»Ÿæ¨¡å—åŒ–è®¾è®¡ï¼Œæ¯ä¸ªæ¨¡å—è´Ÿè´£ç‰¹å®šçš„åŠŸèƒ½ã€‚<br>è®¾è®¡æ¨¡å¼æ˜¯è½¯ä»¶å·¥ç¨‹ä¸­çš„ä¸€ä¸ªæŠ½è±¡æ¦‚å¿µï¼Œå¹¿æ³›åº”ç”¨äºè§£å†³å¸¸è§é—®é¢˜ã€‚</p><p><b>åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œé€šå¸¸ä¼šç»“åˆä½¿ç”¨è¿™äº›æ¨¡å¼ï¼Œä¾‹å¦‚ï¼š</b></p><p>ä½¿ç”¨æ„æ¶æ¨¡å¼æ¥å®ç°ç³»ç»Ÿçš„æ¨¡å—åŒ–è®¾è®¡ã€‚<br>åœ¨æŸä¸ªæ¨¡å—ä¸­ä½¿ç”¨è¡¨ç°æ¨¡å¼æ¥åˆ†ç¦»æ˜¾ç¤ºé€»è¾‘å’Œä¸šåŠ¡é€»è¾‘ã€‚<br>ä½¿ç”¨è®¾è®¡æ¨¡å¼ï¼ˆå¦‚å·¥å‚æ¨¡å¼æˆ–æ„é€ æ¨¡å¼ï¼‰æ¥ç®€åŒ–å¯¹è±¡çš„åˆ›å»ºæˆ–ç®¡ç†ã€‚<br>é€šè¿‡ç»„åˆä½¿ç”¨è¿™äº›æ¨¡å¼ï¼Œå¯ä»¥æé«˜ç³»ç»Ÿçš„å¤ç”¨æ€§ã€å¯ç»´æŠ¤æ€§å’Œæ‰©å±•æ€§ã€‚</p><h1 id="MVCæ¨¡å¼"><a href="#MVCæ¨¡å¼" class="headerlink" title="MVCæ¨¡å¼"></a>MVCæ¨¡å¼</h1><p><b>ä»€ä¹ˆæ˜¯ MVC æ¨¡å¼ï¼Ÿ</b></p><p>MVC æ˜¯ä¸€ç§è½¯ä»¶æ¶æ„è®¾è®¡æ¨¡å¼ï¼Œæœ€åˆç”±IBMåœ¨æ•°æ®åº“åº”ç”¨ä¸­æå‡ºï¼Œåæ¥è¢«æ‰©å±•åˆ°Webå’Œ GUI å¼€å‘é¢†åŸŸã€‚å®ƒå°†ä¸€ä¸ªåº”ç”¨ç¨‹åºåˆ†è§£ä¸ºä¸‰ä¸ªä¸»è¦éƒ¨åˆ†ï¼š</p><li><b>æ¨¡å‹ï¼ˆModelï¼‰</b>ï¼šè´Ÿè´£å¤„ç†æ•°æ®é€»è¾‘ã€ä¸šåŠ¡åŠŸèƒ½ä»¥åŠä¸æ§åˆ¶å™¨ä¹‹é—´çš„é€šä¿¡ã€‚</li><li><b>è§†å›¾ï¼ˆViewï¼‰</b>ï¼šè´Ÿè´£æ˜¾ç¤ºæ•°æ®çš„å‘ˆç°æ–¹å¼ï¼Œé€šå¸¸æ˜¯HTMLé¡µé¢æˆ–ä½¿ç”¨å‰ç«¯æ¡†æ¶æ„å»ºçš„ç»„ä»¶ã€‚</li><li><b>æ§åˆ¶å™¨ï¼ˆControllerï¼‰</b>ï¼šæ¥æ”¶ç”¨æˆ·è¾“å…¥å¹¶ä¼ é€’æ•°æ®åˆ°æ¨¡å‹å’Œè§†å›¾ã€‚</li><h2 id="MVC-åœ¨-GUI-å¼€å‘ä¸­çš„åº”ç”¨"><a href="#MVC-åœ¨-GUI-å¼€å‘ä¸­çš„åº”ç”¨" class="headerlink" title="MVC åœ¨ GUI å¼€å‘ä¸­çš„åº”ç”¨"></a>MVC åœ¨ GUI å¼€å‘ä¸­çš„åº”ç”¨</h2><p>MVC æ¨¡å¼åœ¨ GUI åº”ç”¨å¼€å‘ä¸­éå¸¸æµè¡Œï¼ŒåŸå› å¦‚ä¸‹ï¼š</p><li><b>åˆ†éš”æ•°æ®é€»è¾‘ä¸å‘ˆç°é€»è¾‘</b>ï¼šå°†å¤„ç†æ•°æ®çš„é€»è¾‘ï¼ˆæ¨¡å‹ï¼‰ä¸æ˜¾ç¤ºæ•°æ®çš„éƒ¨åˆ†ï¼ˆè§†å›¾ï¼‰åˆ†å¼€ï¼Œä½¿å¾—ä»£ç æ›´å®¹æ˜“ç»´æŠ¤å’Œå¤ç”¨ã€‚</li><li><b>å“åº”å¼è®¾è®¡</b>ï¼šæ§åˆ¶å™¨å¯ä»¥å®æ—¶æ›´æ–°è§†å›¾ï¼Œç¡®ä¿ç”¨æˆ·ç•Œé¢çš„åŠ¨æ€æ€§ã€‚è¿™åœ¨å‰ç«¯å¼€å‘ä¸­å°¤ä¸ºé‡è¦ï¼Œä¾‹å¦‚å¤„ç†ç”¨æˆ·çš„ç‚¹å‡»äº‹ä»¶ã€è¾“å…¥å­—æ®µæ›´æ”¹ç­‰ã€‚</li><li><b>åˆ†ç¦» concerns</b>ï¼šæ¯ä¸ªéƒ¨åˆ†æœ‰æ˜ç¡®çš„è´£ä»»ï¼Œæ¨¡å‹è´Ÿè´£ä¸šåŠ¡é€»è¾‘ï¼Œè§†å›¾è´Ÿè´£æ•°æ®å±•ç¤ºï¼Œæ§åˆ¶å™¨è´Ÿè´£ç”¨æˆ·äº¤äº’ï¼Œè¿™æ ·æ¯ä¸ªéƒ¨åˆ†çš„åŠŸèƒ½æ›´é›†ä¸­ï¼Œæ˜“äºç†è§£å’Œç»´æŠ¤ã€‚</li><h2 id="MVC-æ¨¡å¼çš„ä¼˜ç‚¹"><a href="#MVC-æ¨¡å¼çš„ä¼˜ç‚¹" class="headerlink" title="MVC æ¨¡å¼çš„ä¼˜ç‚¹"></a>MVC æ¨¡å¼çš„ä¼˜ç‚¹</h2><li><b>ä»£ç å¤ç”¨æ€§</b>ï¼šç›¸åŒçš„æ¨¡å‹å¯ä»¥è¢«å¤šä¸ªè§†å›¾ä½¿ç”¨ï¼Œå‡å°‘äº†é‡å¤ä»£ç ã€‚</li><li><b>å¯æ‰©å±•æ€§</b>ï¼šæ–°å¢åŠŸèƒ½æ—¶ï¼Œåªéœ€ä¿®æ”¹æ¨¡å‹æˆ–æ§åˆ¶å™¨ï¼Œä¸å½±å“è§†å›¾ã€‚</li><li><b>æ˜“æµ‹è¯•æ€§</b>ï¼šæ¯ä¸ªéƒ¨åˆ†ç›¸å¯¹ç‹¬ç«‹ï¼Œä¾¿äºå•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•ã€‚</li><li><b>ç”¨æˆ·ä½“éªŒä¸€è‡´</b>ï¼šé€šè¿‡è§†å›¾ç»„ä»¶åŒ–ï¼Œå¯ä»¥ä¸ºç”¨æˆ·æä¾›æ ‡å‡†åŒ–çš„ç•Œé¢å…ƒç´ ã€‚</li><h2 id="MVC-æ¨¡å¼çš„æŒ‘æˆ˜"><a href="#MVC-æ¨¡å¼çš„æŒ‘æˆ˜" class="headerlink" title="MVC æ¨¡å¼çš„æŒ‘æˆ˜"></a>MVC æ¨¡å¼çš„æŒ‘æˆ˜</h2><li><b>å­¦ä¹ æ›²çº¿</b>ï¼šMVC æ¨¡å¼éœ€è¦å¼€å‘è€…ç†è§£ä¸‰ä¸ªåˆ†éš”çš„éƒ¨åˆ†åŠå…¶äº¤äº’æœºåˆ¶ï¼ŒåˆæœŸå¯èƒ½ä¼šæœ‰ä¸€å®šçš„å­¦ä¹ æˆæœ¬ã€‚</li><li><b>å¤æ‚æ€§</b>ï¼šåœ¨å¤§å‹é¡¹ç›®ä¸­ï¼Œå¦‚æœæ¨¡å‹å’Œæ§åˆ¶å™¨è¿‡äºå¤æ‚ï¼Œå¯èƒ½ä¼šå¢åŠ ç»´æŠ¤éš¾åº¦ã€‚</li><li><b>æ€§èƒ½ä¼˜åŒ–</b>ï¼šç”±äºæ•°æ®ä¼ è¾“çš„å¤šçº§åŒ–ï¼ˆæ¨¡å‹-æ§åˆ¶å™¨-è§†å›¾ï¼‰ï¼Œå¯èƒ½ä¼šå½±å“æ€§èƒ½ï¼Œéœ€è¦è¿›è¡Œé€‚å½“çš„ç¼“å­˜ç­–ç•¥è®¾è®¡ã€‚</li><h2 id="MVC-æ¨¡å¼çš„å˜ç§"><a href="#MVC-æ¨¡å¼çš„å˜ç§" class="headerlink" title="MVC æ¨¡å¼çš„å˜ç§"></a>MVC æ¨¡å¼çš„å˜ç§</h2><p>é™¤äº†æ ‡å‡†çš„ MVC æ¨¡å¼ï¼Œè¿˜æœ‰ä¸€äº›å˜ç§è¢«åº”ç”¨åœ¨ç‰¹å®šé¢†åŸŸï¼š</p><li><b>MVIAï¼ˆModel-View-Interface-Aggregatorï¼‰</b>ï¼šå¸¸ç”¨äºå›¾å½¢ç•Œé¢ç¼–ç¨‹è¯­è¨€å¦‚ Smalltalk ä¸­ã€‚å®ƒå°†æ¨¡å‹ã€è§†å›¾ã€æ¥å£å’Œèšåˆå™¨åˆ†å¼€ã€‚</li><li><b>V Model</b>ï¼šä¸€ç§é€‚ç”¨äºå‰ç«¯æ¡†æ¶çš„æ¨¡å¼ï¼Œç±»ä¼¼äº MVCï¼Œå¹¿æ³›åº”ç”¨äºReactç­‰æ¡†æ¶ä¸­ã€‚</li><h2 id="å®é™…åº”ç”¨ç¤ºä¾‹"><a href="#å®é™…åº”ç”¨ç¤ºä¾‹" class="headerlink" title="å®é™…åº”ç”¨ç¤ºä¾‹"></a>å®é™…åº”ç”¨ç¤ºä¾‹</h2><p>åœ¨æ„å»ºä¸€ä¸ªç®€å•çš„ç”µå•†ç½‘ç«™æ—¶ï¼š</p><li><b>æ¨¡å‹ï¼ˆModelï¼‰</b>ï¼šç®¡ç†è®¢å•ä¿¡æ¯ã€å•†å“åº“å­˜ã€ç”¨æˆ·æ•°æ®ç­‰ã€‚</li><li><b>è§†å›¾ï¼ˆViewï¼‰</b>ï¼šå±•ç¤ºå•†å“åˆ—è¡¨é¡µé¢æˆ–è´­ç‰©è½¦å†…å®¹ã€‚</li><li><b>æ§åˆ¶å™¨ï¼ˆControllerï¼‰</b>ï¼šå¤„ç†ç”¨æˆ·çš„æœç´¢è¾“å…¥ã€æ·»åŠ å•†å“ç‚¹å‡»äº‹ä»¶ã€è®¢å•æäº¤ç­‰åŠŸèƒ½ã€‚</li><h2 id="æ€»ç»“-1"><a href="#æ€»ç»“-1" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>MVC æ¨¡å¼åœ¨ GUI å¼€å‘ä¸­ç¡®å®æ˜¯ä¸€ä¸ªæŒ‡å¯¼æ¨¡å¼ï¼Œå¸®åŠ©å¼€å‘è€…å°†æ•°æ®é€»è¾‘ä¸ç”¨æˆ·ç•Œé¢åˆ†ç¦»ï¼Œå®ç°é«˜æ•ˆçš„ä»£ç ç»“æ„å’Œè‰¯å¥½çš„ç”¨æˆ·ä½“éªŒã€‚ç†è§£å¹¶åº”ç”¨ MVC æ¨¡å¼èƒ½å¤Ÿæ˜¾è‘—æé«˜å¼€å‘æ•ˆç‡å’Œä»£ç è´¨é‡ã€‚</p><p>å› æ­¤ï¼ŒMVC æ¨¡å¼æ˜¯å›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ˆGUIï¼‰å¼€å‘ä¸­éå¸¸é‡è¦çš„è®¾è®¡æ¨¡å¼ä¹‹ä¸€ã€‚</p><br><h1 id="MVVM"><a href="#MVVM" class="headerlink" title="MVVM"></a>MVVM</h1><p><b>MVVMï¼ˆModel-View-ViewModelï¼‰æ¨¡å¼</b></p><p>MVVMï¼ˆModel-View-ViewModelï¼‰æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œé€šå¸¸ç”¨äºå‰ç«¯å¼€å‘ï¼Œç‰¹åˆ«æ˜¯åœ¨Vue.jsç­‰æ¡†æ¶ä¸­è¢«å¹¿æ³›ä½¿ç”¨ã€‚å®ƒæ˜¯å¯¹MVCï¼ˆModel-View-Controllerï¼‰æ¨¡å¼çš„ä¸€ç§æ‰©å±•å’Œä¼˜åŒ–ï¼Œä¸»è¦é’ˆå¯¹è§†å›¾å±‚ä¸æ•°æ®ç»‘å®šçš„é—®é¢˜ã€‚</p><h2 id="MVVMçš„æ ¸å¿ƒæ€æƒ³"><a href="#MVVMçš„æ ¸å¿ƒæ€æƒ³" class="headerlink" title="MVVMçš„æ ¸å¿ƒæ€æƒ³"></a>MVVMçš„æ ¸å¿ƒæ€æƒ³</h2><p>åœ¨MVCæ¨¡å¼ä¸­ï¼Œæ¨¡å‹ï¼ˆModelï¼‰ã€è§†å›¾ï¼ˆViewï¼‰å’Œæ§åˆ¶å™¨ï¼ˆControllerï¼‰æ˜¯åˆ†ç¦»çš„ä¸‰è€…å…³ç³»ï¼š</p><li><b>æ¨¡å‹</b>ï¼šè´Ÿè´£å­˜å‚¨å’Œç®¡ç†ä¸šåŠ¡é€»è¾‘ç›¸å…³çš„é™æ€æˆ–åŠ¨æ€æ•°æ®ã€‚</li><li><b>è§†å›¾</b>ï¼šè´Ÿè´£å°†æ¨¡å‹çš„æ•°æ®å‘ˆç°ç»™ç”¨æˆ·ã€‚</li><li><b>æ§åˆ¶å™¨</b>ï¼šè´Ÿè´£å¤„ç†ç”¨æˆ·çš„è¾“å…¥äº‹ä»¶ï¼Œå¹¶æ ¹æ®ä¸šåŠ¡é€»è¾‘æ›´æ–°æ¨¡å‹ã€‚</li>    <p>ç„¶è€Œï¼ŒMVCæ¨¡å¼çš„ä¸€ä¸ªç¼ºç‚¹æ˜¯ï¼Œå½“éœ€è¦å¯¹è§†å›¾è¿›è¡ŒåŠ¨æ€ç»‘å®šæ—¶ï¼Œéœ€è¦é€šè¿‡useEffectç­‰å‡½æ•°æ‰‹åŠ¨æ¸²æŸ“æ›´æ–°åçš„è§†å›¾ï¼Œè¿™ä¼šå¯¼è‡´ä»£ç å†—ä½™ã€éš¾ä»¥ç»´æŠ¤ã€‚</p><p>MVVMæ¨¡å¼è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œå®ƒå°†æ¨¡å‹ä¸è§†å›¾çš„ç»‘å®šå…³ç³»å’Œæ•°æ®çš„åŒå‘é€šä¿¡ç»“åˆèµ·æ¥ï¼Œæä¾›äº†æ›´é«˜æ•ˆçš„æ–¹å¼æ¥ç®¡ç†æ•°æ®å’Œè§†å›¾çš„åŠ¨æ€æ›´æ–°ã€‚</p><h2 id="MVVMçš„ä¸»è¦ç»„ä»¶"><a href="#MVVMçš„ä¸»è¦ç»„ä»¶" class="headerlink" title="MVVMçš„ä¸»è¦ç»„ä»¶"></a>MVVMçš„ä¸»è¦ç»„ä»¶</h2><li><b>æ¨¡å‹ï¼ˆModelï¼‰</b>ï¼š<p>è´Ÿè´£å­˜å‚¨å’Œç®¡ç†ä¸šåŠ¡é€»è¾‘ç›¸å…³çš„é™æ€æˆ–åŠ¨æ€æ•°æ®ã€‚<br>æ¨¡å‹çš„æ•°æ®å¯ä»¥é€šè¿‡å‘½ä»¤ï¼ˆCommandï¼‰çš„æ–¹å¼è¢«æ§åˆ¶å™¨æˆ–å…¶ä»–ç»„ä»¶è®¿é—®å’Œä¿®æ”¹ã€‚</li></p><li><b>å‘½ä»¤ï¼ˆCommandï¼‰</b>ï¼š<p>ç”¨äºå°†æ¨¡å‹ä¸­çš„æ•°æ®ä¼ é€’ç»™è§†å›¾å±‚ï¼Œå¹¶åœ¨è§†å›¾å±‚å®Œæˆæ“ä½œåï¼Œå°†ç»“æœåé¦ˆå›æ¨¡å‹ã€‚</li></p><li><b>ç®¡ç†å™¨ï¼ˆManagerï¼‰</b>ï¼š<p>è´Ÿè´£å¯¹å‘½ä»¤çš„æ‰§è¡Œè¿›è¡Œç›‘æ§ã€‚<br>ç®¡ç†å™¨ç¡®ä¿å‘½ä»¤çš„æ‰§è¡Œé¡ºåºå’Œä¾èµ–å…³ç³»ã€‚</li></p><li><b>é•œåƒå±‚ï¼ˆMirrorï¼‰</b>ï¼š<p>ç®¡ç†å™¨ä¸æ¨¡å‹ä¹‹é—´çš„ä¸€ä¸ªä¸­é—´å±‚ï¼Œè´Ÿè´£å°†æ¨¡å‹çš„æ•°æ®ä¼ é€’ç»™è§†å›¾å±‚ï¼Œå¹¶æ ¹æ®è§†å›¾å±‚çš„åé¦ˆæ›´æ–°æ¨¡å‹ã€‚</li></p><li><b>ç»‘å®šå±‚ï¼ˆBindingï¼‰</b>ï¼š<p>å°†æ•°æ®ä»æ¨¡å‹ä¼ é€’åˆ°è§†å›¾ç»„ä»¶ä¸­çš„ç»„ä»¶å±æ€§ä¸Šã€‚<br>å®ƒå¯ä»¥ç”¨æ¥å®ç°å•ç‚¹ç»‘å®šæˆ–å¤šç‚¹ç»‘å®šï¼Œå¹¶æ”¯æŒåŠ¨æ€é”®å€¼å¯¹ã€‚</li></p><h2 id="MVVMçš„å·¥ä½œæµç¨‹"><a href="#MVVMçš„å·¥ä½œæµç¨‹" class="headerlink" title="MVVMçš„å·¥ä½œæµç¨‹"></a>MVVMçš„å·¥ä½œæµç¨‹</h2><li><b>åˆ›å»ºæ¨¡å‹ã€å‘½ä»¤å’Œç®¡ç†å™¨</b>ï¼š<p>åœ¨ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå¼€å§‹æ—¶ï¼Œåˆå§‹åŒ–æ¨¡å‹ã€å‘½ä»¤å’Œç®¡ç†å™¨å®ä¾‹ã€‚</li></p><li><b>ç»‘å®šè§†å›¾ä¸æ¨¡å‹</b>ï¼š<p>ä½¿ç”¨&lt;mx:Binding&gt;æ ‡ç­¾å°†æ¨¡å‹çš„æ•°æ®ä¼ é€’åˆ°è§†å›¾ç»„ä»¶ä¸­çš„å±æ€§ä¸Šã€‚<br>ç¡®ä¿æ•°æ®åŒå‘ç»‘å®šï¼Œå³å½“è§†å›¾æ›´æ–°æ—¶ï¼Œæ¨¡å‹ä¹Ÿä¼šåŒæ­¥æ›´æ–°ï¼›åä¹‹äº¦ç„¶ã€‚</li></p><li><b>ç»‘å®šå‘½ä»¤ä¸ç®¡ç†å™¨</b>ï¼š<p>ä½¿ç”¨useCommand &#x3D; trueæ ‡è®°çš„å‘½ä»¤å®ä¾‹ç»‘å®šåˆ°ç®¡ç†å™¨ã€‚<br>è¿™äº›å‘½ä»¤ä¼šé€šè¿‡useMirrorä¼ é€åˆ°é•œåƒå±‚ï¼Œå¹¶åœ¨è§†å›¾å±‚å®Œæˆæ“ä½œååé¦ˆå›æ¨¡å‹ã€‚</li></p><li><b>ç»‘å®šè§†å›¾ä¸å‘½ä»¤</b>ï¼š<p>åœ¨è§†å›¾ç»„ä»¶ä¸­ä½¿ç”¨&lt;mx:Command&gt;æ ‡ç­¾ï¼Œå°†æ•°æ®ä¼ é€’ç»™å‘½ä»¤å®ä¾‹ã€‚<br>å‘½ä»¤å®Œæˆåï¼Œä½¿ç”¨ç®¡ç†å™¨æ¥æ›´æ–°æ¨¡å‹ã€‚</li></p><h2 id="MVVMçš„ä¼˜åŠ¿"><a href="#MVVMçš„ä¼˜åŠ¿" class="headerlink" title="MVVMçš„ä¼˜åŠ¿"></a>MVVMçš„ä¼˜åŠ¿</h2><li><b>æ•°æ®ä¸€è‡´æ€§</b>ï¼šé€šè¿‡é•œåƒå±‚å’Œç»‘å®šå±‚çš„åŒå‘é€šä¿¡æœºåˆ¶ï¼Œç¡®ä¿æ¨¡å‹ã€è§†å›¾å’Œå‘½ä»¤ä¹‹é—´çš„æ•°æ®ä¸€è‡´æ€§ã€‚</li><li><b>ç»„ä»¶åŒ–å¼€å‘</b>ï¼šæ¯ä¸ªç»„ä»¶ï¼ˆæ¨¡å‹ã€å‘½ä»¤ã€ç®¡ç†å™¨ï¼‰éƒ½æœ‰æ˜ç¡®çš„åŠŸèƒ½è¾¹ç•Œï¼Œä¾¿äºç†è§£å’Œç»´æŠ¤ã€‚</li><li><b>åŠ¨æ€ç»‘å®š</b>ï¼šèƒ½å¤Ÿå®ç°è§†å›¾ä¸æ¨¡å‹çš„åŒå‘æ•°æ®ç»‘å®šï¼Œé¿å…æ‰‹åŠ¨æ¸²æŸ“çš„é—®é¢˜ã€‚</li><h2 id="MVVMä¸MVCçš„åŒºåˆ«"><a href="#MVVMä¸MVCçš„åŒºåˆ«" class="headerlink" title="MVVMä¸MVCçš„åŒºåˆ«"></a>MVVMä¸MVCçš„åŒºåˆ«</h2><li><b>æ•°æ®ç»‘å®š</b>ï¼š<p>MVCæ¨¡å¼éœ€è¦é€šè¿‡useEffectç­‰å‡½æ•°æ‰‹åŠ¨æ¸²æŸ“æ›´æ–°åçš„è§†å›¾ï¼Œå¯¼è‡´ä»£ç å†—ä½™ã€‚<br>MVVMæ¨¡å¼é€šè¿‡é•œåƒå±‚å’Œç»‘å®šå±‚å®ç°è‡ªåŠ¨åŒ–çš„æ•°æ®ç»‘å®šå’ŒåŒå‘é€šä¿¡ã€‚</li></p><li><b>å‘½ä»¤æ‰§è¡Œ</b>ï¼š<p>MVCæ¨¡å¼æ²¡æœ‰å†…ç½®çš„å‘½ä»¤æœºåˆ¶ï¼Œæ— æ³•ç›´æ¥å°†æ¨¡å‹çš„æ•°æ®ä¼ é€’ç»™è§†å›¾æˆ–ç»„ä»¶ã€‚<br>MVVMæ¨¡å¼å¼•å…¥äº†å‘½ä»¤æœºåˆ¶ï¼Œå…è®¸å¼€å‘è€…æ›´çµæ´»åœ°å¤„ç†ä¸šåŠ¡é€»è¾‘ã€‚</li></p><h2 id="MVVMçš„ä½¿ç”¨åœºæ™¯"><a href="#MVVMçš„ä½¿ç”¨åœºæ™¯" class="headerlink" title="MVVMçš„ä½¿ç”¨åœºæ™¯"></a>MVVMçš„ä½¿ç”¨åœºæ™¯</h2><p>MVVMæ¨¡å¼éå¸¸é€‚åˆéœ€è¦å¯¹è§†å›¾å’Œæ•°æ®è¿›è¡Œæ·±åº¦ç»‘å®šçš„åº”ç”¨åœºæ™¯ï¼Œä¾‹å¦‚ï¼š</p><li><b>é«˜çº§è¡¨æ ¼ï¼ˆGridï¼‰</b>ï¼šå®ç°åŠ¨æ€åˆ—æ·»åŠ /åˆ é™¤ã€æ•°æ®æ’åºç­‰æ“ä½œã€‚</li><li><b>ç»„ä»¶åŒ–å¸ƒå±€</b>ï¼šå®ç°å“åº”å¼è®¾è®¡ä¸­çš„è‡ªåŠ¨ç¼©æ”¾æˆ–å¸ƒå±€è°ƒæ•´ã€‚</li><li><b>æ•°æ®å¯è§†åŒ–</b>ï¼šå®ç°åŠ¨æ€å›¾è¡¨çš„æ•°æ®æ›´æ–°ã€‚</li><h2 id="æ€»ç»“-2"><a href="#æ€»ç»“-2" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>MVVMæ¨¡å¼é€šè¿‡å°†æ¨¡å‹ã€å‘½ä»¤å’Œç®¡ç†å™¨ç»“åˆåœ¨ä¸€èµ·ï¼Œå®ç°äº†æ•°æ®çš„åŒå‘ç»‘å®šå’Œé«˜æ•ˆçš„ä¸šåŠ¡é€»è¾‘å¤„ç†ã€‚å®ƒéå¸¸é€‚åˆéœ€è¦æ·±åº¦æ•°æ®ç»‘å®šå’Œå¤æ‚ç»„ä»¶åŒ–å¼€å‘çš„åº”ç”¨åœºæ™¯ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> MVVM </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Visual Studio 2022 </tag>
            
            <tag> MVVM </tag>
            
            <tag> MVC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WPFæ¦‚è¿°ä¸‰å±‚æ¶æ„ã€é«˜å†…èšï¼Œä½è€¦åˆã€æ•°æ®äº¤äº’å®¹å™¨ä¸è½½ä½“ã€‚</title>
      <link href="/2025/02/01/WPF/WPF%E6%A6%82%E8%BF%B0/"/>
      <url>/2025/02/01/WPF/WPF%E6%A6%82%E8%BF%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="WPFæŠ€æœ¯æ¦‚è¿°"><a href="#WPFæŠ€æœ¯æ¦‚è¿°" class="headerlink" title="WPFæŠ€æœ¯æ¦‚è¿°"></a>WPFæŠ€æœ¯æ¦‚è¿°</h1><p><b>WPFå…¨ç§°ä¸ºWindows Presentation Foundation,æ˜¯ä¸€ç§åŸºäºXAMLã€.NETå’Œå‘é‡ç»˜å›¾æŠ€æœ¯çš„è¡¨å±‚å¼€å‘æ¡†æ¶ï¼Œå¹¿æ³›ç”¨äºè½¯ä»¶å›¾å½¢ç•Œé¢çš„å¼€å‘ï¼Œæ˜¯ä¸€ç§<mark>ä¸“é—¨ç”¨æ¥ç¼–å†™ç¨‹åºè¡¨ç¤ºå±‚çš„æŠ€æœ¯å’Œå·¥å…·ã€‚</mark></b></p><h2 id="ä¸‰å±‚æ¶æ„"><a href="#ä¸‰å±‚æ¶æ„" class="headerlink" title="ä¸‰å±‚æ¶æ„"></a>ä¸‰å±‚æ¶æ„</h2><p><b>åœ¨WPFï¼ˆWindows Presentation Foundationï¼‰ä¸­ï¼Œåº”ç”¨ç¨‹åºé€šå¸¸è¢«åˆ’åˆ†ä¸ºä¸‰å±‚æ¶æ„ï¼š<code>UI Layerã€Business Layer å’Œ Network Layer</code>ã€‚æ¯å±‚éƒ½æœ‰å…¶ç‰¹å®šçš„åŠŸèƒ½å’Œä½œç”¨ã€‚</b></p><p><b>UI Layerï¼ˆç”¨æˆ·ç•Œé¢å±‚ï¼‰ï¼š</b></p><blockquote><p>è´Ÿè´£æ˜¾ç¤ºåº”ç”¨ç¨‹åºçš„å›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ˆGUIï¼‰ï¼ŒåŒ…æ‹¬çª—ä½“ã€æ§ä»¶å’Œå¸ƒå±€ã€‚<br>ä½¿ç”¨XAMLå®šä¹‰ç•Œé¢å…ƒç´ å’Œæ ·å¼ï¼Œä½¿ç”¨C#æˆ–VB.NETç¼–å†™ç”¨æˆ·äº¤äº’é€»è¾‘ã€‚<br>å¤„ç†ç”¨æˆ·çš„äº¤äº’æ“ä½œï¼Œå¦‚ç‚¹å‡»æŒ‰é’®ã€è¾“å…¥æ–‡æœ¬ç­‰ã€‚</p></blockquote><p><b>Business Layerï¼ˆä¸šåŠ¡é€»è¾‘å±‚ï¼‰ï¼š</b></p><blockquote><p>è´Ÿè´£åº”ç”¨ç¨‹åºçš„æ ¸å¿ƒåŠŸèƒ½å’Œæ•°æ®ç®¡ç†ï¼Œä¸æ•°æ®åº“äº¤äº’æ‰§è¡ŒæŸ¥è¯¢å’Œæ›´æ–°æ“ä½œã€‚<br>ä½¿ç”¨Entity Frameworkè¿›è¡ŒORMï¼Œæä¾› fluent API æˆ– WLINQå®ç°ä¸šåŠ¡é€»è¾‘ã€‚<br>å¤„ç†äº‹åŠ¡æ§åˆ¶ã€é”™è¯¯å¤„ç†å’ŒçŠ¶æ€ç®¡ç†ï¼Œç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§å’Œå®Œæ•´æ€§ã€‚</p></blockquote><p><b>Network Layerï¼ˆç½‘ç»œå±‚ï¼‰ï¼š</b></p><blockquote><p>è´Ÿè´£æ•°æ®çš„ä¼ è¾“å’Œé€šä¿¡ï¼Œä»å®¢æˆ·ç«¯å‘é€è¯·æ±‚åˆ°æœåŠ¡å™¨æˆ–ä»æœåŠ¡å™¨è¿”å›å“åº”ã€‚<br>ä½¿ç”¨.NET Coreæˆ–å…¶ä»–ç½‘ç»œåº“å¦‚DotNet&#x2F;Transportã€Nettyæˆ–GlassFishå®ç°ç½‘ç»œåŠŸèƒ½ã€‚<br>å¤„ç†HTTPè¯·æ±‚çš„ç”Ÿå‘½å‘¨æœŸï¼ŒåŒ…æ‹¬è§£æã€æ•°æ®ä¼ è¾“ã€å“åº”ç”Ÿæˆå’Œé”™è¯¯å¤„ç†ã€‚</p></blockquote><p><b>é€šè¿‡è¿™ä¸‰å±‚æ¶æ„çš„è®¾è®¡ï¼ŒWPFä½¿å¾—åº”ç”¨ç¨‹åºç»“æ„æ¸…æ™°ã€åŠŸèƒ½åˆ†æ˜ã€‚UI Layerå±•ç¤ºç”¨æˆ·ç•Œé¢ï¼ŒBusiness Layerç®¡ç†æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼ŒNetwork Layerè´Ÿè´£æ•°æ®é€šä¿¡ã€‚å„å±‚ä¹‹é—´ç›¸äº’å…³è”ï¼Œå…±åŒæ”¯æ’‘æ•´ä¸ªåº”ç”¨çš„è¿è¡Œã€‚ç†è§£å’Œå®ç°è¿™ä¸‰å±‚æ¶æ„æ˜¯æŒæ¡WPFå¼€å‘çš„å…³é”®ã€‚</b></p><h2 id="é«˜å†…èšï¼Œä½è€¦åˆ"><a href="#é«˜å†…èšï¼Œä½è€¦åˆ" class="headerlink" title="é«˜å†…èšï¼Œä½è€¦åˆ"></a>é«˜å†…èšï¼Œä½è€¦åˆ</h2><p><b>â€œé«˜å†…èšï¼Œä½è€¦åˆâ€</b>æ˜¯ä¸€ä¸ªè½¯ä»¶è®¾è®¡æ¨¡å¼ä¸­çš„æ ¸å¿ƒæ¦‚å¿µï¼Œå°¤å…¶æ˜¯åœ¨éµå¾ªâ€œå¼€é—­åŸåˆ™â€æ—¶è¢«å¹¿æ³›é‡‡ç”¨ã€‚è¿™ç§è®¾è®¡ç†å¿µå¼ºè°ƒä½¿ç³»ç»Ÿä¸­çš„å„ä¸ªç»„ä»¶æˆ–éƒ¨åˆ†ä¹‹é—´çš„ä¾èµ–å°½å¯èƒ½å°‘ï¼ˆä½è€¦åˆï¼‰ï¼ŒåŒæ—¶åœ¨æ¯ä¸ªç»„ä»¶å†…éƒ¨å®ç°åŠŸèƒ½çš„é›†ä¸­å’Œç‹¬ç«‹ï¼ˆé«˜å†…èšï¼‰ã€‚åœ¨WPFï¼ˆWindows Presentation Foundationï¼‰ä¸­çš„ä¸‰å±‚æ¶æ„ä¸­ï¼Œâ€œé«˜å†…èšï¼Œä½è€¦åˆâ€ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p><p><b>1. é«˜å†…èšï¼ˆHigh Cohesionï¼‰</b></p><blockquote><p>æ¯ä¸€å±‚çš„åŠŸèƒ½æ¨¡å—éƒ½è¢«é«˜åº¦é›†ä¸­ï¼Œå…¶èŒè´£èŒƒå›´æ˜ç¡®ä¸”ç›¸äº’ä¹‹é—´ä¾èµ–è¾ƒå°‘ã€‚å…·ä½“æ¥è¯´ï¼š</p></blockquote><li><b>UI Layer</b>ï¼šè´Ÿè´£æ˜¾ç¤ºå’Œç®¡ç†ç”¨æˆ·ç•Œé¢ï¼ŒåŒ…æ‹¬çª—ä½“ã€æ§ä»¶ã€å¸ƒå±€ç­‰ã€‚å®ƒçš„æ ¸å¿ƒåŠŸèƒ½æ˜¯å±•ç¤ºå›¾å½¢å†…å®¹ï¼Œä¸å…¶ä»–å±‚çš„äº¤äº’ä¸»è¦é€šè¿‡ä¸­é—´å±‚ï¼ˆå¦‚ViewModelï¼‰ã€‚</li><li><b>Business Layer</b>ï¼šè´Ÿè´£åº”ç”¨çš„æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œå¦‚æ•°æ®å¤„ç†ã€äº‹åŠ¡ç®¡ç†ã€ä¸šåŠ¡æµç¨‹ç­‰ã€‚å®ƒä¾èµ–ORMï¼ˆObject-Relational Mappingï¼‰æŠ€æœ¯ä¸æ•°æ®åº“äº¤äº’ï¼Œä½†å¯¹å…¶å®ƒå±‚çš„å…³ç³»æœ‰é™ã€‚</li><li><b>Network Layer</b>ï¼šä¸“æ³¨äºæ•°æ®ä¼ è¾“å’Œé€šä¿¡ï¼Œå¤„ç†HTTPè¯·æ±‚ã€æ•°æ®å‘é€/æ¥æ”¶ã€è®¤è¯ç­‰æ“ä½œã€‚è¿™éƒ¨åˆ†é€šå¸¸ä½¿ç”¨ç°æˆçš„åº“æˆ–æ¡†æ¶æ¥å®ç°ã€‚</li><p><b>ç”±äºæ¯ä¸€å±‚çš„åŠŸèƒ½éƒ½éå¸¸é›†ä¸­ï¼Œå½¼æ­¤ä¹‹é—´çš„ä¾èµ–å…³ç³»å¼±ï¼Œé«˜å†…èšç‰¹æ€§å¾—ä»¥ä½“ç°ã€‚</b></p><br><p><b>2. ä½è€¦åˆï¼ˆLow Couplingï¼‰</b></p><blockquote><p>å„å±‚ä¹‹é—´çš„ä¾èµ–å…³ç³»å°½å¯èƒ½å°‘ï¼Œç›¸äº’ä¹‹é—´å‡ ä¹ç‹¬ç«‹ã€‚å…·ä½“æ¥è¯´ï¼š</p></blockquote><li><b>UI Layer</b>ï¼šä¸Business Layerå’ŒNetwork Layerä¹‹é—´çš„ä¾èµ–ä»…é™äºä¸­é—´å±‚ï¼ˆå¦‚ViewModelæˆ–ViewModelBaseï¼‰ï¼Œè¿™äº›ä¸­é—´å±‚è´Ÿè´£ä¼ é€’æ•°æ®å’Œæ§åˆ¶æµã€‚</li><li><b>Business Layer</b>ï¼šä¸UIå’ŒNetwork Layerä¹‹é—´çš„ä¾èµ–ä¹Ÿä¸»è¦é€šè¿‡ä¸­é—´å±‚å®ç°ï¼Œä¾‹å¦‚é€šè¿‡é›†åˆæˆ–äº‹ä»¶æ¥åŒæ­¥UIçš„å˜åŒ–ã€‚</li><li><b>Network Layer</b>ï¼šé€šå¸¸ä¸å…¶ä»–ä¸¤å±‚çš„äº¤äº’éå¸¸æœ‰é™ï¼Œä¸»è¦å¤„ç†æœ¬å±‚ç‰¹å®šçš„åŠŸèƒ½ã€‚</li><blockquote><p>ä½è€¦åˆç‰¹æ€§ä½¿å¾—æ¯ä¸€å±‚å¯ä»¥ç‹¬ç«‹åœ°è¢«ä¿®æ”¹ã€å‡çº§æˆ–æ›¿æ¢ï¼Œè€Œä¸ä¼šå½±å“åˆ°æ•´ä¸ªç³»ç»Ÿçš„åŠŸèƒ½ã€‚</p></blockquote><br><h2 id="ä¸‰å±‚æ¶æ„åœ¨â€œé«˜å†…èšï¼Œä½è€¦åˆâ€ä¸­çš„ä½“ç°"><a href="#ä¸‰å±‚æ¶æ„åœ¨â€œé«˜å†…èšï¼Œä½è€¦åˆâ€ä¸­çš„ä½“ç°" class="headerlink" title="ä¸‰å±‚æ¶æ„åœ¨â€œé«˜å†…èšï¼Œä½è€¦åˆâ€ä¸­çš„ä½“ç°"></a>ä¸‰å±‚æ¶æ„åœ¨â€œé«˜å†…èšï¼Œä½è€¦åˆâ€ä¸­çš„ä½“ç°</h2><p><b>åœ¨WPFçš„ä¸‰å±‚æ¶æ„ä¸­ï¼Œâ€œé«˜å†…èšï¼Œä½è€¦åˆâ€çš„ç‰¹ç‚¹å…·ä½“ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</b></p><ol><b>UI Layerï¼š</b>    <li>é«˜å†…èšï¼šä»…è´Ÿè´£æ˜¾ç¤ºå’Œç®¡ç†ç”¨æˆ·ç•Œé¢ï¼Œä¸å…¶ä»–å±‚çš„äº¤äº’é€šè¿‡ViewModelæˆ–ViewModelBaseå®ç°ã€‚</li>    <li>ä½è€¦åˆï¼šä¸ä¸šåŠ¡é€»è¾‘ï¼ˆå¦‚æ•°æ®æŸ¥è¯¢ï¼‰å’Œç½‘ç»œæ“ä½œä¹‹é—´çš„ä¾èµ–å…³ç³»éå¸¸å¼±ã€‚</li></ol><ol><b>Business Layerï¼š</b>    <li>é«˜å†…èšï¼šä¸»è¦è´Ÿè´£åº”ç”¨çš„æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œå¦‚æ•°æ®å¤„ç†ã€äº‹åŠ¡ç®¡ç†ç­‰ã€‚å®ƒä¾èµ–ORMæŠ€æœ¯å°†æ•°æ®åº“è¡¨æ˜ å°„åˆ°å®ä½“ç±»ï¼Œå¹¶é€šè¿‡ä¸­é—´å±‚ä¼ é€’æ•°æ®ã€‚</li>    <li>ä½è€¦åˆï¼šä¸å…¶ä»–ä¸¤å±‚çš„ä¾èµ–æœ‰é™ï¼Œé€šå¸¸é€šè¿‡ViewModelæˆ–ViewModelBaseä¸UI Layeräº¤äº’ã€‚</li>    </ol><ol><b>Network Layerï¼š</b></b>P    <li>é«˜å†…èšï¼šä¸“æ³¨äºæ•°æ®ä¼ è¾“å’Œé€šä¿¡ï¼Œå¤„ç†HTTPè¯·æ±‚ã€æ•°æ®å‘é€/æ¥æ”¶ç­‰æ“ä½œã€‚è¿™éƒ¨åˆ†åŠŸèƒ½è¾ƒä¸ºç‹¬ç«‹ï¼Œä¸å…¶ä»–å±‚çš„ä¾èµ–è¾ƒå°‘ã€‚</li>    <li>ä½è€¦åˆï¼šä¸UIå’Œä¸šåŠ¡å±‚ä¹‹é—´çš„äº¤äº’ä¸»è¦é€šè¿‡ä¸­é—´å±‚å®ç°ï¼ˆå¦‚HttpBindingæ¡†æ¶ï¼‰ï¼Œä¸å½±å“å…¶æ ¸å¿ƒé€»è¾‘ã€‚</li>    </ol> <h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p><b>åœ¨WPFçš„ä¸‰å±‚æ¶æ„ä¸­ï¼Œâ€œé«˜å†…èšï¼Œä½è€¦åˆâ€çš„è®¾è®¡åŸåˆ™ç¡®ä¿äº†å„å±‚åŠŸèƒ½çš„ç‹¬ç«‹æ€§å’Œæ¨¡å—åŒ–ã€‚è¿™ç§è®¾è®¡æ–¹å¼çš„ä¼˜åŠ¿åœ¨äºï¼š</b></p><blockquote><p>æ˜“äºç»´æŠ¤ï¼šæ¯ä¸€å±‚çš„åŠŸèƒ½æ¸…æ™°æ˜ç¡®ï¼Œå¯ä»¥ç‹¬ç«‹åœ°è¿›è¡Œä¿®æ”¹æˆ–å‡çº§ã€‚<br>æ‰©å±•æ€§å¼ºï¼šæ–°å¢åŠŸèƒ½æ—¶ï¼Œåªéœ€åœ¨ç‰¹å®šå±‚ä¸­å®ç°å³å¯ï¼Œæ— éœ€å½±å“å…¶ä»–å±‚ã€‚<br>å¯é‡ç”¨æ€§é«˜ï¼šå„å±‚çš„è®¾è®¡è¾ƒä¸ºé€šç”¨ï¼Œé€‚åˆå¤šç§åº”ç”¨åœºæ™¯ã€‚<br>é€šè¿‡â€œé«˜å†…èšï¼Œä½è€¦åˆâ€çš„è®¾è®¡æ€æƒ³ï¼ŒWPFçš„ä¸‰å±‚æ¶æ„å®ç°äº†é«˜æ•ˆã€ç¨³å®šä¸”æ˜“äºç»´æŠ¤çš„åº”ç”¨å¼€å‘ã€‚</p></blockquote><h1 id="æ•°æ®äº¤äº’å®¹å™¨ä¸è½½ä½“"><a href="#æ•°æ®äº¤äº’å®¹å™¨ä¸è½½ä½“" class="headerlink" title="æ•°æ®äº¤äº’å®¹å™¨ä¸è½½ä½“"></a>æ•°æ®äº¤äº’å®¹å™¨ä¸è½½ä½“</h1><ol><li>æ•°æ®å®¹å™¨</li></ol><blockquote><p>æ•°æ®å®¹å™¨æ˜¯æŒ‡æä¾›ç»Ÿä¸€æ•°æ®è®¿é—®ç­–ç•¥çš„ç»„ä»¶æˆ–ç±»ï¼Œå®ƒè´Ÿè´£å°†ä¸šåŠ¡é€»è¾‘å±‚ã€ViewModelï¼ˆè§†å›¾æ¨¡å‹ï¼‰å’Œæ•°æ®æºè¿æ¥èµ·æ¥ã€‚åœ¨WPFä¸­ï¼Œæ•°æ®å®¹å™¨é€šå¸¸æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„æ•°æ®è®¿é—®æ¥å£æˆ–ç»„ä»¶ï¼Œç”¨äºç®¡ç†ä¸ä¸åŒæ•°æ®æºï¼ˆå¦‚æ•°æ®åº“ã€äº‘å­˜å‚¨ç­‰ï¼‰çš„äº¤äº’ã€‚</p></blockquote><p><b>æ•°æ®å®¹å™¨çš„ä¸»è¦èŒè´£åŒ…æ‹¬ï¼š</b></p><li>å®šä¹‰ä¸æ•°æ®æºçš„äº¤äº’è§„åˆ™ï¼ˆå¦‚åºåˆ—åŒ–/ååºåˆ—åŒ–è§„åˆ™ã€è¿‡æ»¤è§„åˆ™ç­‰ï¼‰ã€‚</li><li>ç®¡ç†å¤šä¸ªæ•°æ®æºä¹‹é—´çš„åˆ‡æ¢å’Œåä½œã€‚</li><li>æä¾›æ•°æ®è®¿é—®æƒé™ï¼Œç¡®ä¿ä¸åŒç»„ä»¶å¯ä»¥å®‰å…¨åœ°è®¿é—®æ•°æ®æºã€‚</li><p><b>ç¤ºä¾‹ï¼š</b></p><blockquote><p>åœ¨WPFä¸­ï¼Œæ•°æ®å®¹å™¨å¯èƒ½æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„ç±»æˆ–ç»„ä»¶ï¼ˆå¦‚ DataContext æˆ– DataContextCompï¼‰ï¼Œå®ƒåŒ…å«äº†å¯¹æ•°æ®æºçš„æ“ä½œé€»è¾‘ï¼Œå¹¶å°†è¿™äº›æ“ä½œä¸ä¸šåŠ¡é€»è¾‘å±‚å’ŒViewModelç»“åˆåœ¨ä¸€èµ·ã€‚</p></blockquote><ol start="2"><li>è½½ä½“</li></ol><p>è½½ä½“æ˜¯æŒ‡åœ¨è§†å›¾æ¨¡å‹ï¼ˆViewModelï¼‰ä¸­ä½¿ç”¨æ¡¥æ¢ï¼ˆBridgeï¼‰å°†ä¸šåŠ¡é€»è¾‘å±‚çš„æ•°æ®æ“ä½œæ˜ å°„åˆ°æ•°æ®å®¹å™¨çš„é€»è¾‘ã€‚è½½ä½“è´Ÿè´£é€šè¿‡æ¡¥æ¢å°†ä¸šåŠ¡é€»è¾‘çš„æ“ä½œç»“æœä¼ é€’ç»™æ•°æ®å®¹å™¨ï¼Œæˆ–è€…ä»æ•°æ®å®¹å™¨è·å–æ•°æ®å¹¶è¿”å›ç»™ä¸šåŠ¡é€»è¾‘ã€‚</p><p>åœ¨WPFä¸­ï¼Œè½½ä½“é€šå¸¸æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„ç»„ä»¶æˆ–ç±»ï¼Œå®ƒåŒ…å«äº†å¯¹æ¡¥æ¢ï¼ˆå¦‚ ILookupBridgeã€IlooDataAccessBridgeï¼‰çš„å¼•ç”¨ï¼Œå¹¶è´Ÿè´£ç®¡ç†ä¸æ•°æ®æºçš„äº¤äº’ã€‚è½½ä½“å°†ä¸šåŠ¡é€»è¾‘å’Œæ•°æ®æºè¿æ¥èµ·æ¥ï¼Œç¡®ä¿æ•°æ®æ“ä½œçš„æ­£ç¡®æ€§å’Œä¸€è‡´æ€§ã€‚</p><p>ç¤ºä¾‹ï¼š</p><p>è½½ä½“å¯èƒ½æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„ç»„ä»¶æˆ–ç±»ï¼ˆå¦‚ UserDetailBridgeï¼‰ï¼Œå®ƒåŒ…å«äº†å¯¹æ¡¥æ¢çš„å¼•ç”¨ï¼Œå¹¶é€šè¿‡æ¡¥æ¢å°†ç”¨æˆ·çš„æœç´¢ç»“æœä¼ é€’ç»™æ•°æ®å®¹å™¨ï¼ˆå¦‚ DataContext æˆ– DataContextCompï¼‰ã€‚</p><ol start="3"><li>IlooDataAccessBridge</li></ol><p>åœ¨WPFä¸­ï¼ŒIlooDataAccessBridge æ˜¯ä¸€ä¸ªé‡è¦çš„æ¡¥æ¢æ¥å£ï¼Œç”¨äºå®ç°ä¸šåŠ¡é€»è¾‘å±‚ä¸æ•°æ®æºä¹‹é—´çš„äº¤äº’ã€‚å®ƒé€šè¿‡ä»¥ä¸‹æ–¹å¼å°†ä¸šåŠ¡é€»è¾‘å’Œæ•°æ®å®¹å™¨è¿æ¥èµ·æ¥ï¼š</p><li>å®šä¹‰å¦‚ä½•ä»æ•°æ®æºè·å–æ•°æ®ï¼ˆå¦‚æŸ¥è¯¢ã€æ›´æ–°ç­‰ï¼‰ã€‚</li><li>å®šä¹‰å¦‚ä½•å°†ä¸šåŠ¡é€»è¾‘æ“ä½œçš„ç»“æœæ˜ å°„åˆ°æ•°æ®å®¹å™¨çš„é€»è¾‘ä¸­ã€‚</li><li>æä¾›æ•°æ®çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–åŠŸèƒ½ã€‚</li><p><b>ç¤ºä¾‹ï¼š</b></p><p>åœ¨ UserDetailBridge ä¸­ï¼Œä½ å¯ä»¥å®šä¹‰ä¸€ä¸ªæ–¹æ³•æ¥æŸ¥è¯¢æ•°æ®åº“ä¸­çš„ç”¨æˆ·ä¿¡æ¯ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UserDetailBridge</span> <span class="title">implements</span> <span class="title">IlooDataAccessBridge</span>&lt;<span class="title">User</span>, <span class="title">IDetailsUser</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> IBridgeBridge bridge;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">bool</span> <span class="title">GetUserInfo</span>(<span class="params"><span class="built_in">int</span> userId</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">await</span> bridge.ExecuteScalar(<span class="string">&quot;SELECT * FROM Users WHERE Id = ? &quot;</span>, userId);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="4"><li>æ•°æ®å®¹å™¨ä¸è½½ä½“çš„å…³ç³»<blockquote><p>æ•°æ®å®¹å™¨å’Œè½½ä½“åœ¨WPFä¸­é€šå¸¸ç»“åˆä½¿ç”¨ï¼Œä»¥å®ç°é«˜æ•ˆçš„ä¸šåŠ¡é€»è¾‘æ“ä½œã€‚å…·ä½“å…³ç³»å¦‚ä¸‹ï¼š</p></blockquote></li></ol><p>æ•°æ®å®¹å™¨è´Ÿè´£ç®¡ç†ä¸æ•°æ®æºçš„äº¤äº’ç­–ç•¥ï¼ˆå¦‚åºåˆ—åŒ–ã€ååºåˆ—åŒ–è§„åˆ™ï¼‰ã€‚<br>è½½ä½“ï¼ˆé€šè¿‡æ¡¥æ¢ï¼‰å°†ä¸šåŠ¡é€»è¾‘çš„æ“ä½œç»“æœä¼ é€’ç»™æ•°æ®å®¹å™¨ï¼Œå¹¶ä»æ•°æ®å®¹å™¨è·å–æ•°æ®ã€‚</p><p><b>ç¤ºä¾‹ï¼š</b></p><p>åœ¨WPFä¸­ï¼Œæ•°æ®å®¹å™¨å’Œè½½ä½“å¯èƒ½ç»“åˆåœ¨ä¸€èµ·ä½¿ç”¨å¦‚ä¸‹ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UserDetailBridge</span> <span class="title">implements</span> <span class="title">IlooDataAccessBridge</span>&lt;<span class="title">User</span>, <span class="title">IDetailsUser</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> IBridgeBridge bridge;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> DataContext dataContext;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">bool</span> <span class="title">GetUserInfo</span>(<span class="params"><span class="built_in">int</span> userId</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">await</span> bridge.ExecuteScalar(<span class="string">&quot;SELECT * FROM Users WHERE Id = ? &quot;</span>, userId);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UserDetailContainer</span> : <span class="title">IlooDataContextComp</span>&lt;<span class="title">IDetailsUser</span>&gt; &#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">UserDetailContainer</span>(<span class="params">IBridgeBridge bridge</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (bridge != <span class="literal">null</span>)</span><br><span class="line">            bridge.SetBridge(bridge);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="5"><li>æ€»ç»“</li></ol><blockquote><p>æ•°æ®å®¹å™¨ï¼šæä¾›ç»Ÿä¸€çš„ç­–ç•¥å’Œç®¡ç†é€»è¾‘ï¼Œå°†ä¸šåŠ¡é€»è¾‘ä¸æ•°æ®æºè¿æ¥èµ·æ¥ã€‚<br>è½½ä½“ï¼šé€šè¿‡æ¡¥æ¢å°†ä¸šåŠ¡é€»è¾‘çš„æ“ä½œç»“æœä¼ é€’ç»™æ•°æ®å®¹å™¨ï¼Œå¹¶ä»æ•°æ®å®¹å™¨è·å–æ•°æ®ã€‚<br>IlooDataAccessBridgeï¼šæ˜¯å®ç°ä¸šåŠ¡é€»è¾‘å±‚ä¸æ•°æ®æºäº¤äº’çš„æ ¸å¿ƒæ¡¥æ¢ã€‚<br>é€šè¿‡åˆç†ä½¿ç”¨è¿™äº›ç»„ä»¶ï¼Œå¯ä»¥æ›´å¥½åœ°ç»„ç»‡WPFåº”ç”¨çš„ä»£ç ç»“æ„ï¼Œæé«˜æ•°æ®è®¿é—®çš„æ•ˆç‡å’Œå¯ç»´æŠ¤æ€§ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> WPF </category>
          
          <category> .NET </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Visual Studio 2022 </tag>
            
            <tag> WPF </tag>
            
            <tag> ä¸‰å±‚æ¶æ„ </tag>
            
            <tag> é«˜å†…èš </tag>
            
            <tag> ä½è€¦åˆ </tag>
            
            <tag> æ•°æ®äº¤äº’å®¹å™¨ä¸è½½ä½“ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Csharp åˆ—è¡¨</title>
      <link href="/2025/01/29/cshrap%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/csharp%E5%88%97%E8%A1%A8%E7%9A%84%E5%9F%BA%E6%9C%AC%E8%AE%A4%E8%AF%86/"/>
      <url>/2025/01/29/cshrap%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/csharp%E5%88%97%E8%A1%A8%E7%9A%84%E5%9F%BA%E6%9C%AC%E8%AE%A4%E8%AF%86/</url>
      
        <content type="html"><![CDATA[<h1 id="åˆ—è¡¨çš„åŸºæœ¬ç”¨æ³•"><a href="#åˆ—è¡¨çš„åŸºæœ¬ç”¨æ³•" class="headerlink" title="åˆ—è¡¨çš„åŸºæœ¬ç”¨æ³•"></a>åˆ—è¡¨çš„åŸºæœ¬ç”¨æ³•</h1><p><b>åˆ›å»ºåˆ—è¡¨</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºç©ºåˆ—è¡¨</span></span><br><span class="line">List&lt;<span class="built_in">int</span>&gt; numbers = <span class="keyword">new</span> List&lt;<span class="built_in">int</span>&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºå¹¶åˆå§‹åŒ–åˆ—è¡¨</span></span><br><span class="line">List&lt;<span class="built_in">string</span>&gt; names = <span class="keyword">new</span> List&lt;<span class="built_in">string</span>&gt; &#123; <span class="string">&quot;Alice&quot;</span>, <span class="string">&quot;Bob&quot;</span>, <span class="string">&quot;Charlie&quot;</span> &#125;;</span><br></pre></td></tr></table></figure><p><b>æ·»åŠ å…ƒç´ </b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">numbers.Add(<span class="number">10</span>);       <span class="comment">// åœ¨æœ«å°¾æ·»åŠ å•ä¸ªå…ƒç´ </span></span><br><span class="line">numbers.AddRange(<span class="keyword">new</span> <span class="built_in">int</span>[] &#123; <span class="number">20</span>, <span class="number">30</span> &#125;); <span class="comment">// æ·»åŠ å¤šä¸ªå…ƒç´ </span></span><br></pre></td></tr></table></figure><p><b>è®¿é—®å…ƒç´ </b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">int</span> first = numbers[<span class="number">0</span>];  <span class="comment">// é€šè¿‡ç´¢å¼•è®¿é—®ï¼ˆç±»ä¼¼æ•°ç»„ï¼‰</span></span><br></pre></td></tr></table></figure><p><b>åˆ é™¤å…ƒç´ </b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">numbers.Remove(<span class="number">20</span>);      <span class="comment">// åˆ é™¤ç¬¬ä¸€ä¸ªåŒ¹é…çš„å…ƒç´ </span></span><br><span class="line">numbers.RemoveAt(<span class="number">0</span>);     <span class="comment">// åˆ é™¤æŒ‡å®šç´¢å¼•çš„å…ƒç´ </span></span><br><span class="line">numbers.Clear();         <span class="comment">// æ¸…ç©ºåˆ—è¡¨</span></span><br></pre></td></tr></table></figure><p><b>éå†åˆ—è¡¨</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="built_in">int</span> num <span class="keyword">in</span> numbers)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(num);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å¸¸ç”¨å±æ€§å’Œæ–¹æ³•"><a href="#å¸¸ç”¨å±æ€§å’Œæ–¹æ³•" class="headerlink" title="å¸¸ç”¨å±æ€§å’Œæ–¹æ³•"></a>å¸¸ç”¨å±æ€§å’Œæ–¹æ³•</h1><blockquote><p>å±æ€§&#x2F;æ–¹æ³•è¯´æ˜<br>Countè·å–åˆ—è¡¨ä¸­çš„å…ƒç´ æ•°é‡ï¼ˆå®é™…å­˜å‚¨çš„å…ƒç´ æ•°ï¼‰<br>Capacityè·å–æˆ–è®¾ç½®åˆ—è¡¨çš„å†…éƒ¨å®¹é‡ï¼ˆåŠ¨æ€æ‰©å®¹æ—¶çš„é¢„åˆ†é…å¤§å°ï¼‰<br>Add(T item)åœ¨åˆ—è¡¨æœ«å°¾æ·»åŠ å…ƒç´ <br>Insert(int index, T item)åœ¨æŒ‡å®šä½ç½®æ’å…¥å…ƒç´ <br>Contains(T item)æ£€æŸ¥å…ƒç´ æ˜¯å¦å­˜åœ¨<br>IndexOf(T item)è¿”å›å…ƒç´ çš„ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹çš„ç´¢å¼•<br>Sort()å¯¹åˆ—è¡¨å…ƒç´ æ’åºï¼ˆéœ€å…ƒç´ å®ç° IComparable æ¥å£æˆ–æä¾›è‡ªå®šä¹‰æ¯”è¾ƒå™¨ï¼‰<br>Find(Predicate&lt;T&gt; match)æŸ¥æ‰¾ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„å…ƒç´ <br>ForEach(Action&lt;T&gt; action)å¯¹æ¯ä¸ªå…ƒç´ æ‰§è¡Œæ“ä½œ</p></blockquote><p><b> ç¤ºä¾‹ä»£ç </b></p><p><b>åŠ¨æ€æ“ä½œåˆ—è¡¨</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">List&lt;<span class="built_in">string</span>&gt; fruits = <span class="keyword">new</span> List&lt;<span class="built_in">string</span>&gt; &#123; <span class="string">&quot;Apple&quot;</span>, <span class="string">&quot;Banana&quot;</span> &#125;;</span><br><span class="line">fruits.Add(<span class="string">&quot;Cherry&quot;</span>);</span><br><span class="line">fruits.Insert(<span class="number">1</span>, <span class="string">&quot;Mango&quot;</span>);</span><br><span class="line">fruits.Remove(<span class="string">&quot;Banana&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="built_in">string</span> fruit <span class="keyword">in</span> fruits)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(fruit); <span class="comment">// è¾“å‡ºï¼šApple, Mango, Cherry</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ LINQ æŸ¥è¯¢åˆ—è¡¨</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">List&lt;<span class="built_in">int</span>&gt; numbers = <span class="keyword">new</span> List&lt;<span class="built_in">int</span>&gt; &#123; <span class="number">5</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">3</span> &#125;;</span><br><span class="line"><span class="keyword">var</span> evenNumbers = numbers.Where(n =&gt; n % <span class="number">2</span> == <span class="number">0</span>).ToList(); <span class="comment">// ç­›é€‰å¶æ•°</span></span><br><span class="line">Console.WriteLine(<span class="built_in">string</span>.Join(<span class="string">&quot;, &quot;</span>, evenNumbers)); <span class="comment">// è¾“å‡ºï¼š2, 8</span></span><br></pre></td></tr></table></figure><p>æœ€ä½³å®è·µ<br>é¢„åˆ†é…å®¹é‡<br>å¦‚æœå·²çŸ¥å…ƒç´ æ•°é‡ï¼Œåˆå§‹åŒ–æ—¶æŒ‡å®šå®¹é‡ä»¥å‡å°‘åŠ¨æ€æ‰©å®¹çš„å¼€é”€ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">List&lt;<span class="built_in">int</span>&gt; list = <span class="keyword">new</span> List&lt;<span class="built_in">int</span>&gt;(<span class="number">100</span>); <span class="comment">// åˆå§‹å®¹é‡ä¸º 100</span></span><br><span class="line">é¿å…é¢‘ç¹æ’å…¥/åˆ é™¤</span><br><span class="line">è‹¥éœ€è¦é¢‘ç¹åœ¨ä¸­é—´æ’å…¥æˆ–åˆ é™¤å…ƒç´ ï¼Œè€ƒè™‘ä½¿ç”¨ LinkedList&lt;T&gt;ã€‚</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨é›†åˆåˆå§‹åŒ–å™¨<br>ç®€åŒ–ä»£ç ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">List&lt;<span class="built_in">int</span>&gt; numbers = <span class="keyword">new</span> List&lt;<span class="built_in">int</span>&gt; &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> &#125;;</span><br><span class="line">ç»“åˆ LINQ</span><br><span class="line">ä½¿ç”¨ LINQ æ–¹æ³•ï¼ˆå¦‚ Where, Select, OrderByï¼‰ç®€åŒ–å¤æ‚æŸ¥è¯¢ã€‚</span><br></pre></td></tr></table></figure><p><b> å¸¸è§é—®é¢˜<br>å¦‚ä½•é«˜æ•ˆå¤åˆ¶åˆ—è¡¨ï¼Ÿ</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">List&lt;<span class="built_in">int</span>&gt; copy = <span class="keyword">new</span> List&lt;<span class="built_in">int</span>&gt;(originalList); <span class="comment">// é€šè¿‡æ„é€ å‡½æ•°å¤åˆ¶</span></span><br><span class="line">List&lt;<span class="built_in">int</span>&gt; copy2 = originalList.ToList();      <span class="comment">// ä½¿ç”¨ LINQ çš„ ToList()</span></span><br></pre></td></tr></table></figure><p>å¦‚ä½•å°†åˆ—è¡¨è½¬æ¢ä¸ºæ•°ç»„ï¼Ÿ</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="built_in">int</span>[] array = numbers.ToArray();</span><br></pre></td></tr></table></figure><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><blockquote><p>List&lt;T&gt; æ˜¯ C# ä¸­æœ€å¸¸ç”¨çš„é›†åˆç±»å‹ä¹‹ä¸€ï¼Œé€‚ç”¨äºéœ€è¦åŠ¨æ€è°ƒæ•´å¤§å°çš„åœºæ™¯ã€‚é€šè¿‡çµæ´»çš„æ–¹æ³•å’Œ LINQ é›†æˆï¼Œå®ƒå¯ä»¥é«˜æ•ˆå¤„ç†å¤§å¤šæ•°é›†åˆæ“ä½œã€‚åœ¨ä½¿ç”¨æ—¶éœ€æ³¨æ„å®¹é‡ç®¡ç†å’Œæ€§èƒ½ä¼˜åŒ–ï¼Œç»“åˆå…·ä½“éœ€æ±‚é€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Visual Studio 2022 </tag>
            
            <tag> é¢å‘å¯¹è±¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Csharp è¿ç®—ç¬¦é‡è½½</title>
      <link href="/2025/01/28/cshrap%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/csharp%E8%BF%90%E7%AE%97%E7%AC%A6%E9%87%8D%E8%BD%BD/"/>
      <url>/2025/01/28/cshrap%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/csharp%E8%BF%90%E7%AE%97%E7%AC%A6%E9%87%8D%E8%BD%BD/</url>
      
        <content type="html"><![CDATA[<h1 id="è¿ç®—ç¬¦é‡è½½ï¼ˆOperator-Overloadingï¼‰"><a href="#è¿ç®—ç¬¦é‡è½½ï¼ˆOperator-Overloadingï¼‰" class="headerlink" title="è¿ç®—ç¬¦é‡è½½ï¼ˆOperator Overloadingï¼‰"></a>è¿ç®—ç¬¦é‡è½½ï¼ˆOperator Overloadingï¼‰</h1><p><b>åœ¨ C# ä¸­ï¼Œè¿ç®—ç¬¦é‡è½½ï¼ˆOperator Overloadingï¼‰ æ˜¯ä¸€ç§å…è®¸ä½ ä¸ºè‡ªå®šä¹‰çš„ç±»æˆ–ç»“æ„ä½“é‡æ–°å®šä¹‰è¿ç®—ç¬¦è¡Œä¸ºçš„ç‰¹æ€§ã€‚é€šè¿‡è¿ç®—ç¬¦é‡è½½ï¼Œä½ å¯ä»¥è®©è‡ªå®šä¹‰ç±»å‹åƒå†…ç½®ç±»å‹ï¼ˆå¦‚ intã€stringï¼‰ä¸€æ ·ï¼Œç›´æ¥ä½¿ç”¨ +ã€-ã€&#x3D;&#x3D; ç­‰è¿ç®—ç¬¦è¿›è¡Œæ“ä½œï¼Œä½¿ä»£ç æ›´ç®€æ´ã€ç›´è§‚ã€‚</b></p><p>æ ¸å¿ƒè¦ç‚¹<br>ç›®çš„<br>è®©è‡ªå®šä¹‰ç±»å‹æ”¯æŒè¿ç®—ç¬¦æ“ä½œï¼Œæå‡ä»£ç å¯è¯»æ€§ã€‚ä¾‹å¦‚ï¼Œç”¨ a + b ä»£æ›¿ a.Add(b)ã€‚</p><p>å®ç°æ–¹å¼<br>é€šè¿‡å®šä¹‰ public static æ–¹æ³•ï¼Œå¹¶ä½¿ç”¨ operator å…³é”®å­—å£°æ˜è¦é‡è½½çš„è¿ç®—ç¬¦ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å¤åˆ¶</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> è¿”å›ç±»å‹ <span class="keyword">operator</span> è¿ç®—ç¬¦(å‚æ•°) &#123; ... &#125;</span><br></pre></td></tr></table></figure><h2 id="å¯é‡è½½çš„è¿ç®—ç¬¦"><a href="#å¯é‡è½½çš„è¿ç®—ç¬¦" class="headerlink" title="å¯é‡è½½çš„è¿ç®—ç¬¦"></a>å¯é‡è½½çš„è¿ç®—ç¬¦</h2><p><b>ç®—æœ¯è¿ç®—ç¬¦ï¼š+, -, *, &#x2F;, %</p><p>æ¯”è¾ƒè¿ç®—ç¬¦ï¼š&#x3D;&#x3D;, !&#x3D;, &lt;, &gt;, &lt;&#x3D;, &gt;&#x3D;</p><p>é€»è¾‘è¿ç®—ç¬¦ï¼š!,&amp;, |, ^</p><p>ä½è¿ç®—ç¬¦ï¼š &lt; &lt;, &gt;&gt;</p><p>ç±»å‹è½¬æ¢è¿ç®—ç¬¦ï¼šimplicitï¼ˆéšå¼è½¬æ¢ï¼‰å’Œ explicitï¼ˆæ˜¾å¼è½¬æ¢ï¼‰</p><p>å…¶ä»–ï¼štrue, false, ++, â€“</p><p>ä¸å¯é‡è½½çš„è¿ç®—ç¬¦ï¼š<br>&amp; &amp;, ||, &#x3D;, new, is, as, ??, &#x3D;&gt;, . ç­‰ã€‚</b></p><br><p><b>ç®€å•ç¤ºä¾‹<br>å‡è®¾æœ‰ä¸€ä¸ªè¡¨ç¤ºäºŒç»´å‘é‡çš„ç±» Vectorï¼Œé‡è½½ + è¿ç®—ç¬¦å®ç°å‘é‡ç›¸åŠ ï¼š</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">å¤åˆ¶</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Vector</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> X &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> Y &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Vector</span>(<span class="params"><span class="built_in">double</span> x, <span class="built_in">double</span> y</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        X = x;</span><br><span class="line">        Y = y;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‡è½½ + è¿ç®—ç¬¦</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Vector <span class="keyword">operator</span> +(Vector v1, Vector v2)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Vector(v1.X + v2.X, v1.Y + v2.Y);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‡å†™ ToString æ–¹ä¾¿è¾“å‡º</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">string</span> <span class="title">ToString</span>()</span> =&gt; <span class="string">$&quot;(<span class="subst">&#123;X&#125;</span>, <span class="subst">&#123;Y&#125;</span>)&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ç¤ºä¾‹</span></span><br><span class="line">Vector v1 = <span class="keyword">new</span> Vector(<span class="number">3</span>, <span class="number">4</span>);</span><br><span class="line">Vector v2 = <span class="keyword">new</span> Vector(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">Vector sum = v1 + v2; <span class="comment">// ç›´æ¥ä½¿ç”¨ + è¿ç®—ç¬¦</span></span><br><span class="line">Console.WriteLine(sum); <span class="comment">// è¾“å‡º &quot;(4, 6)&quot;</span></span><br></pre></td></tr></table></figure><p><b>å…³é”®è§„åˆ™<br>å¿…é¡»ä¸ºé™æ€æ–¹æ³•<br>è¿ç®—ç¬¦é‡è½½çš„æ–¹æ³•å¿…é¡»æ˜¯ public staticã€‚</p><p>å‚æ•°å’Œè¿”å›ç±»å‹</p><p>è¿ç®—ç¬¦çš„æ“ä½œæ•°å¿…é¡»åŒ…å«å½“å‰ç±»å‹ï¼ˆä¾‹å¦‚ Vector + Vectorï¼‰ã€‚</p><p>è¿”å›ç±»å‹å¯ä»¥æ˜¯ä»»æ„ç±»å‹ï¼Œä½†é€šå¸¸ä¸å½“å‰ç±»å‹ä¸€è‡´ã€‚</p><p>æˆå¯¹é‡è½½</p><p>è‹¥é‡è½½ &#x3D;&#x3D;ï¼Œå¿…é¡»åŒæ—¶é‡è½½ !&#x3D;ã€‚</p><p>è‹¥é‡è½½ &lt;ï¼Œé€šå¸¸éœ€è¦é‡è½½ &gt;ã€ &lt;&#x3D;ã€&gt;&#x3D;ã€‚</p><p>é‡å†™ Equals å’Œ GetHashCode<br>å¦‚æœé‡è½½äº†æ¯”è¾ƒè¿ç®—ç¬¦ï¼ˆå¦‚ &#x3D;&#x3D;ï¼‰ï¼Œå¿…é¡»åŒæ—¶é‡å†™ Equals() å’Œ GetHashCode()ï¼Œç¡®ä¿é€»è¾‘ä¸€è‡´ã€‚</p><p>å…¸å‹åº”ç”¨åœºæ™¯<br>æ•°å­¦å¯¹è±¡<br>å¤æ•°ã€çŸ©é˜µã€å¤šé¡¹å¼ç­‰éœ€è¦ç®—æœ¯è¿ç®—çš„ç±»å‹ã€‚</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å¤åˆ¶</span><br><span class="line">Complex c1 = <span class="keyword">new</span> Complex(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">Complex c2 = <span class="keyword">new</span> Complex(<span class="number">3</span>, <span class="number">4</span>);</span><br><span class="line">Complex sum = c1 + c2; <span class="comment">// ç›´æ¥ç›¸åŠ </span></span><br></pre></td></tr></table></figure><p><b>ç‰©ç†é‡<br>è·ç¦»ã€é€Ÿåº¦ã€æ¸©åº¦ç­‰éœ€è¦è¿ç®—ç¬¦æ“ä½œçš„ç‰©ç†é‡ã€‚</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å¤åˆ¶</span><br><span class="line">Distance d1 = <span class="keyword">new</span> Distance(<span class="number">10</span>, Unit.Meter);</span><br><span class="line">Distance d2 = <span class="keyword">new</span> Distance(<span class="number">5</span>, Unit.Meter);</span><br><span class="line">Distance total = d1 + d2; <span class="comment">// è‡ªåŠ¨å•ä½è½¬æ¢å¹¶ç›¸åŠ </span></span><br></pre></td></tr></table></figure><p><b>è‡ªå®šä¹‰é€»è¾‘<br>ä¾‹å¦‚é‡è½½ + åˆå¹¶é›†åˆï¼Œæˆ–é‡è½½ &#x3D;&#x3D; æ¯”è¾ƒå¯¹è±¡çš„ä¸šåŠ¡é€»è¾‘ç­‰ä»·æ€§ã€‚</p><p>æ³¨æ„äº‹é¡¹<br>é¿å…æ»¥ç”¨<br>è¿ç®—ç¬¦çš„è¡Œä¸ºå¿…é¡»ç¬¦åˆç›´è§‰ã€‚ä¾‹å¦‚ï¼Œ+ ä¸åº”è¢«é‡è½½ä¸ºå‡æ³•æ“ä½œã€‚</p><p>æ€§èƒ½ä¼˜åŒ–<br>é¿å…åœ¨è¿ç®—ç¬¦é‡è½½ä¸­æ‰§è¡Œå¤æ‚æ“ä½œï¼ˆå¦‚æ•°æ®åº“æŸ¥è¯¢ï¼‰ã€‚</p><p>éšå¼&#x2F;æ˜¾å¼è½¬æ¢<br>ä½¿ç”¨ implicit æˆ– explicit å®šä¹‰ç±»å‹è½¬æ¢æ—¶éœ€è°¨æ…ï¼Œç¡®ä¿ä¸ä¼šå¯¼è‡´æ­§ä¹‰ã€‚</b></p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p><b>è¿ç®—ç¬¦é‡è½½è®©è‡ªå®šä¹‰ç±»å‹å¯ä»¥åƒå†…ç½®ç±»å‹ä¸€æ ·ä½¿ç”¨è¿ç®—ç¬¦ï¼Œä½¿ä»£ç æ›´ç®€æ´ã€ç›´è§‚ã€‚ä½†éœ€éµå¾ªè¯­ä¹‰åˆç†æ€§ï¼ˆå¦‚ + è¡¨ç¤ºåŠ æ³•ï¼‰å’Œä¸€è‡´æ€§åŸåˆ™ï¼ˆå¦‚æˆå¯¹é‡è½½ &#x3D;&#x3D; å’Œ !&#x3D;ï¼‰ã€‚æ­£ç¡®ä½¿ç”¨æ—¶ï¼Œèƒ½å¤§å¹…æå‡ä»£ç å¯è¯»æ€§ï¼›æ»¥ç”¨åˆ™ä¼šå¯¼è‡´ä»£ç éš¾ä»¥ç»´æŠ¤ã€‚</b></p>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Visual Studio 2022 </tag>
            
            <tag> é¢å‘å¯¹è±¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Csharp ç´¢å¼•å™¨çš„ä½¿ç”¨</title>
      <link href="/2025/01/28/cshrap%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/csharp%E7%B4%A2%E5%BC%95%E5%99%A8/"/>
      <url>/2025/01/28/cshrap%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/csharp%E7%B4%A2%E5%BC%95%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯ç´¢å¼•å™¨ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯ç´¢å¼•å™¨ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ç´¢å¼•å™¨ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ç´¢å¼•å™¨ï¼Ÿ</h1><p><b>ç´¢å¼•å™¨ï¼ˆIndexerï¼‰æ˜¯ C# ä¸­çš„ä¸€ç§ç‰¹æ®Šæˆå‘˜ï¼Œå…è®¸å¯¹è±¡åƒæ•°ç»„æˆ–é›†åˆä¸€æ ·é€šè¿‡ç´¢å¼•ï¼ˆå¦‚ []ï¼‰è®¿é—®å†…éƒ¨å…ƒç´ ã€‚</p><p>ç±»ä¼¼äºå±æ€§ï¼ˆPropertyï¼‰ï¼Œä½†é€šè¿‡ç´¢å¼•å‚æ•°è®¿é—®æ•°æ®ã€‚</p><p>å¸¸ç”¨äºå°è£…é›†åˆç±»ï¼ˆå¦‚è‡ªå®šä¹‰åˆ—è¡¨ã€å­—å…¸ï¼‰ï¼Œä½¿å…¶å¯ä»¥é€šè¿‡ç´¢å¼•ç›´æ¥æ“ä½œå…ƒç´ ã€‚</b></p><h1 id="å¦‚ä½•å®šä¹‰å’Œä½¿ç”¨ç´¢å¼•å™¨ï¼Ÿ"><a href="#å¦‚ä½•å®šä¹‰å’Œä½¿ç”¨ç´¢å¼•å™¨ï¼Ÿ" class="headerlink" title="å¦‚ä½•å®šä¹‰å’Œä½¿ç”¨ç´¢å¼•å™¨ï¼Ÿ"></a>å¦‚ä½•å®šä¹‰å’Œä½¿ç”¨ç´¢å¼•å™¨ï¼Ÿ</h1><p>è¯­æ³•ç»“æ„</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">å¤åˆ¶</span><br><span class="line"><span class="keyword">public</span> è¿”å›ç±»å‹ <span class="keyword">this</span>[å‚æ•°ç±»å‹ index]</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">get</span> &#123; <span class="comment">/* è¿”å› index å¯¹åº”çš„å€¼ */</span> &#125;</span><br><span class="line">    <span class="keyword">set</span> &#123; <span class="comment">/* è®¾ç½® index å¯¹åº”çš„å€¼ */</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line">ç¤ºä¾‹ä»£ç </span><br><span class="line">csharp</span><br><span class="line">å¤åˆ¶</span><br><span class="line"><span class="keyword">class</span> <span class="title">StringCollection</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span>[] _data = <span class="keyword">new</span> <span class="built_in">string</span>[<span class="number">10</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®šä¹‰ç´¢å¼•å™¨</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> <span class="keyword">this</span>[<span class="built_in">int</span> index]</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (index &lt; <span class="number">0</span> || index &gt;= _data.Length)</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfRangeException();</span><br><span class="line">            <span class="keyword">return</span> _data[index];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">set</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (index &lt; <span class="number">0</span> || index &gt;= _data.Length)</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfRangeException();</span><br><span class="line">            _data[index] = <span class="keyword">value</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ç´¢å¼•å™¨</span></span><br><span class="line"><span class="keyword">var</span> collection = <span class="keyword">new</span> StringCollection();</span><br><span class="line">collection[<span class="number">0</span>] = <span class="string">&quot;Hello&quot;</span>;  <span class="comment">// é€šè¿‡ç´¢å¼•èµ‹å€¼</span></span><br><span class="line">Console.WriteLine(collection[<span class="number">0</span>]);  <span class="comment">// é€šè¿‡ç´¢å¼•å–å€¼</span></span><br></pre></td></tr></table></figure><br><p><b>å…³é”®ç‚¹</p><p>ä½¿ç”¨ this å…³é”®å­—å®šä¹‰ã€‚</p><p>æ”¯æŒå¤šä¸ªå‚æ•°ï¼ˆå¦‚å¤šç»´ç´¢å¼•ï¼‰ï¼špublic int this[int x, int y] { â€¦ }ã€‚</p><p>å¯ä»¥é‡è½½ï¼ˆä¸åŒå‚æ•°ç±»å‹æˆ–æ•°é‡ï¼‰ã€‚</b></p><h1 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h1><p><b>é€‚åˆä½¿ç”¨ç´¢å¼•å™¨çš„åœºæ™¯<br>å°è£…é›†åˆç±»<br>å½“ç±»å†…éƒ¨åŒ…å«æ•°ç»„ã€åˆ—è¡¨æˆ–å…¶ä»–é›†åˆæ—¶ï¼Œé€šè¿‡ç´¢å¼•å™¨æä¾›ç±»ä¼¼æ•°ç»„çš„è®¿é—®æ–¹å¼ã€‚</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">å¤åˆ¶</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyList</span>&lt;<span class="title">T</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> T[] _items;</span><br><span class="line">    <span class="keyword">public</span> T <span class="keyword">this</span>[<span class="built_in">int</span> index] &#123; <span class="keyword">get</span> &#123; <span class="keyword">return</span> _items[index]; &#125; <span class="keyword">set</span> &#123; _items[index] = <span class="keyword">value</span>; &#125; &#125;</span><br><span class="line">&#125;</span><br><span class="line">é”®å€¼å¯¹è®¿é—®</span><br><span class="line">ç±»ä¼¼å­—å…¸çš„é”®å€¼è®¿é—®ï¼Œä¾‹å¦‚é€šè¿‡å­—ç¬¦ä¸²ç´¢å¼•ï¼š</span><br><span class="line"></span><br><span class="line">csharp</span><br><span class="line">å¤åˆ¶</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Config</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt; _settings = <span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt;();</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> <span class="keyword">this</span>[<span class="built_in">string</span> key]</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123; <span class="keyword">return</span> _settings[key]; &#125;</span><br><span class="line">        <span class="keyword">set</span> &#123; _settings[key] = <span class="keyword">value</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><p><b>æ•°å­¦ç»“æ„</p><p>è¡¨ç¤ºçŸ©é˜µã€å‘é‡ç­‰æ•°å­¦ç»“æ„æ—¶ï¼Œé€šè¿‡å¤šç»´ç´¢å¼•è®¿é—®å…ƒç´ ï¼š</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">å¤åˆ¶</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Matrix</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">int</span>[,] _matrix = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">3</span>,<span class="number">3</span>];</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> <span class="keyword">this</span>[<span class="built_in">int</span> row, <span class="built_in">int</span> col]</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123; <span class="keyword">return</span> _matrix[row, col]; &#125;</span><br><span class="line">        <span class="keyword">set</span> &#123; _matrix[row, col] = <span class="keyword">value</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><p><b>ç®€åŒ–ä»£ç <br>å½“éœ€è¦é€šè¿‡ç´¢å¼•ç›´æ¥æ“ä½œå¯¹è±¡å†…éƒ¨æ•°æ®æ—¶ï¼Œç´¢å¼•å™¨æ¯”æ–¹æ³•è°ƒç”¨æ›´ç›´è§‚ï¼š</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">å¤åˆ¶</span><br><span class="line"><span class="comment">// ä½¿ç”¨ç´¢å¼•å™¨</span></span><br><span class="line">myObject[<span class="number">5</span>] = <span class="number">100</span>;</span><br><span class="line"><span class="comment">// å¯¹æ¯”æ–¹æ³•</span></span><br><span class="line">myObject.SetValue(<span class="number">5</span>, <span class="number">100</span>);</span><br></pre></td></tr></table></figure><br><h1 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h1><p><b>ç´¢å¼•å™¨å‚æ•°ç±»å‹<br>å¯ä»¥æ˜¯ä»»æ„ç±»å‹ï¼ˆå¦‚ intã€stringã€enum ç­‰ï¼‰ï¼Œä½†éœ€ç¡®ä¿é€»è¾‘åˆç†ã€‚</p><p>å¼‚å¸¸å¤„ç†<br>åœ¨ get å’Œ set ä¸­éœ€æ£€æŸ¥ç´¢å¼•æœ‰æ•ˆæ€§ï¼Œé¿å…è¶Šç•Œé”™è¯¯ã€‚</p><p>ä¸å¯é™æ€<br>ç´¢å¼•å™¨ä¸èƒ½å£°æ˜ä¸º staticã€‚</p><p>ä¸å±æ€§çš„åŒºåˆ«</p><p>å±æ€§é€šè¿‡åç§°è®¿é—®ï¼ˆå¦‚ obj.Nameï¼‰ï¼Œç´¢å¼•å™¨é€šè¿‡å‚æ•°è®¿é—®ï¼ˆå¦‚ obj[0]ï¼‰ã€‚</p><p>ç´¢å¼•å™¨å¯ä»¥æœ‰å¤šä¸ªå‚æ•°ï¼Œå±æ€§æ²¡æœ‰å‚æ•°ã€‚</b></p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p><b>ç´¢å¼•å™¨ç”¨äºè®©å¯¹è±¡æ”¯æŒç±»ä¼¼æ•°ç»„çš„ç´¢å¼•è®¿é—®ï¼Œé€‚ç”¨äºå°è£…é›†åˆæˆ–éœ€è¦ç›´æ¥é€šè¿‡ç´¢å¼•æ“ä½œæ•°æ®çš„åœºæ™¯ã€‚åˆç†ä½¿ç”¨ç´¢å¼•å™¨å¯ä»¥æå‡ä»£ç çš„å¯è¯»æ€§å’Œæ˜“ç”¨æ€§ï¼Œä½†éœ€æ³¨æ„è¾¹ç•Œæ£€æŸ¥å’Œå‚æ•°é€»è¾‘ã€‚</b></p>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Visual Studio 2022 </tag>
            
            <tag> é¢å‘å¯¹è±¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Csharp è™šæ–¹æ³•å’Œéšè—æ–¹æ³•-æŠ½è±¡ç±»å’Œå¯†å°ç±»</title>
      <link href="/2025/01/27/cshrap%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/csharp%E8%99%9A%E6%96%B9%E6%B3%95%E5%92%8C%E9%9A%90%E8%97%8F%E6%96%B9%E6%B3%95/"/>
      <url>/2025/01/27/cshrap%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/csharp%E8%99%9A%E6%96%B9%E6%B3%95%E5%92%8C%E9%9A%90%E8%97%8F%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h1 id="è™šæ–¹æ³•å’Œéšè—æ–¹æ³•"><a href="#è™šæ–¹æ³•å’Œéšè—æ–¹æ³•" class="headerlink" title="è™šæ–¹æ³•å’Œéšè—æ–¹æ³•"></a>è™šæ–¹æ³•å’Œéšè—æ–¹æ³•</h1><h2 id="è™šæ–¹æ³•ï¼ˆVirtual-Methodï¼‰"><a href="#è™šæ–¹æ³•ï¼ˆVirtual-Methodï¼‰" class="headerlink" title="è™šæ–¹æ³•ï¼ˆVirtual Methodï¼‰"></a>è™šæ–¹æ³•ï¼ˆVirtual Methodï¼‰</h2><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a><b>å®šä¹‰</b></h3><p><b>åœ¨ C# ä¸­ï¼Œè™šæ–¹æ³•æ˜¯åœ¨åŸºç±»ä¸­ä½¿ç”¨virtualå…³é”®å­—ä¿®é¥°çš„æ–¹æ³•ã€‚å®ƒå…è®¸æ´¾ç”Ÿç±»é‡å†™ï¼ˆoverrideï¼‰è¯¥æ–¹æ³•çš„å®ç°ã€‚è™šæ–¹æ³•æä¾›äº†ä¸€ç§å¤šæ€æ€§çš„æœºåˆ¶ï¼Œä½¿å¾—åœ¨è¿è¡Œæ—¶å¯ä»¥æ ¹æ®å¯¹è±¡çš„å®é™…ç±»å‹æ¥è°ƒç”¨ç›¸åº”çš„æ–¹æ³•ã€‚</b></p><li><b>ç¤ºä¾‹</b></li><blockquote><p>è€ƒè™‘ä¸€ä¸ªç®€å•çš„åŠ¨ç‰©ç±»å±‚æ¬¡ç»“æ„ã€‚é¦–å…ˆæœ‰ä¸€ä¸ªåŸºç±»Animalï¼š</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Animal</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">MakeSound</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;The animal makes a sound.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">ç„¶åæœ‰ä¸€ä¸ªæ´¾ç”Ÿç±»Dogï¼Œå®ƒé‡å†™äº†MakeSoundæ–¹æ³•ï¼š</span><br><span class="line">csharp</span><br><span class="line"><span class="keyword">class</span> <span class="title">Dog</span> : <span class="title">Animal</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">MakeSound</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;The dog barks.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è°ƒç”¨æ–¹å¼"><a href="#è°ƒç”¨æ–¹å¼" class="headerlink" title="è°ƒç”¨æ–¹å¼"></a>è°ƒç”¨æ–¹å¼</h2><p>å½“é€šè¿‡åŸºç±»å¼•ç”¨æŒ‡å‘æ´¾ç”Ÿç±»å¯¹è±¡æ—¶ï¼Œè°ƒç”¨è™šæ–¹æ³•ä¼šæ ¹æ®å¯¹è±¡çš„å®é™…ç±»å‹ï¼ˆå³æ´¾ç”Ÿç±»ç±»å‹ï¼‰æ¥æ‰§è¡Œç›¸åº”çš„æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Animal animal = <span class="keyword">new</span> Dog();</span><br><span class="line">animal.MakeSound(); <span class="comment">// è¾“å‡º &quot;The dog barks.&quot;</span></span><br></pre></td></tr></table></figure><p>è¿™å±•ç¤ºäº†å¤šæ€æ€§ï¼Œå› ä¸ºå³ä½¿animalè¢«å£°æ˜ä¸ºAnimalç±»å‹ï¼Œä½†å®é™…æ‰§è¡Œçš„æ˜¯Dogç±»ä¸­é‡å†™åçš„MakeSoundæ–¹æ³•ã€‚</p><h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><p>è™šæ–¹æ³•åœ¨åŸºç±»ä¸­å®šä¹‰äº†ä¸€ä¸ªåŸºæœ¬çš„æ–¹æ³•æ¡†æ¶ï¼Œæ´¾ç”Ÿç±»å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚è¿›è¡Œå®šåˆ¶åŒ–çš„é‡å†™ã€‚é‡å†™æ–¹æ³•æ—¶ï¼Œå¿…é¡»ä½¿ç”¨overrideå…³é”®å­—ï¼Œå¹¶ä¸”æ–¹æ³•ç­¾åï¼ˆæ–¹æ³•åç§°ã€å‚æ•°åˆ—è¡¨å’Œè¿”å›ç±»å‹ï¼‰å¿…é¡»ä¸åŸºç±»ä¸­çš„è™šæ–¹æ³•å®Œå…¨ä¸€è‡´ã€‚</p><br><h1 id="éšè—æ–¹æ³•ï¼ˆMethod-Hidingï¼‰"><a href="#éšè—æ–¹æ³•ï¼ˆMethod-Hidingï¼‰" class="headerlink" title="éšè—æ–¹æ³•ï¼ˆMethod Hidingï¼‰"></a>éšè—æ–¹æ³•ï¼ˆMethod Hidingï¼‰</h1><h2 id="å®šä¹‰-1"><a href="#å®šä¹‰-1" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h2><p>å½“æ´¾ç”Ÿç±»ä¸­å®šä¹‰äº†ä¸€ä¸ªä¸åŸºç±»ä¸­æ–¹æ³•åŒåçš„æ–¹æ³•ï¼Œä½†æ²¡æœ‰ä½¿ç”¨overrideå…³é”®å­—ï¼ˆæˆ–è€…åŸºç±»æ–¹æ³•ä¸æ˜¯è™šæ–¹æ³•ï¼‰æ—¶ï¼Œå°±å‘ç”Ÿäº†æ–¹æ³•éšè—ã€‚æ–¹æ³•éšè—æ˜¯é€šè¿‡åœ¨æ´¾ç”Ÿç±»æ–¹æ³•å‰ä½¿ç”¨newå…³é”®å­—æ¥æ˜¾å¼åœ°è¡¨ç¤ºè¿™ç§éšè—æ„å›¾ã€‚</p><li><b>ç¤ºä¾‹</b></li><p>å‡è®¾è¿˜æ˜¯åˆšæ‰çš„Animalç±»ï¼Œä½†æ˜¯è¿™æ¬¡MakeSoundæ–¹æ³•ä¸æ˜¯è™šæ–¹æ³•ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Animal</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">MakeSound</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;The animal makes a sound.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">ç„¶ååœ¨æ´¾ç”Ÿç±»Catä¸­éšè—è¿™ä¸ªæ–¹æ³•ï¼š</span><br><span class="line">csharp</span><br><span class="line"><span class="keyword">class</span> <span class="title">Cat</span> : <span class="title">Animal</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">new</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">MakeSound</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;The cat meows.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è°ƒç”¨æ–¹å¼-1"><a href="#è°ƒç”¨æ–¹å¼-1" class="headerlink" title="è°ƒç”¨æ–¹å¼"></a>è°ƒç”¨æ–¹å¼</h2><p>ä¸è™šæ–¹æ³•ä¸åŒï¼Œéšè—æ–¹æ³•çš„è°ƒç”¨å–å†³äºå¼•ç”¨å˜é‡çš„ç±»å‹ï¼Œè€Œä¸æ˜¯å¯¹è±¡çš„å®é™…ç±»å‹ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Animal animal = <span class="keyword">new</span> Cat();</span><br><span class="line">animal.MakeSound(); <span class="comment">// è¾“å‡º &quot;The animal makes a sound.&quot;</span></span><br><span class="line">Cat cat = <span class="keyword">new</span> Cat();</span><br><span class="line">cat.MakeSound(); <span class="comment">// è¾“å‡º &quot;The cat meows.&quot;</span></span><br></pre></td></tr></table></figure><h2 id="æ³¨æ„äº‹é¡¹-1"><a href="#æ³¨æ„äº‹é¡¹-1" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><p><b>æ–¹æ³•éšè—å¯èƒ½ä¼šå¯¼è‡´ä¸€äº›æ„å¤–çš„è¡Œä¸ºï¼Œå› ä¸ºå®ƒä¸åƒè™šæ–¹æ³•é‚£æ ·éµå¾ªå¤šæ€æ€§åŸåˆ™ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœæƒ³è¦å®ç°å¤šæ€æ€§ï¼Œåº”è¯¥ä¼˜å…ˆè€ƒè™‘ä½¿ç”¨è™šæ–¹æ³•å’Œé‡å†™ï¼Œè€Œæ–¹æ³•éšè—ä¸»è¦ç”¨äºåœ¨æ´¾ç”Ÿç±»ä¸­æä¾›ä¸€ä¸ªä¸åŸºç±»åŒåä½†è¡Œä¸ºä¸åŒçš„æ–¹æ³•ï¼Œå¹¶ä¸”æ˜ç¡®åœ°è¡¨æ˜è¿™ç§è¡Œä¸ºæ˜¯ç‹¬ç«‹äºåŸºç±»æ–¹æ³•çš„æ„å›¾ã€‚</b></p><h1 id="æŠ½è±¡ç±»ï¼ˆAbstract-Classï¼‰"><a href="#æŠ½è±¡ç±»ï¼ˆAbstract-Classï¼‰" class="headerlink" title="æŠ½è±¡ç±»ï¼ˆAbstract Classï¼‰"></a>æŠ½è±¡ç±»ï¼ˆAbstract Classï¼‰</h1><h2 id="å®šä¹‰ä¸ç‰¹ç‚¹"><a href="#å®šä¹‰ä¸ç‰¹ç‚¹" class="headerlink" title="å®šä¹‰ä¸ç‰¹ç‚¹"></a>å®šä¹‰ä¸ç‰¹ç‚¹</h2><p><b>æŠ½è±¡ç±»æ˜¯ä½¿ç”¨ abstract å…³é”®å­—ä¿®é¥°çš„ç±»ï¼Œå®ƒä¸èƒ½è¢«å®ä¾‹åŒ–ï¼Œä¸»è¦ç”¨äºä½œä¸ºå…¶ä»–ç±»çš„åŸºç±»ï¼Œä¸ºæ´¾ç”Ÿç±»æä¾›ä¸€ä¸ªé€šç”¨çš„æ¨¡æ¿æˆ–æ¡†æ¶ã€‚</p><p>æŠ½è±¡ç±»å¯ä»¥åŒ…å«æŠ½è±¡æ–¹æ³•ã€éæŠ½è±¡æ–¹æ³•ã€å±æ€§ã€å­—æ®µç­‰æˆå‘˜ã€‚æŠ½è±¡æ–¹æ³•æ˜¯ä½¿ç”¨ abstract å…³é”®å­—ä¿®é¥°çš„æ–¹æ³•ï¼Œå®ƒåªæœ‰æ–¹æ³•å£°æ˜ï¼Œæ²¡æœ‰æ–¹æ³•ä½“ï¼Œæ´¾ç”Ÿç±»å¿…é¡»å®ç°è¿™äº›æŠ½è±¡æ–¹æ³•ã€‚</b></p><li>ç¤ºä¾‹ä»£ç </li><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰æŠ½è±¡ç±» Animal</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title">Animal</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// æŠ½è±¡æ–¹æ³•ï¼Œæ´¾ç”Ÿç±»å¿…é¡»å®ç°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">MakeSound</span>()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// éæŠ½è±¡æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Eat</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;The animal is eating.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ´¾ç”Ÿç±» Dog ç»§æ‰¿è‡ªæŠ½è±¡ç±» Animal</span></span><br><span class="line"><span class="keyword">class</span> <span class="title">Dog</span> : <span class="title">Animal</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// å®ç°æŠ½è±¡æ–¹æ³• MakeSound</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">MakeSound</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;The dog barks.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ä¸èƒ½å®ä¾‹åŒ–æŠ½è±¡ç±»</span></span><br><span class="line">        <span class="comment">// Animal animal = new Animal(); // è¿™è¡Œä»£ç ä¼šç¼–è¯‘é”™è¯¯</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¯ä»¥ä½¿ç”¨æ´¾ç”Ÿç±»å®ä¾‹åŒ–</span></span><br><span class="line">        Dog dog = <span class="keyword">new</span> Dog();</span><br><span class="line">        dog.MakeSound(); <span class="comment">// è¾“å‡º: The dog barks.</span></span><br><span class="line">        dog.Eat(); <span class="comment">// è¾“å‡º: The animal is eating.</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä»£ç è§£é‡Š"><a href="#ä»£ç è§£é‡Š" class="headerlink" title="ä»£ç è§£é‡Š"></a>ä»£ç è§£é‡Š</h2><p><b>Animal æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³• MakeSound å’Œä¸€ä¸ªéæŠ½è±¡æ–¹æ³• Eatã€‚<br>Dog ç±»ç»§æ‰¿è‡ª Animal ç±»ï¼Œå¿…é¡»å®ç° MakeSound æ–¹æ³•ã€‚<br>åœ¨ Main æ–¹æ³•ä¸­ï¼Œä¸èƒ½ç›´æ¥å®ä¾‹åŒ–æŠ½è±¡ç±» Animalï¼Œä½†å¯ä»¥å®ä¾‹åŒ–æ´¾ç”Ÿç±» Dogï¼Œå¹¶è°ƒç”¨å…¶æ–¹æ³•ã€‚</b></p><h2 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h2><p><b>å½“ä½ éœ€è¦å®šä¹‰ä¸€ç»„ç›¸å…³ç±»çš„é€šç”¨è¡Œä¸ºï¼Œä½†æŸäº›è¡Œä¸ºçš„å…·ä½“å®ç°éœ€è¦ç”±æ´¾ç”Ÿç±»æ¥å®Œæˆæ—¶ï¼Œå¯ä»¥ä½¿ç”¨æŠ½è±¡ç±»ã€‚ä¾‹å¦‚ï¼Œå›¾å½¢ç±»å¯ä»¥å®šä¹‰ä¸ºæŠ½è±¡ç±»ï¼Œå…¶ä¸­åŒ…å«è®¡ç®—é¢ç§¯çš„æŠ½è±¡æ–¹æ³•ï¼Œä¸åŒçš„å›¾å½¢ï¼ˆå¦‚åœ†å½¢ã€çŸ©å½¢ï¼‰ç»§æ‰¿è‡ªè¯¥æŠ½è±¡ç±»å¹¶å®ç°å…·ä½“çš„è®¡ç®—æ–¹æ³•ã€‚</b></p><h1 id="å¯†å°ç±»ï¼ˆSealed-Classï¼‰"><a href="#å¯†å°ç±»ï¼ˆSealed-Classï¼‰" class="headerlink" title="å¯†å°ç±»ï¼ˆSealed Classï¼‰"></a>å¯†å°ç±»ï¼ˆSealed Classï¼‰</h1><h2 id="å®šä¹‰ä¸ç‰¹ç‚¹-1"><a href="#å®šä¹‰ä¸ç‰¹ç‚¹-1" class="headerlink" title="å®šä¹‰ä¸ç‰¹ç‚¹"></a>å®šä¹‰ä¸ç‰¹ç‚¹</h2><p><b>å¯†å°ç±»æ˜¯ä½¿ç”¨ sealed å…³é”®å­—ä¿®é¥°çš„ç±»ï¼Œå®ƒä¸èƒ½è¢«ç»§æ‰¿ï¼Œå³ä¸èƒ½æœ‰æ´¾ç”Ÿç±»ã€‚<br>å¯†å°ç±»é€šå¸¸ç”¨äºé˜²æ­¢å…¶ä»–ç±»ç»§æ‰¿å’Œä¿®æ”¹å…¶è¡Œä¸ºï¼Œä»è€Œä¿è¯ç±»çš„å®‰å…¨æ€§å’Œç¨³å®šæ€§ã€‚å¯†å°ç±»å¯ä»¥åŒ…å«å„ç§æˆå‘˜ï¼Œä¸æ™®é€šç±»çš„åŒºåˆ«åœ¨äºå®ƒä¸èƒ½ä½œä¸ºåŸºç±»ã€‚</b></p><li>ç¤ºä¾‹ä»£ç </li><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰å¯†å°ç±» Circle</span></span><br><span class="line"><span class="keyword">sealed</span> <span class="keyword">class</span> <span class="title">Circle</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">double</span> radius;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Circle</span>(<span class="params"><span class="built_in">double</span> radius</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.radius = radius;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">double</span> <span class="title">CalculateArea</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> Math.PI * radius * radius;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°è¯•ç»§æ‰¿å¯†å°ç±»ï¼Œä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯</span></span><br><span class="line"><span class="comment">// class DerivedCircle : Circle &#123; &#125; </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Circle circle = <span class="keyword">new</span> Circle(<span class="number">5</span>);</span><br><span class="line">        <span class="built_in">double</span> area = circle.CalculateArea();</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;The area of the circle is: <span class="subst">&#123;area&#125;</span>&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä»£ç è§£é‡Š-1"><a href="#ä»£ç è§£é‡Š-1" class="headerlink" title="ä»£ç è§£é‡Š"></a>ä»£ç è§£é‡Š</h2><p><b>Circle æ˜¯ä¸€ä¸ªå¯†å°ç±»ï¼Œå®ƒåŒ…å«ä¸€ä¸ªç§æœ‰å­—æ®µ radiusã€ä¸€ä¸ªæ„é€ å‡½æ•°å’Œä¸€ä¸ªè®¡ç®—é¢ç§¯çš„æ–¹æ³• CalculateAreaã€‚<br>å°è¯•å®šä¹‰ä¸€ä¸ªç»§æ‰¿è‡ª Circle çš„ç±» DerivedCircle ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ï¼Œå› ä¸ºå¯†å°ç±»ä¸èƒ½è¢«ç»§æ‰¿ã€‚<br>åœ¨ Main æ–¹æ³•ä¸­ï¼Œå¯ä»¥æ­£å¸¸å®ä¾‹åŒ–å¯†å°ç±» Circle å¹¶è°ƒç”¨å…¶æ–¹æ³•ã€‚</p><h2 id="ä½¿ç”¨åœºæ™¯-1"><a href="#ä½¿ç”¨åœºæ™¯-1" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h2><p>å½“ä½ å¸Œæœ›æŸä¸ªç±»çš„å®ç°ç»†èŠ‚ä¸è¢«å…¶ä»–ç±»ä¿®æ”¹ï¼Œæˆ–è€…æŸä¸ªç±»çš„è®¾è®¡å·²ç»æ˜¯æœ€ç»ˆç‰ˆæœ¬ï¼Œä¸éœ€è¦å†è¿›è¡Œæ‰©å±•æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å¯†å°ç±»ã€‚ä¾‹å¦‚ï¼Œä¸€äº›å·¥å…·ç±»ã€å•ä¾‹ç±»ç­‰å¯ä»¥è®¾è®¡ä¸ºå¯†å°ç±»ã€‚<br>ç»¼ä¸Šæ‰€è¿°ï¼ŒæŠ½è±¡ç±»ç”¨äºæä¾›é€šç”¨çš„æŠ½è±¡æ¨¡æ¿ï¼Œä¿ƒè¿›ä»£ç çš„å¤ç”¨å’Œå¤šæ€æ€§ï¼›è€Œå¯†å°ç±»ç”¨äºé™åˆ¶ç±»çš„ç»§æ‰¿ï¼Œä¿è¯ç±»çš„å®‰å…¨æ€§å’Œç¨³å®šæ€§ã€‚</b></p>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Visual Studio 2022 </tag>
            
            <tag> é¢å‘å¯¹è±¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Csharp ç»§æ‰¿</title>
      <link href="/2025/01/27/cshrap%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/csharp%E4%BB%80%E4%B9%88%E6%98%AF%E7%BB%A7%E6%89%BF/"/>
      <url>/2025/01/27/cshrap%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/csharp%E4%BB%80%E4%B9%88%E6%98%AF%E7%BB%A7%E6%89%BF/</url>
      
        <content type="html"><![CDATA[<h1 id="ç»§æ‰¿"><a href="#ç»§æ‰¿" class="headerlink" title="ç»§æ‰¿"></a>ç»§æ‰¿</h1><b>åœ¨ C# ä¸­ï¼Œç»§æ‰¿æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼Œå®ƒå…è®¸ä¸€ä¸ªç±»ï¼ˆå­ç±»æˆ–æ´¾ç”Ÿç±»ï¼‰ç»§æ‰¿å¦ä¸€ä¸ªç±»ï¼ˆçˆ¶ç±»æˆ–åŸºç±»ï¼‰çš„å±æ€§å’Œæ–¹æ³•ï¼Œä»è€Œå®ç°ä»£ç çš„å¤ç”¨å’Œæ‰©å±•ã€‚ä»¥ä¸‹ä»å¤šä¸ªæ–¹é¢è¯¦ç»†ä»‹ç» C# ä¸­çš„ç»§æ‰¿ï¼š<h2 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h2><p>ç»§æ‰¿å»ºç«‹äº†ç±»ä¸ç±»ä¹‹é—´çš„ä¸€ç§ â€œis - aâ€ å…³ç³»ï¼Œå³å­ç±»æ˜¯çˆ¶ç±»çš„ä¸€ç§ç‰¹æ®Šç±»å‹ã€‚é€šè¿‡ç»§æ‰¿ï¼Œå­ç±»å¯ä»¥æ‹¥æœ‰çˆ¶ç±»çš„æˆå‘˜ï¼ˆå­—æ®µã€å±æ€§ã€æ–¹æ³•ç­‰ï¼‰ï¼Œå¹¶ä¸”å¯ä»¥æ·»åŠ è‡ªå·±ç‰¹æœ‰çš„æˆå‘˜æˆ–é‡å†™çˆ¶ç±»çš„æˆå‘˜ä»¥å®ç°ä¸åŒçš„è¡Œä¸ºã€‚</p><p>è¯­æ³•ç¤ºä¾‹</p><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç»§æ‰¿ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•å®šä¹‰çˆ¶ç±»å’Œå­ç±»ï¼š</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªçˆ¶ç±» Animal</span></span><br><span class="line"><span class="keyword">class</span> <span class="title">Animal</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Animal</span>(<span class="params"><span class="built_in">string</span> name</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Eat</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;<span class="subst">&#123;Name&#125;</span> is eating.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªå­ç±» Dogï¼Œç»§æ‰¿è‡ª Animal</span></span><br><span class="line"><span class="keyword">class</span> <span class="title">Dog</span> : <span class="title">Animal</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Dog</span>(<span class="params"><span class="built_in">string</span> name</span>) : <span class="title">base</span>(<span class="params">name</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Bark</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;<span class="subst">&#123;Name&#125;</span> is barking.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Dog dog = <span class="keyword">new</span> Dog(<span class="string">&quot;Buddy&quot;</span>);</span><br><span class="line">        dog.Eat(); </span><br><span class="line">        dog.Bark(); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><b>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼š</p><blockquote><p>Animal æ˜¯çˆ¶ç±»ï¼ŒåŒ…å«ä¸€ä¸ªå±æ€§ Name å’Œä¸€ä¸ªæ–¹æ³• Eatã€‚<br>Dog æ˜¯å­ç±»ï¼Œä½¿ç”¨ : ç¬¦å·è¡¨ç¤ºç»§æ‰¿è‡ª Animal ç±»ã€‚å­ç±» Dog ä¸ä»…ç»§æ‰¿äº†çˆ¶ç±»çš„ Name å±æ€§å’Œ Eat æ–¹æ³•ï¼Œè¿˜æ·»åŠ äº†è‡ªå·±ç‰¹æœ‰çš„æ–¹æ³• Barkã€‚<br>åœ¨ Dog ç±»çš„æ„é€ å‡½æ•°ä¸­ï¼Œä½¿ç”¨ base(name) è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°æ¥åˆå§‹åŒ–ä»çˆ¶ç±»ç»§æ‰¿çš„å±æ€§ã€‚</b></p></blockquote><h2 id="ç»§æ‰¿çš„ç‰¹æ€§"><a href="#ç»§æ‰¿çš„ç‰¹æ€§" class="headerlink" title="ç»§æ‰¿çš„ç‰¹æ€§"></a>ç»§æ‰¿çš„ç‰¹æ€§</h2><h3 id="å•ç»§æ‰¿"><a href="#å•ç»§æ‰¿" class="headerlink" title="å•ç»§æ‰¿"></a>å•ç»§æ‰¿</h3><p><b>C# åªæ”¯æŒå•ç»§æ‰¿ï¼Œå³ä¸€ä¸ªç±»åªèƒ½ç›´æ¥ç»§æ‰¿è‡ªä¸€ä¸ªçˆ¶ç±»ã€‚ä½†å¯ä»¥é€šè¿‡æ¥å£å®ç°å¤šç»§æ‰¿çš„æ•ˆæœï¼Œä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ã€‚ä¾‹å¦‚ï¼š</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¥å£å®šä¹‰</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title">ICanFly</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Fly</span>()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title">ICanSwim</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Swim</span>()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç±»å®ç°å¤šä¸ªæ¥å£</span></span><br><span class="line"><span class="keyword">class</span> <span class="title">Duck</span> : <span class="title">ICanFly</span>, <span class="title">ICanSwim</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Fly</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;The duck is flying.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Swim</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;The duck is swimming.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è®¿é—®ä¿®é¥°ç¬¦ä¸ç»§æ‰¿"><a href="#è®¿é—®ä¿®é¥°ç¬¦ä¸ç»§æ‰¿" class="headerlink" title="è®¿é—®ä¿®é¥°ç¬¦ä¸ç»§æ‰¿"></a>è®¿é—®ä¿®é¥°ç¬¦ä¸ç»§æ‰¿</h2><p><b>çˆ¶ç±»çš„ public æˆå‘˜å¯ä»¥åœ¨å­ç±»ä¸­ç›´æ¥è®¿é—®ã€‚<br>çˆ¶ç±»çš„ protected æˆå‘˜åªèƒ½åœ¨çˆ¶ç±»æœ¬èº«ã€å­ç±»å’ŒåŒä¸€ä¸ªç¨‹åºé›†å†…çš„å…¶ä»–ç±»ä¸­è®¿é—®ã€‚ä¾‹å¦‚ï¼š</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Parent</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="built_in">int</span> protectedField = <span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Child</span> : <span class="title">Parent</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">PrintProtectedField</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(protectedField); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>çˆ¶ç±»çš„ private æˆå‘˜ä¸èƒ½è¢«å­ç±»ç›´æ¥è®¿é—®ã€‚</p></blockquote><h2 id="æ–¹æ³•é‡å†™ï¼ˆOverrideï¼‰"><a href="#æ–¹æ³•é‡å†™ï¼ˆOverrideï¼‰" class="headerlink" title="æ–¹æ³•é‡å†™ï¼ˆOverrideï¼‰"></a>æ–¹æ³•é‡å†™ï¼ˆOverrideï¼‰</h2><p><b>å­ç±»å¯ä»¥é‡å†™çˆ¶ç±»çš„è™šæ–¹æ³•ï¼ˆä½¿ç”¨ virtual å…³é”®å­—ä¿®é¥°çš„æ–¹æ³•ï¼‰ï¼Œä»¥å®ç°ä¸åŒçš„è¡Œä¸ºã€‚é‡å†™æ—¶éœ€è¦ä½¿ç”¨ override å…³é”®å­—ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Shape</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Draw</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Drawing a shape.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Circle</span> : <span class="title">Shape</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Draw</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Drawing a circle.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»§æ‰¿çš„ä¼˜ç‚¹</p><p>ä»£ç å¤ç”¨ï¼šé¿å…äº†é‡å¤ç¼–å†™ç›¸åŒçš„ä»£ç ï¼Œæé«˜äº†å¼€å‘æ•ˆç‡ã€‚ä¾‹å¦‚ï¼Œå¤šä¸ªä¸åŒç±»å‹çš„åŠ¨ç‰©ç±»éƒ½å¯ä»¥ç»§æ‰¿è‡ª Animal ç±»ï¼Œå¤ç”¨ Eat æ–¹æ³•ã€‚</p><p>å¯ç»´æŠ¤æ€§ï¼šå¦‚æœéœ€è¦ä¿®æ”¹çˆ¶ç±»çš„æŸä¸ªé€šç”¨åŠŸèƒ½ï¼Œåªéœ€è¦åœ¨çˆ¶ç±»ä¸­ä¿®æ”¹ä¸€æ¬¡ï¼Œæ‰€æœ‰å­ç±»éƒ½ä¼šå—åˆ°å½±å“ï¼Œå‡å°‘äº†ä»£ç çš„ç»´æŠ¤æˆæœ¬ã€‚</p><p>æ‰©å±•æ€§ï¼šå­ç±»å¯ä»¥åœ¨ç»§æ‰¿çˆ¶ç±»çš„åŸºç¡€ä¸Šæ·»åŠ æ–°çš„åŠŸèƒ½ï¼Œå®ç°å¯¹ç°æœ‰ä»£ç çš„æ‰©å±•ã€‚</b></p><br><h1 id="baseå…³é”®å­—"><a href="#baseå…³é”®å­—" class="headerlink" title="baseå…³é”®å­—"></a>baseå…³é”®å­—</h1><h2 id="è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°"><a href="#è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°" class="headerlink" title="è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°"></a>è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°</h2><p><code>åœ¨å­ç±»çš„æ„é€ å‡½æ•°ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ base å…³é”®å­—æ¥è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œä»¥å®Œæˆçˆ¶ç±»æˆå‘˜çš„åˆå§‹åŒ–ã€‚è¿™åœ¨å­ç±»éœ€è¦ç»§æ‰¿çˆ¶ç±»çš„æŸäº›åˆå§‹åŒ–é€»è¾‘æ—¶éå¸¸æœ‰ç”¨ã€‚</code></p><p><b>ç¤ºä¾‹ä»£ç </b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰çˆ¶ç±»</span></span><br><span class="line"><span class="keyword">class</span> <span class="title">Person</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="built_in">string</span> name;</span><br><span class="line">    <span class="keyword">protected</span> <span class="built_in">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// çˆ¶ç±»çš„æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span>(<span class="params"><span class="built_in">string</span> name, <span class="built_in">int</span> age</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰å­ç±»</span></span><br><span class="line"><span class="keyword">class</span> <span class="title">Student</span> : <span class="title">Person</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span> studentId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å­ç±»çš„æ„é€ å‡½æ•°ï¼Œä½¿ç”¨ base è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Student</span>(<span class="params"><span class="built_in">string</span> name, <span class="built_in">int</span> age, <span class="built_in">string</span> studentId</span>) : <span class="title">base</span>(<span class="params">name, age</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.studentId = studentId;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨ Student ç±»çš„æ„é€ å‡½æ•°ä¸­ï¼Œbase(name, age) è°ƒç”¨äº†çˆ¶ç±» Person çš„æ„é€ å‡½æ•°ï¼Œå°† name å’Œ age å‚æ•°ä¼ é€’ç»™çˆ¶ç±»æ„é€ å‡½æ•°è¿›è¡Œåˆå§‹åŒ–ã€‚è¿™æ ·å¯ä»¥é¿å…åœ¨å­ç±»ä¸­é‡å¤ç¼–å†™çˆ¶ç±»æˆå‘˜çš„åˆå§‹åŒ–ä»£ç ã€‚</p></blockquote><h2 id="è®¿é—®çˆ¶ç±»çš„æ–¹æ³•å’Œå±æ€§"><a href="#è®¿é—®çˆ¶ç±»çš„æ–¹æ³•å’Œå±æ€§" class="headerlink" title="è®¿é—®çˆ¶ç±»çš„æ–¹æ³•å’Œå±æ€§"></a>è®¿é—®çˆ¶ç±»çš„æ–¹æ³•å’Œå±æ€§</h2><p><code>å½“å­ç±»ä¸­é‡å†™äº†çˆ¶ç±»çš„æ–¹æ³•æˆ–å±æ€§æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ base å…³é”®å­—æ¥è®¿é—®çˆ¶ç±»çš„åŸå§‹å®ç°ã€‚</code></p><p><b>ç¤ºä¾‹ä»£ç </b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰çˆ¶ç±»</span></span><br><span class="line"><span class="keyword">class</span> <span class="title">Shape</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Draw</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Drawing a shape.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰å­ç±»</span></span><br><span class="line"><span class="keyword">class</span> <span class="title">Circle</span> : <span class="title">Shape</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Draw</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨ base è°ƒç”¨çˆ¶ç±»çš„ Draw æ–¹æ³•</span></span><br><span class="line">        <span class="keyword">base</span>.Draw();</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Drawing a circle.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨ Circle ç±»ä¸­é‡å†™äº† Draw æ–¹æ³•ã€‚é€šè¿‡ base.Draw()ï¼Œå¯ä»¥å…ˆè°ƒç”¨çˆ¶ç±» Shape çš„ Draw æ–¹æ³•ï¼Œç„¶åå†æ‰§è¡Œå­ç±»ç‰¹æœ‰çš„ç»˜åˆ¶é€»è¾‘ã€‚è¿™ä½¿å¾—å­ç±»å¯ä»¥åœ¨çˆ¶ç±»çš„åŸºç¡€ä¸Šè¿›è¡ŒåŠŸèƒ½æ‰©å±•ã€‚</p></blockquote><h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><p><b>è®¿é—®æƒé™ï¼šbase åªèƒ½è®¿é—®çˆ¶ç±»ä¸­å¯è®¿é—®çš„æˆå‘˜ã€‚å³çˆ¶ç±»çš„ public å’Œ protected æˆå‘˜å¯ä»¥é€šè¿‡ base è®¿é—®ï¼Œè€Œ private æˆå‘˜ä¸èƒ½é€šè¿‡ base è®¿é—®ã€‚<br>è°ƒç”¨æ—¶æœºï¼šåœ¨å­ç±»æ„é€ å‡½æ•°ä¸­ä½¿ç”¨ base è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°æ—¶ï¼Œbase è¯­å¥å¿…é¡»æ˜¯æ„é€ å‡½æ•°ä¸­çš„ç¬¬ä¸€æ¡è¯­å¥ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>base å…³é”®å­—ä¸ºå­ç±»æä¾›äº†ä¸€ç§æ–¹ä¾¿çš„æ–¹å¼æ¥ä¸çˆ¶ç±»è¿›è¡Œäº¤äº’ã€‚å®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨å­ç±»ä¸­å¤ç”¨çˆ¶ç±»çš„æ„é€ é€»è¾‘ï¼Œå¹¶ä¸”åœ¨é‡å†™æ–¹æ³•æ—¶èƒ½å¤Ÿè®¿é—®çˆ¶ç±»çš„åŸå§‹å®ç°ï¼Œä»è€Œå®ç°ä»£ç çš„å¤ç”¨å’ŒåŠŸèƒ½çš„æ‰©å±•ã€‚</b></p>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Visual Studio 2022 </tag>
            
            <tag> é¢å‘å¯¹è±¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Csharp å †æ ˆå’Œé™æ€ç±»å‹</title>
      <link href="/2025/01/27/cshrap%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/csharp%E5%A0%86%E6%A0%88%E5%92%8C%E9%9D%99%E6%80%81%E7%B1%BB%E5%9E%8B/"/>
      <url>/2025/01/27/cshrap%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/csharp%E5%A0%86%E6%A0%88%E5%92%8C%E9%9D%99%E6%80%81%E7%B1%BB%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="å †æ ˆå’Œé™æ€å‚¨åŒº"><a href="#å †æ ˆå’Œé™æ€å‚¨åŒº" class="headerlink" title="å †æ ˆå’Œé™æ€å‚¨åŒº"></a>å †æ ˆå’Œé™æ€å‚¨åŒº</h1><h2 id="å€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹"><a href="#å€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹" class="headerlink" title="å€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹"></a>å€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹</h2><h3 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a><b>æ¦‚å¿µ</b></h3><li><b>å€¼ç±»å‹ï¼š</b></li><blockquote><p>å€¼ç±»å‹å˜é‡ç›´æ¥åŒ…å«å®ƒä»¬çš„æ•°æ®ã€‚å½“ä½ å£°æ˜ä¸€ä¸ªå€¼ç±»å‹å˜é‡æ—¶ï¼Œè¿™ä¸ªå˜é‡æœ¬èº«å­˜å‚¨äº†å®é™…çš„å€¼ã€‚ä¾‹å¦‚ï¼ŒC# ä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆå¦‚intã€doubleã€boolç­‰ï¼‰éƒ½æ˜¯å€¼ç±»å‹ã€‚å¦‚æœæœ‰ä¸€ä¸ªintå˜é‡num &#x3D; 5;ï¼Œå˜é‡numå­˜å‚¨çš„å°±æ˜¯æ•°å­—5è¿™ä¸ªå€¼ã€‚å€¼ç±»å‹åœ¨å†…å­˜ä¸­çš„å­˜å‚¨ç›¸å¯¹ç®€å•ï¼Œé€šå¸¸å­˜å‚¨åœ¨æ ˆï¼ˆStackï¼‰ä¸Šã€‚</p></blockquote><li><b>å¼•ç”¨ç±»å‹ï¼š</b></li><blockquote><p>å¼•ç”¨ç±»å‹å˜é‡å­˜å‚¨çš„æ˜¯ä¸€ä¸ªå¼•ç”¨ï¼Œè¿™ä¸ªå¼•ç”¨æŒ‡å‘å­˜å‚¨æ•°æ®çš„å®é™…å†…å­˜ä½ç½®ï¼ˆé€šå¸¸æ˜¯å † - Heapï¼‰ã€‚ä¾‹å¦‚ï¼Œåœ¨ C# ä¸­ï¼Œç±»ï¼ˆClassï¼‰ã€æ¥å£ï¼ˆInterfaceï¼‰ã€å§”æ‰˜ï¼ˆDelegateï¼‰ç­‰éƒ½æ˜¯å¼•ç”¨ç±»å‹ã€‚å½“ä½ åˆ›å»ºä¸€ä¸ªç±»çš„å¯¹è±¡æ—¶ï¼Œä¾‹å¦‚MyClass myObj &#x3D; new MyClass();ï¼Œå˜é‡myObjå­˜å‚¨çš„æ˜¯æŒ‡å‘MyClasså¯¹è±¡åœ¨å †å†…å­˜ä¸­å®é™…å­˜å‚¨ä½ç½®çš„å¼•ç”¨ã€‚</p></blockquote><h3 id="å†…å­˜åˆ†é…å’Œç®¡ç†"><a href="#å†…å­˜åˆ†é…å’Œç®¡ç†" class="headerlink" title="å†…å­˜åˆ†é…å’Œç®¡ç†"></a><b>å†…å­˜åˆ†é…å’Œç®¡ç†</b></h3><li><b>å€¼ç±»å‹ï¼š</b></li><p><code>å¦‚å‰é¢æåˆ°çš„ï¼Œå€¼ç±»å‹ä¸€èˆ¬å­˜å‚¨åœ¨æ ˆä¸Šã€‚å½“ä¸€ä¸ªå€¼ç±»å‹å˜é‡è¿›å…¥ä½œç”¨åŸŸï¼ˆä¾‹å¦‚åœ¨ä¸€ä¸ªæ–¹æ³•å†…éƒ¨å£°æ˜ï¼‰æ—¶ï¼Œå®ƒä¼šåœ¨æ ˆä¸Šåˆ†é…å†…å­˜ï¼Œå½“å˜é‡ç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼Œå…¶å ç”¨çš„æ ˆå†…å­˜ä¼šè¢«è‡ªåŠ¨é‡Šæ”¾ã€‚ä¾‹å¦‚ï¼š</code></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span> num1 = <span class="number">10</span>;</span><br><span class="line">        <span class="built_in">int</span> num2 = num1;</span><br><span class="line">        num2 = <span class="number">20</span>;</span><br><span class="line">        Console.WriteLine(num1); </span><br><span class="line">        <span class="comment">// è¾“å‡º10ï¼Œå› ä¸ºnum1å’Œnum2æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„å€¼ç±»å‹å˜é‡ï¼Œnum2çš„ä¿®æ”¹ä¸å½±å“num1</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œnum1å’Œnum2éƒ½æ˜¯intå€¼ç±»å‹å˜é‡ï¼Œå®ƒä»¬åœ¨æ ˆä¸Šæœ‰å„è‡ªç‹¬ç«‹çš„å­˜å‚¨ç©ºé—´ã€‚å½“num2è¢«èµ‹å€¼ä¸º20æ—¶ï¼Œnum1çš„å€¼ä¸å—å½±å“ã€‚</p></blockquote><li><b>å¼•ç”¨ç±»å‹ï¼š</b></li><p><code>å¼•ç”¨ç±»å‹çš„å¯¹è±¡æœ¬èº«å­˜å‚¨åœ¨å †ä¸­ï¼Œè€Œå¼•ç”¨å˜é‡å­˜å‚¨åœ¨æ ˆä¸Šã€‚å½“ä½ åˆ›å»ºä¸€ä¸ªå¼•ç”¨ç±»å‹çš„å¯¹è±¡æ—¶ï¼Œä¼šåœ¨å †ä¸­åˆ†é…å†…å­˜æ¥å­˜å‚¨å¯¹è±¡çš„æ•°æ®ï¼ŒåŒæ—¶åœ¨æ ˆä¸Šåˆ›å»ºä¸€ä¸ªå¼•ç”¨å˜é‡æ¥æŒ‡å‘å †ä¸­çš„å¯¹è±¡ã€‚ä¾‹å¦‚ï¼š</code></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">MyClass</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Value;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        MyClass obj1 = <span class="keyword">new</span> MyClass();</span><br><span class="line">        obj1.Value = <span class="number">10</span>;</span><br><span class="line">        MyClass obj2 = obj1;</span><br><span class="line">        obj2.Value = <span class="number">20</span>;</span><br><span class="line">        Console.WriteLine(obj1.Value); </span><br><span class="line">        <span class="comment">// è¾“å‡º20ï¼Œå› ä¸ºobj1å’Œobj2æŒ‡å‘åŒä¸€ä¸ªå †ä¸­çš„å¯¹è±¡ï¼Œä¿®æ”¹obj2ä¼šå½±å“obj1</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨è¿™é‡Œï¼Œobj1å’Œobj2æ˜¯å¼•ç”¨å˜é‡ï¼Œå®ƒä»¬æŒ‡å‘åŒä¸€ä¸ªMyClasså¯¹è±¡åœ¨å †ä¸­çš„å­˜å‚¨ä½ç½®ã€‚å½“é€šè¿‡obj2ä¿®æ”¹Valueå±æ€§æ—¶ï¼Œobj1æ‰€æŒ‡å‘çš„å¯¹è±¡çš„å±æ€§ä¹Ÿè¢«ä¿®æ”¹äº†ï¼Œå› ä¸ºå®ƒä»¬å¼•ç”¨çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚</p></blockquote><h3 id="å‚æ•°ä¼ é€’"><a href="#å‚æ•°ä¼ é€’" class="headerlink" title="å‚æ•°ä¼ é€’"></a><b>å‚æ•°ä¼ é€’</b></h3><li><b>å€¼ç±»å‹ï¼š</b></li><p><code>å½“ä¸€ä¸ªå€¼ç±»å‹å˜é‡ä½œä¸ºå‚æ•°ä¼ é€’ç»™ä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œå®é™…ä¸Šæ˜¯å°†å˜é‡çš„å€¼å¤åˆ¶ä¸€ä»½ä¼ é€’ç»™æ–¹æ³•ã€‚æ–¹æ³•å†…éƒ¨å¯¹å‚æ•°çš„ä¿®æ”¹ä¸ä¼šå½±å“åŸå§‹å˜é‡çš„å€¼ã€‚ä¾‹å¦‚ï¼š</code></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ModifyValue</span>(<span class="params"><span class="built_in">int</span> num</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        num = <span class="number">20</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span> originalNum = <span class="number">10</span>;</span><br><span class="line">        ModifyValue(originalNum);</span><br><span class="line">        Console.WriteLine(originalNum); </span><br><span class="line">        <span class="comment">// è¾“å‡º10ï¼Œå› ä¸ºåœ¨ModifyValueæ–¹æ³•ä¸­ä¿®æ”¹çš„æ˜¯å¤åˆ¶åçš„numï¼Œè€Œä¸æ˜¯originalNum</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><li><b>å¼•ç”¨ç±»å‹ï¼š</b></li><p><code>å½“ä¸€ä¸ªå¼•ç”¨ç±»å‹å˜é‡ä½œä¸ºå‚æ•°ä¼ é€’ç»™ä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œä¼ é€’çš„æ˜¯å¼•ç”¨çš„å‰¯æœ¬ã€‚è¿™æ„å‘³ç€æ–¹æ³•å†…éƒ¨å¯ä»¥é€šè¿‡è¿™ä¸ªå¼•ç”¨è®¿é—®å’Œä¿®æ”¹åŸå§‹å¯¹è±¡ã€‚ä¾‹å¦‚ï¼š</code></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">MyClass</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Value;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ModifyObject</span>(<span class="params">MyClass obj</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        obj.Value = <span class="number">20</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">        MyClass originalObj = <span class="keyword">new</span> MyClass();</span><br><span class="line">        originalObj.Value = <span class="number">10</span>;</span><br><span class="line">        ModifyObject(originalObj);</span><br><span class="line">        Console.WriteLine(originalObj.Value); </span><br><span class="line">        <span class="comment">// è¾“å‡º20ï¼Œå› ä¸ºåœ¨ModifyObjectæ–¹æ³•ä¸­é€šè¿‡å¼•ç”¨ä¿®æ”¹äº†originalObjæŒ‡å‘çš„å¯¹è±¡çš„å€¼</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ€§èƒ½å·®å¼‚"><a href="#æ€§èƒ½å·®å¼‚" class="headerlink" title="æ€§èƒ½å·®å¼‚"></a><b>æ€§èƒ½å·®å¼‚</b></h3><li><b>å€¼ç±»å‹ï¼š</b></li><blockquote><p>ç”±äºå€¼ç±»å‹æ•°æ®å­˜å‚¨åœ¨æ ˆä¸Šï¼Œè®¿é—®é€Ÿåº¦é€šå¸¸æ¯”è¾ƒå¿«ã€‚è€Œä¸”å€¼ç±»å‹çš„å†…å­˜ç®¡ç†ç›¸å¯¹ç®€å•ï¼Œåœ¨å˜é‡ç¦»å¼€ä½œç”¨åŸŸæ—¶è‡ªåŠ¨é‡Šæ”¾å†…å­˜ï¼Œä¸éœ€è¦åƒå¼•ç”¨ç±»å‹é‚£æ ·è¿›è¡Œå¤æ‚çš„åƒåœ¾å›æ”¶ï¼ˆGarbage Collectionï¼‰æ“ä½œã€‚</p></blockquote><li><b>å¼•ç”¨ç±»å‹ï¼š</b></li><blockquote><p>å¼•ç”¨ç±»å‹çš„å­˜å‚¨å’Œè®¿é—®æ¶‰åŠåˆ°å †å’Œæ ˆçš„äº¤äº’ã€‚ä»æ ˆä¸Šçš„å¼•ç”¨å˜é‡è®¿é—®å †ä¸­çš„å¯¹è±¡å¯èƒ½ä¼šç¨å¾®æ…¢ä¸€äº›ã€‚å¹¶ä¸”ï¼Œå¼•ç”¨ç±»å‹å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸç”±åƒåœ¾å›æ”¶æœºåˆ¶ç®¡ç†ï¼Œå½“å¯¹è±¡ä¸å†è¢«å¼•ç”¨æ—¶ï¼Œåƒåœ¾å›æ”¶å™¨ä¼šåœ¨åˆé€‚çš„æ—¶é—´å›æ”¶å¯¹è±¡å ç”¨çš„å †å†…å­˜ï¼Œè¿™ä¸ªè¿‡ç¨‹å¯èƒ½ä¼šå¸¦æ¥ä¸€å®šçš„æ€§èƒ½å¼€é”€ã€‚ä¸è¿‡ï¼Œå¼•ç”¨ç±»å‹çš„çµæ´»æ€§ä½¿å¾—å®ƒä»¬åœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­éå¸¸é‡è¦ï¼Œä¾‹å¦‚ç”¨äºå®ç°å¤æ‚çš„æ•°æ®ç»“æ„å’Œå¯¹è±¡ä¹‹é—´çš„å…³ç³»ã€‚</p></blockquote><br><h1 id="æ ˆå†…å­˜"><a href="#æ ˆå†…å­˜" class="headerlink" title="æ ˆå†…å­˜"></a>æ ˆå†…å­˜</h1><h2 id="æ ˆçš„åŸºæœ¬æ¦‚å¿µ"><a href="#æ ˆçš„åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="æ ˆçš„åŸºæœ¬æ¦‚å¿µ"></a>æ ˆçš„åŸºæœ¬æ¦‚å¿µ</h2><blockquote><p>åœ¨ C# ä¸­ï¼Œæ ˆï¼ˆStackï¼‰æ˜¯ä¸€ç§ç”¨äºå­˜å‚¨æ•°æ®çš„æ•°æ®ç»“æ„ï¼Œå®ƒä¸»è¦ç”¨äºå­˜å‚¨æ–¹æ³•ï¼ˆå‡½æ•°ï¼‰è°ƒç”¨çš„ç›¸å…³ä¿¡æ¯ï¼ŒåŒ…æ‹¬å±€éƒ¨å˜é‡ã€æ–¹æ³•å‚æ•°ã€è¿”å›åœ°å€ç­‰ã€‚æ ˆçš„æ“ä½œéµå¾ª â€œåè¿›å…ˆå‡ºâ€ï¼ˆLIFO - Last In First Outï¼‰åŸåˆ™ï¼Œå°±åƒä¸€æ‘ç›˜å­ï¼Œæœ€åæ”¾ä¸Šå»çš„ç›˜å­æœ€å…ˆè¢«æ‹¿ä¸‹æ¥ã€‚</p></blockquote><blockquote><p>æ ˆåœ¨å†…å­˜ä¸­æœ‰ä¸€ä¸ªå›ºå®šçš„å¤§å°ï¼ˆè¿™ä¸ªå¤§å°ç”±æ“ä½œç³»ç»Ÿå’Œç¼–è¯‘å™¨ç­‰å› ç´ å†³å®šï¼‰ï¼Œå¹¶ä¸”æ˜¯è‡ªåŠ¨ç®¡ç†å†…å­˜çš„ã€‚å½“ä¸€ä¸ªæ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œç³»ç»Ÿä¼šåœ¨æ ˆä¸Šä¸ºè¿™ä¸ªæ–¹æ³•åˆ†é…ä¸€å—å†…å­˜åŒºåŸŸï¼Œç”¨äºå­˜å‚¨è¯¥æ–¹æ³•æ‰€éœ€çš„ä¿¡æ¯ã€‚å½“æ–¹æ³•æ‰§è¡Œç»“æŸåï¼Œè¿™å—å†…å­˜åŒºåŸŸä¼šè¢«è‡ªåŠ¨é‡Šæ”¾ï¼Œæ ˆé¡¶æŒ‡é’ˆä¼šç›¸åº”åœ°è°ƒæ•´ï¼Œä½¿å¾—æ ˆæ¢å¤åˆ°ä¹‹å‰çš„çŠ¶æ€ã€‚</p></blockquote><h2 id="æ ˆåœ¨å†…å­˜ä¸­çš„å­˜å‚¨æ–¹å¼"><a href="#æ ˆåœ¨å†…å­˜ä¸­çš„å­˜å‚¨æ–¹å¼" class="headerlink" title="æ ˆåœ¨å†…å­˜ä¸­çš„å­˜å‚¨æ–¹å¼"></a>æ ˆåœ¨å†…å­˜ä¸­çš„å­˜å‚¨æ–¹å¼</h2><blockquote><p>æ ˆé€šå¸¸å­˜å‚¨åœ¨å†…å­˜çš„è¾ƒé«˜åœ°å€åŒºåŸŸã€‚å®ƒçš„å†…å­˜å¸ƒå±€æ˜¯ä»é«˜åœ°å€å‘ä½åœ°å€å¢é•¿çš„ã€‚ä¾‹å¦‚ï¼Œå½“ä¸€ä¸ªæ–°çš„æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œæ–°çš„æ ˆå¸§ï¼ˆStack Frameï¼‰ä¼šåœ¨æ ˆé¡¶åˆ›å»ºã€‚æ ˆå¸§åŒ…å«äº†è¿™ä¸ªæ–¹æ³•çš„æ‰€æœ‰å±€éƒ¨å˜é‡å’Œè°ƒç”¨ä¿¡æ¯ã€‚</p></blockquote><blockquote><p>å‡è®¾ä¸€ä¸ªç®€å•çš„ C# ç¨‹åºï¼Œåœ¨Mainæ–¹æ³•ä¸­è°ƒç”¨äº†å¦ä¸€ä¸ªæ–¹æ³•SomeMethodï¼Œå½“SomeMethodè¢«è°ƒç”¨æ—¶ï¼Œä¸€ä¸ªæ–°çš„æ ˆå¸§ä¼šåœ¨æ ˆé¡¶è¢«åˆ›å»ºï¼Œç”¨äºå­˜å‚¨SomeMethodçš„å±€éƒ¨å˜é‡å’Œå…¶ä»–ç›¸å…³ä¿¡æ¯ã€‚å½“SomeMethodæ‰§è¡Œå®Œæ¯•ï¼Œè¿™ä¸ªæ ˆå¸§ä¼šè¢«é”€æ¯ï¼Œæ ˆé¡¶æŒ‡é’ˆä¼šå›åˆ°Mainæ–¹æ³•æ ˆå¸§çš„ä½ç½®ã€‚</p></blockquote><h2 id="æ ˆåœ¨æ–¹æ³•è°ƒç”¨ä¸­çš„ä½œç”¨"><a href="#æ ˆåœ¨æ–¹æ³•è°ƒç”¨ä¸­çš„ä½œç”¨" class="headerlink" title="æ ˆåœ¨æ–¹æ³•è°ƒç”¨ä¸­çš„ä½œç”¨"></a>æ ˆåœ¨æ–¹æ³•è°ƒç”¨ä¸­çš„ä½œç”¨</h2><h3 id="å‚æ•°ä¼ é€’ï¼š"><a href="#å‚æ•°ä¼ é€’ï¼š" class="headerlink" title="å‚æ•°ä¼ é€’ï¼š"></a>å‚æ•°ä¼ é€’ï¼š</h3><blockquote><p>å½“ä¸€ä¸ªæ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œæ–¹æ³•çš„å‚æ•°ä¼šè¢«å‹å…¥æ ˆä¸­ã€‚ä¾‹å¦‚ï¼Œå¯¹äºä¸€ä¸ªæ–¹æ³•void MyMethod(int a, int b)ï¼Œå½“è°ƒç”¨MyMethod(3, 5)æ—¶ï¼Œå€¼3å’Œ5ä¼šæŒ‰ç…§ä»å³åˆ°å·¦çš„é¡ºåºï¼ˆåœ¨ C# ä¸­ä¸€èˆ¬æ˜¯è¿™ä¸ªé¡ºåºï¼‰è¢«å‹å…¥æ ˆä¸­ã€‚è¿™æ˜¯å› ä¸ºåœ¨æ–¹æ³•å†…éƒ¨ï¼Œå‚æ•°çš„è®¿é—®é€šå¸¸æ˜¯ä»å·¦åˆ°å³çš„ï¼Œå…ˆå‹å…¥bçš„å€¼5ï¼Œå†å‹å…¥açš„å€¼3ï¼Œè¿™æ ·åœ¨æ–¹æ³•å†…éƒ¨å°±å¯ä»¥æŒ‰ç…§æ­£ç¡®çš„é¡ºåºè®¿é—®å‚æ•°ã€‚</p></blockquote><h3 id="å±€éƒ¨å˜é‡å­˜å‚¨ï¼š"><a href="#å±€éƒ¨å˜é‡å­˜å‚¨ï¼š" class="headerlink" title="å±€éƒ¨å˜é‡å­˜å‚¨ï¼š"></a>å±€éƒ¨å˜é‡å­˜å‚¨ï¼š</h3><blockquote><p>æ–¹æ³•å†…éƒ¨çš„å±€éƒ¨å˜é‡ä¹Ÿå­˜å‚¨åœ¨æ ˆä¸­ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªæ–¹æ³•void AnotherMethod()ä¸­æœ‰ä¸€ä¸ªå±€éƒ¨å˜é‡int localVar &#x3D; 10ï¼Œè¿™ä¸ªlocalVarå˜é‡ä¼šåœ¨AnotherMethodçš„æ ˆå¸§ä¸­åˆ†é…ä¸€ä¸ªå­˜å‚¨ä½ç½®ï¼Œç”¨äºå­˜æ”¾å€¼10ã€‚</p></blockquote><h3 id="è¿”å›åœ°å€å­˜å‚¨ï¼š"><a href="#è¿”å›åœ°å€å­˜å‚¨ï¼š" class="headerlink" title="è¿”å›åœ°å€å­˜å‚¨ï¼š"></a>è¿”å›åœ°å€å­˜å‚¨ï¼š</h3><blockquote><p>å½“ä¸€ä¸ªæ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œè°ƒç”¨è¯¥æ–¹æ³•çš„æŒ‡ä»¤çš„ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ï¼ˆå³è¿”å›åœ°å€ï¼‰ä¼šè¢«å­˜å‚¨åœ¨æ ˆä¸­ã€‚è¿™æ ·ï¼Œå½“è¢«è°ƒç”¨çš„æ–¹æ³•æ‰§è¡Œå®Œæ¯•åï¼Œç³»ç»Ÿå¯ä»¥æ ¹æ®è¿™ä¸ªè¿”å›åœ°å€å›åˆ°è°ƒç”¨è€…ç»§ç»­æ‰§è¡Œåé¢çš„æŒ‡ä»¤ã€‚ä¾‹å¦‚ï¼Œåœ¨Mainæ–¹æ³•ä¸­è°ƒç”¨SomeFunctionï¼Œå½“SomeFunctionè¢«è°ƒç”¨æ—¶ï¼ŒMainæ–¹æ³•ä¸­è°ƒç”¨SomeFunctionæŒ‡ä»¤çš„ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ä¼šè¢«å­˜å‚¨åœ¨æ ˆä¸­ï¼Œå½“SomeFunctionæ‰§è¡Œç»“æŸåï¼Œç¨‹åºä¼šæ ¹æ®è¿™ä¸ªåœ°å€å›åˆ°Mainæ–¹æ³•ç»§ç»­æ‰§è¡Œã€‚</p></blockquote><h3 id="è®¿é—®é€Ÿåº¦ï¼š"><a href="#è®¿é—®é€Ÿåº¦ï¼š" class="headerlink" title="è®¿é—®é€Ÿåº¦ï¼š"></a>è®¿é—®é€Ÿåº¦ï¼š</h3><blockquote><p>ä¸€èˆ¬æ¥è¯´ï¼Œæ ˆçš„è®¿é—®é€Ÿåº¦ç›¸å¯¹è¾ƒå¿«ã€‚å› ä¸ºæ ˆçš„å†…å­˜å¸ƒå±€æ¯”è¾ƒè§„æ•´ï¼Œè€Œä¸”ä¸éœ€è¦åƒå †é‚£æ ·è¿›è¡Œå¤æ‚çš„å†…å­˜ç®¡ç†æ“ä½œï¼ˆå¦‚åƒåœ¾å›æ”¶ï¼‰æ¥æŸ¥æ‰¾å’Œé‡Šæ”¾å†…å­˜ã€‚æ•°æ®åœ¨æ ˆä¸Šçš„å­˜å‚¨å’Œè®¿é—®æ¯”è¾ƒç›´æ¥ï¼Œè€Œå †ä¸­çš„å¯¹è±¡å¯èƒ½å› ä¸ºåƒåœ¾å›æ”¶ç­‰æ“ä½œè€Œå¯¼è‡´å­˜å‚¨ä½ç½®å‘ç”Ÿå˜åŒ–ï¼Œä»è€Œå½±å“è®¿é—®é€Ÿåº¦ã€‚</p></blockquote><br><h1 id="å †å†…å­˜"><a href="#å †å†…å­˜" class="headerlink" title="å †å†…å­˜"></a>å †å†…å­˜</h1><p><code>åœ¨ C# ä¸­ï¼Œå †ï¼ˆHeapï¼‰æ˜¯ç”¨äºåŠ¨æ€å†…å­˜åˆ†é…çš„é‡è¦å†…å­˜åŒºåŸŸï¼Œä¸»è¦ç”¨äºå­˜å‚¨å¼•ç”¨ç±»å‹çš„å¯¹è±¡ã€‚ä¸‹é¢å°†ä»å †çš„åŸºæœ¬æ¦‚å¿µã€å †å†…å­˜åˆ†é…ã€åƒåœ¾å›æ”¶æœºåˆ¶ã€å †ä¸æ ˆçš„å¯¹æ¯”ç­‰æ–¹é¢è¯¦ç»†ä»‹ç»ã€‚</code></p><h2 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h2><blockquote><p>å †æ˜¯ä¸€å—è¾ƒå¤§çš„å†…å­˜åŒºåŸŸï¼Œå®ƒä¸æ ˆä¸åŒï¼Œæ ˆä¸»è¦ç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡å’Œæ–¹æ³•è°ƒç”¨ä¿¡æ¯ï¼Œéµå¾ªåè¿›å…ˆå‡ºï¼ˆLIFOï¼‰åŸåˆ™ã€‚è€Œå †ç”¨äºå­˜å‚¨å¼•ç”¨ç±»å‹çš„å¯¹è±¡ï¼Œå…¶å†…å­˜åˆ†é…å’Œé‡Šæ”¾ç”±åƒåœ¾å›æ”¶å™¨ï¼ˆGarbage Collectorï¼ŒGCï¼‰è´Ÿè´£ç®¡ç†ï¼Œä¸éµå¾ª LIFO åŸåˆ™ã€‚</p></blockquote><h2 id="å †å†…å­˜åˆ†é…"><a href="#å †å†…å­˜åˆ†é…" class="headerlink" title="å †å†…å­˜åˆ†é…"></a>å †å†…å­˜åˆ†é…</h2><p><code>å½“ä½¿ç”¨ new å…³é”®å­—åˆ›å»ºä¸€ä¸ªå¼•ç”¨ç±»å‹çš„å¯¹è±¡æ—¶ï¼Œç³»ç»Ÿä¼šåœ¨å †ä¸Šä¸ºè¯¥å¯¹è±¡åˆ†é…å†…å­˜ã€‚ä¾‹å¦‚ï¼š</code></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Person</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// åœ¨å †ä¸Šåˆ›å»ºä¸€ä¸ª Person å¯¹è±¡</span></span><br><span class="line">        Person person = <span class="keyword">new</span> Person();</span><br><span class="line">        person.Name = <span class="string">&quot;Alice&quot;</span>;</span><br><span class="line">        person.Age = <span class="number">25</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œnew Person() è¯­å¥ä¼šåœ¨å †ä¸Šåˆ†é…ä¸€å—å†…å­˜ï¼Œç”¨äºå­˜å‚¨ Person å¯¹è±¡çš„ Name å’Œ Age å­—æ®µã€‚åŒæ—¶ï¼Œæ ˆä¸Šçš„ person å˜é‡å­˜å‚¨çš„æ˜¯æŒ‡å‘å †ä¸Šè¯¥ Person å¯¹è±¡çš„å¼•ç”¨ã€‚</p></blockquote><h2 id="åƒåœ¾å›æ”¶æœºåˆ¶"><a href="#åƒåœ¾å›æ”¶æœºåˆ¶" class="headerlink" title="åƒåœ¾å›æ”¶æœºåˆ¶"></a>åƒåœ¾å›æ”¶æœºåˆ¶</h2><p><code>åƒåœ¾å›æ”¶å™¨ï¼ˆGCï¼‰è´Ÿè´£è‡ªåŠ¨å›æ”¶å †ä¸Šä¸å†è¢«å¼•ç”¨çš„å¯¹è±¡æ‰€å ç”¨çš„å†…å­˜ã€‚å…¶ä¸»è¦å·¥ä½œæµç¨‹å¦‚ä¸‹ï¼š<br>æ ‡è®°é˜¶æ®µï¼šGC ä¼šä»æ ¹å¯¹è±¡ï¼ˆå¦‚å…¨å±€å˜é‡ã€é™æ€å˜é‡ã€å½“å‰æ‰§è¡Œæ ˆä¸­çš„å˜é‡ç­‰ï¼‰å¼€å§‹éå†æ‰€æœ‰å¯è¾¾çš„å¯¹è±¡ï¼Œå¹¶å°†è¿™äº›å¯¹è±¡æ ‡è®°ä¸º â€œå­˜æ´»â€ã€‚<br>æ¸…é™¤é˜¶æ®µï¼šæœªè¢«æ ‡è®°ä¸º â€œå­˜æ´»â€ çš„å¯¹è±¡è¢«è§†ä¸ºåƒåœ¾å¯¹è±¡ï¼ŒGC ä¼šå›æ”¶è¿™äº›å¯¹è±¡æ‰€å ç”¨çš„å†…å­˜ã€‚<br>å‹ç¼©é˜¶æ®µï¼šä¸ºäº†å‡å°‘å†…å­˜ç¢ç‰‡ï¼ŒGC å¯èƒ½ä¼šå¯¹å †ä¸Šçš„å­˜æ´»å¯¹è±¡è¿›è¡Œç§»åŠ¨å’Œæ•´ç†ï¼Œä½¿å®ƒä»¬åœ¨å†…å­˜ä¸­è¿ç»­å­˜å‚¨ã€‚</code></p><li><b>ä¾‹å¦‚ï¼š</b></li>    <figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">MyClass</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        MyClass obj1 = <span class="keyword">new</span> MyClass();</span><br><span class="line">        obj1.Value = <span class="number">10</span>;</span><br><span class="line">        <span class="comment">// ç°åœ¨ obj1 æŒ‡å‘ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼ŒåŸæ¥çš„å¯¹è±¡ä¸å†è¢«å¼•ç”¨</span></span><br><span class="line">        obj1 = <span class="keyword">new</span> MyClass();</span><br><span class="line">        obj1.Value = <span class="number">20</span>;</span><br><span class="line">        <span class="comment">// ä¹‹å‰åˆ›å»ºçš„ç¬¬ä¸€ä¸ª MyClass å¯¹è±¡æˆä¸ºäº†åƒåœ¾ï¼Œç­‰å¾…åƒåœ¾å›æ”¶</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åƒåœ¾å›æ”¶å™¨ä¼šåœ¨åˆé€‚çš„æ—¶æœºï¼ˆå¦‚å †ç©ºé—´ä¸è¶³ã€æ‰‹åŠ¨è§¦å‘ç­‰ï¼‰å¯¹è¿™äº›åƒåœ¾å¯¹è±¡è¿›è¡Œå›æ”¶ã€‚</p></blockquote><h2 id="å †ä¸æ ˆçš„å¯¹æ¯”"><a href="#å †ä¸æ ˆçš„å¯¹æ¯”" class="headerlink" title="å †ä¸æ ˆçš„å¯¹æ¯”"></a>å †ä¸æ ˆçš„å¯¹æ¯”</h2><table>    <tr>        <th>å¯¹æ¯”é¡¹</th>        <th>å †</th>        <th>æ ˆ</th>    </tr>    <tr>        <td>å­˜å‚¨å†…å®¹</td>        <td>å¼•ç”¨ç±»å‹çš„å¯¹è±¡</td>        <td>å€¼ç±»å‹çš„å˜é‡ã€æ–¹æ³•è°ƒç”¨ä¿¡æ¯ï¼ˆå¦‚å±€éƒ¨å˜é‡ã€è¿”å›åœ°å€ç­‰ï¼‰</td>    </tr>    <tr>        <td>å†…å­˜ç®¡ç†</td>        <td>ç”±åƒåœ¾å›æ”¶å™¨è‡ªåŠ¨ç®¡ç†</td>        <td>è‡ªåŠ¨åˆ†é…å’Œé‡Šæ”¾ï¼Œæ–¹æ³•æ‰§è¡Œç»“æŸåï¼Œæ ˆä¸Šçš„å†…å­˜è‡ªåŠ¨å›æ”¶</td>    </tr>    <tr>    <td>åˆ†é…å’Œè®¿é—®é€Ÿåº¦</td>    <td>ç›¸å¯¹è¾ƒæ…¢ï¼Œå› ä¸ºæ¶‰åŠå¤æ‚çš„å†…å­˜ç®¡ç†å’Œå¯¹è±¡æŸ¥æ‰¾</td>    <td>ç›¸å¯¹è¾ƒå¿«ï¼Œå†…å­˜åˆ†é…å’Œé‡Šæ”¾ç®€å•ç›´æ¥</td>    </tr>    <tr>        <td>å†…å­˜å¸ƒå±€</td>        <td>ä¸éµå¾ªç‰¹å®šé¡ºåºï¼Œå¯èƒ½ä¼šäº§ç”Ÿå†…å­˜ç¢ç‰‡</td>        <td>éµå¾ªåè¿›å…ˆå‡ºï¼ˆLIFOï¼‰åŸåˆ™ï¼Œå†…å­˜å¸ƒå±€è¾ƒä¸ºè§„æ•´</td>    </tr>    </table>        <h2 id="å †çš„æ€§èƒ½å½±å“å› ç´ "><a href="#å †çš„æ€§èƒ½å½±å“å› ç´ " class="headerlink" title="å †çš„æ€§èƒ½å½±å“å› ç´ "></a>å †çš„æ€§èƒ½å½±å“å› ç´ </h2><blockquote><p>è±¡åˆ›å»ºé¢‘ç‡ï¼šé¢‘ç¹åˆ›å»ºå’Œé”€æ¯å¯¹è±¡ä¼šå¢åŠ åƒåœ¾å›æ”¶çš„è´Ÿæ‹…ï¼Œå½±å“æ€§èƒ½ã€‚å¯ä»¥è€ƒè™‘å¯¹è±¡æ± æŠ€æœ¯æ¥å¤ç”¨å¯¹è±¡ï¼Œå‡å°‘å¯¹è±¡åˆ›å»ºå’Œé”€æ¯çš„æ¬¡æ•°ã€‚<br>å¤§å¯¹è±¡åˆ†é…ï¼šå¤§å¯¹è±¡ï¼ˆå¦‚å¤§å‹æ•°ç»„ï¼‰ä¼šè¢«åˆ†é…åˆ°ç‰¹æ®Šçš„å¤§å¯¹è±¡å †ï¼ˆLOHï¼‰ä¸­ï¼Œå¤§å¯¹è±¡å †çš„åƒåœ¾å›æ”¶æœºåˆ¶ä¸æ™®é€šå †ä¸åŒï¼Œé¢‘ç¹åˆ†é…å¤§å¯¹è±¡å¯èƒ½ä¼šå¯¼è‡´å†…å­˜ç¢ç‰‡åŒ–å’Œæ€§èƒ½é—®é¢˜ã€‚<br>åƒåœ¾å›æ”¶ç­–ç•¥ï¼šä¸åŒçš„åƒåœ¾å›æ”¶æ¨¡å¼ï¼ˆå¦‚å·¥ä½œç«™æ¨¡å¼ã€æœåŠ¡å™¨æ¨¡å¼ï¼‰é€‚ç”¨äºä¸åŒçš„åº”ç”¨åœºæ™¯ï¼Œé€‰æ‹©åˆé€‚çš„åƒåœ¾å›æ”¶æ¨¡å¼å¯ä»¥æé«˜æ€§èƒ½ã€‚<br>ç»¼ä¸Šæ‰€è¿°ï¼Œäº†è§£ C# ä¸­å †çš„å·¥ä½œåŸç†å’Œç‰¹ç‚¹ï¼Œæœ‰åŠ©äºç¼–å†™é«˜æ•ˆã€ç¨³å®šçš„ä»£ç ã€‚</p></blockquote><br><h1 id="é™æ€ç±»å‹"><a href="#é™æ€ç±»å‹" class="headerlink" title="é™æ€ç±»å‹"></a>é™æ€ç±»å‹</h1><p><code>C# ä¸­ï¼Œé™æ€ç±»å‹æ˜¯ä¸€ä¸ªé‡è¦çš„æ¦‚å¿µï¼Œå®ƒè´¯ç©¿äºè¯­è¨€çš„å¤šä¸ªæ–¹é¢ï¼Œä¸‹é¢ä»é™æ€ç±»å‹çš„å®šä¹‰ã€é™æ€æˆå‘˜ã€é™æ€ç±»ä»¥åŠé™æ€ç±»å‹æ£€æŸ¥å‡ ä¸ªæ–¹é¢è¯¦ç»†ä»‹ç»ï¼š</code></p><h2 id="é™æ€ç±»å‹çš„å®šä¹‰"><a href="#é™æ€ç±»å‹çš„å®šä¹‰" class="headerlink" title="é™æ€ç±»å‹çš„å®šä¹‰"></a>é™æ€ç±»å‹çš„å®šä¹‰</h2><p><code>é™æ€ç±»å‹æŒ‡çš„æ˜¯åœ¨ç¼–è¯‘æ—¶å°±ç¡®å®šå˜é‡ã€è¡¨è¾¾å¼æˆ–å‚æ•°çš„ç±»å‹ã€‚åœ¨ C# é‡Œï¼Œå½“ä½ å£°æ˜ä¸€ä¸ªå˜é‡æ—¶ï¼Œå¿…é¡»æ˜ç¡®æŒ‡å®šå®ƒçš„ç±»å‹ï¼Œç¼–è¯‘å™¨ä¼šåœ¨ç¼–è¯‘é˜¶æ®µè¿›è¡Œç±»å‹æ£€æŸ¥ï¼Œç¡®ä¿ä»£ç ä¸­æ‰€æœ‰æ“ä½œéƒ½ç¬¦åˆè¯¥ç±»å‹çš„å®šä¹‰ã€‚</code></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å£°æ˜ä¸€ä¸ª int ç±»å‹çš„å˜é‡</span></span><br><span class="line"><span class="built_in">int</span> number = <span class="number">10</span>;</span><br><span class="line"><span class="comment">// å£°æ˜ä¸€ä¸ª string ç±»å‹çš„å˜é‡</span></span><br><span class="line"><span class="built_in">string</span> message = <span class="string">&quot;Hello, World!&quot;</span>;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œnumber è¢«æ˜ç¡®æŒ‡å®šä¸º int ç±»å‹ï¼Œmessage è¢«æŒ‡å®šä¸º string ç±»å‹ï¼Œç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶ä¼šæ ¹æ®è¿™äº›ç±»å‹ä¿¡æ¯æ¥éªŒè¯å¯¹å®ƒä»¬çš„æ“ä½œæ˜¯å¦åˆæ³•ã€‚ä¾‹å¦‚ï¼Œä¸èƒ½ç›´æ¥å°†ä¸€ä¸ªå­—ç¬¦ä¸²èµ‹å€¼ç»™ int ç±»å‹çš„å˜é‡ï¼Œå¦åˆ™ä¼šäº§ç”Ÿç¼–è¯‘é”™è¯¯ã€‚</p></blockquote><h2 id="é™æ€æˆå‘˜"><a href="#é™æ€æˆå‘˜" class="headerlink" title="é™æ€æˆå‘˜"></a>é™æ€æˆå‘˜</h2><h3 id="é™æ€å­—æ®µ"><a href="#é™æ€å­—æ®µ" class="headerlink" title="é™æ€å­—æ®µ"></a><b>é™æ€å­—æ®µ</b></h3><p><code>é™æ€å­—æ®µå±äºç±»æœ¬èº«ï¼Œè€Œä¸æ˜¯ç±»çš„å®ä¾‹ã€‚æ— è®ºåˆ›å»ºå¤šå°‘ä¸ªç±»çš„å®ä¾‹ï¼Œé™æ€å­—æ®µåœ¨å†…å­˜ä¸­åªæœ‰ä¸€ä»½å‰¯æœ¬ã€‚å¯ä»¥é€šè¿‡ç±»åç›´æ¥è®¿é—®é™æ€å­—æ®µã€‚</code></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">MyClass</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// é™æ€å­—æ®µ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> StaticField = <span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// é€šè¿‡ç±»åè®¿é—®é™æ€å­—æ®µ</span></span><br><span class="line">        Console.WriteLine(MyClass.StaticField); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é™æ€æ–¹æ³•"><a href="#é™æ€æ–¹æ³•" class="headerlink" title="é™æ€æ–¹æ³•"></a><b>é™æ€æ–¹æ³•</b></h3><p><code>é™æ€æ–¹æ³•åŒæ ·å±äºç±»æœ¬èº«ï¼Œä¸èƒ½é€šè¿‡ç±»çš„å®ä¾‹æ¥è°ƒç”¨ï¼Œåªèƒ½é€šè¿‡ç±»åè°ƒç”¨ã€‚é™æ€æ–¹æ³•åªèƒ½ç›´æ¥è®¿é—®ç±»çš„é™æ€æˆå‘˜ï¼Œä¸èƒ½ç›´æ¥è®¿é—®å®ä¾‹æˆå‘˜ã€‚</code></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Calculator</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// é™æ€æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">Add</span>(<span class="params"><span class="built_in">int</span> a, <span class="built_in">int</span> b</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> a + b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// é€šè¿‡ç±»åè°ƒç”¨é™æ€æ–¹æ³•</span></span><br><span class="line">        <span class="built_in">int</span> result = Calculator.Add(<span class="number">3</span>, <span class="number">5</span>);</span><br><span class="line">        Console.WriteLine(result); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é™æ€å±æ€§"><a href="#é™æ€å±æ€§" class="headerlink" title="é™æ€å±æ€§"></a><b>é™æ€å±æ€§</b></h3><p><code>é™æ€å±æ€§å’Œé™æ€å­—æ®µç±»ä¼¼ï¼Œä¹Ÿæ˜¯å±äºç±»æœ¬èº«ã€‚å¯ä»¥é€šè¿‡ç±»åæ¥è®¿é—®é™æ€å±æ€§ï¼Œå¹¶ä¸”å¯ä»¥åœ¨å±æ€§çš„è®¿é—®å™¨ä¸­æ·»åŠ è‡ªå®šä¹‰çš„é€»è¾‘ã€‚</code></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Counter</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é™æ€å±æ€§</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> Count</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123; <span class="keyword">return</span> count; &#125;</span><br><span class="line">        <span class="keyword">set</span> &#123; count = <span class="keyword">value</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// é€šè¿‡ç±»åè®¿é—®é™æ€å±æ€§</span></span><br><span class="line">        Counter.Count = <span class="number">5</span>;</span><br><span class="line">        Console.WriteLine(Counter.Count); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é™æ€ç±»"><a href="#é™æ€ç±»" class="headerlink" title="é™æ€ç±»"></a>é™æ€ç±»</h2><p><code>é™æ€ç±»æ˜¯ä¸€ç§ç‰¹æ®Šçš„ç±»ï¼Œå®ƒåªèƒ½åŒ…å«é™æ€æˆå‘˜ï¼Œä¸èƒ½è¢«å®ä¾‹åŒ–ã€‚é™æ€ç±»å¸¸ç”¨äºåˆ›å»ºå·¥å…·ç±»ï¼Œæä¾›ä¸€ç»„ç›¸å…³çš„é™æ€æ–¹æ³•å’Œå±æ€§ã€‚</code></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é™æ€ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">MathUtils</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// é™æ€æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">double</span> <span class="title">Square</span>(<span class="params"><span class="built_in">double</span> num</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> num * num;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é™æ€å±æ€§</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">double</span> Pi &#123; <span class="keyword">get</span> &#123; <span class="keyword">return</span> <span class="number">3.14159</span>; &#125; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// é€šè¿‡ç±»åè°ƒç”¨é™æ€æ–¹æ³•</span></span><br><span class="line">        <span class="built_in">double</span> result = MathUtils.Square(<span class="number">4</span>);</span><br><span class="line">        Console.WriteLine(result); </span><br><span class="line"></span><br><span class="line">        <span class="comment">// é€šè¿‡ç±»åè®¿é—®é™æ€å±æ€§</span></span><br><span class="line">        Console.WriteLine(MathUtils.Pi); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é™æ€ç±»å‹æ£€æŸ¥"><a href="#é™æ€ç±»å‹æ£€æŸ¥" class="headerlink" title="é™æ€ç±»å‹æ£€æŸ¥"></a>é™æ€ç±»å‹æ£€æŸ¥</h2><p><code>é™æ€ç±»å‹æ£€æŸ¥æ˜¯ C# ç¼–è¯‘å™¨åœ¨ç¼–è¯‘é˜¶æ®µè¿›è¡Œçš„ä¸€é¡¹é‡è¦å·¥ä½œã€‚å®ƒä¼šæ£€æŸ¥ä»£ç ä¸­å˜é‡çš„ä½¿ç”¨æ˜¯å¦ç¬¦åˆå…¶å£°æ˜çš„ç±»å‹ï¼Œç¡®ä¿ç±»å‹å®‰å…¨ã€‚ä¾‹å¦‚ï¼š</code></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> num = <span class="number">10</span>;</span><br><span class="line"><span class="comment">// ä¸‹é¢è¿™è¡Œä»£ç ä¼šäº§ç”Ÿç¼–è¯‘é”™è¯¯ï¼Œå› ä¸ºä¸èƒ½å°† int ç±»å‹èµ‹å€¼ç»™ string ç±»å‹çš„å˜é‡</span></span><br><span class="line"><span class="comment">// string str = num; </span></span><br></pre></td></tr></table></figure><blockquote><p>ç¼–è¯‘å™¨ä¼šåœ¨ç¼–è¯‘æ—¶å‘ç°ä¸Šè¿°ä»£ç çš„ç±»å‹ä¸åŒ¹é…é—®é¢˜ï¼Œå¹¶ç»™å‡ºç›¸åº”çš„é”™è¯¯ä¿¡æ¯ï¼Œä»è€Œé¿å…åœ¨è¿è¡Œæ—¶å‡ºç°ç±»å‹ç›¸å…³çš„å¼‚å¸¸ã€‚è¿™ç§é™æ€ç±»å‹æ£€æŸ¥æœºåˆ¶æœ‰åŠ©äºæé«˜ä»£ç çš„å¯é æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Visual Studio 2022 </tag>
            
            <tag> é¢å‘å¯¹è±¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Csharp åŒ¿åç±»å‹</title>
      <link href="/2025/01/27/cshrap%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/csharp%E5%8C%BF%E5%90%8D%E7%B1%BB%E5%9E%8B/"/>
      <url>/2025/01/27/cshrap%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/csharp%E5%8C%BF%E5%90%8D%E7%B1%BB%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="åŒ¿åç±»å‹"><a href="#åŒ¿åç±»å‹" class="headerlink" title="åŒ¿åç±»å‹"></a>åŒ¿åç±»å‹</h1><h2 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h2><p><code>åœ¨ C# ä¸­ï¼ŒåŒ¿åç±»å‹æ˜¯ä¸€ç§å¯ä»¥åœ¨ä¸å®šä¹‰å…·ä½“ç±»å‹ï¼ˆå¦‚ç±»ï¼‰çš„æƒ…å†µä¸‹åˆ›å»ºå¯¹è±¡çš„æ–¹å¼ã€‚åŒ¿åç±»å‹æä¾›äº†ä¸€ç§ä¾¿æ·çš„æ–¹æ³•æ¥å°è£…ä¸€ç»„åªè¯»å±æ€§ï¼Œé€šå¸¸ç”¨äºä¸´æ—¶çš„æ•°æ®å­˜å‚¨å’Œä¼ é€’ã€‚</code></p><p><b>åŒ¿åç±»å‹çš„å®ä¾‹æ˜¯ç”±ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆçš„ç±»å‹ï¼Œå…¶ç±»å‹åå¯¹äºå¼€å‘è€…æ˜¯ä¸å¯è§çš„ã€‚ä¾‹å¦‚ï¼š</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = <span class="keyword">new</span> &#123; Name = <span class="string">&quot;John&quot;</span>, Age = <span class="number">30</span> &#125;;</span><br></pre></td></tr></table></figure><blockquote><p>è¿™é‡Œåˆ›å»ºäº†ä¸€ä¸ªåŒ¿åç±»å‹çš„å¯¹è±¡personï¼Œå®ƒæœ‰ä¸¤ä¸ªå±æ€§Nameå’ŒAgeã€‚varå…³é”®å­—è®©ç¼–è¯‘å™¨æ ¹æ®åˆå§‹åŒ–è¡¨è¾¾å¼æ¥æ¨æ–­å˜é‡<br>çš„ç±»å‹ã€‚</p></blockquote><p><b>å±æ€§è®¿é—®</b></p><p><b>å¯ä»¥é€šè¿‡å¯¹è±¡å®ä¾‹æ¥è®¿é—®å…¶å±æ€§ã€‚ä¾‹å¦‚ï¼Œå¯¹äºä¸Šé¢çš„personå¯¹è±¡ï¼Œå¯ä»¥è¿™æ ·è®¿é—®å±æ€§ï¼š</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Console.WriteLine(person.Name); </span><br><span class="line">Console.WriteLine(person.Age);</span><br></pre></td></tr></table></figure><p><b>ç”±äºåŒ¿åç±»å‹çš„å±æ€§æ˜¯åªè¯»çš„ï¼Œä¸èƒ½å¯¹å…¶è¿›è¡Œé‡æ–°èµ‹å€¼ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢çš„ä»£ç æ˜¯é”™è¯¯çš„ï¼š</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">person.Name = <span class="string">&quot;Jane&quot;</span>; <span class="comment">// ç¼–è¯‘é”™è¯¯ï¼Œå› ä¸ºåŒ¿åç±»å‹çš„å±æ€§æ˜¯åªè¯»çš„</span></span><br></pre></td></tr></table></figure><h2 id="ç”¨é€”"><a href="#ç”¨é€”" class="headerlink" title="ç”¨é€”"></a>ç”¨é€”</h2><p><code>LINQ æŸ¥è¯¢ç»“æœçš„ä¸´æ—¶å­˜å‚¨ï¼šåœ¨ LINQï¼ˆLanguage - Integrated Queryï¼‰ä¸­ï¼Œç»å¸¸ä¼šä½¿ç”¨åŒ¿åç±»å‹æ¥å­˜å‚¨æŸ¥è¯¢ç»“æœã€‚ä¾‹å¦‚ï¼Œå‡è®¾æœ‰ä¸€ä¸ªList&lt;int&gt;ç±»å‹çš„åˆ—è¡¨numbersï¼Œè¦è·å–å…¶ä¸­æ¯ä¸ªæ•°å­—çš„å¹³æ–¹å’Œç«‹æ–¹å¹¶å­˜å‚¨ä¸ºä¸€ä¸ªæ–°çš„å¯¹è±¡é›†åˆï¼Œå¯ä»¥è¿™æ ·åšï¼š</code></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> result = <span class="keyword">from</span> n <span class="keyword">in</span> numbers</span><br><span class="line">             <span class="keyword">select</span> <span class="keyword">new</span> &#123; Square = n * n, Cube = n * n * n &#125;;</span><br></pre></td></tr></table></figure><blockquote><p>è¿™é‡Œresultæ˜¯ä¸€ä¸ªåŒ…å«åŒ¿åç±»å‹å¯¹è±¡çš„é›†åˆï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æœ‰Squareå’ŒCubeä¸¤ä¸ªå±æ€§ï¼Œåˆ†åˆ«å­˜å‚¨æ•°å­—çš„å¹³æ–¹å’Œç«‹æ–¹ã€‚</p></blockquote><p><code>ä½œä¸ºæ–¹æ³•è¿”å›å€¼çš„ä¸´æ—¶ç±»å‹ï¼šå½“éœ€è¦ä»ä¸€ä¸ªæ–¹æ³•è¿”å›ä¸€ç»„ç®€å•çš„æ•°æ®ï¼Œä½†åˆä¸æƒ³ä¸“é—¨ä¸ºæ­¤å®šä¹‰ä¸€ä¸ªç±»æ—¶ï¼Œå¯ä»¥ä½¿ç”¨åŒ¿åç±»å‹ã€‚ä¾‹å¦‚ï¼š</code></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">object</span> <span class="title">GetData</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> &#123; Message = <span class="string">&quot;Success&quot;</span>, StatusCode = <span class="number">200</span> &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è°ƒç”¨GetDataæ–¹æ³•æ—¶ï¼Œä¼šè¿”å›ä¸€ä¸ªåŒ¿åç±»å‹çš„å¯¹è±¡ï¼ŒåŒ…å«Messageå’ŒStatusCodeä¸¤ä¸ªå±æ€§ã€‚</p></blockquote><h2 id="åŒ¿åç±»å‹çš„é™åˆ¶"><a href="#åŒ¿åç±»å‹çš„é™åˆ¶" class="headerlink" title="åŒ¿åç±»å‹çš„é™åˆ¶"></a>åŒ¿åç±»å‹çš„é™åˆ¶</h2><p><code>ä¸èƒ½è·¨æ–¹æ³•å…±äº«ï¼šå› ä¸ºåŒ¿åç±»å‹æ˜¯ç”±ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶ç”Ÿæˆçš„ä¸´æ—¶ç±»å‹ï¼Œå…¶ç±»å‹å®šä¹‰åªåœ¨å®šä¹‰å®ƒçš„æ–¹æ³•å†…éƒ¨æœ‰æ•ˆã€‚å¦‚æœè¦åœ¨å¤šä¸ªæ–¹æ³•ä¹‹é—´ä¼ é€’æ•°æ®ï¼Œæœ€å¥½ä½¿ç”¨è‡ªå®šä¹‰çš„ç±»æˆ–ç»“æ„ã€‚</code></p><p><code>ç¼ºå°‘ç±»å‹åç§°ï¼šç”±äºæ²¡æœ‰æ˜ç¡®çš„ç±»å‹åç§°ï¼Œä¸èƒ½å°†åŒ¿åç±»å‹ç”¨ä½œæ–¹æ³•å‚æ•°çš„ç±»å‹å£°æ˜ï¼ˆé™¤éä½¿ç”¨objectç­‰æ›´é€šç”¨çš„ç±»å‹æ¥æ¥æ”¶ï¼‰ï¼Œä¹Ÿä¸èƒ½ç”¨äºç»§æ‰¿ç­‰é¢å‘å¯¹è±¡çš„é«˜çº§ç‰¹æ€§ã€‚ä¾‹å¦‚ï¼Œä¸èƒ½è¿™æ ·å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼š</code></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ProcessData</span>(<span class="params"><span class="keyword">new</span> &#123; Name = <span class="string">&quot;&quot;</span>, Age = <span class="number">0</span> &#125;</span>) <span class="comment">// ç¼–è¯‘é”™è¯¯ï¼Œä¸èƒ½ä½¿ç”¨åŒ¿åç±»å‹ä½œä¸ºå‚æ•°ç±»å‹</span></span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// æ–¹æ³•ä½“</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Visual Studio 2022 </tag>
            
            <tag> é¢å‘å¯¹è±¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Csharp æ„é€ å‡½æ•°çš„ä½¿ç”¨ï¼Œthiså…³é”®å­—</title>
      <link href="/2025/01/27/cshrap%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/csharp%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E7%9A%84%E4%BD%BF%E7%94%A8%EF%BC%8Cthis%E5%85%B3%E9%94%AE%E5%AD%97/"/>
      <url>/2025/01/27/cshrap%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/csharp%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E7%9A%84%E4%BD%BF%E7%94%A8%EF%BC%8Cthis%E5%85%B3%E9%94%AE%E5%AD%97/</url>
      
        <content type="html"><![CDATA[<h1 id="æ„é€ å‡½æ•°"><a href="#æ„é€ å‡½æ•°" class="headerlink" title="æ„é€ å‡½æ•°"></a>æ„é€ å‡½æ•°</h1><h2 id="ä»€ä¹ˆæ˜¯æ„é€ å‡½æ•°ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯æ„é€ å‡½æ•°ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯æ„é€ å‡½æ•°ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯æ„é€ å‡½æ•°ï¼Ÿ</h2><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a><b>å®šä¹‰</b></h3><p><code>åœ¨ C# ä¸­ï¼Œæ„é€ å‡½æ•°æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–¹æ³•ï¼Œå®ƒä¸ç±»åŒåï¼Œå¹¶ä¸”æ²¡æœ‰è¿”å›ç±»å‹ï¼ˆç”šè‡³ä¸èƒ½æ˜¯ voidï¼‰ã€‚æ„é€ å‡½æ•°ä¸»è¦ç”¨äºåœ¨åˆ›å»ºç±»çš„å¯¹è±¡æ—¶åˆå§‹åŒ–å¯¹è±¡çš„çŠ¶æ€ã€‚ä¾‹å¦‚ï¼Œå½“ä½ åˆ›å»ºä¸€ä¸ªPersonç±»çš„å¯¹è±¡æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ„é€ å‡½æ•°æ¥åˆå§‹åŒ–Personå¯¹è±¡çš„å§“åã€å¹´é¾„ç­‰å±æ€§ã€‚</code></p><h3 id="é»˜è®¤æ„é€ å‡½æ•°"><a href="#é»˜è®¤æ„é€ å‡½æ•°" class="headerlink" title="é»˜è®¤æ„é€ å‡½æ•°"></a><b>é»˜è®¤æ„é€ å‡½æ•°</b></h3><p><code>å¦‚æœä¸€ä¸ªç±»ä¸­æ²¡æœ‰å®šä¹‰ä»»ä½•æ„é€ å‡½æ•°ï¼ŒC# ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨æä¾›ä¸€ä¸ªé»˜è®¤æ„é€ å‡½æ•°ã€‚è¿™ä¸ªé»˜è®¤æ„é€ å‡½æ•°æ²¡æœ‰å‚æ•°ï¼Œå¹¶ä¸”å®ƒçš„ä½œç”¨æ˜¯åˆå§‹åŒ–å¯¹è±¡çš„æˆå‘˜å˜é‡ä¸ºå®ƒä»¬çš„é»˜è®¤å€¼ï¼ˆä¾‹å¦‚ï¼Œæ•°å€¼ç±»å‹ä¸º 0ï¼Œå¼•ç”¨ç±»å‹ä¸ºnullï¼‰ã€‚</code></p><p><b>ä¾‹å¦‚ï¼š</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">MyClass</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span> myVariable;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        MyClass obj = <span class="keyword">new</span> MyClass();</span><br><span class="line">        <span class="comment">// æ­¤æ—¶obj.myVariableçš„å€¼ä¸º0</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><h3 id="å¸¦å‚æ•°çš„æ„é€ å‡½æ•°"><a href="#å¸¦å‚æ•°çš„æ„é€ å‡½æ•°" class="headerlink" title="å¸¦å‚æ•°çš„æ„é€ å‡½æ•°"></a><b>å¸¦å‚æ•°çš„æ„é€ å‡½æ•°</b></h3><p><code>å¯ä»¥å®šä¹‰å¸¦å‚æ•°çš„æ„é€ å‡½æ•°æ¥æ ¹æ®ä¼ å…¥çš„å‚æ•°åˆå§‹åŒ–å¯¹è±¡çš„å±æ€§ã€‚</code></p><p><b>ä¾‹å¦‚ï¼Œå®šä¹‰ä¸€ä¸ªRectangleç±»æ¥è¡¨ç¤ºçŸ©å½¢ï¼Œæœ‰widthå’Œheightä¸¤ä¸ªå±æ€§ï¼š</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Rectangle</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Width &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Height &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Rectangle</span>(<span class="params"><span class="built_in">int</span> width, <span class="built_in">int</span> height</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Width = width;</span><br><span class="line">        Height = height;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Rectangle rect = <span class="keyword">new</span> Rectangle(<span class="number">5</span>, <span class="number">3</span>);</span><br><span class="line">        <span class="comment">// æ­¤æ—¶rect.Widthçš„å€¼ä¸º5ï¼Œrect.Heightçš„å€¼ä¸º3</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><h3 id="æ„é€ å‡½æ•°çš„é‡è½½"><a href="#æ„é€ å‡½æ•°çš„é‡è½½" class="headerlink" title="æ„é€ å‡½æ•°çš„é‡è½½"></a><b>æ„é€ å‡½æ•°çš„é‡è½½</b></h3><p><code>C# å…è®¸åœ¨ä¸€ä¸ªç±»ä¸­å®šä¹‰å¤šä¸ªæ„é€ å‡½æ•°ï¼Œåªè¦å®ƒä»¬çš„å‚æ•°åˆ—è¡¨ä¸åŒï¼ˆå‚æ•°ä¸ªæ•°ã€å‚æ•°ç±»å‹æˆ–è€…å‚æ•°é¡ºåºä¸åŒï¼‰ã€‚è¿™è¢«ç§°ä¸ºæ„é€ å‡½æ•°çš„é‡è½½ã€‚</code></p><p><b>ä¾‹å¦‚ï¼Œå¯¹äºä¸Šé¢çš„Rectangleç±»ï¼Œå¯ä»¥æ·»åŠ ä¸€ä¸ªé»˜è®¤æ„é€ å‡½æ•°ï¼š</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Rectangle</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Width &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Height &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Rectangle</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Width = <span class="number">0</span>;</span><br><span class="line">        Height = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Rectangle</span>(<span class="params"><span class="built_in">int</span> width, <span class="built_in">int</span> height</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Width = width;</span><br><span class="line">        Height = height;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Rectangle rect1 = <span class="keyword">new</span> Rectangle();</span><br><span class="line">        <span class="comment">// rect1.Widthå’Œrect1.Heightçš„å€¼éƒ½ä¸º0</span></span><br><span class="line">        Rectangle rect2 = <span class="keyword">new</span> Rectangle(<span class="number">5</span>, <span class="number">3</span>);</span><br><span class="line">        <span class="comment">// rect2.Widthçš„å€¼ä¸º5ï¼Œrect2.Heightçš„å€¼ä¸º3</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><h3 id="æ„é€ å‡½æ•°çš„ç»§æ‰¿"><a href="#æ„é€ å‡½æ•°çš„ç»§æ‰¿" class="headerlink" title="æ„é€ å‡½æ•°çš„ç»§æ‰¿"></a><b>æ„é€ å‡½æ•°çš„ç»§æ‰¿</b></h3><p><code>åœ¨æ´¾ç”Ÿç±»ä¸­ï¼Œå¦‚æœæ²¡æœ‰æ˜¾å¼åœ°è°ƒç”¨åŸºç±»çš„æ„é€ å‡½æ•°ï¼Œç¼–è¯‘å™¨ä¼šé»˜è®¤è°ƒç”¨åŸºç±»çš„æ— å‚æ•°æ„é€ å‡½æ•°ã€‚</code></p><p><b>ä¾‹å¦‚ï¼Œæœ‰ä¸€ä¸ªåŸºç±»Shapeå’Œä¸€ä¸ªæ´¾ç”Ÿç±»Circleï¼š</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Shape</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Shape</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Name = <span class="string">&quot;Shape&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">Circle</span> : <span class="title">Shape</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> Radius &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Circle</span>(<span class="params"><span class="built_in">double</span> radius</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Radius = radius;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Circle circle = <span class="keyword">new</span> Circle(<span class="number">2.0</span>);</span><br><span class="line">        <span class="comment">// circle.Nameçš„å€¼ä¸º&quot;Shape&quot;ï¼Œè¿™æ˜¯å› ä¸ºé»˜è®¤è°ƒç”¨äº†åŸºç±»Shapeçš„æ— å‚æ•°æ„é€ å‡½æ•°</span></span><br><span class="line">        <span class="comment">// circle.Radiusçš„å€¼ä¸º2.0</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><blockquote><p>å¦‚æœåŸºç±»æ²¡æœ‰æ— å‚æ•°æ„é€ å‡½æ•°ï¼Œå¹¶ä¸”æ´¾ç”Ÿç±»éœ€è¦è°ƒç”¨åŸºç±»çš„æœ‰å‚æ•°æ„é€ å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨baseå…³é”®å­—åœ¨æ´¾ç”Ÿç±»çš„æ„é€ å‡½æ•°ä¸­æ˜¾å¼åœ°è°ƒç”¨åŸºç±»æ„é€ å‡½æ•°ã€‚</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Shape</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Shape</span>(<span class="params"><span class="built_in">string</span> name</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">Circle</span> : <span class="title">Shape</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> Radius &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Circle</span>(<span class="params"><span class="built_in">double</span> radius</span>) : <span class="title">base</span>(<span class="params"><span class="string">&quot;Circle&quot;</span></span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Radius = radius;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Circle circle = <span class="keyword">new</span> Circle(<span class="number">2.0</span>);</span><br><span class="line">        <span class="comment">// circle.Nameçš„å€¼ä¸º&quot;Circle&quot;ï¼Œé€šè¿‡baseå…³é”®å­—è°ƒç”¨äº†åŸºç±»Shapeçš„æœ‰å‚æ•°æ„é€ å‡½æ•°</span></span><br><span class="line">        <span class="comment">// circle.Radiusçš„å€¼ä¸º2.0</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><hr><h1 id="this-å…³é”®å­—"><a href="#this-å…³é”®å­—" class="headerlink" title="this å…³é”®å­—"></a>this å…³é”®å­—</h1><h2 id="å«ä¹‰å’Œç”¨é€”"><a href="#å«ä¹‰å’Œç”¨é€”" class="headerlink" title="å«ä¹‰å’Œç”¨é€”"></a><b>å«ä¹‰å’Œç”¨é€”</b></h2><p><code>åœ¨ C# ä¸­ï¼Œthisæ˜¯ä¸€ä¸ªå¼•ç”¨å½“å‰ç±»çš„å®ä¾‹çš„å…³é”®å­—ã€‚å®ƒä¸»è¦ç”¨äºåœ¨ç±»çš„å†…éƒ¨åŒºåˆ†æˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡ï¼Œå°¤å…¶æ˜¯å½“å®ƒä»¬åç§°ç›¸åŒæ—¶ã€‚ä¾‹å¦‚ï¼Œå½“ä¸€ä¸ªç±»çš„æ–¹æ³•å‚æ•°ä¸ç±»çš„æˆå‘˜å˜é‡åŒåæ—¶ï¼Œä½¿ç”¨thiså¯ä»¥æ˜ç¡®åœ°å¼•ç”¨æˆå‘˜å˜é‡ã€‚</code></p><p><b>ä¾‹å¦‚ï¼Œæœ‰ä¸€ä¸ªPersonç±»ï¼ŒåŒ…å«nameå±æ€§å’Œä¸€ä¸ªæ–¹æ³•æ¥è®¾ç½®nameå±æ€§ï¼š</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Person</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span> name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SetName</span>(<span class="params"><span class="built_in">string</span> name</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><blockquote><p>åœ¨SetNameæ–¹æ³•ä¸­ï¼Œå‚æ•°nameæ˜¯å±€éƒ¨å˜é‡ï¼Œthis.nameå¼•ç”¨çš„æ˜¯ç±»ä¸­çš„æˆå‘˜å˜é‡nameã€‚å½“è°ƒç”¨SetNameæ–¹æ³•å¹¶ä¼ å…¥ä¸€ä¸ªå­—ç¬¦ä¸²æ—¶ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²ä¼šè¢«èµ‹å€¼ç»™æˆå‘˜å˜é‡nameã€‚</p></blockquote><h3 id="åœ¨æ„é€ å‡½æ•°ä¸­çš„ä½¿ç”¨"><a href="#åœ¨æ„é€ å‡½æ•°ä¸­çš„ä½¿ç”¨" class="headerlink" title="åœ¨æ„é€ å‡½æ•°ä¸­çš„ä½¿ç”¨"></a><b>åœ¨æ„é€ å‡½æ•°ä¸­çš„ä½¿ç”¨</b></h3><p><code>thisä¹Ÿå¸¸ç”¨äºåœ¨ä¸€ä¸ªç±»çš„æ„é€ å‡½æ•°ä¸­è°ƒç”¨å…¶ä»–æ„é€ å‡½æ•°ã€‚è¿™åœ¨æ„é€ å‡½æ•°é‡è½½çš„æƒ…å†µä¸‹å¾ˆæœ‰ç”¨ï¼Œå¯ä»¥é¿å…ä»£ç é‡å¤ã€‚</code></p><p><b>ä¾‹å¦‚ï¼Œå¯¹äºä¸€ä¸ªRectangleç±»ï¼Œæœ‰ä¸¤ä¸ªæ„é€ å‡½æ•°ï¼Œä¸€ä¸ªæ¥æ”¶é•¿å’Œå®½ï¼Œå¦ä¸€ä¸ªåªæ¥æ”¶è¾¹é•¿ï¼ˆç”¨äºåˆ›å»ºæ­£æ–¹å½¢ï¼‰ï¼š</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Rectangle</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">int</span> width;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">int</span> height;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Rectangle</span>(<span class="params"><span class="built_in">int</span> width, <span class="built_in">int</span> height</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>.width = width;</span><br><span class="line">        <span class="keyword">this</span>.height = height;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Rectangle</span>(<span class="params"><span class="built_in">int</span> sideLength</span>) : <span class="title">this</span>(<span class="params">sideLength, sideLength</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><br><blockquote><p>åœ¨ç¬¬äºŒä¸ªæ„é€ å‡½æ•°ä¸­ï¼Œé€šè¿‡this(sideLength, sideLength)è°ƒç”¨äº†ç¬¬ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œè¿™æ ·å°±å¯ä»¥å¤ç”¨è®¾ç½®widthå’Œheightçš„ä»£ç ã€‚</p></blockquote><h3 id="åœ¨é“¾å¼è°ƒç”¨ä¸­çš„åº”ç”¨"><a href="#åœ¨é“¾å¼è°ƒç”¨ä¸­çš„åº”ç”¨" class="headerlink" title="åœ¨é“¾å¼è°ƒç”¨ä¸­çš„åº”ç”¨"></a><b>åœ¨é“¾å¼è°ƒç”¨ä¸­çš„åº”ç”¨</b></h3><p><b>å¯ä»¥åœ¨æ–¹æ³•è¿”å›å½“å‰ç±»çš„å®ä¾‹æ—¶ä½¿ç”¨thisæ¥å®ç°é“¾å¼è°ƒç”¨ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªCalculatorç±»ä¸­ï¼š</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Calculator</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">int</span> result;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Calculator <span class="title">Add</span>(<span class="params"><span class="built_in">int</span> num</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        result += num;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">GetResult</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å¯ä»¥è¿™æ ·ä½¿ç”¨ï¼šCalculator calc &#x3D; new Calculator().Add(5).Add(3).GetResult();ï¼Œè¿™é‡ŒAddæ–¹æ³•è¿”å›thisï¼Œä½¿å¾—å¯ä»¥è¿ç»­è°ƒç”¨Addæ–¹æ³•ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Visual Studio 2022 </tag>
            
            <tag> é¢å‘å¯¹è±¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Csharp publicä¸privateè¯´æ˜ set-getæ–¹æ³•</title>
      <link href="/2025/01/26/cshrap%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/csharp%E7%A7%81%E6%9C%89%E5%92%8C%E5%85%AC%E6%9C%89%E8%AF%B4%E6%98%8E/"/>
      <url>/2025/01/26/cshrap%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/csharp%E7%A7%81%E6%9C%89%E5%92%8C%E5%85%AC%E6%9C%89%E8%AF%B4%E6%98%8E/</url>
      
        <content type="html"><![CDATA[<h1 id="set-getæ–¹æ³•çš„ä½¿ç”¨"><a href="#set-getæ–¹æ³•çš„ä½¿ç”¨" class="headerlink" title="set-getæ–¹æ³•çš„ä½¿ç”¨"></a>set-getæ–¹æ³•çš„ä½¿ç”¨</h1><p><code>åœ¨ C# ä¸­ï¼Œget å’Œ set ä¸»è¦ç”¨äºå®šä¹‰å±æ€§ï¼ˆPropertyï¼‰ï¼Œå±æ€§æ˜¯ä¸€ç§ç”¨äºå°è£…å­—æ®µï¼ˆFieldï¼‰çš„æˆå‘˜ï¼Œå®ƒæä¾›äº†å¯¹å­—æ®µçš„è®¿é—®æ§åˆ¶ï¼Œä½¿å¾—å¯ä»¥æ›´å®‰å…¨ã€æ›´æ–¹ä¾¿åœ°è¯»å–å’Œä¿®æ”¹å­—æ®µçš„å€¼ã€‚ä»¥ä¸‹æ˜¯å…³äº get å’Œ set çš„è¯¦ç»†ä»‹ç»ï¼š</code></p><p><b>1. å±æ€§çš„åŸºæœ¬æ¦‚å¿µ</b></p><blockquote><p>å±æ€§ç»“åˆäº†å­—æ®µå’Œæ–¹æ³•çš„ä¼˜ç‚¹ï¼Œä»å¤–éƒ¨çœ‹å®ƒå°±åƒä¸€ä¸ªå­—æ®µï¼Œå¯ä»¥åƒè®¿é—®å­—æ®µä¸€æ ·è®¿é—®å±æ€§ï¼›ä½†åœ¨å†…éƒ¨ï¼Œå®ƒé€šè¿‡ get å’Œ set è®¿é—®å™¨æ¥æ§åˆ¶å¯¹å­—æ®µçš„è¯»å†™æ“ä½œã€‚</p></blockquote><p><b>2. å®Œæ•´å±æ€§å®šä¹‰ï¼ˆåŒ…å« get å’Œ setï¼‰</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Person</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ç§æœ‰å­—æ®µï¼Œç”¨äºå­˜å‚¨æ•°æ®</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span> _name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å…¬å…±å±æ€§ï¼Œç”¨äºå°è£… _name å­—æ®µ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// get è®¿é—®å™¨ç”¨äºè·å–å±æ€§çš„å€¼</span></span><br><span class="line">            <span class="keyword">return</span> _name;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">set</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// set è®¿é—®å™¨ç”¨äºè®¾ç½®å±æ€§çš„å€¼</span></span><br><span class="line">            <span class="comment">// value æ˜¯ä¸€ä¸ªéšå¼å‚æ•°ï¼Œä»£è¡¨è¦è®¾ç½®çš„å€¼</span></span><br><span class="line">            _name = <span class="keyword">value</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Person person = <span class="keyword">new</span> Person();</span><br><span class="line">        <span class="comment">// è®¾ç½®å±æ€§å€¼ï¼Œè°ƒç”¨ set è®¿é—®å™¨</span></span><br><span class="line">        person.Name = <span class="string">&quot;John&quot;</span>;</span><br><span class="line">        <span class="comment">// è·å–å±æ€§å€¼ï¼Œè°ƒç”¨ get è®¿é—®å™¨</span></span><br><span class="line">        Console.WriteLine(person.Name); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><b>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼š</b></p><blockquote><p>_name æ˜¯ä¸€ä¸ªç§æœ‰å­—æ®µï¼Œç”¨äºå®é™…å­˜å‚¨æ•°æ®ã€‚<br>Name æ˜¯ä¸€ä¸ªå…¬å…±å±æ€§ï¼Œå®ƒå°è£…äº† _name å­—æ®µã€‚<br>get è®¿é—®å™¨ç”¨äºè¿”å› _name å­—æ®µçš„å€¼ï¼Œå½“ä»å¤–éƒ¨è¯»å– Name å±æ€§æ—¶ï¼Œä¼šæ‰§è¡Œ get è®¿é—®å™¨ä¸­çš„ä»£ç ã€‚<br>set è®¿é—®å™¨ç”¨äºè®¾ç½® _name å­—æ®µçš„å€¼ï¼Œå½“ä»å¤–éƒ¨ç»™ Name å±æ€§èµ‹å€¼æ—¶ï¼Œä¼šæ‰§è¡Œ set è®¿é—®å™¨ä¸­çš„ä»£ç ï¼Œvalue æ˜¯ä¸€ä¸ªéšå¼å‚æ•°ï¼Œå®ƒä»£è¡¨è¦è®¾ç½®çš„æ–°å€¼ã€‚</p></blockquote><p><b>3. åªè¯»å±æ€§ï¼ˆåªåŒ…å« get è®¿é—®å™¨ï¼‰</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Circle</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">double</span> _radius;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Circle</span>(<span class="params"><span class="built_in">double</span> radius</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _radius = radius;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åªè¯»å±æ€§ï¼Œåªæœ‰ get è®¿é—®å™¨</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> Area</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> Math.PI * _radius * _radius;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Circle circle = <span class="keyword">new</span> Circle(<span class="number">5</span>);</span><br><span class="line">        <span class="comment">// å¯ä»¥è¯»å– Area å±æ€§çš„å€¼</span></span><br><span class="line">        Console.WriteLine(circle.Area); </span><br><span class="line">        <span class="comment">// ä¸‹é¢è¿™è¡Œä»£ç ä¼šæŠ¥é”™ï¼Œå› ä¸º Area æ˜¯åªè¯»å±æ€§</span></span><br><span class="line">        <span class="comment">// circle.Area = 100; </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒArea å±æ€§åªæœ‰ get è®¿é—®å™¨ï¼Œæ²¡æœ‰ set è®¿é—®å™¨ï¼Œæ‰€ä»¥å®ƒæ˜¯åªè¯»çš„ã€‚å¤–éƒ¨ä»£ç åªèƒ½è¯»å–è¯¥å±æ€§çš„å€¼ï¼Œä¸èƒ½å¯¹å…¶è¿›è¡Œèµ‹å€¼æ“ä½œã€‚</p></blockquote><p><b>4. è‡ªåŠ¨å®ç°å±æ€§ï¼ˆç®€åŒ–å±æ€§å®šä¹‰ï¼‰</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Book</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// è‡ªåŠ¨å®ç°å±æ€§ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªéšè—çš„ç§æœ‰å­—æ®µ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Title &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Author &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Book book = <span class="keyword">new</span> Book();</span><br><span class="line">        book.Title = <span class="string">&quot;C# Programming&quot;</span>;</span><br><span class="line">        book.Author = <span class="string">&quot;John Doe&quot;</span>;</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;Title: <span class="subst">&#123;book.Title&#125;</span>, Author: <span class="subst">&#123;book.Author&#125;</span>&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨è‡ªåŠ¨å®ç°å±æ€§ä¸­ï¼Œä¸éœ€è¦æ˜¾å¼å®šä¹‰ç§æœ‰å­—æ®µï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªéšè—çš„ç§æœ‰å­—æ®µã€‚å¯ä»¥ç›´æ¥ä½¿ç”¨ get å’Œ set è®¿é—®å™¨ï¼Œä»£ç æ›´åŠ ç®€æ´ã€‚</p></blockquote><p><b>5. è®¿é—®ä¿®é¥°ç¬¦ä¸ getã€set</b></p><blockquote><p>å¯ä»¥ä¸º get å’Œ set è®¿é—®å™¨åˆ†åˆ«æŒ‡å®šä¸åŒçš„è®¿é—®ä¿®é¥°ç¬¦ï¼Œä»¥å®ç°æ›´ç»†ç²’åº¦çš„è®¿é—®æ§åˆ¶ã€‚</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Student</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">int</span> _age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Age</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> _age;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">set</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">value</span> &gt;= <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                _age = <span class="keyword">value</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Student</span>(<span class="params"><span class="built_in">int</span> age</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ç±»å†…éƒ¨å¯ä»¥è°ƒç”¨ç§æœ‰ set è®¿é—®å™¨</span></span><br><span class="line">        Age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Student student = <span class="keyword">new</span> Student(<span class="number">20</span>);</span><br><span class="line">        <span class="comment">// å¯ä»¥è¯»å– Age å±æ€§çš„å€¼</span></span><br><span class="line">        Console.WriteLine(student.Age); </span><br><span class="line">        <span class="comment">// ä¸‹é¢è¿™è¡Œä»£ç ä¼šæŠ¥é”™ï¼Œå› ä¸º set è®¿é—®å™¨æ˜¯ç§æœ‰çš„</span></span><br><span class="line">        <span class="comment">// student.Age = 21; </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒAge å±æ€§çš„ set è®¿é—®å™¨è¢«å£°æ˜ä¸º privateï¼Œè¿™æ„å‘³ç€åªæœ‰åœ¨ Student ç±»å†…éƒ¨æ‰èƒ½ä¿®æ”¹ Age å±æ€§çš„å€¼ï¼Œå¤–éƒ¨ä»£ç åªèƒ½è¯»å–è¯¥å±æ€§çš„å€¼ã€‚</p></blockquote><br><hr><h1 id="Csharp-publicä¸privateçš„æƒé™æ§åˆ¶"><a href="#Csharp-publicä¸privateçš„æƒé™æ§åˆ¶" class="headerlink" title="Csharp publicä¸privateçš„æƒé™æ§åˆ¶"></a>Csharp publicä¸privateçš„æƒé™æ§åˆ¶</h1><p><b>è®¿é—®ä¿®é¥°ç¬¦çš„æ¦‚å¿µ</b></p><p><code>åœ¨ C# ä¸­ï¼Œè®¿é—®ä¿®é¥°ç¬¦ç”¨äºæ§åˆ¶ç±»ã€æˆå‘˜ï¼ˆå¦‚å­—æ®µã€æ–¹æ³•ã€å±æ€§ç­‰ï¼‰çš„å¯è®¿é—®æ€§ã€‚<mark>public</mark>å’Œ<mark>private</mark>æ˜¯ä¸¤ç§æœ€å¸¸ç”¨çš„è®¿é—®ä¿®é¥°ç¬¦ã€‚å®ƒä»¬å®šä¹‰äº†ä»£ç ä¸­çš„å“ªäº›éƒ¨åˆ†å¯ä»¥è®¿é—®ç‰¹å®šçš„ç±»æˆå‘˜ã€‚</code></p><p><b>privateè®¿é—®ä¿®é¥°ç¬¦</b></p><blockquote><p>å«ä¹‰ï¼šprivateæ˜¯æœ€ä¸¥æ ¼çš„è®¿é—®çº§åˆ«ã€‚è¢«æ ‡è®°ä¸ºprivateçš„æˆå‘˜åªèƒ½åœ¨å…¶æ‰€å±çš„ç±»å†…éƒ¨è®¿é—®ã€‚</p></blockquote><p><b>ç¤ºä¾‹ä»£ç ï¼š</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">MyClass</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">int</span> myPrivateVariable;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">MyPrivateMethod</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// è¿™ä¸ªæ–¹æ³•å¯ä»¥è®¿é—®myPrivateVariable</span></span><br><span class="line">        myPrivateVariable = <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">AnotherClass</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Test</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        MyClass myObj = <span class="keyword">new</span> MyClass();</span><br><span class="line">        <span class="comment">// ä¸‹é¢è¿™è¡Œä»£ç ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ï¼Œå› ä¸ºmyPrivateVariableæ˜¯ç§æœ‰çš„ï¼Œä¸èƒ½åœ¨MyClasså¤–éƒ¨è®¿é—®</span></span><br><span class="line">        <span class="comment">// myObj.myPrivateVariable = 5;</span></span><br><span class="line">        <span class="comment">// ä¸‹é¢è¿™è¡Œä»£ç ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ï¼Œå› ä¸ºMyPrivateMethodæ˜¯ç§æœ‰çš„ï¼Œä¸èƒ½åœ¨MyClasså¤–éƒ¨è®¿é—®</span></span><br><span class="line">        <span class="comment">// myObj.MyPrivateMethod();</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><b>ç”¨é€”ï¼š</b></p><blockquote><p>ç”¨äºéšè—ç±»çš„å†…éƒ¨å®ç°ç»†èŠ‚ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªç±»å¯èƒ½æœ‰ä¸€äº›å†…éƒ¨çš„è®¡æ•°å™¨æˆ–è€…çŠ¶æ€å˜é‡ï¼Œè¿™äº›å˜é‡ä¸åº”è¯¥è¢«å¤–éƒ¨ä»£ç éšæ„ä¿®æ”¹ï¼Œå°±å¯ä»¥å°†å®ƒä»¬å£°æ˜ä¸ºprivateã€‚è¿™æ ·å¯ä»¥ç¡®ä¿ç±»çš„å®Œæ•´æ€§å’Œä¸€è‡´æ€§ï¼Œé˜²æ­¢å¤–éƒ¨ä»£ç å¯¹å†…éƒ¨æ•°æ®è¿›è¡Œä¸æ°å½“çš„æ“ä½œã€‚<br>é™åˆ¶å¯¹æ–¹æ³•çš„è®¿é—®ã€‚æœ‰äº›æ–¹æ³•å¯èƒ½åªæ˜¯ä¸ºäº†è¾…åŠ©ç±»å†…éƒ¨çš„å…¶ä»–æ–¹æ³•è€Œå­˜åœ¨ï¼Œä¸åº”è¯¥è¢«å¤–éƒ¨è°ƒç”¨ï¼Œå°†è¿™äº›æ–¹æ³•å£°æ˜ä¸ºprivateå¯ä»¥é¿å…å®ƒä»¬è¢«è¯¯ç”¨ã€‚</p></blockquote><p><b>publicè®¿é—®ä¿®é¥°ç¬¦</b></p><blockquote><p>å«ä¹‰ï¼špublicæä¾›äº†æœ€å¹¿æ³›çš„è®¿é—®çº§åˆ«ã€‚è¢«æ ‡è®°ä¸ºpublicçš„æˆå‘˜å¯ä»¥ä»ä»»ä½•å…¶ä»–ç±»è®¿é—®ï¼Œæ— è®ºæ˜¯åœ¨åŒä¸€ä¸ªç¨‹åºé›†ä¸­è¿˜æ˜¯åœ¨å¼•ç”¨äº†è¯¥ç¨‹åºé›†çš„å…¶ä»–ç¨‹åºé›†ä¸­ã€‚</p></blockquote><p><b>ç¤ºä¾‹ä»£ç ï¼š</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">MyClass</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> myPublicVariable;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">MyPublicMethod</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// è¿™ä¸ªæ–¹æ³•å¯ä»¥è¢«å…¶ä»–ç±»è®¿é—®</span></span><br><span class="line">        myPublicVariable = <span class="number">20</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">AnotherClass</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Test</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        MyClass myObj = <span class="keyword">new</span> MyClass();</span><br><span class="line">        myObj.myPublicVariable = <span class="number">5</span>;</span><br><span class="line">        myObj.MyPublicMethod();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><b>ç”¨é€”ï¼š</b></p><blockquote><p>å½“éœ€è¦å‘å¤–éƒ¨æä¾›ç±»çš„åŠŸèƒ½æˆ–è€…æ•°æ®æ—¶ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªè¡¨ç¤ºå›¾å½¢çš„ç±»å¯èƒ½æœ‰ä¸€ä¸ªpublicæ–¹æ³•ç”¨äºç»˜åˆ¶å›¾å½¢ï¼Œæˆ–è€…ä¸€ä¸ªè¡¨ç¤ºæ•°æ®åº“è¿æ¥çš„ç±»å¯èƒ½æœ‰publicå±æ€§ç”¨äºè·å–è¿æ¥å­—ç¬¦ä¸²ã€‚è¿™äº›publicæˆå‘˜æ„æˆäº†ç±»ä¸å¤–éƒ¨ä¸–ç•Œäº¤äº’çš„æ¥å£ï¼Œå…¶ä»–ç±»å¯ä»¥é€šè¿‡è¿™äº›æ¥å£æ¥ä½¿ç”¨è¯¥ç±»çš„åŠŸèƒ½ã€‚</p></blockquote><p>protectedï¼ˆå—ä¿æŠ¤çš„ï¼‰</p><p>å«ä¹‰ï¼šè¢« protected ä¿®é¥°çš„æˆå‘˜å¯ä»¥åœ¨å…¶æ‰€å±çš„ç±»å†…éƒ¨ä»¥åŠè¯¥ç±»çš„æ´¾ç”Ÿç±»ä¸­è®¿é—®ã€‚</p><p>ç¤ºä¾‹ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">MyBaseClass</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="built_in">int</span> myProtectedVariable;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">MyDerivedClass</span> : <span class="title">MyBaseClass</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">MyDerivedMethod</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å¯ä»¥è®¿é—®myProtectedVariableï¼Œå› ä¸ºMyDerivedClassç»§æ‰¿è‡ªMyBaseClass</span></span><br><span class="line">        myProtectedVariable = <span class="number">20</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>internalï¼ˆå†…éƒ¨çš„ï¼‰</p><p>å«ä¹‰ï¼šè¢« internal ä¿®é¥°çš„æˆå‘˜å¯ä»¥åœ¨åŒä¸€ç¨‹åºé›†ï¼ˆä¸€ä¸ª.dll æˆ–.exe æ–‡ä»¶ï¼‰å†…çš„ä»»ä½•ç±»ä¸­è®¿é—®ã€‚</p><p>ç¤ºä¾‹ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">MyInternalClass</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">internal</span> <span class="keyword">void</span> <span class="title">MyInternalMethod</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// æ–¹æ³•ä½“</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœæœ‰å¦ä¸€ä¸ªç±»åœ¨ç›¸åŒçš„ç¨‹åºé›†ä¸­ï¼Œå°±å¯ä»¥è®¿é—®MyInternalClasså’ŒMyInternalMethodï¼Œä½†å¦‚æœåœ¨å…¶ä»–ç¨‹åºé›†ä¸­åˆ™æ— æ³•è®¿é—®ã€‚</p><p>protected internalï¼ˆå—ä¿æŠ¤çš„å†…éƒ¨ï¼‰</p><p>å«ä¹‰ï¼šè¿™æ˜¯ä¸€ç§ç»„åˆä¿®é¥°ç¬¦ã€‚è¢« protected internal ä¿®é¥°çš„æˆå‘˜å¯ä»¥åœ¨å…¶æ‰€å±çš„ç±»å†…éƒ¨ã€è¯¥ç±»çš„æ´¾ç”Ÿç±»ä¸­æˆ–è€…åŒä¸€ç¨‹åºé›†å†…çš„ä»»ä½•ç±»ä¸­è®¿é—®ã€‚</p><p>ç¤ºä¾‹ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">MyBaseClass2</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">internal</span> <span class="built_in">int</span> myProtectedInternalVariable;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">MyDerivedClass2</span> : <span class="title">MyBaseClass2</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">MyDerivedMethod2</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å¯ä»¥è®¿é—®myProtectedInternalVariableï¼Œå› ä¸ºæ˜¯æ´¾ç”Ÿç±»</span></span><br><span class="line">        myProtectedInternalVariable = <span class="number">30</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒæ—¶ï¼Œåœ¨åŒä¸€ç¨‹åºé›†ä¸­çš„å…¶ä»–ç±»ä¹Ÿå¯ä»¥è®¿é—®myProtectedInternalVariableã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Visual Studio 2022 </tag>
            
            <tag> é¢å‘å¯¹è±¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Csharpç±»çš„å®šä¹‰å’Œä½¿ç”¨</title>
      <link href="/2025/01/26/cshrap%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/csharp%E7%B1%BB%E7%9A%84%E5%AE%9A%E4%B9%89%E5%92%8C%E4%BD%BF%E7%94%A8/"/>
      <url>/2025/01/26/cshrap%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/csharp%E7%B1%BB%E7%9A%84%E5%AE%9A%E4%B9%89%E5%92%8C%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="ç±»çš„å®šä¹‰"><a href="#ç±»çš„å®šä¹‰" class="headerlink" title="ç±»çš„å®šä¹‰"></a>ç±»çš„å®šä¹‰</h1><p><code>åœ¨ C# ä¸­ï¼Œç±»æ˜¯ä¸€ç§ç”¨æˆ·å®šä¹‰çš„æ•°æ®ç±»å‹ï¼Œå®ƒæ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„åŸºæœ¬æ„å»ºå—ã€‚ç±»ç”¨äºå°è£…æ•°æ®ï¼ˆé€šè¿‡å­—æ®µï¼‰å’Œè¡Œä¸ºï¼ˆé€šè¿‡æ–¹æ³•ï¼‰ã€‚å®šä¹‰ä¸€ä¸ªç±»çš„åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š</code></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">ClassName</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ç±»çš„æˆå‘˜ï¼ˆå­—æ®µã€æ–¹æ³•ã€å±æ€§ç­‰ï¼‰</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><b>ä¾‹å¦‚ï¼Œå®šä¹‰ä¸€ä¸ªç®€å•çš„Personç±»ï¼š</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Person</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// å­—æ®µï¼Œç”¨äºå­˜å‚¨äººçš„å§“å</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name;</span><br><span class="line">    <span class="comment">// æ–¹æ³•ï¼Œç”¨äºæ‰“å°é—®å€™è¯­</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">SayHello</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;Hello, my name is <span class="subst">&#123;Name&#125;</span>.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ç±»çš„æˆå‘˜"><a href="#ç±»çš„æˆå‘˜" class="headerlink" title="ç±»çš„æˆå‘˜"></a>ç±»çš„æˆå‘˜</h1><p><b>å­—æ®µ</b></p><p><code>å­—æ®µæ˜¯ç±»ä¸­çš„å˜é‡ï¼Œç”¨äºå­˜å‚¨æ•°æ®ã€‚å®ƒä»¬å¯ä»¥æœ‰ä¸åŒçš„è®¿é—®ä¿®é¥°ç¬¦ï¼Œå¦‚publicã€privateã€protectedç­‰ã€‚publicå­—æ®µå¯ä»¥ä»ç±»çš„å¤–éƒ¨è®¿é—®ï¼Œè€Œprivateå­—æ®µåªèƒ½åœ¨ç±»çš„å†…éƒ¨è®¿é—®ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸Šé¢çš„Personç±»ä¸­ï¼ŒNameæ˜¯ä¸€ä¸ªpublicå­—æ®µã€‚</code></p><p><b>æ–¹æ³•</b></p><p><code>æ–¹æ³•æ˜¯ç±»ä¸­çš„å‡½æ•°ï¼Œç”¨äºå®šä¹‰ç±»çš„è¡Œä¸ºã€‚æ–¹æ³•å¯ä»¥æ¥å—å‚æ•°å¹¶è¿”å›ä¸€ä¸ªå€¼ã€‚ä¾‹å¦‚ï¼ŒPersonç±»ä¸­çš„SayHelloæ–¹æ³•æ²¡æœ‰å‚æ•°ï¼Œå¹¶ä¸”è¿”å›ç±»å‹ä¸ºvoidï¼ˆå³ä¸è¿”å›ä»»ä½•å€¼ï¼‰ã€‚å¦‚æœä¸€ä¸ªæ–¹æ³•è¦è¿”å›ä¸€ä¸ªå€¼ï¼Œéœ€è¦åœ¨æ–¹æ³•å£°æ˜ä¸­æŒ‡å®šè¿”å›ç±»å‹ã€‚</code></p><p><b>ä¾‹å¦‚ï¼š</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Calculator</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">Add</span>(<span class="params"><span class="built_in">int</span> num1, <span class="built_in">int</span> num2</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> num1 + num2;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><b>å±æ€§</b><br>å±æ€§æä¾›äº†ä¸€ç§çµæ´»çš„æ–¹å¼æ¥è®¿é—®å’Œä¿®æ”¹ç±»ä¸­çš„æ•°æ®ã€‚å±æ€§åœ¨å½¢å¼ä¸Šç±»ä¼¼äºå­—æ®µï¼Œä½†å®é™…ä¸Šå®ƒä»¬åŒ…å«äº†getï¼ˆç”¨äºè·å–å€¼ï¼‰å’Œsetï¼ˆç”¨äºè®¾ç½®å€¼ï¼‰è®¿é—®å™¨ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºPersonç±»çš„Nameå­—æ®µæ·»åŠ å±æ€§ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Person</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span> _name;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123; <span class="keyword">return</span> _name; &#125;</span><br><span class="line">        <span class="keyword">set</span> &#123; _name = <span class="keyword">value</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å±æ€§æ¥è®¿é—®å’Œä¿®æ”¹_nameå­—æ®µï¼Œå¹¶ä¸”å¯ä»¥åœ¨getå’Œsetè®¿é—®å™¨ä¸­æ·»åŠ é¢å¤–çš„é€»è¾‘ï¼Œå¦‚æ•°æ®éªŒè¯ã€‚</p></blockquote><p><b>æ„é€ å‡½æ•°</b></p><p><code>æ„é€ å‡½æ•°æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–¹æ³•ï¼Œç”¨äºåœ¨åˆ›å»ºç±»çš„å¯¹è±¡æ—¶åˆå§‹åŒ–å¯¹è±¡çš„çŠ¶æ€ã€‚æ„é€ å‡½æ•°çš„åç§°ä¸ç±»åç›¸åŒï¼Œå¹¶ä¸”æ²¡æœ‰è¿”å›ç±»å‹ï¼ˆç”šè‡³ä¸èƒ½æ˜¯voidï¼‰ã€‚ä¾‹å¦‚ï¼š</code></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Person</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Age;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span>(<span class="params"><span class="built_in">string</span> name, <span class="built_in">int</span> age</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Name = name;</span><br><span class="line">        Age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>ç°åœ¨ï¼Œå½“æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªPersonå¯¹è±¡æ—¶ï¼Œå¿…é¡»æä¾›å§“åå’Œå¹´é¾„ï¼š</code></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Person p = <span class="keyword">new</span> Person(<span class="string">&quot;John&quot;</span>, <span class="number">30</span>);</span><br></pre></td></tr></table></figure><p><b>è®¿é—®ä¿®é¥°ç¬¦</b></p><blockquote><p>publicï¼šå…¬å¼€çš„ï¼Œç±»çš„å¤–éƒ¨å¯ä»¥è®¿é—®ã€‚ä¾‹å¦‚ï¼Œpublicæ–¹æ³•å’Œå­—æ®µå¯ä»¥åœ¨å…¶ä»–ç±»ä¸­é€šè¿‡å¯¹è±¡å®ä¾‹æ¥è®¿é—®ã€‚<br>privateï¼šç§æœ‰çš„ï¼Œåªèƒ½åœ¨ç±»çš„å†…éƒ¨è®¿é—®ã€‚é€šå¸¸ç”¨äºå°è£…ç±»çš„å†…éƒ¨å®ç°ç»†èŠ‚ï¼Œé˜²æ­¢å¤–éƒ¨ä»£ç çš„éæ³•è®¿é—®ã€‚<br>protectedï¼šå—ä¿æŠ¤çš„ï¼Œåªèƒ½åœ¨ç±»çš„å†…éƒ¨ä»¥åŠè¯¥ç±»çš„æ´¾ç”Ÿç±»ä¸­è®¿é—®ã€‚ç”¨äºåœ¨ç»§æ‰¿å…³ç³»ä¸­æ§åˆ¶æˆå‘˜çš„è®¿é—®æƒé™ã€‚<br>internalï¼šå†…éƒ¨çš„ï¼Œåœ¨åŒä¸€ä¸ªç¨‹åºé›†ï¼ˆAssemblyï¼‰å†…å¯ä»¥è®¿é—®ã€‚è¿™å¯¹äºç»„ç»‡ä»£ç å’Œé™åˆ¶è®¿é—®èŒƒå›´å¾ˆæœ‰ç”¨ã€‚</p></blockquote><p><b>ç»§æ‰¿</b></p><p><code>C# æ”¯æŒç±»çš„ç»§æ‰¿ï¼Œå®ƒå…è®¸ä¸€ä¸ªç±»ï¼ˆæ´¾ç”Ÿç±»æˆ–å­ç±»ï¼‰ç»§æ‰¿å¦ä¸€ä¸ªç±»ï¼ˆåŸºç±»æˆ–çˆ¶ç±»ï¼‰çš„æˆå‘˜ã€‚ç»§æ‰¿çš„è¯­æ³•å¦‚ä¸‹ï¼š</code></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">DerivedClass</span> : <span class="title">BaseClass</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// æ´¾ç”Ÿç±»çš„æˆå‘˜</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><b>ä¾‹å¦‚ï¼Œå®šä¹‰ä¸€ä¸ªStudentç±»ç»§æ‰¿è‡ªPersonç±»ï¼š</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Student</span> : <span class="title">Person</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> School;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Student</span>(<span class="params"><span class="built_in">string</span> name, <span class="built_in">int</span> age, <span class="built_in">string</span> school</span>) : <span class="title">base</span>(<span class="params">name, age</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        School = school;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨è¿™é‡Œï¼ŒStudentç±»ç»§æ‰¿äº†Personç±»çš„Nameå’ŒAgeå­—æ®µä»¥åŠç›¸å…³æ–¹æ³•ã€‚å¹¶ä¸”Studentç±»æœ‰è‡ªå·±çš„å­—æ®µSchoolã€‚æ„é€ å‡½æ•°ä¸­çš„base(name, age)ç”¨äºè°ƒç”¨åŸºç±»Personçš„æ„é€ å‡½æ•°æ¥åˆå§‹åŒ–ç»§æ‰¿çš„æˆå‘˜ã€‚</p></blockquote><p><b>å¤šæ€æ€§</b></p><p><code>å¤šæ€æ€§æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„é‡è¦æ¦‚å¿µï¼ŒC# é€šè¿‡æ–¹æ³•é‡å†™ï¼ˆOverrideï¼‰æ¥å®ç°å¤šæ€ã€‚åœ¨åŸºç±»ä¸­å®šä¹‰ä¸€ä¸ªè™šæ–¹æ³•ï¼ˆä½¿ç”¨virtualå…³é”®å­—ï¼‰ï¼Œç„¶ååœ¨æ´¾ç”Ÿç±»ä¸­é‡å†™è¯¥æ–¹æ³•ï¼ˆä½¿ç”¨overrideå…³é”®å­—ï¼‰ã€‚ä¾‹å¦‚ï¼š</code></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Shape</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="built_in">double</span> <span class="title">Area</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">Circle</span> : <span class="title">Shape</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">double</span> radius;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Circle</span>(<span class="params"><span class="built_in">double</span> r</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        radius = r;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">double</span> <span class="title">Area</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> Math.PI * radius * radius;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å½“æˆ‘ä»¬æœ‰ä¸€ä¸ªShapeç±»å‹çš„æ•°ç»„ï¼Œå…¶ä¸­åŒ…å«ä¸åŒçš„å½¢çŠ¶ï¼ˆå¦‚Circleï¼‰å¯¹è±¡æ—¶ï¼Œé€šè¿‡è°ƒç”¨Areaæ–¹æ³•ï¼Œä¼šæ ¹æ®å¯¹è±¡çš„å®é™…ç±»å‹ï¼ˆå¤šæ€ï¼‰æ¥æ‰§è¡Œæ­£ç¡®çš„Areaè®¡ç®—æ–¹æ³•ã€‚</p></blockquote><br><hr><h1 id="è½¦è¾†ç±»ä¸å‘é‡ç±»çš„å®šä¹‰å’Œä½¿ç”¨"><a href="#è½¦è¾†ç±»ä¸å‘é‡ç±»çš„å®šä¹‰å’Œä½¿ç”¨" class="headerlink" title="è½¦è¾†ç±»ä¸å‘é‡ç±»çš„å®šä¹‰å’Œä½¿ç”¨"></a>è½¦è¾†ç±»ä¸å‘é‡ç±»çš„å®šä¹‰å’Œä½¿ç”¨</h1><p><b>è½¦è¾†ç±»ï¼ˆVehicle Classï¼‰</b></p><p><b>å®šä¹‰å’ŒåŸºæœ¬å±æ€§</b></p><p><code>é¦–å…ˆï¼Œè½¦è¾†ç±»å¯ä»¥åŒ…å«è½¦è¾†çš„åŸºæœ¬å±æ€§ï¼Œå¦‚å“ç‰Œï¼ˆbrandï¼‰ã€å‹å·ï¼ˆmodelï¼‰ã€é¢œè‰²ï¼ˆcolorï¼‰ã€é€Ÿåº¦ï¼ˆspeedï¼‰ç­‰ã€‚åœ¨ C# ä¸­ï¼Œå¯ä»¥è¿™æ ·å®šä¹‰è½¦è¾†ç±»ï¼š</code></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Vehicle</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Brand &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Model &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Color &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">double</span> speed;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> Speed</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123; <span class="keyword">return</span> speed; &#125;</span><br><span class="line">        <span class="keyword">set</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">value</span> &gt;= <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                speed = <span class="keyword">value</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¿™é‡Œï¼ŒBrandã€Modelå’ŒColoræ˜¯å…¬å…±å±æ€§ï¼Œå¯ä»¥ç›´æ¥è¯»å†™ã€‚Speedå±æ€§æ˜¯é€šè¿‡ä¸€ä¸ªç§æœ‰å­—æ®µspeedæ¥å®ç°çš„ï¼Œå¹¶ä¸”åœ¨è®¾ç½®é€Ÿåº¦æ—¶è¿›è¡Œäº†ç®€å•çš„éªŒè¯ï¼Œç¡®ä¿é€Ÿåº¦ä¸å°äº 0ã€‚</p></blockquote><p><b>æ–¹æ³•</b></p><p><code>è½¦è¾†ç±»å¯ä»¥æœ‰ä¸€äº›æ–¹æ³•ï¼Œæ¯”å¦‚åŠ é€Ÿï¼ˆAccelerateï¼‰å’Œå‡é€Ÿï¼ˆDecelerateï¼‰æ–¹æ³•ã€‚</code></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Vehicle</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//... å‰é¢å®šä¹‰çš„å±æ€§</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Accelerate</span>(<span class="params"><span class="built_in">double</span> increment</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Speed += increment;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Decelerate</span>(<span class="params"><span class="built_in">double</span> decrement</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Speed -= decrement;</span><br><span class="line">        <span class="keyword">if</span> (Speed &lt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Speed = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¿™äº›æ–¹æ³•å¯ä»¥æ”¹å˜è½¦è¾†çš„é€Ÿåº¦å±æ€§ã€‚Accelerateæ–¹æ³•å°†é€Ÿåº¦å¢åŠ æŒ‡å®šçš„å¢é‡ï¼ŒDecelerateæ–¹æ³•å°†é€Ÿåº¦å‡å°‘æŒ‡å®šçš„å‡é‡ï¼Œå¹¶ç¡®ä¿é€Ÿåº¦ä¸ä¼šå°äº 0ã€‚</p></blockquote><br><p><b>å‘é‡ç±»ï¼ˆVector Classï¼‰</b></p><p><b>å®šä¹‰å’ŒåŸºæœ¬æ“ä½œ</b></p><p><code>åœ¨æ•°å­¦å’Œç¼–ç¨‹ä¸­ï¼Œå‘é‡æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„æ¦‚å¿µã€‚åœ¨ C# ä¸­ï¼Œå¯ä»¥å®šä¹‰ä¸€ä¸ªäºŒç»´å‘é‡ç±»ï¼ŒåŒ…å« x å’Œ y ä¸¤ä¸ªåˆ†é‡ã€‚</code></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Vector</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> X &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> Y &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Vector</span>(<span class="params"><span class="built_in">double</span> x, <span class="built_in">double</span> y</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        X = x;</span><br><span class="line">        Y = y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¿™æ˜¯ä¸€ä¸ªç®€å•çš„å‘é‡ç±»å®šä¹‰ï¼Œæœ‰ä¸¤ä¸ªå…¬å…±å±æ€§Xå’ŒYæ¥è¡¨ç¤ºå‘é‡çš„ä¸¤ä¸ªåˆ†é‡ï¼Œå¹¶ä¸”é€šè¿‡æ„é€ å‡½æ•°æ¥åˆå§‹åŒ–è¿™ä¸¤ä¸ªåˆ†é‡ã€‚</p></blockquote><p><b>å‘é‡è¿ç®—æ–¹æ³•</b></p><p><b>å‘é‡ç±»å¯ä»¥æœ‰ä¸€äº›æ–¹æ³•æ¥è¿›è¡Œå‘é‡è¿ç®—ï¼Œæ¯”å¦‚å‘é‡åŠ æ³•å’Œå‡æ³•ã€‚</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Vector</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//... å‰é¢å®šä¹‰çš„å±æ€§å’Œæ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Vector <span class="title">Add</span>(<span class="params">Vector other</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Vector(X + other.X, Y + other.Y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Vector <span class="title">Subtract</span>(<span class="params">Vector other</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Vector(X - other.X, Y - other.Y);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Addæ–¹æ³•ç”¨äºå°†å½“å‰å‘é‡å’Œå¦ä¸€ä¸ªå‘é‡ç›¸åŠ ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„å‘é‡ã€‚Subtractæ–¹æ³•ç”¨äºå°†å½“å‰å‘é‡å‡å»å¦ä¸€ä¸ªå‘é‡ï¼Œä¹Ÿè¿”å›ä¸€ä¸ªæ–°çš„å‘é‡ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Visual Studio 2022 </tag>
            
            <tag> é¢å‘å¯¹è±¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Csharpé¢å‘å¯¹è±¡æ¦‚å¿µå¼•å…¥</title>
      <link href="/2025/01/26/cshrap%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/csharp%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E6%A6%82%E5%BF%B5%E5%BC%95%E5%85%A5/"/>
      <url>/2025/01/26/cshrap%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/csharp%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E6%A6%82%E5%BF%B5%E5%BC%95%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<h1 id="é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆObject-Oriented-Programmingï¼‰"><a href="#é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆObject-Oriented-Programmingï¼‰" class="headerlink" title="é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆObject - Oriented Programmingï¼‰"></a>é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆObject - Oriented Programmingï¼‰</h1><h2 id="é¢å‘å¯¹è±¡æ¦‚å¿µå¼•å…¥ï¼š"><a href="#é¢å‘å¯¹è±¡æ¦‚å¿µå¼•å…¥ï¼š" class="headerlink" title="é¢å‘å¯¹è±¡æ¦‚å¿µå¼•å…¥ï¼š"></a>é¢å‘å¯¹è±¡æ¦‚å¿µå¼•å…¥ï¼š</h2><p> <b>ä»å®é™…ç”Ÿæ´»åœºæ™¯ç±»æ¯”å¼•å…¥</b></p><p><code>æƒ³è±¡æˆ‘ä»¬è¦å¼€å‘ä¸€ä¸ªæ±½è½¦ç®¡ç†ç³»ç»Ÿã€‚åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œæ±½è½¦æ˜¯ä¸€ä¸ªå…·æœ‰å¤šç§å±æ€§å’Œè¡Œä¸ºçš„å®ä½“ã€‚æ±½è½¦æœ‰é¢œè‰²ï¼ˆå¦‚çº¢è‰²ã€è“è‰²ï¼‰ã€å“ç‰Œï¼ˆå¦‚ä¸°ç”°ã€å®é©¬ï¼‰ã€é€Ÿåº¦ï¼ˆå¦‚ 0 - 200km/hï¼‰ç­‰å±æ€§ï¼Œè¿˜æœ‰å¯åŠ¨ã€åŠ é€Ÿã€åˆ¹è½¦ç­‰è¡Œä¸ºã€‚</code></p><p><b>åœ¨ C# ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ±½è½¦æŠ½è±¡æˆä¸€ä¸ª<mark>ç±»ï¼ˆclassï¼‰</mark>ï¼Œå°±åƒåˆ›å»ºä¸€ä¸ªæ±½è½¦çš„è“å›¾ã€‚è¿™ä¸ªç±»å¯ä»¥å®šä¹‰æ±½è½¦çš„å„ç§å±æ€§å’Œè¡Œä¸ºã€‚ä¾‹å¦‚ï¼š</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Car</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// æ±½è½¦çš„å±æ€§</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Color;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Brand;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Speed;</span><br><span class="line">    <span class="comment">// æ±½è½¦çš„è¡Œä¸ºï¼ˆæ–¹æ³•ï¼‰</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Start</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;The car has started.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Accelerate</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Speed += <span class="number">10</span>;</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;The <span class="subst">&#123;Brand&#125;</span> car&#x27;s speed is now <span class="subst">&#123;Speed&#125;</span> km/h.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Brake</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Speed -= <span class="number">5</span>;</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;The <span class="subst">&#123;Brand&#125;</span> car&#x27;s speed is now <span class="subst">&#123;Speed&#125;</span> km/h.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¿™é‡Œï¼ŒColorã€Brandå’ŒSpeedæ˜¯æ±½è½¦ç±»çš„å±æ€§ï¼Œç”¨æ¥æè¿°æ±½è½¦çš„çŠ¶æ€ã€‚Startã€Accelerateå’ŒBrakeæ˜¯æ–¹æ³•ï¼Œä»£è¡¨æ±½è½¦å¯ä»¥æ‰§è¡Œçš„è¡Œä¸ºã€‚è¿™å°±æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ç±»çš„æ¦‚å¿µï¼Œå®ƒæ˜¯å¯¹è±¡çš„æ¨¡æ¿ï¼Œå®šä¹‰äº†å¯¹è±¡å…·æœ‰ä»€ä¹ˆå’Œèƒ½åšä»€ä¹ˆã€‚<br>é€šè¿‡ç®€å•ç¨‹åºç»“æ„å¼•å…¥å¯¹è±¡å’Œç±»çš„å…³ç³»</p></blockquote><br><p><b>å½“æˆ‘ä»¬æœ‰äº†æ±½è½¦ç±»è¿™ä¸ªè“å›¾åï¼Œå°±å¯ä»¥åˆ›å»ºæ±½è½¦å¯¹è±¡ã€‚åœ¨ C# ä¸­ï¼Œä½¿ç”¨<mark>new</mark>å…³é”®å­—æ¥åˆ›å»ºå¯¹è±¡ã€‚ä¾‹å¦‚ï¼š</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Car myCar = <span class="keyword">new</span> Car();</span><br><span class="line">        myCar.Color = <span class="string">&quot;Red&quot;</span>;</span><br><span class="line">        myCar.Brand = <span class="string">&quot;Toyota&quot;</span>;</span><br><span class="line">        myCar.Speed = <span class="number">0</span>;</span><br><span class="line">        myCar.Start();</span><br><span class="line">        myCar.Accelerate();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨è¿™ä¸ªMainæ–¹æ³•ä¸­ï¼ŒCar myCar &#x3D; new Car();è¿™ä¸€è¡Œåˆ›å»ºäº†ä¸€ä¸ªCarç±»çš„å¯¹è±¡myCarã€‚ç„¶åæˆ‘ä»¬å¯ä»¥åƒè®¾ç½®å˜é‡ä¸€æ ·è®¾ç½®å¯¹è±¡çš„å±æ€§ï¼Œå¦‚myCar.Color &#x3D; â€œRedâ€;ã€‚å¹¶ä¸”å¯ä»¥è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•ï¼Œå¦‚myCar.Start();å’ŒmyCar.Accelerate();ã€‚è¿™å°±åƒæ ¹æ®æ±½è½¦è“å›¾åˆ¶é€ å‡ºäº†ä¸€è¾†å…·ä½“çš„æ±½è½¦ï¼Œç„¶åå¯ä»¥å¯¹è¿™è¾†æ±½è½¦è¿›è¡Œå„ç§æ“ä½œï¼Œæ¯”å¦‚æ”¹å˜å®ƒçš„é¢œè‰²ã€å¯åŠ¨å®ƒã€è®©å®ƒåŠ é€Ÿç­‰ã€‚è¿™ä½“ç°äº†å¯¹è±¡æ˜¯ç±»çš„å®ä¾‹çš„æ¦‚å¿µï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„å±æ€§å€¼ï¼Œå¯ä»¥æ‰§è¡Œç±»ä¸­å®šä¹‰çš„æ–¹æ³•ã€‚</p></blockquote><br><p><b>å¼•å…¥å°è£…æ¦‚å¿µä»¥å¢å¼ºæ•°æ®å®‰å…¨æ€§å’Œç¨‹åºå¯ç»´æŠ¤æ€§</b></p><p><code>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæ±½è½¦çš„å±æ€§æ˜¯ç›´æ¥å¯è®¿é—®çš„ï¼Œè¿™åœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½ä¼šå¯¼è‡´é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œå¤–éƒ¨ä»£ç å¯èƒ½ä¼šä¸å°å¿ƒè®¾ç½®ä¸åˆç†çš„é€Ÿåº¦å€¼ã€‚ä¸ºäº†æ›´å¥½åœ°æ§åˆ¶å¯¹æ•°æ®çš„è®¿é—®ï¼ŒC# æä¾›äº†å°è£…æœºåˆ¶ã€‚</code></p><p><b>æˆ‘ä»¬å¯ä»¥æŠŠå±æ€§è®¾ä¸º<mark>privateï¼ˆç§æœ‰ï¼‰</mark>ï¼Œç„¶åé€šè¿‡å…¬å…±<mark>ï¼ˆpublicï¼‰</mark>çš„æ–¹æ³•æ¥è®¿é—®å’Œä¿®æ”¹è¿™äº›å±æ€§ã€‚ä¾‹å¦‚ï¼š</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Car</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ç§æœ‰å±æ€§</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span> color;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">string</span> brand;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">int</span> speed;</span><br><span class="line">    <span class="comment">// å…¬å…±å±æ€§ï¼ˆç”¨äºè®¿é—®ç§æœ‰å±æ€§ï¼‰</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Color</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123; <span class="keyword">return</span> color; &#125;</span><br><span class="line">        <span class="keyword">set</span> &#123; color = <span class="keyword">value</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Brand</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123; <span class="keyword">return</span> brand; &#125;</span><br><span class="line">        <span class="keyword">set</span> &#123; brand = <span class="keyword">value</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Speed</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123; <span class="keyword">return</span> speed; &#125;</span><br><span class="line">        <span class="keyword">set</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">value</span> &gt;= <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                speed = <span class="keyword">value</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ±½è½¦çš„è¡Œä¸ºï¼ˆæ–¹æ³•ï¼‰</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Start</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;The car has started.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Accelerate</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Speed += <span class="number">10</span>;</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;The <span class="subst">&#123;Brand&#125;</span> car&#x27;s speed is now <span class="subst">&#123;Speed&#125;</span> km/h.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Brake</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Speed -= <span class="number">5</span>;</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;The <span class="subst">&#123;Board&#125;</span> car&#x27;s speed is now <span class="subst">&#123;Speed&#125;</span> km/h.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¿™é‡Œï¼Œcolorã€brandå’Œspeedæ˜¯ç§æœ‰å±æ€§ï¼Œå¤–éƒ¨ä»£ç ä¸èƒ½ç›´æ¥è®¿é—®å®ƒä»¬ã€‚é€šè¿‡å®šä¹‰å…¬å…±å±æ€§Colorã€Brandå’ŒSpeedï¼Œå¤–éƒ¨ä»£ç å¯ä»¥å®‰å…¨åœ°è·å–å’Œè®¾ç½®è¿™äº›å±æ€§çš„å€¼ã€‚è€Œä¸”åœ¨Speedå±æ€§çš„setæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ é€»è¾‘æ¥ç¡®ä¿é€Ÿåº¦å€¼ä¸ä¼šè¢«è®¾ç½®ä¸ºè´Ÿæ•°ï¼Œè¿™å¢å¼ºäº†æ•°æ®çš„å®‰å…¨æ€§å’Œç¨‹åºçš„å¯ç»´æŠ¤æ€§ï¼Œä½“ç°äº†å°è£…çš„æ¦‚å¿µã€‚</p></blockquote><br><p><b>å¼•å…¥ç»§æ‰¿æ¥å±•ç¤ºä»£ç å¤ç”¨å’Œå±‚æ¬¡ç»“æ„</b></p><p><code>å‡è®¾æˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªè·‘è½¦ï¼ˆSports Carï¼‰ç±»ï¼Œè·‘è½¦ä¹Ÿæ˜¯æ±½è½¦ï¼Œå®ƒå…·æœ‰æ±½è½¦çš„åŸºæœ¬å±æ€§å’Œè¡Œä¸ºï¼Œä½†è¿˜æœ‰ä¸€äº›ç‰¹æ®Šçš„åŠŸèƒ½ï¼Œæ¯”å¦‚æ¶¡è½®å¢å‹ï¼ˆTurbo Boostï¼‰ã€‚</code></p><p><b>åœ¨ C# ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç»§æ‰¿æ¥åˆ›å»ºè·‘è½¦ç±»ã€‚è·‘è½¦ç±»ï¼ˆSportsCarï¼‰å¯ä»¥ç»§æ‰¿æ±½è½¦ç±»ï¼ˆCarï¼‰çš„å±æ€§å’Œæ–¹æ³•ï¼Œå¹¶æ·»åŠ è‡ªå·±çš„æ–°æ–¹æ³•ã€‚ä¾‹å¦‚ï¼š</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">SportsCar</span> : <span class="title">Car</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">TurboBoost</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Speed += <span class="number">50</span>;</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;The <span class="subst">&#123;Brand&#125;</span> sports car&#x27;s speed after turbo boost is <span class="subst">&#123;Speed&#125;</span> km/h.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¿™é‡Œï¼ŒSportsCarç±»ç»§æ‰¿äº†Carç±»ï¼Œå®ƒè‡ªåŠ¨æ‹¥æœ‰äº†Carç±»çš„Colorã€Brandã€Speedå±æ€§å’ŒStartã€Accelerateã€Brakeæ–¹æ³•ã€‚åŒæ—¶ï¼Œå®ƒè¿˜æ·»åŠ äº†è‡ªå·±çš„TurboBoostæ–¹æ³•ã€‚è¿™ä½“ç°äº†ç»§æ‰¿çš„æ¦‚å¿µï¼Œé€šè¿‡ç»§æ‰¿å¯ä»¥å¤ç”¨ä»£ç ï¼Œå¹¶ä¸”å¯ä»¥æ„å»ºå±‚æ¬¡åŒ–çš„ç±»ç»“æ„ï¼Œä½¿å¾—ç¨‹åºæ›´åŠ æ¸…æ™°å’Œæ˜“äºç»´æŠ¤ã€‚</p></blockquote><br><p><b>å¼•å…¥å¤šæ€æ¥å±•ç¤ºæ–¹æ³•çš„çµæ´»æ€§å’ŒåŠ¨æ€æ€§</b></p><p><code>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯è®©æ±½è½¦æ˜¾ç¤ºè‡ªå·±çš„ä¿¡æ¯ã€‚åœ¨æ±½è½¦ç±»ï¼ˆCarï¼‰ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼š</code></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Car</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">DisplayInfo</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;This is a <span class="subst">&#123;Brand&#125;</span> car with color <span class="subst">&#123;Color&#125;</span> and speed <span class="subst">&#123;Speed&#125;</span> km/h.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><b>å¯¹äºè·‘è½¦ç±»ï¼ˆSportsCarï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥é‡å†™ï¼ˆoverrideï¼‰è¿™ä¸ªæ–¹æ³•æ¥æ˜¾ç¤ºæ›´è¯¦ç»†çš„ä¿¡æ¯ï¼š</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">SportsCar</span> : <span class="title">Car</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">DisplayInfo</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;This is a sports <span class="subst">&#123;Brand&#125;</span> car with color <span class="subst">&#123;Color&#125;</span>, speed <span class="subst">&#123;Speed&#125;</span> km/h and turbo boost function.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><b>ç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒæ¥å—ä¸€ä¸ªCarç±»å‹çš„å¯¹è±¡ï¼Œå¹¶è°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„DisplayInfoæ–¹æ³•ï¼š</b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Car myCar = <span class="keyword">new</span> Car();</span><br><span class="line">        myCar.Color = <span class="string">&quot;Red&quot;</span>;</span><br><span class="line">        myCar.Brand = <span class="string">&quot;Toyota&quot;</span>;</span><br><span class="line">        myCar.Speed = <span class="number">0</span>;</span><br><span class="line">        SportsCar mySportsCar = <span class="keyword">new</span> SportsCar();</span><br><span class="line">        mySportsCar.Color = <span class="string">&quot;Blue&quot;</span>;</span><br><span class="line">        mySportsCar.Brand = <span class="string">&quot;Ferrari&quot;</span>;</span><br><span class="line">        mySportsCar.Speed = <span class="number">0</span>;</span><br><span class="line">        DisplayCarInfo(myCar);</span><br><span class="line">        DisplayCarInfo(mySportsCar);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">DisplayCarInfo</span>(<span class="params">Car car</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        car.DisplayInfo();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨DisplayCarInfoæ–¹æ³•ä¸­ï¼Œå®ƒå¹¶ä¸çŸ¥é“ä¼ å…¥çš„æ˜¯æ™®é€šæ±½è½¦å¯¹è±¡è¿˜æ˜¯è·‘è½¦å¯¹è±¡ï¼Œä½†æ˜¯ä¼šæ ¹æ®å¯¹è±¡çš„å®é™…ç±»å‹æ¥è°ƒç”¨ç›¸åº”çš„DisplayInfoæ–¹æ³•ã€‚å¦‚æœæ˜¯æ™®é€šæ±½è½¦å¯¹è±¡ï¼Œå°±è°ƒç”¨Carç±»çš„DisplayInfoæ–¹æ³•ï¼›å¦‚æœæ˜¯è·‘è½¦å¯¹è±¡ï¼Œå°±è°ƒç”¨SportsCarç±»çš„DisplayInfoæ–¹æ³•ã€‚è¿™ä½“ç°äº†å¤šæ€çš„æ¦‚å¿µï¼ŒåŒä¸€ä¸ªæ–¹æ³•åœ¨ä¸åŒçš„å¯¹è±¡ä¸­æœ‰ä¸åŒçš„è¡Œä¸ºï¼Œå¢åŠ äº†ç¨‹åºçš„çµæ´»æ€§å’Œå¯æ‰©å±•æ€§ã€‚</p></blockquote><br><hr><h1 id="ä½¿ç”¨é¢å‘å¯¹è±¡æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ"><a href="#ä½¿ç”¨é¢å‘å¯¹è±¡æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ" class="headerlink" title="ä½¿ç”¨é¢å‘å¯¹è±¡æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ"></a>ä½¿ç”¨é¢å‘å¯¹è±¡æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ</h1><h2 id="æé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§"><a href="#æé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§" class="headerlink" title="æé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§"></a>æé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§</h2><p><b>å°è£…æ€§çš„ä¼˜åŠ¿ï¼š</b></p><blockquote><p>é€šè¿‡å°è£…ï¼Œå°†æ•°æ®å’Œæ“ä½œæ•°æ®çš„æ–¹æ³•ç»„åˆåœ¨ä¸€ä¸ªç±»ä¸­ï¼Œå¹¶éšè—å†…éƒ¨ç»†èŠ‚ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªå¤æ‚çš„ä¼ä¸šèµ„æºè§„åˆ’ï¼ˆERPï¼‰ç³»ç»Ÿä¸­ï¼Œæœ‰ä¸€ä¸ª â€œå‘˜å·¥â€ ç±»ï¼Œå…¶ä¸­åŒ…å«å‘˜å·¥çš„å·¥èµ„ã€ç»©æ•ˆç­‰æ•æ„Ÿæ•°æ®ã€‚è¿™äº›æ•°æ®å¯ä»¥è¢«å°è£…ä¸ºç§æœ‰å±æ€§ï¼Œåªèƒ½é€šè¿‡ç‰¹å®šçš„å…¬å…±æ–¹æ³•ï¼ˆå¦‚è·å–å·¥èµ„ã€æ›´æ–°ç»©æ•ˆï¼‰æ¥è®¿é—®å’Œä¿®æ”¹ã€‚è¿™æ ·ï¼Œå½“ç³»ç»Ÿçš„ä¸šåŠ¡é€»è¾‘å‘ç”Ÿå˜åŒ–ï¼Œæ¯”å¦‚å·¥èµ„è®¡ç®—æ–¹å¼æ”¹å˜æ—¶ï¼Œåªéœ€è¦ä¿®æ”¹ â€œå‘˜å·¥â€ ç±»å†…éƒ¨çš„ç›¸å…³æ–¹æ³•ï¼Œè€Œä¸ä¼šå½±å“åˆ°ç³»ç»Ÿä¸­å…¶ä»–ä¾èµ–è¿™ä¸ªç±»çš„éƒ¨åˆ†ã€‚</p></blockquote><p><b>å±‚æ¬¡ç»“æ„ä¾¿äºç®¡ç†ï¼š</b></p><blockquote><p>é¢å‘å¯¹è±¡çš„ç»§æ‰¿å’Œå¤šæ€ç‰¹æ€§ä½¿å¾—ä»£ç å…·æœ‰æ¸…æ™°çš„å±‚æ¬¡ç»“æ„ã€‚ä»¥å›¾å½¢ç»˜åˆ¶ç³»ç»Ÿä¸ºä¾‹ï¼Œæœ‰ä¸€ä¸ªåŸºç±» â€œå›¾å½¢â€ï¼Œå®ƒå®šä¹‰äº†åŸºæœ¬çš„ç»˜åˆ¶æ–¹æ³•å’Œé€šç”¨å±æ€§ï¼ˆå¦‚é¢œè‰²ï¼‰ã€‚ä»è¿™ä¸ªåŸºç±»æ´¾ç”Ÿå‡ºæ¥çš„ â€œåœ†å½¢â€â€œæ–¹å½¢â€ ç­‰ç±»å¯ä»¥ç»§æ‰¿è¿™äº›åŸºæœ¬çš„åŠŸèƒ½ï¼Œå¹¶æ·»åŠ è‡ªå·±ç‰¹æœ‰çš„å±æ€§å’Œæ–¹æ³•ï¼ˆå¦‚åœ†å½¢çš„åŠå¾„ã€æ–¹å½¢çš„è¾¹é•¿ï¼‰ã€‚å½“éœ€è¦å¯¹ç³»ç»Ÿè¿›è¡Œç»´æŠ¤ï¼Œæ¯”å¦‚ä¼˜åŒ–ç»˜åˆ¶ç®—æ³•æ—¶ï¼Œå¼€å‘äººå‘˜å¯ä»¥å¾ˆå®¹æ˜“åœ°å®šä½åˆ°ç›¸å…³çš„ç±»å±‚æ¬¡ç»“æ„éƒ¨åˆ†è¿›è¡Œä¿®æ”¹ï¼Œè€Œä¸ä¼šå¹²æ‰°åˆ°å…¶ä»–ä¸ç›¸å…³çš„å›¾å½¢ç±»ã€‚</p></blockquote><h2 id="å¢å¼ºä»£ç çš„å¤ç”¨æ€§"><a href="#å¢å¼ºä»£ç çš„å¤ç”¨æ€§" class="headerlink" title="å¢å¼ºä»£ç çš„å¤ç”¨æ€§"></a>å¢å¼ºä»£ç çš„å¤ç”¨æ€§</h2><p><b>ç»§æ‰¿å®ç°ä»£ç å¤ç”¨ï¼š</b></p><blockquote><p>ç»§æ‰¿å…è®¸ä¸€ä¸ªç±»ï¼ˆæ´¾ç”Ÿç±»ï¼‰ç»§æ‰¿å¦ä¸€ä¸ªç±»ï¼ˆåŸºç±»ï¼‰çš„å±æ€§å’Œæ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œåœ¨å¼€å‘ä¸€ä¸ªæ¸¸æˆæ—¶ï¼Œæœ‰ä¸€ä¸ª â€œè§’è‰²â€ åŸºç±»ï¼Œå®ƒåŒ…å«äº†è§’è‰²çš„åŸºæœ¬å±æ€§ï¼ˆå¦‚ç”Ÿå‘½å€¼ã€æ”»å‡»åŠ›ï¼‰å’Œé€šç”¨æ–¹æ³•ï¼ˆå¦‚ç§»åŠ¨ã€æ”»å‡»ï¼‰ã€‚å½“åˆ›å»º â€œæˆ˜å£«â€â€œæ³•å¸ˆâ€ ç­‰ä¸åŒç±»å‹çš„è§’è‰²ç±»æ—¶ï¼Œå®ƒä»¬å¯ä»¥ç»§æ‰¿ â€œè§’è‰²â€ åŸºç±»çš„è¿™äº›å±æ€§å’Œæ–¹æ³•ï¼Œè€Œä¸éœ€è¦é‡æ–°ç¼–å†™ç›¸åŒçš„ä»£ç ã€‚è¿™å¤§å¤§å‡å°‘äº†ä»£ç çš„å†—ä½™ï¼Œæé«˜äº†å¼€å‘æ•ˆç‡ã€‚</p></blockquote><p> <b>ç»„ä»¶åŒ–å¼€å‘ä¾¿äºå¤ç”¨ï¼š</b></p><blockquote><p>é¢å‘å¯¹è±¡ç¼–ç¨‹é¼“åŠ±å°†åŠŸèƒ½åˆ’åˆ†ä¸ºç‹¬ç«‹çš„ç±»ï¼Œè¿™äº›ç±»å¯ä»¥åƒç»„ä»¶ä¸€æ ·åœ¨ä¸åŒçš„é¡¹ç›®ä¸­è¢«å¤ç”¨ã€‚æ¯”å¦‚ï¼Œä¸€ä¸ªå¼€å‘å¥½çš„ â€œæ–‡ä»¶è¯»å–â€ ç±»ï¼Œå¯ä»¥åœ¨å¤šä¸ªéœ€è¦è¯»å–æ–‡ä»¶çš„åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ã€‚åªè¦è¿™ä¸ªç±»çš„æ¥å£ï¼ˆå…¬å…±æ–¹æ³•å’Œå±æ€§ï¼‰è®¾è®¡åˆç†ï¼Œå°±å¯ä»¥æ–¹ä¾¿åœ°é›†æˆåˆ°æ–°çš„é¡¹ç›®ä¸­ï¼Œè€Œä¸éœ€è¦é‡æ–°ç¼–å†™æ–‡ä»¶è¯»å–ç›¸å…³çš„ä»£ç ã€‚</p></blockquote><h2 id="æ›´å¥½åœ°æ¨¡æ‹Ÿç°å®ä¸–ç•Œ"><a href="#æ›´å¥½åœ°æ¨¡æ‹Ÿç°å®ä¸–ç•Œ" class="headerlink" title="æ›´å¥½åœ°æ¨¡æ‹Ÿç°å®ä¸–ç•Œ"></a>æ›´å¥½åœ°æ¨¡æ‹Ÿç°å®ä¸–ç•Œ</h2><p><b>è‡ªç„¶åœ°æŠ½è±¡ç°å®äº‹ç‰©ï¼š</b></p><blockquote><p>é¢å‘å¯¹è±¡ç¼–ç¨‹èƒ½å¤Ÿå°†ç°å®ä¸–ç•Œä¸­çš„äº‹ç‰©æŠ½è±¡ä¸ºç±»å’Œå¯¹è±¡ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªäº¤é€šæ¨¡æ‹Ÿç³»ç»Ÿä¸­ï¼Œå¯ä»¥å°†æ±½è½¦ã€è¡Œäººã€äº¤é€šä¿¡å·ç¯ç­‰éƒ½çœ‹ä½œå¯¹è±¡ã€‚æ±½è½¦å¯¹è±¡æœ‰å“ç‰Œã€é€Ÿåº¦ã€ä½ç½®ç­‰å±æ€§ï¼Œä»¥åŠå¯åŠ¨ã€åŠ é€Ÿã€åˆ¹è½¦ç­‰æ–¹æ³•ï¼›è¡Œäººå¯¹è±¡æœ‰å§“åã€è¡Œèµ°é€Ÿåº¦ã€ç›®çš„åœ°ç­‰å±æ€§å’Œè¡Œèµ°ã€ç­‰å¾…ç­‰æ–¹æ³•ï¼›äº¤é€šä¿¡å·ç¯å¯¹è±¡æœ‰é¢œè‰²ã€åˆ‡æ¢æ—¶é—´ç­‰å±æ€§å’Œå˜è‰²æ–¹æ³•ã€‚é€šè¿‡è¿™äº›å¯¹è±¡ä¹‹é—´çš„äº¤äº’ï¼Œå¯ä»¥å¾ˆè‡ªç„¶åœ°æ¨¡æ‹Ÿå‡ºäº¤é€šåœºæ™¯ï¼Œä½¿å¾—ç¨‹åºçš„è®¾è®¡å’Œç†è§£æ›´åŠ è´´è¿‘ç°å®ã€‚</p></blockquote><p><b>æ–¹ä¾¿å¤„ç†å¤æ‚å…³ç³»ï¼š</b></p><blockquote><p>é¢å‘å¯¹è±¡å¯ä»¥å¾ˆå¥½åœ°å¤„ç†ç°å®ä¸–ç•Œä¸­äº‹ç‰©ä¹‹é—´çš„å¤æ‚å…³ç³»ã€‚ä»¥ç”Ÿæ€ç³»ç»Ÿæ¨¡æ‹Ÿä¸ºä¾‹ï¼ŒåŠ¨ç‰©ç±»å’Œæ¤ç‰©ç±»ä¹‹é—´å­˜åœ¨æ•é£Ÿã€å…±ç”Ÿç­‰å…³ç³»ã€‚å¯ä»¥é€šè¿‡å¯¹è±¡ä¹‹é—´çš„æ–¹æ³•è°ƒç”¨å’Œæ¶ˆæ¯ä¼ é€’æ¥æ¨¡æ‹Ÿè¿™ç§å…³ç³»ã€‚æ¯”å¦‚ï¼ŒåŠ¨ç‰©å¯¹è±¡çš„ â€œè¿›é£Ÿâ€ æ–¹æ³•å¯èƒ½ä¼šæ¶‰åŠåˆ°å¯¹æ¤ç‰©å¯¹è±¡çš„ â€œè¢«åƒâ€ æ–¹æ³•çš„è°ƒç”¨ï¼Œè¿™ç§æ–¹å¼èƒ½å¤Ÿæ›´ç›´è§‚åœ°è¡¨ç¤ºå’Œå¤„ç†å¤æ‚çš„ç”Ÿæ€å…³ç³»ã€‚</p></blockquote><h2 id="åˆ©äºå›¢é˜Ÿåä½œå¼€å‘"><a href="#åˆ©äºå›¢é˜Ÿåä½œå¼€å‘" class="headerlink" title="åˆ©äºå›¢é˜Ÿåä½œå¼€å‘"></a>åˆ©äºå›¢é˜Ÿåä½œå¼€å‘</h2><p><b>åˆ†å·¥æ˜ç¡®ï¼š</b></p><blockquote><p>åœ¨å›¢é˜Ÿå¼€å‘ä¸­ï¼Œé¢å‘å¯¹è±¡çš„ç¼–ç¨‹æ–¹å¼ä½¿å¾—ä¸åŒçš„å¼€å‘äººå‘˜å¯ä»¥è´Ÿè´£ä¸åŒçš„ç±»æˆ–ç±»å±‚æ¬¡ç»“æ„ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªå¤§å‹çš„ç”µå­å•†åŠ¡ç³»ç»Ÿå¼€å‘ä¸­ï¼Œä¸€ä¸ªå¼€å‘äººå‘˜å¯ä»¥è´Ÿè´£ â€œç”¨æˆ·â€ ç±»ç›¸å…³çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬ç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€ä¿¡æ¯ä¿®æ”¹ç­‰ï¼›å¦ä¸€ä¸ªå¼€å‘äººå‘˜å¯ä»¥ä¸“æ³¨äº â€œå•†å“â€ ç±»ç›¸å…³çš„éƒ¨åˆ†ï¼Œå¦‚å•†å“æ·»åŠ ã€åˆ é™¤ã€å±•ç¤ºç­‰ã€‚æ¯ä¸ªå¼€å‘äººå‘˜åªéœ€è¦å…³æ³¨è‡ªå·±è´Ÿè´£çš„ç±»çš„å†…éƒ¨å®ç°å’Œå¯¹å¤–æ¥å£ï¼Œé™ä½äº†å¼€å‘è¿‡ç¨‹ä¸­çš„æ²Ÿé€šæˆæœ¬ã€‚</p></blockquote><p><b>æ˜“äºé›†æˆä¸æµ‹è¯•ï¼š</b></p><blockquote><p>ç”±äºç±»æ˜¯ç›¸å¯¹ç‹¬ç«‹çš„å•å…ƒï¼Œå®ƒä»¬ä¹‹é—´çš„æ¥å£æ¸…æ™°ï¼Œè¿™ä½¿å¾—åœ¨é›†æˆå„ä¸ªéƒ¨åˆ†çš„ä»£ç æ—¶æ›´åŠ å®¹æ˜“ã€‚è€Œä¸”ï¼Œåœ¨æµ‹è¯•é˜¶æ®µï¼Œå¯ä»¥å¯¹æ¯ä¸ªç±»è¿›è¡Œå•å…ƒæµ‹è¯•ï¼Œæ£€æŸ¥å…¶åŠŸèƒ½æ˜¯å¦ç¬¦åˆé¢„æœŸã€‚ä¾‹å¦‚ï¼Œåœ¨å¼€å‘ä¸€ä¸ªè½¯ä»¶ç³»ç»Ÿæ—¶ï¼Œå¯¹äº â€œè®¢å•å¤„ç†â€ ç±»ï¼Œå¯ä»¥ç‹¬ç«‹åœ°ç¼–å†™æµ‹è¯•ç”¨ä¾‹æ¥éªŒè¯è®¢å•çš„åˆ›å»ºã€ä¿®æ”¹ã€åˆ é™¤ç­‰åŠŸèƒ½æ˜¯å¦æ­£ç¡®ï¼Œç„¶åå†å°†è¿™ä¸ªç±»é›†æˆåˆ°æ•´ä¸ªç³»ç»Ÿä¸­è¿›è¡Œç³»ç»Ÿæµ‹è¯•ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Visual Studio 2022 </tag>
            
            <tag> é¢å‘å¯¹è±¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Csharp  try-catch-finallyè¯­å¥å¤„ç†å¼‚å¸¸</title>
      <link href="/2025/01/25/csharp%E5%A4%84%E7%90%86%E5%BC%82%E5%B8%B8/"/>
      <url>/2025/01/25/csharp%E5%A4%84%E7%90%86%E5%BC%82%E5%B8%B8/</url>
      
        <content type="html"><![CDATA[<h1>Csharp ä½¿ç”¨try-catch-finallyè¯­å¥å¤„ç†å¼‚å¸¸</h1><p>åœ¨ C# ç¼–ç¨‹ä¸­ï¼Œ<code>try - catch - finally</code>è¯­å¥æ˜¯ä¸€ç§å¼ºå¤§çš„æœºåˆ¶ï¼Œç”¨äºå¤„ç†ç¨‹åºè¿è¡Œæ—¶å¯èƒ½å‡ºç°çš„å¼‚å¸¸æƒ…å†µã€‚å¼‚å¸¸æ˜¯åœ¨ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­å‡ºç°çš„é”™è¯¯æˆ–æ„å¤–æƒ…å†µï¼Œä¾‹å¦‚è¯•å›¾è®¿é—®ä¸å­˜åœ¨çš„æ–‡ä»¶ã€æ•°ç»„è¶Šç•Œã€é™¤æ•°ä¸ºé›¶ç­‰æ“ä½œã€‚ä½¿ç”¨<code>try - catch - finally</code>å¯ä»¥è®©ç¨‹åºåœ¨é‡åˆ°è¿™äº›å¼‚å¸¸æ—¶é‡‡å–é€‚å½“çš„æªæ–½ï¼Œè€Œä¸æ˜¯ç›´æ¥å´©æºƒã€‚</p><p><b>try å—</b><br>åŠŸèƒ½ï¼štryå—æ˜¯åŒ…å«å¯èƒ½ä¼šæŠ›å‡ºå¼‚å¸¸çš„ä»£ç éƒ¨åˆ†ã€‚è¿™æ˜¯å¼‚å¸¸å¤„ç†çš„èµ·ç‚¹ï¼Œå½“ç¨‹åºæ‰§è¡Œåˆ°tryå—ä¸­çš„ä»£ç æ—¶ï¼Œä¼šç›‘æ§å…¶ä¸­çš„æ“ä½œæ˜¯å¦ä¼šå¼•å‘å¼‚å¸¸ã€‚</p><li>ç¤ºä¾‹ï¼š</li><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span>[] numbers = &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> &#125;;</span><br><span class="line">    Console.WriteLine(numbers[<span class="number">3</span>]);<span class="comment">// è¿™é‡Œä¼šæŠ›å‡ºIndexOutOfRangeExceptionå¼‚å¸¸ï¼Œå› ä¸ºæ•°ç»„æœ€å¤§ç´¢å¼•æ˜¯2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œä»£ç è¯•å›¾è®¿é—®æ•°ç»„numbersä¸­ä¸å­˜åœ¨çš„ç´¢å¼•ï¼ˆç´¢å¼•ä¸º 3ï¼Œè€Œæ•°ç»„é•¿åº¦ä¸º 3ï¼Œæœ‰æ•ˆç´¢å¼•èŒƒå›´æ˜¯ 0 - 2ï¼‰ï¼Œè¿™ä¼šå¯¼è‡´ä¸€ä¸ª<code>IndexOutOfRangeException</code>å¼‚å¸¸ã€‚</p><li>catch å—</li><p>åŠŸèƒ½ï¼šcatchå—ç”¨äºæ•è·tryå—ä¸­æŠ›å‡ºçš„ç‰¹å®šç±»å‹çš„å¼‚å¸¸ã€‚å½“tryå—ä¸­çš„ä»£ç æŠ›å‡ºå¼‚å¸¸åï¼Œç¨‹åºä¼šæŸ¥æ‰¾åŒ¹é…çš„catchå—æ¥å¤„ç†è¯¥å¼‚å¸¸ã€‚å¯ä»¥æœ‰å¤šä¸ªcatchå—ï¼Œæ¯ä¸ªcatchå—å¯ä»¥å¤„ç†ä¸åŒç±»å‹çš„å¼‚å¸¸ã€‚</p><li>ç¤ºä¾‹ï¼š</li><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span>[] numbers = &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> &#125;;</span><br><span class="line">    Console.WriteLine(numbers[<span class="number">3</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (IndexOutOfRangeException ex)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;æ•°ç»„ç´¢å¼•è¶…å‡ºèŒƒå›´ï¼Œå¼‚å¸¸ä¿¡æ¯ï¼š &quot;</span> + ex.Message);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œcatchå—æ•è·äº†<code>IndexOutOfRangeException</code>ç±»å‹çš„å¼‚å¸¸ã€‚exæ˜¯å¼‚å¸¸å¯¹è±¡ï¼Œé€šè¿‡å®ƒå¯ä»¥è®¿é—®å¼‚å¸¸çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚Messageå±æ€§åŒ…å«äº†å¼‚å¸¸çš„æ–‡æœ¬æè¿°ã€‚å½“å¼‚å¸¸è¢«æ•è·åï¼Œcatchå—ä¸­çš„ä»£ç ä¼šè¢«æ‰§è¡Œï¼Œè¿™é‡Œæ˜¯æ‰“å°å‡ºå¼‚å¸¸ä¿¡æ¯ã€‚</p><p><b>finally å—ï¼Œ</b></p><p>åŠŸèƒ½ï¼šfinallyå—ä¸­çš„ä»£ç æ— è®ºtryå—ä¸­æ˜¯å¦æŠ›å‡ºå¼‚å¸¸éƒ½ä¼šè¢«æ‰§è¡Œã€‚å®ƒé€šå¸¸ç”¨äºæ¸…ç†èµ„æºï¼Œä¾‹å¦‚å…³é—­æ–‡ä»¶ã€é‡Šæ”¾æ•°æ®åº“è¿æ¥ã€é‡Šæ”¾å†…å­˜ç­‰æ“ä½œï¼Œä»¥ç¡®ä¿ç¨‹åºçš„èµ„æºå¾—åˆ°æ­£ç¡®çš„ç®¡ç†ã€‚</p><li>ç¤ºä¾‹ï¼š</li><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">    FileStream fileStream = <span class="keyword">new</span> FileStream(<span class="string">&quot;test.txt&quot;</span>, FileMode.Open);</span><br><span class="line">    <span class="comment">// è¿™é‡Œå¯èƒ½ä¼šæœ‰è¯»å–æ–‡ä»¶ç­‰æ“ä½œï¼Œå¦‚æœå‡ºç°å¼‚å¸¸ï¼Œæ–‡ä»¶æµåº”è¯¥è¢«æ­£ç¡®å…³é—­</span></span><br><span class="line">    <span class="comment">// å‡è®¾è¿™é‡Œæœ‰ä¸€äº›å¯èƒ½å¯¼è‡´å¼‚å¸¸çš„ä»£ç ï¼Œæ¯”å¦‚è¯»å–æ–‡ä»¶å†…å®¹æ—¶æ–‡ä»¶æ ¼å¼é”™è¯¯</span></span><br><span class="line">    <span class="comment">// å…·ä½“çš„è¯»å–æ–‡ä»¶æ“ä½œä»£ç çœç•¥</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (FileNotFoundException ex)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;æ–‡ä»¶æœªæ‰¾åˆ°ï¼Œå¼‚å¸¸ä¿¡æ¯ï¼š &quot;</span> + ex.Message);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">finally</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// å…³é—­æ–‡ä»¶æµï¼Œæ— è®ºæ˜¯å¦å‡ºç°å¼‚å¸¸</span></span><br><span class="line">    <span class="keyword">if</span> (fileStream!= <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        fileStream.Close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œtryå—å°è¯•æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æµã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œä¼šæŠ›å‡º<code>FileNotFoundException</code>å¼‚å¸¸å¹¶è¢«catchå—æ•è·å¤„ç†ã€‚æ— è®ºæ˜¯å¦å‡ºç°å¼‚å¸¸ï¼Œfinallyå—ä¸­çš„ä»£ç éƒ½ä¼šå°è¯•å…³é—­æ–‡ä»¶æµï¼ˆè¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨å®é™…ä»£ç ä¸­ï¼Œæ›´æ¨èä½¿ç”¨usingè¯­å¥æ¥è‡ªåŠ¨ç®¡ç†æ–‡ä»¶æµç­‰èµ„æºï¼Œusingè¯­å¥åœ¨å†…éƒ¨ä¹Ÿä½¿ç”¨äº†try - finallyæœºåˆ¶ï¼‰ã€‚</p><p><b>å¼‚å¸¸ç±»å‹çš„å±‚æ¬¡ç»“æ„å’ŒåŒ¹é…è§„åˆ™</b></p><p>åœ¨ C# ä¸­ï¼Œæ‰€æœ‰å¼‚å¸¸ç±»å‹éƒ½æ´¾ç”Ÿè‡ª<code>System.Exception</code>ç±»ã€‚å½“æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸æ—¶ï¼Œcatchå—ä¼šæŒ‰ç…§ä»ä¸Šåˆ°ä¸‹çš„é¡ºåºæŸ¥æ‰¾åŒ¹é…çš„å¼‚å¸¸ç±»å‹æ¥å¤„ç†ã€‚</p><blockquote><p>ä¾‹å¦‚ï¼ŒSystem.ArithmeticExceptionæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼ŒDivideByZeroExceptionæ´¾ç”Ÿè‡ªå®ƒã€‚å¦‚æœæœ‰ä¸€ä¸ªtryå—æŠ›å‡ºäº†DivideByZeroExceptionå¼‚å¸¸ï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªcatchå—æ•è·System.ArithmeticExceptionï¼Œå¦ä¸€ä¸ªcatchå—æ•è·DivideByZeroExceptionï¼Œé‚£ä¹ˆä¼šä¼˜å…ˆåŒ¹é…DivideByZeroExceptionçš„catchå—ï¼Œå› ä¸ºå®ƒæ˜¯æœ€å…·ä½“çš„åŒ¹é…ã€‚</p></blockquote><li>ç¤ºä¾‹ï¼š</li><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span> a = <span class="number">10</span>;</span><br><span class="line">    <span class="built_in">int</span> b = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">int</span> result = a / b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (DivideByZeroException ex)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;é™¤æ•°ä¸èƒ½ä¸ºé›¶ï¼Œå¼‚å¸¸ä¿¡æ¯ï¼š &quot;</span> + ex.Message);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (ArithmeticException ex)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;ç®—æœ¯å¼‚å¸¸ï¼Œå¼‚å¸¸ä¿¡æ¯ï¼š &quot;</span> + ex.Message);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œtryå—ä¸­é™¤æ³•è¿ç®—é™¤æ•°ä¸ºé›¶ä¼šæŠ›å‡ºDivideByZeroExceptionï¼Œå®ƒä¼šè¢«ç¬¬ä¸€ä¸ªcatchå—æ•è·ï¼Œè€Œä¸ä¼šåŒ¹é…ç¬¬äºŒä¸ªcatchå—ï¼Œå› ä¸ºDivideByZeroExceptionæ›´å…·ä½“åœ°åŒ¹é…äº†æŠ›å‡ºçš„å¼‚å¸¸ç±»å‹ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Csharp </tag>
            
            <tag> Visual Studio 2022 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‡½æ•°clac(),css åª’ä½“æŸ¥è¯¢</title>
      <link href="/2025/01/24/css/clac(),css%20%E5%AA%92%E4%BD%93%E6%9F%A5%E8%AF%A2/"/>
      <url>/2025/01/24/css/clac(),css%20%E5%AA%92%E4%BD%93%E6%9F%A5%E8%AF%A2/</url>
      
        <content type="html"><![CDATA[<h1 style="font-size:59px;color:#0DE6FE;font-family:åæ–‡è¡Œæ¥·">calc</h1><p>åœ¨ CSS ä¸­ï¼Œcalc() æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å‡½æ•°ï¼Œå®ƒå…è®¸ä½ åœ¨ CSS å±æ€§å€¼ä¸­è¿›è¡Œæ•°å­¦è®¡ç®—ã€‚è¿™ä½¿å¾—ä½ å¯ä»¥æ ¹æ®ä¸åŒçš„é•¿åº¦å•ä½ï¼ˆå¦‚åƒç´ ã€ç™¾åˆ†æ¯”ç­‰ï¼‰åŠ¨æ€åœ°è®¡ç®—å±æ€§å€¼ï¼Œä¸ºç½‘é¡µå¸ƒå±€æä¾›äº†æ›´å¤§çš„çµæ´»æ€§ã€‚ä»¥ä¸‹æ˜¯å…³äº calc() çš„è¯¦ç»†ä»‹ç»ï¼š</p><p><b>åŸºæœ¬è¯­æ³•</b></p><li>calc() å‡½æ•°çš„åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š</li><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">calc(expression)</span><br></pre></td></tr></table></figure><blockquote><p>å…¶ä¸­ expression æ˜¯ä¸€ä¸ªæ•°å­¦è¡¨è¾¾å¼ï¼Œè¯¥è¡¨è¾¾å¼å¯ä»¥åŒ…å«åŠ ï¼ˆ+ï¼‰ã€å‡ï¼ˆ-ï¼‰ã€ä¹˜ï¼ˆ*ï¼‰ã€é™¤ï¼ˆ&#x2F;ï¼‰å››ç§åŸºæœ¬è¿ç®—ç¬¦ï¼ŒåŒæ—¶å¯ä»¥ä½¿ç”¨ä¸åŒçš„é•¿åº¦å•ä½ï¼Œå¦‚ pxã€%ã€emã€rem ç­‰ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿ç®—ç¬¦å‰åå¿…é¡»æœ‰ç©ºæ ¼ã€‚<br>ç¤ºä¾‹ä»£ç åŠè§£é‡Š</p></blockquote><ol><li>ä½¿ç”¨ calc() è¿›è¡Œå®½åº¦è®¡ç®—<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.parent</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">width</span>: <span class="number">800px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background-color</span>: lightgray;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">padding</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.child</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="comment">/* å­å…ƒç´ å®½åº¦ä¸ºçˆ¶å…ƒç´ å®½åº¦å‡å»40px */</span></span></span><br><span class="line"><span class="language-css">      <span class="attribute">width</span>: <span class="built_in">calc</span>(<span class="number">100%</span> - <span class="number">40px</span>);</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background-color</span>: lightblue;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">height</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">  </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;parent&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;child&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><blockquote><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œ.child å…ƒç´ çš„å®½åº¦é€šè¿‡ calc(100% - 40px) è®¡ç®—å¾—å‡ºï¼Œå³çˆ¶å…ƒç´ å®½åº¦å‡å» 40pxã€‚è¿™æ ·å¯ä»¥ç¡®ä¿å­å…ƒç´ åœ¨çˆ¶å…ƒç´ å†…éƒ¨æœ‰ä¸€å®šçš„å·¦å³è¾¹è·ã€‚</p></blockquote><ol start="2"><li>ä½¿ç”¨ calc() è¿›è¡Œé«˜åº¦è®¡ç®—<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">html</span>,</span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.box</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="comment">/* å…ƒç´ é«˜åº¦ä¸ºè§†å£é«˜åº¦çš„50%åŠ ä¸Š20px */</span></span></span><br><span class="line"><span class="language-css">      <span class="attribute">height</span>: <span class="built_in">calc</span>(<span class="number">50vh</span> + <span class="number">20px</span>);</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background-color</span>: lightgreen;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">  </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><blockquote><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ.box å…ƒç´ çš„é«˜åº¦é€šè¿‡ calc(50vh + 20px) è®¡ç®—ï¼Œå³è§†å£é«˜åº¦çš„ 50% å†åŠ ä¸Š 20pxã€‚</p></blockquote><br><p><b>æ³¨æ„äº‹é¡¹</b></p><li>è¿ç®—ç¬¦å‰åçš„ç©ºæ ¼ï¼šåœ¨ calc() å‡½æ•°ä¸­ï¼Œè¿ç®—ç¬¦ï¼ˆ+ã€-ã€*ã€/ï¼‰å‰åå¿…é¡»æœ‰ç©ºæ ¼ï¼Œå¦åˆ™è¡¨è¾¾å¼å°†æ— æ•ˆã€‚ä¾‹å¦‚ï¼Œcalc(100% - 40px) æ˜¯æ­£ç¡®çš„ï¼Œè€Œ calc(100%-40px) æ˜¯é”™è¯¯çš„ã€‚</li><li>è®¡ç®—è§„åˆ™ï¼šä¹˜æ³•å’Œé™¤æ³•è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§é«˜äºåŠ æ³•å’Œå‡æ³•è¿ç®—ç¬¦ã€‚ä¾‹å¦‚ï¼Œcalc(10px + 5 * 2px) ä¼šå…ˆè®¡ç®— 5 * 2pxï¼Œå†åŠ ä¸Š 10pxï¼Œç»“æœä¸º 20pxã€‚</li><li>å…¼å®¹æ€§ï¼šcalc() å‡½æ•°åœ¨ç°ä»£æµè§ˆå™¨ä¸­å¾—åˆ°äº†å¹¿æ³›æ”¯æŒï¼Œä½†åœ¨ä¸€äº›æ—§ç‰ˆæœ¬çš„æµè§ˆå™¨ä¸­å¯èƒ½å­˜åœ¨å…¼å®¹æ€§é—®é¢˜ã€‚åœ¨ä½¿ç”¨æ—¶ï¼Œå»ºè®®è¿›è¡Œå…¼å®¹æ€§æµ‹è¯•ã€‚</li><br><h1 style="font-size:30px;color:#220DFE;font-family:åæ–‡è¡Œæ¥·">åª’ä½“æŸ¥è¯¢</h1><p>CSS åª’ä½“æŸ¥è¯¢æ˜¯å®ç°ç½‘é¡µå“åº”å¼è®¾è®¡çš„å…³é”®æŠ€æœ¯ï¼Œå®ƒèƒ½è®©ç½‘é¡µåœ¨ä¸åŒè®¾å¤‡å’Œå±å¹•å°ºå¯¸ä¸‹éƒ½æœ‰è‰¯å¥½çš„æ˜¾ç¤ºæ•ˆæœã€‚ä»¥ä¸‹ä»åŸºç¡€æ¦‚å¿µã€è¯­æ³•ã€å¸¸è§åº”ç”¨åœºæ™¯å’Œæ³¨æ„äº‹é¡¹ç­‰æ–¹é¢è¯¦ç»†ä»‹ç» CSS åª’ä½“æŸ¥è¯¢çš„å­¦ä¹ è¦ç‚¹ã€‚</p><p><b>åŸºç¡€æ¦‚å¿µ</b></p><blockquote><p>åª’ä½“æŸ¥è¯¢å…è®¸ä½ æ ¹æ®è®¾å¤‡çš„å„ç§ç‰¹æ€§ï¼ˆå¦‚å±å¹•å®½åº¦ã€é«˜åº¦ã€åˆ†è¾¨ç‡ã€è®¾å¤‡æ–¹å‘ç­‰ï¼‰æ¥åº”ç”¨ä¸åŒçš„ CSS æ ·å¼ã€‚é€šè¿‡åª’ä½“æŸ¥è¯¢ï¼Œå¯ä»¥ä¸ºä¸åŒçš„è®¾å¤‡ç¯å¢ƒå®šåˆ¶ç‰¹å®šçš„æ ·å¼è§„åˆ™ï¼Œä»è€Œå®ç°ç½‘é¡µåœ¨å¤šç§è®¾å¤‡ä¸Šçš„è‡ªé€‚åº”å¸ƒå±€ã€‚</p></blockquote><p><b>åŸºæœ¬è¯­æ³•</b></p><li>åª’ä½“æŸ¥è¯¢ä½¿ç”¨ @media è§„åˆ™ï¼Œå…¶åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š</li><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@media</span> media_type <span class="keyword">and</span> (media_feature) &#123;</span><br><span class="line">    <span class="comment">/* å½“æ¡ä»¶æ»¡è¶³æ—¶åº”ç”¨çš„ CSS è§„åˆ™ */</span></span><br><span class="line">    selector &#123;</span><br><span class="line">        property: value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>media_typeï¼ˆåª’ä½“ç±»å‹ï¼‰ï¼šæŒ‡å®šé€‚ç”¨çš„è®¾å¤‡ç±»å‹ï¼Œå¸¸è§å€¼æœ‰ï¼š<br>allï¼šé€‚ç”¨äºæ‰€æœ‰è®¾å¤‡ï¼Œæ˜¯é»˜è®¤å€¼ã€‚<br>screenï¼šç”¨äºè®¡ç®—æœºå±å¹•ã€å¹³æ¿ç”µè„‘ã€æ™ºèƒ½æ‰‹æœºç­‰ã€‚<br>printï¼šç”¨äºæ‰“å°æœºå’Œæ‰“å°é¢„è§ˆã€‚<br>speechï¼šç”¨äºå±å¹•é˜…è¯»å™¨ç­‰è¯­éŸ³åˆæˆè®¾å¤‡ã€‚<br>media_featureï¼ˆåª’ä½“ç‰¹æ€§ï¼‰ï¼šæè¿°è®¾å¤‡çš„å…·ä½“ç‰¹æ€§ï¼Œé€šå¸¸ä»¥æ‹¬å·åŒ…è£¹ã€‚å¸¸è§çš„åª’ä½“ç‰¹æ€§æœ‰ï¼š<br>widthã€min-width å’Œ max-widthï¼šåˆ†åˆ«è¡¨ç¤ºå±å¹•å®½åº¦ã€æœ€å°å±å¹•å®½åº¦å’Œæœ€å¤§å±å¹•å®½åº¦ã€‚ä¾‹å¦‚ (min-width: 768px) è¡¨ç¤ºå±å¹•å®½åº¦å¤§äºç­‰äº 768 åƒç´ ã€‚<br>heightã€min-height å’Œ max-heightï¼šåˆ†åˆ«è¡¨ç¤ºå±å¹•é«˜åº¦ã€æœ€å°å±å¹•é«˜åº¦å’Œæœ€å¤§å±å¹•é«˜åº¦ã€‚<br>orientationï¼šè¡¨ç¤ºè®¾å¤‡çš„æ–¹å‘ï¼Œå€¼ä¸º portraitï¼ˆç«–å±ï¼‰æˆ– landscapeï¼ˆæ¨ªå±ï¼‰ã€‚</p></blockquote><p><b>é€»è¾‘è¿ç®—ç¬¦</b></p><p>å¯ä»¥ä½¿ç”¨é€»è¾‘è¿ç®—ç¬¦ç»„åˆå¤šä¸ªåª’ä½“ç‰¹æ€§æˆ–åª’ä½“ç±»å‹ï¼Œä½¿æŸ¥è¯¢æ¡ä»¶æ›´çµæ´»ï¼š</p><p><code>andï¼š</code>ç”¨äºè¿æ¥å¤šä¸ªåª’ä½“ç‰¹æ€§ï¼Œè¡¨ç¤ºæ‰€æœ‰æ¡ä»¶éƒ½å¿…é¡»æ»¡è¶³ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">min-width</span>: <span class="number">768px</span>) <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">1023px</span>) &#123;</span><br><span class="line">    <span class="selector-tag">body</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ä¸Šè¿°ä»£ç è¡¨ç¤ºåœ¨å±å¹•è®¾å¤‡ä¸”å®½åº¦åœ¨ 768px åˆ° 1023px ä¹‹é—´æ—¶ï¼Œå°† body å…ƒç´ çš„å­—ä½“å¤§å°è®¾ç½®ä¸º 16pxã€‚<br>,ï¼ˆé€—å·ï¼‰ï¼šè¡¨ç¤ºæˆ–çš„å…³ç³»ï¼Œåªè¦å…¶ä¸­ä¸€ä¸ªæ¡ä»¶æ»¡è¶³å³å¯ã€‚ä¾‹å¦‚ï¼š</p></blockquote><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">767px</span>), print &#123;</span><br><span class="line">    <span class="selector-class">.sidebar</span> &#123;</span><br><span class="line">        <span class="attribute">display</span>: none;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¿™æ®µä»£ç è¡¨ç¤ºåœ¨å±å¹•è®¾å¤‡å®½åº¦å°äºç­‰äº 767px æˆ–è€…åœ¨æ‰“å°æ—¶ï¼Œéšè— sidebar å…ƒç´ ã€‚<br>notï¼šç”¨äºå–åæŸ¥è¯¢ç»“æœã€‚ä¾‹å¦‚ï¼š</p></blockquote><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@media</span> <span class="keyword">not</span> screen <span class="keyword">and</span> (<span class="attribute">min-width</span>: <span class="number">768px</span>) &#123;</span><br><span class="line">    <span class="comment">/* æ ·å¼è§„åˆ™ */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¡¨ç¤ºé™¤äº†å±å¹•è®¾å¤‡ä¸”å®½åº¦å¤§äºç­‰äº 768px çš„æƒ…å†µå¤–ï¼Œåº”ç”¨è¿™äº›æ ·å¼ã€‚<br>å¸¸è§åº”ç”¨åœºæ™¯</p></blockquote><ol><li>å“åº”å¼å¸ƒå±€</li></ol><p>æ ¹æ®ä¸åŒå±å¹•å®½åº¦è°ƒæ•´é¡µé¢å¸ƒå±€ã€‚ä¾‹å¦‚ï¼Œåœ¨å°å±å¹•è®¾å¤‡ä¸Šé‡‡ç”¨å•åˆ—å¸ƒå±€ï¼Œå¤§å±å¹•è®¾å¤‡ä¸Šé‡‡ç”¨å¤šåˆ—å¸ƒå±€ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* å°å±å¹•è®¾å¤‡ï¼ˆå®½åº¦å°äº 768pxï¼‰ */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">767px</span>) &#123;</span><br><span class="line">    <span class="selector-class">.column</span> &#123;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* ä¸­ç­‰å±å¹•è®¾å¤‡ï¼ˆå®½åº¦åœ¨ 768px åˆ° 1023px ä¹‹é—´ï¼‰ */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">min-width</span>: <span class="number">768px</span>) <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">1023px</span>) &#123;</span><br><span class="line">    <span class="selector-class">.column</span> &#123;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">50%</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* å¤§å±å¹•è®¾å¤‡ï¼ˆå®½åº¦å¤§äºç­‰äº 1024pxï¼‰ */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">min-width</span>: <span class="number">1024px</span>) &#123;</span><br><span class="line">    <span class="selector-class">.column</span> &#123;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">33.33%</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>å­—ä½“å¤§å°è°ƒæ•´</li></ol><p>åœ¨ä¸åŒå±å¹•å°ºå¯¸ä¸‹è°ƒæ•´å­—ä½“å¤§å°ä»¥æé«˜å¯è¯»æ€§ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* å°å±å¹•è®¾å¤‡ */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">767px</span>) &#123;</span><br><span class="line">    <span class="selector-tag">body</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* å¤§å±å¹•è®¾å¤‡ */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">min-width</span>: <span class="number">1024px</span>) &#123;</span><br><span class="line">    <span class="selector-tag">body</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">18px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>å›¾ç‰‡æ˜¾ç¤ºä¼˜åŒ–</li></ol><p>æ ¹æ®è®¾å¤‡åˆ†è¾¨ç‡å’Œå±å¹•å¤§å°æ˜¾ç¤ºä¸åŒå°ºå¯¸çš„å›¾ç‰‡ï¼ŒèŠ‚çœå¸¦å®½ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* å°å±å¹•è®¾å¤‡ */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">767px</span>) &#123;</span><br><span class="line">    <span class="selector-class">.image</span> &#123;</span><br><span class="line">        <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">&#x27;small-image.jpg&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* å¤§å±å¹•è®¾å¤‡ */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">min-width</span>: <span class="number">1024px</span>) &#123;</span><br><span class="line">    <span class="selector-class">.image</span> &#123;</span><br><span class="line">        <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">&#x27;large-image.jpg&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><b>æ³¨æ„äº‹é¡¹</b></p><li>åª’ä½“æŸ¥è¯¢é¡ºåºï¼šåª’ä½“æŸ¥è¯¢çš„é¡ºåºå¾ˆé‡è¦ï¼Œå› ä¸ºåé¢çš„è§„åˆ™å¯èƒ½ä¼šè¦†ç›–å‰é¢çš„è§„åˆ™ã€‚ä¸€èˆ¬å»ºè®®æŒ‰ç…§ä»å°åˆ°å¤§ï¼ˆæˆ–ä»å¤§åˆ°å°ï¼‰çš„å±å¹•å°ºå¯¸é¡ºåºç¼–å†™åª’ä½“æŸ¥è¯¢ã€‚</li><li>æµè§ˆå™¨å…¼å®¹æ€§ï¼šç°ä»£æµè§ˆå™¨å¯¹åª’ä½“æŸ¥è¯¢çš„æ”¯æŒå¾ˆå¥½ï¼Œä½†åœ¨ä¸€äº›æ—§ç‰ˆæœ¬æµè§ˆå™¨ä¸­å¯èƒ½å­˜åœ¨å…¼å®¹æ€§é—®é¢˜ã€‚å¯ä»¥ä½¿ç”¨ CSS å‰ç¼€æˆ–å€ŸåŠ© CSS é¢„å¤„ç†å™¨ï¼ˆå¦‚ Sassã€Lessï¼‰æ¥å¤„ç†å…¼å®¹æ€§ã€‚</li><li>æ€§èƒ½è€ƒè™‘ï¼šè¿‡å¤šå¤æ‚çš„åª’ä½“æŸ¥è¯¢å¯èƒ½ä¼šå½±å“é¡µé¢æ€§èƒ½ï¼Œå°¤å…¶æ˜¯åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šã€‚å°½é‡ä¿æŒåª’ä½“æŸ¥è¯¢ç®€æ´ï¼Œé¿å…ä¸å¿…è¦çš„åµŒå¥—å’Œå¤æ‚é€»è¾‘ã€‚</li>]]></content>
      
      
      <categories>
          
          <category> CSSåŸºç¡€ </category>
          
          <category> Visual Studio Code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
            <tag> Visual Studio Code </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­¦ä¹ CSS.14å­¦ä¹ ç¬”è®°</title>
      <link href="/2025/01/24/css/%E5%AD%A6%E4%B9%A0css.14/"/>
      <url>/2025/01/24/css/%E5%AD%A6%E4%B9%A0css.14/</url>
      
        <content type="html"><![CDATA[<h1 style="font-size:30px;color:#F30000;font-family:åæ–‡è¡Œæ¥·">ä¼¸ç¼©å®¹å™¨ï¼Œä¼¸ç¼©é¡¹ç›®</h1><li><b>ä¼¸ç¼©å®¹å™¨</b>ï¼šå¼€å¯äº†<code>flex</code>çš„å…ƒç´ ï¼Œå°±æ˜¯ï¼šä¼¸ç¼©å®¹å™¨ã€‚</li><blockquote><p>1.ç»™å…ƒç´ è®¾ç½®ï¼š<mark>dispay:flex</mark>æˆ–<mark>display:inline-flex</mark>ï¼Œè¯¥å…ƒç´ å°±å˜ä¸ºäº†ä¼¸ç¼©å®¹å™¨ã€‚<br>2.<mark>display:inline-flex</mark>å¾ˆå°‘ä½¿ç”¨ï¼Œå› ä¸ºå¯ä»¥ç»™å¤šä¸ªä¼¸ç¼©å®¹å™¨çš„çˆ¶å®¹å™¨ï¼Œä¹Ÿè®¾ç½®ä¸ºä¼¸ç¼©å®¹å™¨ã€‚<br>3.ä¸€ä¸ªå…ƒç´ å¯ä»¥åŒæ—¶æ˜¯ï¼šä¼¸ç¼©å®¹å™¨ã€ä¼¸ç¼©é¡¹ç›®ã€‚</p></blockquote><li><b>ä¼¸ç¼©é¡¹ç›®</b>:ä¼¸ç¼©å®¹å™¨æ‰€æœ‰<mark>å­å…ƒç´ </mark>è‡ªåŠ¨æˆä¸ºäº†ï¼šä¼¸ç¼©é¡¹ç›®ã€‚</li><blockquote><p>1.ä»…ä¼¸ç¼©å®¹å™¨çš„<mark>å­å…ƒç´ </mark>æˆä¸ºäº†ä¼¸ç¼©é¡¹ç›®ï¼Œå­™å­å…ƒç´ ã€é‡å­™å­å…ƒç´ ç­‰åä»£ï¼Œä¸æ˜¯ä¼¸ç¼©é¡¹ç›®ã€‚<br>2.æ— è®ºåŸæ¥æ˜¯å“ªç§å…ƒç´ ï¼ˆå¿«ã€è¡Œå†…å—ã€è¡Œå†…ï¼‰ï¼Œä¸€æ—¦æˆä¸ºäº†ä¼¸ç¼©é¡¹ç›®ï¼Œå…¨éƒ½ä¼šâ€œå—çŠ¶åŒ–â€ã€‚</p></blockquote><h1 style="font-size:30px;color:#F30000;font-family:åæ–‡è¡Œæ¥·">ä¸»è½´ä¸ä¾§è½´</h1><li><b>ä¸»è½´</b>ï¼šä¼¸ç¼©é¡¹ç›®æ²¿ç€ä¸»è½´æ’åˆ—ï¼Œä¸»è½´é»˜è®¤æ˜¯æ°´å¹³çš„ï¼Œé»˜è®¤æ–¹å‘æ˜¯ï¼šä»å·¦åˆ°å³ï¼ˆå·¦è¾¹æ˜¯èµ·ç‚¹ï¼Œå³è¾¹æ˜¯ç»ˆç‚¹ï¼‰ã€‚</li><li><b>ä¾§è½´</b>ï¼šä¸ä¸»è½´å‚ç›´çš„å°±æ˜¯ä¾§è½´ï¼Œä¾§è½´é»˜è®¤æ˜¯å‚ç›´çš„ï¼Œé»˜è®¤æ–¹å‘æ˜¯ï¼šä»ä¸Šåˆ°ä¸‹ï¼ˆä¸Šè¾¹æ˜¯èµ·ç‚¹ï¼Œä¸‹è¾¹æ˜¯ç»ˆç‚¹ï¼‰ã€‚</li><h1 style="font-size:30px;color:#F30000;font-family:åæ–‡è¡Œæ¥·">ä¸»è½´æ–¹å‘</h1><li>å±æ€§åï¼š<code>flex-direction</code></li><li>å¸¸ç”¨å€¼å¦‚ä¸‹:</li><ol>    <li><code>row</code>ï¼šä¸»è½´æ–¹å‘æ°´å¹³ä»å·¦åˆ°å³--é»˜è®¤å€¼</li>    <li><code>row-reverse</code>ï¼šä¸»è½´æ–¹å‘æ°´å¹³ä»å³åˆ°å·¦ã€‚</li>    <li><code>column</code>ï¼šä¸»è½´æ–¹å‘å‚ç›´ä»ä¸Šåˆ°ä¸‹ã€‚</li>    <li><code>column-reverse</code>ï¼šä¸»è½´æ–¹å‘å‚ç›´ä»ä¸‹åˆ°ä¸Šã€‚</li>    </ol> <blockquote><p>æ³¨æ„ï¼šæ”¹å˜äº†ä¸»è½´çš„æ–¹å‘ï¼Œä¾§è½´æ–¹å‘ä¹Ÿä¼šéšä¹‹æ”¹å˜ã€‚</p></blockquote><h1 style="font-size:30px;color:#F30000;font-family:åæ–‡è¡Œæ¥·">ä¸»è½´æ¢è¡Œæ–¹å¼</h1><li>å±æ€§åï¼š<mark>flex-wrap</mark></li><li>å¸¸ç”¨å€¼å¦‚ä¸‹ï¼š</li><ol>    <li><code>nowrap</code>ï¼šé»˜è®¤å€¼ï¼Œä¸æ¢è¡Œã€‚</li>    <li><code>wrap</code>ï¼šè‡ªåŠ¨æ¢è¡Œï¼Œä¼¸ç¼©å®¹å™¨ä¸å¤Ÿè‡ªåŠ¨æ¢è¡Œã€‚</li>    <li><code>wrap-reverse</code>ï¼šåå‘æ¢è¡Œã€‚</li>    </ol>        <h1 style="font-size:30px;color:#F30000;font-family:åæ–‡è¡Œæ¥·">ä¸»è½´å¯¹é½æ–¹å¼</h1><li>å±æ€§å</li>ï¼š<mark>justify-content</mark></li><li>å¸¸ç”¨å€¼å¦‚ä¸‹ï¼š</li><ol>    <li><code>flex-start</code>ï¼šä¸»è½´èµ·ç‚¹å¯¹é½ã€‚--é»˜è®¤å€¼</li>    <li><code>flex-end</code>ï¼šä¸»è½´ç»ˆç‚¹å¯¹é½ã€‚</li>    <li><code>center</code>ï¼šå±…ä¸­å¯¹é½</li>    <li><code>space-between</code>ï¼šå‡åŒ€åˆ†å¸ƒï¼Œä¸¤ç«¯å¯¹é½ï¼ˆæœ€å¸¸ç”¨ï¼‰ã€‚</li>    <li><code>space-around</code>ï¼šå‡åŒ€åˆ†å¸ƒï¼Œä¸¤ç«¯è·ç¦»æ˜¯ä¸­é—´è·ç¦»çš„ä¸€åŠã€‚</li>    <li><code>space-evenly</code>ï¼šå‡åŒ€åˆ†å¸ƒï¼Œä¸¤ç«¯è·ç¦»ä¸ä¸­é—´è·ç¦»ä¸€è‡´ã€‚</li>    </ol><h1 style="font-size:30px;color:#F30000;font-family:åæ–‡è¡Œæ¥·">ä¾§è½´å¯¹é½æ–¹å¼</h1>        <p><b>åªæœ‰ä¸€è¡Œçš„æƒ…å†µ</b></p><li>æ‰€éœ€å±æ€§ï¼š<mark>align-items</mark></li><li>å¸¸ç”¨å€¼å¦‚ä¸‹ï¼š</li><ol>    <li><code>flex-start</code>ï¼šä¾§è½´çš„èµ·ç‚¹å¯¹é½ã€‚</li>    <li><code>flex-end</code>ï¼šä¾§è½´çš„ç»ˆç‚¹å¯¹é½ã€‚</li>    <li><code>center</code>ï¼šä¾§è½´çš„ä¸­ç‚¹å¯¹é½ã€‚</li>    <li><code>baseline</code>ï¼šä¼¸ç¼©é¡¹ç›®çš„ç¬¬ä¸€è¡Œæ–‡å­—çš„åŸºçº¿å¯¹é½ã€‚</li>    <li><code>stretch</code>ï¼šå¦‚æœä¼¸ç¼©é¡¹ç›®æœªè®¾ç½®é«˜åº¦ï¼Œå°†å æ»¡æ•´ä¸ªå®¹å™¨çš„é«˜åº¦ã€‚--é»˜è®¤å€¼</li>    </ol><p><b>å¤šè¡Œçš„æƒ…å†µ</b></p><li>æ‰€éœ€å±æ€§ï¼š<mark>align-content</mark></li><li>å¸¸ç”¨å€¼å¦‚ä¸‹ï¼š</li><ol>    <li><code>flex-start</code>ï¼šä¸ä¾§è½´çš„èµ·ç‚¹å¯¹é½ã€‚</li>    <li><code>flex-end</code>ï¼šä¸ä¾§è½´çš„ç»ˆç‚¹å¯¹é½ã€‚</li>    <li><code>center</code>ï¼šä¸ä¾§è½´çš„ä¸­ç‚¹å¯¹é½ã€‚</li>    <li><code>space-between</code>ï¼šä¸ä¾§è½´ä¸¤ç«¯å¯¹é½ï¼Œä¸­é—´å¹³å‡åˆ†å¸ƒã€‚</li>    <li><code>space-around</code>ï¼šä¼¸ç¼©é¡¹ç›®é—´çš„è·ç¦»ç›¸ç­‰ï¼Œæ¯”è·è¾¹ç¼˜å¤§ä¸€å€ã€‚</li>    <li><code>space-evenly</code>ï¼šåœ¨ä¾§è½´ä¸Šå®Œå…¨å¹³åˆ†</li>    <li><code>stretch</code>ï¼šå æ»¡æ•´ä¸ªä¾§è½´ã€‚--é»˜è®¤å€¼</li>    </ol><h1 style="font-size:30px;color:#F30000;font-family:åæ–‡è¡Œæ¥·">ä¼¸ç¼©ç›’æ¨¡å‹_ä¼¸</h1> <p><b><mark>flex-grow</mark></b></p><li>æ¦‚å¿µï¼š<code>flex-grow</code>å®šä¹‰ä¼¸ç¼©é¡¹ç›®çš„æ”¾å¤§æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º0ï¼Œå³ï¼šçºµä½¿ä¸»è½´å­˜åœ¨å‰©ä½™ç©ºé—´ï¼Œä¹Ÿä¸æ‹‰ä¼¸ï¼ˆæ”¾å¤§ï¼‰ã€‚</li><li>è§„åˆ™ï¼š</li><ol>    <li>è‹¥æ‰€æœ‰ä¼¸ç¼©é¡¹ç›®çš„<code>flex-grow</code>å€¼ä¸º1ï¼Œåˆ™ï¼šå®ƒä»¬å°†ç­‰åˆ†å‰©ä½™ç©ºé—´ï¼ˆå¦‚æœæœ‰ç©ºé—´çš„è¯ï¼‰ã€‚</li>    <li>è‹¥ä¸‰ä¸ªä¼¸ç¼©é¡¹ç›®çš„<code>flex-grow</code>å€¼åˆ†åˆ«ä¸ºï¼š1ã€2ã€3ï¼Œåˆ™ï¼šåˆ†åˆ«ç“œåˆ†åˆ°ï¼š1/6ã€2/6ã€3/6çš„ç©ºé—´ã€‚</li>    </ol><h1 style="font-size:30px;color:#F30000;font-family:åæ–‡è¡Œæ¥·">ä¼¸ç¼©ç›’æ¨¡å‹_ç¼©</h1> <p><b><mark>flex-shrink</mark></b></p><li>æ¦‚å¿µï¼š<code>flex-shrink</code>å®šä¹‰äº†é¡¹ç›®çš„å‹ç¼©æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º1ï¼Œå³ï¼šå¦‚æœç©ºé—´ä¸è¶³ï¼Œè¯¥é¡¹ç›®å°†ä¼šç¼©å°ã€‚</li><h1 style="font-size:30px;color:#F30000;font-family:åæ–‡è¡Œæ¥·">flexç¬¦åˆå±æ€§</h1><p><mark>flex</mark>æ˜¯å¤åˆå±æ€§ï¼Œå¤åˆäº†ï¼š<code>flex-growã€flex-shrinkã€flex-bassis</code>ä¸‰ä¸ªå±æ€§ï¼Œé»˜è®¤å€¼ä¸º0ã€0ã€autoã€‚</p><li>å¦‚æœå†™<code>flex:1 1 auto</code>ï¼Œåˆ™å¯ç®€å†™ä¸ºï¼š<code>flex:auto</code></li><li>å¦‚æœå†™<code>flex:1 1 0</code>ï¼Œåˆ™å¯ç®€å†™ä¸ºï¼š<code>flex:auto</code></li><li>å¦‚æœå†™<code>flex:0 0 auto</code>ï¼Œåˆ™å¯ç®€å†™ä¸ºï¼š<code>flex:1</code></li><li>å¦‚æœå†™<code>flex:0 1 auto</code>ï¼Œåˆ™å¯ç®€å†™ä¸ºï¼š<code>flex:0 auto -- å³flexåˆå§‹å€¼</code></li><h1 style="font-size:30px;color:#F30000;font-family:åæ–‡è¡Œæ¥·">é¡¹ç›®æ’åº</h1><li><code>order</code>å±æ€§å®šä¹‰é¡¹ç›®çš„æ’åˆ—é¡ºåºã€‚æ•°å€¼è¶Šå°ï¼Œæ’åˆ—è¶Šé å‰ï¼Œé»˜è®¤å€¼ä¸º0ã€‚</li><h1 style="font-size:30px;color:#F30000;font-family:åæ–‡è¡Œæ¥·">å•ç‹¬å¯¹é½</h1><li>é€šè¿‡<code>align-self</code>å±æ€§ï¼Œå¯ä»¥å•ç‹¬è°ƒæ•´æŸä¸ªä¼¸ç¼©é¡¹ç›®çš„å¯¹é½æ–¹å¼ã€‚</li><li>é»˜è®¤å€¼ä¸ºauto,è¡¨ç¤ºç»§æ‰¿çˆ¶å…ƒç´ çš„align-itemså±æ€§ã€‚</li>    ]]></content>
      
      
      <categories>
          
          <category> CSSåŸºç¡€ </category>
          
          <category> Visual Studio Code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
            <tag> Visual Studio Code </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­¦ä¹ CSS.13å­¦ä¹ ç¬”è®°</title>
      <link href="/2025/01/23/css/%E5%AD%A6%E4%B9%A0css.13/"/>
      <url>/2025/01/23/css/%E5%AD%A6%E4%B9%A0css.13/</url>
      
        <content type="html"><![CDATA[<h1 style="font-size:30px;color:#B72795;font-family:åæ–‡è¡Œæ¥·">CSS åŠ¨ç”»</h1><p><b>ç›¸è¾ƒäºä¼ ç»Ÿçš„è„šæœ¬å®ç°åŠ¨ç”»æŠ€æœ¯ï¼Œä½¿ç”¨ CSS åŠ¨ç”»æœ‰ä¸‰ä¸ªä¸»è¦ä¼˜ç‚¹ï¼š</b></p><p>1.èƒ½å¤Ÿéå¸¸å®¹æ˜“åœ°åˆ›å»ºç®€å•åŠ¨ç”»ï¼Œä½ ç”šè‡³ä¸éœ€è¦äº†è§£ JavaScript å°±èƒ½åˆ›å»ºåŠ¨ç”»ã€‚</p><p>2.åŠ¨ç”»è¿è¡Œæ•ˆæœè‰¯å¥½ï¼Œç”šè‡³åœ¨ä½æ€§èƒ½çš„ç³»ç»Ÿä¸Šã€‚æ¸²æŸ“å¼•æ“ä¼šä½¿ç”¨è·³å¸§æˆ–è€…å…¶ä»–æŠ€æœ¯ä»¥ä¿è¯åŠ¨ç”»è¡¨ç°å°½å¯èƒ½çš„æµç•…ã€‚è€Œä½¿  ç”¨ JavaScript å®ç°çš„åŠ¨ç”»é€šå¸¸è¡¨ç°ä¸ä½³ï¼ˆé™¤éç»è¿‡å¾ˆå¥½çš„è®¾è®¡ï¼‰ã€‚</p><p>3.è®©æµè§ˆå™¨æ§åˆ¶åŠ¨ç”»åºåˆ—ï¼Œå…è®¸æµè§ˆå™¨ä¼˜åŒ–æ€§èƒ½å’Œæ•ˆæœï¼Œå¦‚é™ä½ä½äºéšè—é€‰é¡¹å¡ä¸­çš„åŠ¨ç”»æ›´æ–°é¢‘ç‡ã€‚</p><br><p>CSS åŠ¨ç”»æ˜¯ç½‘é¡µè®¾è®¡ä¸­ç”¨äºåˆ›å»ºåŠ¨æ€å’Œäº¤äº’æ•ˆæœçš„å¼ºå¤§å·¥å…·ï¼Œä»¥ä¸‹æ˜¯å…³äº CSS åŠ¨ç”»çš„å­¦ä¹ å†…å®¹ï¼š</p><p style="font-size:20px"><b>åŸºæœ¬æ¦‚å¿µ</b></p><li><b>å…³é”®å¸§</b>ï¼šCSS åŠ¨ç”»é€šè¿‡å®šä¹‰å…³é”®å¸§æ¥æè¿°åŠ¨ç”»çš„ä¸åŒçŠ¶æ€ã€‚å…³é”®å¸§ä½¿ç”¨@keyframesè§„åˆ™æ¥åˆ›å»ºï¼Œå®ƒå…è®¸ä½ æŒ‡å®šåŠ¨ç”»åœ¨ä¸åŒæ—¶é—´ç‚¹çš„å±æ€§å€¼ã€‚</li><li><b>åŠ¨ç”»å±æ€§</b>ï¼šé€šè¿‡ä¸€ç³»åˆ— CSS åŠ¨ç”»å±æ€§æ¥æ§åˆ¶åŠ¨ç”»çš„è¡Œä¸ºï¼ŒåŒ…æ‹¬åŠ¨ç”»åç§°ã€æŒç»­æ—¶é—´ã€æ’­æ”¾æ¬¡æ•°ã€æ’­æ”¾æ–¹å‘ã€å»¶è¿Ÿæ—¶é—´ç­‰ã€‚</li><br><p style="font-size:20px"><b>ä¸»è¦å±æ€§</b></p><p><b>@keyframes</b></p><li><b>è¯­æ³•</b>ï¼š<code>@keyframes animationName &#123; keyframe-selector &#123; property: value; &#125; &#125;</code></li><br><li><b>æè¿°</b>ï¼šç”¨äºå®šä¹‰åŠ¨ç”»çš„å…³é”®å¸§ã€‚animationNameæ˜¯åŠ¨ç”»çš„åç§°ï¼Œkeyframe-selectorå¯ä»¥æ˜¯ç™¾åˆ†æ¯”ï¼ˆå¦‚0%ã€50%ã€100%ï¼‰æˆ–fromã€toå…³é”®å­—ï¼Œç”¨äºæŒ‡å®šåŠ¨ç”»åœ¨ä¸åŒæ—¶é—´ç‚¹çš„çŠ¶æ€ã€‚</li><br><p><b>animation-name</b></p><li><b>è¯­æ³•</b>ï¼š<code>animation-name: none | &lt;single-animation-name&gt;#</code></li><br><li><b>æè¿°</b>ï¼šæŒ‡å®šè¦åº”ç”¨çš„åŠ¨ç”»åç§°ï¼Œå¯¹åº”@keyframesä¸­å®šä¹‰çš„åç§°ã€‚</li><br><p><b>animation-duration</b></p><li><b>è¯­æ³•</b>ï¼š<code>animation-duration: &lt;time&gt;#</code></li><br><li><b>æè¿°</b>ï¼šæŒ‡å®šåŠ¨ç”»å®Œæˆä¸€ä¸ªå‘¨æœŸæ‰€éœ€çš„æ—¶é—´ï¼Œä»¥ç§’ï¼ˆsï¼‰æˆ–æ¯«ç§’ï¼ˆmsï¼‰ä¸ºå•ä½ã€‚</li><br>    <p><b>animation-timing-function</b></p><li><b>è¯­æ³•</b>ï¼š<code>animation-timing-function: ease | linear | ease-in | ease-out | ease-in-out | cubic-bezier(n,n,n,n)</code></li><br><li><b>æè¿°</b>ï¼šæ§åˆ¶åŠ¨ç”»çš„é€Ÿåº¦æ›²çº¿ï¼Œä¸è¿‡æ¸¡çš„æ—¶é—´å‡½æ•°ç±»ä¼¼ã€‚</li><br>    <p><b>animation-delay</b></p><li><b>è¯­æ³•</b>ï¼š<code>animation-delay: &lt;time&gt;</code></li><br><li><b>æè¿°</b>ï¼šæŒ‡å®šåŠ¨ç”»å¼€å§‹å‰çš„å»¶è¿Ÿæ—¶é—´ã€‚</li><br>    <p><b>animation-iteration-count</b></p><li><b>è¯­æ³•</b>ï¼š<code>animation-iteration-count: infinite | &lt;number&gt;</code></li><br><li><b>æè¿°</b>ï¼šæŒ‡å®šåŠ¨ç”»çš„æ’­æ”¾æ¬¡æ•°ï¼Œinfiniteè¡¨ç¤ºæ— é™å¾ªç¯æ’­æ”¾ã€‚</li><br>    <p><b>animation-direction</b></p><li><b>è¯­æ³•</b>ï¼š<code>animation-direction: normal | reverse | alternate | alternate-reverse</code></li><br><li><b>æè¿°</b>ï¼šæ§åˆ¶åŠ¨ç”»çš„æ’­æ”¾æ–¹å‘ï¼Œnormalä¸ºæ­£å‘æ’­æ”¾ï¼Œreverseä¸ºåå‘æ’­æ”¾ï¼Œalternateè¡¨ç¤ºåœ¨å¥‡æ•°æ¬¡è¿­ä»£æ—¶æ­£å‘æ’­æ”¾ï¼Œå¶æ•°æ¬¡è¿­ä»£æ—¶åå‘æ’­æ”¾ï¼Œalternate-reverseåˆ™ç›¸åã€‚</li><br>    <li><b>ç¤ºä¾‹</b></li>    <p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ CSS åŠ¨ç”»ç¤ºä¾‹ï¼Œè®©ä¸€ä¸ªæ–¹å—åœ¨é¡µé¢ä¸Šä»å·¦åˆ°å³ç§»åŠ¨å¹¶æ—‹è½¬ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* å®šä¹‰å…³é”®å¸§ */</span></span><br><span class="line"><span class="keyword">@keyframes</span> moveAndRotate &#123;</span><br><span class="line">  <span class="selector-tag">from</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">0</span>) <span class="built_in">rotate</span>(<span class="number">0deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">to</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">200px</span>) <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* åº”ç”¨åŠ¨ç”» */</span></span><br><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: blue;</span><br><span class="line">  <span class="comment">/* åº”ç”¨åŠ¨ç”»å±æ€§ */</span></span><br><span class="line">  <span class="attribute">animation-name</span>: moveAndRotate;</span><br><span class="line">  <span class="attribute">animation-duration</span>: <span class="number">3s</span>;</span><br><span class="line">  <span class="attribute">animation-timing-function</span>: ease-in-out;</span><br><span class="line">  <span class="attribute">animation-delay</span>: <span class="number">0s</span>;</span><br><span class="line">  <span class="attribute">animation-iteration-count</span>: infinite;</span><br><span class="line">  <span class="attribute">animation-direction</span>: normal;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><b>æ³¨æ„äº‹é¡¹</b></p><li>æ€§èƒ½è€ƒè™‘ï¼šä¸è¿‡æ¸¡ç±»ä¼¼ï¼Œå¤æ‚çš„åŠ¨ç”»å¯èƒ½ä¼šå¯¹æ€§èƒ½äº§ç”Ÿå½±å“ï¼Œå°¤å…¶æ˜¯åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šã€‚å°½é‡é¿å…è¿‡åº¦ä½¿ç”¨åŠ¨ç”»ï¼Œæˆ–è€…å¯¹å¤§é‡å…ƒç´ åŒæ—¶åº”ç”¨å¤æ‚åŠ¨ç”»ã€‚</li><li>å…¼å®¹æ€§å¤„ç†ï¼šä¸åŒæµè§ˆå™¨å¯¹ CSS åŠ¨ç”»çš„æ”¯æŒå¯èƒ½å­˜åœ¨å·®å¼‚ï¼Œéœ€è¦ä½¿ç”¨æµè§ˆå™¨å‰ç¼€æ¥ç¡®ä¿åœ¨å„ç§æµè§ˆå™¨ä¸­éƒ½èƒ½æ­£å¸¸æ˜¾ç¤ºã€‚ä¾‹å¦‚ï¼Œ-webkit-animationç”¨äº WebKit å†…æ ¸çš„æµè§ˆå™¨ã€‚</li><li>å¯è®¿é—®æ€§ï¼šç¡®ä¿åŠ¨ç”»ä¸ä¼šå½±å“ç½‘ç«™çš„å¯è®¿é—®æ€§ï¼Œä¾‹å¦‚ï¼Œå¯¹äºæœ‰è§†è§‰éšœç¢çš„ç”¨æˆ·ï¼ŒåŠ¨ç”»å¯èƒ½ä¼šé€ æˆå›°æ‰°ã€‚å¯ä»¥æä¾›å…³é—­åŠ¨ç”»çš„é€‰é¡¹ï¼Œæˆ–è€…ç¡®ä¿åŠ¨ç”»ä¸ä¼šå¹²æ‰°ç”¨æˆ·å¯¹å†…å®¹çš„ç†è§£å’Œæ“ä½œã€‚</li>]]></content>
      
      
      <categories>
          
          <category> CSSåŸºç¡€ </category>
          
          <category> Visual Studio Code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
            <tag> Visual Studio Code </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­¦ä¹ CSS.12å­¦ä¹ ç¬”è®°</title>
      <link href="/2025/01/23/css/%E5%AD%A6%E4%B9%A0css.12/"/>
      <url>/2025/01/23/css/%E5%AD%A6%E4%B9%A0css.12/</url>
      
        <content type="html"><![CDATA[<h1 style="font-size:30px;color:#00633D;font-family:åæ–‡è¡Œæ¥·">CSS è¿‡æ¸¡</h1><p>CSS è¿‡æ¸¡æ˜¯ CSS ä¸­ä¸€é¡¹éå¸¸å®ç”¨çš„ç‰¹æ€§ï¼Œå®ƒå¯ä»¥åœ¨å…ƒç´ çš„å±æ€§å€¼å‘ç”Ÿå˜åŒ–æ—¶åˆ›å»ºå¹³æ»‘çš„è¿‡æ¸¡æ•ˆæœï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚ä»¥ä¸‹æ˜¯å…³äº CSS è¿‡æ¸¡çš„å­¦ä¹ å†…å®¹ï¼š</p><p style="font-size:24px"><b>åŸºæœ¬æ¦‚å¿µ</b></p><li><b>è¿‡æ¸¡å±æ€§</b>ï¼šCSS è¿‡æ¸¡ä¸»è¦é€šè¿‡transitionå±æ€§æ¥å®ç°ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¤åˆå±æ€§ï¼Œç”¨äºè®¾ç½®è¿‡æ¸¡æ•ˆæœçš„å„ä¸ªæ–¹é¢ï¼ŒåŒ…æ‹¬è¿‡æ¸¡çš„å±æ€§ã€æŒç»­æ—¶é—´ã€è¿‡æ¸¡å‡½æ•°å’Œå»¶è¿Ÿæ—¶é—´ã€‚</li><br><li><b>è¿‡æ¸¡æ•ˆæœè§¦å‘</b>ï¼šé€šå¸¸åœ¨å…ƒç´ çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶è§¦å‘è¿‡æ¸¡æ•ˆæœï¼Œæ¯”å¦‚é¼ æ ‡æ‚¬åœï¼ˆ:hoverï¼‰ã€è·å–ç„¦ç‚¹ï¼ˆ:focusï¼‰ã€æ¿€æ´»ï¼ˆ:activeï¼‰ç­‰ä¼ªç±»çŠ¶æ€å˜åŒ–ï¼Œæˆ–è€…é€šè¿‡ JavaScript åŠ¨æ€ä¿®æ”¹å…ƒç´ çš„å±æ€§å€¼ã€‚</li><br><p style="font-size:24px"><b>transitionå±æ€§</b></p><li><b>è¯­æ³•</b>ï¼š<code>transition: property duration timing-function delay</code>;</li><li><b>property</b>ï¼šæŒ‡å®šè¦åº”ç”¨è¿‡æ¸¡æ•ˆæœçš„ CSS å±æ€§åç§°ã€‚å¯ä»¥æ˜¯å…·ä½“çš„å±æ€§ï¼Œå¦‚widthã€heightã€colorç­‰ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨allè¡¨ç¤ºæ‰€æœ‰å¯è¿‡æ¸¡çš„å±æ€§ã€‚</li><li><b>duration</b>ï¼šæŒ‡å®šè¿‡æ¸¡æ•ˆæœæŒç»­çš„æ—¶é—´ï¼Œä»¥ç§’ï¼ˆsï¼‰æˆ–æ¯«ç§’ï¼ˆmsï¼‰ä¸ºå•ä½ã€‚</li><li><b>timing-function</b>ï¼šæŒ‡å®šè¿‡æ¸¡çš„æ—¶é—´å‡½æ•°ï¼Œç”¨äºæ§åˆ¶è¿‡æ¸¡çš„é€Ÿåº¦æ›²çº¿ã€‚å¸¸è§çš„å€¼æœ‰easeï¼ˆé»˜è®¤å€¼ï¼Œæ…¢ - å¿« - æ…¢ï¼‰ã€linearï¼ˆåŒ€é€Ÿï¼‰ã€ease-inï¼ˆæ…¢ - å¿«ï¼‰ã€ease-outï¼ˆå¿« - æ…¢ï¼‰ã€ease-in-outï¼ˆæ…¢ - å¿« - æ…¢ï¼‰ç­‰ï¼Œè¿˜å¯ä»¥ä½¿ç”¨cubic-bezier()å‡½æ•°è‡ªå®šä¹‰æ›²çº¿ã€‚</li><li><b>delay</b>ï¼šæŒ‡å®šè¿‡æ¸¡æ•ˆæœå¼€å§‹å‰çš„å»¶è¿Ÿæ—¶é—´ï¼Œä»¥ç§’ï¼ˆsï¼‰æˆ–æ¯«ç§’ï¼ˆmsï¼‰ä¸ºå•ä½ã€‚</li><br><li><b>ç¤ºä¾‹</b></li><li>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ CSS è¿‡æ¸¡ç¤ºä¾‹ï¼Œå½“é¼ æ ‡æ‚¬åœåœ¨ä¸€ä¸ªæŒ‰é’®ä¸Šæ—¶ï¼ŒæŒ‰é’®çš„èƒŒæ™¯é¢œè‰²å’Œå®½åº¦ä¼šåœ¨ 1 ç§’å†…å¹³æ»‘è¿‡æ¸¡ï¼š</li>    <figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">button</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: blue;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">transition</span>: background-color <span class="number">1s</span>, width <span class="number">1s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">button</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: red;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><li>å¯ä»¥ç»™è¿‡æ¸¡æ•ˆæœæ·»åŠ å»¶è¿Ÿï¼Œè®©è¿‡æ¸¡åœ¨é¼ æ ‡æ‚¬åœä¸€æ®µæ—¶é—´åæ‰å¼€å§‹ï¼š</li><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">button</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: blue;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">transition</span>: background-color <span class="number">1s</span> <span class="number">0.5s</span>, width <span class="number">1s</span> <span class="number">0.5s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">button</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: red;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><li>ä½¿ç”¨ease-inæ—¶é—´å‡½æ•°è®©å®½åº¦å˜åŒ–çš„è¿‡æ¸¡æ•ˆæœä»¥æ…¢ - å¿«çš„æ–¹å¼è¿›è¡Œï¼š</li><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">button</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: blue;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">transition</span>: width <span class="number">1s</span> ease-in;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">button</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><p style="font-size:24px"><b>æ³¨æ„äº‹é¡¹</b></p><li><b>å…¼å®¹æ€§</b>ï¼šCSS è¿‡æ¸¡åœ¨å¤§å¤šæ•°ç°ä»£æµè§ˆå™¨ä¸­éƒ½å¾—åˆ°äº†å¾ˆå¥½çš„æ”¯æŒï¼Œä½†åœ¨ä¸€äº›æ—§ç‰ˆæœ¬çš„æµè§ˆå™¨ä¸­å¯èƒ½å­˜åœ¨å…¼å®¹æ€§é—®é¢˜ã€‚å¯ä»¥ä½¿ç”¨æµè§ˆå™¨å‰ç¼€ï¼ˆå¦‚-webkit-ã€-moz-ç­‰ï¼‰æ¥æé«˜å…¼å®¹æ€§ã€‚</li><li><b>å¯è¿‡æ¸¡å±æ€§</b>ï¼šå¹¶éæ‰€æœ‰çš„ CSS å±æ€§éƒ½å¯ä»¥è¿›è¡Œè¿‡æ¸¡ï¼Œåªæœ‰å…·æœ‰ä¸­é—´å€¼çš„å±æ€§æ‰èƒ½å®ç°è¿‡æ¸¡æ•ˆæœã€‚ä¾‹å¦‚ï¼Œdisplayå±æ€§å°±ä¸èƒ½ç›´æ¥è¿‡æ¸¡ï¼Œå› ä¸ºå®ƒçš„å€¼æ²¡æœ‰ä¸­é—´çŠ¶æ€ã€‚</li><li><b>æ€§èƒ½ä¼˜åŒ–</b>ï¼šè¿‡åº¦ä½¿ç”¨å¤æ‚çš„è¿‡æ¸¡æ•ˆæœå¯èƒ½ä¼šå½±å“é¡µé¢æ€§èƒ½ï¼Œç‰¹åˆ«æ˜¯åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šã€‚å°½é‡é¿å…å¯¹å¤§é‡å…ƒç´ åŒæ—¶åº”ç”¨è¿‡æ¸¡æ•ˆæœï¼Œæˆ–è€…ä½¿ç”¨è¿‡äºå¤æ‚çš„è¿‡æ¸¡å‡½æ•°ã€‚</li>]]></content>
      
      
      <categories>
          
          <category> CSSåŸºç¡€ </category>
          
          <category> Visual Studio Code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
            <tag> Visual Studio Code </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­¦ä¹ CSS.11å­¦ä¹ ç¬”è®°</title>
      <link href="/2025/01/22/css/%E5%AD%A6%E4%B9%A0css.11/"/>
      <url>/2025/01/22/css/%E5%AD%A6%E4%B9%A0css.11/</url>
      
        <content type="html"><![CDATA[<h1 style="font-size:30px;color:#F56262;font-family:åæ–‡è¡Œæ¥·">CSS 3D</h1><p>CSS 3D æ˜¯ CSSï¼ˆå±‚å æ ·å¼è¡¨ï¼‰çš„ä¸€ä¸ªé‡è¦ç‰¹æ€§ï¼Œå®ƒå…è®¸å¼€å‘äººå‘˜åœ¨ç½‘é¡µä¸Šåˆ›å»ºå…·æœ‰ä¸‰ç»´ç©ºé—´æ•ˆæœçš„å…ƒç´ ï¼Œä¸ºç”¨æˆ·å¸¦æ¥æ›´åŠ ä¸°å¯Œå’Œæ²‰æµ¸å¼çš„è§†è§‰ä½“éªŒã€‚ä»¥ä¸‹æ˜¯å¯¹ CSS 3D å‡ ä¸ªå…³é”®æ–¹é¢çš„è¯¦ç»†è§£é‡Šï¼š</p><p style="font-size:20px"><b>ä¸€ã€æ ¸å¿ƒæ¦‚å¿µ</b></p><p><b>1.ä¸‰ç»´ç©ºé—´åæ ‡ç³»</b>ï¼š</p><li>åœ¨ CSS 3D ä¸­ï¼Œä½¿ç”¨ä¸‰ç»´ç©ºé—´åæ ‡ç³»ï¼Œç”± xã€y å’Œ z è½´ç»„æˆã€‚</li><li>x è½´æ˜¯æ°´å¹³è½´ï¼Œä»å·¦åˆ°å³ä¸ºæ­£æ–¹å‘ã€‚</li><li>y è½´æ˜¯å‚ç›´è½´ï¼Œä»ä¸Šåˆ°ä¸‹ä¸ºæ­£æ–¹å‘ã€‚</li><li>z è½´æ˜¯æ·±åº¦è½´ï¼Œä»å±å¹•å¤–å‘å±å¹•å†…ä¸ºæ­£æ–¹å‘ã€‚</li><br><p><b>2.è§†è§’ä¸é€è§†</b>ï¼š</p><li>Perspectiveï¼ˆé€è§†ï¼‰ï¼šè¯¥å±æ€§å®šä¹‰äº†è§‚å¯Ÿ 3D åœºæ™¯çš„è·ç¦»ï¼Œå®ƒå½±å“å…ƒç´ åœ¨ 3D ç©ºé—´ä¸­çš„å‘ˆç°æ•ˆæœã€‚</li><li>å¯ä»¥é€šè¿‡è®¾ç½®çˆ¶å…ƒç´ çš„ perspective å±æ€§æ¥å®ç°é€è§†æ•ˆæœï¼Œä¾‹å¦‚ perspective: 500px;ã€‚è¾ƒå°çš„å€¼ä¼šä½¿å…ƒç´ çš„ 3D æ•ˆæœæ›´å¼ºçƒˆï¼Œè€Œè¾ƒå¤§çš„å€¼ä¼šä½¿å…ƒç´ çœ‹èµ·æ¥æ›´æ‰å¹³ã€‚</li><li>è¿˜å¯ä»¥ä½¿ç”¨ perspective-origin å±æ€§æ¥æ”¹å˜é€è§†çš„åŸç‚¹ï¼Œé»˜è®¤æ˜¯å…ƒç´ çš„ä¸­å¿ƒï¼ˆ50% 50%ï¼‰ï¼Œå¯ä»¥è°ƒæ•´ä¸ºå…¶ä»–ä½ç½®ï¼Œå¦‚ perspective-origin: top left;ã€‚</li><p><b>3.å˜æ¢ï¼ˆTransformsï¼‰ï¼š</b></p><li>translate3d(x, y, z)ï¼šå°†å…ƒç´ åœ¨ 3D ç©ºé—´ä¸­æ²¿ xã€y å’Œ z è½´è¿›è¡Œå¹³ç§»ã€‚ä¾‹å¦‚ï¼Œtransform: translate3d(50px, 100px, 20px); ä¼šå°†å…ƒç´ åœ¨ x è½´ä¸Šç§»åŠ¨ 50 åƒç´ ï¼Œy è½´ä¸Šç§»åŠ¨ 100 åƒç´ ï¼Œz è½´ä¸Šç§»åŠ¨ 20 åƒç´ ã€‚</li><li>rotateX(angle)ã€rotateY(angle)ã€rotateZ(angle)ï¼šåˆ†åˆ«å°†å…ƒç´ ç»• xã€yã€z è½´æ—‹è½¬æŒ‡å®šçš„è§’åº¦ã€‚ä¾‹å¦‚ï¼Œtransform: rotateX(45deg); ä¼šä½¿å…ƒç´ ç»• x è½´æ—‹è½¬ 45 åº¦ã€‚</li><li>scale3d(sx, sy, sz)ï¼šæŒ‰æ¯”ä¾‹ç¼©æ”¾å…ƒç´ åœ¨ xã€y å’Œ z è½´ä¸Šçš„å°ºå¯¸ã€‚ä¾‹å¦‚ï¼Œtransform: scale3d(1.5, 1.2, 0.8); ä¼šå°†å…ƒç´ åœ¨ x è½´ä¸Šæ”¾å¤§ 1.5 å€ï¼Œy è½´ä¸Šæ”¾å¤§ 1.2 å€ï¼Œz è½´ä¸Šç¼©å°åˆ° 0.8 å€ã€‚</li><li>å¯ä»¥ç»„åˆä½¿ç”¨è¿™äº›å˜æ¢ï¼Œä¾‹å¦‚ transform: translate3d(50px, 100px, 20px) rotateY(45deg); ä¼šå…ˆå¹³ç§»å…ƒç´ ï¼Œå†ç»• y è½´æ—‹è½¬ã€‚</li><br><p><b>4.å˜æ¢é£æ ¼ï¼ˆTransform Styleï¼‰ï¼š</b></p><li>transform-style: preserve-3dï¼šè¯¥å±æ€§ç”¨äºæŒ‡å®šå­å…ƒç´ æ˜¯å¦åœ¨ 3D ç©ºé—´ä¸­å‘ˆç°ã€‚è®¾ç½®ä¸º preserve-3d æ—¶ï¼Œå­å…ƒç´ ä¼šä¿ç•™ 3D ç‰¹æ€§ï¼Œå¯ä»¥åˆ›å»ºæ›´å¤æ‚çš„ 3D ç»“æ„ï¼Œä¾‹å¦‚ 3D ç«‹æ–¹ä½“ã€‚</li><li>transform-style: flatï¼šè¿™æ˜¯é»˜è®¤å€¼ï¼Œå­å…ƒç´ ä¼šè¢«å¹³é¢åŒ–ï¼Œä¸å…·æœ‰ 3D æ•ˆæœã€‚</li><br><p style="font-size:20px"><b>äºŒã€å…ƒç´ çš„ 3D å®šä½ä¸å¸ƒå±€</b></p><p><b>ç»å¯¹å®šä½ï¼ˆAbsolute Positioningï¼‰ï¼š</b></p><li>é€šå¸¸å°†å…ƒç´ çš„ä½ç½®è®¾ç½®ä¸º absolute æˆ– fixed ä»¥æ–¹ä¾¿åœ¨ 3D ç©ºé—´ä¸­å¯¹å…¶è¿›è¡Œç²¾ç¡®çš„å®šä½å’Œå˜æ¢ã€‚</li><br><p><b>å±‚å é¡ºåºï¼ˆStacking Orderï¼‰ï¼š</b></p><li>ä½¿ç”¨ z-index å±æ€§å¯ä»¥æ§åˆ¶å…ƒç´ åœ¨ 3D ç©ºé—´ä¸­çš„å±‚å é¡ºåºã€‚è¾ƒé«˜çš„ z-index å€¼çš„å…ƒç´ ä¼šæ˜¾ç¤ºåœ¨è¾ƒä½ z-index å€¼çš„å…ƒç´ å‰é¢ã€‚</li><br><p style="font-size:20px"><b>ä¸‰ã€èƒŒé¢å¯è§æ€§ï¼ˆBackface Visibilityï¼‰</b></p><li>backface-visibilityï¼šè¯¥å±æ€§å†³å®šå…ƒç´ çš„èƒŒé¢æ˜¯å¦å¯è§ã€‚</li><li>backface-visibility: visible; è¡¨ç¤ºå…ƒç´ çš„èƒŒé¢å¯è§ï¼Œå½“å…ƒç´ æ—‹è½¬æ—¶å¯ä»¥çœ‹åˆ°å…¶èƒŒé¢ã€‚</li><li>backface-visibility: hidden; è¡¨ç¤ºå…ƒç´ çš„èƒŒé¢ä¸å¯è§ï¼Œå¸¸ç”¨äºåˆ›å»ºå…·æœ‰åŒé¢æ•ˆæœçš„å…ƒç´ ï¼Œå½“æ—‹è½¬æ—¶åªæ˜¾ç¤ºæ­£é¢ã€‚</li>]]></content>
      
      
      <categories>
          
          <category> CSSåŸºç¡€ </category>
          
          <category> Visual Studio Code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
            <tag> Visual Studio Code </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­¦ä¹ CSS.10å­¦ä¹ ç¬”è®°</title>
      <link href="/2025/01/22/css/%E5%AD%A6%E4%B9%A0css.10/"/>
      <url>/2025/01/22/css/%E5%AD%A6%E4%B9%A0css.10/</url>
      
        <content type="html"><![CDATA[<h1 style="font-size:30px;color:#3A4973;font-family:åæ–‡è¡Œæ¥·">CSS 2D</h1><p>CSS 2D æ˜¯æŒ‡ä½¿ç”¨ CSS å®ç°çš„äºŒç»´å˜æ¢ï¼Œå®ƒå…è®¸å¼€å‘è€…å¯¹ HTML å…ƒç´ è¿›è¡Œå¹³é¢å†…çš„å„ç§å˜æ¢æ“ä½œï¼Œä»è€Œå®ç°ä¸°å¯Œçš„é¡µé¢æ•ˆæœã€‚ä»¥ä¸‹æ˜¯æ›´è¯¦ç»†çš„è§£é‡Šï¼š</p><p style="font-weight:bold;font-size:20px">ä¸€ã€åŸºæœ¬å˜æ¢å‡½æ•°</p><p><b>translate(x, y)ï¼š</b></p><li>åŠŸèƒ½ï¼šå°†å…ƒç´ åœ¨äºŒç»´å¹³é¢ä¸Šè¿›è¡Œå¹³ç§»ã€‚</li><li>å‚æ•°ï¼š</li><br><p>1.xï¼šå…ƒç´ åœ¨æ°´å¹³æ–¹å‘ï¼ˆX è½´ï¼‰ä¸Šçš„ç§»åŠ¨è·ç¦»ã€‚å¯ä»¥æ˜¯åƒç´ å€¼ï¼ˆå¦‚ 50pxï¼‰ã€ç™¾åˆ†æ¯”ï¼ˆå¦‚ 50%ï¼‰æˆ–å…¶ä»–é•¿åº¦å•ä½ã€‚æ­£å€¼è¡¨ç¤ºå‘å³ç§»åŠ¨ï¼Œè´Ÿå€¼è¡¨ç¤ºå‘å·¦ç§»åŠ¨ã€‚</p><p>2.yï¼šå…ƒç´ åœ¨å‚ç›´æ–¹å‘ï¼ˆY è½´ï¼‰ä¸Šçš„ç§»åŠ¨è·ç¦»ã€‚å¯ä»¥æ˜¯åƒç´ å€¼ã€ç™¾åˆ†æ¯”æˆ–å…¶ä»–é•¿åº¦å•ä½ã€‚æ­£å€¼è¡¨ç¤ºå‘ä¸‹ç§»åŠ¨ï¼Œè´Ÿå€¼è¡¨ç¤ºå‘ä¸Šç§»åŠ¨ã€‚</p><li>ç¤ºä¾‹ï¼š</li><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.element</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">100px</span>, <span class="number">50px</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¯´æ˜ï¼šä¸Šè¿°ä»£ç ä¼šå°† .element ç±»çš„å…ƒç´ åœ¨æ°´å¹³æ–¹å‘å‘å³ç§»åŠ¨ 100 åƒç´ ï¼Œåœ¨å‚ç›´æ–¹å‘å‘ä¸‹ç§»åŠ¨ 50 åƒç´ ã€‚</p></blockquote><p><b>rotate(angle)ï¼š</b></p><li>åŠŸèƒ½ï¼šå°†å…ƒç´ ç»•å…¶ä¸­å¿ƒç‚¹æ—‹è½¬ä¸€å®šè§’åº¦ã€‚</li><li>å‚æ•°ï¼š</li><br><p>angleï¼šæ—‹è½¬çš„è§’åº¦ï¼Œå•ä½æ˜¯åº¦ï¼ˆdegï¼‰ã€‚æ­£å€¼è¡¨ç¤ºé¡ºæ—¶é’ˆæ—‹è½¬ï¼Œè´Ÿå€¼è¡¨ç¤ºé€†æ—¶é’ˆæ—‹è½¬ã€‚</p><li>ç¤ºä¾‹ï¼š</li><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.element</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">45deg</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¯´æ˜ï¼šè¯¥ä»£ç å°† .element ç±»çš„å…ƒç´ é¡ºæ—¶é’ˆæ—‹è½¬ 45 åº¦ã€‚</p></blockquote><p><b>scale(x, y)ï¼š</b></p><li>åŠŸèƒ½ï¼šå¯¹å…ƒç´ è¿›è¡Œç¼©æ”¾æ“ä½œã€‚</li><li>å‚æ•°ï¼š</li><br><p>xï¼šå…ƒç´ åœ¨æ°´å¹³æ–¹å‘ï¼ˆX è½´ï¼‰ä¸Šçš„ç¼©æ”¾æ¯”ä¾‹ã€‚å¯ä»¥æ˜¯å°æ•°ï¼ˆå¦‚ 0.5 è¡¨ç¤ºç¼©å°åˆ°åŸæ¥çš„ 50%ï¼‰æˆ–å¤§äº 1 çš„æ•°ï¼ˆå¦‚ 2 è¡¨ç¤ºæ”¾å¤§åˆ°åŸæ¥çš„ 2 å€ï¼‰ã€‚<br>yï¼šå…ƒç´ åœ¨å‚ç›´æ–¹å‘ï¼ˆY è½´ï¼‰ä¸Šçš„ç¼©æ”¾æ¯”ä¾‹ã€‚å¦‚æœä¸æŒ‡å®š y å€¼ï¼Œå…ƒç´ å°†åœ¨ X å’Œ Y è½´ä¸ŠæŒ‰ç…§ x çš„æ¯”ä¾‹è¿›è¡Œç¼©æ”¾ã€‚</p><li>ç¤ºä¾‹ï¼š</li><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.element</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.5</span>, <span class="number">2</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¯´æ˜ï¼šæ­¤ä»£ç å°† .element ç±»çš„å…ƒç´ åœ¨æ°´å¹³æ–¹å‘æ”¾å¤§åˆ°åŸæ¥çš„ 1.5 å€ï¼Œåœ¨å‚ç›´æ–¹å‘æ”¾å¤§åˆ°åŸæ¥çš„ 2 å€ã€‚</p></blockquote><p><b>skew(x-angle, y-angle)ï¼š</b></p><li>åŠŸèƒ½ï¼šä½¿å…ƒç´ åœ¨äºŒç»´å¹³é¢ä¸Šäº§ç”Ÿå€¾æ–œæ•ˆæœã€‚</li><li>å‚æ•°ï¼š</li><br><p>x-angleï¼šå…ƒç´ åœ¨æ°´å¹³æ–¹å‘ï¼ˆX è½´ï¼‰ä¸Šçš„å€¾æ–œè§’åº¦ï¼Œå•ä½æ˜¯åº¦ï¼ˆdegï¼‰ã€‚æ­£å€¼è¡¨ç¤ºå‘å³ä¾§å€¾æ–œï¼Œè´Ÿå€¼è¡¨ç¤ºå‘å·¦ä¾§å€¾æ–œã€‚<br>y-angleï¼šå…ƒç´ åœ¨å‚ç›´æ–¹å‘ï¼ˆY è½´ï¼‰ä¸Šçš„å€¾æ–œè§’åº¦ï¼Œå•ä½æ˜¯åº¦ï¼ˆdegï¼‰ã€‚æ­£å€¼è¡¨ç¤ºå‘ä¸‹æ–¹å€¾æ–œï¼Œè´Ÿå€¼è¡¨ç¤ºå‘ä¸Šæ–¹å€¾æ–œã€‚</p><li>ç¤ºä¾‹ï¼š</li><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.element</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">skew</span>(<span class="number">30deg</span>, <span class="number">10deg</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¯´æ˜ï¼š.element ç±»çš„å…ƒç´ å°†åœ¨æ°´å¹³æ–¹å‘å€¾æ–œ 30 åº¦ï¼Œåœ¨å‚ç›´æ–¹å‘å€¾æ–œ 10 åº¦ã€‚</p></blockquote><p style="font-weight:bold;font-size:20px">äºŒã€transform-origin å±æ€§</p><li>åŠŸèƒ½ï¼šè®¾ç½®å…ƒç´ å˜æ¢çš„åŸç‚¹ä½ç½®ï¼Œé»˜è®¤æ˜¯å…ƒç´ çš„ä¸­å¿ƒï¼ˆ50% 50%ï¼‰ã€‚</li><li>å‚æ•°ï¼š</li><br><p>å¯ä»¥ä½¿ç”¨é•¿åº¦å•ä½ï¼ˆå¦‚ pxï¼‰ã€ç™¾åˆ†æ¯”æˆ–å…³é”®å­—ï¼ˆå¦‚ topã€bottomã€leftã€rightã€centerï¼‰æ¥æŒ‡å®šä½ç½®ã€‚</p><li>ç¤ºä¾‹ï¼š</li><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.element</span> &#123;</span><br><span class="line">    <span class="attribute">transform-origin</span>: top left;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">45deg</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¯´æ˜ï¼šå¯¹äº .element ç±»çš„å…ƒç´ ï¼Œé¦–å…ˆå°†å˜æ¢åŸç‚¹è®¾ç½®ä¸ºå·¦ä¸Šè§’ï¼Œç„¶åè¿›è¡Œ 45 åº¦çš„æ—‹è½¬æ“ä½œã€‚ç”±äºå˜æ¢åŸç‚¹æ”¹å˜ï¼Œå…ƒç´ å°†ä»¥å·¦ä¸Šè§’ä¸ºä¸­å¿ƒè¿›è¡Œæ—‹è½¬ã€‚</p></blockquote><p style="font-weight:bold;font-size:20px">ä¸‰ã€ç»„åˆä½¿ç”¨å˜æ¢å‡½æ•°</p><li>å¯ä»¥å°†å¤šä¸ªå˜æ¢å‡½æ•°ç»„åˆä½¿ç”¨ï¼Œå®ƒä»¬ä¼šæŒ‰ç…§é¡ºåºä¾æ¬¡å¯¹å…ƒç´ è¿›è¡Œæ“ä½œã€‚</li><li>ç¤ºä¾‹ï¼š</li><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.element</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">100px</span>, <span class="number">50px</span>) <span class="built_in">rotate</span>(<span class="number">45deg</span>) <span class="built_in">scale</span>(<span class="number">1.5</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¯´æ˜ï¼šå¯¹äº .element ç±»çš„å…ƒç´ ï¼Œå…ˆå°†å…¶å‘å³å¹³ç§» 100 åƒç´ ã€å‘ä¸‹å¹³ç§» 50 åƒç´ ï¼Œç„¶åé¡ºæ—¶é’ˆæ—‹è½¬ 45 åº¦ï¼Œæœ€åå°†å…¶æ”¾å¤§åˆ°åŸæ¥çš„ 1.5 å€ã€‚</p></blockquote><h1 style="font-size:30px;color:#3A4973;font-family:åæ–‡è¡Œæ¥·">åº”ç”¨åœºæ™¯</h1><p><b>åŠ¨æ€æ•ˆæœå¢å¼º</b></p><li>åŠ¨ç”»æ•ˆæœï¼šé€šè¿‡ CSS 2D å˜æ¢å¯ä»¥åˆ›å»ºå„ç§å¸å¼•äººçš„åŠ¨ç”»æ•ˆæœï¼Œå¦‚å…ƒç´ åœ¨é¡µé¢ä¸Šçš„å¹³æ»‘ç§»åŠ¨ã€æ—‹è½¬ã€ç¼©æ”¾ç­‰ï¼Œä½¿é¡µé¢æ›´å…·å¸å¼•åŠ›ã€‚</li><li>äº¤äº’æ•ˆæœï¼šä¸ºæŒ‰é’®ã€é“¾æ¥ã€å›¾æ ‡ç­‰æ·»åŠ ç‚¹å‡»ã€æ‚¬åœç­‰äº¤äº’æ•ˆæœï¼Œå½“ç”¨æˆ·ä¸é¡µé¢å…ƒç´ äº¤äº’æ—¶ï¼Œé€šè¿‡ 2D å˜æ¢æ¥æ”¹å˜å…ƒç´ çš„å¤–è§‚ï¼Œä½¿é¡µé¢æ›´åŠ ç”ŸåŠ¨æœ‰è¶£ã€‚</li><p><b>å¸ƒå±€è°ƒæ•´</b></p><li>å“åº”å¼è®¾è®¡ï¼šåœ¨å“åº”å¼å¸ƒå±€ä¸­ï¼Œåˆ©ç”¨ CSS 2D å˜æ¢è°ƒæ•´å…ƒç´ çš„ä½ç½®å’Œå¤§å°ï¼Œä»¥é€‚åº”ä¸åŒå±å¹•å°ºå¯¸å’Œåˆ†è¾¨ç‡çš„è®¾å¤‡ï¼Œç¡®ä¿é¡µé¢åœ¨å„ç§è®¾å¤‡ä¸Šéƒ½èƒ½ä¿æŒè‰¯å¥½çš„æ˜¾ç¤ºæ•ˆæœã€‚</li><li>åˆ›æ„å¸ƒå±€ï¼šå®ç°ä¸€äº›éä¼ ç»Ÿçš„å¸ƒå±€æ–¹å¼ï¼Œå¦‚å€¾æ–œçš„æ–‡æœ¬ã€æ—‹è½¬çš„å›¾ç‰‡ç­‰ï¼Œä¸ºé¡µé¢å¸¦æ¥ç‹¬ç‰¹çš„è§†è§‰é£æ ¼ï¼Œçªç ´ä¼ ç»ŸçŸ©å½¢å¸ƒå±€çš„é™åˆ¶ã€‚</li><b>UI å…ƒç´ è®¾è®¡</b><li>æŒ‰é’®å’Œå›¾æ ‡ï¼šä¸ºæŒ‰é’®å’Œå›¾æ ‡æ·»åŠ é˜´å½±ã€ç«‹ä½“æ•ˆæœç­‰ï¼Œä½¿ç”¨ CSS 2D å˜æ¢å¯ä»¥è®©å®ƒä»¬çœ‹èµ·æ¥æ›´åŠ ç«‹ä½“å’Œå¸å¼•äººï¼Œå¢å¼ºç”¨æˆ·å¯¹å¯äº¤äº’å…ƒç´ çš„æ„ŸçŸ¥ã€‚</li><li>å¯¼èˆªèœå•ï¼šåˆ›å»ºå…·æœ‰åŠ¨æ€æ•ˆæœçš„å¯¼èˆªèœå•ï¼Œå¦‚æ‚¬åœæ—¶å¼¹å‡ºçš„ä¸‹æ‹‰èœå•ã€æ—‹è½¬çš„é€‰é¡¹å¡ç­‰ï¼Œæå‡å¯¼èˆªçš„æ˜“ç”¨æ€§å’Œè§†è§‰æ•ˆæœã€‚</li><b>å…¼å®¹æ€§</b><li>è™½ç„¶å¤§å¤šæ•°ç°ä»£æµè§ˆå™¨éƒ½æ”¯æŒ CSS 2D å˜æ¢ï¼Œä½†åœ¨ä¸€äº›è¾ƒæ—§çš„æµè§ˆå™¨æˆ–ç‰¹å®šç‰ˆæœ¬ä¸­å¯èƒ½å­˜åœ¨å…¼å®¹æ€§é—®é¢˜ã€‚ä¸ºäº†ç¡®ä¿å…¼å®¹æ€§ï¼Œå¯èƒ½éœ€è¦ä½¿ç”¨æµè§ˆå™¨å‰ç¼€ï¼ˆå¦‚ -webkit-ã€-moz- ç­‰ï¼‰ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å·¥å…·å¦‚ Autoprefixer æ¥è‡ªåŠ¨æ·»åŠ è¿™äº›å‰ç¼€ã€‚</li>]]></content>
      
      
      <categories>
          
          <category> CSSåŸºç¡€ </category>
          
          <category> Visual Studio Code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
            <tag> Visual Studio Code </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­¦ä¹ CSS.9å­¦ä¹ ç¬”è®°</title>
      <link href="/2025/01/22/css/%E5%AD%A6%E4%B9%A0css.9/"/>
      <url>/2025/01/22/css/%E5%AD%A6%E4%B9%A0css.9/</url>
      
        <content type="html"><![CDATA[<div style="font-size:50px;font-family:åæ–‡æ¥·ä½“;color:#B4A8FC">CSS æ¸å˜</div><br></br><p style="font-size:25px"><b>1.çº¿æ€§æ¸å˜</b></p><li>å¤šä¸ªé¢œè‰²ä¹‹é—´çš„æ¸å˜ï¼Œé»˜è®¤<b>ä»ä¸Šåˆ°ä¸‹</b>æ¸å˜ã€‚</li><blockquote><p>background-image:linear-gradient( , , );</p></blockquote><li>ä½¿ç”¨å…³é”®è¯è®¾ç½®çº¿æ€§<b>æ¸å˜çš„æ–¹å‘</b>ã€‚</li><blockquote><p>background-image:linear-gradient(to top, , , );<br>background-image:linear-gradient(to  right top, , , ); </p></blockquote><li>ä½¿ç”¨è§’åº¦è®¾ç½®çº¿æ€§<b>2.æ¸å˜çš„æ–¹å‘</b>ã€‚</li><blockquote><p>background-imge:linear-gradient(30deg, , , );</p></blockquote><li>è°ƒæ•´å¼€å§‹<b>æ¸å˜çš„ä½ç½®</b>ã€‚</li><blockquote><p>background-imge:linear-gradient(red 50px, , , );</p></blockquote><p style="font-size:25px"><b>3.å¾„å‘æ¸å˜</b></p><li>ä½¿ç”¨åƒç´ å€¼å€¼è°ƒæ•´æ¸å˜åœ†çš„åœ†å¿ƒä½ç½®ã€‚</li><blockquote><p>background-image:radial-gradient(at 100px 50px, , , );</p></blockquote><li>è°ƒæ•´æ¸å˜å½¢çŠ¶ä¸ºæ­£åœ†ã€‚</li><blockquote><p>background-image:radial-gradient(circle, , , );</p></blockquote><li>è°ƒæ•´å½¢çŠ¶çš„åŠå¾„</li>ã€‚<blockquote><p>background-image:radial-gradient(100px, , , );<br>background-image:radial-gradient(50px,100px, , , );</p></blockquote><p style="font-size:25px"><b>4.é‡å¤æ¸å˜</b></p><blockquote><p>åœ¨æ¸å˜ç±»å‹å‰é¢åŠ ä¸Š repeating</p></blockquote><div style="font-size:50px;font-family:åæ–‡æ¥·ä½“;color:#B4A8FC">web å­—ä½“</div><p><b>åŸºæœ¬ç”¨æ³•</b></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@font-face&#123;</span><br><span class="line">     font-family:&quot;&quot;;</span><br><span class="line">     font-display:swap;</span><br><span class="line">     src:url(./  );</span><br><span class="line">&#125;     </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CSSåŸºç¡€ </category>
          
          <category> Visual Studio Code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
            <tag> Visual Studio Code </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­¦ä¹ CSS.8å­¦ä¹ ç¬”è®°</title>
      <link href="/2025/01/22/css/%E5%AD%A6%E4%B9%A0css.8/"/>
      <url>/2025/01/22/css/%E5%AD%A6%E4%B9%A0css.8/</url>
      
        <content type="html"><![CDATA[<p style="font-size:30px;color:#43E2FE;font-family:åæ–‡æ¥·ä½“">CSS3é•¿åº¦å•ä½</p><p><mark>vm</mark>è§†å£å®½åº¦çš„ç™¾åˆ†ä¹‹å¤šå°‘<mark>10vw</mark>å°±æ˜¯è§†å£å®½åº¦çš„<mark>10%</mark><br><mark>vh</mark>è§†å£å®½åº¦çš„ç™¾åˆ†ä¹‹å¤šå°‘<mark>10vw</mark>å°±æ˜¯è§†å£é«˜åº¦çš„<mark>10%</mark></p><p style="font-size:30px;color:#43E2FE;font-family:åæ–‡æ¥·ä½“"><mark>box-sizing</mark>æ€ªå¼‚ç›’æ¨¡å‹</p><p>ä½¿ç”¨<mark>box-sizing</mark>å±æ€§å¯ä»¥è®¾ç½®å’Œæ¨¡å‹çš„ä¿©ç§ç±»å‹</p><details><mark>width</mark>å’Œ<mark>height</mark>è®¾ç½®çš„æ˜¯ç›’å­å†…å®¹åŒºçš„å¤§å°ã€‚ï¼ˆé»˜è®¤å€¼ï¼‰ <summary><b>content-box</b></summary></details><details><mark>width</mark>å’Œ<mark>height</mark>è®¾ç½®çš„æ˜¯ç›’å­æ€»å¤§å°ï¼ˆæ€ªå¼‚ç›’æ¨¡å‹ï¼‰ <summary><b>border-box</b></summary></details>   <p style="font-size:30px;color:#43E2FE;font-family:åæ–‡æ¥·ä½“"><mark>resize</mark>è°ƒæ•´ç›’å­å¤§å°</p><p>ä½¿ç”¨<mark>resize</mark>å±æ€§å¯ä»¥å¯ä»¥æ§åˆ¶æ˜¯å¦å…è®¸ç”¨æˆ·è°ƒèŠ‚å…ƒç´ å°ºå¯¸ã€‚</p><p><b>none:</b>ä¸å…è®¸ç”¨æˆ·è°ƒæ•´å…ƒç´ å¤§å°ã€‚ï¼ˆé»˜è®¤ï¼‰<br><b>both:</b>ç”¨æˆ·å¯ä»¥è°ƒèŠ‚å…ƒç´ çš„å®½åº¦å’Œé«˜åº¦ã€‚<br><b>horizontal:</b>ç”¨æˆ·å¯ä»¥è°ƒèŠ‚å…ƒç´ çš„å®½åº¦ã€‚<br><b>vertical:</b>ç”¨æˆ·å¯ä»¥è°ƒèŠ‚å…ƒç´ çš„é«˜åº¦ã€‚</p><p style="font-size:30px;color:#43E2FE;font-family:åæ–‡æ¥·ä½“"><mark>box-shadow</mark>ç›’å­é˜´å½±</p><div>ä½¿ç”¨<mark>box-shadow</mark>å±æ€§ä¸ºç›’å­æ·»åŠ é˜´å½±ã€‚</div><br><details><code>box-shadow: h-shadow v-shadow blur spread color inset;</code><summary><b>è¯­æ³•</b></summary></details><li>å„ä¸ªå€¼çš„å«ä¹‰ï¼š</li><b>h-shadow</b>:æ°´å¹³é˜´å½±çš„ä½ç½®ï¼Œå¿…é¡»å¡«å†™ï¼Œå¯ä»¥ä¸ºè´Ÿå€¼<b>v-shadow</b>:å‚ç›´é˜´å½±çš„ä½ç½®ï¼Œå¿…é¡»å¡«å†™ï¼Œå¯ä»¥ä¸ºè´Ÿå€¼<b>blur</b>:å¯é€‰ï¼Œæ¨¡ç³Šè·ç¦»<b>spread</b>:å¯é€‰ï¼Œéšéšçš„å¤–å»¶å€¼<b>color</b>:å¯é€‰ï¼Œé˜´å½±çš„é¢œè‰²<b>inset</b>:å¯é€‰ï¼Œå°†å¤–éƒ¨é˜´å½±è¯¥ä¸ºå†…éƒ¨é˜´å½±<blockquote><p>é»˜è®¤å€¼ï¼šbox-shadow:noneè¡¨ç¤ºæ²¡æœ‰é˜´å½±</p></blockquote><p style="font-size:30px;color:#43E2FE;font-family:åæ–‡æ¥·ä½“"><mark>opacity</mark>ç›’å­é˜´å½±</p><p><b>opacity</b>å±æ€§èƒ½ä¸ºæ•´ä¸ªå…ƒç´ æ·»åŠ é€æ˜åº¦æ•ˆæœï¼Œå€¼æ˜¯0åˆ°1ä¹‹é—´çš„å°æ•°ï¼Œ0æ˜¯å®Œå…¨é€æ˜ï¼Œ1è¡¨ç¤ºå®Œå…¨ä¸é€æ˜ã€‚</p><p style="font-size:30px;color:#43E2FE;font-family:åæ–‡æ¥·ä½“"><mark>background-origin</mark>è®¾ç½®èƒŒæ™¯å›¾çš„åŸç‚¹ã€‚</p><li>è¯­æ³•</li><p>1.<b>padding-box:</b>ä»<b>padding</b>åŒºåŸŸå¼€å§‹æ˜¾ç¤ºèƒŒæ™¯å›¾åƒã€‚â€“é»˜è®¤å€¼<br>2.<b>border-box:</b>ä»<b>border</b>åŒºåŸŸå¼€å§‹æ˜¾ç¤ºèƒŒæ™¯å›¾åƒã€‚<br>3.<b>content-box:</b>ä»<b>content</b>åŒºåŸŸå¼€å§‹æ˜¾ç¤ºèƒŒæ™¯å›¾åƒã€‚</p><hr><p style="font-size:30px;color:#43E2FE;font-family:åæ–‡æ¥·ä½“"><mark>background-clip</mark>è®¾ç½®èƒŒæ™¯å›¾çš„å‘å¤–è£å‰ªçš„åŒºåŸŸã€‚</p><li>è¯­æ³•</li><p>1.<b>padding-box:</b>ä»<b>padding</b>åŒºåŸŸå¼€å§‹å‘å¤–è£å‰ªèƒŒæ™¯ã€‚â€“é»˜è®¤å€¼<br>2.<b>border-box:</b>ä»<b>border</b>åŒºåŸŸå¼€å§‹å‘å¤–è£å‰ªèƒŒæ™¯ã€‚<br>3.<b>content-box:</b>ä»<b>content</b>åŒºåŸŸå¼€å§‹å‘å¤–è£å‰ªèƒŒæ™¯ã€‚<br>4.<b>text:</b>èƒŒæ™¯å›¾åªå‘ˆç°åœ¨æ–‡å­—ä¸Šã€‚</p><p style="font-size:30px;color:#43E2FE;font-family:åæ–‡æ¥·ä½“"><mark>background-size</mark>è®¾ç½®èƒŒæ™¯å›¾çš„å°ºå¯¸ã€‚</p><li>è¯­æ³•</li><p>1.ç”¨é•¿åº¦æŒ‡å®šèƒŒæ™¯å›¾ç‰‡å¤§å°ï¼Œä¸å…è®¸è´Ÿå€¼ã€‚</p><blockquote><p>background-size:300px 200px;</p></blockquote><p>2.ç”¨ç™¾åˆ†æ¯”æŒ‡å®šèƒŒæ™¯å›¾ç‰‡å¤§å°ï¼Œä¸å…è®¸è´Ÿè´£ã€‚</p><blockquote><p>background-size:100% 100%;</p></blockquote><p>3.<b>auto</b>ï¼šèƒŒæ™¯å›¾ç‰‡çš„çœŸå®å¤§å°ï¼Œâ€“é»˜è®¤å€¼<br>4.<b>contain</b>ï¼šå°†èƒŒæ™¯å›¾ç‰‡ç­‰æ¯”ç¼©æ”¾ï¼Œæ˜¯åŒ—äº¬å›¾ç‰‡çš„å®½é«˜ï¼Œä¸å®¹å™¨çš„æ¬¾æˆ–é«˜ç›¸ç­‰ï¼Œå†å°†å®Œæ•´èƒŒæ™¯å›¾ç‰‡åŒ…å«åœ¨å®¹å™¨å†…ï¼Œä½†è¦æ³¨æ„ï¼šå¯èƒ½ä¼šé€ æˆå®¹å™¨é‡Œéƒ¨åˆ†åŒºåŸŸæ²¡æœ‰èƒŒæ™¯å›¾ç‰‡ã€‚</p><blockquote><p>background-size:contain:</p></blockquote><p>5.<b>cover</b>ï¼šå°†èƒŒæ™¯å›¾ç‰‡ç­‰æ¯”ä¾‹ç¼©æ”¾ï¼Œç›´åˆ°å®Œå…¨è¦†ç›–å®¹å™¨ï¼Œå›¾ç‰‡ä¼šå°½å¯èƒ½å…¨çš„æ˜¾ç¤ºåœ¨å…ƒç´ ä¸Šï¼Œä½†è¦æ³¨æ„ï¼šèƒŒæ™¯å›¾ç‰‡æœ‰å¯èƒ½æ˜¾ç¤ºä¸å®Œæ•´ã€‚â€“ç›¸å¯¹æ¯”è¾ƒå¥½çš„é€‰æ‹©</p><blockquote><p>background-size:cover;</p></blockquote><hr><p style="font-size:30px;color:#43E2FE;font-family:åæ–‡æ¥·ä½“">è¾¹æ¡†åœ†è§’</p><li>åŒæ—¶è®¾ç½®å››ä¸ªè§’çš„åœ†è§’ï¼š</li><blockquote><p>border-radius:10px;</p></blockquote><hr><p style="font-size:30px;color:#43E2FE;font-family:åæ–‡æ¥·ä½“">æ–‡æœ¬é˜´å½±</p><details>text-shadow:h-shahow v-shadow blur color;<summary>è¯­æ³•</summary></details><p style="font-size:30px;color:#43E2FE;font-family:åæ–‡æ¥·ä½“">æ–‡æœ¬æ¢è¡Œ</p></li>å¸¸ç”¨å€¼å¦‚ä¸‹</li>:<b>normal</b>:æ–‡æœ¬è¶…å‡ºè¾¹ç•Œè‡ªåŠ¨æ¢è¡Œï¼Œæ–‡æœ¬ä¸­çš„æ¢è¡Œè¢«æµè§ˆå™¨è¯†åˆ«ä¸ºä¸€ä¸ªç©ºæ ¼ã€‚ï¼ˆé»˜è®¤å€¼ï¼‰<b>pre</b>:åŸæ ·è¾“å‡ºï¼Œä¸preæ ‡ç­¾çš„æ•ˆæœç›¸åŒã€‚<b>pre-wrap</b>:åœ¨preæ•ˆæœçš„åŸºç¡€ä¸Šï¼Œè¶…å‡ºå…ƒç´ è¾¹ç•Œè‡ªåŠ¨æ¢è¡Œã€‚<b>pre-line</b>:åœ¨preæ•ˆæœçš„åŸºç¡€ä¸Šï¼Œè¶…å‡ºå…ƒç´ è¾¹ç•Œè‡ªåŠ¨æ¢è¡Œï¼Œä¸”è¯†åˆ«æ–‡æœ¬ä¸­çš„æ¢è¡Œï¼Œç©ºæ ¼ä¼šå¿½ç•¥ã€‚<b>nowrap</b>:å¼ºåˆ¶ä¸æ¢è¡Œã€‚<p style="font-size:30px;color:#43E2FE;font-family:åæ–‡æ¥·ä½“">æ–‡æœ¬æº¢å‡º</p><li>å¸¸ç”¨å€¼å¦‚ä¸‹</li>:<b>clip</b>:å…šå†…è”å†…å®¹æº¢å‡ºæ—¶ï¼Œå°†æº¢å‡ºéƒ¨åˆ†è£åˆ‡æ‰ã€‚ï¼ˆé»˜è®¤å€¼ï¼‰<b>ellipsis</b>:å½“å†…è”å†…å®¹æº¢å‡ºå¿«å®¹å™¨æ—¶ï¼Œå°†æº¢å‡ºéƒ¨åˆ†æ›¿æ¢ä¸ºÂ·Â·Â·ã€‚<blockquote><p>è¦ä½¿å¾—text-overflowå±æ€§ç”Ÿæ•ˆï¼Œå¿«å®¹å™¨å¿…é¡»æ˜¾å¼å®šä¹‰overflowä¸ºévisibleå€¼ï¼Œwhite-spaceä¸ºnowrapå€¼ã€‚</p></blockquote><hr><p style="font-size:30px;color:#43E2FE;font-family:åæ–‡è¡Œæ¥·">CSS3 å¤šåˆ—å¸ƒå±€</p><p>CSS å¤šåˆ—å¸ƒå±€æ˜¯ä¸€ç§ç”¨äºå°†ç½‘é¡µå†…å®¹æ’åˆ—æˆå¤šåˆ—æ˜¾ç¤ºçš„æŠ€æœ¯ï¼Œèƒ½å¤Ÿåœ¨æœ‰é™çš„ç©ºé—´å†…æ›´é«˜æ•ˆåœ°å±•ç¤ºä¿¡æ¯ï¼Œä»¥ä¸‹æ˜¯å…³äº CSS å¤šåˆ—å¸ƒå±€çš„å­¦ä¹ å†…å®¹ï¼š</p><li><b>åŸºæœ¬æ¦‚å¿µ</b></li><li>å¤šåˆ—å¸ƒå±€å±æ€§ï¼šCSS é€šè¿‡ä¸€ç³»åˆ—å±æ€§æ¥å®ç°å¤šåˆ—å¸ƒå±€ï¼Œä¸»è¦ç”¨äºæ§åˆ¶åˆ—çš„æ•°é‡ã€å®½åº¦ã€é—´è·ä»¥åŠåˆ—ä¹‹é—´çš„åˆ†éš”çº¿ç­‰ã€‚</li><li>åº”ç”¨åœºæ™¯ï¼šå¤šåˆ—å¸ƒå±€å¸¸ç”¨äºæ–°é—»åˆ—è¡¨ã€æ–‡ç« æ’ç‰ˆã€äº§å“å±•ç¤ºç­‰åœºæ™¯ï¼Œä½¿å†…å®¹å‘ˆç°æ›´åŠ æ¸…æ™°ã€æœ‰æ¡ç†ï¼Œæé«˜å¯è¯»æ€§å’Œè§†è§‰æ•ˆæœã€‚</li><br><li><b>ä¸»è¦å±æ€§</b></li><p><b>column-count</b></p><li>è¯­æ³•ï¼š<code>column-count: auto | &lt;integer&gt;</code></li><li>æè¿°ï¼šæŒ‡å®šå…ƒç´ è¦åˆ’åˆ†çš„åˆ—æ•°ï¼Œautoä¸ºé»˜è®¤å€¼ï¼Œè¡¨ç¤ºæ ¹æ®å…¶ä»–å±æ€§è‡ªåŠ¨è®¡ç®—åˆ—æ•°ï¼Œ&lt;integer&gt;ä¸ºå…·ä½“çš„åˆ—æ•°ã€‚</li><br><p><b>column-width</b></p><li>è¯­æ³•ï¼šcolumn-width: auto | &lt;length&gt;</li><li>æè¿°ï¼šæŒ‡å®šæ¯åˆ—çš„å®½åº¦ï¼Œautoè¡¨ç¤ºç”±æµè§ˆå™¨æ ¹æ®å®¹å™¨å¤§å°å’Œå…¶ä»–å±æ€§è‡ªåŠ¨ç¡®å®šåˆ—å®½ï¼Œ&lt;length&gt;ä¸ºå…·ä½“çš„å®½åº¦å€¼ï¼Œå¦‚100pxã€20emç­‰ã€‚</li><br><p><b>column-gap</b></p><li>è¯­æ³•ï¼šcolumn-gap: normal | &lt;length&gt;</li><li>è¯­æ³•ï¼šcolumn-gap: normal | &lt;length&gt;</li><li>æè¿°ï¼šè®¾ç½®åˆ—ä¸åˆ—ä¹‹é—´çš„é—´éš™å®½åº¦ï¼Œnormalçš„é»˜è®¤å€¼é€šå¸¸ä¸º1emï¼Œä¹Ÿå¯ä»¥æŒ‡å®šå…·ä½“çš„é•¿åº¦å€¼ã€‚</li><br><p><b>column-rule</b></p><li>è¯­æ³•ï¼šcolumn-rule: &lt;column-rule-width&gt; || &lt;column-rule-style&gt; || &lt;column-rule-color&gt;</li><li>è¯­æ³•ï¼šcolumn-rule: &lt;column-rule-width&gt; || &lt;column-rule-style&gt; || &lt;column-rule-color&gt;</li><li>æè¿°ï¼šæ˜¯ä¸€ä¸ªå¤åˆå±æ€§ï¼Œç”¨äºè®¾ç½®åˆ—ä¹‹é—´çš„åˆ†éš”çº¿ï¼Œåˆ†åˆ«å¯¹åº”åˆ†éš”çº¿çš„å®½åº¦ã€æ ·å¼å’Œé¢œè‰²ã€‚ä¾‹å¦‚column-rule: 1px solid blackè¡¨ç¤º 1 åƒç´ å®½ã€å®çº¿ã€é»‘è‰²çš„åˆ†éš”çº¿ã€‚</li><br><p><b>column-span</b></p><li>è¯­æ³•ï¼šcolumn-span: none | all</li><li>æè¿°ï¼šæŒ‡å®šå…ƒç´ æ˜¯å¦è·¨è¶Šæ‰€æœ‰åˆ—ï¼Œnoneè¡¨ç¤ºå…ƒç´ ä¸è·¨è¶Šåˆ—ï¼Œåœ¨æ‰€åœ¨åˆ—æ˜¾ç¤ºï¼Œallè¡¨ç¤ºå…ƒç´ è·¨è¶Šæ‰€æœ‰åˆ—ã€‚</li><br><li>ç¤ºä¾‹</li><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ CSS å¤šåˆ—å¸ƒå±€ç¤ºä¾‹ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.multicol</span> &#123;</span><br><span class="line">  <span class="comment">/* è®¾ç½®3åˆ—å¸ƒå±€ */</span></span><br><span class="line">  <span class="attribute">column-count</span>: <span class="number">3</span>;</span><br><span class="line">  <span class="comment">/* åˆ—ä¹‹é—´çš„é—´éš™ä¸º20px */</span></span><br><span class="line">  <span class="attribute">column-gap</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="comment">/* åˆ—ä¹‹é—´çš„åˆ†éš”çº¿ä¸º1pxå®çº¿ç°è‰² */</span></span><br><span class="line">  <span class="attribute">column-rule</span>: <span class="number">1px</span> solid gray;</span><br><span class="line">&#125;</span><br><span class="line">è®©ä¸€ä¸ªæ ‡é¢˜è·¨è¶Šæ‰€æœ‰åˆ—ï¼š</span><br><span class="line">css</span><br><span class="line"><span class="selector-tag">h1</span> &#123;</span><br><span class="line">  <span class="attribute">column-span</span>: all;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><b>æ³¨æ„äº‹é¡¹</b></p><li>å†…å®¹é€‚é…ï¼šå¤šåˆ—å¸ƒå±€ä¸­çš„å†…å®¹åº”æ ¹æ®åˆ—å®½è‡ªåŠ¨æ¢è¡Œå’Œè°ƒæ•´ï¼Œç¡®ä¿å†…å®¹åœ¨ä¸åŒåˆ—ä¸­å®Œæ•´æ˜¾ç¤ºï¼Œé¿å…å‡ºç°æˆªæ–­æˆ–æ˜¾ç¤ºä¸å®Œæ•´çš„æƒ…å†µã€‚å¯¹äºå›¾åƒç­‰å…ƒç´ ï¼Œå¯èƒ½éœ€è¦è®¾ç½®max-width: 100%ç­‰å±æ€§æ¥ä½¿å…¶é€‚åº”åˆ—å®½ã€‚</li><li>å…¼å®¹æ€§é—®é¢˜ï¼šå¤šåˆ—å¸ƒå±€åœ¨ä¸åŒæµè§ˆå™¨ä¸­çš„æ”¯æŒå­˜åœ¨ä¸€å®šå·®å¼‚ï¼Œç‰¹åˆ«æ˜¯åœ¨ä¸€äº›æ—§ç‰ˆæœ¬æµè§ˆå™¨ä¸­ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œéœ€è¦è¿›è¡Œå……åˆ†çš„æµ‹è¯•ï¼Œå¹¶æ ¹æ®éœ€è¦ä½¿ç”¨æµè§ˆå™¨å‰ç¼€æ¥æé«˜å…¼å®¹æ€§ï¼Œå¦‚-webkit-column-countã€-moz-column-countç­‰ã€‚</li><li>å¤æ‚å¸ƒå±€å¤„ç†ï¼šå¯¹äºå¤æ‚çš„å¤šåˆ—å¸ƒå±€éœ€æ±‚ï¼Œå¯èƒ½éœ€è¦ç»“åˆå…¶ä»– CSS å¸ƒå±€æŠ€æœ¯ï¼Œå¦‚ Flexbox æˆ– Grid å¸ƒå±€æ¥å®ç°æ›´ç²¾ç»†çš„æ’ç‰ˆæ•ˆæœã€‚åŒæ—¶ï¼Œè¦æ³¨æ„å¤šåˆ—å¸ƒå±€ä¸å…¶ä»–å¸ƒå±€æ–¹å¼ä¹‹é—´çš„ç›¸äº’å½±å“ï¼Œé¿å…å‡ºç°å¸ƒå±€æ··ä¹±çš„é—®é¢˜ã€‚</li>]]></content>
      
      
      <categories>
          
          <category> CSSåŸºç¡€ </category>
          
          <category> Visual Studio Code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
            <tag> Visual Studio Code </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¤è¯†HTML.4å­¦ä¹ ç¬”è®°</title>
      <link href="/2025/01/21/html/%E5%AD%A6%E4%B9%A0html.4/"/>
      <url>/2025/01/21/html/%E5%AD%A6%E4%B9%A0html.4/</url>
      
        <content type="html"><![CDATA[<p style="font-size:30px;color:#8DFEF6">åˆ—è¡¨æ ‡ç­¾</p><br><p>datalist:ç”¨äºæœç´¢æ¡†çš„å…³é”®å­—æç¤º</p><p>details:ç”¨äºå±•ç¤ºé—®é¢˜å’Œç­”æ¡ˆï¼Œæˆ–å¯¹ä¸“æœ‰åè¯è¿›è¡Œè§£é‡Š</p><p>summary:å†™åœ¨detaislsçš„é‡Œé¢ï¼Œç”¨äºæŒ‡å®šé—®é¢˜æˆ–ä¸“ç”¨åè¯</p><p style="font-size:30px;color:#8DFEF6">æ–‡æœ¬æ ‡ç­¾</p><br>ruby:åŒ…è£¹éœ€è¦æ³¨éŸ³çš„æ–‡å­—rt:å†™æ³¨éŸ³ï¼Œrtæ ‡ç­¾å†™åœ¨rubyçš„é‡Œé¢<p style="font-size:30px;color:#8DFEF6">æ–‡æœ¬æ ‡è®°</p><br>mark:æ ‡è®°<p style="font-size:30px;color:#8DFEF6">è¡¨å•åŠŸèƒ½</p><br><p>placeholder:æç¤ºæ–‡å­—ï¼ˆæ³¨æ„ï¼šä¸æ˜¯é»˜è®¤å€¼ï¼Œvalueæ˜¯é»˜è®¤å€¼ï¼‰ï¼Œé€‚ç”¨äº<mark>æ–‡å­—è¾“å…¥ç±»</mark>çš„è¡¨å•æ§ä»¶ã€‚</p><p>required:è¡¨ç¤ºè¾“å…¥é¡¹å¿…å¡«ï¼Œé€‚ç”¨äº<mark>é™¤æŒ‰é’®å¤–</mark>å…¶ä»–è¡¨å•æ§ä»¶ã€‚</p><p>autofocus:è‡ªåŠ¨è·å–ç„¦ç‚¹ï¼Œé€‚ç”¨äºæ‰€æœ‰è¡¨å•æ§ä»¶ã€‚</p><p>autocomplete:è‡ªåŠ¨å®Œæˆï¼Œå¯ä»¥è®¾ç½®ä¸º<mark>on</mark>æˆ–<mark>off</mark>ï¼Œé€‚ç”¨äº<make>æ–‡å­—è¾“å…¥ç±»</make>çš„è¡¨å•æ§ä»¶ã€‚</p><p>pattern:å¡«å†™æ­£åˆ™è¡¨è¾¾å¼ï¼Œæ˜¯ç”¨äºè¾“å…¥ç±»è¡¨å•æ§ä»¶ã€‚        æ³¨æ„ï¼šå¤šè¡Œè¾“å…¥ä¸å¯ç”¨ï¼Œä¸”ç©ºçš„è¾“å…¥æ¡†ä¸ä¼šéªŒè¯ï¼Œå¾€å¾€ä¸<mark>required</mark>é…åˆã€‚</p>          <p style="font-size:30px;color:#8DFEF6">inputå±æ€§å€¼</p><p><br></br><br>email:é‚®ç®±ç±»å‹çš„è¾“å…¥æ¡†ï¼Œè¡¨å•æäº¤æ—¶ä¼šéªŒè¯æ ¼å¼ï¼Œè¾“å…¥ä¸ºç©ºåˆ™ä¸éªŒè¯æ ¼å¼ã€‚<br>url:urlç±»å‹çš„è¾“å…¥æ¡†ï¼Œè¡¨å•æäº¤æ—¶ä¼šéªŒè¯æ ¼å¼ï¼Œè¾“å…¥ä¸ºç©ºåˆ™ä¸éªŒè¯æ ¼å¼ã€‚<br>number:æ•°å­—ç±»å‹çš„è¾“å…¥æ¡†ï¼Œè¡¨å•æäº¤æ—¶ä¼šéªŒè¯æ ¼å¼ï¼Œè¾“å…¥ä¸ºç©ºåˆ™ä¸éªŒè¯æ ¼å¼ã€‚<br>search:æœç´¢ç±»å‹çš„è¾“å…¥æ¡†ï¼Œè¡¨å•æäº¤æ—¶ä¸ä¼šéªŒè¯æ ¼å¼ã€‚<br>tel:ç”µè¯ç±»å‹çš„è¾“å…¥æ¡†ï¼Œè¡¨å•æäº¤æ—¶ä¸ä¼šéªŒè¯æ ¼å¼ï¼Œåœ¨ç§»åŠ¨ç«¯ä½¿ç”¨æ—¶ï¼Œä¼šå”¤èµ·æ•°å­—é”®ç›˜ã€‚<br>range:èŒƒå›´é€‰æ‹©æ¡†ï¼Œé»˜è®¤å€¼ä¸º<make>50</make>ï¼Œè¡¨å•æäº¤æ—¶ä¸ä¼šéªŒè¯æ ¼å¼ã€‚<br>color:é¢œè‰²é€‰æ‹©æ¡†ï¼Œé»˜è®¤å€¼ä¸ºé»‘è‰²ï¼Œè¡¨å•æäº¤æ—¶ä¸ä¼šéªŒè¯æ ¼å¼ã€‚<br>date:æ—¥æœŸé€‰æ‹©æ¡†ï¼Œé»˜è®¤å€¼ä¸ºç©ºï¼Œè¡¨å•æäº¤æ—¶ä¸ä¼šéªŒè¯æ ¼å¼ã€‚<br>month:æœˆä»½é€‰æ‹©æ¡†ï¼Œé»˜è®¤å€¼ä¸ºç©ºï¼Œè¡¨å•æäº¤æ—¶ä¸ä¼šéªŒè¯æ ¼å¼ã€‚<br>week:å‘¨é€‰æ‹©æ¡†ï¼Œé»˜è®¤å€¼ä¸ºç©ºï¼Œè¡¨å•æäº¤æ—¶ä¸ä¼šéªŒè¯æ ¼å¼ã€‚<br>time:æ—¶é—´é€‰åˆ™æ¡†ï¼Œé»˜è®¤å€¼ä¸ºç©ºï¼Œè¡¨å•æäº¤æ—¶ä¸ä¼šéªŒè¯æ ¼å¼ã€‚<br>datetime-local:æ—¥æœŸâ•æ—¶é—´é€‰æ‹©æ¡†ï¼Œé»˜è®¤å€¼ä¸ºç©ºï¼Œè¡¨å•æäº¤æ—¶ä¸ä¼šéªŒè¯æ ¼å¼ã€‚</p><p style="font-size:30px;color:#8DFEF6">formå±æ€§</p><blockquote><p>novalidate:å¦‚æœç»™formæ ‡ç­¾è®¾ç½®äº†è¯¥å±æ€§å€¼ï¼Œè¡¨å•æäº¤çš„æ—¶å€™ä¸å†è¿›è¡ŒéªŒè¯ã€‚</p></blockquote><p style="font-size:30px;color:#8DFEF6">è§†é¢‘æ ‡ç­¾</p><p>&lt;video&gt;æ ‡ç­¾ç”¨æ¥å®šä¹‰è§†é¢‘ï¼Œä»–æ˜¯åŒæ ‡ç­¾ã€‚</p><p><br></br></p><p>src:URLåœ°å€  è§†é¢‘åœ°å€<br>width:åƒç´ å€¼  è®¾ç½®è§†é¢‘æ’­æ”¾å™¨çš„å®½é«˜<br>height:åƒç´ å€¼  è®¾ç½®è§†é¢‘æ’­æ”¾å™¨çš„é«˜åº¦<br>controls:å‘ç”¨æˆ·æ˜¾ç¤ºè§†é¢‘æ§ä»¶ï¼ˆæ¯”å¦‚æ’­æ”¾&#x2F;æš‚åœæŒ‰é’®ï¼‰<br>muted:è§†é¢‘é™éŸ³<br>autoplay:è§†é¢‘è‡ªåŠ¨æ’­æ”¾<br>loop:å¾ªç¯æ’­æ”¾<br>poster:URLåœ°å€   è§†é¢‘å°é¢<br>preload:  auto&#x2F;metadta&#x2F;none  å¦‚æœä½¿ç”¨autoplay,åˆ™å¿½ç•¥è¯¥å±æ€§ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> HTMLåŸºç¡€ </category>
          
          <category> Visual Studio Code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Visual Studio Code </tag>
            
            <tag> HTML </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­¦ä¹ CSS.7å­¦ä¹ ç¬”è®°</title>
      <link href="/2025/01/19/css/%E5%AD%A6%E4%B9%A0css.7/"/>
      <url>/2025/01/19/css/%E5%AD%A6%E4%B9%A0css.7/</url>
      
        <content type="html"><![CDATA[<p style="font-size:40px;color:#0F7369;font-family:åæ–‡æ¥·ä½“">CSS ç›¸å¯¹å®šä½</p><p><b>1.å¦‚ä½•è®¾ç½®ç›¸å¯¹å®šä½ï¼Ÿ</b></p><ul>    <li>ç»™å…ƒç´ è®¾ç½®<code>position:relative</code>å³å¯å®ç°ç›¸å¯¹å®šä½ã€‚</li>    <li>å¯ä»¥ä½¿ç”¨<code>leftã€rightã€topã€bottom</code>å››ä¸ªå±æ€§è°ƒæ•´ä½ç½®ã€‚</li>    </ul>  <p><b>2.ç›¸å¯¹å®šä½çš„å‚è€ƒç‚¹åœ¨å“ªé‡Œï¼Ÿ</b></p><ul>    <li>ç›¸å¯¹è‡ªå·±åŸæ¥çš„ä½ç½®</li>    </ul><p><b>3.ç›¸å¯¹å®šä½çš„ç‰¹ç‚¹</b></p><ol>    <li>ä¸ä¼šè„±ç¦»æ–‡æ¡£æµï¼Œå…ƒç´ ä½ç½®çš„å˜åŒ–ï¼Œåªæ˜¯è§†è§‰æ•ˆæœä¸Šçš„å˜åŒ–ï¼Œä¸ä¼šå¯¹å…¶ä»–å…ƒç´ äº§ç”Ÿä»»ä½•å½±å“ã€‚</li>    <li>å®šä½å…ƒç´ çš„æ˜¾ç¤º<b>å±‚çº§</b>æ¯”æ™®é€šå…ƒç´ é«˜ï¼Œæ— è®ºä»€ä¹ˆå®šä½ï¼Œæ˜¾ç¤ºå±‚çº§éƒ½æ˜¯ä¸€æ ·çš„ã€‚</li>    <p>é»˜è®¤è§„åˆ™æ˜¯ï¼š<p>    <ul>        <li>å®šä½çš„å…ƒç´ ä¼šç›–åœ¨æ™®é€šå…ƒç´ ä¹‹ä¸Šã€‚</li>        <li>éƒ½å‘ç”Ÿå®šä½çš„ä¿©ä¸ªå…ƒç´ ï¼Œåå†™çš„å…ƒç´ ä¼šç›–åœ¨å…ˆå†™çš„å…ƒç´ ä¹‹æ°´ä¸Šã€‚</li>        </ul>    <li><code>left</code>ä¸èƒ½å’Œ<code>right</code>ä¸€èµ·è®¾ç½®ï¼Œ<code>top</code>å’Œ<code>bottom</code>ä¸èƒ½ä¸€èµ·è®¾ç½®ã€‚</li>    <li>ç›¸å¯¹å®šä½çš„å…ƒç´ ï¼Œä¹Ÿèƒ½ç»§ç»­æµ®åŠ¨ï¼Œä½†ä¸æ¨èè¿™æ ·åšã€‚</li>    <li>æƒ³å¯¹è¡Œä¸ºçš„å…ƒç´ ï¼Œä¹Ÿèƒ½é€šè¿‡<code>margin</code>è°ƒæ•´ä½ç½®ï¼Œä½†ä¸æ¨èè¿™æ ·åšã€‚</li>    </ol>    <blockquote><p>ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œç›¸å¯¹å®šä½ï¼Œä¼šä¸ç»å¯¹å®šä½é…åˆä½¿ç”¨ã€‚</p></blockquote><p style="font-size:40px;color:#0F7369;font-family:åæ–‡æ¥·ä½“">CSS ç»å¯¹å®šä½</p><p>å¦‚ä½•è®¾ç½®ç»å¯¹å®šä½ï¼Ÿ</p><ul>    <li>ç»™å…ƒç´ è®¾ç½®<code>position:absolute</code>å³å¯å®ç°ç»å¯¹å®šä½ã€‚</li>    <li>å¯ä»¥ä½¿ç”¨<code>leftã€rightã€topã€bottom</code>å››ä¸ªå±æ€§è°ƒæ•´ä½ç½®ã€‚</li>    </ul>    <p>ç»å¯¹å®šä½çš„å‚è€ƒç‚¹åœ¨å“ªé‡Œï¼Ÿ</p>    <li>å‚è€ƒå®ƒçš„åŒ…å«å—ã€‚</li>    </ul><blockquote><p>ä»€ä¹ˆæ˜¯åŒ…å«å—ï¼Ÿ</p><p> 1.å¯¹äºæ²¡æœ‰è„±ç¦»æ–‡æ¡£æµçš„å…ƒç´ ï¼šåŒ…å«å—å°±æ˜¯çˆ¶å…ƒç´ ï¼›<br>    2.å¯¹äºè„±ç¦»æ–‡æ¡£æµçš„å…ƒç´ ï¼šåŒ…å«å—æ˜¯ç¬¬ä¸€ä¸ªæ‹¥æœ‰å®šä½å±æ€§çš„ç¥–å…ˆå…ƒç´ ï¼ˆå¦‚æœæ‰€æœ‰ç¥–å…ˆéƒ½æ²¡å®šä½ï¼Œé‚£åŒ…å«å¿«å°±æ˜¯æ•´ä¸ªé¡µé¢ï¼‰ã€‚</p></blockquote><p>ç»å¯¹å®šä½å…ƒç´ çš„ç‰¹ç‚¹ï¼š</p><ol>    <li>è„±ç¦»æ–‡æ¡£æµï¼Œä¼šå¯¹åé¢çš„å…„å¼Ÿå…ƒç´ ã€çˆ¶å…ƒç´ æœ‰å½±å“ã€‚</li>    <li><code>left</code>ä¸èƒ½å’Œ<code>right</code>ä¸€èµ·è®¾ç½®ï¼Œ<code>top</code>å’Œ<code>bottom</code>ä¸èƒ½ä¸€èµ·è®¾ç½®ã€‚</li>    <li>ç»å¯¹å®šä½ã€æµ®åŠ¨ä¸èƒ½åŒæ—¶è®¾ç½®ï¼Œå¦‚æœåŒæ—¶è®¾ç½®ï¼Œæµ®åŠ¨å¤±æ•ˆï¼Œä»¥ç»å¯¹å®šä½ä¸ºä¸»ã€‚</li>    <li>ç»å¯¹å®šä½çš„å…ƒç´ ï¼Œä¹Ÿèƒ½ç”¨è¿‡<code>margin</code>è°ƒæ•´ä½ç½®ï¼Œä½†ä¸æ¨èè¿™æ ·åšã€‚</li>    <li>æ— è®ºæ˜¯ä»€ä¹ˆå…ƒç´ ï¼ˆè¡Œå†…ã€è¡Œå†…å—ã€å—çº§ï¼‰è®¾ç½®ä¸ºç»å¯¹å®šä½ä¹‹åï¼Œéƒ½å˜æˆäº†ç»å¯¹å®šä½å…ƒç´ ã€‚</li>    </ol> <blockquote><p>ä½•ä¸ºå®šä½å…ƒç´ ï¼Ÿâ€“é»˜è®¤å®½ã€é«˜éƒ½è¢«å†…å®¹æ‰€æ’‘å¼€ï¼Œä¸”èƒ½è‡ªç”¨è®¾ç½®å®½é«˜ã€‚</p></blockquote><p style="font-size:40px;color:#0F7369;font-family:åæ–‡æ¥·ä½“">CSS å›ºå®šå®šä½</p>    <p><b>å¦‚ä½•è®¾ç½®ä¸ºå›ºå®šå®šä½ï¼Ÿ</b></p><ul>    <li>ç»™å…ƒç´ è®¾ç½®<code>position:fixed</code>å³å¯å®ç°å›ºå®šå®šä½ã€‚</li>    <li>å¯ä»¥ä½¿ç”¨<code>leftã€rightã€topã€bottom</code>å››ä¸ªå±æ€§è°ƒæ•´ä½ç½®ã€‚</li>    <p>å›ºå®šå®šä½çš„å‚è€ƒç‚¹åœ¨å“ªé‡Œï¼Ÿ</p>    <li>å‚è€ƒå®ƒçš„<b>è§†å£</b>        </ul> <blockquote><p>ä»€ä¹ˆæ˜¯è§†å£ï¼Ÿâ€“å¯¹äºPCæµè§ˆå™¨æ¥è¯´ï¼Œè§†å£å°±æ˜¯æˆ‘ä»¬çœ‹ç½‘é¡µçš„é‚£æ‰‡â€œçª—æˆ·â€ã€‚</p></blockquote><p><b>å›ºå®šå®šä½å…ƒç´ çš„ç‰¹ç‚¹</b></p><ol>    <li>è„±ç¦»æ–‡æ¡£æµï¼Œä¼šå¯¹åé¢çš„å…„å¼Ÿå…ƒç´ ã€çˆ¶å…ƒç´ æœ‰å½±å“ã€‚</li>    <li><code>left</code>ä¸èƒ½å’Œ<code>right</code>ä¸€èµ·è®¾ç½®ï¼Œ<code>top</code>å’Œ<code>bottom</code>ä¸èƒ½ä¸€èµ·è®¾ç½®ã€‚</li>    <li>å›ºå®šå®šä½ã€æµ®åŠ¨ä¸èƒ½åŒæ—¶è®¾ç½®ï¼Œå¦‚æœåŒæ—¶è®¾ç½®ï¼Œæµ®åŠ¨å¤±æ•ˆï¼Œä»¥å›ºå®šå®šä½ä¸ºä¸»ã€‚</li>    <li>å›ºå®šå®šä½çš„å…ƒç´ ï¼Œä¹Ÿèƒ½ç”¨è¿‡<code>margin</code>è°ƒæ•´ä½ç½®ï¼Œä½†ä¸æ¨èè¿™æ ·åšã€‚</li>    <li>æ— è®ºæ˜¯ä»€ä¹ˆå…ƒç´ ï¼ˆè¡Œå†…ã€è¡Œå†…å—ã€å—çº§ï¼‰è®¾ç½®ä¸ºç»å¯¹å®šä½ä¹‹åï¼Œéƒ½å˜æˆäº†å›ºå®šå®šä½å…ƒç´ ã€‚</li>    </ol>    <p style="font-size:40px;color:#0F7369;font-family:åæ–‡æ¥·ä½“">CSS ç²˜æ€§å®šä½</p><p><b>å¦‚ä½•è®¾ç½®ä¸ºç²˜æ€§å®šä½ï¼Ÿ</b></p><ul>    <li>ç»™å…ƒç´ è®¾ç½®<code>position:sticky</code>å³å¯å®ç°ç²˜æ€§å®šä½ã€‚</li>    <li>å¯ä»¥ä½¿ç”¨<code>leftã€rightã€topã€bottom</code>å››ä¸ªå±æ€§è°ƒæ•´ä½ç½®ï¼Œä¸è¿‡æœ€å¸¸ç”¨çš„æ˜¯<code>top</code>å€¼ã€‚</li>    </ul><p><b>ç²˜æ€§å®šä½çš„å‚è€ƒç‚¹åœ¨å“ªé‡Œï¼Ÿ</b></p><ul>    <li>ç¦»ä»–æœ€è¿‘çš„ä¸€ä¸ªæ‹¥æœ‰â€œæ»šåŠ¨æœºåˆ¶â€çš„ç¥–å…ˆå…ƒç´ ï¼Œå³ä½¿è¿™ä¸ªç¥–å…ˆä¸æ˜¯æœ€è¿‘çš„çœŸå®å¯æ»šåŠ¨ç¥–å…ˆã€‚</li>    </ul>    <p> <b>ç²˜æ€§å®šä½å…ƒç´ çš„ç‰¹ç‚¹</b></p> <ul> <li>ä¸ä¼šè„±ç¦»æ–‡æ¡£æµï¼Œå®ƒæ˜¯ä¸€ç§ä¸“é—¨ç”¨äºçª—å£æ»šåŠ¨æ˜¯çš„æ–°çš„å®šä½æ–¹å¼ã€‚</li> <li>æœ€å¸¸ç”¨çš„å€¼æ˜¯<code>top</code>å€¼ã€‚</li> <li>ç²˜æ€§å®šä½å’Œæµ®åŠ¨å¯ä»¥åŒæ—¶è®¾ç½®ï¼Œä½†ä¸æ¨èè¿™æ ·åšã€‚</li> <li>ç²˜æ€§å®šä½çš„å…ƒç´ ï¼Œä¹Ÿèƒ½é€šè¿‡<code>margin</code>è°ƒæ•´ä½ç½®ï¼Œä½†ä¸æ¨èè¿™æ ·åšã€‚</li> </ul><p style="font-size:40px;color:#0F7369;font-family:åæ–‡æ¥·ä½“">CSS å®šä½çš„ç‰¹æ®Šåº”ç”¨</p><blockquote><p>1.å‘ç”Ÿå›ºå®šå®šä½ã€ç»å¯¹å®šä½åï¼Œå…ƒç´ éƒ½å˜æˆäº†å®šä½å…ƒç´ ï¼Œé»˜è®¤å®½é«˜è¢«å†…å®¹æ’‘å¼€ï¼Œä¸”ä¾ç„¶å¯ä»¥è®¾ç½®å®½é«˜ã€‚<br>2.å‘ç”Ÿç›¸å¯¹å®šä½åï¼Œå…ƒç´ ä¾ç„¶æ˜¯ä¹‹å‰çš„æ˜¾ç¤ºæ¨¡å¼ã€‚<br>3.ä»¥ä¸‹æ‰€è¯´çš„ç‰¹æ®Šåº”ç”¨ï¼Œåªé’ˆå¯¹<code>ç»å¯¹å®šä½</code>å’Œ<code>å›ºå®šå®šä½</code>çš„å…ƒç´ ï¼Œä¸åŒ…æ‹¬ç›¸å¯¹å®šä½çš„å…ƒç´ ã€‚</p></blockquote><p><b>è®©å®šä½å…ƒç´ çš„æ¬¾å……æ»¡åŒ…å«å—</b><br>1.å¿«å®½æƒ³ä¸åŒ…å«å—ä¸€è‡´ï¼Œå¯ä»¥ç»™å®šä½å…ƒç´ åŒæ—¶è®¾ç½®<code>left</code>å’Œ<code>right</code>ä¸º0ã€‚<br>2.é«˜åº¦æƒ³ä¸åŒ…å«å—ä¸€è‡´ï¼Œ<code>top</code>å’Œ<code>bottom</code>è®¾ç½®ä¸º0ã€‚</p><p><b>è®©å®šä½å…ƒç´ åœ¨åŒ…å«å—ä¸­å±…ä¸­</b><br>æ–¹æ¡ˆä¸€ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">left:0;</span><br><span class="line">right:0;</span><br><span class="line">top:0;</span><br><span class="line">bottom:0;</span><br><span class="line">margin:0;</span><br></pre></td></tr></table></figure><p>æ–¹æ¡ˆäºŒï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">left:50%;</span><br><span class="line">top:50;</span><br><span class="line">margin-left:è´Ÿçš„å®½åº¦ä¸€åŠ;</span><br><span class="line">margin-top:è´Ÿçš„é«˜åº¦ä¸€åŠ;</span><br></pre></td></tr></table></figure><blockquote><p>è¯¥å®šä½çš„å…ƒç´ å¿…é¡»è®¾ç½®å®½é«˜ï¼ï¼ï¼</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CSSåŸºç¡€ </category>
          
          <category> Visual Studio Code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
            <tag> Visual Studio Code </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­¦ä¹ CSS.6å­¦ä¹ ç¬”è®°</title>
      <link href="/2025/01/19/css/%E5%AD%A6%E4%B9%A0css.6/"/>
      <url>/2025/01/19/css/%E5%AD%A6%E4%B9%A0css.6/</url>
      
        <content type="html"><![CDATA[<h6 style="font-size:50px;color:#54E4E9;font-family:åæ–‡æ¥·ä½“">CSS æµ®åŠ¨ï¼ˆfloatï¼‰</h6><blockquote><p>ç°åœ¨æµ®åŠ¨æ˜¯ä¸»æµçš„é¡µé¢å¸ƒå±€æ–¹å¼ä¹‹ä¸€ã€‚</p></blockquote><p><b>1.å…ƒç´ æµ®åŠ¨åçš„ç‰¹ç‚¹</b></p><lo>    <li>è„±ç¦»æ–‡æ¡£æµ</li>    <li>ä¸ç®¡æµ®åŠ¨å‰æ˜¯ä»€ä¹ˆå…ƒç´ ï¼Œæµ®åŠ¨åï¼šé»˜è®¤å®½ä¸é«˜éƒ½æ˜¯è¢«å†…å®¹æ’‘å¼€ï¼ˆå°½å¯èƒ½å°ï¼‰ï¼Œè€Œä¸”å¯ä»¥è®¾ç½®å®½é«˜ã€‚</li>    <li>ä¸ä¼šç‹¬å ä¸€è¡Œï¼Œå¯ä»¥ä¸å…¶ä»–å…ƒç´ å…±ç”¨ä¸€è¡Œã€‚</li>    <li>ä¸ä¼š<code>margin</code>åˆå¹¶ï¼Œä¹Ÿä¸ä¼š<code>margin</code>å¡Œé™·ï¼Œèƒ½å¤Ÿå®Œç¾åœ°è®¾ç½®å››ä¸ªæ–¹å‘çš„<code>margin</code><code>padding</code>ã€‚</li>    <li>ä¸ä¼šåƒè¡Œå†…å—ä¸€æ ·è¢«å½“ä½œæ–‡æœ¬å¤„ç†ï¼ˆæ²¡æœ‰è¡Œå†…å—çš„ç©ºç™½é—®é¢˜ï¼‰ã€‚</li>    </lo>    <br><p><b>2.æµ®åŠ¨åä¼šæœ‰å“ªäº›å½±å“</b><br><b>å¯¹å…„å¼Ÿå…ƒç´ çš„å½±å“</b>:åé¢çš„å…„å¼Ÿå…ƒç´ ï¼Œä¼šå æ®æµ®åŠ¨å…ƒç´ ä¹‹å‰çš„ä½ç½®ï¼Œåœ¨æµ®åŠ¨å…ƒç´ çš„ä¸‹é¢ï¼›å¯¹å‰é¢çš„å…„å¼Ÿæ— å½±å“ã€‚<br><b>å¯¹çˆ¶å…ƒç´ çš„å½±å“</b>:ä¸èƒ½æ’‘èµ·çˆ¶å…ƒç´ çš„é«˜åº¦ï¼Œå¯¼è‡´çˆ¶å…ƒç´ é«˜åº¦å¡Œé™·ï¼›ä½†çˆ¶å…ƒç´ çš„å®½é«˜ä¾ç„¶æŸç¼šæµ®åŠ¨çš„å…ƒç´ ã€‚</p><p><b>3.è§£å†³æµ®åŠ¨äº§ç”Ÿçš„å½±å“ï¼ˆæ¸…é™¤æµ®åŠ¨ï¼‰</b></p><p>è§£å†³æ–¹æ¡ˆï¼š<br>        1.æ–¹æ¡ˆä¸€ï¼šç»™çˆ¶å…ƒç´ æŒ‡å®šé«˜åº¦ã€‚<br>        2.æ–¹æ¡ˆäºŒï¼šç»™çˆ¶å…ƒç´ ä¹Ÿè®¾ç½®æµ®åŠ¨ï¼Œå¸¦æ¥å…¶ä»–å½±å“ã€‚<br>        3.æ–¹æ¡ˆä¸‰ï¼šç»™çˆ¶å…ƒç´ è®¾ç½®<code>overflow:hidden</code>ã€‚<br>        4.æ–¹æ¡ˆå››ï¼šåœ¨æ‰€æœ‰æµ®åŠ¨å…ƒç´ çš„æœ€åé¢ï¼Œæ·»åŠ ä¸€ä¸ªå—çº§å…ƒç´ ï¼Œå¹¶ç»™è¯¥å—çº§å…ƒç´ è®¾ç½®<code>clear:both</code>ã€‚<br>        5.æ–¹æ¡ˆäº”ï¼šç»™æµ®åŠ¨å…ƒç´ çš„çˆ¶å…ƒç´ ï¼Œè®¾ç½®ä¼ªå…ƒç´ ï¼Œé€šè¿‡ä¼ªå…ƒç´ æ¸…é™¤æµ®åŠ¨ï¼ŒåŸç†ä¸æ–¹æ¡ˆå››ç›¸åŒã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.parent::after&#123;</span><br><span class="line">     contert:&#x27;&#x27;;</span><br><span class="line">     display:block;</span><br><span class="line">     clear:both;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><blockquote><p>å¸ƒå±€ä¸­çš„ä¸€ä¸ªåŸåˆ™ï¼šè®¾ç½®æµ®åŠ¨çš„æ—¶å€™ï¼Œå…„å¼Ÿå…ƒç´ è¦ä¹ˆå…¨éƒ½æµ®åŠ¨ï¼Œè¦ä¹ˆå…¨éƒ½ä¸æµ®åŠ¨ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CSSåŸºç¡€ </category>
          
          <category> Visual Studio Code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
            <tag> Visual Studio Code </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­¦ä¹ CSS.5å­¦ä¹ ç¬”è®°</title>
      <link href="/2025/01/18/css/%E5%AD%A6%E4%B9%A0css.5/"/>
      <url>/2025/01/18/css/%E5%AD%A6%E4%B9%A0css.5/</url>
      
        <content type="html"><![CDATA[<h6 style="font-size:50px;color:#7C5E17;font-family:åæ–‡æ¥·ä½“">CSSç›’å­æ¨¡å‹</h6><ol>    <li style="font-size:25px;"><b>CSSé•¿åº¦å•ä½</b></li>    </ol>    <ol>    <li><code>px</code>:åƒç´ ã€‚</li>    <li><code>em</code>:ç›¸å¯¹å…ƒç´ <code>font-size</code>çš„å€æ•°ã€‚</li>    <li><code>rem</code>:ç›¸å¯¹æ ¹å­—ä½“å¤§å°ï¼Œhtmlæ ‡ç­¾å°±æ˜¯æ ¹.</li>    <li><code>%</code>:ç›¸å¯¹çˆ¶å…ƒç´ è®¡ç®—ã€‚</li>    </ol><blockquote><p>CSSä¸­è®¾ç½®é•¿åº¦ï¼Œå¿…é¡»åŠ å•ä½ï¼Œå¦åˆ™æ ·å¼æ— æ•ˆï¼</p></blockquote><br><br><p style="font-size:30px;color:#26F0E6;font-family:åæ–‡æ¥·ä½“">ç›’å­æ¨¡å‹çš„ç»„æˆ</p><p><code>CSS</code>ä¼šæŠŠæ‰€æœ‰çš„<code>HTML</code>å…ƒç´ éƒ½çœ‹æˆä¸€ä¸ª<b>ç›’å­</b>ï¼Œæ‰€æœ‰çš„æ ·å¼ä¹Ÿéƒ½æ˜¯åŸºäºè¿™ä¸ªç›’å­ã€‚</p><ol>    <li><b>marginï¼ˆå¤–è¾¹è·ï¼‰</b>ï¼šç›’å­ä¸å¤–ç•Œçš„è·ç¦»ã€‚ï¼ˆä¸ä¼šå½±å“ç›’å­å¤§å°ï¼Œä½†ä¼šå½±å“ç›’å­çš„ä½ç½®ï¼‰</li>    <li><b>borderï¼ˆè¾¹æ¡†ï¼‰</b>:ç›’å­çš„è¾¹æ¡†ã€‚</li>    <li><b>paddingï¼ˆå†…è¾¹è·ï¼‰</b>:ç´§è´´å†…å®¹çš„è¡¥ç™½åŒºåŸŸã€‚</li>    <li><b>contertï¼ˆå†…å®¹ï¼‰</b>:å…ƒç´ ä¸­çš„æ–‡æœ¬æˆ–åä»£å…ƒç´ éƒ½æ˜¯å®ƒçš„å†…å®¹ã€‚</li>    </ol><blockquote><p>ç›’å­çš„å¤§å°&#x3D;content+å·¦å³padding+å·¦å³borderã€‚</p></blockquote><br><p style="font-size:30px;color:#26F0E6;font-family:åæ–‡æ¥·ä½“">marginæ³¨æ„äº‹é¡¹</p><blockquote><p>1.å­å…ƒç´ çš„<code>margin</code>,æ˜¯å‚è€ƒçˆ¶å…ƒç´ çš„<code>content</code>è®¡ç®—çš„ã€‚ï¼ˆå› ä¸ºæ˜¯çˆ¶äº²çš„contentä¸­æ‰¿è£…ç€å­å…ƒç´ ï¼‰<br>2.ä¸Š<code>margin</code>ã€å·¦<code>margin</code>:å½±å“è‡ªå·±çš„ä½ç½®ï¼›ä¸‹<code>margin</code>ã€å³<code>margin</code>:å½±å“åé¢å…„å¼Ÿå…ƒç´ çš„ä½ç½®ã€‚<br>3.å—çº§å…ƒç´ ã€è¡Œå†…å—çº§å…ƒç´ ï¼Œå‡å¯å®Œç¾åœ°è®¾ç½®å››ä¸ªæ–¹å‘çš„<code>margin</code>ï¼›ä½†è¡Œå†…å…ƒç´ ï¼Œå·¦å³<code>margin</code>å¯ä»¥å®Œç¾è®¾ç½®ï¼Œä¸Šä¸‹<code>margin</code>è®¾ç½®æ— æ•ˆã€‚<br>4.<code>margin</code>çš„å€¼ä¹Ÿå¯ä»¥æ˜¯<code>auto</code>,å¦‚æœç»™ä¸€ä¸ª<b>å—çº§å…ƒç´ </b>è®¾ç½®å·¦å³<code>margin</code>éƒ½ä¸º<code>auto</code>,è¯¥å—çº§å…ƒç´ ä¼šåœ¨çˆ¶å…ƒç´ ä¸­æ°´å¹³å±…ä¸­ã€‚<br>5.<code>margin</code>çš„å€¼å¯ä»¥æ˜¯è´Ÿå€¼ã€‚</p></blockquote><p style="font-size:25px;color:#26F0E6;font-family:åæ–‡æ¥·ä½“">marginå¡Œé™·é—®é¢˜</p><p>ä»€ä¹ˆæ˜¯<code>margin</code>å¡Œé™·ï¼Ÿ</p><p>&nbsp;&nbsp;ç¬¬ä¸€ä¸ªå…ƒç´ çš„<b>ä¸Š</b><code>margin</code>ä¼šä½œç”¨åœ¨çˆ¶å…ƒç´ ä¸Šï¼Œæœ€åä¸€ä¸ªå­å…ƒç´ çš„<b>ä¸‹</b><code>margin</code>ä¼šä½œç”¨åœ¨çˆ¶å…ƒç´ ä¸Šã€‚<br><br><br>å¦‚ä½•è§£å†³<code>margin</code>å¡Œé™·ï¼Ÿ</p><ul>    <li>æ–¹æ¡ˆä¸€ï¼šç»™çˆ¶å…ƒç´ è®¾ç½®ä¸ä¸º0çš„<code>padding</code>ã€‚</li>    <li>æ–¹æ¡ˆäºŒï¼šç»™çˆ¶å…ƒç´ è®¾ç½®å®½åº¦ä¸ä¸º0çš„<code>border</code>ã€‚</li>    <li>æ–¹æ¡ˆä¸‰ï¼šç»™çˆ¶å…ƒç´ è®¾ç½®cssæ ·å¼<code>overflow:hidden</code></li>    </ul>    <blockquote><p>å¤„ç†å†…å®¹æº¢å‡ºï¼šä¹Ÿæ˜¯åŠ ä¸Švoerflow:hidden.</p></blockquote><blockquote><p>éšè—å…ƒç´ çš„æ–¹å¼<br>vidibility:hidden<br>display:none</p></blockquote><p style="font-size:30px;color:#26F0E6;font-family:åæ–‡æ¥·ä½“">å¸ƒå±€å°æŠ€å·§</p><p>1.è¡Œå†…å…ƒç´ ã€è¡Œå†…å—å…ƒç´ ï¼Œå¯ä»¥è¢«çˆ¶å…ƒç´ å½“åšæ–‡æœ¬å¤„ç†ã€‚</p><blockquote><p>å³ï¼šå¯ä»¥åƒå¤„ç†æ–‡æœ¬å¯¹é½ä¸€æ ·ï¼Œå»å¤„ç†ï¼šè¡Œå†…ã€è¡Œå†…å—åœ¨çˆ¶å…ƒç´ ä¸­çš„å¯¹é½ã€‚<br>ä¾‹å¦‚ï¼štext-alignã€line-heightã€text-indentç­‰ã€‚</p></blockquote><p>2.å¦‚ä½•è®©å­å…ƒç´ ï¼Œåœ¨çˆ¶äº²ä¸­<b>æ°´å¹³å±…ä¸­ï¼š</p><ul>    <li>è‹¥å­å…ƒç´ ä¸ºå—å…ƒç´ ï¼Œç»™çˆ¶å…ƒç´ åŠ ä¸Šï¼š<code>margin:0 auto;</code>ã€‚</li>    <li>è‹¥å­å…ƒç´ ä¸ºè¡Œå†…å…ƒç´ ã€è¡Œå†…å—å…ƒç´ ï¼Œç»™çˆ¶å…ƒç´ åŠ ä¸Šï¼š<code>text-align:center</code></li>    </ul><p> 3.å¦‚ä½•è®©å­å…ƒç´ ï¼Œåœ¨çˆ¶äº²ä¸­<b>å‚ç›´å±…ä¸­</b>:<br>    <ul><br>        <li>è‹¥å­å…ƒç´ ä¸ºå—å…ƒç´ ï¼Œç»™å­å…ƒç´ åŠ ä¸Šï¼š<code>margin-top</code>ï¼Œå€¼ä¸ºï¼šï¼ˆçˆ¶å…ƒç´ <code>content</code>-å­å…ƒç´ ç›’å­æ€»é«˜ï¼‰&#x2F;2ã€‚</li><br>        <li>è‹¥å­å…ƒç´ ä¸ºè¡Œå†…å…ƒç´ ã€è¡Œå†…å—å…ƒç´ ï¼š<br>            è®©çˆ¶å…ƒç´ çš„<code>height=line-height</code>ï¼Œæ¯ä¸ªå­å…ƒç´ éƒ½åŠ ä¸Šï¼š<code>vertical-align:middle;</code>ã€‚<br>            è¡¥å……ï¼šè‹¥æƒ³ç»å¯¹å‚ç›´å±…ä¸­ï¼Œçˆ¶å…ƒç´ <code>font-size</code>è®¾ç½®ä¸º<code>0</code>ã€‚</li><br>    </ul></p>]]></content>
      
      
      <categories>
          
          <category> CSSåŸºç¡€ </category>
          
          <category> Visual Studio Code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
            <tag> Visual Studio Code </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­¦ä¹ CSS.4å­¦ä¹ ç¬”è®°</title>
      <link href="/2025/01/18/css/%E5%AD%A6%E4%B9%A0css.4/"/>
      <url>/2025/01/18/css/%E5%AD%A6%E4%B9%A0css.4/</url>
      
        <content type="html"><![CDATA[<h1 style="font-size:30px;color:#7DFFB5;font-family:åæ–‡æ¥·ä½“">CSSåˆ—è¡¨å±æ€§</h1><p><b>åˆ—è¡¨ç›¸å…³çš„å±æ€§ï¼Œå¯ä»¥ä½œç”¨åœ¨<code>ul</code>ã€<code>ol</code>ã€<code>li</code>å…ƒç´ ä¸Šã€‚</b></p><table border="1">    <tr>        <th>CSSå±æ€§å</th>        <th>åŠŸèƒ½</th>        <th>å±æ€§å€¼</th>    </tr>        <tr>            <th><code>tlst-style-type</code></th>            <th>è®¾ç½®åˆ—è¡¨ç¬¦å·</th>            <th>å¸¸ç”¨å±æ€§å¦‚ä¸‹ï¼š                <code>none</code>ï¼šä¸æ˜¾ç¤ºå‰é¢çš„æ ‡è¯†ï¼ˆå¾ˆå¸¸ç”¨ï¼ï¼‰                <code>square</code>:å®å¿ƒæ–¹å—                <code>disc</code>ï¼šåœ†å½¢                <code>decimal</code>:æ•°å­—                <code>lower-roman</code>:å°å†™ç½—é©¬å­—                <code>upper-roman</code>:å¤§å†™ç½—é©¬å­—                <code>lower-alpha</code>:å°å†™å­—æ¯                <code>upper-alpha</code>:å¤§å†™å­—æ¯</th>     </tr>         <tr>        <th><code>list-style-position</code></th>        <th>è®¾ç½®åˆ—è¡¨ç¬¦å·çš„ä½ç½®</th>        <th><code>inside</code>:åœ¨<code>li</code>çš„é‡Œé¢            <code>outside</code>:åœ¨<code>li</code>çš„å¤–è¾¹</th>    </tr>    <tr>        <th><code>list-style-image</code></th>        <th>è‡ªå®šä¹‰åˆ—è¡¨ç¬¦å·</th>        <th><code>urlï¼ˆå›¾ç‰‡åœ°å€ï¼‰</code></th>    </tr>    <tr>        <th><code>list-style</code></th>        <th>ç¬¦åˆå±æ€§</th>        <th>æ²¡æœ‰æ•°é‡ã€é¡ºåºçš„è¦æ±‚</th>    </tr>        </table><h1 style="font-size:30px;color:#7DFFB5;font-family:åæ–‡æ¥·ä½“">CSSè¡¨æ ¼å±æ€§</h1><p><b>1.è¾¹æ¡†ç›¸å…³å±æ€§ï¼ˆå…¶ä»–å…ƒç´ ä¹Ÿèƒ½ç”¨ï¼‰ï¼š</b></p><table>    <tr>        <th>CSSå±æ€§å</th>        <th>åŠŸèƒ½</th>        <th>å±æ€§å€¼</th>    </tr>    <tr>        <td><code>border-width</code></td>        <td>è¾¹æ¡†å®½åº¦</td>        <td><code>CSS</code>ä¸­å¯ç”¨çš„é•¿åº¦å€¼</td>    </tr>    <tr>        <td><code>bordet-color</code></td>        <td>è¾¹æ¡†é¢œè‰²</td>        <td><code>CSS</code>ä¸­å¯ç”¨çš„é¢œè‰²å€¼</td>    </tr>    <tr>        <td><code>border-style</code></td>        <td>è¾¹æ¡†é£æ ¼</td>        <td><code>none</code>é»˜è®¤å€¼            <code>solid</code>å®çº¿            <code>dashed</code>è™šçº¿            <code>dotted</code>ç‚¹çº¿            <code>double</code>åŒå®çº¿        </td>    </tr>    <tr>        <td><code>border</code></td>        <td>è¾¹æ¡†å¤åˆå±æ€§</td>        <td>æ²¡æœ‰ä¹¦é‡ã€é¡ºåºçš„è¦æ±‚</td>    </tr>    </table><h1 style="font-size:30px;color:#7DFFB5;font-family:åæ–‡æ¥·ä½“">è¡¨æ ¼ç‹¬æœ‰å±æ€§ï¼ˆåªæœ‰<code>table</code>è¡¨æƒ…æ‰èƒ½ä½¿ç”¨ï¼‰ï¼š</h1><table>    <tr>        <th>CSSå±æ€§å</th>        <th>åŠŸèƒ½</th>        <th>å±æ€§å€¼</th>    </tr>    <tr>        <td><code>table-layout</code></td>        <td>è®¾ç½®äº†åˆ—å®½åº¦</td>        <td><code>auto</code>:è‡ªåŠ¨ï¼Œç±»æ¬¾æ ¹æ®å†…å®¹è®¡ç®—ï¼ˆé»˜è®¤å€¼ï¼‰            <code>fixed</code>:å›ºå®šåˆ—å®½ï¼Œå¹³å‡åˆ†ã€‚</td>    </tr>    <tr>        <td><code>borber-spacing</code></td>        <td>å•å…ƒæ ¼é—´è·</td>        <td><code>CSS</code>ä¸­å¯ç”¨çš„é•¿åº¦å€¼ã€‚        ç”Ÿæ•ˆçš„å‰æï¼šå•å…ƒæ ¼è¾¹æ¡†ä¸èƒ½åˆå¹¶</td>    </tr>    <tr>        <td><code>borer-collapse</code></td>        <td>åˆå¹¶å•å…ƒæ ¼è¾¹æ¡†</td>        <td><code>collapse</code>:åˆå¹¶            <code>separate</code>:ä¸åˆå¹¶</td>    </tr>    <tr>        <td><code>empty-cells</code></td>        <td>éšè—æ²¡æœ‰å†…å®¹çš„å•å…ƒæ ¼</td>        <td><code>show</code>:æ˜¾ç¤ºï¼Œé»˜è®¤            <code>hide</code>:éšè—</td>    </tr>    <tr>        <td><code>caption-side</code></td>        <td>è®¾ç½®è¡¨æ ¼æ ‡é¢˜ä½ç½®</td>        <td><code>top</code>:ä¸Šé¢ï¼ˆé»˜è®¤å€¼ï¼‰            <code>bottom</code>åœ¨è¡¨æ ¼ä¸‹é¢</td></table>    <h1 style="font-size:30px;color:#7DFFB5;font-family:åæ–‡æ¥·ä½“">CSSèƒŒæ™¯å±æ€§</h1><table>    <tr>        <th>CSSå±æ€§å</th>        <th>åŠŸèƒ½</th>        <th>å±æ€§å€¼</th>    </tr>    <tr>        <td><code>background-color</code></td>        <td>è®¾ç½®èƒŒæ™¯é¢œè‰²</td>        <td>ç¬¦åˆ<code>CSS</code>ä¸­çš„é¢œè‰²è§„èŒƒçš„å€¼ã€‚é»˜è®¤èƒŒæ™¯é¢œè‰²æ˜¯<code>transparent</code>ã€‚</td>    </tr>    <tr>        <td><code>background-image</code></td>        <td>è®¾ç½®èƒŒæ™¯å›¾ç‰‡</td>        <td><code>urlï¼ˆå›¾ç‰‡åœ°å€ï¼‰</code></td>    </tr>    <tr>        <td><code>background-repeat</code></td>        <td>è®¾ç½®èƒŒæ™¯é‡å¤æ–¹å¼</td>        <td><code>repeat</code>:é‡å¤ï¼Œé“ºæ»¡æ•´ä¸ªå…ƒç´ ï¼Œé»˜è®¤å€¼<code>repeat-x</code>åªåœ¨æ°´å¹³æ–¹å‘é‡å¤ã€‚<code>repeat-y</code>åªåœ¨å‚ç›´æ–¹å‘é‡å¤<code>no-repeat</code>:ä¸é‡å¤ã€‚</td>    </tr>    <tr>        <td><code>background-position</code></td>        <td>è®¾ç½®èƒŒæ™¯å›¾ä½ç½®</td>        <td><b>é€šè¿‡å…³é”®å­—è®¾ç½®ä½ç½®</b>ï¼šå†™ä¸¤ä¸ªå€¼ï¼Œç”¨ç©ºæ ¼éš”å¼€ã€‚ æ°´å¹³ï¼š<code>leftã€centerã€rightã€</code>å‚ç›´ï¼š<code>topã€centerã€bottom</code>å¦‚æœåªå–ä¸€ä¸ªå€¼ï¼Œå¦ä¸€ä¸ªæ–¹å‘çš„å€¼å–center            <b>é€šè¿‡é•¿åº¦æŒ‡å®šåæ ‡ä½ç½®</b>:ä»¥å…ƒç´ å·¦ä¸Šè§’ï¼Œä¸ºåæ ‡åŸç‚¹ï¼Œè®¾ç½®å›¾æ ‡å·¦ä¸Šè§’ä½ç½®ã€‚ä¿©ä¸ªå€¼ï¼Œåˆ†åˆ«æ˜¯<code>x,yåæ ‡ã€‚</code>åªå†™ä¸€ä¸ªå€¼ï¼Œä¼šè¢«å½“åšxåæ ‡ï¼Œyåæ ‡å–center</td>    </tr>    <tr>        <td><code>background</code></td>        <td>ç¬¦åˆå±æ€§</td>        <td>æ²¡æœ‰æ•°é‡å’Œé¡ºåºè¦æ±‚</td>    </tr>    </table> <h1 style="font-size:30px;color:#7DFFB5;font-family:åæ–‡æ¥·ä½“">CSSé¼ æ ‡å±æ€§</h1><table>    <tr>        <th>CSSå±æ€§å</th>        <th>åŠŸèƒ½</th>        <th>å±æ€§å€¼</th>    </tr>    <tr>        <td><code>cursor</code></td>        <td>è®¾ç½®é¼ æ ‡å…‰æ ‡çš„æ ·å¼</td>        <td><code>pointer</code>:å°æ‰‹        <code>move</code>:ç§»åŠ¨å›¾æ ‡        <code>text</code>:æ–‡å­—é€‰æ‹©å™¨        <code>crosshair</code>:åå­—æ¶        <code>wait</code>:ç­‰å¾…        <code>hrlp</code>:å¸®åŠ©</td>    </tr>    </table>        ]]></content>
      
      
      <categories>
          
          <category> CSSåŸºç¡€ </category>
          
          <category> Visual Studio Code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
            <tag> Visual Studio Code </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­¦ä¹ CSS.3å­¦ä¹ ç¬”è®°</title>
      <link href="/2025/01/17/css/%E5%AD%A6%E4%B9%A0css.3/"/>
      <url>/2025/01/17/css/%E5%AD%A6%E4%B9%A0css.3/</url>
      
        <content type="html"><![CDATA[<h2 style="font-size:45px;color:#5274E3;font-family:åæ–‡æ¥·ä½“">CSS å¸¸ç”¨æ–‡æœ¬æ ·å¼</h2><p style="font-size:20px;font-family:åæ–‡æ¥·ä½“"><b>ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„ CSS æ–‡æœ¬æ ·å¼ï¼š</b></p>   <ul>        <li style="font-size:25px"><b>å­—ä½“æ ·å¼</b></li><br>    <li><b>å­—ä½“ç±»å‹ï¼š</b></li>    <li><b><code>font-family: 'Arial', sans-serif;</code></b>ï¼šè®¾ç½®å­—ä½“ä¸º Arialï¼Œå¦‚æœæ²¡æœ‰ Arial å­—ä½“ï¼Œåˆ™ä½¿ç”¨ç³»ç»Ÿé»˜è®¤çš„æ— è¡¬çº¿å­—ä½“ã€‚</li>    <li><b><code>font-family: 'Times New Roman', serif;</code></b>ï¼šè®¾ç½®å­—ä½“ä¸º Times New Romanï¼Œå¦‚æœæ²¡æœ‰è¯¥å­—ä½“ï¼Œåˆ™ä½¿ç”¨ç³»ç»Ÿé»˜è®¤çš„æœ‰è¡¬çº¿å­—ä½“ã€‚</li><br>    <li><b>å­—ä½“å¤§å°ï¼š</b></li>    <li><b><code>font-size: 16px;</code></b>ï¼šå°†å­—ä½“å¤§å°è®¾ç½®ä¸º 16 åƒç´ ã€‚</li>    <li><b><code>font-size: 1.2em;</code></b>ï¼šå­—ä½“å¤§å°ç›¸å¯¹äºå…¶çˆ¶å…ƒç´ å­—ä½“å¤§å°çš„ 1.2 å€ï¼Œè¿™æ˜¯ä¸€ç§ç›¸å¯¹å•ä½ï¼Œå¸¸ç”¨äºä¿æŒæ–‡æœ¬åœ¨ä¸åŒå±å¹•å’Œè®¾å¤‡ä¸Šçš„å¯è¯»æ€§ã€‚</li><br>    <li><b>å­—ä½“ç²—ç»†ï¼š</b></li>    <li><b><code>font-weight: normal;</code></b>ï¼šæ­£å¸¸ç²—ç»†ï¼Œç­‰åŒäº <b><code>font-weight: 400;</code></b>ã€‚</li>    <li><b><code>font-weight: bold;</code></b>ï¼šåŠ ç²—ï¼Œç­‰åŒäº <b><code>font-weight: 700;</code></b>ï¼Œå¸¸ç”¨äºçªå‡ºæ˜¾ç¤ºæ ‡é¢˜æˆ–é‡è¦ä¿¡æ¯ã€‚</li>    <li><b><code>font-weight: 100;</code></b>ï¼šæœ€ç»†çš„å­—ä½“ç²—ç»†ï¼Œæ•°å€¼è¶Šå¤§ï¼Œå­—ä½“è¶Šç²—ï¼Œä¸€èˆ¬æœ‰ 100ã€200ã€300ã€400ã€500ã€600ã€700ã€800ã€900 ç­‰ç­‰çº§åˆ«ã€‚</li><br><hr>    <li style="font-size:25px"><b>æ–‡æœ¬æ’ç‰ˆ</b></li><br>    <li><b>æ–‡æœ¬å¯¹é½ï¼š</b></li>    <li><b><code>text-align: left;</code></b>ï¼šæ–‡æœ¬å·¦å¯¹é½ï¼Œå¸¸ç”¨äºæ®µè½æ–‡æœ¬çš„é»˜è®¤å¯¹é½æ–¹å¼ã€‚</li>    <li><b><code>text-align: center;</code></b>ï¼šæ–‡æœ¬å±…ä¸­å¯¹é½ï¼Œé€‚ç”¨äºæ ‡é¢˜ã€é‡è¦æç¤ºç­‰éœ€è¦çªå‡ºæ˜¾ç¤ºçš„æ–‡æœ¬ã€‚</li>    <li><b><code>text-align: right;</code></b>ï¼šæ–‡æœ¬å³å¯¹é½ï¼Œå¯ç”¨äºä¸€äº›ç‰¹å®šçš„å¸ƒå±€éœ€æ±‚ï¼Œå¦‚è¡¨æ ¼ä¸­çš„æ•°æ®å¯¹é½ã€‚</li>    <li><b><code>text-align: justify;</code></b>ï¼šä¸¤ç«¯å¯¹é½ï¼Œå¸¸ç”¨äºæŠ¥çº¸ã€ä¹¦ç±ç­‰æ’ç‰ˆï¼Œä½¿æ–‡æœ¬çš„å·¦å³ä¸¤ç«¯éƒ½å¯¹é½ï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´å•è¯é—´è·ä¸å‡åŒ€ã€‚</li><br>    <li><b>æ–‡æœ¬ç¼©è¿›ï¼š</b></li>    <li><b><code>text-indent: 2em;</code></b>ï¼šé¦–è¡Œç¼©è¿› 2 ä¸ªå­—ç¬¦å®½åº¦ï¼Œç¬¦åˆä¸­æ–‡æ’ç‰ˆä¹ æƒ¯ï¼Œå¸¸ç”¨äºæ®µè½é¦–è¡Œç¼©è¿›ï¼Œå¢å¼ºæ–‡æœ¬çš„å±‚æ¬¡æ„Ÿã€‚</li><br>    <li><b>è¡Œé«˜ï¼š</b></li>    <li><b><code>line-height: 1.5;</code></b>ï¼šè¡Œé«˜æ˜¯å­—ä½“å¤§å°çš„ 1.5 å€ï¼Œåˆé€‚çš„è¡Œé«˜å¯ä»¥ä½¿æ–‡æœ¬æ›´æ˜“è¯»ï¼Œé¿å…è¡Œä¸è¡Œä¹‹é—´è¿‡äºæ‹¥æŒ¤æˆ–è¿‡äºç–è¿œã€‚</li>    <li><b><code>line-height: 24px;</code></b>ï¼šå°†è¡Œé«˜å›ºå®šä¸º 24 åƒç´ ï¼Œé€‚ç”¨äºéœ€è¦ç²¾ç¡®æ§åˆ¶è¡Œé—´è·çš„åœºæ™¯ã€‚</li><br><hr>    <li style="font-size:25px"><b>æ–‡æœ¬ä¿®é¥°</b></li><br>    <li><b>æ–‡æœ¬é¢œè‰²ï¼š</b></li>    <li><b><code>color: #ff0000;</code></b>ï¼šè®¾ç½®æ–‡æœ¬é¢œè‰²ä¸ºçº¢è‰²ï¼Œä½¿ç”¨åå…­è¿›åˆ¶é¢œè‰²ä»£ç ã€‚</li>    <li><b><code>color: rgb(0, 0, 255);</code></b>ï¼šè®¾ç½®æ–‡æœ¬é¢œè‰²ä¸ºè“è‰²ï¼Œä½¿ç”¨ RGB é¢œè‰²æ¨¡å¼ã€‚</li>    <li><b><code>color: rgba(0, 128, 0, 0.5);</code></b>ï¼šè®¾ç½®æ–‡æœ¬é¢œè‰²ä¸ºåŠé€æ˜çš„ç»¿è‰²ï¼Œå…¶ä¸­ 0.5 è¡¨ç¤ºé€æ˜åº¦ã€‚</li><br>    <li><b>æ–‡æœ¬è£…é¥°ï¼š</b></li>    <li><b><code>text-decoration: none;</code></b>ï¼šå»é™¤æ–‡æœ¬è£…é¥°ï¼Œå¸¸ç”¨äºé“¾æ¥ï¼Œä½¿å…¶çœ‹èµ·æ¥åƒæ™®é€šæ–‡æœ¬ã€‚</li>    <li><b><code>text-decoration: underline;</code></b>ï¼šç»™æ–‡æœ¬æ·»åŠ ä¸‹åˆ’çº¿ï¼Œå¯ç”¨äºå¼ºè°ƒæˆ–è¡¨ç¤ºé“¾æ¥ã€‚</li>    <li><b><code>text-decoration: overline;</code></b>ï¼šç»™æ–‡æœ¬æ·»åŠ ä¸Šåˆ’çº¿ï¼Œè¾ƒå°‘ä½¿ç”¨ï¼Œå¯ç”¨äºä¸€äº›ç‰¹æ®Šæ•ˆæœã€‚</li>    <li><b><code>text-decoration: line-through;</code></b>ï¼šç»™æ–‡æœ¬æ·»åŠ åˆ é™¤çº¿ï¼Œè¡¨ç¤ºæ–‡æœ¬è¢«åˆ é™¤æˆ–ä¸å†æœ‰æ•ˆã€‚</li><br><hr>    <li style="font-size:25px"><b>å…¶ä»–</b></li><br>    <li><b>å­—æ¯é—´è·ï¼š</b></li>    <li><b><code>letter-spacing: 1px;</code></b>ï¼šå­—æ¯é—´è·å¢åŠ  1 åƒç´ ï¼Œå¯ä»¥ä½¿æ–‡æœ¬çœ‹èµ·æ¥æ›´å®½æ•ï¼Œå¸¸ç”¨äºæ ‡é¢˜æˆ–éœ€è¦å¼ºè°ƒçš„æ–‡æœ¬ã€‚</li><br>    <li><b>å•è¯é—´è·ï¼š</b></li>    <li><b><code>word-spacing: 2px;</code></b>ï¼šå•è¯é—´è·å¢åŠ  2 åƒç´ ï¼Œå¯¹è‹±æ–‡ç­‰ä»¥ç©ºæ ¼åˆ†éš”å•è¯çš„è¯­è¨€æœ‰æ•ˆï¼Œå¯æ”¹å–„æ–‡æœ¬çš„è§†è§‰æ•ˆæœã€‚</li>    <li><b>æ–‡æœ¬è½¬æ¢ï¼š</b></li>    <li><b><code>text-transform: uppercase;</code></b>ï¼šå°†æ–‡æœ¬è½¬æ¢ä¸ºå¤§å†™ï¼Œå¸¸ç”¨äºæ ‡é¢˜æˆ–ç¼©å†™è¯ã€‚</li>    <li><b><code>text-transform: lowercase;</code></b>ï¼šå°†æ–‡æœ¬è½¬æ¢ä¸ºå°å†™ã€‚</li>    <li><b><code>text-transform: capitalize;</code></b>ï¼šå°†æ¯ä¸ªå•è¯çš„é¦–å­—æ¯å¤§å†™ï¼Œé€‚ç”¨äºæ ‡é¢˜æˆ–éœ€è¦çªå‡ºæ˜¾ç¤ºçš„æ–‡æœ¬ã€‚ã€‚</li>    </ul><p style="font-size:30px;font-weight: bold;font-family:åæ–‡æ¥·ä½“">vertical-align</p><ul>    <li>å±æ€§åï¼š<code>vertical-align</code>ã€‚</li>    <li>ä½œç”¨:ç”¨äºæŒ‡å®š<code>åŒä¸€è¡Œå…ƒç´ ä¹‹é—´</code>ï¼Œæˆ–<code>è¡¨æ ¼å•å…ƒæ ¼</code>å†…æ–‡å­—çš„<code>å‚ç›´å¯¹é½æ–¹å¼</code>ã€‚</li>    <li>å¸¸ç”¨å€¼ï¼š</li>    </ul>    <ol>    <li><code>baseline</code>(é»˜è®¤å€¼)ï¼šä½¿å…ƒç´ çš„åŸºçº¿ä¸çˆ¶å…ƒç´ çš„åŸºçº¿å¯¹é½ã€‚</li>    <li><code>top</code>:ä½¿å…ƒç´ çš„<code>é¡¶éƒ¨</code>ä¸å…¶<code>æ‰€åœ¨è¡Œçš„é¡¶éƒ¨</code>å¯¹é½ã€‚</li>    <li><code>middle</code>:ä½¿å…ƒç´ çš„<code>ä¸­éƒ¨</code>ä¸<code>çˆ¶å…ƒç´ çš„åŸºçº¿</code>åŠ ä¸Šçˆ¶å…ƒç´ å­—æ¯<code>x</code>çš„ä¸€åŠã€‚</li>    <li><code>bottom</code>:ä½¿å…ƒç´ çš„<code>åº•éƒ¨</code>ä¸å…¶<code>æ‰€åœ¨è¡Œçš„åº•éƒ¨</code>å¯¹é½ã€‚</li>    </ol><blockquote><p>æ³¨æ„ï¼š<code>vertical-align</code>ä¸èƒ½æ§åˆ¶å—å…ƒç´ ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CSSåŸºç¡€ </category>
          
          <category> Visual Studio Code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
            <tag> Visual Studio Code </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­¦ä¹ CSS.2å­¦ä¹ ç¬”è®°</title>
      <link href="/2025/01/17/css/%E5%AD%A6%E4%B9%A0css.2/"/>
      <url>/2025/01/17/css/%E5%AD%A6%E4%B9%A0css.2/</url>
      
        <content type="html"><![CDATA[<h1 style="font-size:45pxpx;color:#47F1EF;font-family:åæ–‡æ¥·ä½“">ä¼ªç±»é€‰æ‹©å™¨</h1><ul>    <li>æ¦‚å¿µ</li>    </ul><blockquote><p>ä½œç”¨ï¼šé€‰ä¸­ç‰¹æ®ŠçŠ¶æ€çš„å…ƒç´ ã€‚<br>å¦‚ä½•ç†è§£â€œä¼ªâ€ï¼Ÿ-è™šå‡çš„ï¼Œä¸æ˜¯çœŸçš„ã€‚<br>å¦‚ä½•ç†è§£â€œä¼ªç±»â€ï¼Ÿ-åƒç±»ï¼ˆclassï¼‰ï¼Œä½†ä¸æ˜¯ç±»ï¼Œæ˜¯å…ƒç´ çš„ç‰¹æ®ŠçŠ¶æ€ã€‚</p></blockquote><ul>    <li>å¸¸ç”¨ä¼ªç±»é€‰æ‹©å™¨</li>    </ul>    <p><b>ä¸€ã€åŠ¨æ€ä¼ªç±»ï¼š</b></p><ol>    <li><code>:link</code>è¶…é“¾æ¥<code>æœªè¢«è®¿é—®</code>çš„çŠ¶æ€ã€‚</li>    <li><code>:visted</code>è¶…é“¾æ¥<code>è®¿é—®è¿‡</code>çš„çŠ¶æ€ã€‚</li>    <li><code>:hover</code>é¼ æ ‡<code>æ‚¬åœ</code>åœ¨å…ƒç´ ä¸Šçš„çŠ¶æ€ã€‚</li>    <li><code>:active</code>å…ƒç´ æ¿€æ´»çš„çŠ¶æ€ã€‚</li>    <li><code>:focus</code>è·å–ç„¦ç‚¹çš„å…ƒç´ ã€‚</li>    </ol>    <blockquote><p>è¡¨è¾¾ç±»å…ƒç´ æ‰èƒ½ä½¿ç”¨<code>:focus</code>ä¼ªç±»ã€‚<br>å½“ç”¨æˆ·ï¼šç‚¹å‡»å…ƒç´ ã€è§¦æ‘¸å…ƒç´ ã€æˆ–é€šè¿‡é”®ç›˜çš„â€œtabâ€å»ºç­‰æ–¹å¼ï¼Œé€‰æ‹©å…ƒç´ æ—¶ï¼Œå°±æ˜¯è·å¾—ç„¦ç‚¹ã€‚</p></blockquote><p><b>äºŒã€å¸¸ç”¨ç»“æ„ä¼ªç±»ï¼š</b></p><ul type="circle">    <li>å¸¸ç”¨çš„</li>    </ul>     <ol>    <li><code>:first-child</code>æ‰€ç”¨å…„å¼Ÿå…ƒç´ ä¸­çš„<code>ç¬¬ä¸€ä¸ªã€‚</code></li>    <li><code>:last-child</code>æ‰€æœ‰å…ƒç´ ä¸­çš„<code>æœ€åä¸€ä¸ªã€‚</code></li>    <li><code>:nth-child(n)</code>æ‰€æœ‰å…„å¼Ÿå…ƒç´ ä¸­çš„<code>ç¬¬nä¸ªã€‚</code></li>    <li><code>:first-of-type</code>æ‰€æœ‰åŒç±»å‹å…„å¼Ÿå…ƒç´ çš„<code>ç¬¬ä¸€ä¸ªã€‚</code></li>    <li><code>:last-of-type</code>æ‰€æœ‰åŒç±»å‹å…„å¼Ÿä¸­çš„æœ€åä¸€ä¸ªã€‚</li>    <li><code>:nth-of-type(n)</code>æ‰€æœ‰åŒç±»å‹å…„å¼Ÿå…ƒç´ ä¸­çš„<code>ç¬¬nä¸ªã€‚</code>    </ol>  <p><b>ä¸‰ã€å¦å®šä¼ªç±»ï¼š</b></p> <blockquote><p><code>:not(é€‰æ‹©å™¨)</code>æ´¾çº¯æ»¡è¶³æ‹¬å·ä¸­æ¡ä»¶çš„å…ƒç´ ã€‚</p></blockquote><p><b>å››ã€UIä¼ªç±»</b></p><ol>    <li><code>:checked</code>è¢«é€‰ä¸­çš„å¤é€‰æ¡†æˆ–å•é€‰æ¡†æŒ‰é’®ã€‚</li>    <li><code>:enable</code>å¯ç”¨çš„è¡¨å•å…ƒç´ ï¼ˆæ²¡æœ‰<code>didabled</code>å±æ€§ï¼‰ã€‚</li>    <li><code>:disabled</code>ä¸å¯ç”¨çš„è¡¨å•å…ƒç´ ï¼ˆæœ‰<code>didabled</code>å±æ€§ï¼‰ã€‚</li>    </ol><p style="font-size:25px"><b>ä¼ªå…ƒç´ é€‰æ‹©å™¨</b></p><ul>    <li>ä½œç”¨ï¼š<code>é€‰ä¸­å…ƒç´ </code>ä¸­çš„ä¸€äº›ç‰¹æ®Šä½ç½®ã€‚</li>    <li>å¸¸ç”¨ä¼ªå…ƒç´ ï¼š<li>    <ol>        <li><code>::first-letter</code>é€‰ä¸­å…ƒç´ ä¸­çš„<code>ç¬¬ä¸€ä¸ªæ–‡å­—</code>ã€‚</li>        <li><code>::first-line</code>é€‰ä¸­å…ƒç´ ä¸­çš„<code>ç¬¬ä¸€è¡Œæ–‡å­—</code>ã€‚</li>        <li><code>::selection</code> é€‰ä¸­<code>è¢«é¼ æ ‡é€‰ä¸­çš„</code>å†…å®¹ã€‚</li>        <li><code>::placeholder</code>é€‰ä¸­è¾“å…¥æ¡†çš„<code>æç¤ºæ–‡å­—</code>ã€‚</li>        <li><code>::before</code>åœ¨å…ƒç´ <code>æœ€å¼€å§‹</code>çš„ä½ç½®ï¼Œåˆ›å»ºä¸€ä¸ªå­å…ƒç´ ï¼ˆå¿…é¡»ç”¨<code>content</code>å±æ€§æŒ‡å®šå†…å®¹ï¼‰ã€‚</li>        <li><code>::after</code>åœ¨å…ƒç´ <code>æœ€å</code>çš„ä½ç½®ï¼Œåˆ›å»ºä¸€ä¸ªå­å…ƒç´ ï¼ˆå¿…é¡»ç”¨<code>content</code>å±æ€§æŒ‡å®šå†…å®¹ï¼‰ã€‚</li>              </ol></ul><p><b>é€‰æ‹©å™¨ä¼˜å…ˆçº§</b></p><p><b>CSSé€‰æ‹©å™¨ä¼˜å…ˆçº§æ˜¯æŒ‡å½“å¤šä¸ªCSSè§„åˆ™åº”ç”¨äºåŒä¸€ä¸ªå…ƒç´ æ—¶ï¼Œç”¨æ¥å†³å®šå“ªä¸ªè§„åˆ™ç”Ÿæ•ˆçš„é¡ºåºã€‚ä¼˜å…ˆçº§ä»é«˜åˆ°ä½ä¾æ¬¡ä¸ºï¼š</b></p><p><b>ä¸€ã€å†…è”æ ·å¼ï¼ˆInline stylesï¼‰</b></p><li>å†…è”æ ·å¼æ˜¯ç›´æ¥åœ¨HTMLå…ƒç´ çš„<code>style</code>å±æ€§ä¸­å®šä¹‰çš„æ ·å¼ã€‚ä¾‹å¦‚<code>&lt;div  style="color: red;"&gt;å†…å®¹&lt;/div"&gt;</code>ï¼Œè¿™ç§æ ·å¼å…·æœ‰æœ€é«˜çš„ä¼˜å…ˆçº§ï¼Œå› ä¸ºå®ƒç›´æ¥ä½œç”¨äºå…ƒç´ æœ¬èº«ï¼Œèƒ½å¤Ÿè¦†ç›–å¤–éƒ¨æ ·å¼è¡¨å’Œå†…éƒ¨æ ·å¼è¡¨ä¸­çš„å…¶ä»–é€‰æ‹©å™¨å®šä¹‰çš„æ ·å¼ã€‚</li><p><b>äºŒã€IDé€‰æ‹©å™¨ï¼ˆID selectorsï¼‰</b></p><li>IDé€‰æ‹©å™¨ä½¿ç”¨<code>#</code>åŠ å…ƒç´ çš„IDå€¼æ¥é€‰æ‹©å…ƒç´ ï¼Œå¦‚<code>#header&#123;background-color: blue;&#125;</code>ã€‚åœ¨é¡µé¢ä¸­ï¼ŒIDåº”è¯¥æ˜¯å”¯ä¸€çš„ï¼Œæ‰€ä»¥IDé€‰æ‹©å™¨çš„ä¼˜å…ˆçº§å¾ˆé«˜ã€‚å®ƒä»…æ¬¡äºå†…è”æ ·å¼ï¼Œèƒ½å¤Ÿè¦†ç›–ç±»é€‰æ‹©å™¨ã€å±æ€§é€‰æ‹©å™¨ç­‰å®šä¹‰çš„æ ·å¼ã€‚</li><p><b>ä¸‰ã€ç±»é€‰æ‹©å™¨ã€å±æ€§é€‰æ‹©å™¨å’Œä¼ªç±»é€‰æ‹©å™¨ï¼ˆClass selectors, Attribute selectors, and Pseudo-classesï¼‰</b></p><ol>       <li><b>ç±»é€‰æ‹©å™¨</b>ï¼šä½¿ç”¨<code>.</code>åŠ ç±»åæ¥é€‰æ‹©å…ƒç´ ï¼Œå¦‚<code>.container&#123;width: 100px;&#125;</code>ã€‚å®ƒå¯ä»¥ä¸ºå…·æœ‰ç›¸åŒç±»åçš„å¤šä¸ªå…ƒç´ è®¾ç½®ç»Ÿä¸€çš„æ ·å¼ã€‚</li>    <li><b>å±æ€§é€‰æ‹©å™¨</b>ï¼šé€šè¿‡å…ƒç´ çš„å±æ€§æ¥é€‰æ‹©å…ƒç´ ï¼Œä¾‹å¦‚<code>input[type="text"]&#123;border: 1px solid black;&#125;</code>ï¼Œå®ƒé€‰æ‹©æ‰€æœ‰<code>type</code>å±æ€§ä¸º<code>text</code>çš„<code>input</code>å…ƒç´ ã€‚</li><li><b>ä¼ªç±»é€‰æ‹©å™¨</b>ï¼šç”¨äºå®šä¹‰å…ƒç´ çš„ç‰¹æ®ŠçŠ¶æ€ï¼Œå¦‚<code>:hover</code>ï¼ˆé¼ æ ‡æ‚¬åœæ—¶ï¼‰ã€<code>:active</code>ï¼ˆå…ƒç´ è¢«æ¿€æ´»æ—¶ï¼‰ç­‰ï¼Œä¾‹å¦‚<code>a:hover&#123;color: green;&#125;</code>ã€‚è¿™ä¸‰è€…ä¼˜å…ˆçº§ç›¸åŒï¼Œéƒ½é«˜äºæ ‡ç­¾é€‰æ‹©å™¨å’Œé€šé…ç¬¦é€‰æ‹©å™¨ã€‚</li>    <p><b>å››ã€æ ‡ç­¾é€‰æ‹©å™¨å’Œä¼ªå…ƒç´ é€‰æ‹©å™¨ï¼ˆType selectors and Pseudo-elementsï¼‰</b></p><ol>    <li><b>æ ‡ç­¾é€‰æ‹©å™¨</b>ï¼šç›´æ¥ä½¿ç”¨å…ƒç´ çš„æ ‡ç­¾åæ¥é€‰æ‹©å…ƒç´ ï¼Œå¦‚<code>div&#123;margin: 10px;&#125;</code>ï¼Œå®ƒä¼šé€‰æ‹©é¡µé¢ä¸Šæ‰€æœ‰çš„<code>div</code>å…ƒç´ ã€‚</li><li><b>ä¼ªå…ƒç´ é€‰æ‹©å™¨</b>ï¼šç”¨äºé€‰æ‹©å…ƒç´ çš„ç‰¹å®šéƒ¨åˆ†ï¼Œå¦‚<code>::before</code>å’Œ<code>::after</code>ã€‚ä¾‹å¦‚<code>div::before&#123;content: "å‰ç¼€";&#125;</code>ï¼Œä¼šåœ¨<code>div</code>å…ƒç´ å†…å®¹å‰æ’å…¥â€œå‰ç¼€â€æ–‡æœ¬ã€‚å®ƒä»¬çš„ä¼˜å…ˆçº§ç›¸åŒï¼Œä½äºç±»é€‰æ‹©å™¨ç­‰ã€‚</li>    <p><b>äº”ã€é€šé…ç¬¦é€‰æ‹©å™¨ã€ç»§æ‰¿æ ·å¼å’Œæµè§ˆå™¨é»˜è®¤æ ·å¼<code>ï¼ˆUniversal selectors, Inherited styles, and Default browser styles</code>ï¼‰</b></p><ol>        <li><b>é€šé…ç¬¦é€‰æ‹©å™¨</b>ï¼šä½¿ç”¨<code>*</code>æ¥é€‰æ‹©é¡µé¢ä¸Šæ‰€æœ‰çš„å…ƒç´ ï¼Œå¦‚<code>*&#123;box-sizing: border-box;&#125;</code>ï¼Œå®ƒçš„ä¼˜å…ˆçº§å¾ˆä½ã€‚</li>    <li><b>ç»§æ‰¿æ ·å¼</b>ï¼šæŸäº›CSSå±æ€§ï¼ˆå¦‚<code>colorã€font-size</code>ç­‰ï¼‰ä¼šä»çˆ¶å…ƒç´ ç»§æ‰¿åˆ°å­å…ƒç´ ï¼Œè¿™ç§ç»§æ‰¿è€Œæ¥çš„æ ·å¼ä¼˜å…ˆçº§ä¹Ÿå¾ˆä½ã€‚</li>    <li><b>æµè§ˆå™¨é»˜è®¤æ ·å¼</b>ï¼šæµè§ˆå™¨è‡ªèº«ä¸ºå…ƒç´ å®šä¹‰çš„ä¸€äº›åˆå§‹æ ·å¼ï¼Œå¦‚æœæ²¡æœ‰å…¶ä»–æ ·å¼è¦†ç›–ï¼Œè¿™äº›é»˜è®¤æ ·å¼ä¼šç”Ÿæ•ˆï¼Œå®ƒçš„ä¼˜å…ˆçº§æ˜¯æœ€ä½çš„ã€‚</li>    <blockquote><p>å½“ä¼˜å…ˆçº§ç›¸åŒæ—¶ï¼ŒCSSè§„åˆ™çš„å®šä¹‰é¡ºåºä¹Ÿä¼šå½±å“æœ€ç»ˆç”Ÿæ•ˆçš„æ ·å¼ã€‚åœ¨åŒä¸€ä¸ªCSSæ–‡ä»¶ä¸­ï¼Œåå®šä¹‰çš„è§„åˆ™ä¼šè¦†ç›–å…ˆå®šä¹‰çš„è§„åˆ™ï¼›å¦‚æœå¤šä¸ªCSSæ–‡ä»¶åŒæ—¶ä½œç”¨äºé¡µé¢ï¼ŒååŠ è½½çš„CSSæ–‡ä»¶ä¸­çš„è§„åˆ™ä¼šè¦†ç›–å…ˆåŠ è½½çš„CSSæ–‡ä»¶ä¸­çš„è§„åˆ™ï¼ˆå‰ææ˜¯é€‰æ‹©å™¨ä¼˜å…ˆçº§ç›¸åŒï¼‰ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> CSSåŸºç¡€ </category>
          
          <category> Visual Studio Code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
            <tag> Visual Studio Code </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­¦ä¹ CSS.1å­¦ä¹ ç¬”è®°</title>
      <link href="/2025/01/16/css/%E5%AD%A6%E4%B9%A0css.1/"/>
      <url>/2025/01/16/css/%E5%AD%A6%E4%B9%A0css.1/</url>
      
        <content type="html"><![CDATA[<p style="text-align:center;color:#DB7A0B;font-family:åæ–‡æ¥·ä½“;font-size:60px">å…¥é—¨CSS</p><div>S<h1 style="color:#47F1EF;font-size:39px;font-family:åæ–‡æ¥·ä½“">CSSç®€ä»‹</h1></div><p style="font-size:30px;font-family:åæ–‡æ¥·ä½“"><b>1.ä»€ä¹ˆæ˜¯ CSSï¼Ÿ</b></p><ul>    <li>CSS æŒ‡çš„æ˜¯å±‚å æ ·å¼è¡¨* (Cascading Style Sheets)</li>    <li>CSS æè¿°äº†<b>å¦‚ä½•åœ¨å±å¹•ã€çº¸å¼ æˆ–å…¶ä»–åª’ä½“ä¸Šæ˜¾ç¤º HTML å…ƒç´ </b></li>    <li>CSS <b>èŠ‚çœäº†å¤§é‡å·¥ä½œ</b>ã€‚å®ƒå¯ä»¥åŒæ—¶æ§åˆ¶å¤šå¼ ç½‘é¡µçš„å¸ƒå±€</li>    <li>å¤–éƒ¨æ ·å¼è¡¨å­˜å‚¨åœ¨<b> CSS æ–‡ä»¶ä¸­</b></li></ul><h1 style="color:#47F1EF;font-size:39px;font-family:åæ–‡æ¥·ä½“">CSS è¯­æ³•</h1><p style="font-size:19px">CSSï¼ˆå±‚å æ ·å¼è¡¨ï¼‰ç”¨äºè®¾ç½®HTMLé¡µé¢ä¸­å…ƒç´ çš„æ ·å¼ï¼Œå…¶è¯­æ³•ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š</p><p style="font-size:20px"><b>1.é€‰æ‹©å™¨</b></p><div>    <p>é€‰æ‹©å™¨ç”¨äºé€‰æ‹©é¡µé¢ä¸­çš„å…ƒç´ ï¼Œä»¥ä¾¿ä¸ºå…¶åº”ç”¨æ ·å¼ã€‚å¸¸è§çš„é€‰æ‹©å™¨ç±»å‹æœ‰ï¼š</p>    <ul>        <li><b>å…ƒç´ é€‰æ‹©å™¨</b>ï¼šç›´æ¥ä½¿ç”¨å…ƒç´ åç§°ï¼Œå¦‚pé€‰æ‹©é¡µé¢ä¸­æ‰€æœ‰çš„&lt;p&gt;å…ƒç´ ã€‚</li>        <li><b>ç±»é€‰æ‹©å™¨</b>ï¼šä»¥<code>.</code>å¼€å¤´ï¼Œå¦‚<code>.my-class</code>é€‰æ‹©é¡µé¢ä¸­æ‰€æœ‰<code>class="my-class"</code>çš„å…ƒç´ ã€‚</li>        <li><b>IDé€‰æ‹©å™¨</b>:ä»¥<code>#</code>å¼€å¤´ï¼Œå¦‚<code>#my-id</code>é€‰æ‹©é¡µé¢ä¸­<code>id="my-id"</code>çš„å…ƒç´ ã€‚</li>        <li><b>å±æ€§é€‰æ‹©å™¨</b>:ä»¥<code>[attribute]</code>å½¢å¼ï¼Œå¦‚<code>[type="text"]</code>é€‰æ‹©æ‰€æœ‰<code>type</code>å±æ€§å€¼ä¸º<code>text</code>çš„å…ƒç´ ã€‚</li>        <li><b>ä¼ªç±»é€‰æ‹©å™¨</b>:ä»¥<code>:</code>å¼€å¤´ï¼Œå¦‚<code>:hover</code>é€‰æ‹©é¼ æ ‡æ‚¬åœçš„å…ƒç´ ï¼Œ<code>:nth-child(n)</code>é€‰æ‹©å…¶çˆ¶å…ƒç´ çš„ç¬¬<code>n</code>ä¸ªå­å…ƒç´ ç­‰ã€‚</li>        <li><b>ä¼ªå…ƒç´ é€‰æ‹©å™¨</b>:ä»¥<code>:before</code>åœ¨å…ƒç´ å†…å®¹å‰æ’å…¥å†…å®¹ï¼Œ<code>::after</code>åœ¨å…ƒç´ å†…å®¹åæ’å…¥å†…å®¹ç­‰ã€‚</li>        <li><b>ç»„åˆé€‰æ‹©å™¨</b>:å¯ä»¥å°†å¤šä¸ªé€‰æ‹©å™¨ç»„åˆä½¿ç”¨ï¼Œå¦‚<code>div p</code>é€‰æ‹©<code>&lt;div&gt;</code>å…ƒç´ å†…çš„æ‰€æœ‰<code>&lt;p&gt;</code>å…ƒç´ ï¼Œ<code>.class1.class2</code>é€‰æ‹©åŒæ—¶å…·æœ‰<code>class1</code>å’Œ<code>class2</code>ç±»çš„å…ƒç´ ç­‰ã€‚</li>        </ul>        </div><p style="font-size:20px"><b>2.å£°æ˜å™¨</b></p><p>é€‰æ‹©å™¨åé¢è·Ÿç€ä¸€ä¸ªèŠ±æ‹¬å·<code>&#123;&#125;</code>ï¼Œé‡Œé¢åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå£°æ˜ï¼Œç”¨äºå®šä¹‰å…ƒç´ çš„æ ·å¼ã€‚æ¯ä¸ªå£°æ˜ç”±å±æ€§å’Œå€¼ç»„æˆï¼Œå±æ€§å’Œå€¼ä¹‹é—´ç”¨è‹±æ–‡å†’å·<code>:</code>åˆ†éš”ï¼Œæ¯ä¸ªå£°æ˜ä¹‹é—´ç”¨è‹±æ–‡åˆ†å·<code>;</code>åˆ†éš”ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: red;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p style="font-size:25px"><b>ç¤ºä¾‹:</b></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* é€‰æ‹©æ‰€æœ‰æ®µè½å…ƒç´ ï¼Œè®¾ç½®å­—ä½“é¢œè‰²ä¸ºçº¢è‰²ï¼Œå­—ä½“å¤§å°ä¸º16px */</span></span><br><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: red;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* é€‰æ‹©idä¸º&quot;header&quot;çš„å…ƒç´ ï¼Œè®¾ç½®èƒŒæ™¯é¢œè‰²ä¸ºè“è‰²ï¼Œæ–‡å­—é¢œè‰²ä¸ºç™½è‰² */</span></span><br><span class="line"><span class="selector-id">#header</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: blue;</span><br><span class="line">    <span class="attribute">color</span>: white;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* é€‰æ‹©ç±»åä¸º&quot;highlight&quot;çš„å…ƒç´ ï¼Œé¼ æ ‡æ‚¬åœæ—¶è®¾ç½®èƒŒæ™¯é¢œè‰²ä¸ºé»„è‰² */</span></span><br><span class="line"><span class="selector-class">.highlight</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: yellow;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* é€‰æ‹©æ‰€æœ‰inputå…ƒç´ ï¼Œä¸”typeå±æ€§å€¼ä¸º&quot;text&quot;ï¼Œè®¾ç½®è¾¹æ¡†ä¸º1pxå®çº¿é»‘è‰² */</span></span><br><span class="line"><span class="selector-tag">input</span><span class="selector-attr">[type=<span class="string">&quot;text&quot;</span>]</span> &#123;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid black;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>CSSçš„è¯­æ³•ç®€æ´è€Œå¼ºå¤§ï¼Œé€šè¿‡åˆç†ä½¿ç”¨é€‰æ‹©å™¨å’Œå£°æ˜å—ï¼Œå¯ä»¥çµæ´»åœ°ä¸ºHTMLé¡µé¢ä¸­çš„å…ƒç´ è®¾ç½®å„ç§æ ·å¼ã€‚</p></blockquote><h1 style="color:#47F1EF;font-size:39px;font-family:åæ–‡æ¥·ä½“">CSS æ ·å¼</h1><p>æœ‰ä¸‰ç§ä¸»è¦çš„æ’å…¥CSSæ ·å¼è¡¨çš„æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯å†…è”æ ·å¼ã€å†…éƒ¨æ ·å¼è¡¨å’Œå¤–éƒ¨æ ·å¼è¡¨ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†ä»‹ç»ï¼š</p><p style="font-size:20px"><b>1. å†…è”æ ·å¼ï¼ˆInline CSSï¼‰</b></p><ul>    <li><b>å®šä¹‰</b>:ç›´æ¥åœ¨HTMLå…ƒç´ çš„æ ‡ç­¾ä¸­ä½¿ç”¨<code>style</code>å±æ€§æ¥æ·»åŠ CSSæ ·å¼ã€‚</li>    <li><b>ä½¿ç”¨æ–¹æ³•</b>:åœ¨å…ƒç´ æ ‡ç­¾ä¸­æ·»åŠ <code>style="æ ·å¼è§„åˆ™"</code>ï¼Œæ ·å¼è§„åˆ™ä¸­åŒ…å«å±æ€§å’Œå€¼ï¼Œå±æ€§å’Œå€¼ä¹‹é—´ç”¨è‹±æ–‡å†’å·åˆ†éš”ï¼Œå¤šä¸ªæ ·å¼è§„åˆ™ä¹‹é—´ç”¨è‹±æ–‡åˆ†å·åˆ†éš”ã€‚ä¾‹å¦‚ï¼š</li>    </ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&quot;color: red; font-size: 16px;&quot;</span>&gt;</span>è¿™æ˜¯ä¸€æ®µçº¢è‰²çš„æ–‡æœ¬ï¼Œå­—ä½“å¤§å°ä¸º16pxã€‚<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><ul>    <li><b>ç‰¹ç‚¹</b>:</li>   <ul type="circle">    </ul>        <li>ä¼˜ç‚¹ï¼šå¯ä»¥ç›´æ¥åœ¨å…ƒç´ ä¸Šåº”ç”¨æ ·å¼ï¼Œå¯¹äºå•ä¸ªå…ƒç´ çš„æ ·å¼ä¿®æ”¹éå¸¸æ–¹ä¾¿ï¼Œå¯ä»¥å¿«é€Ÿçœ‹åˆ°æ•ˆæœã€‚</li>        <li>ç¼ºç‚¹ï¼šæ ·å¼ä¸ç»“æ„æ··åˆï¼Œè¿åäº†CSSä¸HTMLåˆ†ç¦»çš„åŸåˆ™ï¼Œä¸åˆ©äºç»´æŠ¤å’Œé‡ç”¨ã€‚å½“éœ€è¦å¯¹å¤šä¸ªå…ƒç´ åº”ç”¨ç›¸åŒçš„æ ·å¼æ—¶ï¼Œä»£ç ä¼šå˜å¾—å†—ä½™ã€‚</li></ul>        <p style="font-size:20px"><b>2. å†…éƒ¨æ ·å¼è¡¨ï¼ˆInternal CSSï¼‰</b></p><ul>    <li><b>å®šä¹‰</b>:åœ¨HTMLæ–‡æ¡£çš„<code>&lt;head&gt;</code>éƒ¨åˆ†ä½¿ç”¨<code>&lt;style&gt;</code>æ ‡ç­¾æ¥å®šä¹‰CSSæ ·å¼ã€‚</li>    <li><b>ä½¿ç”¨æ–¹æ³•</b>:åœ¨<code>&lt;head&gt;</code>æ ‡ç­¾å†…æ·»åŠ <code>&lt;style&gt;</code>æ ‡ç­¾ï¼Œåœ¨<code>&lt;style&gt;</code>æ ‡ç­¾å†…ç¼–å†™CSSé€‰æ‹©å™¨å’Œå¯¹åº”çš„æ ·å¼è§„åˆ™ã€‚ä¾‹å¦‚ï¼š</li>    </ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">p</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">color</span>: blue;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">font-size</span>: <span class="number">14px</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.highlight</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background-color</span>: yellow;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>è¿™æ˜¯ä¸€æ®µè“è‰²çš„æ–‡æœ¬ï¼Œå­—ä½“å¤§å°ä¸º14pxã€‚<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;highlight&quot;</span>&gt;</span>è¿™æ˜¯ä¸€ä¸ªé»„è‰²èƒŒæ™¯çš„divã€‚<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><ul>    <li><b>ç‰¹ç‚¹</b>:</li>       </ul><ul type="circle">        <li>ä¼˜ç‚¹ï¼šæ ·å¼ä¸HTMLç»“æ„åœ¨åŒä¸€æ–‡ä»¶ä¸­ï¼Œæ–¹ä¾¿æŸ¥çœ‹å’Œä¿®æ”¹ï¼Œé€‚ç”¨äºå•ä¸ªé¡µé¢çš„æ ·å¼å®šä¹‰ã€‚å¯ä»¥é¿å…å†…è”æ ·å¼å¸¦æ¥çš„ä»£ç å†—ä½™é—®é¢˜ã€‚</li>        <li>ç¼ºç‚¹ï¼šæ ·å¼ä»ç„¶å±€é™äºå•ä¸ªHTMLæ–‡ä»¶ï¼Œä¸åˆ©äºå¤šä¸ªé¡µé¢ä¹‹é—´çš„æ ·å¼å…±äº«å’Œç»´æŠ¤ã€‚å½“ç½‘ç«™åŒ…å«å¤šä¸ªé¡µé¢æ—¶ï¼Œæ¯ä¸ªé¡µé¢éƒ½éœ€è¦é‡å¤ç¼–å†™ç›¸åŒçš„æ ·å¼ä»£ç ã€‚</li></ul><p style="font-size:20px"><b>3. å¤–éƒ¨æ ·å¼è¡¨ï¼ˆExternal CSSï¼‰</b></p><ul>    <li><b>å®šä¹‰</b>:å°†CSSæ ·å¼å†™åœ¨ä¸€ä¸ªå•ç‹¬çš„<code>.css</code>æ–‡ä»¶ä¸­ï¼Œç„¶ååœ¨HTMLæ–‡æ¡£ä¸­é€šè¿‡<code>&lt;link&gt;</code>æ ‡ç­¾å¼•å…¥è¯¥æ ·å¼è¡¨ã€‚</li>    <li><b>ä½¿ç”¨æ–¹æ³•</b>:é¦–å…ˆåˆ›å»ºä¸€ä¸ªCSSæ–‡ä»¶ï¼ˆå¦‚<code>styles.css</code>ï¼‰ï¼Œåœ¨å…¶ä¸­ç¼–å†™CSSæ ·å¼è§„åˆ™ã€‚ç„¶ååœ¨HTMLæ–‡æ¡£çš„<code>&lt;head&gt;</code>éƒ¨åˆ†ä½¿ç”¨<code>&lt;link&gt;</code>æ ‡ç­¾å¼•å…¥è¯¥CSSæ–‡ä»¶ã€‚ä¾‹å¦‚ï¼š</li>    </ul><ul type="circle">    <li><code>styles.css</code>æ–‡ä»¶å†…å®¹ï¼š</li>    </ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">    <span class="attribute">font-family</span>: Arial, sans-serif;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: green;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">18px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#header</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#333</span>;</span><br><span class="line">    <span class="attribute">color</span>: white;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul type="circle">    <li>HTMLæ–‡ä»¶å†…å®¹ï¼š</li>    </ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;styles.css&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;header&quot;</span>&gt;</span>è¿™æ˜¯é¡µé¢å¤´éƒ¨ã€‚<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>è¿™æ˜¯ä¸€æ®µç»¿è‰²çš„æ–‡æœ¬ï¼Œå­—ä½“å¤§å°ä¸º18pxã€‚<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><ul>    <li><b>ç‰¹ç‚¹</b>:</li>       </ul><ul type="circle">        <li>ä¼˜ç‚¹ï¼šå®ç°äº†CSSä¸HTMLçš„å®Œå…¨åˆ†ç¦»ï¼Œç¬¦åˆWebå¼€å‘çš„æœ€ä½³å®è·µã€‚æ ·å¼æ–‡ä»¶å¯ä»¥è¢«å¤šä¸ªHTMLé¡µé¢å…±äº«ï¼Œä¾¿äºç»´æŠ¤å’Œæ›´æ–°ã€‚å½“éœ€è¦ä¿®æ”¹æ ·å¼æ—¶ï¼Œåªéœ€ä¿®æ”¹ä¸€ä¸ªCSSæ–‡ä»¶ï¼Œæ‰€æœ‰å¼•ç”¨è¯¥æ–‡ä»¶çš„é¡µé¢éƒ½ä¼šè‡ªåŠ¨æ›´æ–°æ ·å¼ã€‚</li>        <li>ç¼ºç‚¹ï¼šéœ€è¦é¢å¤–çš„æ–‡ä»¶ç®¡ç†ï¼Œå¯¹äºéå¸¸ç®€å•çš„é¡µé¢æˆ–ä¸´æ—¶çš„æ ·å¼ä¿®æ”¹ï¼Œå¯èƒ½ä¼šæ˜¾å¾—æœ‰äº›ç¹çã€‚</li></ul><p style="font-size:20px"><b>æ ·å¼ä¼˜å…ˆçº§</b></p><div>    å½“åŒæ—¶ä½¿ç”¨ä»¥ä¸Šä¸‰ç§æ–¹æ³•æ—¶ï¼Œæ ·å¼çš„ä¼˜å…ˆçº§ä»é«˜åˆ°ä½ä¾æ¬¡ä¸ºï¼šå†…è”æ ·å¼ > å†…éƒ¨æ ·å¼è¡¨ > å¤–éƒ¨æ ·å¼è¡¨ã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡ä½¿ç”¨<code>!important</code>è§„åˆ™æ¥æé«˜æŸä¸ªæ ·å¼è§„åˆ™çš„ä¼˜å…ˆçº§ï¼Œä½†åº”è°¨æ…ä½¿ç”¨ï¼Œå› ä¸ºå®ƒå¯èƒ½ä¼šå¯¼è‡´æ ·å¼éš¾ä»¥ç»´æŠ¤ã€‚ä¾‹å¦‚ï¼š</div><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*è¿™ä¼šä½¿&lt;p&gt;å…ƒç´ çš„æ–‡æœ¬é¢œè‰²æ— è®ºå¦‚ä½•éƒ½æ˜¾ç¤ºä¸ºçº¢è‰²ï¼Œå³ä½¿æœ‰å…¶ä»–æ›´é«˜ä¼˜å…ˆçº§çš„æ ·å¼è§„åˆ™å­˜åœ¨ã€‚*/</span></span><br><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: red <span class="meta">!important</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> CSSåŸºç¡€ </category>
          
          <category> Visual Studio Code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
            <tag> Visual Studio Code </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¤è¯†HTML.3å­¦ä¹ ç¬”è®°</title>
      <link href="/2025/01/15/html/%E5%AD%A6%E4%B9%A0html.3/"/>
      <url>/2025/01/15/html/%E5%AD%A6%E4%B9%A0html.3/</url>
      
        <content type="html"><![CDATA[<h1 style="text-align:center;font-size:60px;color:green;font-family:åæ–‡æ¥·ä½“">å—å…ƒç´ å’Œè¡Œå†…å…ƒç´ </h1><p><dfn>ä¸€ã€å®šä¹‰å’Œç”¨æ³•</dfn></p><blockquote><p>div æ ‡ç­¾å®šä¹‰ HTML æ–‡æ¡£ä¸­çš„åˆ†å‰²æˆ–éƒ¨åˆ†ï¼ˆåˆ†åŒºæˆ–å°èŠ‚ï¼Œdivision&#x2F;sectionï¼‰ã€‚<br>div æ ‡ç­¾å¯ä»¥æŠŠæ–‡æ¡£åˆ†å‰²ä¸ºç‹¬ç«‹çš„ã€ä¸åŒçš„éƒ¨åˆ†ã€‚å®ƒå¯ä»¥ç”¨ä½œä¸¥æ ¼çš„ç»„ç»‡å·¥å…·ï¼Œå¹¶ä¸”ä¸ä½¿ç”¨ä»»ä½•æ ¼å¼ä¸å…¶å…³è”ã€‚<br>ä»»ä½•ç±»å‹çš„å†…å®¹éƒ½å¯ä»¥æ”¾åœ¨ div æ ‡ç­¾å†…ï¼div æ ‡ç­¾å¯ç”¨ä½œ HTML å…ƒç´ çš„å®¹å™¨ï¼Œç„¶åä½¿ç”¨ CSS è®¾ç½®æ ·å¼æˆ–ä½¿ç”¨ JavaScript è¿›è¡Œæ“ä½œã€‚<br>å¦‚æœç”¨ id æˆ– class æ¥æ ‡è®° divï¼Œé‚£ä¹ˆè¯¥æ ‡ç­¾çš„ä½œç”¨ä¼šå˜å¾—æ›´åŠ æœ‰æ•ˆã€‚é€šè¿‡ä½¿ç”¨ class æˆ– id å±æ€§ï¼Œå¯ä»¥è½»æ¾åœ°å¯¹ div æ ‡ç­¾è®¾ç½®æ ·å¼ã€‚<br>æ³¨æ„ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨æ€»æ˜¯åœ¨ div å…ƒç´ å‰åæ”¾ç½®ä¸€ä¸ªæ¢è¡Œç¬¦ã€‚</p></blockquote><p>äºŒã€ç”¨æ³•</p><blockquote><p>div æ˜¯å—çº§å…ƒç´ ã€‚è¿™æ„å‘³ç€å®ƒçš„å†…å®¹è‡ªåŠ¨åœ°å¼€å§‹ä¸€ä¸ªæ–°è¡Œã€‚å®é™…ä¸Šï¼Œæ¢è¡Œæ˜¯ div å›ºæœ‰çš„å”¯ä¸€æ ¼å¼è¡¨ç°ã€‚å¯ä»¥é€šè¿‡ div çš„ class æˆ– id åº”ç”¨é¢å¤–çš„æ ·å¼ã€‚<br>ä¸å¿…ä¸ºæ¯ä¸€ä¸ª div éƒ½åŠ ä¸Šç±»æˆ– idï¼Œè™½ç„¶è¿™æ ·åšä¹Ÿæœ‰ä¸€å®šçš„å¥½å¤„ã€‚<br>å¯ä»¥å¯¹åŒä¸€ä¸ª div å…ƒç´ åº”ç”¨ class æˆ– id å±æ€§ï¼Œä½†æ˜¯æ›´å¸¸è§çš„æƒ…å†µæ˜¯åªåº”ç”¨å…¶ä¸­ä¸€ç§ã€‚è¿™ä¸¤è€…çš„ä¸»è¦å·®å¼‚æ˜¯ï¼Œclass ç”¨äºå…ƒç´ ç»„ï¼ˆç±»ä¼¼çš„å…ƒç´ ï¼Œæˆ–è€…å¯ä»¥ç†è§£ä¸ºæŸä¸€ç±»å…ƒç´ ï¼‰ï¼Œè€Œ id ç”¨äºæ ‡è¯†å•ç‹¬çš„å”¯ä¸€çš„å…ƒç´ ã€‚</p></blockquote><h1 id="å®ä¾‹ï¼š"><a href="#å®ä¾‹ï¼š" class="headerlink" title="å®ä¾‹ï¼š"></a>å®ä¾‹ï¼š</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">.cities &#123;</span><br><span class="line">    background-color:black;</span><br><span class="line">    color:white;</span><br><span class="line">    margin:20px;</span><br><span class="line">    padding:20px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;div class=&quot;cities&quot;&gt;</span><br><span class="line">&lt;h2&gt;London&lt;/h2&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;London is the capital city of England. It is the most populous city in the United Kingdom, with a metropolitan area of over 13 million inhabitants.&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;Standing on the River Thames, London has been a major settlement for two millennia, its history going back to its founding by the Romans, who named it Londinium.&lt;/p&gt;</span><br><span class="line">&lt;/div&gt; </span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h1 style="text-align:center;font-size:60px;font-family:åæ–‡æ¥·ä½“;color:green">è¡¨å•</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=&quot;text&quot;&gt;  &lt;!--è¾“å…¥æ¡†--&gt;</span><br><span class="line">&lt;button&gt;SEARCH&lt;button&gt; &lt;!--æœç´¢--&gt;</span><br></pre></td></tr></table></figure><p><b><code>è¡¨å•å¸¸ç”¨å±æ€§</code></b></p><pre>1.ä½œç”¨äºformæ ‡ç­¾ï¼ˆè¡¨å•ï¼‰action:ç”¨äºæŒ‡å®šè¡¨å•çš„æäº¤åœ°å€ï¼ˆéœ€è¦ä¸åç«¯æ²Ÿé€šåç¡®å®šï¼‰ã€‚target:ç”¨äºæ§åˆ¶è¡¨å•æäº¤åï¼Œå¦‚ä½•æ‰“å¼€é¡µé¢ï¼Œå¸¸ç”¨å€¼å¦‚ä¸‹ï¼š        _self:åœ¨æœ¬çª—å£æ‰“å¼€ã€‚        _blank:åœ¨æ–°çª—å£æ‰“å¼€ã€‚2.ä½œç”¨äºinputæ ‡ç­¾ï¼ˆè¾“å…¥æ¡†ï¼‰method:ç”¨äºæ§åˆ¶è¡¨å•çš„æäº¤æ–¹å¼ã€‚type:è®¾ç½®è¾“å…¥æ¡†çš„ç±»å‹ï¼Œç›®å‰ç”¨åˆ°çš„å€¼æ˜¯text,è¡¨ç¤ºæ™®é€šæ–‡æœ¬ã€‚name:ç”¨äºæŒ‡å®šæäº¤æ•°æ®çš„åå­—ï¼Œï¼ˆéœ€è¦ä¸åç«¯äººå‘˜æ²Ÿé€šåç¡®å®šï¼‰ã€‚</pre><p><code>ç¤ºä¾‹</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;https://search.jd.com/Search&quot;</span><span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span><span class="attr">name</span>=<span class="string">&quot;keyword&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span>&gt;</span>äº¬ä¸œæœç´¢<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p style="font-family:åæ–‡æ¥·ä½“;color:green;font-size:20px">è¡¨å•_å¸¸ç”¨æ§ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è®¤è¯†æ–°å±æ€§ï¼švalue(å€¼):å¯ä»¥æ§åˆ¶è¾“å…¥æ¡†çš„é»˜è®¤å€¼</span><br><span class="line">           maxlength(æœ€å¤§é•¿åº¦)ï¼šå¯ä»¥è¾“å…¥æœ€å¤§çš„å­—ç¬¦é•¿åº¦</span><br></pre></td></tr></table></figure><hr><p style="font-family:åæ–‡æ¥·ä½“;color:green;font-size:20px">è¡¨å•_å•é€‰æ¡†ä¸å¤šé€‰æ¡†</p><ul>    <b><li>å•é€‰æ¡†</li></b>    </ul>    <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=&quot;radio&quot; name=&quot;sex&quot; value=&quot;female&quot;&gt;å¥³</span><br><span class="line">&lt;input type=&quot;radio&quot; name=&quot;sex&quot; value=&quot;male&quot;&gt;ç”·</span><br></pre></td></tr></table></figure><blockquote><p>å¸¸ç”¨å±æ€§æ€§å¦‚ä¸‹ï¼š<br>name:æ•°æ®çš„åç§°ï¼Œæ³¨æ„ï¼šæƒ³è¦å•é€‰æ•ˆæœï¼Œå¤šä¸ªradioçš„nameå±æ€§å€¼è¦ä¿æŒä¸€è‡´ã€‚<br>valueï¼šæäº¤çš„æ•°æ®å€¼<br>checked:è®©è¯¥å•é€‰æŒ‰é’®é»˜è®¤é€‰ä¸­ã€‚</p></blockquote><ul>    <b><li>å¤é€‰æ¡†</li></b>    </ul>    <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobby&quot;</span> <span class="attr">value</span>=<span class="string">&quot;exercise&quot;</span>&gt;</span>è¿åŠ¨</span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobby&quot;</span> <span class="attr">value</span>=<span class="string">&quot;reading&quot;</span>&gt;</span>é˜…è¯»</span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobby&quot;</span> <span class="attr">value</span>=<span class="string">&quot;swimming&quot;</span>&gt;</span>æ¸¸æ³³</span><br></pre></td></tr></table></figure><blockquote><p>å¸¸ç”¨å±æ€§æ€§å¦‚ä¸‹ï¼š<br>checkedï¼šè®©è¯¥å¤é€‰æ¡†é»˜è®¤é€‰ä¸­ã€‚</p></blockquote><hr><p style="font-family:åæ–‡æ¥·ä½“;color:green;font-size:20px">è¡¨å•_éšè—åŸŸ</p><ul>    <b><li>éšè—åŸŸ</li></b>    </ul>    <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;page&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>ç”¨æˆ·ä¸å¯è§çš„ä¸€ä¸ªåŒºåŸŸï¼Œä½œç”¨æ˜¯ï¼šæäº¤è¡¨å•çš„æ—¶å€™ï¼Œæºå¸¦ä¸€äº›å›ºå®šçš„æ•°æ®ã€‚</p></blockquote><hr><ul>    <b><li>æäº¤æŒ‰é’®</li></b>    </ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æäº¤&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hatton</span>&gt;</span>æäº¤<span class="tag">&lt;/<span class="name">hatton</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼š<br>1.buttonæ ‡ç­¾typeå±æ€§çš„é»˜è®¤å€¼æ˜¯submitã€‚<br>2.buttonä¸è¦æŒ‡å®šnameå±æ€§ã€‚<br>3.inputæ ‡ç­¾ç¼–å†™çš„æŒ‰é’®ï¼Œä½¿ç”¨valueå±æ€§æŒ‡å®šæŒ‰é’®æ–‡å­—ã€‚</p></blockquote><ul>    <b><li>é‡ç½®æŒ‰é’®</li></b>    </ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;reset&quot;</span> <span class="attr">value</span>=<span class="string">&quot;é‡ç½®&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;reset&quot;</span>&gt;</span>é‡ç½®<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><ul>    <b><li>æ™®é€šæŒ‰é’®</li></b>    </ul>  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ç¡®å®š&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span>&gt;</span>ç¡®å®š<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼š<br>æ™®é€šæŒ‰é’®çš„typeå€¼ä¸ºbutton,è‹¥ä¸å†™typeå€¼æ˜¯submitä¼šå¼•èµ·è¡¨å•çš„æäº¤ã€‚</p></blockquote><hr><p style="font-family:åæ–‡æ¥·ä½“;color:green;font-size:20px">è¡¨å•_æ–‡æœ¬åŸŸå’Œä¸‹æ‹‰æ¡†</p><ul>    <b><li>æ–‡æœ¬åŸŸ</li></b>    </ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">txtarea</span> <span class="attr">name</span>=<span class="string">&quot;msg&quot;</span> <span class="attr">rows</span>=<span class="string">&quot;22&quot;</span> <span class="attr">cols</span>=<span class="string">&quot;3&quot;</span>&gt;</span>æ–‡æœ¬åŸŸ<span class="tag">&lt;/<span class="name">txtarea</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>å¸¸ç”¨å±æ€§å¦‚ä¸‹ï¼š<br>1.rowsï¼šæŒ‡å®šé»˜è®¤æ˜¾ç¤ºçš„è¡Œæ•°ï¼Œä¼šå½±å“æ–‡æœ¬åŸŸçš„é«˜åº¦ã€‚<br>2.cols:æŒ‡å®šé»˜è®¤æ˜¾ç¤ºçš„åˆ—æ•°ï¼Œä¼šå½±å“æ–‡æœ¬åŸŸçš„å®½åº¦ã€‚<br>3.ä¸èƒ½ç¼–å†™typeå±æ€§ï¼Œå…¶ä»–å±æ€§ï¼Œä¸æ™®é€šæ–‡æœ¬è¾“å…¥æ¡†ä¸€è‡´ã€‚</p></blockquote><ul>    <b><li>ä¸‹æ‹‰æ¡†</li></b>    </ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">&quot;city&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;beijing&quot;</span>&gt;</span>åŒ—äº¬<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;shanghai&quot;</span>&gt;</span>ä¸Šæµ·<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;guangzhou&quot;</span>&gt;</span>å¹¿å·<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;shenzhen&quot;</span> <span class="attr">selected</span>&gt;</span>æ·±åœ³<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>å¸¸ç”¨å±æ€§åŠæ³¨æ„äº‹é¡¹ï¼š<br>1.name:æŒ‡å®šæ•°æ®çš„åç§°ã€‚<br>2.optionæ ‡ç­¾è®¾ç½®valueå±æ€§ï¼Œå¦‚æœæ²¡æœ‰valueå±æ€§ï¼Œæäº¤çš„æ•°æ®æ˜¯optionä¸­é—´çš„æ–‡å­—;å¦‚æœè®¾ç½®äº†valueå±æ€§ï¼Œæäº¤çš„æ•°æ®å°±æ˜¯valueçš„å€¼ï¼ˆå»ºè®®è®¾ç½®valueå±æ€§ï¼‰<br>3.optionæ ‡ç­¾è®¾ç½®äº†selectedå±æ€§ï¼Œè¡¨ç¤ºé»˜è®¤é€‰ä¸­ã€‚</p></blockquote><hr><p style="font-family:åæ–‡æ¥·ä½“;color:green;font-size:20px">è¡¨å•_ç¦ç”¨è¡¨å•æ§ä»¶</p><ul>    <b><li>ç¦ç”¨è¡¨å•æ§ä»¶</li></b>    </ul><blockquote><p>ç»™è¡¨å•æ§ä»¶çš„æ ‡ç­¾è®¾ç½®disabledå³å¯ç¦ç”¨è¡¨å•æ§ä»¶ã€‚<br>inputã€textareaã€buttonã€selectã€optionéƒ½å¯ä»¥è®¾ç½®disabledå±æ€§</p></blockquote><p style="font-family:åæ–‡æ¥·ä½“;color:green;font-size:20px">è¡¨å•_labelæ ‡ç­¾</p><ul>    <b><li>è¡¨å•labelæ ‡ç­¾</li></b>    </ul>    <blockquote><p>labelæ ‡ç­¾å¯ä¸è¡¨å•æ§ä»¶ç›¸å…³è”ï¼Œå…³è”ä¹‹åç‚¹å‡»æ–‡å­—ï¼Œä¸ä¹‹å¯¹åº”çš„è¡¨å•æ§ä»¶å°±ä¼šè·å–ç„¦ç‚¹ã€‚ä¸¤ç§ä¸labelå…³è”æ–¹å¼å¦‚ä¸‹ï¼š<br>1.è®©labelæ ‡ç­¾çš„formå±æ€§çš„å€¼ç­‰äºè¡¨å•æ§ä»¶çš„idã€‚<br>2.æŠŠè¡¨å•æ§ä»¶å¥—åœ¨labelæ ‡ç­¾çš„é‡Œé¢ã€‚</p></blockquote><h1 style="text-align:center;font-size:60px;font-family:åæ–‡æ¥·ä½“;color:green">æ¡†æ¶æ ‡ç­¾</h1><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;https://www.taobao.com&quot;</span><span class="attr">frameborder</span>=<span class="string">&quot;0&quot;</span><span class="attr">width</span>=<span class="string">&quot;300&quot;</span><span class="attr">height</span>=<span class="string">&quot;300&quot;</span>&gt;</span>taobao<span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>ä¸è¶…é“¾æ¥çš„targetå±æ€§é…åˆä½¿ç”¨</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://www.taobao.com&quot;</span>  <span class="attr">target</span>=<span class="string">&quot;clj&quot;</span>&gt;</span>æ·˜å®<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">iframe</span> <span class="attr">name</span>=<span class="string">&quot;clj&quot;</span>  <span class="attr">frameborder</span>=<span class="string">&quot;0&quot;</span> <span class="attr">width</span>=<span class="string">&quot;300&quot;</span> <span class="attr">htight</span>=<span class="string">&quot;300&quot;</span> &gt;</span>taobao<span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>ä¸è¡¨å•çš„targetå±æ€§é…åˆä½¿ç”¨</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;https://www.taobao.com&quot;</span> <span class="attr">target</span>=<span class="string">&quot;clj&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;keyword&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span>&gt;</span>æœç´¢<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">iframe</span> <span class="attr">name</span>=<span class="string">&quot;clj&quot;</span>  <span class="attr">frameborder</span>=<span class="string">&quot;0&quot;</span> <span class="attr">width</span>=<span class="string">&quot;300&quot;</span> <span class="attr">htight</span>=<span class="string">&quot;300&quot;</span> &gt;</span>taobao<span class="tag">&lt;/<span class="name">iframe</span>&gt;</span>  </span><br></pre></td></tr></table></figure><table>    <tr>        <th>æ ‡ç­¾å</th>        <th>åŠŸèƒ½å’Œè¯­ä¹‰</th>        <th>å±æ€§</th>        <th>å•/åŒæ ‡ç­¾</th>        </tr>    <tr>        <th>iframe</th>        <th>æ¡†æ¶ï¼ˆåœ¨é¡µé¢ä¸­åµŒå…¥å…¶ä»–æ–‡ä»¶ï¼‰</th>        <th>name:æ¡†æ¶åå­—ï¼Œå¯ä»¥ä¸targetå±æ€§é…åˆã€‚            width:æ¡†æ¶çš„å®½ã€‚            heightï¼šæ¡†æ¶çš„é«˜ã€‚            frameborder:æ˜¯å¦æ˜¾ç¤ºè¾¹æ¡†ï¼Œå€¼ï¼š0æˆ–è€…1ã€‚</th>        <th>åŒ</th>    </tr>  </table>    <blockquote><p>iframeæ ‡ç­¾çš„å®é™…åº”ç”¨ï¼š<br>    1.åœ¨ç½‘é¡µä¸­åµŒå…¥å¹¿å‘Šã€‚<br>    2.ä¸è¶…é“¾æ¥æˆ–è¡¨å•çš„targeté…åˆï¼Œå±•ç¤ºä¸åŒçš„å†…å®¹ã€‚</p></blockquote><p style="font-family:åæ–‡æ¥·ä½“;color:green;font-size:20px">HTML å­—ç¬¦å®ä½“</p><p><code><b>å­—ç¬¦å®ä½“</b>ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼šä¸€ä¸ª&å’Œä¸€ä¸ªå®ä½“åç§°ï¼ˆæˆ–è€…ä¸€ä¸ª#å’Œä¸€ä¸ªå®ä½“ç¼–å·ï¼‰ï¼Œæœ€ååŠ ä¸Šä¸€ä¸ªåˆ†å·<b>;</b> ã€‚</code></p>]]></content>
      
      
      <categories>
          
          <category> HTMLåŸºç¡€ </category>
          
          <category> Visual Studio Code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Visual Studio Code </tag>
            
            <tag> HTML </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¤è¯†HTML.2å­¦ä¹ ç¬”è®°</title>
      <link href="/2025/01/14/html/%E5%AD%A6%E4%B9%A0html.2/"/>
      <url>/2025/01/14/html/%E5%AD%A6%E4%B9%A0html.2/</url>
      
        <content type="html"><![CDATA[<h1 style="text-align:center;font-size:60px;color:green;font-family:åæ–‡æ¥·ä½“;">HTML é¢œè‰²</h1><p><b><dfn>é¢œè‰²å€¼</dfn></b></p><p>é¢œè‰²ç”±ä¸€ä¸ªåå…­è¿›åˆ¶ç¬¦å·æ¥å®šä¹‰ï¼Œè¿™ä¸ªç¬¦å·ç”±çº¢è‰²ã€ç»¿è‰²å’Œè“è‰²çš„å€¼ç»„æˆï¼ˆRGBï¼‰ã€‚æ¯ç§é¢œè‰²çš„æœ€å°å€¼æ˜¯ 0ï¼ˆåå…­è¿›åˆ¶ï¼š#00ï¼‰ã€‚æœ€å¤§å€¼æ˜¯ 255ï¼ˆåå…­è¿›åˆ¶ï¼š#FFï¼‰ã€‚<p>    <p><b><dfn>åœ¨HTMLä¸­åº”ç”¨16è¿›åˆ¶é¢œè‰²</dfn></b><br><cite>è®¾ç½®æ–‡æœ¬é¢œè‰²</cite></p><blockquote><p>å¯ä»¥é€šè¿‡CSSçš„colorå±æ€§æ¥è®¾ç½®æ–‡æœ¬é¢œè‰²ã€‚ä¾‹å¦‚ï¼š   </p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;p style=&quot;color:#FF5733;&quot;&gt;è¿™æ˜¯ä¸€æ®µçº¢è‰²çš„æ–‡æœ¬ã€‚&lt;/p&gt;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ®µè½pä¸­çš„æ–‡æœ¬é¢œè‰²è¢«è®¾ç½®ä¸º#FF5733ï¼Œè¿™æ˜¯ä¸€ç§æ©™çº¢è‰²ã€‚</p></blockquote><p><cite>è®¾ç½®èƒŒæ™¯é¢œè‰²</cite></p><blockquote><p>ä½¿ç”¨background-colorå±æ€§å¯ä»¥è®¾ç½®å…ƒç´ çš„èƒŒæ™¯é¢œè‰²ã€‚ä¾‹å¦‚ï¼š</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;background-color:#333399; width:200px; height:100px;&quot;</span>&gt;</span></span><br><span class="line">  è¿™æ˜¯ä¸€ä¸ªæœ‰èƒŒæ™¯é¢œè‰²çš„div</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>è¿™é‡Œè®¾ç½®äº†ä¸€ä¸ªdivå…ƒç´ çš„èƒŒæ™¯é¢œè‰²ä¸º#333399ï¼Œè¿™æ˜¯ä¸€ç§æ·±è“è‰²ã€‚åŒæ—¶ï¼Œé€šè¿‡è®¾ç½®widthå’Œheightå±æ€§ï¼Œå®šä¹‰äº†divçš„å¤§å°ï¼Œä»¥ä¾¿æ›´å¥½åœ°å±•ç¤ºèƒŒæ™¯é¢œè‰²æ•ˆæœã€‚</p></blockquote><p><cite>è®¾ç½®è¾¹æ¡†é¢œè‰²</cite></p><blockquote><p>å¦‚æœè¦ç»™å…ƒç´ æ·»åŠ è¾¹æ¡†å¹¶è®¾ç½®è¾¹æ¡†é¢œè‰²ï¼Œå¯ä»¥ä½¿ç”¨borderå±æ€§ã€‚ä¾‹å¦‚ï¼š</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;border:2px solid #FFD700; width:200px; height:100px;&quot;</span>&gt;</span></span><br><span class="line">  è¿™æ˜¯ä¸€ä¸ªæœ‰é»„è‰²è¾¹æ¡†çš„div</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œdivå…ƒç´ æœ‰ä¸€ä¸ª2åƒç´ å®½çš„å®çº¿è¾¹æ¡†ï¼Œè¾¹æ¡†é¢œè‰²ä¸º#FFD700ï¼Œå³é‡‘è‰²ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¯ä»¥ä¸ºç½‘é¡µä¸­çš„å„ç§å…ƒç´ æ·»åŠ å…·æœ‰ç‰¹å®šé¢œè‰²çš„è¾¹æ¡†ï¼Œå¢å¼ºé¡µé¢çš„è§†è§‰æ•ˆæœã€‚<br>å¦‚ä½•ä½¿ç”¨æ ·å¼<br>å½“æµè§ˆå™¨è¯»åˆ°ä¸€ä¸ªæ ·å¼è¡¨ï¼Œå®ƒå°±ä¼šæŒ‰ç…§è¿™ä¸ªæ ·å¼è¡¨æ¥å¯¹æ–‡æ¡£è¿›è¡Œæ ¼å¼åŒ–ã€‚æœ‰ä»¥ä¸‹ä¸‰ç§æ–¹å¼æ¥æ’å…¥æ ·å¼è¡¨ï¼š</p></blockquote><p><cite>å¤–éƒ¨æ ·å¼è¡¨</cite></p><blockquote><p>å½“æ ·å¼éœ€è¦è¢«åº”ç”¨åˆ°å¾ˆå¤šé¡µé¢çš„æ—¶å€™ï¼Œå¤–éƒ¨æ ·å¼è¡¨å°†æ˜¯ç†æƒ³çš„é€‰æ‹©ã€‚ä½¿ç”¨å¤–éƒ¨æ ·å¼è¡¨ï¼Œä½ å°±å¯ä»¥é€šè¿‡æ›´æ”¹ä¸€ä¸ªæ–‡ä»¶æ¥æ”¹å˜æ•´ä¸ªç«™ç‚¹çš„å¤–è§‚ã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;head&gt;</span><br><span class="line">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;mystyle.css&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br></pre></td></tr></table></figure><p><cite>å†…éƒ¨æ ·å¼è¡¨</cite></p><blockquote><p>å½“å•ä¸ªæ–‡ä»¶éœ€è¦ç‰¹åˆ«æ ·å¼æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨å†…éƒ¨æ ·å¼è¡¨ã€‚ä½ å¯ä»¥åœ¨ head éƒ¨åˆ†é€šè¿‡ style æ ‡ç­¾å®šä¹‰å†…éƒ¨æ ·å¼è¡¨ã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;head&gt;</span><br><span class="line"></span><br><span class="line">&lt;style type=&quot;text/css&quot;&gt;</span><br><span class="line">body &#123;background-color: red&#125;</span><br><span class="line">p &#123;margin-left: 20px&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br></pre></td></tr></table></figure><p><cite>å†…è”æ ·å¼</cite></p><blockquote><p>å½“ç‰¹æ®Šçš„æ ·å¼éœ€è¦åº”ç”¨åˆ°ä¸ªåˆ«å…ƒç´ æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨å†…è”æ ·å¼ã€‚ä½¿ç”¨å†…è”æ ·å¼çš„æ–¹æ³•æ˜¯åœ¨ç›¸å…³çš„æ ‡ç­¾ä¸­ä½¿ç”¨æ ·å¼å±æ€§ã€‚æ ·å¼å±æ€§å¯ä»¥åŒ…å«ä»»ä½• CSS å±æ€§ã€‚ä»¥ä¸‹å®ä¾‹æ˜¾ç¤ºå‡ºå¦‚ä½•æ”¹å˜æ®µè½çš„é¢œè‰²å’Œå·¦å¤–è¾¹è·ã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;p style=&quot;color: red; margin-left: 20px&quot;&gt;</span><br><span class="line">This is a paragraph</span><br><span class="line">&lt;/p&gt;</span><br></pre></td></tr></table></figure><h1 style="text-align:center;font-size:60px;color:green;font-family:åæ–‡æ¥·ä½“;">HTML è¶…é“¾æ¥</h1><p><code>è¶…é“¾æ¥å¯ä»¥æ˜¯ä¸€ä¸ªå­—ï¼Œä¸€ä¸ªè¯ï¼Œæˆ–è€…ä¸€ç»„è¯ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€å¹…å›¾åƒï¼Œæ‚¨å¯ä»¥ç‚¹å‡»è¿™äº›å†…å®¹æ¥è·³è½¬åˆ°æ–°çš„æ–‡æ¡£æˆ–è€…å½“å‰æ–‡æ¡£ä¸­çš„æŸä¸ªéƒ¨åˆ†ã€‚</code></p><blockquote><p>å½“æ‚¨æŠŠé¼ æ ‡æŒ‡é’ˆç§»åŠ¨åˆ°ç½‘é¡µä¸­çš„æŸä¸ªé“¾æ¥ä¸Šæ—¶ï¼Œç®­å¤´ä¼šå˜ä¸ºä¸€åªå°æ‰‹ã€‚<br>æˆ‘ä»¬é€šè¿‡ä½¿ç”¨ ã€Šaã€‹ æ ‡ç­¾åœ¨ HTML ä¸­åˆ›å»ºé“¾æ¥ã€‚<br>æœ‰ä¸¤ç§ä½¿ç”¨ ã€Šaã€‹ æ ‡ç­¾çš„æ–¹å¼ï¼š<br>é€šè¿‡ä½¿ç”¨ href å±æ€§ - åˆ›å»ºæŒ‡å‘å¦ä¸€ä¸ªæ–‡æ¡£çš„é“¾æ¥<br>é€šè¿‡ä½¿ç”¨ name å±æ€§ - åˆ›å»ºæ–‡æ¡£å†…çš„ä¹¦ç­¾</p></blockquote><p><code>HTMLä¸­çš„é“¾æ¥æ˜¯é€šè¿‡ã€Šaã€‹ï¼ˆanchorï¼‰æ ‡ç­¾æ¥åˆ›å»ºçš„ï¼Œå®ƒå…è®¸ç”¨æˆ·ä»ä¸€ä¸ªç½‘é¡µè·³è½¬åˆ°å¦ä¸€ä¸ªç½‘é¡µã€ç½‘é¡µçš„æŸä¸ªéƒ¨åˆ†ï¼Œæˆ–è€…æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç­‰ã€‚ä»¥ä¸‹æ˜¯å…³äºHTMLé“¾æ¥çš„è¯¦ç»†ä»‹ç»ï¼š</code></p><p>ä¸€ã€åŸºæœ¬è¯­æ³•</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;é“¾æ¥ç›®æ ‡çš„URL&quot;</span>&gt;</span>é“¾æ¥æ–‡å­—æˆ–å†…å®¹<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>hrefå±æ€§æ˜¯å…³é”®ï¼Œå®ƒæŒ‡å®šäº†é“¾æ¥çš„ç›®æ ‡åœ°å€ã€‚å¯ä»¥æ˜¯ç½‘é¡µçš„URLã€æ–‡ä»¶çš„è·¯å¾„ã€ç½‘é¡µå†…éƒ¨çš„é”šç‚¹ç­‰ã€‚<br>é“¾æ¥æ–‡å­—æˆ–å†…å®¹æ˜¯æ˜¾ç¤ºåœ¨ç½‘é¡µä¸Šçš„éƒ¨åˆ†ï¼Œç”¨æˆ·ç‚¹å‡»è¿™éƒ¨åˆ†å†…å®¹å°±ä¼šè§¦å‘é“¾æ¥è·³è½¬ã€‚å¯ä»¥æ˜¯çº¯æ–‡æœ¬ï¼Œä¹Ÿå¯ä»¥æ˜¯å›¾ç‰‡æˆ–å…¶ä»–HTMLå…ƒç´ ã€‚</p></blockquote><p>äºŒã€é“¾æ¥ç±»å‹<br>1.å¤–éƒ¨é“¾æ¥<br><code>è¿™æ˜¯æŒ‡å‘å…¶ä»–ç½‘ç«™çš„é“¾æ¥ã€‚ä¾‹å¦‚ï¼Œè¦åˆ›å»ºä¸€ä¸ªé“¾æ¥åˆ°ç™¾åº¦é¦–é¡µçš„é“¾æ¥ï¼Œå¯ä»¥è¿™æ ·å†™ï¼š</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://www.baidu.com&quot;</span>&gt;</span>è®¿é—®ç™¾åº¦<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>å½“ç”¨æˆ·ç‚¹å‡»â€œè®¿é—®ç™¾åº¦â€è¿™å‡ ä¸ªå­—æ—¶ï¼Œæµè§ˆå™¨ä¼šæ‰“å¼€ç™¾åº¦çš„é¦–é¡µã€‚</p></blockquote><p>2.å†…éƒ¨é“¾æ¥<br><code>å†…éƒ¨é“¾æ¥æ˜¯æŒ‡åœ¨åŒä¸€ç½‘ç«™å†…éƒ¨ä¸åŒé¡µé¢ä¹‹é—´çš„é“¾æ¥ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªç½‘ç«™æœ‰é¦–é¡µï¼ˆindex.htmlï¼‰ã€å…³äºæˆ‘ä»¬ï¼ˆabout.htmlï¼‰å’Œè”ç³»æˆ‘ä»¬ï¼ˆcontact.htmlï¼‰ä¸‰ä¸ªé¡µé¢ï¼Œå¯ä»¥åœ¨é¦–é¡µåˆ›å»ºä¸€ä¸ªé“¾æ¥åˆ°å…³äºæˆ‘ä»¬é¡µé¢çš„é“¾æ¥ï¼š</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;about.html&quot;</span>&gt;</span>å…³äºæˆ‘ä»¬<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>è¿™é‡Œå‡è®¾è¿™äº›é¡µé¢éƒ½åœ¨åŒä¸€ä¸ªç›®å½•ä¸‹ã€‚å¦‚æœé¡µé¢åœ¨ä¸åŒçš„ç›®å½•ï¼Œéœ€è¦æ­£ç¡®è®¾ç½®ç›¸å¯¹è·¯å¾„æˆ–ç»å¯¹è·¯å¾„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå…³äºæˆ‘ä»¬é¡µé¢åœ¨pagesç›®å½•ä¸‹ï¼Œé“¾æ¥å¯ä»¥å†™æˆï¼š</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;pages/about.html&quot;</span>&gt;</span>å…³äºæˆ‘ä»¬<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p>3.é”šç‚¹é“¾æ¥</p><blockquote><p>é”šç‚¹é“¾æ¥ç”¨äºåœ¨åŒä¸€é¡µé¢å†…å¿«é€Ÿè·³è½¬åˆ°ç‰¹å®šä½ç½®ã€‚é¦–å…ˆéœ€è¦åœ¨ç›®æ ‡ä½ç½®è®¾ç½®ä¸€ä¸ªé”šç‚¹ï¼Œä½¿ç”¨ã€Šaã€‹æ ‡ç­¾çš„nameå±æ€§ï¼ˆHTML5ä¸­æ¨èä½¿ç”¨idå±æ€§ï¼‰æ¥å®šä¹‰é”šç‚¹ã€‚ä¾‹å¦‚ï¼Œåœ¨é¡µé¢åº•éƒ¨æœ‰ä¸€ä¸ªæ®µè½ï¼š</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h2</span> <span class="attr">id</span>=<span class="string">&quot;section1&quot;</span>&gt;</span>ç¬¬ä¸€éƒ¨åˆ†<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>è¿™é‡Œæ˜¯ç¬¬ä¸€éƒ¨åˆ†çš„å†…å®¹â€¦â€¦<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>ç„¶ååœ¨é¡µé¢é¡¶éƒ¨å¯ä»¥åˆ›å»ºä¸€ä¸ªé“¾æ¥åˆ°è¿™ä¸ªé”šç‚¹çš„é“¾æ¥ï¼š</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#section1&quot;</span>&gt;</span>è·³è½¬åˆ°ç¬¬ä¸€éƒ¨åˆ†<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line">å½“ç”¨æˆ·ç‚¹å‡»è¿™ä¸ªé“¾æ¥æ—¶ï¼Œé¡µé¢ä¼šæ»šåŠ¨åˆ°<span class="tag">&lt;<span class="name">h2</span> <span class="attr">id</span>=<span class="string">&quot;section1&quot;</span>&gt;</span>æ‰€åœ¨çš„ä½ç½®ã€‚</span><br></pre></td></tr></table></figure><p>ä¸‰ã€é“¾æ¥çš„å…¶ä»–å±æ€§<br>1.targetå±æ€§</p><blockquote><p>è¿™ä¸ªå±æ€§å¯ä»¥æ§åˆ¶é“¾æ¥åœ¨ä½•å¤„æ‰“å¼€ã€‚å¸¸ç”¨çš„å€¼æœ‰ï¼š</p></blockquote><p><code>_selfï¼šåœ¨å½“å‰çª—å£æˆ–æ ‡ç­¾é¡µä¸­æ‰“å¼€é“¾æ¥ï¼Œè¿™æ˜¯é»˜è®¤å€¼ã€‚<br>_blankï¼šåœ¨æ–°çª—å£æˆ–æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€é“¾æ¥ã€‚ä¾‹å¦‚ï¼š</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://www.example.com&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span>&gt;</span>åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€ç¤ºä¾‹ç½‘ç«™<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>ç‚¹å‡»è¿™ä¸ªé“¾æ¥ä¼šåœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€<a href="https://www.example.com./">https://www.example.comã€‚</a></p></blockquote><p><code>_parentï¼šåœ¨çˆ¶çª—å£æˆ–æ ‡ç­¾é¡µä¸­æ‰“å¼€é“¾æ¥ï¼Œä¸»è¦ç”¨äºæ¡†æ¶ï¼ˆframeï¼‰æˆ–åµŒå¥—çš„ç½‘é¡µåœºæ™¯ã€‚<br>_topï¼šåœ¨æ•´ä¸ªæµè§ˆå™¨çª—å£ä¸­æ‰“å¼€é“¾æ¥ï¼Œä¹Ÿä¼šæ¸…é™¤æ‰€æœ‰æ¡†æ¶ã€‚</code><br>2.titleå±æ€§<br><code>ä¸ºé“¾æ¥æä¾›é¢å¤–çš„ä¿¡æ¯ï¼Œå½“ç”¨æˆ·å°†é¼ æ ‡æ‚¬åœåœ¨é“¾æ¥ä¸Šæ—¶ï¼Œä¼šæ˜¾ç¤ºè¿™ä¸ªæç¤ºä¿¡æ¯ã€‚ä¾‹å¦‚ï¼š</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://www.example.com&quot;</span> <span class="attr">title</span>=<span class="string">&quot;è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹ç½‘ç«™&quot;</span>&gt;</span>ç¤ºä¾‹ç½‘ç«™<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>é¼ æ ‡æ‚¬åœåœ¨â€œç¤ºä¾‹ç½‘ç«™â€é“¾æ¥ä¸Šæ—¶ï¼Œä¼šæ˜¾ç¤ºâ€œè¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹ç½‘ç«™â€çš„æç¤ºã€‚<br>HTMLé“¾æ¥æ˜¯ç½‘é¡µä¹‹é—´ç›¸äº’è¿æ¥çš„æ¡¥æ¢ï¼Œåˆç†ä½¿ç”¨é“¾æ¥å¯ä»¥æå¤§åœ°æå‡ç”¨æˆ·ä½“éªŒå’Œç½‘ç«™çš„å¯¼èˆªæ€§ã€‚</p></blockquote><h1 style="text-align:center;font-size:60px;color:green;font-family:åæ–‡æ¥·ä½“;">HTML å›¾åƒ</h1><p><code>åœ¨HTMLä¸­æ’å…¥å›¾åƒä¸»è¦é€šè¿‡ã€Šimgã€‹æ ‡ç­¾æ¥å®ç°ï¼Œè¿™æ˜¯ä¸€ç§éå¸¸ç®€å•ä½†åŠŸèƒ½å¼ºå¤§çš„æ–¹å¼ï¼Œå¯ä»¥è®©ç½‘é¡µæ›´åŠ ç”ŸåŠ¨å’Œå¯Œæœ‰è¡¨ç°åŠ›ã€‚ä»¥ä¸‹æ˜¯å…³äºå¦‚ä½•åœ¨HTMLä¸­æ’å…¥å›¾åƒçš„è¯¦ç»†ä»‹ç»ï¼š</code><br>ä¸€ã€åŸºæœ¬è¯­æ³•</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;å›¾åƒçš„URLæˆ–è·¯å¾„&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;å›¾åƒçš„æ›¿ä»£æ–‡æœ¬&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>srcå±æ€§ï¼šè¿™æ˜¯å¿…éœ€çš„å±æ€§ï¼Œç”¨äºæŒ‡å®šå›¾åƒçš„æºè·¯å¾„ã€‚å¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„ï¼ˆç›¸å¯¹äºå½“å‰HTMLæ–‡ä»¶çš„ä½ç½®ï¼‰æˆ–ç»å¯¹è·¯å¾„ï¼ˆå®Œæ•´çš„URLï¼‰ã€‚</p></blockquote><p><code>altå±æ€§ï¼šä¹Ÿæ˜¯å¾ˆé‡è¦çš„å±æ€§ï¼Œå®ƒæä¾›äº†å›¾åƒçš„æ›¿ä»£æ–‡æœ¬ã€‚å½“å›¾åƒç”±äºæŸäº›åŸå› æ— æ³•æ˜¾ç¤ºæ—¶ï¼ˆå¦‚ç½‘ç»œé—®é¢˜ã€å›¾åƒè·¯å¾„é”™è¯¯ç­‰ï¼‰ï¼Œæµè§ˆå™¨ä¼šæ˜¾ç¤ºè¿™ä¸ªæ›¿ä»£æ–‡æœ¬ã€‚æ­¤å¤–ï¼Œå¯¹äºä½¿ç”¨å±å¹•é˜…è¯»å™¨çš„ç”¨æˆ·æ¥è¯´ï¼Œaltæ–‡æœ¬å¯ä»¥å¸®åŠ©ä»–ä»¬äº†è§£å›¾åƒçš„å†…å®¹ï¼Œä»è€Œæé«˜ç½‘é¡µçš„å¯è®¿é—®æ€§ã€‚</code></p><h1 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h1><p>1.ä½¿ç”¨ç›¸å¯¹è·¯å¾„æ’å…¥å›¾åƒ<br><code>å‡è®¾ä½ æœ‰ä¸€ä¸ªåä¸ºimage.jpgçš„å›¾åƒæ–‡ä»¶ï¼Œå®ƒå’Œä½ çš„HTMLæ–‡ä»¶ä½äºåŒä¸€ä¸ªç›®å½•ä¸‹ï¼Œä½ å¯ä»¥è¿™æ ·æ’å…¥å›¾åƒï¼š</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;image.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;ç¤ºä¾‹å›¾åƒ&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>å¦‚æœå›¾åƒæ–‡ä»¶ä½äºä¸€ä¸ªåä¸ºimagesçš„å­ç›®å½•ä¸­ï¼Œè·¯å¾„åº”è¯¥æ˜¯ï¼š</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;images/image.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;ç¤ºä¾‹å›¾åƒ&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p>2.ä½¿ç”¨ç»å¯¹è·¯å¾„æ’å…¥å›¾åƒ<br><code>å¦‚æœä½ æƒ³æ’å…¥ä¸€ä¸ªæ¥è‡ªäº’è”ç½‘çš„å›¾åƒï¼Œå¯ä»¥ä½¿ç”¨å®Œæ•´çš„URLï¼š</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://example.com/images/image.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;æ¥è‡ªå¤–éƒ¨ç½‘ç«™çš„å›¾åƒ&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p>äºŒã€å…¶ä»–æœ‰ç”¨çš„å±æ€§<br>1.widthå’Œheightå±æ€§</p><blockquote><p>è¿™ä¸¤ä¸ªå±æ€§å¯ä»¥ç”¨æ¥æŒ‡å®šå›¾åƒçš„æ˜¾ç¤ºå®½åº¦å’Œé«˜åº¦ï¼Œå•ä½é€šå¸¸æ˜¯åƒç´ ã€‚è¿™å¯ä»¥å¸®åŠ©ä½ æ§åˆ¶å›¾åƒåœ¨ç½‘é¡µä¸­çš„å¤§å°ï¼Œä½¿å…¶æ›´å¥½åœ°é€‚åº”å¸ƒå±€ã€‚ä¾‹å¦‚ï¼š</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;image.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;ç¤ºä¾‹å›¾åƒ&quot;</span> <span class="attr">width</span>=<span class="string">&quot;300&quot;</span> <span class="attr">height</span>=<span class="string">&quot;200&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>æ³¨æ„ï¼Œå¦‚æœåªè®¾ç½®å…¶ä¸­ä¸€ä¸ªå±æ€§ï¼Œå›¾åƒä¼šæŒ‰æ¯”ä¾‹è‡ªåŠ¨è°ƒæ•´å¦ä¸€ä¸ªç»´åº¦çš„å¤§å°ï¼Œä»¥ä¿æŒå›¾åƒçš„çºµæ¨ªæ¯”ã€‚</code><br>2.titleå±æ€§</p><blockquote><p>å’Œé“¾æ¥çš„titleå±æ€§ç±»ä¼¼ï¼Œtitleå±æ€§ä¸ºå›¾åƒæä¾›é¢å¤–çš„ä¿¡æ¯ï¼Œå½“ç”¨æˆ·å°†é¼ æ ‡æ‚¬åœåœ¨å›¾åƒä¸Šæ—¶ï¼Œä¼šæ˜¾ç¤ºè¿™ä¸ªæç¤ºä¿¡æ¯ã€‚</p></blockquote><p>ä¾‹å¦‚ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;image.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;ç¤ºä¾‹å›¾åƒ&quot;</span> <span class="attr">title</span>=<span class="string">&quot;è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹å›¾åƒ&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 style="text-align:center;font-size:60px;color:green;font-family:åæ–‡æ¥·ä½“;">HTML è¡¨æ ¼ï¼Œåˆ—è¡¨</h1><p>ä¸€ã€åŸºæœ¬è¯­æ³•<br><code>HTMLè¡¨æ ¼æ˜¯é€šè¿‡tableæ ‡ç­¾æ¥åˆ›å»ºçš„ï¼Œè¡¨æ ¼ç”±è¡Œï¼ˆã€Štrã€‹ï¼‰ã€å•å…ƒæ ¼ï¼ˆtdæˆ–thï¼‰ç»„æˆã€‚å…¶ä¸­ï¼Œthç”¨äºå®šä¹‰è¡¨å¤´å•å…ƒæ ¼ï¼Œé€šå¸¸æ˜¾ç¤ºä¸ºåŠ ç²—å’Œå±…ä¸­ï¼Œè€Œtdç”¨äºå®šä¹‰æ™®é€šå•å…ƒæ ¼ã€‚</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">th</span>&gt;</span>è¡¨å¤´1<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">th</span>&gt;</span>è¡¨å¤´2<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">th</span>&gt;</span>è¡¨å¤´3<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>æ•°æ®1<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>æ•°æ®2<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>æ•°æ®3<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>æ•°æ®4<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>æ•°æ®5<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>æ•°æ®6<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure><p>1.è¡¨æ ¼çš„ç»„æˆéƒ¨åˆ†</p><blockquote><p>1.tableæ ‡ç­¾ï¼šå®šä¹‰æ•´ä¸ªè¡¨æ ¼ã€‚<br>2.træ ‡ç­¾ï¼šå®šä¹‰è¡¨æ ¼çš„è¡Œã€‚<br>3.thæ ‡ç­¾ï¼šå®šä¹‰è¡¨å¤´å•å…ƒæ ¼ï¼Œé€šå¸¸ç”¨äºç¬¬ä¸€è¡Œæ¥æè¿°åˆ—çš„å†…å®¹ã€‚<br>4.tdæ ‡ç­¾ï¼šå®šä¹‰æ™®é€šå•å…ƒæ ¼ï¼Œç”¨äºåŒ…å«æ•°æ®ã€‚</p></blockquote><p>2.è¡¨æ ¼çš„å±æ€§</p><blockquote><p>è™½ç„¶HTML5ä¸­è®¸å¤šè¡¨æ ¼å±æ€§å·²ç»è¢«CSSæ‰€å–ä»£ï¼Œä½†ä»ç„¶æœ‰ä¸€äº›å±æ€§å¯ä»¥ç”¨æ¥æ§åˆ¶è¡¨æ ¼çš„åŸºæœ¬è¡Œä¸ºï¼š<br>borderå±æ€§ï¼šç”¨äºè®¾ç½®è¡¨æ ¼è¾¹æ¡†çš„å®½åº¦ã€‚ä¾‹å¦‚ï¼Œtable border&#x3D;â€1â€ä¼šåˆ›å»ºä¸€ä¸ªæœ‰è¾¹æ¡†çš„è¡¨æ ¼ã€‚ä¸è¿‡ï¼Œç°åœ¨æ›´æ¨èä½¿ç”¨CSSæ¥æ§åˆ¶è¾¹æ¡†æ ·å¼ã€‚<br>cellpaddingå’Œcellspacingå±æ€§ï¼šåˆ†åˆ«ç”¨äºè®¾ç½®å•å…ƒæ ¼å†…å†…å®¹ä¸è¾¹æ¡†çš„è·ç¦»ï¼ˆå†…è¾¹è·ï¼‰å’Œå•å…ƒæ ¼ä¹‹é—´çš„è·ç¦»ï¼ˆå¤–è¾¹è·ï¼‰ã€‚åŒæ ·ï¼Œè¿™äº›ç°åœ¨ä¹Ÿæ¨èä½¿ç”¨CSSæ¥æ§åˆ¶ã€‚</p></blockquote><p><code>åœ¨HTMLä¸­ï¼Œåˆ—è¡¨æ˜¯ä¸€ç§éå¸¸æœ‰ç”¨çš„å…ƒç´ ï¼Œç”¨äºç»„ç»‡å’Œæ˜¾ç¤ºä¸€ç³»åˆ—ç›¸å…³çš„ä¿¡æ¯ã€‚HTMLæä¾›äº†ä¸‰ç§ä¸»è¦çš„åˆ—è¡¨ç±»å‹ï¼šæ— åºåˆ—è¡¨ï¼ˆulï¼‰ã€æœ‰åºåˆ—è¡¨ï¼ˆolï¼‰å’Œæè¿°åˆ—è¡¨ï¼ˆdlï¼‰ã€‚æ¯ç§åˆ—è¡¨ç±»å‹éƒ½æœ‰å…¶ç‰¹å®šçš„ç”¨é€”å’Œæ ¼å¼ã€‚</code><br>ä¸€ã€æ— åºåˆ—è¡¨ï¼ˆulï¼‰</p><blockquote><p>æ— åºåˆ—è¡¨ç”¨äºè¡¨ç¤ºæ²¡æœ‰ç‰¹å®šé¡ºåºçš„é¡¹ç›®åˆ—è¡¨ã€‚åˆ—è¡¨é¡¹ä½¿ç”¨liï¼ˆlist itemï¼‰æ ‡ç­¾å®šä¹‰ã€‚</p></blockquote><p>1.åŸºæœ¬è¯­æ³•</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>åˆ—è¡¨é¡¹1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>åˆ—è¡¨é¡¹2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>åˆ—è¡¨é¡¹3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>åœ¨æµè§ˆå™¨ä¸­ï¼Œè¿™å°†æ˜¾ç¤ºä¸€ä¸ªå¸¦æœ‰é¡¹ç›®ç¬¦å·çš„åˆ—è¡¨ã€‚</code><br>äºŒã€æœ‰åºåˆ—è¡¨ï¼ˆolï¼‰<br><dfn>æœ‰åºåˆ—è¡¨ç”¨äºè¡¨ç¤ºæœ‰ç‰¹å®šé¡ºåºçš„é¡¹ç›®åˆ—è¡¨ã€‚åˆ—è¡¨é¡¹åŒæ ·ä½¿ç”¨liæ ‡ç­¾å®šä¹‰ã€‚æœ‰åºåˆ—è¡¨çš„åˆ—è¡¨é¡¹ä¼šè‡ªåŠ¨ç¼–å·ã€‚</dfn><br>2.åŸºæœ¬è¯­æ³•</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>åˆ—è¡¨é¡¹1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>åˆ—è¡¨é¡¹2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>åˆ—è¡¨é¡¹3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>åœ¨æµè§ˆå™¨ä¸­ï¼Œè¿™å°†æ˜¾ç¤ºä¸€ä¸ªå¸¦æœ‰æ•°å­—ç¼–å·çš„åˆ—è¡¨ã€‚</code><br>ä¸‰ã€æè¿°åˆ—è¡¨ï¼ˆdlï¼‰<br><dfn>æè¿°åˆ—è¡¨ç”¨äºè¡¨ç¤ºæœ¯è¯­å’Œæè¿°çš„åˆ—è¡¨ã€‚å®ƒç”±dlæ ‡ç­¾å®šä¹‰ï¼Œæ¯ä¸ªæœ¯è¯­ä½¿ç”¨dtï¼ˆdefinition termï¼‰æ ‡ç­¾å®šä¹‰ï¼Œæ¯ä¸ªæè¿°ä½¿ç”¨ddï¼ˆdefinition descriptionï¼‰æ ‡ç­¾å®šä¹‰ã€‚</dfn><br>1.åŸºæœ¬è¯­æ³•</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dl</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dt</span>&gt;</span>æœ¯è¯­1<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dd</span>&gt;</span>æè¿°1<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dt</span>&gt;</span>æœ¯è¯­2<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dd</span>&gt;</span>æè¿°2<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dl</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>åœ¨æµè§ˆå™¨ä¸­ï¼Œè¿™å°†æ˜¾ç¤ºä¸€ä¸ªæœ¯è¯­å’Œæè¿°çš„åˆ—è¡¨ï¼Œæœ¯è¯­é€šå¸¸ä¼šåŠ ç²—æ˜¾ç¤ºã€‚</code><br><dfn>å››ã€åˆ—è¡¨çš„åµŒå¥—</dfn></p><blockquote><p>åˆ—è¡¨å¯ä»¥åµŒå¥—ä½¿ç”¨ï¼Œå³åœ¨ä¸€ä¸ªåˆ—è¡¨é¡¹å†…éƒ¨å†åˆ›å»ºä¸€ä¸ªæ–°çš„åˆ—è¡¨ã€‚è¿™åœ¨éœ€è¦è¡¨ç¤ºå±‚æ¬¡ç»“æ„æ—¶éå¸¸æœ‰ç”¨ã€‚</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">å¤åˆ¶</span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>æ°´æœ</span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>è‹¹æœ<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>é¦™è•‰<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>æ©™å­<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>è”¬èœ</span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>èƒ¡èåœ<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>è¥¿çº¢æŸ¿<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>åœŸè±†<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>åœ¨æµè§ˆå™¨ä¸­ï¼Œè¿™å°†æ˜¾ç¤ºä¸€ä¸ªåµŒå¥—çš„æ— åºåˆ—è¡¨ï¼Œå…¶ä¸­æ¯ä¸ªä¸»è¦ç±»åˆ«ï¼ˆæ°´æœå’Œè”¬èœï¼‰ä¸‹é¢æœ‰å­ç±»åˆ«ã€‚</code></p>]]></content>
      
      
      <categories>
          
          <category> HTMLåŸºç¡€ </category>
          
          <category> Visual Studio Code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Visual Studio Code </tag>
            
            <tag> HTML </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>html.1å­¦ä¹ ç¬”è®°</title>
      <link href="/2025/01/14/html/%E5%AD%A6%E4%B9%A0html.1/"/>
      <url>/2025/01/14/html/%E5%AD%A6%E4%B9%A0html.1/</url>
      
        <content type="html"><![CDATA[<blockquote><p>HTML æ³¨é‡Š</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--ï¼ˆæ–‡æœ¬ï¼‰--&gt;</span><br></pre></td></tr></table></figure><h1 style="text-align:center;font-size:60px"> HTML æ ·å¼</h1><h2 style="text-align:center;font-size:30px;font-family:åæ–‡æ¥·ä½“">HTML çš„ style å±æ€§</h2><blockquote><p>style å±æ€§ç”¨äºæ”¹å˜ HTML å…ƒç´ çš„æ ·å¼ã€‚</p></blockquote><p>1.style å±æ€§çš„ä½œç”¨:</p><blockquote><p>æä¾›äº†ä¸€ç§æ”¹å˜æ‰€æœ‰ HTML å…ƒç´ çš„æ ·å¼çš„é€šç”¨æ–¹æ³•ã€‚<br>æ ·å¼æ˜¯ HTML 4 å¼•å…¥çš„ï¼Œå®ƒæ˜¯ä¸€ç§æ–°çš„é¦–é€‰çš„æ”¹å˜ HTML å…ƒç´ æ ·å¼çš„æ–¹å¼ã€‚é€šè¿‡ HTML æ ·å¼ï¼Œèƒ½å¤Ÿé€šè¿‡ä½¿ç”¨ style å±æ€§ç›´æ¥å°†æ ·å¼æ·»åŠ åˆ° HTML å…ƒç´ ï¼Œæˆ–è€…é—´æ¥åœ°åœ¨ç‹¬ç«‹çš„æ ·å¼è¡¨ä¸­ï¼ˆCSS æ–‡ä»¶ï¼‰è¿›è¡Œå®šä¹‰ã€‚</p></blockquote><h3 style="text-align:center;color:green;font-size:30px;font-family:åæ–‡æ¥·ä½“">HTML æ ·å¼å®ä¾‹ - èƒŒæ™¯é¢œè‰²</h3><blockquote><p>background-color å±æ€§ä¸ºå…ƒç´ å®šä¹‰äº†èƒŒæ™¯é¢œè‰²ï¼š</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;body style=&quot;background-color:yellow&quot;&gt;</span><br><span class="line">&lt;h2 style=&quot;background-color:red&quot;&gt;This is a heading&lt;/h2&gt;</span><br><span class="line">&lt;p style=&quot;background-color:green&quot;&gt;This is a paragraph.&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h4 style="text-align:center;color:red;font-size:30px;font-family:åæ–‡æ¥·ä½“">HTML æ ·å¼å®ä¾‹ - å­—ä½“ã€é¢œè‰²å’Œå°ºå¯¸</h4><blockquote><p>font-familyã€color ä»¥åŠ font-size å±æ€§åˆ†åˆ«å®šä¹‰å…ƒç´ ä¸­æ–‡æœ¬çš„å­—ä½“ç³»åˆ—ã€é¢œè‰²å’Œå­—ä½“å°ºå¯¸ï¼š</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1 style=&quot;font-family:verdana&quot;&gt;A heading&lt;/h1&gt;</span><br><span class="line">&lt;p style=&quot;font-family:arial;color:red;font-size:20px;&quot;&gt;A paragraph.&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h5 style="text-align:center;color:green;font-size:30px;font-family:åæ–‡æ¥·ä½“">HTML æ ·å¼å®ä¾‹ - æ–‡æœ¬å¯¹é½</h5>                    <blockquote><p>text-align å±æ€§è§„å®šäº†å…ƒç´ ä¸­æ–‡æœ¬çš„æ°´å¹³å¯¹é½æ–¹å¼ï¼š</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1 style=&quot;text-align:center&quot;&gt;This is a heading&lt;/h1&gt;</span><br><span class="line">&lt;p&gt;The heading above is aligned to the center of this page.&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h1 style="text-align:center;font-size:60px;">HTML æ–‡æœ¬æ ¼å¼åŒ–</h1><blockquote><p>HTML å¯å®šä¹‰å¾ˆå¤šä¾›æ ¼å¼åŒ–è¾“å‡ºçš„å…ƒç´ ï¼Œæ¯”å¦‚ç²—ä½“å’Œæ–œä½“å­—ã€‚</p></blockquote><h2 style="text-align:center;font-size:30px;font-family:åæ–‡æ¥·ä½“;color:red">æ–‡æœ¬é£æ ¼åŒ–</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;b&gt;This text is bold&lt;/b&gt;</span><br><span class="line"></span><br><span class="line">&lt;br /&gt;</span><br><span class="line"></span><br><span class="line">&lt;strong&gt;This text is strong&lt;/strong&gt;</span><br><span class="line"></span><br><span class="line">&lt;br /&gt;</span><br><span class="line"></span><br><span class="line">&lt;big&gt;This text is big&lt;/big&gt;</span><br><span class="line"></span><br><span class="line">&lt;br /&gt;</span><br><span class="line"></span><br><span class="line">&lt;em&gt;This text is emphasized&lt;/em&gt;</span><br><span class="line"></span><br><span class="line">&lt;br /&gt;</span><br><span class="line"></span><br><span class="line">&lt;i&gt;This text is italic&lt;/i&gt;</span><br><span class="line"></span><br><span class="line">&lt;br /&gt;</span><br><span class="line"></span><br><span class="line">&lt;small&gt;This text is small&lt;/small&gt;</span><br><span class="line"></span><br><span class="line">&lt;br /&gt;</span><br><span class="line"></span><br><span class="line">This text contains</span><br><span class="line">&lt;sub&gt;subscript&lt;/sub&gt;</span><br><span class="line"></span><br><span class="line">&lt;br /&gt;</span><br></pre></td></tr></table></figure><h3 style="text-align:center;font-size:30px;color:red;font-family:åæ–‡æ¥·ä½“">é¢„æ ¼å¼æ–‡æœ¬</h3>    <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">    &lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;pre&gt;</span><br><span class="line">è¿™æ˜¯</span><br><span class="line">é¢„æ ¼å¼æ–‡æœ¬ã€‚</span><br><span class="line">å®ƒä¿ç•™äº†      ç©ºæ ¼</span><br><span class="line">å’Œæ¢è¡Œã€‚</span><br><span class="line">&lt;/pre&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;pre æ ‡ç­¾å¾ˆé€‚åˆæ˜¾ç¤ºè®¡ç®—æœºä»£ç ï¼š&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;pre&gt;</span><br><span class="line">for i = 1 to 10</span><br><span class="line">     print i</span><br><span class="line">next i</span><br><span class="line">&lt;/pre&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h4 style="text-align:center;font-size:30px;color:red;font-family:åæ–‡æ¥·ä½“">â€œè®¡ç®—æœºè¾“å‡ºâ€æ ‡ç­¾</h4>    <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;code&gt;Computer code&lt;/code&gt;</span><br><span class="line">&lt;br /&gt;</span><br><span class="line">&lt;kbd&gt;Keyboard input&lt;/kbd&gt;</span><br><span class="line">&lt;br /&gt;</span><br><span class="line">&lt;tt&gt;Teletype text&lt;/tt&gt;</span><br><span class="line">&lt;br /&gt;</span><br><span class="line">&lt;samp&gt;Sample text&lt;/samp&gt;</span><br><span class="line">&lt;br /&gt;</span><br><span class="line">&lt;var&gt;Computer variable&lt;/var&gt;</span><br><span class="line">&lt;br /&gt;</span><br><span class="line">&lt;p&gt;</span><br><span class="line">&lt;b&gt;æ³¨é‡Šï¼š&lt;/b&gt;è¿™äº›æ ‡ç­¾å¸¸ç”¨äºæ˜¾ç¤ºè®¡ç®—æœº/ç¼–ç¨‹ä»£ç ã€‚</span><br><span class="line">&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h5 style="text-align:center;font-size:30px;color:red;font-family:åæ–‡æ¥·ä½“">åœ°å€</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;address&gt;</span><br><span class="line">Written by &lt;a href=&quot;mailto:webmaster@example.com&quot;&gt;Donald Duck&lt;/a&gt;.&lt;br&gt; </span><br><span class="line">Visit us at:&lt;br&gt;</span><br><span class="line">Example.com&lt;br&gt;</span><br><span class="line">Box 564, Disneyland&lt;br&gt;</span><br><span class="line">USA</span><br><span class="line">&lt;/address&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h5 style="text-align:center;font-size:30px;color:red;font-family:åæ–‡æ¥·ä½“">ç¼©å†™å’Œé¦–å­—æ¯ç¼©å†™</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HTML &lt;abbr&gt; å…ƒç´ å®šä¹‰ç¼©å†™æˆ–é¦–å­—æ¯ç¼©ç•¥è¯­ã€‚</span><br><span class="line"></span><br><span class="line">å¯¹ç¼©å†™è¿›è¡Œæ ‡è®°èƒ½å¤Ÿä¸ºæµè§ˆå™¨ã€ç¿»è¯‘ç³»ç»Ÿä»¥åŠæœç´¢å¼•æ“æä¾›æœ‰ç”¨çš„ä¿¡æ¯ã€‚</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;abbr title=&quot;etcetera&quot;&gt;etc.&lt;/abbr&gt;</span><br><span class="line">&lt;br /&gt;</span><br><span class="line">&lt;acronym title=&quot;World Wide Web&quot;&gt;WWW&lt;/acronym&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;åœ¨æŸäº›æµè§ˆå™¨ä¸­ï¼Œå½“æ‚¨æŠŠé¼ æ ‡ç§»è‡³ç¼©ç•¥è¯è¯­ä¸Šæ—¶ï¼Œtitle å¯ç”¨äºå±•ç¤ºè¡¨è¾¾çš„å®Œæ•´ç‰ˆæœ¬ã€‚&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;ä»…å¯¹äº IE 5 ä¸­çš„ acronym å…ƒç´ æœ‰æ•ˆã€‚&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;å¯¹äº Netscape 6.2 ä¸­çš„ abbr å’Œ acronym å…ƒç´ éƒ½æœ‰æ•ˆã€‚&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h6 style="text-align:center;font-size:30px;color:red;font-family:åæ–‡æ¥·ä½“">æ–‡å­—æ–¹å‘</h6><blockquote><p>bdo:dir&#x3D;ltrï¼ˆä»å·¦åˆ°å³è¾“å‡ºï¼‰,rtlï¼ˆä»å³åˆ°å·¦è¾“å‡ºï¼‰å¿…éœ€ã€‚è§„å®š <bdo> å…ƒç´ å†…æ–‡æœ¬çš„æ–‡æœ¬æ–¹å‘ã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;</span><br><span class="line">å¦‚æœæ‚¨çš„æµè§ˆå™¨æ”¯æŒ bi-directional override (bdo)ï¼Œä¸‹ä¸€è¡Œä¼šä»å³å‘å·¦è¾“å‡º (rtl)ï¼›</span><br><span class="line">&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;bdo dir=&quot;rtl&quot;&gt;</span><br><span class="line">Here is some Hebrew text</span><br><span class="line">&lt;/bdo&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h6 style="text-align:center;font-size:30px;color:red;font-family:åæ–‡æ¥·ä½“">å¿«å¼•ç”¨</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">HTML &lt;blockquote&gt; å…ƒç´ å®šä¹‰è¢«å¼•ç”¨çš„èŠ‚ã€‚</span><br><span class="line">æµè§ˆå™¨é€šå¸¸ä¼šå¯¹ &lt;blockquote&gt; å…ƒç´ è¿›è¡Œç¼©è¿›å¤„ç†ã€‚</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">è¿™æ˜¯é•¿çš„å¼•ç”¨ï¼š</span><br><span class="line">&lt;blockquote&gt;</span><br><span class="line">è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚è¿™æ˜¯é•¿çš„å¼•ç”¨ã€‚</span><br><span class="line">&lt;/blockquote&gt;</span><br><span class="line"></span><br><span class="line">è¿™æ˜¯çŸ­çš„å¼•ç”¨ï¼š</span><br><span class="line">&lt;q&gt;</span><br><span class="line">è¿™æ˜¯çŸ­çš„å¼•ç”¨ã€‚</span><br><span class="line">&lt;/q&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;</span><br><span class="line">ä½¿ç”¨ blockquote å…ƒç´ çš„è¯ï¼Œæµè§ˆå™¨ä¼šæ’å…¥æ¢è¡Œå’Œå¤–è¾¹è·ï¼Œè€Œ q å…ƒç´ ä¸ä¼šæœ‰ä»»ä½•ç‰¹æ®Šçš„å‘ˆç°ã€‚</span><br><span class="line">&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h6 style="text-align:center;font-size:30px;color:red;font-family:åæ–‡æ¥·ä½“">åˆ é™¤å­—æ•ˆæœå’Œæ’å…¥å­—æ•ˆæœ</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;ä¸€æ‰“æœ‰ &lt;del&gt;äºŒå&lt;/del&gt; &lt;ins&gt;åäºŒ&lt;/ins&gt; ä»¶ã€‚&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;å¤§å¤šæ•°æµè§ˆå™¨ä¼šæ”¹å†™ä¸ºåˆ é™¤æ–‡æœ¬å’Œä¸‹åˆ’çº¿æ–‡æœ¬ã€‚&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;p&gt;ä¸€äº›è€å¼çš„æµè§ˆå™¨ä¼šæŠŠåˆ é™¤æ–‡æœ¬å’Œä¸‹åˆ’çº¿æ–‡æœ¬æ˜¾ç¤ºä¸ºæ™®é€šæ–‡æœ¬ã€‚&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> HTMLåŸºç¡€ </category>
          
          <category> Visual Studio Code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Visual Studio Code </tag>
            
            <tag> HTML </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¤è¯†HTMLï¼ŒHTMLåŸºæœ¬ä½¿ç”¨</title>
      <link href="/2024/12/23/html/%E8%AE%A4%E8%AF%86html/"/>
      <url>/2024/12/23/html/%E8%AE%A4%E8%AF%86html/</url>
      
        <content type="html"><![CDATA[<h1 id="å…¥é—¨HTML"><a href="#å…¥é—¨HTML" class="headerlink" title="å…¥é—¨HTML"></a>å…¥é—¨HTML</h1><h2 id="åœ¨VSCodeåˆ›å»ºHTMLæ–‡ä»¶"><a href="#åœ¨VSCodeåˆ›å»ºHTMLæ–‡ä»¶" class="headerlink" title="åœ¨VSCodeåˆ›å»ºHTMLæ–‡ä»¶"></a>åœ¨VSCodeåˆ›å»ºHTMLæ–‡ä»¶</h2><h3 id="æ‰“å¼€-VSCodeï¼š"><a href="#æ‰“å¼€-VSCodeï¼š" class="headerlink" title="æ‰“å¼€ VSCodeï¼š"></a>æ‰“å¼€ VSCodeï¼š</h3><blockquote><p>å¦‚æœä½ è¿˜æ²¡æœ‰æ‰“å¼€ VSCodeï¼Œé¦–å…ˆå¯åŠ¨å®ƒã€‚</p></blockquote><h3 id="åˆ›å»ºæ–°æ–‡ä»¶ï¼š"><a href="#åˆ›å»ºæ–°æ–‡ä»¶ï¼š" class="headerlink" title="åˆ›å»ºæ–°æ–‡ä»¶ï¼š"></a>åˆ›å»ºæ–°æ–‡ä»¶ï¼š</h3><blockquote><p>ä½ å¯ä»¥é€šè¿‡ç‚¹å‡»ç•Œé¢å·¦ä¸Šè§’çš„â€œæ–‡ä»¶â€èœå•ï¼Œç„¶åé€‰æ‹©â€œæ–°å»ºæ–‡ä»¶â€æ¥åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ã€‚<br>æˆ–è€…ï¼Œä½ å¯ä»¥ä½¿ç”¨å¿«æ·é”® Ctrl + Nï¼ˆåœ¨ Windows&#x2F;Linux ä¸Šï¼‰æˆ– Cmd + Nï¼ˆåœ¨ macOS ä¸Šï¼‰æ¥å¿«é€Ÿåˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ã€‚</p></blockquote><h3 id="ä¿å­˜æ–‡ä»¶ä¸º-HTMLï¼š"><a href="#ä¿å­˜æ–‡ä»¶ä¸º-HTMLï¼š" class="headerlink" title="ä¿å­˜æ–‡ä»¶ä¸º HTMLï¼š"></a>ä¿å­˜æ–‡ä»¶ä¸º HTMLï¼š</h3><blockquote><p>åœ¨åˆ›å»ºæ–°æ–‡ä»¶åï¼Œä½ éœ€è¦ä¿å­˜å®ƒã€‚ç‚¹å‡»ç•Œé¢å·¦ä¸Šè§’çš„â€œæ–‡ä»¶â€èœå•ï¼Œç„¶åé€‰æ‹©â€œä¿å­˜â€æˆ–è€…ä½¿ç”¨å¿«æ·é”® Ctrl + Sï¼ˆåœ¨ Windows&#x2F;Linux ä¸Šï¼‰æˆ– Cmd + Sï¼ˆåœ¨ macOS ä¸Šï¼‰ã€‚<br>åœ¨å¼¹å‡ºçš„ä¿å­˜å¯¹è¯æ¡†ä¸­ï¼Œé€‰æ‹©ä½ æƒ³è¦ä¿å­˜æ–‡ä»¶çš„ä½ç½®ï¼Œç„¶ååœ¨æ–‡ä»¶åè¾“å…¥æ¡†ä¸­è¾“å…¥æ–‡ä»¶åï¼Œç¡®ä¿æ–‡ä»¶åä»¥ .html ç»“å°¾ï¼ˆä¾‹å¦‚ï¼Œexample.htmlï¼‰ã€‚</p></blockquote><h3 id="å¼€å§‹ç¼–å†™-HTMLï¼š"><a href="#å¼€å§‹ç¼–å†™-HTMLï¼š" class="headerlink" title="å¼€å§‹ç¼–å†™ HTMLï¼š"></a>å¼€å§‹ç¼–å†™ HTMLï¼š</h3><blockquote><p>ä¸€æ—¦æ–‡ä»¶è¢«ä¿å­˜ä¸º HTML æ–‡ä»¶ï¼Œä½ å°±å¯ä»¥å¼€å§‹ç¼–å†™ HTML ä»£ç äº†ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªåŸºæœ¬çš„ HTML é¡µé¢ç»“æ„å¦‚ä¸‹ï¼š</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, World!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨-HTML-æ¨¡æ¿ï¼š"><a href="#ä½¿ç”¨-HTML-æ¨¡æ¿ï¼š" class="headerlink" title="ä½¿ç”¨ HTML æ¨¡æ¿ï¼š"></a>ä½¿ç”¨ HTML æ¨¡æ¿ï¼š</h3><blockquote><p>VSCode æ”¯æŒé€šè¿‡å¿«æ·æ–¹å¼åˆ›å»ºæ–‡ä»¶æ¨¡æ¿ã€‚ä½ å¯ä»¥å®‰è£…ä¸€ä¸ªåä¸º â€œHTML Snippetsâ€ çš„æ‰©å±•æ¥å¿«é€Ÿç”Ÿæˆ HTML æ–‡ä»¶çš„åŸºæœ¬ç»“æ„ã€‚</p></blockquote><h3 id="ä¿å­˜å¹¶é¢„è§ˆï¼š"><a href="#ä¿å­˜å¹¶é¢„è§ˆï¼š" class="headerlink" title="ä¿å­˜å¹¶é¢„è§ˆï¼š"></a>ä¿å­˜å¹¶é¢„è§ˆï¼š</h3><blockquote><p>ç¼–å†™å®Œ HTML ä»£ç åï¼Œä¿å­˜æ–‡ä»¶ã€‚ä½ å¯ä»¥é€šè¿‡å³é”®ç‚¹å‡»ç¼–è¾‘å™¨ä¸­çš„æ–‡ä»¶å¹¶é€‰æ‹©â€œåœ¨æµè§ˆå™¨ä¸­æ‰“å¼€â€æ¥é¢„è§ˆä½ çš„ HTML é¡µé¢ï¼Œæˆ–è€…ç›´æ¥ä½¿ç”¨æµè§ˆå™¨æ‰“å¼€ä¿å­˜çš„ HTML æ–‡ä»¶ã€‚</p></blockquote><h1 id="HTMLåŸºç¡€æ ‡ç­¾"><a href="#HTMLåŸºç¡€æ ‡ç­¾" class="headerlink" title="HTMLåŸºç¡€æ ‡ç­¾"></a>HTMLåŸºç¡€æ ‡ç­¾</h1><p><img src="/img%5Cyouxin%5Chtmljc.png"></p><h1 id="HTMLåŸºç¡€å±æ€§"><a href="#HTMLåŸºç¡€å±æ€§" class="headerlink" title="HTMLåŸºç¡€å±æ€§"></a>HTMLåŸºç¡€å±æ€§</h1><p><img src="/img%5Cyouxin%5Chtmlsx.png"></p>]]></content>
      
      
      <categories>
          
          <category> HTMLåŸºç¡€ </category>
          
          <category> Visual Studio Code </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Visual Studio Code </tag>
            
            <tag> HTML </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Csharpä»€ä¹ˆæ˜¯å§”æ‰˜</title>
      <link href="/2024/12/14/csharp%E5%A7%94%E6%89%98/"/>
      <url>/2024/12/14/csharp%E5%A7%94%E6%89%98/</url>
      
        <content type="html"><![CDATA[<h1 id="Csharpä»€ä¹ˆæ˜¯å§”æ‰˜"><a href="#Csharpä»€ä¹ˆæ˜¯å§”æ‰˜" class="headerlink" title="Csharpä»€ä¹ˆæ˜¯å§”æ‰˜"></a>Csharpä»€ä¹ˆæ˜¯å§”æ‰˜</h1><p>1.åœ¨C#ä¸­ï¼Œå§”æ‰˜ï¼ˆDelegateï¼‰æ˜¯ä¸€ç§ç‰¹æ®Šçš„ç±»å‹ï¼Œå®ƒå®šä¹‰äº†æ–¹æ³•çš„ç±»å‹ï¼Œä½¿å¾—å¯ä»¥å°†æ–¹æ³•ä½œä¸ºå‚æ•°ä¼ é€’ï¼Œæˆ–è€…å°†å…¶èµ‹å€¼ç»™å˜é‡ã€‚å§”æ‰˜æ˜¯å®ç°äº‹ä»¶å’Œå›è°ƒæ–¹æ³•çš„åŸºç¡€ã€‚å®ƒä»¬ä½¿å¾—å°†æ–¹æ³•ä½œä¸ºå¯¹è±¡è¿›è¡Œæ“ä½œæˆä¸ºå¯èƒ½ï¼Œè¿™åœ¨å¼‚æ­¥ç¼–ç¨‹ã€äº‹ä»¶å¤„ç†å’Œå›è°ƒæ–¹æ³•ä¸­éå¸¸æœ‰ç”¨ã€‚</p><p>2.å§”æ‰˜çš„åŸºæœ¬è¯­æ³•</p><blockquote><p>å§”æ‰˜çš„å®šä¹‰ç±»ä¼¼äºæ¥å£ï¼Œä½†å®ƒä¸“é—¨ç”¨äºæ–¹æ³•ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå§”æ‰˜çš„åŸºæœ¬å®šä¹‰ï¼š</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">delegate</span> <span class="built_in">int</span> <span class="title">Operation</span>(<span class="params"><span class="built_in">int</span> x, <span class="built_in">int</span> y</span>)</span>;</span><br></pre></td></tr></table></figure><blockquote><p>è¿™ä¸ªOperationå§”æ‰˜ç±»å‹å¯ä»¥æŒæœ‰ä»»ä½•æ¥å—ä¸¤ä¸ªintå‚æ•°å¹¶è¿”å›ä¸€ä¸ªintçš„æ–¹æ³•ã€‚</p></blockquote><p>3.ä½¿ç”¨å§”æ‰˜</p><blockquote><p>å®šä¹‰å§”æ‰˜ï¼šé¦–å…ˆå®šä¹‰ä¸€ä¸ªå§”æ‰˜ç±»å‹ã€‚<br>å®ä¾‹åŒ–å§”æ‰˜ï¼šåˆ›å»ºå§”æ‰˜çš„å®ä¾‹ï¼Œå¹¶å°†å…¶ä¸å…·ä½“çš„æ–¹æ³•å…³è”ã€‚<br>è°ƒç”¨å§”æ‰˜ï¼šé€šè¿‡å§”æ‰˜å®ä¾‹è°ƒç”¨æ–¹æ³•ã€‚</p></blockquote><h2 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰å§”æ‰˜</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">delegate</span> <span class="built_in">int</span> <span class="title">Operation</span>(<span class="params"><span class="built_in">int</span> x, <span class="built_in">int</span> y</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®ç°å§”æ‰˜çš„æ–¹æ³•</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MathOperations</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">Add</span>(<span class="params"><span class="built_in">int</span> x, <span class="built_in">int</span> y</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> x + y;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">Subtract</span>(<span class="params"><span class="built_in">int</span> x, <span class="built_in">int</span> y</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> x - y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        MathOperations math = <span class="keyword">new</span> MathOperations();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å®ä¾‹åŒ–å§”æ‰˜</span></span><br><span class="line">        Operation op = <span class="keyword">new</span> Operation(math.Add);</span><br><span class="line">        <span class="built_in">int</span> result = op(<span class="number">5</span>, <span class="number">3</span>); <span class="comment">// è°ƒç”¨å§”æ‰˜ï¼Œç­‰åŒäºmath.Add(5, 3)</span></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Add: &quot;</span> + result);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ”¹å˜å§”æ‰˜å…³è”çš„æ–¹æ³•</span></span><br><span class="line">        op = math.Subtract;</span><br><span class="line">        result = op(<span class="number">5</span>, <span class="number">3</span>); <span class="comment">// è°ƒç”¨å§”æ‰˜ï¼Œç­‰åŒäºmath.Subtract(5, 3)</span></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Subtract: &quot;</span> + result);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4.å¤šæ’­å§”æ‰˜</p><blockquote><p>C#ä¸­çš„å§”æ‰˜è¿˜æ”¯æŒå¤šæ’­ï¼Œå³ä¸€ä¸ªå§”æ‰˜å¯ä»¥å…³è”å¤šä¸ªæ–¹æ³•ã€‚å½“å§”æ‰˜è¢«è°ƒç”¨æ—¶ï¼Œå…³è”çš„æ‰€æœ‰æ–¹æ³•éƒ½ä¼šæŒ‰é¡ºåºè¢«è°ƒç”¨ã€‚</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">delegate</span> <span class="keyword">void</span> <span class="title">HelloDelegate</span>(<span class="params"><span class="built_in">string</span> name</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Greeting</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Hello</span>(<span class="params"><span class="built_in">string</span> name</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Hello, &quot;</span> + name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Goodbye</span>(<span class="params"><span class="built_in">string</span> name</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Goodbye, &quot;</span> + name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        HelloDelegate hello = <span class="keyword">new</span> HelloDelegate(<span class="keyword">new</span> Greeting().Hello);</span><br><span class="line">        hello += <span class="keyword">new</span> Greeting().Goodbye; <span class="comment">// æ·»åŠ å¦ä¸€ä¸ªæ–¹æ³•</span></span><br><span class="line"></span><br><span class="line">        hello(<span class="string">&quot;World&quot;</span>); <span class="comment">// è¾“å‡º: Hello, World å’Œ Goodbye, World</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>5.å§”æ‰˜ä¸äº‹ä»¶</p><blockquote><p>å§”æ‰˜æ˜¯å®ç°äº‹ä»¶çš„åŸºç¡€ã€‚åœ¨C#ä¸­ï¼Œäº‹ä»¶æ˜¯ä¸€ç§ç‰¹æ®Šçš„å¤šæ’­å§”æ‰˜ï¼Œç”¨äºå‘å¸ƒè®¢é˜…æ¨¡å¼ï¼Œå…è®¸å¯¹è±¡é€šçŸ¥å…¶ä»–å¯¹è±¡å‘ç”Ÿäº†æŸä¸ªäº‹ä»¶ã€‚</p></blockquote><p>6.æ€»ç»“</p><blockquote><p>å§”æ‰˜æä¾›äº†ä¸€ç§å°†æ–¹æ³•ä½œä¸ºå‚æ•°ä¼ é€’çš„å¼ºå¤§æœºåˆ¶ï¼Œå®ƒä»¬æ˜¯å®ç°å›è°ƒã€äº‹ä»¶å’Œå¼‚æ­¥ç¼–ç¨‹çš„å…³é”®ã€‚é€šè¿‡å§”æ‰˜ï¼Œä½ å¯ä»¥ç¼–å†™æ›´åŠ çµæ´»å’ŒåŠ¨æ€çš„ä»£ç ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Csharp </tag>
            
            <tag> Visual Studio 2022 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Csharpæšä¸¾ç±»å‹å­¦ä¹ ç¬”è®°</title>
      <link href="/2024/12/14/csharp%E6%9E%9A%E4%B8%BE%E7%B1%BB%E5%9E%8B/"/>
      <url>/2024/12/14/csharp%E6%9E%9A%E4%B8%BE%E7%B1%BB%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="Csharpæšä¸¾ç±»å‹"><a href="#Csharpæšä¸¾ç±»å‹" class="headerlink" title="Csharpæšä¸¾ç±»å‹"></a>Csharpæšä¸¾ç±»å‹</h1><p>1.C# ä¸­çš„æšä¸¾ï¼ˆEnumï¼‰æ˜¯ä¸€ç§ç‰¹æ®Šçš„å€¼ç±»å‹ï¼Œå®ƒå…è®¸ä½ ä¸ºä¸€ç»„ç›¸å…³çš„å¸¸é‡å®šä¹‰ä¸€ä¸ªåç§°ã€‚æšä¸¾æ˜¯ä¸€ç§å¼ºç±»å‹çš„å¸¸é‡é›†åˆï¼Œè¿™æ„å‘³ç€æ¯ä¸ªæšä¸¾æˆå‘˜éƒ½æœ‰ä¸€ä¸ªåç§°å’Œä¸€ä¸ªåº•å±‚çš„æ•´æ•°å€¼ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œç¬¬ä¸€ä¸ªæšä¸¾æˆå‘˜çš„å€¼æ˜¯0ï¼Œæ¯ä¸ªéšåçš„æˆå‘˜çš„å€¼æ¯”å‰ä¸€ä¸ªæˆå‘˜çš„å€¼å¤§1ã€‚</p><p>2.ä¸‹é¢æ˜¯æšä¸¾çš„ä¸€äº›åŸºæœ¬ç”¨æ³•ï¼š</p><blockquote><p>å®šä¹‰æšä¸¾</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="built_in">enum</span> DaysOfWeek</span><br><span class="line">&#123;</span><br><span class="line">    Sunday,</span><br><span class="line">    Monday,</span><br><span class="line">    Tuesday,</span><br><span class="line">    Wednesday,</span><br><span class="line">    Thursday,</span><br><span class="line">    Friday,</span><br><span class="line">    Saturday</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ä½¿ç”¨æšä¸¾</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DaysOfWeek today = DaysOfWeek.Friday;</span><br><span class="line">Console.WriteLine(today); <span class="comment">// è¾“å‡ºï¼šFriday</span></span><br></pre></td></tr></table></figure><blockquote><p>è®¿é—®æšä¸¾æˆå‘˜çš„å€¼</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> dayValue = (<span class="built_in">int</span>)today;</span><br><span class="line">Console.WriteLine(dayValue); <span class="comment">// è¾“å‡ºï¼š4</span></span><br></pre></td></tr></table></figure><blockquote><p>æšä¸¾çš„åº•å±‚ç±»å‹<br>ä½ å¯ä»¥æŒ‡å®šæšä¸¾çš„åº•å±‚ç±»å‹ï¼Œæ¯”å¦‚ byteã€sbyteã€shortã€ushortã€intã€uintã€long æˆ– ulongã€‚å¦‚æœä¸æŒ‡å®šï¼Œé»˜è®¤æ˜¯ intã€‚</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="built_in">enum</span> DaysOfWeek : <span class="built_in">byte</span></span><br><span class="line">&#123;</span><br><span class="line">    Sunday,</span><br><span class="line">    Monday,</span><br><span class="line">    Tuesday,</span><br><span class="line">    Wednesday,</span><br><span class="line">    Thursday,</span><br><span class="line">    Friday,</span><br><span class="line">    Saturday</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æšä¸¾æˆå‘˜çš„æ˜¾å¼å€¼<br>ä½ ä¹Ÿå¯ä»¥ä¸ºæšä¸¾æˆå‘˜æŒ‡å®šæ˜¾å¼çš„å€¼ã€‚</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="built_in">enum</span> DaysOfWeek</span><br><span class="line">&#123;</span><br><span class="line">    Sunday = <span class="number">1</span>,</span><br><span class="line">    Monday = <span class="number">2</span>,</span><br><span class="line">    Tuesday = <span class="number">3</span>,</span><br><span class="line">    Wednesday = <span class="number">4</span>,</span><br><span class="line">    Thursday = <span class="number">5</span>,</span><br><span class="line">    Friday = <span class="number">6</span>,</span><br><span class="line">    Saturday = <span class="number">7</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æšä¸¾ä¸switchè¯­å¥<br>æšä¸¾ç±»å‹ç»å¸¸ä¸ switch è¯­å¥ä¸€èµ·ä½¿ç”¨ã€‚</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> (today)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">case</span> DaysOfWeek.Sunday:</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Sunday is the first day of the week.&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> DaysOfWeek.Monday:</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Monday is the second day of the week.&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="comment">// ... å…¶ä»–æƒ…å†µ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ£€æŸ¥æšä¸¾æˆå‘˜æ˜¯å¦å­˜åœ¨<br>ä½ å¯ä»¥ä½¿ç”¨ Enum.IsDefined æ–¹æ³•æ¥æ£€æŸ¥ä¸€ä¸ªå€¼æ˜¯å¦æ˜¯æšä¸¾ä¸­çš„ä¸€ä¸ªæœ‰æ•ˆæˆå‘˜ã€‚</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">bool</span> isDefined = Enum.IsDefined(<span class="keyword">typeof</span>(DaysOfWeek), <span class="number">8</span>);</span><br><span class="line">Console.WriteLine(isDefined); <span class="comment">// è¾“å‡ºï¼šFalse</span></span><br></pre></td></tr></table></figure><blockquote><p>æšä¸¾æ˜¯C#ä¸­ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„åŠŸèƒ½ï¼Œå®ƒå¯ä»¥è®©ä½ çš„ä»£ç æ›´åŠ æ¸…æ™°å’Œæ˜“äºç»´æŠ¤ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Csharp </tag>
            
            <tag> Visual Studio 2022 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Csharpç»“æ„ä½“ä»‹ç»åŠä½¿ç”¨å­¦ä¹ ç¬”è®°</title>
      <link href="/2024/12/14/csharp%E7%BB%93%E6%9E%84%E4%BD%93/"/>
      <url>/2024/12/14/csharp%E7%BB%93%E6%9E%84%E4%BD%93/</url>
      
        <content type="html"><![CDATA[<h1 id="Csharpç»“æ„ä½“ä»‹ç»"><a href="#Csharpç»“æ„ä½“ä»‹ç»" class="headerlink" title="Csharpç»“æ„ä½“ä»‹ç»"></a>Csharpç»“æ„ä½“ä»‹ç»</h1><p>1.åœ¨C#ä¸­ï¼Œç»“æ„ä½“æ˜¯ä¸€ç§å€¼ç±»å‹ï¼Œç”¨äºå°è£…å°‘é‡çš„æ•°æ®ã€‚ç»“æ„ä½“ä½¿ç”¨ struct å…³é”®å­—å®šä¹‰ï¼Œå¹¶ä¸”å¯ä»¥åŒ…å«æ•°æ®å­—æ®µã€æ–¹æ³•ã€å±æ€§ã€ç´¢å¼•å™¨ã€è¿ç®—ç¬¦é‡è½½å’Œæ„é€ å‡½æ•°ã€‚ç»“æ„ä½“ä¸èƒ½ç»§æ‰¿å…¶ä»–çš„ç»“æ„ä½“æˆ–ç±»ï¼Œä¹Ÿä¸èƒ½è¢«å…¶ä»–ç»“æ„ä½“æˆ–ç±»ç»§æ‰¿ã€‚ä»¥ä¸‹æ˜¯ç»“æ„ä½“çš„ä¸€äº›åŸºæœ¬ç‰¹æ€§ï¼š</p><p>2.å®šä¹‰ç»“æ„ä½“ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> Point</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> X;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Y;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Point</span>(<span class="params"><span class="built_in">int</span> x, <span class="built_in">int</span> y</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        X = x;</span><br><span class="line">        Y = y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3.å®ä¾‹åŒ–ç»“æ„ä½“ï¼š</p><blockquote><p>ç»“æ„ä½“å¯ä»¥é€šè¿‡ç›´æ¥å£°æ˜æˆ–ä½¿ç”¨ new å…³é”®å­—æ¥å®ä¾‹åŒ–ã€‚</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Point p1 = <span class="keyword">new</span> Point();</span><br><span class="line">Point p2 = <span class="keyword">new</span> Point(<span class="number">10</span>, <span class="number">20</span>);</span><br></pre></td></tr></table></figure><p>4.ç»“æ„ä½“æ˜¯å€¼ç±»å‹ï¼š</p><blockquote><p>ç»“æ„ä½“æ˜¯å€¼ç±»å‹ï¼Œæ‰€ä»¥å½“å®ƒä»¬è¢«èµ‹å€¼ç»™å¦ä¸€ä¸ªå˜é‡æ—¶ï¼Œå®ƒä»¬çš„å€¼ä¼šè¢«å¤åˆ¶ã€‚</p></blockquote><p>5.æ–¹æ³•å’Œå±æ€§ï¼š</p><blockquote><p>ç»“æ„ä½“å¯ä»¥åŒ…å«æ–¹æ³•å’Œå±æ€§ï¼Œå°±åƒç±»ä¸€æ ·ã€‚</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> Rectangle</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Length;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Width;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> Area</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123; <span class="keyword">return</span> Length * Width; &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">PrintArea</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;Area: <span class="subst">&#123;Area&#125;</span>&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>6.è¿ç®—ç¬¦é‡è½½ï¼š</p><blockquote><p>ç»“æ„ä½“å¯ä»¥é‡è½½è¿ç®—ç¬¦ï¼Œä»¥æä¾›è‡ªå®šä¹‰çš„æ“ä½œã€‚</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> Vector</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> X;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">double</span> Y;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Vector <span class="keyword">operator</span> +(Vector a, Vector b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Vector(a.X + b.X, a.Y + b.Y);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>7.ç»“æ„ä½“ä¸ç±»çš„åŒºåˆ«ï¼š</p><blockquote><p>ç»“æ„ä½“æ˜¯å€¼ç±»å‹ï¼Œè€Œç±»æ˜¯å¼•ç”¨ç±»å‹ã€‚<br>ç»“æ„ä½“é»˜è®¤ç»§æ‰¿è‡ª System.ValueTypeï¼Œè€Œç±»é»˜è®¤ç»§æ‰¿è‡ª System.Objectã€‚<br>ç»“æ„ä½“ä¸èƒ½æœ‰ææ„å‡½æ•°ï¼Œè€Œç±»å¯ä»¥ã€‚<br>ç»“æ„ä½“ä¸èƒ½å®ç°æ¥å£ï¼Œè€Œç±»å¯ä»¥ã€‚</p></blockquote><p>8.è£…ç®±å’Œæ‹†ç®±ï¼š</p><blockquote><p>å½“ç»“æ„ä½“è¢«èµ‹å€¼ç»™ä¸€ä¸ªå¯¹è±¡ç±»å‹ï¼ˆæ¯”å¦‚ object æˆ–æ¥å£ç±»å‹ï¼‰æ—¶ï¼Œä¼šå‘ç”Ÿè£…ç®±æ“ä½œï¼Œå°†å€¼ç±»å‹è½¬æ¢ä¸ºå¼•ç”¨ç±»å‹ã€‚ç›¸åçš„æ“ä½œç§°ä¸ºæ‹†ç®±ã€‚</p></blockquote><blockquote><p>ä½¿ç”¨ç»“æ„ä½“æ—¶ï¼Œé€šå¸¸æ˜¯ä¸ºäº†åˆ›å»ºè½»é‡çº§çš„ã€ä¸å¯å˜çš„æ•°æ®ç»“æ„ï¼Œæˆ–è€…å½“ä½ éœ€è¦ç¡®ä¿æ•°æ®è¢«å¤åˆ¶è€Œä¸æ˜¯å¼•ç”¨æ—¶ã€‚</p></blockquote><h1 id="Csharpç»“æ„ä½“å‡½æ•°"><a href="#Csharpç»“æ„ä½“å‡½æ•°" class="headerlink" title="Csharpç»“æ„ä½“å‡½æ•°"></a>Csharpç»“æ„ä½“å‡½æ•°</h1><p>1.åœ¨C#ä¸­ï¼Œç»“æ„ä½“ï¼ˆstructï¼‰æ˜¯ä¸€ç§å€¼ç±»å‹ï¼Œå®ƒå¯ä»¥ç”¨æ¥å®šä¹‰è½»é‡çº§çš„æ•°æ®ç»“æ„ã€‚ç»“æ„ä½“å¯ä»¥åŒ…å«æ•°æ®å­—æ®µã€å±æ€§ã€æ–¹æ³•å’Œæ„é€ å‡½æ•°ç­‰ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å…³äºC#ç»“æ„ä½“ä¸­å‡½æ•°çš„åŸºæœ¬ç¤ºä¾‹ï¼š</p><p>2.ç»“æ„ä½“å®šä¹‰</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> Point</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> X &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Y &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Point</span>(<span class="params"><span class="built_in">int</span> x, <span class="built_in">int</span> y</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        X = x;</span><br><span class="line">        Y = y;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">PrintCoordinates</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;(<span class="subst">&#123;X&#125;</span>, <span class="subst">&#123;Y&#125;</span>)&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‡å†™ToStringæ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="built_in">string</span> <span class="title">ToString</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">$&quot;Point(<span class="subst">&#123;X&#125;</span>, <span class="subst">&#123;Y&#125;</span>)&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3.ä½¿ç”¨ç»“æ„ä½“</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Point p = <span class="keyword">new</span> Point(<span class="number">10</span>, <span class="number">20</span>);</span><br><span class="line">p.PrintCoordinates(); <span class="comment">// è¾“å‡º: (10, 20)</span></span><br><span class="line">Console.WriteLine(p.ToString()); <span class="comment">// è¾“å‡º: Point(10, 20)</span></span><br></pre></td></tr></table></figure><p>4.ç»“æ„ä½“ä¸æ–¹æ³•</p><blockquote><p>æ„é€ å‡½æ•°ï¼šç”¨äºåˆå§‹åŒ–ç»“æ„ä½“çš„å­—æ®µã€‚<br>æ–¹æ³•ï¼šå¯ä»¥å®šä¹‰æ–¹æ³•æ¥æ‰§è¡Œç‰¹å®šçš„æ“ä½œï¼Œæ¯”å¦‚ä¸Šé¢çš„PrintCoordinatesæ–¹æ³•ã€‚<br>å±æ€§ï¼šä½¿ç”¨getå’Œsetå—æ¥å®šä¹‰å±æ€§ï¼Œå…è®¸å¤–éƒ¨ä»£ç ä»¥å±æ€§çš„æ–¹å¼è®¿é—®ç»“æ„ä½“çš„å­—æ®µã€‚<br>é‡å†™æ–¹æ³•ï¼šå¯ä»¥é‡å†™å¦‚ToStringç­‰æ–¹æ³•ï¼Œä»¥æä¾›ç»“æ„ä½“çš„è‡ªå®šä¹‰å­—ç¬¦ä¸²è¡¨ç¤ºã€‚</p></blockquote><p>5.ç»“æ„ä½“çš„å€¼ç±»å‹ç‰¹æ€§</p><blockquote><p>ç»“æ„ä½“æ˜¯å€¼ç±»å‹ï¼Œèµ‹å€¼å’Œå‚æ•°ä¼ é€’æ—¶ä¼šå¤åˆ¶æ•´ä¸ªç»“æ„ä½“ã€‚<br>ç»“æ„ä½“ä¸èƒ½è¢«ç»§æ‰¿ï¼Œä½†å¯ä»¥å®ç°æ¥å£ã€‚<br>ç»“æ„ä½“é»˜è®¤æœ‰Equalsã€GetHashCodeå’ŒToStringæ–¹æ³•ï¼Œä½†é€šå¸¸éœ€è¦æ ¹æ®éœ€è¦é‡å†™è¿™äº›æ–¹æ³•ã€‚</p></blockquote><p>6.ç»“æ„ä½“ä¸ç±»çš„åŒºåˆ«</p><blockquote><p>ç±»æ˜¯å¼•ç”¨ç±»å‹ï¼Œè€Œç»“æ„ä½“æ˜¯å€¼ç±»å‹ã€‚<br>ç±»å¯ä»¥ç»§æ‰¿å…¶ä»–ç±»ï¼Œè€Œç»“æ„ä½“ä¸èƒ½ç»§æ‰¿å…¶ä»–ç»“æ„ä½“æˆ–ç±»ã€‚<br>ç»“æ„ä½“çš„å­—æ®µé»˜è®¤ä¸ºprivateï¼Œè€Œç±»çš„å­—æ®µé»˜è®¤ä¸ºprivateã€‚</p></blockquote><blockquote><p>è¿™äº›æ˜¯C#ä¸­ç»“æ„ä½“å’Œå‡½æ•°çš„åŸºæœ¬ç”¨æ³•ã€‚æ ¹æ®å…·ä½“éœ€æ±‚ï¼Œä½ å¯ä»¥åœ¨ç»“æ„ä½“ä¸­å®šä¹‰æ›´å¤šå¤æ‚çš„é€»è¾‘å’Œæ–¹æ³•ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Csharp </tag>
            
            <tag> Visual Studio 2022 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Csharpé€’å½’çš„è°ƒç”¨ã€å¸¸é‡å­¦ä¹ ç¬”è®°</title>
      <link href="/2024/12/13/csharp%E9%80%92%E5%BD%92%E3%80%81%E5%B8%B8%E9%87%8F/"/>
      <url>/2024/12/13/csharp%E9%80%92%E5%BD%92%E3%80%81%E5%B8%B8%E9%87%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="Csharpé€’å½’å‡½æ•°ç»ƒä¹ "><a href="#Csharpé€’å½’å‡½æ•°ç»ƒä¹ " class="headerlink" title="Csharpé€’å½’å‡½æ•°ç»ƒä¹ "></a>Csharpé€’å½’å‡½æ•°ç»ƒä¹ </h1><h3 id="1-2ï¼-3ï¼-Â·Â·Â·-10ï¼"><a href="#1-2ï¼-3ï¼-Â·Â·Â·-10ï¼" class="headerlink" title="1+2ï¼+3ï¼+Â·Â·Â·+10ï¼"></a>1+2ï¼+3ï¼+Â·Â·Â·+10ï¼</h3><p>åˆ©ç”¨å¤šå°‘ä¸ªæ–¹æ³•è®¡ç®—ç»“æœ</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="built_in">int</span> <span class="title">F1</span>(<span class="params"><span class="built_in">int</span> n</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">int</span> result = n * F1(n - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="built_in">int</span> <span class="title">F2</span>(<span class="params"><span class="built_in">int</span> n</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(n == <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">int</span> result = F2(n - <span class="number">1</span>) + F1(n);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(F2(<span class="number">10</span>));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p> è¾“å‡ºç»“æœï¼š<br> <figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4037913</span></span><br></pre></td></tr></table></figure></p><h1 id="æœ‰å…³ç³»å¼1-1-2-2-3-3-Â·Â·Â·-K-K"><a href="#æœ‰å…³ç³»å¼1-1-2-2-3-3-Â·Â·Â·-K-K" class="headerlink" title="æœ‰å…³ç³»å¼1^1+2^2+3^3+Â·Â·Â·+K^K&lt;2000,ç¼–ä¸€ä¸ªç¨‹åºï¼Œæ±‚å‡ºæ»¡è¶³æ­¤å…³ç³»å¼çš„æœ€å¤§å€¼"></a>æœ‰å…³ç³»å¼1^1+2^2+3^3+Â·Â·Â·+K^K&lt;2000,ç¼–ä¸€ä¸ªç¨‹åºï¼Œæ±‚å‡ºæ»¡è¶³æ­¤å…³ç³»å¼çš„æœ€å¤§å€¼</h1><blockquote><p>åˆ©ç”¨é€’å½’å’Œå¾ªç¯è§£å†³è¿™ä¸ªé—®é¢˜</p></blockquote><p>1.å¾ªç¯ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span> k = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">int</span> result = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        result += k * k;</span><br><span class="line">        <span class="keyword">if</span> (result &gt;= <span class="number">2000</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        k++;</span><br><span class="line">    &#125;</span><br><span class="line">    Console.WriteLine(k - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">17</span></span><br></pre></td></tr></table></figure><p>2.é€’å½’ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="built_in">int</span> <span class="title">F</span>(<span class="params"><span class="built_in">int</span> n</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">int</span> result = F(n - <span class="number">1</span>) + n * n;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span> i = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(F(i) &gt;= <span class="number">2000</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">        Console.WriteLine(i - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p> è¾“å‡ºç»“æœï¼š<br> <figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">17</span></span><br></pre></td></tr></table></figure></p><h1 id="ä»€ä¹ˆæ˜¯å¸¸é‡"><a href="#ä»€ä¹ˆæ˜¯å¸¸é‡" class="headerlink" title="ä»€ä¹ˆæ˜¯å¸¸é‡"></a>ä»€ä¹ˆæ˜¯å¸¸é‡</h1><ol><li>åœ¨C#ä¸­ï¼Œå¸¸é‡æ˜¯ä¸€ç§ç‰¹æ®Šçš„å˜é‡ï¼Œå…¶å€¼åœ¨åˆå§‹åŒ–åä¸èƒ½è¢«æ”¹å˜ã€‚å¸¸é‡ç”¨äºå­˜å‚¨é‚£äº›åœ¨ç¨‹åºè¿è¡ŒæœŸé—´ä¸åº”è¯¥æ”¹å˜çš„æ•°æ®ã€‚</li><li>ä»¥ä¸‹æ˜¯C#ä¸­å¸¸é‡çš„å‡ ä¸ªå…³é”®ç‚¹ï¼š</li></ol><blockquote><p>å£°æ˜ï¼šä½¿ç”¨constå…³é”®å­—æ¥å£°æ˜å¸¸é‡ã€‚<br>ç±»å‹ï¼šå¸¸é‡å¿…é¡»æœ‰æ˜ç¡®çš„ç±»å‹ï¼Œé€šå¸¸æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œå¦‚intã€doubleã€stringç­‰ã€‚<br>åˆå§‹åŒ–ï¼šå¸¸é‡åœ¨å£°æ˜æ—¶å¿…é¡»è¢«åˆå§‹åŒ–ï¼Œä¸”ä¹‹åä¸èƒ½è¢«é‡æ–°èµ‹å€¼ã€‚<br>ä½œç”¨åŸŸï¼šå¸¸é‡çš„ä½œç”¨åŸŸå–å†³äºå…¶å£°æ˜çš„ä½ç½®ï¼Œå¯ä»¥æ˜¯å±€éƒ¨çš„ï¼ˆåœ¨æ–¹æ³•æˆ–ä»£ç å—ä¸­ï¼‰æˆ–å…¨å±€çš„ï¼ˆåœ¨ç±»æˆ–å‘½åç©ºé—´ä¸­ï¼‰ã€‚<br>ç¼–è¯‘æ—¶å¸¸æ•°ï¼šç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶ä¼šå°†å¸¸é‡çš„å€¼å†…åµŒåˆ°ä»£ç ä¸­ï¼Œè¿™æ„å‘³ç€å®ƒä»¬åœ¨è¿è¡Œæ—¶æ˜¯ä¸å¯å˜çš„ã€‚</p></blockquote><h3 id="ä¸‹é¢æ˜¯ä¸€ä¸ªC-ä¸­å£°æ˜å’Œä½¿ç”¨å¸¸é‡çš„ä¾‹å­ï¼š"><a href="#ä¸‹é¢æ˜¯ä¸€ä¸ªC-ä¸­å£°æ˜å’Œä½¿ç”¨å¸¸é‡çš„ä¾‹å­ï¼š" class="headerlink" title="ä¸‹é¢æ˜¯ä¸€ä¸ªC#ä¸­å£°æ˜å’Œä½¿ç”¨å¸¸é‡çš„ä¾‹å­ï¼š"></a>ä¸‹é¢æ˜¯ä¸€ä¸ªC#ä¸­å£°æ˜å’Œä½¿ç”¨å¸¸é‡çš„ä¾‹å­ï¼š</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ConstantsExample</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// å£°æ˜ä¸€ä¸ªå¸¸é‡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">const</span> <span class="built_in">int</span> MaxValue = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Display</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨å¸¸é‡</span></span><br><span class="line">        Console.WriteLine(<span class="string">&quot;The maximum value is: &quot;</span> + MaxValue);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        ConstantsExample example = <span class="keyword">new</span> ConstantsExample();</span><br><span class="line">        example.Display();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å°è¯•ä¿®æ”¹å¸¸é‡å€¼å°†å¯¼è‡´ç¼–è¯‘é”™è¯¯</span></span><br><span class="line">        <span class="comment">// ConstantsExample.MaxValue = 200; // é”™è¯¯ï¼šæ— æ³•å¯¹åªè¯»å­—æ®µâ€œConstantsExample.MaxValueâ€èµ‹å€¼</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒMaxValueæ˜¯ä¸€ä¸ªå¸¸é‡ï¼Œå®ƒè¢«å£°æ˜ä¸ºconstï¼Œå¹¶ä¸”åˆå§‹åŒ–ä¸º100ã€‚åœ¨Displayæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªå¸¸é‡æ¥æ‰“å°ä¿¡æ¯ã€‚å°è¯•ä¿®æ”¹MaxValueçš„å€¼å°†å¯¼è‡´ç¼–è¯‘é”™è¯¯ï¼Œå› ä¸ºå¸¸é‡åœ¨åˆå§‹åŒ–åä¸èƒ½è¢«æ”¹å˜ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Csharp </tag>
            
            <tag> Visual Studio 2022 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Csharpå‡½æ•°çš„é‡è½½å­¦ä¹ ç¬”è®°</title>
      <link href="/2024/12/12/csharp%E5%87%BD%E6%95%B0%E7%9A%84%E9%87%8D%E8%BD%BD/"/>
      <url>/2024/12/12/csharp%E5%87%BD%E6%95%B0%E7%9A%84%E9%87%8D%E8%BD%BD/</url>
      
        <content type="html"><![CDATA[<h1 id="Csharpå‡½æ•°çš„é‡è½½-Overload"><a href="#Csharpå‡½æ•°çš„é‡è½½-Overload" class="headerlink" title="Csharpå‡½æ•°çš„é‡è½½-Overload"></a>Csharpå‡½æ•°çš„é‡è½½-Overload</h1><p>1.åœ¨C#ä¸­ï¼Œå‡½æ•°é‡è½½ï¼ˆFunction Overloadingï¼‰æ˜¯æŒ‡åœ¨åŒä¸€ä¸ªç±»ä¸­å¯ä»¥å®šä¹‰å¤šä¸ªåŒåå‡½æ•°ï¼Œåªè¦å®ƒä»¬çš„å‚æ•°åˆ—è¡¨ä¸åŒå³å¯ã€‚å‚æ•°åˆ—è¡¨ä¸åŒå¯ä»¥æ˜¯å‚æ•°çš„ç±»å‹ä¸åŒã€å‚æ•°çš„æ•°é‡ä¸åŒï¼Œæˆ–è€…æ˜¯ä¸¤è€…éƒ½ä¸åŒã€‚å‡½æ•°é‡è½½ä½¿å¾—å‡½æ•°åå¯ä»¥ä¿æŒä¸€è‡´ï¼ŒåŒæ—¶èƒ½å¤Ÿæ ¹æ®ä¼ å…¥çš„å‚æ•°æ‰§è¡Œä¸åŒçš„æ“ä½œã€‚</p><p>2.ä»¥ä¸‹æ˜¯å‡½æ•°é‡è½½çš„å‡ ä¸ªè¦ç‚¹ï¼š</p><blockquote><p>1.å‡½æ•°åç›¸åŒï¼šé‡è½½çš„å‡½æ•°å¿…é¡»åœ¨åŒä¸€ä¸ªç±»ä¸­ï¼Œå¹¶ä¸”å‡½æ•°åç›¸åŒã€‚<br>2.å‚æ•°åˆ—è¡¨ä¸åŒï¼šå‚æ•°åˆ—è¡¨å¿…é¡»åœ¨æ•°é‡æˆ–è€…ç±»å‹ä¸Šæœ‰æ‰€ä¸åŒã€‚<br>3.è¿”å›ç±»å‹æ— å…³ï¼šå‡½æ•°çš„è¿”å›ç±»å‹ä¸å½±å“é‡è½½ï¼Œå³ä½¿ä¸¤ä¸ªå‡½æ•°è¿”å›ç±»å‹ä¸åŒï¼Œåªè¦å‚æ•°åˆ—è¡¨ç›¸åŒï¼Œå®ƒä»¬å°±ä¸æ˜¯é‡è½½ã€‚<br>4.è®¿é—®ä¿®é¥°ç¬¦æ— å…³ï¼šå‡½æ•°çš„è®¿é—®ä¿®é¥°ç¬¦ï¼ˆå¦‚publicã€privateç­‰ï¼‰ä¸å½±å“é‡è½½ã€‚</p></blockquote><p>3.ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„C#å‡½æ•°é‡è½½çš„ä¾‹å­ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MathOperations</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// é‡è½½å‡½æ•°ï¼Œæ— å‚æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">Add</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‡è½½å‡½æ•°ï¼Œä¸€ä¸ªintå‚æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">Add</span>(<span class="params"><span class="built_in">int</span> a</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‡è½½å‡½æ•°ï¼Œä¸¤ä¸ªintå‚æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">Add</span>(<span class="params"><span class="built_in">int</span> a, <span class="built_in">int</span> b</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> a + b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// é‡è½½å‡½æ•°ï¼Œä¸€ä¸ªdoubleå‚æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">double</span> <span class="title">Add</span>(<span class="params"><span class="built_in">double</span> a</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒAdd å‡½æ•°è¢«é‡è½½äº†å››æ¬¡ï¼Œæ¯æ¬¡çš„å‚æ•°åˆ—è¡¨éƒ½ä¸åŒã€‚è¿™ä½¿å¾—è°ƒç”¨è€…å¯ä»¥æ ¹æ®éœ€è¦ä¼ å…¥ä¸åŒæ•°é‡æˆ–ç±»å‹çš„å‚æ•°ï¼Œå¹¶æ‰§è¡Œç›¸åº”çš„æ“ä½œã€‚</p></blockquote><blockquote><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒC#ç¼–è¯‘å™¨åœ¨è°ƒç”¨å‡½æ•°æ—¶ï¼Œä¼šæ ¹æ®ä¼ å…¥å‚æ•°çš„ç±»å‹å’Œæ•°é‡æ¥å†³å®šè°ƒç”¨å“ªä¸ªé‡è½½ç‰ˆæœ¬ã€‚å¦‚æœå­˜åœ¨å¤šä¸ªåŒ¹é…çš„é‡è½½ç‰ˆæœ¬ï¼Œç¼–è¯‘å™¨å°†é€‰æ‹©æœ€å…·ä½“çš„ä¸€ä¸ªã€‚å¦‚æœæ²¡æœ‰åŒ¹é…çš„é‡è½½ç‰ˆæœ¬ï¼Œæˆ–è€…å­˜åœ¨å¤šä¸ªåŒæ ·å…·ä½“çš„ç‰ˆæœ¬ï¼Œç¼–è¯‘å™¨å°†æŠ¥é”™ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Csharp </tag>
            
            <tag> Visual Studio 2022 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Csharpé€’å½’çš„è°ƒç”¨å­¦ä¹ ç¬”è®°</title>
      <link href="/2024/12/12/csharp%E9%80%92%E5%BD%92%E7%9A%84%E8%B0%83%E7%94%A8/"/>
      <url>/2024/12/12/csharp%E9%80%92%E5%BD%92%E7%9A%84%E8%B0%83%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="Csharpæ–¹æ³•çš„é€’å½’è°ƒç”¨"><a href="#Csharpæ–¹æ³•çš„é€’å½’è°ƒç”¨" class="headerlink" title="Csharpæ–¹æ³•çš„é€’å½’è°ƒç”¨"></a>Csharpæ–¹æ³•çš„é€’å½’è°ƒç”¨</h1><p>1.åœ¨C#ä¸­ï¼Œé€’å½’è°ƒç”¨æ˜¯ä¸€ç§æ–¹æ³•è‡ªå·±è°ƒç”¨è‡ªå·±çš„æŠ€æœ¯ã€‚é€’å½’å¯ä»¥ç”¨æ¥è§£å†³é‚£äº›å¯ä»¥åˆ†è§£æˆç›¸ä¼¼å­é—®é¢˜çš„é—®é¢˜ï¼Œæ¯”å¦‚æ ‘çš„éå†ã€æ’åºç®—æ³•ï¼ˆå¦‚å¿«é€Ÿæ’åºã€å½’å¹¶æ’åºï¼‰ç­‰ã€‚é€’å½’æ–¹æ³•é€šå¸¸æœ‰ä¸¤ä¸ªä¸»è¦éƒ¨åˆ†ï¼šé€’å½’ç»ˆæ­¢æ¡ä»¶å’Œé€’å½’å·¥ä½œéƒ¨åˆ†ã€‚</p><p>2.ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„é€’å½’æ–¹æ³•çš„ä¾‹å­ï¼Œè¿™ä¸ªæ–¹æ³•ç”¨æ¥è®¡ç®—ä¸€ä¸ªæ•°çš„é˜¶ä¹˜ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span> number = <span class="number">5</span>;</span><br><span class="line">        <span class="built_in">int</span> result = Factorial(number);</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;The factorial of &quot;</span> + number + <span class="string">&quot; is &quot;</span> + result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">Factorial</span>(<span class="params"><span class="built_in">int</span> n</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// é€’å½’ç»ˆæ­¢æ¡ä»¶</span></span><br><span class="line">        <span class="keyword">if</span> (n &lt;= <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é€’å½’å·¥ä½œéƒ¨åˆ†</span></span><br><span class="line">        <span class="keyword">return</span> n * Factorial(n - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3.åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒFactorial æ–¹æ³•è®¡ç®—ä¸€ä¸ªæ•´æ•° n çš„é˜¶ä¹˜ã€‚é€’å½’ç»ˆæ­¢æ¡ä»¶æ˜¯å½“ n å°äºæˆ–ç­‰äº1æ—¶ï¼Œå› ä¸º1çš„é˜¶ä¹˜æ˜¯1ï¼Œè¿™æ˜¯è®¡ç®—çš„åŸºæœ¬æƒ…å†µã€‚é€’å½’å·¥ä½œéƒ¨åˆ†æ˜¯æ–¹æ³•è°ƒç”¨è‡ªå·±ï¼Œä½†æ˜¯æ¯æ¬¡éƒ½å°† n å‡å°‘1ï¼Œç›´åˆ°è¾¾åˆ°åŸºæœ¬æƒ…å†µã€‚</p><p>4.ä½¿ç”¨é€’å½’æ—¶éœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š</p><blockquote><p>é€’å½’ç»ˆæ­¢æ¡ä»¶ï¼šå¿…é¡»æœ‰ä¸€ä¸ªæ˜ç¡®çš„ç»ˆæ­¢æ¡ä»¶æ¥é˜²æ­¢æ— é™é€’å½’ã€‚<br>é€’å½’å·¥ä½œéƒ¨åˆ†ï¼šæ¯æ¬¡é€’å½’è°ƒç”¨éƒ½åº”è¯¥å‘ç»ˆæ­¢æ¡ä»¶é è¿‘ã€‚<br>æ€§èƒ½é—®é¢˜ï¼šé€’å½’å¯èƒ½ä¼šå¯¼è‡´è¾ƒå¤§çš„å†…å­˜å¼€é”€ï¼Œå› ä¸ºæ¯æ¬¡é€’å½’è°ƒç”¨éƒ½ä¼šåœ¨è°ƒç”¨æ ˆä¸Šå¢åŠ ä¸€å±‚ã€‚å¯¹äºæ·±åº¦é€’å½’ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ ˆæº¢å‡ºé”™è¯¯ã€‚<br>å°¾é€’å½’ä¼˜åŒ–ï¼šåœ¨æŸäº›ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œå°¾é€’å½’å¯ä»¥è¢«ä¼˜åŒ–ä»¥å‡å°‘å†…å­˜ä½¿ç”¨ã€‚ä½†åœ¨C#ä¸­ï¼Œç¼–è¯‘å™¨å¹¶ä¸è‡ªåŠ¨ä¼˜åŒ–å°¾é€’å½’ã€‚<br>åœ¨å®é™…ç¼–ç¨‹ä¸­ï¼Œé€’å½’æ˜¯ä¸€ç§å¼ºå¤§çš„å·¥å…·ï¼Œä½†éœ€è¦è°¨æ…ä½¿ç”¨ï¼Œä»¥é¿å…æ€§èƒ½é—®é¢˜å’Œæ ˆæº¢å‡ºé”™è¯¯ã€‚å¯¹äºå¯ä»¥é€’å½’è§£å†³çš„é—®é¢˜ï¼Œæœ‰æ—¶å€™ä½¿ç”¨è¿­ä»£æ–¹æ³•ï¼ˆå¾ªç¯ï¼‰å¯èƒ½æ˜¯ä¸€ä¸ªæ›´å¥½çš„é€‰æ‹©ã€‚</p></blockquote><h1 id="é€’å½’å‡½æ•°â€”æ±‚é˜¶ä¹˜"><a href="#é€’å½’å‡½æ•°â€”æ±‚é˜¶ä¹˜" class="headerlink" title="é€’å½’å‡½æ•°â€”æ±‚é˜¶ä¹˜"></a>é€’å½’å‡½æ•°â€”æ±‚é˜¶ä¹˜</h1><h2 id="1-10çš„é˜¶ä¹˜"><a href="#1-10çš„é˜¶ä¹˜" class="headerlink" title="1.10çš„é˜¶ä¹˜"></a>1.10çš„é˜¶ä¹˜</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="built_in">int</span> <span class="title">F</span>(<span class="params"><span class="built_in">int</span> n</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">int</span> result=n * F(n - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(F(<span class="number">10</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Csharp </tag>
            
            <tag> Visual Studio 2022 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Csharpæ–¹æ³•çš„å‚æ•°å’Œè¿”å›å€¼å­¦ä¹ ç¬”è®°</title>
      <link href="/2024/12/10/csharp%E5%8F%82%E6%95%B0/"/>
      <url>/2024/12/10/csharp%E5%8F%82%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="Csharpæ–¹æ³•çš„å‚æ•°å’Œè¿”å›å€¼å­¦ä¹ ç¬”è®°"><a href="#Csharpæ–¹æ³•çš„å‚æ•°å’Œè¿”å›å€¼å­¦ä¹ ç¬”è®°" class="headerlink" title="Csharpæ–¹æ³•çš„å‚æ•°å’Œè¿”å›å€¼å­¦ä¹ ç¬”è®°"></a>Csharpæ–¹æ³•çš„å‚æ•°å’Œè¿”å›å€¼å­¦ä¹ ç¬”è®°</h1><p><font size='5'>1.åœ¨C#ä¸­ï¼Œæ–¹æ³•ï¼ˆMethodï¼‰æ˜¯ç±»æˆ–ç»“æ„ä½“ä¸­å®šä¹‰çš„ï¼Œç”¨æ¥æ‰§è¡Œç‰¹å®šä»»åŠ¡çš„ä»£ç å—ã€‚æ–¹æ³•å¯ä»¥æœ‰å‚æ•°ï¼ˆParameterï¼‰ï¼Œä¹Ÿå¯ä»¥æœ‰è¿”å›å€¼ï¼ˆReturn Valueï¼‰ã€‚ä¸‹é¢åˆ†åˆ«ä»‹ç»æ–¹æ³•çš„å‚æ•°å’Œè¿”å›å€¼ï¼š</font></p><h3 id="æ–¹æ³•çš„å‚æ•°ï¼ˆParameterï¼‰"><a href="#æ–¹æ³•çš„å‚æ•°ï¼ˆParameterï¼‰" class="headerlink" title="æ–¹æ³•çš„å‚æ•°ï¼ˆParameterï¼‰"></a>æ–¹æ³•çš„å‚æ•°ï¼ˆParameterï¼‰</h3><p>1.å‚æ•°æ˜¯ä¼ é€’ç»™æ–¹æ³•çš„å€¼ï¼Œç”¨äºæ§åˆ¶æ–¹æ³•çš„è¡Œä¸ºã€‚å‚æ•°å®šä¹‰åœ¨æ–¹æ³•çš„å£°æ˜ä¸­ï¼Œä½äºæ–¹æ³•åä¹‹åï¼Œæ‹¬å·()å†…éƒ¨ï¼Œå‚æ•°ä¹‹é—´ç”¨é€—å·åˆ†éš”ã€‚</p><blockquote><p>ä½ç½®å‚æ•°ï¼šè°ƒç”¨æ–¹æ³•æ—¶ï¼Œå‚æ•°å€¼æŒ‰ç…§å®šä¹‰çš„é¡ºåºä¼ é€’ã€‚<br>å‘½åå‚æ•°ï¼šåœ¨è°ƒç”¨æ–¹æ³•æ—¶ï¼Œå¯ä»¥æŒ‡å®šå‚æ•°åï¼Œä½¿å¾—ä»£ç æ›´æ¸…æ™°ã€‚<br>å¯é€‰å‚æ•°ï¼šä½¿ç”¨optionalå…³é”®å­—å®šä¹‰ï¼Œè°ƒç”¨æ—¶å¯ä»¥çœç•¥ã€‚<br>å‚æ•°æ•°ç»„ï¼šä½¿ç”¨paramså…³é”®å­—å®šä¹‰ï¼Œå…è®¸ä¼ é€’ä¸å®šæ•°é‡çš„å‚æ•°ã€‚<br>è¾“å‡ºå‚æ•°ï¼šä½¿ç”¨outå…³é”®å­—å®šä¹‰ï¼Œæ–¹æ³•å¯ä»¥è¿”å›å¤šä¸ªå€¼ã€‚</p></blockquote><h3 id="æ–¹æ³•çš„è¿”å›å€¼ï¼ˆReturn-Valueï¼‰"><a href="#æ–¹æ³•çš„è¿”å›å€¼ï¼ˆReturn-Valueï¼‰" class="headerlink" title="æ–¹æ³•çš„è¿”å›å€¼ï¼ˆReturn Valueï¼‰"></a>æ–¹æ³•çš„è¿”å›å€¼ï¼ˆReturn Valueï¼‰</h3><p>1.è¿”å›å€¼æ˜¯æ–¹æ³•æ‰§è¡Œå®Œæ¯•åè¿”å›ç»™è°ƒç”¨è€…çš„å€¼ã€‚è¿”å›å€¼çš„ç±»å‹åœ¨æ–¹æ³•å£°æ˜ä¸­æŒ‡å®šã€‚</p><blockquote><p>è¿”å›ç±»å‹ï¼šæ–¹æ³•å£°æ˜æ—¶æŒ‡å®šçš„ç±»å‹ï¼Œå¦‚intã€stringç­‰ã€‚<br>è¿”å›è¯­å¥ï¼šä½¿ç”¨returnå…³é”®å­—ï¼Œåé¢è·Ÿè¿”å›å€¼ã€‚<br>æ— è¿”å›å€¼ï¼šä½¿ç”¨voidå…³é”®å­—ï¼Œè¡¨ç¤ºæ–¹æ³•ä¸è¿”å›ä»»ä½•å€¼ã€‚<br>éšå¼è¿”å›å€¼ï¼šå¯¹äºvoidæ–¹æ³•ï¼Œä¸éœ€è¦returnè¯­å¥ï¼Œæ–¹æ³•æ‰§è¡Œå®Œæ¯•åè‡ªåŠ¨è¿”å›ã€‚</p></blockquote><h2 id="ç¤ºä¾‹ä»£ç "><a href="#ç¤ºä¾‹ä»£ç " class="headerlink" title="ç¤ºä¾‹ä»£ç "></a>ç¤ºä¾‹ä»£ç </h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Example</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// å¸¦å‚æ•°å’Œè¿”å›å€¼çš„æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">Add</span>(<span class="params"><span class="built_in">int</span> a, <span class="built_in">int</span> b</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> a + b; <span class="comment">// è¿”å›å€¼</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¸¦å¯é€‰å‚æ•°çš„æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Display</span>(<span class="params"><span class="built_in">string</span> message = <span class="string">&quot;Hello&quot;</span></span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¸¦å‚æ•°æ•°ç»„çš„æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Print</span>(<span class="params"><span class="keyword">params</span> <span class="built_in">string</span>[] names</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">var</span> name <span class="keyword">in</span> names)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(name);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¸¦è¾“å‡ºå‚æ•°çš„æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Calculate</span>(<span class="params"><span class="keyword">out</span> <span class="built_in">int</span> result</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        result = <span class="number">42</span>; <span class="comment">// è¾“å‡ºå‚æ•°èµ‹å€¼</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼ŒAddæ–¹æ³•æ¥å—ä¸¤ä¸ªæ•´æ•°å‚æ•°å¹¶è¿”å›å®ƒä»¬çš„å’Œï¼›Displayæ–¹æ³•æœ‰ä¸€ä¸ªå¯é€‰å‚æ•°ï¼›Printæ–¹æ³•æ¥å—ä¸€ä¸ªå‚æ•°æ•°ç»„ï¼›Calculateæ–¹æ³•æœ‰ä¸€ä¸ªè¾“å‡ºå‚æ•°ã€‚</p><h1 id="Csharpæ–¹æ³•ä¸­çš„å‚æ•°æ•°ç»„å­¦ä¹ ç¬”è®°"><a href="#Csharpæ–¹æ³•ä¸­çš„å‚æ•°æ•°ç»„å­¦ä¹ ç¬”è®°" class="headerlink" title="Csharpæ–¹æ³•ä¸­çš„å‚æ•°æ•°ç»„å­¦ä¹ ç¬”è®°"></a>Csharpæ–¹æ³•ä¸­çš„å‚æ•°æ•°ç»„å­¦ä¹ ç¬”è®°</h1><p>1.åœ¨C#ä¸­ï¼Œå‚æ•°æ•°ç»„æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ•°ç»„ï¼Œå®ƒå…è®¸ä½ ä¼ é€’ä¸€ä¸ªä¸å®šæ•°é‡çš„å‚æ•°ç»™æ–¹æ³•ã€‚å‚æ•°æ•°ç»„ä½¿ç”¨paramså…³é”®å­—æ¥å£°æ˜ï¼Œå®ƒåªèƒ½ä½œä¸ºæ–¹æ³•çš„æœ€åä¸€ä¸ªå‚æ•°ï¼Œå¹¶ä¸”åªèƒ½å£°æ˜ä¸€æ¬¡ã€‚</p><p>2.ä»¥ä¸‹æ˜¯ä½¿ç”¨å‚æ•°æ•°ç»„çš„ä¸€äº›åŸºæœ¬è§„åˆ™ï¼š</p><blockquote><p>ä½¿ç”¨paramså…³é”®å­—ï¼šåœ¨æ–¹æ³•çš„å‚æ•°åˆ—è¡¨ä¸­ï¼Œä½¿ç”¨paramså…³é”®å­—æ¥å£°æ˜å‚æ•°æ•°ç»„ã€‚<br>ç±»å‹é™åˆ¶ï¼šå‚æ•°æ•°ç»„å¿…é¡»æ˜¯æ–¹æ³•çš„æœ€åä¸€ä¸ªå‚æ•°ï¼Œå¹¶ä¸”åªèƒ½æœ‰ä¸€ä¸ªã€‚<br>ä¼ é€’å‚æ•°ï¼šä½ å¯ä»¥åƒä¼ é€’æ™®é€šæ•°ç»„ä¸€æ ·ä¼ é€’å‚æ•°æ•°ç»„ï¼Œä¹Ÿå¯ä»¥ä¼ é€’å•ä¸ªå‚æ•°ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨å°†å®ƒä»¬åŒ…è£…æˆæ•°ç»„ã€‚</p></blockquote><h3 id="ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨å‚æ•°æ•°ç»„çš„ç®€å•ç¤ºä¾‹ï¼š"><a href="#ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨å‚æ•°æ•°ç»„çš„ç®€å•ç¤ºä¾‹ï¼š" class="headerlink" title="ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨å‚æ•°æ•°ç»„çš„ç®€å•ç¤ºä¾‹ï¼š"></a>ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨å‚æ•°æ•°ç»„çš„ç®€å•ç¤ºä¾‹ï¼š</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        PrintSum(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>); <span class="comment">// ä¼ é€’å¤šä¸ªå‚æ•°</span></span><br><span class="line">        PrintSum(<span class="keyword">new</span> <span class="built_in">int</span>[] &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> &#125;); <span class="comment">// ä¼ é€’æ•°ç»„</span></span><br><span class="line">        PrintSum(<span class="number">1</span>); <span class="comment">// ä¼ é€’å•ä¸ªå‚æ•°</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">PrintSum</span>(<span class="params"><span class="keyword">params</span> <span class="built_in">int</span>[] numbers</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">var</span> number <span class="keyword">in</span> numbers)</span><br><span class="line">        &#123;</span><br><span class="line">            sum += number;</span><br><span class="line">        &#125;</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;Sum: <span class="subst">&#123;sum&#125;</span>&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒPrintSumæ–¹æ³•å¯ä»¥æ¥å—ä»»æ„æ•°é‡çš„æ•´æ•°å‚æ•°ã€‚ä½ å¯ä»¥ä¼ é€’å•ä¸ªæ•´æ•°ã€ä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œæˆ–è€…å¤šä¸ªæ•´æ•°ä½œä¸ºå‚æ•°ã€‚</p><p>å‚æ•°æ•°ç»„åœ¨å†…éƒ¨å®é™…ä¸Šæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ‰€ä»¥ä½ å¯ä»¥åƒä½¿ç”¨æ™®é€šæ•°ç»„ä¸€æ ·ä½¿ç”¨å®ƒï¼Œä¾‹å¦‚é€šè¿‡ç´¢å¼•è®¿é—®å…ƒç´ ã€ä½¿ç”¨Lengthå±æ€§è·å–å…ƒç´ æ•°é‡ç­‰ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Csharp </tag>
            
            <tag> Visual Studio 2022 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Csharpå‡½æ•°å®šä¹‰å’Œè°ƒç”¨å­¦ä¹ ç¬”è®°å­¦ä¹ ç¬”è®°</title>
      <link href="/2024/12/08/csharp%E5%87%BD%E6%95%B0%E4%B8%80/"/>
      <url>/2024/12/08/csharp%E5%87%BD%E6%95%B0%E4%B8%80/</url>
      
        <content type="html"><![CDATA[<h1 id="Csharpå‡½æ•°å®šä¹‰å’Œè°ƒç”¨å­¦ä¹ ç¬”è®°"><a href="#Csharpå‡½æ•°å®šä¹‰å’Œè°ƒç”¨å­¦ä¹ ç¬”è®°" class="headerlink" title="Csharpå‡½æ•°å®šä¹‰å’Œè°ƒç”¨å­¦ä¹ ç¬”è®°"></a>Csharpå‡½æ•°å®šä¹‰å’Œè°ƒç”¨å­¦ä¹ ç¬”è®°</h1><h3 id="åœ¨C-ä¸­ï¼Œå‡½æ•°é€šå¸¸è¢«ç§°ä¸ºæ–¹æ³•ï¼ˆMethodï¼‰ã€‚æ–¹æ³•æ˜¯ä¸€ç§æ‰§è¡Œç‰¹å®šä»»åŠ¡çš„ä»£ç å—ï¼Œå¯ä»¥åŒ…å«å‚æ•°ï¼ˆè¾“å…¥å€¼ï¼‰ï¼Œå¹¶å¯ä»¥è¿”å›ç»“æœã€‚ä»¥ä¸‹æ˜¯C-ä¸­æ–¹æ³•çš„å®šä¹‰å’Œè°ƒç”¨çš„åŸºæœ¬æ­¥éª¤ï¼š"><a href="#åœ¨C-ä¸­ï¼Œå‡½æ•°é€šå¸¸è¢«ç§°ä¸ºæ–¹æ³•ï¼ˆMethodï¼‰ã€‚æ–¹æ³•æ˜¯ä¸€ç§æ‰§è¡Œç‰¹å®šä»»åŠ¡çš„ä»£ç å—ï¼Œå¯ä»¥åŒ…å«å‚æ•°ï¼ˆè¾“å…¥å€¼ï¼‰ï¼Œå¹¶å¯ä»¥è¿”å›ç»“æœã€‚ä»¥ä¸‹æ˜¯C-ä¸­æ–¹æ³•çš„å®šä¹‰å’Œè°ƒç”¨çš„åŸºæœ¬æ­¥éª¤ï¼š" class="headerlink" title="åœ¨C#ä¸­ï¼Œå‡½æ•°é€šå¸¸è¢«ç§°ä¸ºæ–¹æ³•ï¼ˆMethodï¼‰ã€‚æ–¹æ³•æ˜¯ä¸€ç§æ‰§è¡Œç‰¹å®šä»»åŠ¡çš„ä»£ç å—ï¼Œå¯ä»¥åŒ…å«å‚æ•°ï¼ˆè¾“å…¥å€¼ï¼‰ï¼Œå¹¶å¯ä»¥è¿”å›ç»“æœã€‚ä»¥ä¸‹æ˜¯C#ä¸­æ–¹æ³•çš„å®šä¹‰å’Œè°ƒç”¨çš„åŸºæœ¬æ­¥éª¤ï¼š"></a>åœ¨C#ä¸­ï¼Œå‡½æ•°é€šå¸¸è¢«ç§°ä¸ºæ–¹æ³•ï¼ˆMethodï¼‰ã€‚æ–¹æ³•æ˜¯ä¸€ç§æ‰§è¡Œç‰¹å®šä»»åŠ¡çš„ä»£ç å—ï¼Œå¯ä»¥åŒ…å«å‚æ•°ï¼ˆè¾“å…¥å€¼ï¼‰ï¼Œå¹¶å¯ä»¥è¿”å›ç»“æœã€‚ä»¥ä¸‹æ˜¯C#ä¸­æ–¹æ³•çš„å®šä¹‰å’Œè°ƒç”¨çš„åŸºæœ¬æ­¥éª¤ï¼š</h3><p>1.æ–¹æ³•çš„å®šä¹‰</p><blockquote><p>è®¿é—®ä¿®é¥°ç¬¦ï¼šå®šä¹‰æ–¹æ³•çš„å¯è§æ€§ï¼ˆå¦‚public, private, protectedç­‰ï¼‰ã€‚<br>è¿”å›ç±»å‹ï¼šæ–¹æ³•æ‰§è¡Œå®Œæ¯•åè¿”å›çš„æ•°æ®ç±»å‹ã€‚<br>æ–¹æ³•åç§°ï¼šæ–¹æ³•çš„åç§°ï¼Œéµå¾ªC#çš„å‘½åè§„åˆ™ã€‚<br>å‚æ•°åˆ—è¡¨ï¼šæ–¹æ³•éœ€è¦çš„è¾“å…¥å€¼ï¼ŒåŒ…æ‹¬ç±»å‹å’Œåç§°ï¼Œç”±åœ†æ‹¬å·åŒ…å›´ã€‚<br>æ–¹æ³•ä½“ï¼šåŒ…å«æ–¹æ³•é€»è¾‘çš„ä»£ç å—ï¼Œç”±å¤§æ‹¬å· {} åŒ…å›´ã€‚</p></blockquote><p>ç¤ºä¾‹ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyClass</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œæ²¡æœ‰å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">SayHello</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hello, World!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªæ•´æ•°</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">AddNumbers</span>(<span class="params"><span class="built_in">int</span> num1, <span class="built_in">int</span> num2</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> num1 + num2;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2.æ–¹æ³•çš„è°ƒç”¨</p><blockquote><p>è¦è°ƒç”¨ä¸€ä¸ªæ–¹æ³•ï¼Œä½ éœ€è¦ä½¿ç”¨æ–¹æ³•çš„åç§°ï¼Œåé¢è·Ÿç€ä¸€å¯¹åœ†æ‹¬å·ï¼Œå¦‚æœæ–¹æ³•æœ‰å‚æ•°ï¼Œåˆ™åœ¨åœ†æ‹¬å·å†…ä¼ é€’ç›¸åº”çš„å‚æ•°å€¼ã€‚</p></blockquote><p>ç¤ºä¾‹ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        MyClass myClass = <span class="keyword">new</span> MyClass();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è°ƒç”¨æ²¡æœ‰å‚æ•°çš„æ–¹æ³•</span></span><br><span class="line">        <span class="built_in">string</span> helloMessage = myClass.SayHello();</span><br><span class="line">        Console.WriteLine(helloMessage); <span class="comment">// è¾“å‡º: Hello, World!</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// è°ƒç”¨æœ‰å‚æ•°çš„æ–¹æ³•</span></span><br><span class="line">        <span class="built_in">int</span> result = myClass.AddNumbers(<span class="number">5</span>, <span class="number">3</span>);</span><br><span class="line">        Console.WriteLine(result); <span class="comment">// è¾“å‡º: 8</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3.é™æ€æ–¹æ³•</p><blockquote><p>é™æ€æ–¹æ³•ä¸ä¾èµ–äºç±»çš„å®ä¾‹ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ç±»åæ¥è°ƒç”¨ã€‚</p></blockquote><p>ç¤ºä¾‹ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Utility</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// å®šä¹‰ä¸€ä¸ªé™æ€æ–¹æ³•</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">GetGreeting</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Good morning!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ç›´æ¥é€šè¿‡ç±»åè°ƒç”¨é™æ€æ–¹æ³•</span></span><br><span class="line">        <span class="built_in">string</span> greeting = Utility.GetGreeting();</span><br><span class="line">        Console.WriteLine(greeting); <span class="comment">// è¾“å‡º: Good morning!</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4.é‡è½½æ–¹æ³•</p><blockquote><p>ä½ å¯ä»¥åœ¨åŒä¸€ä¸ªç±»ä¸­å®šä¹‰å¤šä¸ªåŒåæ–¹æ³•ï¼Œåªè¦å®ƒä»¬çš„å‚æ•°åˆ—è¡¨ä¸åŒï¼ˆå‚æ•°çš„ç±»å‹å’Œ&#x2F;æˆ–æ•°é‡ä¸åŒï¼‰ã€‚</p></blockquote><p>ç¤ºä¾‹ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Calculator</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// æ–¹æ³•é‡è½½</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">Calculate</span>(<span class="params"><span class="built_in">int</span> a, <span class="built_in">int</span> b</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> a + b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">double</span> <span class="title">Calculate</span>(<span class="params"><span class="built_in">double</span> a, <span class="built_in">double</span> b</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> a + b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Calculator calc = <span class="keyword">new</span> Calculator();</span><br><span class="line"></span><br><span class="line">        <span class="built_in">int</span> intResult = calc.Calculate(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">        Console.WriteLine(intResult); <span class="comment">// è¾“å‡º: 3</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">double</span> doubleResult = calc.Calculate(<span class="number">1.5</span>, <span class="number">2.5</span>);</span><br><span class="line">        Console.WriteLine(doubleResult); <span class="comment">// è¾“å‡º: 4.0</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼ŒCalculate æ–¹æ³•è¢«é‡è½½äº†ä¸¤æ¬¡ï¼Œä¸€æ¬¡æ¥å—ä¸¤ä¸ªæ•´æ•°å‚æ•°ï¼Œå¦ä¸€æ¬¡æ¥å—ä¸¤ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•°å‚æ•°ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Csharp </tag>
            
            <tag> Visual Studio 2022 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Csharpå­—ç¬¦ä¸²éå†ç¼–ç¨‹é¢˜ä¸‰å­¦ä¹ ç¬”è®°</title>
      <link href="/2024/12/05/csharp%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%81%8D%E5%8E%86%E7%BC%96%E7%A8%8B%E9%A2%983/"/>
      <url>/2024/12/05/csharp%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%81%8D%E5%8E%86%E7%BC%96%E7%A8%8B%E9%A2%983/</url>
      
        <content type="html"><![CDATA[<h1 id="è¾“å…¥æ˜¯ä¸ªä¸ç›¸ç­‰çš„æ­£æ•´æ•°ï¼Œè¾“å‡ºè¿™10ä¸ªæ­£æ•´æ•°ä¸­çš„ç¬¬äºŒå¤§çš„æ•°ã€‚"><a href="#è¾“å…¥æ˜¯ä¸ªä¸ç›¸ç­‰çš„æ­£æ•´æ•°ï¼Œè¾“å‡ºè¿™10ä¸ªæ­£æ•´æ•°ä¸­çš„ç¬¬äºŒå¤§çš„æ•°ã€‚" class="headerlink" title="è¾“å…¥æ˜¯ä¸ªä¸ç›¸ç­‰çš„æ­£æ•´æ•°ï¼Œè¾“å‡ºè¿™10ä¸ªæ­£æ•´æ•°ä¸­çš„ç¬¬äºŒå¤§çš„æ•°ã€‚"></a>è¾“å…¥æ˜¯ä¸ªä¸ç›¸ç­‰çš„æ­£æ•´æ•°ï¼Œè¾“å‡ºè¿™10ä¸ªæ­£æ•´æ•°ä¸­çš„ç¬¬äºŒå¤§çš„æ•°ã€‚</h1><p>æ ·ä¾‹è¾“å…¥<br>3 5 7 2 9 5 3 10 3 8<br>æ ·ä¾‹è¾“å‡º<br>9</p><p>åˆ†æï¼š</p><blockquote><p>å®šä¹‰ä¸¤ä¸ªå˜é‡è®¾ç½®ä¸ºç¬¬ä¸€å¤§æ•°ï¼Œå’Œç¬¬äºŒå¤§æ•°</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> str=Console.ReadLine();</span><br><span class="line">    <span class="built_in">string</span>[] strArray = str.Split(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">    <span class="built_in">int</span>[] intArray = <span class="keyword">new</span> <span class="built_in">int</span>[strArray.Length];</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; intArray.Length; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span> number=Convert.ToInt32(strArray[i]);</span><br><span class="line">        intArray[i] = number;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">int</span> max1 = <span class="number">0</span>, max2 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">0</span>;i &lt; intArray.Length; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (intArray[i] &gt; max1)</span><br><span class="line">        &#123;</span><br><span class="line">            max2 = max1;</span><br><span class="line">            max1=intArray[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(intArray[i] &gt; max2)</span><br><span class="line">            &#123;</span><br><span class="line">                max2 = intArray[i];</span><br><span class="line">            &#125;                        </span><br><span class="line">        &#125;                              </span><br><span class="line">    &#125;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;ç¬¬ä¸€å¤§æ•°&quot;</span> + max1 + <span class="string">&quot;ç¬¬äºŒå¤§æ•°&quot;</span> + max2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡ºç»“æœï¼š"><a href="#è¾“å‡ºç»“æœï¼š" class="headerlink" title="è¾“å‡ºç»“æœï¼š"></a>è¾“å‡ºç»“æœï¼š</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="number">3</span> <span class="number">2</span> <span class="number">5</span> <span class="number">6</span> <span class="number">8</span> <span class="number">4</span> <span class="number">9</span> <span class="number">7</span> <span class="number">10</span></span><br><span class="line">ç¬¬ä¸€å¤§æ•°<span class="number">10</span>ç¬¬äºŒå¤§æ•°<span class="number">9</span></span><br></pre></td></tr></table></figure><h1 id="æè¿°ç»™å®šä¸€ä¸ªåªåŒ…å«å°å†™å­—æ¯çš„å­—ç¬¦ä¸²ï¼Œè¯·ä½ æ‰¾å‡ºç¬¬ä¸€ä¸ªä»…å‡ºç°ä¸€æ¬¡çš„å­—ç¬¦ã€‚å¦‚æœæ²¡æœ‰ï¼Œè¾“å‡ºnoã€‚"><a href="#æè¿°ç»™å®šä¸€ä¸ªåªåŒ…å«å°å†™å­—æ¯çš„å­—ç¬¦ä¸²ï¼Œè¯·ä½ æ‰¾å‡ºç¬¬ä¸€ä¸ªä»…å‡ºç°ä¸€æ¬¡çš„å­—ç¬¦ã€‚å¦‚æœæ²¡æœ‰ï¼Œè¾“å‡ºnoã€‚" class="headerlink" title="æè¿°ç»™å®šä¸€ä¸ªåªåŒ…å«å°å†™å­—æ¯çš„å­—ç¬¦ä¸²ï¼Œè¯·ä½ æ‰¾å‡ºç¬¬ä¸€ä¸ªä»…å‡ºç°ä¸€æ¬¡çš„å­—ç¬¦ã€‚å¦‚æœæ²¡æœ‰ï¼Œè¾“å‡ºnoã€‚"></a>æè¿°ç»™å®šä¸€ä¸ªåªåŒ…å«å°å†™å­—æ¯çš„å­—ç¬¦ä¸²ï¼Œè¯·ä½ æ‰¾å‡ºç¬¬ä¸€ä¸ªä»…å‡ºç°ä¸€æ¬¡çš„å­—ç¬¦ã€‚å¦‚æœæ²¡æœ‰ï¼Œè¾“å‡ºnoã€‚</h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> str=Console.ReadLine();</span><br><span class="line">    <span class="built_in">int</span>[] countArray= <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">26</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> i=<span class="number">0</span>;i&lt;str.Length;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        countArray[str[i]-<span class="string">&#x27;a&#x27;</span>]=countArray[str[i]-<span class="string">&#x27;a&#x27;</span>]+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">bool</span> isFind = <span class="literal">false</span>;</span><br><span class="line">    <span class="built_in">char</span> c = <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> i=<span class="number">0</span>; i&lt;str.Length;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (countArray[str[i] - <span class="string">&#x27;a&#x27;</span>] == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            isFind = <span class="literal">true</span>;</span><br><span class="line">            c = str[i];</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (isFind == <span class="literal">false</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(c);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡ºç»“æœï¼š-1"><a href="#è¾“å‡ºç»“æœï¼š-1" class="headerlink" title="è¾“å‡ºç»“æœï¼š"></a>è¾“å‡ºç»“æœï¼š</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">levvel</span><br><span class="line">no</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">level</span><br><span class="line">v</span><br></pre></td></tr></table></figure><h1 id="å¤§å°å†™å­—æ¯è½¬æ¢"><a href="#å¤§å°å†™å­—æ¯è½¬æ¢" class="headerlink" title="å¤§å°å†™å­—æ¯è½¬æ¢"></a>å¤§å°å†™å­—æ¯è½¬æ¢</h1><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> str=Console.ReadLine();</span><br><span class="line">    <span class="built_in">int</span> cha = <span class="string">&#x27;A&#x27;</span> - <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; str.Length; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (str[i] &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; str[i] &lt;= <span class="string">&#x27;z&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">char</span> c = (<span class="built_in">char</span>)(str[i] + cha);</span><br><span class="line">            Console.Write(c);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(str[i] &gt;= <span class="string">&#x27;A&#x27;</span> &amp;&amp; cha &lt;= <span class="string">&#x27;Z&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">char</span> c = (<span class="built_in">char</span>)(str[i] - cha);</span><br><span class="line">            Console.Write(c);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡ºç»“æœï¼š-2"><a href="#è¾“å‡ºç»“æœï¼š-2" class="headerlink" title="è¾“å‡ºç»“æœï¼š"></a>è¾“å‡ºç»“æœï¼š</h3> <figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fjsdjfFLKSJ</span><br><span class="line">FJSDJFflksj</span><br></pre></td></tr></table></figure><h1 id="åœ¨ä¸€ä¸ªæ•°ç»„ä¸­æŸ¥æ‰¾ä¸€ä¸ªç»™å®šçš„å€¼ï¼Œè¾“å‡ºç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®-ä»ä¸€å¼€å§‹ï¼‰"><a href="#åœ¨ä¸€ä¸ªæ•°ç»„ä¸­æŸ¥æ‰¾ä¸€ä¸ªç»™å®šçš„å€¼ï¼Œè¾“å‡ºç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®-ä»ä¸€å¼€å§‹ï¼‰" class="headerlink" title="åœ¨ä¸€ä¸ªæ•°ç»„ä¸­æŸ¥æ‰¾ä¸€ä¸ªç»™å®šçš„å€¼ï¼Œè¾“å‡ºç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®(ä»ä¸€å¼€å§‹ï¼‰"></a>åœ¨ä¸€ä¸ªæ•°ç»„ä¸­æŸ¥æ‰¾ä¸€ä¸ªç»™å®šçš„å€¼ï¼Œè¾“å‡ºç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®(ä»ä¸€å¼€å§‹ï¼‰</h1><blockquote><p>è¾“å…¥ï¼š3 8 23 45 2 5<br> 23<br> è¾“å‡ºï¼š3</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> str=Console.ReadLine();</span><br><span class="line">    <span class="built_in">string</span>[] strArray = str.Split(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">    <span class="built_in">int</span>[] intArray = <span class="keyword">new</span> <span class="built_in">int</span>[strArray.Length];</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; intArray.Length; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span> n=Convert.ToInt32(strArray[i]);</span><br><span class="line">        intArray[i] = n;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">int</span> number=Convert.ToInt32(Console.ReadLine());</span><br><span class="line">    <span class="built_in">int</span> location = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">0</span>;i&lt; intArray.Length; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (number == intArray[i])</span><br><span class="line">        &#123;</span><br><span class="line">            location = i+<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    Console.WriteLine(location);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å‡ºç»“æœï¼š-3"><a href="#è¾“å‡ºç»“æœï¼š-3" class="headerlink" title="è¾“å‡ºç»“æœï¼š"></a>è¾“å‡ºç»“æœï¼š</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span> <span class="number">4</span> <span class="number">5</span> <span class="number">76</span> <span class="number">3</span> <span class="number">67</span></span><br><span class="line"><span class="number">76</span></span><br><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Csharp </tag>
            
            <tag> Visual Studio 2022 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Csharpå­—ç¬¦ä¸²éå†ç¼–ç¨‹é¢˜äºŒå­¦ä¹ ç¬”è®°</title>
      <link href="/2024/12/03/csharp%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%81%8D%E5%8E%86%E7%BC%96%E7%A8%8B%E9%A2%982/"/>
      <url>/2024/12/03/csharp%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%81%8D%E5%8E%86%E7%BC%96%E7%A8%8B%E9%A2%982/</url>
      
        <content type="html"><![CDATA[<h1 id="Csharpç¼–ç¨‹é¢˜åˆ¤æ–­åˆæ³•æ ‡è¯†ç¬¦ã€‚"><a href="#Csharpç¼–ç¨‹é¢˜åˆ¤æ–­åˆæ³•æ ‡è¯†ç¬¦ã€‚" class="headerlink" title="Csharpç¼–ç¨‹é¢˜åˆ¤æ–­åˆæ³•æ ‡è¯†ç¬¦ã€‚"></a>Csharpç¼–ç¨‹é¢˜åˆ¤æ–­åˆæ³•æ ‡è¯†ç¬¦ã€‚</h1><p>1.è¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåˆ¤æ–­å…¶æ˜¯å¦æ˜¯c#çš„åˆæ³•æ ‡è¯†ç¬¦ã€‚<br>2.åˆ†æï¼š</p><blockquote><p>åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸æ˜¯æ˜¯æ•°å­—ã€å­—æ¯ï¼ˆå¤§å°å†™ï¼‰ã€ä¸‹åˆ’çº¿ã€‚<br>åˆ¤æ–­æ˜¯å¦æ˜¯æ•°å­—å¼€å¤´ï¼ˆæ•°å­—å¼€å¤´ä¸æ˜¯åˆæ³•æ ‡è¯†ç¬¦ï¼‰</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> str=Console.ReadLine();</span><br><span class="line">    <span class="built_in">bool</span> isRight = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; str.Length; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>((str[i] &lt; <span class="string">&#x27;0&#x27;</span> || str[i]&gt;<span class="string">&#x27;9&#x27;</span>)&amp;&amp;(str[i] &lt; <span class="string">&#x27;a&#x27;</span> || str[i]&gt;<span class="string">&#x27;z&#x27;</span>)&amp;&amp; (str[i] &lt; <span class="string">&#x27;A&#x27;</span> || str[i] &gt; <span class="string">&#x27;Z&#x27;</span>) &amp;&amp; (str[i] != <span class="string">&#x27;_&#x27;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            isRight = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (str[<span class="number">0</span>]&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;str[<span class="number">0</span>]&lt;=<span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        isRight=<span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (isRight)</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;æ˜¯åˆæ³•å­—ç¬¦&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;ä¸æ˜¯åˆæ³•å­—ç¬¦&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3.è¾“å‡ºç»“æœï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SHFKHFRjgjidgj12</span><br><span class="line">æ˜¯åˆæ³•å­—ç¬¦</span><br></pre></td></tr></table></figure><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">12</span>JHSJFjlfjsd</span><br><span class="line">ä¸æ˜¯åˆæ³•å­—ç¬¦</span><br></pre></td></tr></table></figure><h1 id="Csharpç¼–ç¨‹é¢˜-å›æ–‡ä¸²ã€‚"><a href="#Csharpç¼–ç¨‹é¢˜-å›æ–‡ä¸²ã€‚" class="headerlink" title="Csharpç¼–ç¨‹é¢˜-å›æ–‡ä¸²ã€‚"></a>Csharpç¼–ç¨‹é¢˜-å›æ–‡ä¸²ã€‚</h1><p>1.â€œå›æ–‡ä¸²â€æ˜¯ä¸€ä¸ªæ­£è¯»å’Œåè¯»éƒ½ä¸€æ ·çš„å­—ç¬¦ä¸²ï¼Œæ¯”å¦‚â€œlevelâ€æˆ–è€…â€œnoonâ€ç­‰ç­‰å°±æ˜¯å›æ–‡ä¸²ã€‚è¯·å†™ä¸€ä¸ªç¨‹åºåˆ¤æ–­è¯»å…¥çš„å­—ç¬¦ä¸²æ˜¯å¦æ˜¯â€œå›æ–‡â€ã€‚<br>2.åˆ†æï¼š</p><blockquote><p>å¦‚æœå­—ç¬¦ä¸²æ˜¯å¶æ•°çš„è¯ï¼Œå‡å¦‚8&#x2F;2&#x3D;4ï¼Œéå†0-3ã€‚å¦‚æœæ˜¯å¥‡æ•°çš„è¯ï¼Œ7&#x2F;2&#x3D;3ï¼Œéå†0-2<br>å‡è®¾å­—ç¬¦ä¸²æ˜¯8ï¼Œé‚£ä¹ˆç´¢å¼•å¯¹åº”çš„æ˜¯0-7ã€1-6ã€2-5Â·Â·Â·ï¼Œiå¯¹åº”çš„å€’æ•°length-1-iã€‚</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> str = Console.ReadLine();</span><br><span class="line">    <span class="built_in">bool</span> ha = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; str.Length / <span class="number">2</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (str[i] != str[str.Length - <span class="number">1</span> - i])</span><br><span class="line">        &#123;</span><br><span class="line">            ha = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (ha)</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;æ˜¯å›æ–‡ä¸²&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;ä¸æ˜¯å›æ–‡ä¸²&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p> 3.è¾“å‡ºç»“æœï¼š<br> <figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> level</span><br><span class="line">æ˜¯å›æ–‡ä¸²</span><br></pre></td></tr></table></figure></p><h1 id="Csharpç¼–ç¨‹é¢˜-æŸ¥æ‰¾æœ€é•¿è¿ç»­æ¬¡æ•°"><a href="#Csharpç¼–ç¨‹é¢˜-æŸ¥æ‰¾æœ€é•¿è¿ç»­æ¬¡æ•°" class="headerlink" title="Csharpç¼–ç¨‹é¢˜-æŸ¥æ‰¾æœ€é•¿è¿ç»­æ¬¡æ•°"></a>Csharpç¼–ç¨‹é¢˜-æŸ¥æ‰¾æœ€é•¿è¿ç»­æ¬¡æ•°</h1><p>1.æ”¶é›†äº†è¿ç»­Nï¼ˆ1&lt;N&lt;10000000)å¤©çš„æœ€é«˜æ°”æ¸©æ•°æ®ã€‚ç°åœ¨ä»–æƒ³çŸ¥é“æ°”æ¸©ä¸€ç›´ä¸Šå‡çš„æœ€é•¿è¿ç»­å¤©æ•°ã€‚<br>æ ·ä¾‹è¾“å…¥ï¼š1 3 5 | 2 3 5 7 8 | 6 9<br>æ ·ä¾‹è¾“å‡ºï¼š5<br>2.åˆ†æï¼š</p><blockquote><p>åˆ¤æ–­å‰é¢çš„æ•°å­—æ˜¯å¦æ¯”åé¢å°<br>å¦‚æœåé¢çš„è¿ç»­æœ€é«˜å¤©æ•°æ¯”åé¢çš„è¿ç»­å¤©æ•°é«˜åˆ™æ›´æ–°ä¸€ä¸‹ã€‚</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> str=Console.ReadLine();</span><br><span class="line">    <span class="built_in">string</span>[] strArray = str.Split(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">    <span class="built_in">int</span>[] ints= <span class="keyword">new</span> <span class="built_in">int</span>[strArray.Length];</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; ints.Length; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span> number=Convert.ToInt32(strArray[i]);</span><br><span class="line">        ints[i]=number;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">int</span> maxDays = <span class="number">0</span>;<span class="comment">//è®°å½•æœ€é«˜æ°”æ¸©è¿ç»­å‡é«˜çš„å¤©æ•°</span></span><br><span class="line">    <span class="built_in">int</span> count = <span class="number">1</span>;<span class="comment">//è®°å½•æ°”æ¸©è¿ç»­å‡é«˜çš„å¤©æ•°</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">0</span>;i &lt; ints.Length<span class="number">-1</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (ints[i] &lt; ints[i + <span class="number">1</span>])</span><br><span class="line">        &#123;</span><br><span class="line">            count++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (count &gt; maxDays)</span><br><span class="line">            &#123;</span><br><span class="line">                maxDays = count;</span><br><span class="line">            &#125;</span><br><span class="line">            count = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (count &gt; maxDays)</span><br><span class="line">        &#123;</span><br><span class="line">            maxDays = count;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;æœ€é«˜æ°”æ¸©è¿ç»­å‡é«˜çš„æœ€é•¿å¤©æ•°&quot;</span> + maxDays);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Csharp </tag>
            
            <tag> Visual Studio 2022 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Csharpå­—ç¬¦ä¸²éå†ç¼–ç¨‹é¢˜å­¦ä¹ ç¬”è®°</title>
      <link href="/2024/12/01/csharp%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%81%8D%E5%8E%86%E7%BC%96%E7%A8%8B%E9%A2%98/"/>
      <url>/2024/12/01/csharp%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%81%8D%E5%8E%86%E7%BC%96%E7%A8%8B%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h1 id="Csharpå­—ç¬¦ä¸²éå†ç¼–ç¨‹é¢˜å­¦ä¹ ç¬”è®°"><a href="#Csharpå­—ç¬¦ä¸²éå†ç¼–ç¨‹é¢˜å­¦ä¹ ç¬”è®°" class="headerlink" title="Csharpå­—ç¬¦ä¸²éå†ç¼–ç¨‹é¢˜å­¦ä¹ ç¬”è®°"></a>Csharpå­—ç¬¦ä¸²éå†ç¼–ç¨‹é¢˜å­¦ä¹ ç¬”è®°</h1><p>1.è¾“å…¥n(n&lt;100)ä¸ªæ•°ï¼Œæ‰¾å‡ºå…¶ä¸­æœ€å°çš„æ•°ï¼Œå°†å®ƒä¸æœ€å‰é¢çš„æ•°äº¤æ¢åè¾“å‡ºè¿™äº›æ•°ã€‚</p><p>2.åˆ†æï¼š</p><blockquote><p>1.å…ˆè·å–å­—ç¬¦ä¸²ï¼ˆstring str&#x3D;Console.ReadLine()ï¼‰<br>2.å­—ç¬¦ä¸²æ•°ç»„é€šè¿‡ç©ºæ ¼è¿›è¡Œè¾“å…¥ï¼Œä½¿ç”¨string[] strArray&#x3D;str.Split(â€˜ â€˜);<br>3.å­—ç¬¦ä¸²è½¬æ¢æ•´å‹,å£°æ˜int[] intArray&#x3D;new int[strArray.Length];ä½¿ç”¨forå¾ªç¯è½¬æ¢èµ‹å€¼ã€‚<br>4.å‡è®¾ï¼ˆç´¢å¼•ï¼‰0æœ€å°int min&#x3D;intArray[0];é‚£æœ€å°å€¼å’Œåé¢çš„ç´¢å¼•è¿›è¡Œæ¯”è¾ƒï¼Œintä¸€ä¸ªå˜é‡è¿›è¡Œå­˜å‚¨æœ€å°å€¼ã€‚<br>5.æ‰¾åˆ°æœ€å°å€¼å’Œå‡è®¾çš„è¿›è¡Œä½ç½®äº¤æ¢ï¼Œintä¸€ä¸ªä¸´æ—¶å˜é‡è¿›è¡Œå­˜å‚¨ï¼ˆç´¢å¼•0ï¼‰ï¼Œåœ¨æŠŠæœ€å°å€¼æ”¾åœ¨ï¼ˆç´¢å¼•0ï¼‰é‡Œé¢ï¼Œç„¶åå†å°†ä¸´æ—¶å˜é‡æ”¾åœ¨æœ€å°å€¼é‡Œé¢ã€‚</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> str=Console.ReadLine();</span><br><span class="line">    <span class="built_in">string</span>[] strArray = str.Split(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">    <span class="built_in">int</span>[] intArray= <span class="keyword">new</span> <span class="built_in">int</span>[strArray.Length];</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; strArray.Length; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span> number=Convert.ToInt32(strArray[i]);</span><br><span class="line">        intArray[i] = number; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">int</span> min = intArray[<span class="number">0</span>];</span><br><span class="line">    <span class="built_in">int</span> minIndex = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">1</span>; i &lt; intArray.Length; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (intArray[i] &lt; min)</span><br><span class="line">        &#123;</span><br><span class="line">            min = intArray[i];</span><br><span class="line">            minIndex = i;</span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">int</span> temp=intArray[<span class="number">0</span>];</span><br><span class="line">    intArray[<span class="number">0</span>] = intArray[minIndex];</span><br><span class="line">    intArray[minIndex] = temp;</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="built_in">int</span> t <span class="keyword">in</span> intArray)</span><br><span class="line">    &#123;</span><br><span class="line">        Console.Write(t+<span class="string">&quot; &quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>3.è¾“å‡ºç»“æœï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span> <span class="number">4</span> <span class="number">1</span> <span class="number">54</span> <span class="number">56</span> <span class="number">32</span> <span class="number">42</span> <span class="number">5</span></span><br><span class="line"><span class="number">1</span> <span class="number">4</span> <span class="number">3</span> <span class="number">54</span> <span class="number">56</span> <span class="number">32</span> <span class="number">42</span> <span class="number">5</span></span><br></pre></td></tr></table></figure><h2 id="æ’åº-ç³»ç»Ÿæ–¹æ³•"><a href="#æ’åº-ç³»ç»Ÿæ–¹æ³•" class="headerlink" title="æ’åº-ç³»ç»Ÿæ–¹æ³•"></a>æ’åº-ç³»ç»Ÿæ–¹æ³•</h2><p>1.ç¼–å†™ä¸€ä¸ªæ§åˆ¶å°ç¨‹åºï¼Œè¦æ±‚ç”¨æˆ·è¾“å…¥ä¸€ç»„æ•°å­—ç©ºæ ¼é—´éš”ï¼Œï¼Œå¯¹ç”¨æˆ·è¾“å…¥çš„æ•°å­—ä»å°åˆ°å¤§è¾“å‡ºã€‚</p><p>2.åˆ†æï¼š</p><blockquote><p>å¯ä»¥ç”¨ç³»ç»Ÿæ–¹æ³•åšå‡ºæ¥ï¼ˆArray.Sortï¼‰</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> str=Console.ReadLine();</span><br><span class="line">    <span class="built_in">string</span>[] strArray = str.Split(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">    <span class="built_in">int</span>[] intArray= <span class="keyword">new</span> <span class="built_in">int</span>[strArray.Length];</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; intArray.Length; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span> number=Convert.ToInt32(strArray[i]);</span><br><span class="line">        intArray[i]=number;</span><br><span class="line">    &#125;</span><br><span class="line">    Array.Sort(intArray);</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="built_in">int</span> i <span class="keyword">in</span> intArray)</span><br><span class="line">    &#123;</span><br><span class="line">        Console.Write(i+<span class="string">&quot; &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3.è¾“å‡ºç»“æœï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span> <span class="number">1</span> <span class="number">4</span> <span class="number">5</span> <span class="number">3</span> <span class="number">6</span></span><br><span class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Csharp </tag>
            
            <tag> Visual Studio 2022 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Csharpç¼–ç¨‹é¢˜å­¦ä¹ ç¬”è®°</title>
      <link href="/2024/11/30/csharp%E7%BC%96%E7%A8%8B%E9%A2%983/"/>
      <url>/2024/11/30/csharp%E7%BC%96%E7%A8%8B%E9%A2%983/</url>
      
        <content type="html"><![CDATA[<h1 id="Csharpç¼–ç¨‹é¢˜å­¦ä¹ ç¬”è®°"><a href="#Csharpç¼–ç¨‹é¢˜å­¦ä¹ ç¬”è®°" class="headerlink" title="Csharpç¼–ç¨‹é¢˜å­¦ä¹ ç¬”è®°"></a>Csharpç¼–ç¨‹é¢˜å­¦ä¹ ç¬”è®°</h1><h2 id="1-c-ä¸‰ä¸ªå¯ä¹å¯ä»¥æ¢ä¸€ç“¶å¯ä¹ï¼Œç°å†æœ‰364ç“¶å¯ä¹ï¼Œé—®ä¸€å…±å¯ä»¥å’Œå¤šå°‘ç“¶å¯ä¹ï¼Œå‰©ä¸‹å‡ ä¸ªç©ºç“¶"><a href="#1-c-ä¸‰ä¸ªå¯ä¹å¯ä»¥æ¢ä¸€ç“¶å¯ä¹ï¼Œç°å†æœ‰364ç“¶å¯ä¹ï¼Œé—®ä¸€å…±å¯ä»¥å’Œå¤šå°‘ç“¶å¯ä¹ï¼Œå‰©ä¸‹å‡ ä¸ªç©ºç“¶" class="headerlink" title="1.c#ä¸‰ä¸ªå¯ä¹å¯ä»¥æ¢ä¸€ç“¶å¯ä¹ï¼Œç°å†æœ‰364ç“¶å¯ä¹ï¼Œé—®ä¸€å…±å¯ä»¥å’Œå¤šå°‘ç“¶å¯ä¹ï¼Œå‰©ä¸‹å‡ ä¸ªç©ºç“¶"></a>1.c#ä¸‰ä¸ªå¯ä¹å¯ä»¥æ¢ä¸€ç“¶å¯ä¹ï¼Œç°å†æœ‰364ç“¶å¯ä¹ï¼Œé—®ä¸€å…±å¯ä»¥å’Œå¤šå°‘ç“¶å¯ä¹ï¼Œå‰©ä¸‹å‡ ä¸ªç©ºç“¶</h2><p>2.åˆ†æï¼š</p><blockquote><p>1.è¿™ä¸ªé—®é¢˜å¯ä»¥é€šè¿‡å¾ªç¯æ¥è§£å†³ï¼Œæ¯æ¬¡å¾ªç¯è®¡ç®—å‡ºå¯ä»¥æ¢åˆ°çš„å¯ä¹ç“¶æ•°å’Œå‰©ä¸‹çš„ç©ºç“¶æ•°ï¼Œç›´åˆ°å‰©ä¸‹çš„ç©ºç“¶æ•°ä¸è¶³ä»¥æ¢åˆ°ä¸€ç“¶å¯ä¹ä¸ºæ­¢ã€‚<br>2.é¦–å…ˆï¼Œæˆ‘ä»¬æœ‰364ç“¶å¯ä¹ï¼Œæ¯3ä¸ªç©ºç“¶å¯ä»¥æ¢1ç“¶å¯ä¹ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹æ­¥éª¤æ¥è®¡ç®—ï¼š<br>â€¢ä»¥æ¢åˆ°çš„å¯ä¹ç“¶æ•°ï¼š364é™¤ä»¥3ï¼Œå¾—åˆ°121ç“¶å¯ä¹ï¼Œä½™æ•°ä¸º1ä¸ªç©ºç“¶ã€‚<br>â€¢åœ¨æˆ‘ä»¬æœ‰121ç“¶å¯ä¹å’Œ1ä¸ªç©ºç“¶ï¼Œæ€»å…±122ä¸ªç©ºç“¶ã€‚<br>â€¢æ¬¡è®¡ç®—å¯ä»¥æ¢åˆ°çš„å¯ä¹ç“¶æ•°ï¼š122é™¤ä»¥3ï¼Œå¾—åˆ°40ç“¶å¯ä¹ï¼Œä½™æ•°ä¸º2ä¸ªç©ºç“¶ã€‚<br>â€¢åœ¨æˆ‘ä»¬æœ‰40ç“¶å¯ä¹å’Œ2ä¸ªç©ºç“¶ï¼Œæ€»å…±42ä¸ªç©ºç“¶ã€‚<br>â€¢å†æ¬¡è®¡ç®—å¯ä»¥æ¢åˆ°çš„å¯ä¹ç“¶æ•°ï¼š42é™¤ä»¥3ï¼Œå¾—åˆ°14ç“¶å¯ä¹ï¼Œä½™æ•°ä¸º0ä¸ªç©ºç“¶ã€‚<br>â€¢ç°åœ¨æˆ‘ä»¬æœ‰14ç“¶å¯ä¹å’Œ0ä¸ªç©ºç“¶ï¼Œæ€»å…±14ä¸ªç©ºç“¶ã€‚<br>â€¢å†æ¬¡è®¡ç®—å¯ä»¥æ¢åˆ°çš„å¯ä¹ç“¶æ•°ï¼š14é™¤ä»¥3ï¼Œå¾—åˆ°4ç“¶å¯ä¹ï¼Œä½™æ•°ä¸º2ä¸ªç©ºç“¶ã€‚<br>â€¢ç°åœ¨æˆ‘ä»¬æœ‰4ç“¶å¯ä¹å’Œ2ä¸ªç©ºç“¶ï¼Œæ€»å…±6ä¸ªç©ºç“¶ã€‚<br>â€¢å†æ¬¡è®¡ç®—å¯ä»¥æ¢åˆ°çš„å¯ä¹ç“¶æ•°ï¼š6é™¤ä»¥3ï¼Œå¾—åˆ°2ç“¶å¯ä¹ï¼Œä½™æ•°ä¸º0ä¸ªç©ºç“¶ã€‚<br>â€¢ç°åœ¨æˆ‘ä»¬æœ‰2ç“¶å¯ä¹å’Œ0ä¸ªç©ºç“¶ï¼Œæ€»å…±2ä¸ªç©ºç“¶ã€‚<br>â€¢å†æ¬¡è®¡ç®—å¯ä»¥æ¢åˆ°çš„å¯ä¹ç“¶æ•°ï¼š2é™¤ä»¥3ï¼Œå¾—åˆ°0ç“¶å¯ä¹ï¼Œä½™æ•°ä¸º2ä¸ªç©ºç“¶ã€‚<br>â€¢æ‰€ä»¥ï¼Œæ€»å…±å¯ä»¥æ¢åˆ°çš„å¯ä¹ç“¶æ•°ä¸ºï¼š121 + 40 + 14 + 4 + 2 &#x3D; 181ç“¶ï¼Œæœ€åå‰©ä¸‹2ä¸ªç©ºç“¶ã€‚</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span> pingNumber = <span class="number">364</span>;</span><br><span class="line">    <span class="built_in">int</span> heNumber = <span class="number">364</span>;</span><br><span class="line">    <span class="keyword">while</span> (pingNumber &gt; <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        heNumber += pingNumber / <span class="number">3</span>;</span><br><span class="line">        pingNumber = (pingNumber / <span class="number">3</span>) + (pingNumber % <span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;ä¸€å…±å¯ä»¥å–&quot;</span>+heNumber+<span class="string">&quot;,å‰©ä¸‹&quot;</span>+pingNumber);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3.è¾“å‡ºç»“æœï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä¸€å…±å¯ä»¥å–<span class="number">545</span>,å‰©ä¸‹<span class="number">2</span></span><br></pre></td></tr></table></figure><h2 id="ç¼–å†™ä¸€ä¸ªåº”ç”¨ç¨‹åºæ¥è¾“å…¥çš„å­—ç¬¦ä¸²è¿›è¡ŒåŠ å¯†ï¼Œå¯¹äºå­—æ¯å­—ç¬¦ä¸²åŠ å¯†è§„åˆ™å¦‚ä¸‹ï¼š"><a href="#ç¼–å†™ä¸€ä¸ªåº”ç”¨ç¨‹åºæ¥è¾“å…¥çš„å­—ç¬¦ä¸²è¿›è¡ŒåŠ å¯†ï¼Œå¯¹äºå­—æ¯å­—ç¬¦ä¸²åŠ å¯†è§„åˆ™å¦‚ä¸‹ï¼š" class="headerlink" title="ç¼–å†™ä¸€ä¸ªåº”ç”¨ç¨‹åºæ¥è¾“å…¥çš„å­—ç¬¦ä¸²è¿›è¡ŒåŠ å¯†ï¼Œå¯¹äºå­—æ¯å­—ç¬¦ä¸²åŠ å¯†è§„åˆ™å¦‚ä¸‹ï¼š"></a>ç¼–å†™ä¸€ä¸ªåº”ç”¨ç¨‹åºæ¥è¾“å…¥çš„å­—ç¬¦ä¸²è¿›è¡ŒåŠ å¯†ï¼Œå¯¹äºå­—æ¯å­—ç¬¦ä¸²åŠ å¯†è§„åˆ™å¦‚ä¸‹ï¼š</h2><p>â€˜aâ€™â†’â€™dâ€™,â€™xâ€™â†’â€™aâ€™,â€™Aâ€™â†’â€™Dâ€™,â€™Xâ€™â†’â€™Aâ€™,<br>1.åˆ†æï¼š</p><blockquote><p>å­—ç¬¦æ˜¯å¾ªç¯+3ã€‚</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> str=Console.ReadLine();</span><br><span class="line">    <span class="built_in">char</span>[] strArray= str.ToCharArray();</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; strArray.Length; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> ((strArray[i] &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; strArray[i] &lt;= <span class="string">&#x27;z&#x27;</span>) || (strArray[i] &gt;= <span class="string">&#x27;A&#x27;</span> &amp;&amp; strArray[i] &lt;= <span class="string">&#x27;Z&#x27;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            strArray[i] = (<span class="built_in">char</span>)(strArray[i] + <span class="number">3</span>);<span class="comment">//&#x27;a&#x27;+3 97+3=100=&#x27;d&#x27;</span></span><br><span class="line">            <span class="keyword">if</span> (strArray[i] &gt; <span class="string">&#x27;z&#x27;</span> &amp;&amp; strArray[i] &lt;= <span class="string">&#x27;z&#x27;</span> + <span class="number">3</span>)<span class="comment">//zyx</span></span><br><span class="line">            &#123;</span><br><span class="line">                strArray[i] = (<span class="built_in">char</span>)(strArray[i] - <span class="number">26</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (strArray[i] &gt; <span class="string">&#x27;Z&#x27;</span> &amp;&amp; strArray[i] &lt;= <span class="string">&#x27;Z&#x27;</span> + <span class="number">3</span>)<span class="comment">//XYZ</span></span><br><span class="line">            &#123;</span><br><span class="line">                strArray[i]= (<span class="built_in">char</span>)(strArray[i] - <span class="number">26</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="built_in">char</span> temp <span class="keyword">in</span> strArray)</span><br><span class="line">    &#123;</span><br><span class="line">        Console.Write(temp+<span class="string">&quot; &quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Csharp </tag>
            
            <tag> Visual Studio 2022 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Csharpä»€ä¹ˆæ˜¯æ•°ç»„ï¼Œæ•°ç»„çš„éå†ç¬”è®°</title>
      <link href="/2024/11/29/csharp%E6%95%B0%E7%BB%84/"/>
      <url>/2024/11/29/csharp%E6%95%B0%E7%BB%84/</url>
      
        <content type="html"><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯æ•°ç»„"><a href="#ä»€ä¹ˆæ˜¯æ•°ç»„" class="headerlink" title="ä»€ä¹ˆæ˜¯æ•°ç»„"></a>ä»€ä¹ˆæ˜¯æ•°ç»„</h1><p>1.æ•°ç»„æ˜¯ä¸€ç§å¸¸ç”¨çš„æ•°æ®ç»“æ„ï¼Œç”¨äºå­˜å‚¨åŒä¸€ç±»å‹çš„å¤šä¸ªå€¼ã€‚åœ¨ç¼–ç¨‹ä¸­ï¼Œæ•°ç»„å¯ä»¥è¢«çœ‹ä½œæ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œå…¶ä¸­åŒ…å«äº†å›ºå®šæ•°é‡çš„å…ƒç´ ï¼Œè¿™äº›å…ƒç´ é€šå¸¸æ˜¯ç›¸åŒç±»å‹çš„æ•°æ®ã€‚ä»¥ä¸‹æ˜¯æ•°ç»„çš„ä¸€äº›åŸºæœ¬ç‰¹æ€§ï¼š</p><blockquote><p>1.å…ƒç´ ç±»å‹ä¸€è‡´ï¼šæ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½æ˜¯åŒä¸€æ•°æ®ç±»å‹çš„ï¼Œæ¯”å¦‚æ•´æ•°ã€æµ®ç‚¹æ•°ã€å­—ç¬¦ç­‰ã€‚<br>2.è¿ç»­å­˜å‚¨ï¼šæ•°ç»„çš„å…ƒç´ åœ¨å†…å­˜ä¸­æ˜¯è¿ç»­å­˜æ”¾çš„ï¼Œè¿™æ„å‘³ç€å®ƒä»¬æ‹¥æœ‰è¿ç»­çš„å†…å­˜åœ°å€ã€‚<br>3.ç´¢å¼•è®¿é—®ï¼šå¯ä»¥é€šè¿‡ç´¢å¼•ï¼ˆé€šå¸¸æ˜¯ä»0å¼€å§‹çš„æ•´æ•°ï¼‰æ¥è®¿é—®æ•°ç»„ä¸­çš„å…ƒç´ ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæœ‰ä¸€ä¸ªåä¸ºarrçš„æ•°ç»„ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡arr[0]æ¥è®¿é—®ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œarr[1]æ¥è®¿é—®ç¬¬äºŒä¸ªå…ƒç´ ï¼Œä»¥æ­¤ç±»æ¨ã€‚<br>4.å›ºå®šå¤§å°ï¼šåœ¨æŸäº›ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œæ•°ç»„çš„å¤§å°æ˜¯å›ºå®šçš„ï¼Œä¸€æ—¦å£°æ˜ï¼Œå…¶é•¿åº¦å°±ä¸èƒ½æ”¹å˜ã€‚è€Œåœ¨å…¶ä»–è¯­è¨€ä¸­ï¼Œå¦‚Pythonçš„åˆ—è¡¨ï¼Œæ•°ç»„çš„å¤§å°æ˜¯åŠ¨æ€çš„ï¼Œå¯ä»¥æ ¹æ®éœ€è¦å¢é•¿å’Œç¼©å°ã€‚<br>5.éå†ï¼šå¯ä»¥éå†æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œé€šå¸¸ä½¿ç”¨å¾ªç¯ç»“æ„ï¼ˆå¦‚forå¾ªç¯ï¼‰æ¥å®ç°ã€‚<br>6.æ“ä½œï¼šæ•°ç»„æ”¯æŒå¤šç§æ“ä½œï¼Œå¦‚æŸ¥æ‰¾ã€æ’å…¥ã€åˆ é™¤ã€æ’åºç­‰ã€‚</p></blockquote><h2 id="æ•°ç»„çš„å£°æ˜"><a href="#æ•°ç»„çš„å£°æ˜" class="headerlink" title="æ•°ç»„çš„å£°æ˜"></a>æ•°ç»„çš„å£°æ˜</h2><blockquote><p>ç±»å‹[] æ•°ç»„åï¼›<br>æ•°ç»„åéµå®ˆå˜é‡å‘½åè§„åˆ™</p></blockquote><h2 id="æ•°ç»„çš„èµ‹å€¼"><a href="#æ•°ç»„çš„èµ‹å€¼" class="headerlink" title="æ•°ç»„çš„èµ‹å€¼"></a>æ•°ç»„çš„èµ‹å€¼</h2><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span>[] ages=&#123;<span class="number">46</span>,<span class="number">45</span>,<span class="number">3</span>,<span class="number">53</span>,<span class="number">5</span>,<span class="number">2</span>&#125;</span><br><span class="line">ages=<span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">10</span>]ï¼›</span><br><span class="line">ages=<span class="keyword">new</span> <span class="built_in">int</span>[]&#123;<span class="number">3</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="number">76</span>,<span class="number">8</span>&#125;</span><br><span class="line">ages=<span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">6</span>]&#123;<span class="number">4</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">42</span>,<span class="number">6</span>&#125;</span><br></pre></td></tr></table></figure><h2 id="æ•°ç»„çš„ä½¿ç”¨ï¼ˆä¿®æ”¹å’Œè¯»å–ï¼‰"><a href="#æ•°ç»„çš„ä½¿ç”¨ï¼ˆä¿®æ”¹å’Œè¯»å–ï¼‰" class="headerlink" title="æ•°ç»„çš„ä½¿ç”¨ï¼ˆä¿®æ”¹å’Œè¯»å–ï¼‰"></a>æ•°ç»„çš„ä½¿ç”¨ï¼ˆä¿®æ”¹å’Œè¯»å–ï¼‰</h2><p>é€šè¿‡ç´¢å¼•ï¼ˆä¸‹æ ‡ï¼‰ï¼Œç´¢å¼•ä»0å¼€å§‹ã€‚<br>å¯ä»¥æŠŠæ•°ç»„æƒ³è±¡æˆä¸€ä¸ªç«è½¦ï¼Œä¸€ä¸ªè½¦å¢é‡Œé¢å­˜å‚¨çš„å°±æ˜¯æ•°æ®å…ƒç´ ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//å£°æ˜intç±»å‹çš„æ•°æ®</span><br><span class="line">       int[] ages=&#123;46,45,3,53,5,2&#125;</span><br><span class="line">//æ•°ç»„çš„æ•°æ®æœ‰ä¸‹æ ‡   0  1  2 3  4 5</span><br><span class="line">//æ•°ç»„å[ç´¢å¼•]</span><br><span class="line">age[index]</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šä¸èƒ½è®¿é—®ç´¢å¼•ä¸å­˜åœ¨çš„å€¼</p></blockquote><h1 id="æ•°ç»„çš„éå†"><a href="#æ•°ç»„çš„éå†" class="headerlink" title="æ•°ç»„çš„éå†"></a>æ•°ç»„çš„éå†</h1><blockquote><p>1.å£°æ˜ä¸€ä¸ªintçš„æ•°ç»„ï¼Œæ•°ç»„å¤§å°ä¸º9<br>2.å£°æ˜ä¸€ä¸ªcharçš„æ•°ç»„ï¼Œæ•°ç»„é•¿åº¦ä¸º20<br>3.å£°æ˜ä¸€ä¸ªfloatæ•°ç»„ï¼Œæ•°ç»„é•¿åº¦ä¸º5<br>4.å£°æ˜ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œæ•°ç»„é•¿åº¦ä¸º8</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span>[] inta = <span class="keyword">new</span> <span class="built_in">int</span>[<span class="number">9</span>];</span><br><span class="line"><span class="built_in">char</span>[] chara=<span class="keyword">new</span> <span class="built_in">char</span>[<span class="number">20</span>];</span><br><span class="line"><span class="built_in">float</span>[] floata = <span class="keyword">new</span> <span class="built_in">float</span>[<span class="number">5</span>];</span><br><span class="line"><span class="built_in">string</span>[] stringa = <span class="keyword">new</span> <span class="built_in">string</span>[<span class="number">8</span>];</span><br></pre></td></tr></table></figure><h1 id="è¿™ä¹ˆéå†ä¸€ä¸ªæ•°ç»„ï¼Ÿï¼ˆæ­£åºå’Œå€’åºï¼‰"><a href="#è¿™ä¹ˆéå†ä¸€ä¸ªæ•°ç»„ï¼Ÿï¼ˆæ­£åºå’Œå€’åºï¼‰" class="headerlink" title="è¿™ä¹ˆéå†ä¸€ä¸ªæ•°ç»„ï¼Ÿï¼ˆæ­£åºå’Œå€’åºï¼‰"></a>è¿™ä¹ˆéå†ä¸€ä¸ªæ•°ç»„ï¼Ÿï¼ˆæ­£åºå’Œå€’åºï¼‰</h1><blockquote><p>éå†å°±æ˜¯å–å¾—æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå€¼<br> éå†ç´¢å¼•-é€šè¿‡ç´¢å¼•è®¿é—®å…ƒç´ </p></blockquote><p> 1.é€šè¿‡forå’Œwhileéå†ä¸€ä¸ªæ•°ç»„<br> 2.é€šè¿‡foreachéå†ä¸€ä¸ªæ•°ç»„</p><h2 id="forå¾ªç¯"><a href="#forå¾ªç¯" class="headerlink" title="forå¾ªç¯"></a>forå¾ªç¯</h2> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> int[] ages = &#123; 23, 45, 67, 12, 34, 56, 8, 34, 23, 3 &#125;;</span><br><span class="line">for(int i = 0; i &lt; 10; i++)</span><br><span class="line">&#123;</span><br><span class="line">    Console.Write(ages[i]+&quot; &quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">int[] ages = &#123; 23, 45, 67, 12, 34, 56, 8, 34, 23, 3 &#125;;</span><br><span class="line">for(int i = 9; i&gt;=0; i--)</span><br><span class="line">&#123;</span><br><span class="line">    Console.Write(ages[i]+&quot; &quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3.åœ¨æˆ‘ä»¬ä¸çŸ¥é“æ•°ç»„çš„é•¿åº¦æ—¶å¯ä»¥ç”¨ages.Lengthè·å–agesçš„é•¿åº¦ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> <span class="built_in">int</span>[] ages = &#123; <span class="number">23</span>, <span class="number">45</span>, <span class="number">67</span>, <span class="number">12</span>, <span class="number">34</span>, <span class="number">56</span>, <span class="number">8</span>, <span class="number">34</span>, <span class="number">23</span>, <span class="number">3</span> &#125;;</span><br><span class="line"><span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">0</span>; i &lt;ages.Length; i++)</span><br><span class="line">&#123;</span><br><span class="line">    Console.Write(ages[i]+<span class="string">&quot; &quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="whileå¾ªç¯"><a href="#whileå¾ªç¯" class="headerlink" title="whileå¾ªç¯"></a>whileå¾ªç¯</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">int[] ages = &#123; 23, 45, 67, 12, 34, 56, 8, 34, 23, 3 &#125;;</span><br><span class="line">int i = 0;</span><br><span class="line">while (i &lt; 10)</span><br><span class="line">&#123;</span><br><span class="line">    Console.Write(ages[i]+&quot; &quot;);</span><br><span class="line">    i++;</span><br><span class="line">&#125;</span><br><span class="line">```CSHARPå€’åº</span><br><span class="line">int[] ages = &#123; 23, 45, 67, 12, 34, 56, 8, 34, 23, 3 &#125;;</span><br><span class="line">int i = 9;</span><br><span class="line">while (i &gt;= 0)</span><br><span class="line">&#123;</span><br><span class="line">    Console.Write(ages[i]+&quot; &quot;);</span><br><span class="line">    i--;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="foreach"><a href="#foreach" class="headerlink" title="foreach"></a>foreach</h2><blockquote><p>åœ¨C#ä¸­ï¼Œforeach å¾ªç¯æ˜¯ä¸€ç§ç®€æ´ä¸”é«˜æ•ˆçš„æ–¹å¼æ¥éå†æ•°ç»„ã€é›†åˆæˆ–ä»»ä½•å®ç°äº† IEnumerable æˆ– IEnumerable<T>æ¥å£çš„å¯¹è±¡ã€‚foreach å¾ªç¯ä¼šè‡ªåŠ¨å¤„ç†è¿­ä»£è¿‡ç¨‹ï¼Œä½ åªéœ€è¦å…³æ³¨æ¯ä¸ªå…ƒç´ çš„å¤„ç†é€»è¾‘ã€‚</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">    <span class="built_in">int</span>[] ages = &#123; <span class="number">23</span>, <span class="number">45</span>, <span class="number">67</span>, <span class="number">12</span>, <span class="number">34</span>, <span class="number">56</span>, <span class="number">8</span>, <span class="number">34</span>, <span class="number">23</span>, <span class="number">3</span> &#125;;</span><br><span class="line"><span class="keyword">foreach</span> (<span class="built_in">int</span> age <span class="keyword">in</span> ages)</span><br><span class="line">&#123;</span><br><span class="line">    Console.Write(age+<span class="string">&quot; &quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Csharp </tag>
            
            <tag> Visual Studio 2022 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CsharpåŸºæœ¬æ•°æ®ç±»å‹â€”æµ®ç‚¹å‹ï¼Œç±»å‹è½¬æ¢å­¦ä¹ ç¬”è®°</title>
      <link href="/2024/11/27/csharp%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B2/"/>
      <url>/2024/11/27/csharp%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B2/</url>
      
        <content type="html"><![CDATA[<h1 id="CsharpåŸºæœ¬æ•°æ®ç±»å‹ï¼šæµ®ç‚¹å‹"><a href="#CsharpåŸºæœ¬æ•°æ®ç±»å‹ï¼šæµ®ç‚¹å‹" class="headerlink" title="CsharpåŸºæœ¬æ•°æ®ç±»å‹ï¼šæµ®ç‚¹å‹"></a>CsharpåŸºæœ¬æ•°æ®ç±»å‹ï¼šæµ®ç‚¹å‹</h1><blockquote><p>æµ®ç‚¹æ•°å€¼ç±»å‹è¡¨ç¤ºå®æ•°ã€‚ æ‰€æœ‰æµ®ç‚¹å‹æ•°å€¼ç±»å‹å‡ä¸ºå€¼ç±»å‹ã€‚ å®ƒä»¬è¿˜æ˜¯ç®€å•ç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨æ–‡æœ¬è¿›è¡Œåˆå§‹åŒ–ã€‚ æ‰€æœ‰æµ®ç‚¹æ•°å€¼ç±»å‹éƒ½æ”¯æŒç®—æœ¯ã€æ¯”è¾ƒå’Œç›¸ç­‰è¿ç®—ç¬¦ã€‚</p></blockquote><h2 id="æµ®ç‚¹ç±»å‹çš„ç‰¹å¾"><a href="#æµ®ç‚¹ç±»å‹çš„ç‰¹å¾" class="headerlink" title="æµ®ç‚¹ç±»å‹çš„ç‰¹å¾"></a>æµ®ç‚¹ç±»å‹çš„ç‰¹å¾</h2><p><img src="/img%5Cfudianxing.png"></p><p>1.æµ®ç‚¹æ•°åœ¨è®¡ç®—æœºä¸­æ˜¯ä»¥IEEE 754æ ‡å‡†æ¥å­˜å‚¨çš„ï¼Œè¿™æ„å‘³ç€å®ƒä»¬å¯ä»¥è¡¨ç¤ºéå¸¸å¤§æˆ–éå¸¸å°çš„æ•°ï¼Œå¹¶ä¸”å¯ä»¥è¡¨ç¤ºéæ•´æ•°ã€‚</p><p>2.ä»¥ä¸‹æ˜¯ä¸€äº›å…³äºC#æµ®ç‚¹å‹çš„é‡è¦ç‚¹ï¼š</p><blockquote><p>æµ®ç‚¹æ•°çš„ç²¾åº¦æ˜¯æœ‰é™çš„ï¼Œå› æ­¤åœ¨è¿›è¡Œæµ®ç‚¹æ•°è¿ç®—æ—¶å¯èƒ½ä¼šå‡ºç°ç²¾åº¦æŸå¤±ã€‚<br>æµ®ç‚¹æ•°å¯ä»¥è¡¨ç¤ºæ­£æ•°ã€è´Ÿæ•°å’Œé›¶ã€‚<br>æµ®ç‚¹æ•°ä¹Ÿå¯ä»¥è¡¨ç¤ºç‰¹æ®Šå€¼ï¼Œå¦‚æ­£æ— ç©·(double.PositiveInfinity)ã€è´Ÿæ— ç©·(double.NegativeInfinity)å’ŒNaNï¼ˆä¸æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œdouble.NaNï¼‰ã€‚<br>åœ¨æ¯”è¾ƒæµ®ç‚¹æ•°æ—¶ï¼Œåº”è¯¥ä½¿ç”¨ä¸€å®šçš„å®¹å·®æ¥åˆ¤æ–­ä¸¤ä¸ªæ•°æ˜¯å¦â€œç›¸ç­‰â€ï¼Œå› ä¸ºç›´æ¥æ¯”è¾ƒå¯èƒ½ä¼šå› ä¸ºç²¾åº¦é—®é¢˜å¯¼è‡´ä¸å‡†ç¡®çš„ç»“æœã€‚<br>æµ®ç‚¹æ•°çš„èˆå…¥æ¨¡å¼å¯ä»¥é€šè¿‡Math.Roundæ–¹æ³•æˆ–è€…MidpointRoundingæšä¸¾æ¥æ§åˆ¶ã€‚<br>ä½¿ç”¨æµ®ç‚¹å‹æ—¶ï¼Œéœ€è¦è€ƒè™‘åˆ°è¿™äº›ç‰¹æ€§å’Œé™åˆ¶ï¼Œä»¥ç¡®ä¿ç¨‹åºçš„æ­£ç¡®æ€§å’Œå¥å£®æ€§ã€‚</p></blockquote><h1 id="è½¬ä¹‰å­—ç¬¦"><a href="#è½¬ä¹‰å­—ç¬¦" class="headerlink" title="è½¬ä¹‰å­—ç¬¦"></a>è½¬ä¹‰å­—ç¬¦</h1><p>1.åœ¨C#ä¸­ï¼Œè½¬ä¹‰å­—ç¬¦æ˜¯ä¸€ç§ç‰¹æ®Šçš„å­—ç¬¦åºåˆ—ï¼Œä»¥åæ–œæ ï¼ˆ\ï¼‰å¼€å§‹ï¼Œç”¨æ¥è¡¨ç¤ºé‚£äº›ä¸èƒ½ç›´æ¥è¡¨ç¤ºçš„å­—ç¬¦æˆ–è€…å…·æœ‰ç‰¹æ®Šå«ä¹‰çš„å­—ç¬¦ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„è½¬ä¹‰å­—ç¬¦ï¼š</p><blockquote><p>1.æ¢è¡Œç¬¦ï¼ˆ\nï¼‰ï¼šæ’å…¥ä¸€ä¸ªæ–°è¡Œã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Console.WriteLine(&quot;Hello,\nWorld!&quot;);</span><br></pre></td></tr></table></figure><blockquote><p>2.å›è½¦ç¬¦ï¼ˆ\rï¼‰ï¼šå°†å…‰æ ‡ç§»åŠ¨åˆ°å½“å‰è¡Œçš„å¼€å¤´ã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Console.WriteLine(&quot;Hello,\rWorld!&quot;);</span><br></pre></td></tr></table></figure><blockquote><p>3.åˆ¶è¡¨ç¬¦ï¼ˆ\tï¼‰ï¼šæ’å…¥ä¸€ä¸ªæ°´å¹³åˆ¶è¡¨ç¬¦ï¼ˆTabï¼‰ã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Console.WriteLine(&quot;Hello,\tWorld!&quot;);</span><br></pre></td></tr></table></figure><blockquote><p>4.åæ–œæ ï¼ˆ\ï¼‰ï¼šè¡¨ç¤ºä¸€ä¸ªå®é™…çš„åæ–œæ å­—ç¬¦ã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string path = &quot;C:\\Program Files\\Example&quot;;</span><br></pre></td></tr></table></figure><blockquote><p>5.å•å¼•å·ï¼ˆ&#39;ï¼‰ï¼šè¡¨ç¤ºä¸€ä¸ªå•å¼•å·å­—ç¬¦ã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string text = &quot;He&#x27;s the one.&quot;;</span><br></pre></td></tr></table></figure><blockquote><p>6.åŒå¼•å·ï¼ˆ&quot;ï¼‰ï¼šè¡¨ç¤ºä¸€ä¸ªåŒå¼•å·å­—ç¬¦ã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string text = &quot;He said \&quot;Hello\&quot; to me.&quot;;</span><br></pre></td></tr></table></figure><blockquote><p>7.é—®å·ï¼ˆ?ï¼‰ï¼šè¡¨ç¤ºä¸€ä¸ªé—®å·å­—ç¬¦ã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string text = &quot;What&#x27;s this?&quot;;</span><br></pre></td></tr></table></figure><blockquote><p>8.ç©ºå­—ç¬¦ï¼ˆ\0ï¼‰ï¼šè¡¨ç¤ºä¸€ä¸ªç©ºå­—ç¬¦ï¼ˆnull characterï¼‰ã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string text = &quot;Hello\0World&quot;;</span><br></pre></td></tr></table></figure><blockquote><p>9.Unicodeè½¬ä¹‰åºåˆ—ï¼ˆ\uXXXX æˆ– \UXXXXXXXXï¼‰ï¼šè¡¨ç¤ºä¸€ä¸ªUnicodeå­—ç¬¦ï¼Œå…¶ä¸­XXXXæ˜¯å››ä½åå…­è¿›åˆ¶æ•°ï¼ŒXXXXXXXXæ˜¯å…«ä½åå…­è¿›åˆ¶æ•°ã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">string text = &quot;\u00A9&quot;; // Â© symbol</span><br><span class="line">string text = &quot;\U0001F600&quot;; // ğŸ˜€ emoji</span><br></pre></td></tr></table></figure><blockquote><p>10.å…«è¿›åˆ¶è½¬ä¹‰åºåˆ—ï¼ˆ\XXXï¼‰ï¼šè¡¨ç¤ºä¸€ä¸ªASCIIå­—ç¬¦ï¼Œå…¶ä¸­XXXæ˜¯ä¸‰ä½å…«è¿›åˆ¶æ•°ã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string text = &quot;\7&quot;; // è¡¨ç¤ºASCIIç ä¸º7çš„å­—ç¬¦ï¼Œå³BELï¼ˆå“é“ƒï¼‰å­—ç¬¦</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Csharp </tag>
            
            <tag> Visual Studio 2022 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CsharpåŸºæœ¬æ•°æ®ç±»å‹â€”æ•´å‹å­¦ä¹ ç¬”è®°</title>
      <link href="/2024/11/26/csharp%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/"/>
      <url>/2024/11/26/csharp%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="CsharpåŸºæœ¬æ•°æ®ç±»å‹ï¼šæ•´å‹"><a href="#CsharpåŸºæœ¬æ•°æ®ç±»å‹ï¼šæ•´å‹" class="headerlink" title="CsharpåŸºæœ¬æ•°æ®ç±»å‹ï¼šæ•´å‹"></a>CsharpåŸºæœ¬æ•°æ®ç±»å‹ï¼šæ•´å‹</h1><blockquote><p>æ•´å‹æ•°å€¼ç±»å‹ è¡¨ç¤ºæ•´æ•°ã€‚ æ‰€æœ‰çš„æ•´å‹æ•°å€¼ç±»å‹å‡ä¸ºå€¼ç±»å‹ã€‚ å®ƒä»¬è¿˜æ˜¯ç®€å•ç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨æ–‡æœ¬è¿›è¡Œåˆå§‹åŒ–ã€‚ æ‰€æœ‰æ•´å‹æ•°å€¼ç±»å‹éƒ½æ”¯æŒç®—æœ¯ã€ä½é€»è¾‘ã€æ¯”è¾ƒå’Œç›¸ç­‰è¿ç®—ç¬¦ã€‚</p></blockquote><p>1.C# æ”¯æŒä»¥ä¸‹é¢„å®šä¹‰æ•´å‹ç±»å‹ï¼š<br><img src="/img%5Czhengxing.png"></p><h2 id="åœ¨C-ä¸­ï¼Œæ•´æ•°æ•°æ®ç±»å‹åˆ†ä¸ºæœ‰ç¬¦å·å’Œæ— ç¬¦å·ä¸¤ç§ï¼Œå®ƒä»¬çš„ä¸»è¦åŒºåˆ«åœ¨äºå€¼çš„èŒƒå›´å’Œæ˜¯å¦åŒ…å«è´Ÿæ•°ã€‚"><a href="#åœ¨C-ä¸­ï¼Œæ•´æ•°æ•°æ®ç±»å‹åˆ†ä¸ºæœ‰ç¬¦å·å’Œæ— ç¬¦å·ä¸¤ç§ï¼Œå®ƒä»¬çš„ä¸»è¦åŒºåˆ«åœ¨äºå€¼çš„èŒƒå›´å’Œæ˜¯å¦åŒ…å«è´Ÿæ•°ã€‚" class="headerlink" title="åœ¨C#ä¸­ï¼Œæ•´æ•°æ•°æ®ç±»å‹åˆ†ä¸ºæœ‰ç¬¦å·å’Œæ— ç¬¦å·ä¸¤ç§ï¼Œå®ƒä»¬çš„ä¸»è¦åŒºåˆ«åœ¨äºå€¼çš„èŒƒå›´å’Œæ˜¯å¦åŒ…å«è´Ÿæ•°ã€‚"></a>åœ¨C#ä¸­ï¼Œæ•´æ•°æ•°æ®ç±»å‹åˆ†ä¸ºæœ‰ç¬¦å·å’Œæ— ç¬¦å·ä¸¤ç§ï¼Œå®ƒä»¬çš„ä¸»è¦åŒºåˆ«åœ¨äºå€¼çš„èŒƒå›´å’Œæ˜¯å¦åŒ…å«è´Ÿæ•°ã€‚</h2><p>1.æœ‰ç¬¦å·æ•´æ•°ï¼ˆSigned Integersï¼‰ï¼š</p><blockquote><p>å¯ä»¥è¡¨ç¤ºæ­£æ•°ã€è´Ÿæ•°å’Œé›¶ã€‚<br>å¸¸è§çš„æœ‰ç¬¦å·æ•´æ•°ç±»å‹åŒ…æ‹¬ï¼š<br>sbyteï¼š8ä½æœ‰ç¬¦å·æ•´æ•°ï¼ŒèŒƒå›´ä» -128 åˆ° 127ã€‚<br>shortï¼š16ä½æœ‰ç¬¦å·æ•´æ•°ï¼ŒèŒƒå›´ä» -32,768 åˆ° 32,767ã€‚<br>intï¼š32ä½æœ‰ç¬¦å·æ•´æ•°ï¼ŒèŒƒå›´ä» -2,147,483,648 åˆ° 2,147,483,647ã€‚<br>longï¼š64ä½æœ‰ç¬¦å·æ•´æ•°ï¼ŒèŒƒå›´ä» -9,223,372,036,854,775,808 åˆ° 9,223,372,036,854,775,807ã€‚</p></blockquote><p>2.æ— ç¬¦å·æ•´æ•°ï¼ˆUnsigned Integersï¼‰ï¼š</p><blockquote><p>åªèƒ½è¡¨ç¤ºæ­£æ•°å’Œé›¶ï¼Œä¸èƒ½è¡¨ç¤ºè´Ÿæ•°ã€‚<br>å¸¸è§çš„æ— ç¬¦å·æ•´æ•°ç±»å‹åŒ…æ‹¬ï¼š<br>byteï¼š8ä½æ— ç¬¦å·æ•´æ•°ï¼ŒèŒƒå›´ä» 0 åˆ° 255ã€‚<br>ushortï¼š16ä½æ— ç¬¦å·æ•´æ•°ï¼ŒèŒƒå›´ä» 0 åˆ° 65,535ã€‚<br>uintï¼š32ä½æ— ç¬¦å·æ•´æ•°ï¼ŒèŒƒå›´ä» 0 åˆ° 4,294,967,295ã€‚<br>ulongï¼š64ä½æ— ç¬¦å·æ•´æ•°ï¼ŒèŒƒå›´ä» 0 åˆ° 18,446,744,073,709,551,615ã€‚</p></blockquote><p>3.åŒºåˆ«ï¼š</p><blockquote><p>å€¼çš„èŒƒå›´ï¼šæ— ç¬¦å·æ•´æ•°ç±»å‹çš„å€¼èŒƒå›´ä»0å¼€å§‹ï¼Œè€Œæœ‰ç¬¦å·æ•´æ•°ç±»å‹çš„å€¼èŒƒå›´åˆ™åŒ…æ‹¬è´Ÿæ•°ã€‚<br>å†…å­˜å ç”¨ï¼šç›¸åŒä½æ•°çš„æœ‰ç¬¦å·å’Œæ— ç¬¦å·æ•´æ•°å ç”¨çš„å†…å­˜å¤§å°æ˜¯ç›¸åŒçš„ï¼Œä½†æ˜¯æ— ç¬¦å·æ•´æ•°å¯ä»¥è¡¨ç¤ºæ›´å¤§çš„æ­£æ•°å€¼ã€‚<br>æº¢å‡ºè¡Œä¸ºï¼šå½“æ•´æ•°è¿ç®—ç»“æœè¶…å‡ºå…¶ç±»å‹æ‰€èƒ½è¡¨ç¤ºçš„èŒƒå›´æ—¶ï¼Œä¼šå‘ç”Ÿæº¢å‡ºã€‚æœ‰ç¬¦å·æ•´æ•°æº¢å‡ºæ—¶å¯èƒ½ä¼šå˜æˆä¸€ä¸ªè´Ÿæ•°ï¼Œè€Œæ— ç¬¦å·æ•´æ•°æº¢å‡ºæ—¶ä¼šä»0å¼€å§‹å¾ªç¯ã€‚<br>é»˜è®¤å€¼ï¼šæœ‰ç¬¦å·æ•´æ•°ç±»å‹çš„é»˜è®¤å€¼æ˜¯0ï¼Œè€Œæ— ç¬¦å·æ•´æ•°ç±»å‹çš„é»˜è®¤å€¼ä¹Ÿæ˜¯0ã€‚<br>ä½¿ç”¨åœºæ™¯ï¼šæœ‰ç¬¦å·æ•´æ•°é€šå¸¸ç”¨äºéœ€è¦è¡¨ç¤ºæ­£è´Ÿå€¼çš„åœºæ™¯ï¼Œè€Œæ— ç¬¦å·æ•´æ•°é€šå¸¸ç”¨äºè®¡æ•°å™¨ã€ç´¢å¼•ã€æ•°ç»„é•¿åº¦ç­‰åªèƒ½å–éè´Ÿå€¼çš„åœºæ™¯ã€‚<br>åœ¨å®é™…ç¼–ç¨‹ä¸­ï¼Œé€‰æ‹©ä½¿ç”¨æœ‰ç¬¦å·è¿˜æ˜¯æ— ç¬¦å·æ•´æ•°ç±»å‹ï¼Œåº”æ ¹æ®å…·ä½“çš„åº”ç”¨åœºæ™¯å’Œéœ€æ±‚æ¥å†³å®šã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Csharp </tag>
            
            <tag> Visual Studio 2022 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Csharpå¾ªç¯åµŒå¥—åŸºæœ¬ç”¨æ³•å­¦ä¹ ç¬”è®°</title>
      <link href="/2024/11/25/csharp%E5%BE%AA%E7%8E%AF%E5%B5%8C%E5%A5%97/"/>
      <url>/2024/11/25/csharp%E5%BE%AA%E7%8E%AF%E5%B5%8C%E5%A5%97/</url>
      
        <content type="html"><![CDATA[<h1 id="1-å¾ªç¯åµŒå¥—çš„åŸºæœ¬ç”¨æ³•"><a href="#1-å¾ªç¯åµŒå¥—çš„åŸºæœ¬ç”¨æ³•" class="headerlink" title="1.å¾ªç¯åµŒå¥—çš„åŸºæœ¬ç”¨æ³•"></a>1.å¾ªç¯åµŒå¥—çš„åŸºæœ¬ç”¨æ³•</h1><blockquote><p>C# ä¸­çš„å¾ªç¯åµŒå¥—æ˜¯æŒ‡åœ¨ä¸€ä¸ªå¾ªç¯å†…éƒ¨å†åŒ…å«å¦ä¸€ä¸ªå¾ªç¯ã€‚è¿™ç§ç»“æ„é€šå¸¸ç”¨äºå¤„ç†å¤šç»´æ•°ç»„æˆ–éœ€è¦å¤šçº§è¿­ä»£çš„æƒ…å†µã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„å¾ªç¯åµŒå¥—ç¤ºä¾‹ï¼ŒåŒ…æ‹¬ for å¾ªç¯å’Œ foreach å¾ªç¯çš„åµŒå¥—ã€‚</p></blockquote><p><font size="5">1.è¾“å…¥ä¸¤ä¸ªæ•´æ•°nå’Œm,è¾“å‡ºnè¡Œmåˆ—çš„*é˜µ</font></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="built_in">int</span> n=Convert.ToInt32 (Console.ReadLine());</span><br><span class="line"><span class="built_in">int</span> m=Convert.ToInt32 (Console.ReadLine());</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; m; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        Console.Write(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    Console.WriteLine();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><font size="5">è¾“å‡ºç»“æœï¼š</font></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">5</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line">*****</span><br><span class="line">*****</span><br><span class="line">*****</span><br><span class="line">*****</span><br><span class="line">*****</span><br></pre></td></tr></table></figure><p><font size="5">2.è¾“å…¥æ•´æ•°n,è¾“å‡ºnå±‚çš„ä¸‰è§’å½¢</font></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="built_in">int</span> n=Convert.ToInt32 (Console.ReadLine());</span><br><span class="line"><span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">1</span>; i &lt; n+<span class="number">1</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; i; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        Console.Write (<span class="string">&quot;*&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    Console.WriteLine ();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><font size="5">è¾“å‡ºç»“æœï¼š</font></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">6</span></span><br><span class="line">*</span><br><span class="line">**</span><br><span class="line">***</span><br><span class="line">****</span><br><span class="line">*****</span><br><span class="line">******</span><br></pre></td></tr></table></figure><p><font size="5">3.è¾“å…¥æ•´æ•°n,è¾“å‡ºnå±‚çš„ä¸‰è§’å½¢çš„æ–œè¾¹ã€‚</font></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="built_in">int</span> n=Convert.ToInt32 (Console.ReadLine());</span><br><span class="line"><span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">1</span>; i &lt; n + <span class="number">1</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; i<span class="number">-1</span>; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        Console.Write(<span class="string">&quot; &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><font size="5">è¾“å‡ºç»“æœï¼š</font></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">6</span></span><br><span class="line">*</span><br><span class="line"> *</span><br><span class="line">  *</span><br><span class="line">   *</span><br><span class="line">    *</span><br><span class="line">     *</span><br></pre></td></tr></table></figure><p><font size="5">4.å¦‚æœæˆ‘ä»¬è¦è®©å®ƒåè¿‡æ¥å‘¢ï¼Ÿ.è¾“å…¥æ•´æ•°nã€‚</font></p><blockquote><p>1.å‰é¢çš„é¢˜æˆ‘ä»¬éƒ½æ˜¯ä»å°åˆ°å¤§å¼€å§‹éå†ï¼Œè€Œè¿™æ¬¡æ˜¯ä»å¤§åˆ°å°éå†ã€‚<br>2.å› ä¸ºæ˜¯ä»å¤§åˆ°å°ç¬¬ä¸€ä¸ªforå¾ªç¯åˆå§‹åŒ–i&#x3D;n;i&gt;0;iâ€“;</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="built_in">int</span> n=Convert.ToInt32(Console.ReadLine());</span><br><span class="line"><span class="keyword">for</span>(<span class="built_in">int</span> i = n; i &gt; <span class="number">0</span>; i--)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; i<span class="number">-1</span>; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        Console.Write(<span class="string">&quot; &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><font size="5">è¾“å‡ºç»“æœï¼š</font></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">6</span></span><br><span class="line">     *</span><br><span class="line">    *</span><br><span class="line">   *</span><br><span class="line">  *</span><br><span class="line"> *</span><br><span class="line">*</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Csharp </tag>
            
            <tag> Visual Studio 2022 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Csharpå¾ªç¯åµŒå¥—ä¹ä¹ä¹˜æ³•è¡¨ã€ä¹°é¸¡å’Œæœ€å¤§å…¬çº¦æ•°ç¬”è®°</title>
      <link href="/2024/11/25/csharp%E5%BE%AA%E7%8E%AF%E5%B5%8C%E5%A5%97%E7%BC%96%E7%A8%8B%E9%A2%98/"/>
      <url>/2024/11/25/csharp%E5%BE%AA%E7%8E%AF%E5%B5%8C%E5%A5%97%E7%BC%96%E7%A8%8B%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h1 id="Csharpç¼–ç¨‹é¢˜ï¼Œä¹ä¹ä¹˜æ³•è¡¨å’Œç™¾æ–‡ä¹°é¸¡é—®é¢˜"><a href="#Csharpç¼–ç¨‹é¢˜ï¼Œä¹ä¹ä¹˜æ³•è¡¨å’Œç™¾æ–‡ä¹°é¸¡é—®é¢˜" class="headerlink" title="Csharpç¼–ç¨‹é¢˜ï¼Œä¹ä¹ä¹˜æ³•è¡¨å’Œç™¾æ–‡ä¹°é¸¡é—®é¢˜"></a>Csharpç¼–ç¨‹é¢˜ï¼Œä¹ä¹ä¹˜æ³•è¡¨å’Œç™¾æ–‡ä¹°é¸¡é—®é¢˜</h1><p>1.ä½¿ç”¨åµŒå¥—å¾ªç¯å†™å‡ºä¹ä¹ä¹˜æ³•è¡¨<br>åˆ†æï¼š</p><blockquote><p>1.é€‰æ‹©forè¯­å¥è¿›è¡ŒåµŒå¥—å¾ªç¯<br> 2.æœ€å¤–å±‚å¾ªç¯9æ¬¡ï¼Œå­å¾ªç¯é€’å¢åˆ°9æ¬¡</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">1</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">1</span>; j &lt;= i; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            console.Write(<span class="string">&quot;&#123;0&#125;*&#123;1&#125;=&#123;2&#125;&quot;</span>,j,i,i*j);</span><br><span class="line">        &#125;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p> è¾“å‡ºç»“æœï¼š<br> <figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">1</span> * <span class="number">1</span> = <span class="number">1</span></span><br><span class="line"><span class="number">1</span> * <span class="number">2</span> = <span class="number">2</span>   <span class="number">2</span> * <span class="number">2</span> = <span class="number">4</span></span><br><span class="line"><span class="number">1</span> * <span class="number">3</span> = <span class="number">3</span>   <span class="number">2</span> * <span class="number">3</span> = <span class="number">6</span>   <span class="number">3</span> * <span class="number">3</span> = <span class="number">9</span></span><br><span class="line"><span class="number">1</span> * <span class="number">4</span> = <span class="number">4</span>   <span class="number">2</span> * <span class="number">4</span> = <span class="number">8</span>   <span class="number">3</span> * <span class="number">4</span> = <span class="number">12</span>   <span class="number">4</span> * <span class="number">4</span> = <span class="number">16</span></span><br><span class="line"><span class="number">1</span> * <span class="number">5</span> = <span class="number">5</span>   <span class="number">2</span> * <span class="number">5</span> = <span class="number">10</span>   <span class="number">3</span> * <span class="number">5</span> = <span class="number">15</span>   <span class="number">4</span> * <span class="number">5</span> = <span class="number">20</span>   <span class="number">5</span> * <span class="number">5</span> = <span class="number">25</span></span><br><span class="line"><span class="number">1</span> * <span class="number">6</span> = <span class="number">6</span>   <span class="number">2</span> * <span class="number">6</span> = <span class="number">12</span>   <span class="number">3</span> * <span class="number">6</span> = <span class="number">18</span>   <span class="number">4</span> * <span class="number">6</span> = <span class="number">24</span>   <span class="number">5</span> * <span class="number">6</span> = <span class="number">30</span>   <span class="number">6</span> * <span class="number">6</span> = <span class="number">36</span></span><br><span class="line"><span class="number">1</span> * <span class="number">7</span> = <span class="number">7</span>   <span class="number">2</span> * <span class="number">7</span> = <span class="number">14</span>   <span class="number">3</span> * <span class="number">7</span> = <span class="number">21</span>   <span class="number">4</span> * <span class="number">7</span> = <span class="number">28</span>   <span class="number">5</span> * <span class="number">7</span> = <span class="number">35</span>   <span class="number">6</span> * <span class="number">7</span> = <span class="number">42</span>   <span class="number">7</span> * <span class="number">7</span> = <span class="number">49</span></span><br><span class="line"><span class="number">1</span> * <span class="number">8</span> = <span class="number">8</span>   <span class="number">2</span> * <span class="number">8</span> = <span class="number">16</span>   <span class="number">3</span> * <span class="number">8</span> = <span class="number">24</span>   <span class="number">4</span> * <span class="number">8</span> = <span class="number">32</span>   <span class="number">5</span> * <span class="number">8</span> = <span class="number">40</span>   <span class="number">6</span> * <span class="number">8</span> = <span class="number">48</span>   <span class="number">7</span> * <span class="number">8</span> = <span class="number">56</span>   <span class="number">8</span> * <span class="number">8</span> = <span class="number">64</span></span><br><span class="line"><span class="number">1</span> * <span class="number">9</span> = <span class="number">9</span>   <span class="number">2</span> * <span class="number">9</span> = <span class="number">18</span>   <span class="number">3</span> * <span class="number">9</span> = <span class="number">27</span>   <span class="number">4</span> * <span class="number">9</span> = <span class="number">36</span>   <span class="number">5</span> * <span class="number">9</span> = <span class="number">45</span>   <span class="number">6</span> * <span class="number">9</span> = <span class="number">54</span>   <span class="number">7</span> * <span class="number">9</span> = <span class="number">63</span>   <span class="number">8</span> * <span class="number">9</span> = <span class="number">72</span>   <span class="number">9</span> * <span class="number">9</span> = <span class="number">81</span></span><br></pre></td></tr></table></figure><br>2.ç”¨100æ–‡ä¹°ä¸€ç™¾åªé¸¡ï¼Œå…¶ä¸­å…¬é¸¡ï¼Œæ¯é¸¡ï¼Œéƒ½å¿…é¡»è¦æœ‰ï¼Œå…¬é¸¡3æ–‡ä¸€åªï¼Œæ¯é¸¡5æ–‡ä¸€åªï¼Œå°é¸¡2æ–‡ä¸€åªï¼Œè¯·é—®å…¬é¸¡ã€æ¯é¸¡ã€å°é¸¡è¦ä¹°å¤šå°‘åªåˆšå¥½å‡‘é½100æ–‡ã€‚<br>1.è¦æ±‚ï¼šæ¯ç§é¸¡éƒ½è¦æœ‰ä¸”æœ‰å‡ ç§ä¹°æ³•ã€‚<br>2.åˆ†æï¼š</p><blockquote><p>é€šè¿‡ä¸‰å±‚å¾ªç¯æ¥éå†æ‰€æœ‰å¯èƒ½çš„å…¬é¸¡ã€æ¯é¸¡å’Œå°é¸¡çš„ç»„åˆï¼Œä»¥æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„è§£å†³æ–¹æ¡ˆã€‚</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> roosters=<span class="number">1</span>;roosters&lt;=<span class="number">100</span>/<span class="number">3</span>;roosters++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="built_in">int</span> hen = <span class="number">1</span>; hen &lt;= <span class="number">100</span> / <span class="number">5</span>; hen++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="built_in">int</span> pullet=<span class="number">1</span>; pullet&lt;=<span class="number">100</span> / <span class="number">2</span>; pullet++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> ((roosters * <span class="number">3</span> + hen * <span class="number">5</span> + pullet * <span class="number">2</span>) == <span class="number">100</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    Console.WriteLine(<span class="string">&quot;å…¬é¸¡ï¼š&#123;0&#125;ï¼Œæ¯é¸¡ï¼š&#123;1&#125;ï¼Œå°é¸¡ï¼š&#123;2&#125;&quot;</span>,roosters,hen,pullet);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure><p>3.è¾“å…¥ä¸¤ä¸ªæ•´æ•°num1å’Œnum2,è¾“å‡ºè¿™ä¸¤ä¸ªæ­£æ•´æ•°num1å’Œnum2çš„æœ€å¤§å…¬çº¦æ•°ã€‚<br>1.åˆ†æï¼š</p><blockquote><p>1.ä»€ä¹ˆæ˜¯æœ€å¤§å…¬çº¦æ•°:ä¸¤ä¸ªæˆ–å¤šä¸ª æ•´æ•° å…±æœ‰ çº¦æ•° ä¸­æœ€å¤§çš„ä¸€ä¸ªã€‚</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span> num1=Convert.ToInt32(Console.ReadLine());</span><br><span class="line">    <span class="built_in">int</span> num2=Convert.ToInt32(Console.ReadLine());</span><br><span class="line">    <span class="built_in">int</span> min = num1;</span><br><span class="line">    <span class="keyword">if</span>(num2 &lt; min)</span><br><span class="line">    &#123;</span><br><span class="line">        min = num2;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> i = min; i &gt; <span class="number">0</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (num1 % i == <span class="number">0</span> &amp;&amp; num2 % i == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;æœ€å¤§å…¬çº¦æ•°&quot;</span>+i);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Csharp </tag>
            
            <tag> Visual Studio 2022 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Csharpè®¤è¯†æ–°çš„ç±»Randomå­¦ä¹ ç¬”è®°</title>
      <link href="/2024/11/25/%E8%AE%A4%E8%AF%86%E6%96%B0%E7%9A%84%E7%B1%BBRandom/"/>
      <url>/2024/11/25/%E8%AE%A4%E8%AF%86%E6%96%B0%E7%9A%84%E7%B1%BBRandom/</url>
      
        <content type="html"><![CDATA[<h1 id="Csharpç®€å•è®¤è¯†Randomç±»"><a href="#Csharpç®€å•è®¤è¯†Randomç±»" class="headerlink" title="Csharpç®€å•è®¤è¯†Randomç±»"></a>Csharpç®€å•è®¤è¯†Randomç±»</h1><p>1.å®šä¹‰</p><blockquote><p>è¡¨ç¤ºä¼ªéšæœºæ•°ç”Ÿæˆå™¨ï¼Œè¿™æ˜¯ä¸€ç§èƒ½å¤Ÿäº§ç”Ÿæ»¡è¶³æŸäº›éšæœºæ€§ç»Ÿè®¡è¦æ±‚çš„æ•°å­—åºåˆ—çš„ç®—æ³•ã€‚</p></blockquote><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Random</span></span><br></pre></td></tr></table></figure><p>2.ç¤ºä¾‹ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    Random rd = <span class="keyword">new</span> Random();</span><br><span class="line">    Console.WriteLine(rd.Next(<span class="number">1</span>,<span class="number">10</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š<br>éšæœº1åˆ°10ï¼›</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">8</span></span><br></pre></td></tr></table></figure><h2 id="çŒœæ•°å­—"><a href="#çŒœæ•°å­—" class="headerlink" title="çŒœæ•°å­—"></a>çŒœæ•°å­—</h2><p>1.éšæœºï¼Œå¾ªç¯ï¼Œæ‰å¯¹åœæ­¢å¾ªç¯ã€‚</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    Random rd = <span class="keyword">new</span> Random();</span><br><span class="line">    <span class="built_in">int</span> number=rd.Next(<span class="number">1</span>,<span class="number">101</span>);</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span> numberUser=Convert.ToInt32(Console.ReadLine());</span><br><span class="line">        <span class="keyword">if</span> (numberUser &gt; number)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;ä½ çŒœå¤§äº†&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(numberUser&lt;number)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;ä½ çŒœå°äº†&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(numberUser==number)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;ä½ çŒœå¯¹äº†&quot;</span>);   </span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">while</span> (<span class="literal">true</span>);</span><br></pre></td></tr></table></figure><p> è¾“å‡ºç»“æœï¼š(éšæœºï¼Œç»“æœä¸å”¯ä¸€)<br> <figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">20</span></span><br><span class="line">ä½ çŒœå¤§äº†</span><br><span class="line"><span class="number">50</span></span><br><span class="line">ä½ çŒœå¤§äº†</span><br><span class="line"><span class="number">10</span></span><br><span class="line">ä½ çŒœå¯¹äº†</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Csharp </tag>
            
            <tag> Visual Studio 2022 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Csharpç¬”è®°å„ç§å¾ªç¯ç¼–ç¨‹é¢˜äºŒã€‚</title>
      <link href="/2024/11/24/csharp%E7%BC%96%E7%A8%8B%E9%A2%982/"/>
      <url>/2024/11/24/csharp%E7%BC%96%E7%A8%8B%E9%A2%982/</url>
      
        <content type="html"><![CDATA[<h1 id="1-ç¼–å†™ä¸€å…±ç¨‹åºï¼Œæ‰“å°å‡ºæ‰€æœ‰çš„â€œæ°´ä»™èŠ±æ•°â€ï¼Œæ‰€è°“â€œæ°´ä»™èŠ±æ•°â€æ˜¯æŒ‡ä¸€ä¸ªä¸‰ä½æ•°ï¼Œå…¶å„ä½æ•°å­—ç«‹æ–¹ç­‰äºè¯¥æ•°æœ¬èº«ã€‚"><a href="#1-ç¼–å†™ä¸€å…±ç¨‹åºï¼Œæ‰“å°å‡ºæ‰€æœ‰çš„â€œæ°´ä»™èŠ±æ•°â€ï¼Œæ‰€è°“â€œæ°´ä»™èŠ±æ•°â€æ˜¯æŒ‡ä¸€ä¸ªä¸‰ä½æ•°ï¼Œå…¶å„ä½æ•°å­—ç«‹æ–¹ç­‰äºè¯¥æ•°æœ¬èº«ã€‚" class="headerlink" title="1.ç¼–å†™ä¸€å…±ç¨‹åºï¼Œæ‰“å°å‡ºæ‰€æœ‰çš„â€œæ°´ä»™èŠ±æ•°â€ï¼Œæ‰€è°“â€œæ°´ä»™èŠ±æ•°â€æ˜¯æŒ‡ä¸€ä¸ªä¸‰ä½æ•°ï¼Œå…¶å„ä½æ•°å­—ç«‹æ–¹ç­‰äºè¯¥æ•°æœ¬èº«ã€‚"></a>1.ç¼–å†™ä¸€å…±ç¨‹åºï¼Œæ‰“å°å‡ºæ‰€æœ‰çš„â€œæ°´ä»™èŠ±æ•°â€ï¼Œæ‰€è°“â€œæ°´ä»™èŠ±æ•°â€æ˜¯æŒ‡ä¸€ä¸ªä¸‰ä½æ•°ï¼Œå…¶å„ä½æ•°å­—ç«‹æ–¹ç­‰äºè¯¥æ•°æœ¬èº«ã€‚</h1><p>1.è¦æ±‚ï¼šä¾‹å¦‚153&#x3D;1<em>1</em>1+5<em>5</em>5+3<em>3</em>3ï¼Œæ‰€ä»¥153æ˜¯â€œæ°´ä»™èŠ±â€ã€‚</p><p>2.è¾“å…¥153</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">100</span>; i &lt;= <span class="number">999</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span> ge = i % <span class="number">10</span>;</span><br><span class="line">        <span class="built_in">int</span> shi = (i / <span class="number">10</span>) % <span class="number">10</span>;</span><br><span class="line">        <span class="built_in">int</span> bai = i / <span class="number">100</span>;</span><br><span class="line">        <span class="keyword">if</span> (i == ge * ge * ge + shi * shi * shi + bai * bai * bai)</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>3.è¾“å‡ºç»“æœï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">370</span></span><br><span class="line"><span class="number">371</span></span><br><span class="line"><span class="number">407</span></span><br></pre></td></tr></table></figure><h1 id="éšæœºä¸€ä¸ªæœªçŸ¥çš„æ•´æ•°ï¼Œå»é™¤è¿™ä¸ªæ•´æ•°å„ä¸ªä½ä¸Šçš„0ï¼Œå½¢æˆæ–°çš„æ•°ï¼Œå¹¶è¾“å‡ºã€‚"><a href="#éšæœºä¸€ä¸ªæœªçŸ¥çš„æ•´æ•°ï¼Œå»é™¤è¿™ä¸ªæ•´æ•°å„ä¸ªä½ä¸Šçš„0ï¼Œå½¢æˆæ–°çš„æ•°ï¼Œå¹¶è¾“å‡ºã€‚" class="headerlink" title="éšæœºä¸€ä¸ªæœªçŸ¥çš„æ•´æ•°ï¼Œå»é™¤è¿™ä¸ªæ•´æ•°å„ä¸ªä½ä¸Šçš„0ï¼Œå½¢æˆæ–°çš„æ•°ï¼Œå¹¶è¾“å‡ºã€‚"></a>éšæœºä¸€ä¸ªæœªçŸ¥çš„æ•´æ•°ï¼Œå»é™¤è¿™ä¸ªæ•´æ•°å„ä¸ªä½ä¸Šçš„0ï¼Œå½¢æˆæ–°çš„æ•°ï¼Œå¹¶è¾“å‡ºã€‚</h1><p>1.è¦æ±‚ï¼šè¾“å…¥çš„æ•°å­—nå¤§äº0ï¼Œå°äº1000000ã€‚</p><p>2.è¾“å…¥2020</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> a= Convert.ToInt32(Console.ReadLine()); <span class="comment">//2020</span></span><br><span class="line"><span class="built_in">int</span> sum = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">int</span> cheng = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(a != <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span> i = a % <span class="number">10</span>;<span class="comment">//0 202 //2 20//0 2 //2</span></span><br><span class="line">    <span class="keyword">if</span>(i != <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        i *= cheng; <span class="comment">//2 //2</span></span><br><span class="line">        sum+= i;<span class="comment">//2 //2</span></span><br><span class="line">        cheng *= <span class="number">10</span>;<span class="comment">//20 //20</span></span><br><span class="line">    &#125;</span><br><span class="line">    a = a / <span class="number">10</span>; <span class="comment">//2 //2</span></span><br><span class="line">&#125;</span><br><span class="line">Console.WriteLine(sum); <span class="comment">//22</span></span><br></pre></td></tr></table></figure><p>3.è¾“å‡ºç»“æœï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">22</span></span><br></pre></td></tr></table></figure><h1 id="éšæœºæ•°å…¥ä¸€ä¸ªæ•´æ•°num-è¾“å‡ºä¸€ä¸ªæ–°çš„æ•°ï¼Œæ–°æ•°æ°å¥½ä¸åŸæ•°æ¯ä¸€ä½ä¸Šçš„æ•°å­—ç›¸åï¼ˆå¦‚æœåŸæ•°æœ«å°¾æœ‰å¤šä¸ªé›¶ï¼Œè¾“å‡ºçš„æ–°æ•°é«˜ä½ä¸å«0ï¼‰"><a href="#éšæœºæ•°å…¥ä¸€ä¸ªæ•´æ•°num-è¾“å‡ºä¸€ä¸ªæ–°çš„æ•°ï¼Œæ–°æ•°æ°å¥½ä¸åŸæ•°æ¯ä¸€ä½ä¸Šçš„æ•°å­—ç›¸åï¼ˆå¦‚æœåŸæ•°æœ«å°¾æœ‰å¤šä¸ªé›¶ï¼Œè¾“å‡ºçš„æ–°æ•°é«˜ä½ä¸å«0ï¼‰" class="headerlink" title="éšæœºæ•°å…¥ä¸€ä¸ªæ•´æ•°num,è¾“å‡ºä¸€ä¸ªæ–°çš„æ•°ï¼Œæ–°æ•°æ°å¥½ä¸åŸæ•°æ¯ä¸€ä½ä¸Šçš„æ•°å­—ç›¸åï¼ˆå¦‚æœåŸæ•°æœ«å°¾æœ‰å¤šä¸ªé›¶ï¼Œè¾“å‡ºçš„æ–°æ•°é«˜ä½ä¸å«0ï¼‰"></a>éšæœºæ•°å…¥ä¸€ä¸ªæ•´æ•°num,è¾“å‡ºä¸€ä¸ªæ–°çš„æ•°ï¼Œæ–°æ•°æ°å¥½ä¸åŸæ•°æ¯ä¸€ä½ä¸Šçš„æ•°å­—ç›¸åï¼ˆå¦‚æœåŸæ•°æœ«å°¾æœ‰å¤šä¸ªé›¶ï¼Œè¾“å‡ºçš„æ–°æ•°é«˜ä½ä¸å«0ï¼‰</h1><p>1.æ ·ä¾‹è¾“å…¥8736 è¾“å‡º6378<br>  æ ·ä¾‹è¾“å…¥2300 è¾“å‡º32</p><p>  2.è¾“å…¥8736</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> num=Convert.ToInt32(Console.ReadLine());<span class="comment">//8736</span></span><br><span class="line"><span class="built_in">bool</span> yudao = <span class="literal">false</span>; <span class="comment">//é»˜è®¤è¿˜æ²¡æœ‰é‡åˆ°ç¬¬ä¸€ä¸ªé0</span></span><br><span class="line"><span class="keyword">while</span> (num!=<span class="number">0</span>) <span class="comment">//ä»ç¬¬åˆ°é«˜ä½éå†</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span> i = num % <span class="number">10</span>; <span class="comment">//6 873</span></span><br><span class="line">    <span class="comment">//åˆ¤æ–­æ˜¯å¦é‡åˆ°äº†ç¬¬ä¸€ä¸ªé0æ•°å­—</span></span><br><span class="line">    <span class="comment">//å·²ç»é‡åˆ°äº†ç¬¬ä¸€ä¸ªé0æ•°å­—</span></span><br><span class="line">    <span class="comment">//ä¸éœ€è¦å»æ‰0äº†</span></span><br><span class="line">    <span class="comment">//è¿˜æ²¡æœ‰é‡åˆ°ç¬¬ä¸€ä¸ªé0æ•°å­—</span></span><br><span class="line">    <span class="comment">//å»æ‰</span></span><br><span class="line">    <span class="keyword">if</span> (yudao == <span class="literal">false</span>)<span class="comment">//è¿˜æ²¡æœ‰é‡åˆ°ç¬¬ä¸€ä¸ªé0æ•°å­—</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(i != <span class="number">0</span>)<span class="comment">//i=6</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.Write(i);</span><br><span class="line">            <span class="comment">//æ ‡å¿—ä½ï¼Œæ ‡å¿—æ˜¯å¦è¾¾åˆ°äº†æŸä¸ªæ¡ä»¶</span></span><br><span class="line">            yudao= <span class="literal">true</span>;<span class="comment">//ç¡®å®ši!=0æ—¶ï¼Œåœæ­¢åˆ¤æ–­</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">     <span class="keyword">else</span><span class="comment">//i=3</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.Write(i);</span><br><span class="line">        &#125;</span><br><span class="line">    num = num / <span class="number">10</span>;<span class="comment">//8736 873</span></span><br></pre></td></tr></table></figure><p>  3.è¾“å‡ºç»“æœ<br>  <figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">6378</span></span><br></pre></td></tr></table></figure></p><h1 id="å›æ–‡æ•°å’Œå€’åºè¯»éƒ½æ˜¯ä¸€æ ·çš„æ•´æ•°ã€‚è¾“å…¥ä¸€ä¸ªæ•°ï¼Œåˆ¤æ–­æ˜¯å¦æ˜¯å›æ–‡æ•°ã€‚è¾“å…¥çš„æ•´æ•°å¤§äº0ï¼Œå°äº1000000ã€‚"><a href="#å›æ–‡æ•°å’Œå€’åºè¯»éƒ½æ˜¯ä¸€æ ·çš„æ•´æ•°ã€‚è¾“å…¥ä¸€ä¸ªæ•°ï¼Œåˆ¤æ–­æ˜¯å¦æ˜¯å›æ–‡æ•°ã€‚è¾“å…¥çš„æ•´æ•°å¤§äº0ï¼Œå°äº1000000ã€‚" class="headerlink" title="å›æ–‡æ•°å’Œå€’åºè¯»éƒ½æ˜¯ä¸€æ ·çš„æ•´æ•°ã€‚è¾“å…¥ä¸€ä¸ªæ•°ï¼Œåˆ¤æ–­æ˜¯å¦æ˜¯å›æ–‡æ•°ã€‚è¾“å…¥çš„æ•´æ•°å¤§äº0ï¼Œå°äº1000000ã€‚"></a>å›æ–‡æ•°å’Œå€’åºè¯»éƒ½æ˜¯ä¸€æ ·çš„æ•´æ•°ã€‚è¾“å…¥ä¸€ä¸ªæ•°ï¼Œåˆ¤æ–­æ˜¯å¦æ˜¯å›æ–‡æ•°ã€‚è¾“å…¥çš„æ•´æ•°å¤§äº0ï¼Œå°äº1000000ã€‚</h1><p>  1.è¦æ±‚ï¼šå¦‚æœæ˜¯å›æ–‡è¾“å‡ºyesï¼Œä¸æ˜¯è¾“å‡ºnoã€‚<br>  2.è¾“å…¥2397<br> <figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"> <span class="built_in">int</span> n=Convert.ToInt32(Console.ReadLine());<span class="comment">//2992</span></span><br><span class="line"><span class="built_in">int</span> tempN = n;</span><br><span class="line"><span class="built_in">int</span> number = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (tempN != <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span> i = tempN % <span class="number">10</span>;<span class="comment">//2 299  //9 29 //9 2 //2</span></span><br><span class="line">    number *= <span class="number">10</span>;<span class="comment">//0*10=0 //20 //290 //2990</span></span><br><span class="line">    number += i;<span class="comment">//2 //29 //299 //2992</span></span><br><span class="line">    tempN = tempN / <span class="number">10</span>;<span class="comment">//299 //29 //2 //0</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (number == n)</span><br><span class="line">&#123;</span><br><span class="line">   Console.WriteLine(<span class="string">&quot;yes&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;no&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>3.è¾“å‡ºç»“æœï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">no</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Csharp </tag>
            
            <tag> Visual Studio 2022 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Csharpç¬”è®°å„ç§å¾ªç¯ç¼–ç¨‹é¢˜ä¸€ã€‚</title>
      <link href="/2024/11/22/csharp%E7%BC%96%E7%A8%8B%E9%A2%981/"/>
      <url>/2024/11/22/csharp%E7%BC%96%E7%A8%8B%E9%A2%981/</url>
      
        <content type="html"><![CDATA[<h1 id="1-ä¸€ä¸ªçƒä»æŸä¸€é«˜åº¦è½ä¸‹ï¼Œæ¯æ¬¡è½åœ°ååè·³å›åŸæ¥é«˜åº¦çš„ä¸€åŠï¼Œå†è½ä¸‹ã€‚"><a href="#1-ä¸€ä¸ªçƒä»æŸä¸€é«˜åº¦è½ä¸‹ï¼Œæ¯æ¬¡è½åœ°ååè·³å›åŸæ¥é«˜åº¦çš„ä¸€åŠï¼Œå†è½ä¸‹ã€‚" class="headerlink" title="1.ä¸€ä¸ªçƒä»æŸä¸€é«˜åº¦è½ä¸‹ï¼Œæ¯æ¬¡è½åœ°ååè·³å›åŸæ¥é«˜åº¦çš„ä¸€åŠï¼Œå†è½ä¸‹ã€‚"></a>1.ä¸€ä¸ªçƒä»æŸä¸€é«˜åº¦è½ä¸‹ï¼Œæ¯æ¬¡è½åœ°ååè·³å›åŸæ¥é«˜åº¦çš„ä¸€åŠï¼Œå†è½ä¸‹ã€‚</h1><p>1.è¦æ±‚ï¼šçƒç¬¬åæ¬¡åå¼¹å¤šé«˜ï¼Ÿåœ¨ç¬¬åæ¬¡è½åœ°æ—¶ï¼Œå…±ç»è¿‡å¤šå°‘ç±³ï¼Ÿ<br>2.è¦æ±‚ï¼šè¾“å…¥çƒçš„åˆå§‹é«˜åº¦ï¼Œè¾“å‡ºåå¼¹å¤šé«˜ï¼Œå’Œç»è¿‡äº†å¤šå°‘ç±³ã€‚</p><p>3.åˆ†æï¼š</p><blockquote><p>1.æˆ‘ä»¬å¯ä»¥ç”¨int næ¥ç¡®å®šçƒçš„ä»å¤šé«˜å¾€ä¸‹å¼¹ã€‚<br>    2.å†åˆ©ç”¨forå¾ªç¯æ¥æ±‚å‡ºçƒä½“çš„ç¬¬åæ¬¡åå¼¹å¤šé«˜å’Œç»è¿‡äº†å¤šå°‘ç±³<br>    3.å¯ä»¥ç”¨doubleæ¥å®šä¹‰highå­˜å‚¨ç¬¬åæ¬¡çš„é«˜ï¼Œå› ä¸ºåå¼¹æ˜¯åŸæ¥çš„ä¸€åŠï¼Œforçš„è¡¨è¾¾å¼ï¼šhigh&#x2F;&#x3D;2;ã€‚<br>    4.å†ç”¨doubleæ¥å®šä¹‰distanceå­˜å‚¨åå¼¹çš„å’Œï¼Œ2*næ¥ç¡®å®šç¬¬ä¸€æ¬¡è°ˆçš„é«˜ï¼Œå› ä¸ºåå¼¹æ˜¯åŸæ¥çš„ä¸€åŠ<br>    ç¬¬2ä¸ªforçš„è¡¨è¾¾å¼ï¼šdistance&#x2F;&#x3D;2;ã€‚</p></blockquote><p>4.è¾“å…¥100ã€‚</p> <figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> n=Convert.ToInt32 (Console.ReadLine());</span><br><span class="line"></span><br><span class="line"><span class="built_in">double</span> high = n;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">    high /= <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line">Console.WriteLine (high);</span><br><span class="line"><span class="built_in">double</span> distance = <span class="number">2</span> * n;</span><br><span class="line"><span class="built_in">double</span> sum = n;</span><br><span class="line"><span class="keyword">for</span>(<span class="built_in">int</span> i= <span class="number">0</span>; i &lt; <span class="number">9</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">    distance /= <span class="number">2</span>;</span><br><span class="line">    sum += distance;</span><br><span class="line">&#125;</span><br><span class="line">Console.WriteLine (sum);</span><br></pre></td></tr></table></figure><p> 5.è¾“å‡ºç»“æœï¼š<br> <figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">0.09765625</span></span><br><span class="line"><span class="number">299.609375</span></span><br></pre></td></tr></table></figure></p><h1 id="2-è¾“å…¥ä¸€ä¸ªæ•´æ•°aï¼Œå’Œä¸€ä¸ªæ­£æ•´æ•°nï¼Œè®¡ç®—ä¹˜æ–¹açš„æ¬¡æ–¹"><a href="#2-è¾“å…¥ä¸€ä¸ªæ•´æ•°aï¼Œå’Œä¸€ä¸ªæ­£æ•´æ•°nï¼Œè®¡ç®—ä¹˜æ–¹açš„æ¬¡æ–¹" class="headerlink" title="2.è¾“å…¥ä¸€ä¸ªæ•´æ•°aï¼Œå’Œä¸€ä¸ªæ­£æ•´æ•°nï¼Œè®¡ç®—ä¹˜æ–¹açš„æ¬¡æ–¹"></a>2.è¾“å…¥ä¸€ä¸ªæ•´æ•°aï¼Œå’Œä¸€ä¸ªæ­£æ•´æ•°nï¼Œè®¡ç®—ä¹˜æ–¹açš„æ¬¡æ–¹</h1><p>1.è¦æ±‚ï¼šä½¿ç”¨å¾ªç¯æ¥è®¡ç®—açš„æ¬¡æ–¹ã€‚</p><p>2.åˆ†æï¼š</p><blockquote><p>1.ç”¨int aå’Œnã€‚åœ¨doubleæ¥å®šä¹‰ä¸€ä¸ªå˜é‡sumæ¥å­˜å‚¨açš„æ¬¡æ–¹ï¼Œå†åˆ©ç”¨forå¾ªç¯æ¥åˆ¤æ–­æ¬¡æ–¹å¤§å°ã€‚forå¾ªç¯è¡¨è¾¾å¼ï¼šsum*&#x3D;n;</p></blockquote><p>3.è¾“å…¥a&#x3D;5,n&#x3D;5</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;           </span><br><span class="line">    <span class="built_in">int</span> a = Convert.ToInt32(Console.ReadLine());</span><br><span class="line">    <span class="built_in">int</span> n = Convert.ToInt32(Console.ReadLine());</span><br><span class="line">    <span class="built_in">double</span> sum = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        sum *= n;</span><br><span class="line">    &#125;</span><br><span class="line">    Console.WriteLine(sum);</span><br></pre></td></tr></table></figure><p>4.è¾“å‡ºç»“æœï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3125</span></span><br></pre></td></tr></table></figure><h1 id="3-æˆ‘å›½ç°æœ‰xäº¿äººå£ï¼ŒæŒ‰æ¯å¹´0-1-çš„å¢é•¿é€Ÿåº¦ï¼Œnå¹´åå°†æœ‰å¤šå°‘äººï¼Ÿ"><a href="#3-æˆ‘å›½ç°æœ‰xäº¿äººå£ï¼ŒæŒ‰æ¯å¹´0-1-çš„å¢é•¿é€Ÿåº¦ï¼Œnå¹´åå°†æœ‰å¤šå°‘äººï¼Ÿ" class="headerlink" title="3.æˆ‘å›½ç°æœ‰xäº¿äººå£ï¼ŒæŒ‰æ¯å¹´0.1%çš„å¢é•¿é€Ÿåº¦ï¼Œnå¹´åå°†æœ‰å¤šå°‘äººï¼Ÿ"></a>3.æˆ‘å›½ç°æœ‰xäº¿äººå£ï¼ŒæŒ‰æ¯å¹´0.1%çš„å¢é•¿é€Ÿåº¦ï¼Œnå¹´åå°†æœ‰å¤šå°‘äººï¼Ÿ</h1><p>1.è¦æ±‚ï¼šä½¿ç”¨å¾ªç¯æ±‚nå¹´åæœ‰å¤šå°‘äººã€‚</p><p>2.åˆ†æï¼š</p><blockquote><p>1.äººå£æ˜¯ç”¨æ•°å­—ç»Ÿè®¡ï¼Œæˆ‘ä»¬å¯ç”¨doubleå®šä¹‰ä¸€ä¸ªå€¼ï¼Œåœ¨int nianå®šä¹‰è¿‡äº†å¤šå°‘å¹´ã€‚<br>2.ç”¨forå¾ªç¯ï¼Œè¡¨è¾¾å¼ï¼šrankou*&#x3D;1.001;</p></blockquote><p>3.è¾“å…¥rankou&#x3D;120000,nian&#x3D;12</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123; </span><br><span class="line"><span class="built_in">double</span> rankou = Convert.ToInt32(Console.ReadLine());</span><br><span class="line"> <span class="built_in">int</span> nian = Convert.ToInt32(Console.ReadLine());</span><br><span class="line"> <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; nian; i++)</span><br><span class="line"> &#123;</span><br><span class="line">     rankou *= <span class="number">1.001</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> Console.WriteLine(rankou);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p> 4.è¾“å‡ºç»“æœï¼š<br> <figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">121447.94645949498</span></span><br></pre></td></tr></table></figure></p><h1 id="æŠ•èµ„ï¼Œå·²çŸ¥æŠ•èµ„çš„å¤åˆåˆ©ç‡ä¸ºR-0åˆ°20ä¹‹é—´çš„æ•´æ•°-ã€‚æŠ•Mé’±ï¼ˆ100åˆ°1000000ä¹‹é—´çš„æ•´æ•°ï¼‰ã€‚æŠ•èµ„Yå¹´ï¼ˆèŒƒå›´0åˆ°400ï¼‰ã€‚"><a href="#æŠ•èµ„ï¼Œå·²çŸ¥æŠ•èµ„çš„å¤åˆåˆ©ç‡ä¸ºR-0åˆ°20ä¹‹é—´çš„æ•´æ•°-ã€‚æŠ•Mé’±ï¼ˆ100åˆ°1000000ä¹‹é—´çš„æ•´æ•°ï¼‰ã€‚æŠ•èµ„Yå¹´ï¼ˆèŒƒå›´0åˆ°400ï¼‰ã€‚" class="headerlink" title="æŠ•èµ„ï¼Œå·²çŸ¥æŠ•èµ„çš„å¤åˆåˆ©ç‡ä¸ºR(0åˆ°20ä¹‹é—´çš„æ•´æ•°)ã€‚æŠ•Mé’±ï¼ˆ100åˆ°1000000ä¹‹é—´çš„æ•´æ•°ï¼‰ã€‚æŠ•èµ„Yå¹´ï¼ˆèŒƒå›´0åˆ°400ï¼‰ã€‚"></a>æŠ•èµ„ï¼Œå·²çŸ¥æŠ•èµ„çš„å¤åˆåˆ©ç‡ä¸ºR(0åˆ°20ä¹‹é—´çš„æ•´æ•°)ã€‚æŠ•Mé’±ï¼ˆ100åˆ°1000000ä¹‹é—´çš„æ•´æ•°ï¼‰ã€‚æŠ•èµ„Yå¹´ï¼ˆèŒƒå›´0åˆ°400ï¼‰ã€‚</h1><p> 1.è¦æ±‚ï¼šæŠ•èµ„å…±èµšå¤šå°‘é’±ï¼Ÿ</p><p> 2.åˆ†æï¼š</p><blockquote><p>1.å¤åˆåˆ©ç‡ç»™æˆ‘ä»¬çš„èŒƒå›´æ˜¯0åˆ°20ä¹‹é—´ï¼Œæˆ‘å°±å–10å¥½äº†ï¼Œå¤åˆåˆ©ç‡æ˜¯10é™¤100å°±æ˜¯å®ƒçš„å¤åˆåˆ©ç‡ã€‚<br>2.ç”¨doubleæ¥ç¬¬ä¸€å˜é‡Rã€Mã€Y,å’Œsumæ¥å­˜å‚¨ç­”æ¡ˆã€‚</p></blockquote><p>3.è¾“å…¥R&#x3D;10ï¼ŒM&#x3D;50000ï¼ŒY&#x3D;20</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="built_in">double</span> R=Convert.ToInt32(Console.ReadLine());</span><br><span class="line"><span class="built_in">double</span> M=Convert.ToInt32(Console.ReadLine());</span><br><span class="line"><span class="built_in">double</span> Y=Convert.ToInt32(Console.ReadLine());</span><br><span class="line"><span class="built_in">double</span> sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="built_in">int</span> i =<span class="number">0</span>;i&lt;Y;i++)</span><br><span class="line">&#123;</span><br><span class="line">    M *= (R / <span class="number">100.0</span>) + <span class="number">1</span>;</span><br><span class="line">    sum += M;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">Console.WriteLine(sum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4.è¾“å‡ºç»“æœï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3150124.972129084</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Csharp </tag>
            
            <tag> Visual Studio 2022 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¼–ç¨‹é¢˜ï¼šç”¨å¾ªç¯åšå‡ºæŒ–æ˜æ•°å­—å¹¶è®¡ç®—å’Œï¼ˆç¬”è®°ï¼‰</title>
      <link href="/2024/11/20/csharp%E5%AD%97%E7%AC%A6%E8%AF%BB%E5%8F%96/"/>
      <url>/2024/11/20/csharp%E5%AD%97%E7%AC%A6%E8%AF%BB%E5%8F%96/</url>
      
        <content type="html"><![CDATA[<h1 id="1-æŒ–æ˜æ•°å­—ï¼Œå¹¶å¹¶è®¡ç®—è¿™äº›æ•°å­—çš„å’Œ"><a href="#1-æŒ–æ˜æ•°å­—ï¼Œå¹¶å¹¶è®¡ç®—è¿™äº›æ•°å­—çš„å’Œ" class="headerlink" title="1.æŒ–æ˜æ•°å­—ï¼Œå¹¶å¹¶è®¡ç®—è¿™äº›æ•°å­—çš„å’Œ"></a><font size="8"><b>1.æŒ–æ˜æ•°å­—ï¼Œå¹¶å¹¶è®¡ç®—è¿™äº›æ•°å­—çš„å’Œ</font></b></h1><blockquote><p>çŸ¥è¯†ç‚¹ï¼š<br>1.å¦‚ä½•è¯»å–ä¸€ä¸ªå­—ç¬¦è¾“å…¥<br>2.è¾“å…¥ç¼“å†²åŒº<br>3.breakè·³å‡ºå¾ªç¯</p></blockquote><p><font size="5"><b>1.æ•°å­—å’Œå­—ç¬¦æ··åˆåœ¨ä¸€èµ·äº†ï¼Œä½œä¸ºä¸€ä¸ªä¼˜ç§€çš„æŒ–æ˜äººå‘˜ï¼ŒæŠŠè¾“å…¥çš„æ•°å­—æŒ–å‡ºæ¥å¹¶è®¡ç®—è¿™äº›æ•°å­—çš„å’Œï¼Œå¹¶è¾“å‡ºã€‚è¾“å…¥ä»¥@ä½œä¸ºç»“æŸã€‚ æ ·ä¾‹è¾“å…¥23a34b34@  æ ·ä¾‹è¾“å‡º19</p><blockquote><p>åªå­¦åˆ°å¾ªç¯å¦‚ä½•åšå‡ºè¿™é“éš¾é¢˜</fotn></b></p></blockquote><p><font size="5"><b>2.åˆ†æï¼š</fotn></b></p><blockquote><p>1.è¿™é¢˜æˆ‘ä»¬å¯ä»¥ç”¨ASCIIç æ¥åšï¼Œç”¨charè¾“å‡ºå­—ç¬¦ã€‚<br>2ã€‚ç”¨ifæ¥åˆ¤æ–­æ˜¯å¦æ˜¯æ•°å­—ã€‚<br>åœ¨intå®šä¹‰ä¸€ä¸ªå˜é‡æ¥å­˜å‚¨å’Œ</p></blockquote><p><font size="5">3.è¾“å…¥å€¼ï¼š234SKHF23@</fotn></b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">char</span> c;</span><br><span class="line"><span class="built_in">int</span> sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">    c = (<span class="built_in">char</span>)Console.Read();</span><br><span class="line">    <span class="keyword">if</span> (c &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">int</span> number = c - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        sum += number;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">while</span> (c != <span class="string">&#x27;@&#x27;</span>);</span><br><span class="line">Console.WriteLine(sum);</span><br></pre></td></tr></table></figure><p><font size="5">4.è¾“å‡ºç»“æœï¼š</fotn></b></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">234</span>SKHF23@</span><br><span class="line"><span class="number">14</span></span><br></pre></td></tr></table></figure><h1 id="ä»€ä¹ˆæ˜¯ç¼“å†²åŒº"><a href="#ä»€ä¹ˆæ˜¯ç¼“å†²åŒº" class="headerlink" title="ä»€ä¹ˆæ˜¯ç¼“å†²åŒº"></a><font size="8"><b>ä»€ä¹ˆæ˜¯ç¼“å†²åŒº</font></b></h1><blockquote><p>åœ¨C#ä¸­ï¼Œç¼“å†²åŒºé€šå¸¸æŒ‡çš„æ˜¯ä¸€å—å†…å­˜åŒºåŸŸï¼Œç”¨äºä¸´æ—¶å­˜å‚¨æ•°æ®ã€‚ç¼“å†²åŒºåœ¨å¤„ç†I&#x2F;Oæ“ä½œï¼ˆå¦‚æ–‡ä»¶è¯»å†™ã€ç½‘ç»œé€šä¿¡ç­‰ï¼‰æ—¶éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥å‡å°‘å®é™…çš„I&#x2F;Oæ“ä½œæ¬¡æ•°ï¼Œæé«˜æ€§èƒ½ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Csharp </tag>
            
            <tag> Visual Studio 2022 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å˜é‡çš„ä½œç”¨åŸŸ</title>
      <link href="/2024/11/19/%E5%8F%98%E9%87%8F%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F/"/>
      <url>/2024/11/19/%E5%8F%98%E9%87%8F%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F/</url>
      
        <content type="html"><![CDATA[<h1 id="C-å˜é‡é‡Œçš„ä½œç”¨åŸŸ"><a href="#C-å˜é‡é‡Œçš„ä½œç”¨åŸŸ" class="headerlink" title="C#å˜é‡é‡Œçš„ä½œç”¨åŸŸ"></a><font size="8">C#å˜é‡é‡Œçš„ä½œç”¨åŸŸ</font></b></h1><p><font size="6">ä¸€.ä»€ä¹ˆæ˜¯ä½œç”¨åŸŸ</font></b></p><blockquote><p>ä½œç”¨åŸŸï¼ˆScopeï¼‰æ˜¯ç¼–ç¨‹ä¸­çš„ä¸€ä¸ªåŸºæœ¬æ¦‚å¿µï¼Œå®ƒå®šä¹‰äº†ä»£ç ä¸­å˜é‡ã€å‡½æ•°ã€ç±»ç­‰å®ä½“çš„å¯è§æ€§å’Œç”Ÿå‘½å‘¨æœŸã€‚ä½œç”¨åŸŸå†³å®šäº†åœ¨ç¨‹åºçš„å“ªäº›éƒ¨åˆ†å¯ä»¥è®¿é—®æˆ–ä¿®æ”¹è¿™äº›å®ä½“ã€‚</p></blockquote><p><font size="6">äºŒ.C#å˜é‡ä½œç”¨åŸŸä¸­ä¸€äº›å…³é”®ç‚¹</font></b></p><p>1.å±€éƒ¨ä½œç”¨åŸŸæ˜¯æŒ‡åœ¨ç¼–ç¨‹ä¸­ï¼Œå˜é‡æˆ–å‡½æ•°ä»…åœ¨å®šä¹‰å®ƒä»¬çš„ç‰¹å®šä»£ç å—æˆ–åŒºåŸŸå†…å¯è§å’Œå¯è®¿é—®çš„ä½œç”¨åŸŸã€‚è¿™ç§ä½œç”¨åŸŸé€šå¸¸ä¸å±€éƒ¨å˜é‡å’Œå±€éƒ¨å‡½æ•°ç›¸å…³è”ï¼Œå®ƒä»¬åªåœ¨åˆ›å»ºå®ƒä»¬çš„å‡½æ•°ã€æ–¹æ³•æˆ–ä»£ç å—å†…éƒ¨æœ‰æ•ˆã€‚ä»¥ä¸‹æ˜¯å±€éƒ¨ä½œç”¨åŸŸçš„ä¸€äº›å…³é”®ç‰¹ç‚¹ï¼š</p><p>å®šä¹‰ä½ç½®ï¼šå±€éƒ¨å˜é‡æˆ–å‡½æ•°é€šå¸¸åœ¨å‡½æ•°ã€æ–¹æ³•æˆ–ä»£ç å—å†…éƒ¨å®šä¹‰ã€‚</p><p>å¯è§æ€§ï¼šå±€éƒ¨å˜é‡æˆ–å‡½æ•°åªåœ¨å®šä¹‰å®ƒä»¬çš„å‡½æ•°ã€æ–¹æ³•æˆ–ä»£ç å—å†…éƒ¨å¯è§ã€‚ä¸€æ—¦ä»£ç æ‰§è¡Œç¦»å¼€äº†è¿™ä¸ªåŒºåŸŸï¼Œå±€éƒ¨å˜é‡æˆ–å‡½æ•°å°±ä¸å†å¯è®¿é—®ã€‚</p><p>ç”Ÿå‘½å‘¨æœŸï¼šå±€éƒ¨å˜é‡çš„ç”Ÿå‘½å‘¨æœŸé€šå¸¸ä¸å®šä¹‰å®ƒä»¬çš„å‡½æ•°æˆ–ä»£ç å—çš„æ‰§è¡Œå‘¨æœŸç›¸åŒã€‚å½“å‡½æ•°æˆ–ä»£ç å—æ‰§è¡Œç»“æŸæ—¶ï¼Œå±€éƒ¨å˜é‡ä¼šè¢«é”€æ¯ï¼Œå ç”¨çš„å†…å­˜ä¼šè¢«é‡Šæ”¾ã€‚</p><p>åˆå§‹åŒ–ï¼šåœ¨æŸäº›ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œå±€éƒ¨å˜é‡åœ¨ä½¿ç”¨å‰å¿…é¡»è¢«åˆå§‹åŒ–ï¼Œå¦åˆ™å¯èƒ½ä¼šå¼•å‘é”™è¯¯æˆ–è­¦å‘Šã€‚</p><p>åŒåå˜é‡ï¼šåœ¨ä¸åŒçš„å‡½æ•°æˆ–ä»£ç å—ä¸­å¯ä»¥å®šä¹‰åŒåçš„å±€éƒ¨å˜é‡ï¼Œå®ƒä»¬æ˜¯ç‹¬ç«‹çš„ï¼Œäº’ä¸å½±å“ã€‚</p><p>å‚æ•°ä¼ é€’ï¼šå½“å‡½æ•°æˆ–æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œå®å‚çš„å€¼ä¼šè¢«å¤åˆ¶åˆ°å¯¹åº”çš„å±€éƒ¨å˜é‡ï¼ˆå½¢å‚ï¼‰ä¸­ï¼Œå±€éƒ¨å˜é‡çš„ä¿®æ”¹ä¸ä¼šå½±å“å®å‚çš„å€¼ï¼Œé™¤éä½¿ç”¨äº†å¼•ç”¨ä¼ é€’æˆ–æŒ‡é’ˆã€‚</p><p>ä½œç”¨åŸŸé“¾ï¼šåœ¨æ”¯æŒé—­åŒ…çš„è¯­è¨€ä¸­ï¼Œå±€éƒ¨å˜é‡å¯ä»¥è¢«åµŒå¥—å‡½æ•°è®¿é—®ï¼Œå½¢æˆä½œç”¨åŸŸé“¾ã€‚</p><p>é‡ç”¨æ€§ï¼šå±€éƒ¨å˜é‡çš„åç§°å¯ä»¥åœ¨ä¸åŒçš„å‡½æ•°æˆ–ä»£ç å—ä¸­é‡å¤ä½¿ç”¨ï¼Œå› ä¸ºå®ƒä»¬çš„ä½œç”¨åŸŸæ˜¯ç‹¬ç«‹çš„ã€‚</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Mainæ–¹æ³•å¼€å§‹æ‰§è¡Œ&quot;</span>);</span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// å®šä¹‰ä¸€ä¸ªå±€éƒ¨å˜é‡</span></span><br><span class="line">            <span class="built_in">int</span> localVar = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// localVarä»…åœ¨è¿™ä¸ªä»£ç å—å†…éƒ¨å¯è§</span></span><br><span class="line">            Console.WriteLine(<span class="string">&quot;å±€éƒ¨å˜é‡çš„å€¼: &quot;</span> + localVar);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åœ¨è¿™ä¸ªç‚¹ï¼ŒlocalVarä¸å†å­˜åœ¨ï¼Œå› ä¸ºå®ƒçš„ä½œç”¨åŸŸå·²ç»ç»“æŸ</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2.åœ¨C#ä¸­ï¼Œå…¨å±€ä½œç”¨åŸŸçš„æ¦‚å¿µä¸ä¼ ç»Ÿçš„å…¨å±€å˜é‡æœ‰æ‰€ä¸åŒã€‚C#æ˜¯ä¸€ç§é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ï¼Œå®ƒé¼“åŠ±å°è£…å’Œæ¨¡å—åŒ–ï¼Œå› æ­¤å¹¶ä¸ç›´æ¥æ”¯æŒä¼ ç»Ÿæ„ä¹‰ä¸Šçš„å…¨å±€å˜é‡ã€‚ç„¶è€Œï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‡ ç§æ–¹å¼æ¥å®ç°å…¨å±€å¯è®¿é—®çš„æ•°æ®ï¼š</p><blockquote><p>é™æ€æˆå‘˜å˜é‡å’Œé™æ€å±æ€§ï¼š<br>åœ¨C#ä¸­ï¼Œå¯ä»¥é€šè¿‡é™æ€ç±»å’Œé™æ€æˆå‘˜æ¥æ¨¡æ‹Ÿå…¨å±€å˜é‡çš„æ•ˆæœã€‚é™æ€æˆå‘˜å±äºç±»æœ¬èº«ï¼Œè€Œä¸æ˜¯ç±»çš„ä»»ä½•ç‰¹å®šå®ä¾‹ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">csharp</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">Global</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">int</span> GlobalValue = <span class="number">42</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨ç¨‹åºçš„ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥è¿™æ ·è®¿é—®</span></span><br><span class="line"><span class="built_in">int</span> <span class="keyword">value</span> = Global.GlobalValue;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Csharp </tag>
            
            <tag> Visual Studio 2022 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>forè¯­å¥å­¦ä¹ ç¬”è®°</title>
      <link href="/2024/11/12/for%E8%AF%AD%E5%8F%A5/"/>
      <url>/2024/11/12/for%E8%AF%AD%E5%8F%A5/</url>
      
        <content type="html"><![CDATA[<h1 id="forå¾ªç¯ç¬”è®°"><a href="#forå¾ªç¯ç¬”è®°" class="headerlink" title="forå¾ªç¯ç¬”è®°"></a><font size="8"></b>forå¾ªç¯ç¬”è®°</font></b></h1><blockquote><p>forå¾ªç¯è¾“å‡ºæ‰§è¡Œå¾ªç¯æ¬¡æ•°<br>for(åˆå§‹åŒ–ï¼›æ¡ä»¶è¡¨è¾¾å¼ï¼›å¢é‡è¡¨è¾¾å¼)<br>{  &#x2F;&#x2F;å¾ªç¯ä½“<br>}</p></blockquote><p><b><font size="5">1.fotå¾ªç¯çš„åŸºæœ¬ç»“æ„</font></b></p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>;i&lt;<span class="number">10</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><b><font size="5">2.fotè¯­å¥çš„å…ƒç´ </font></b></p><blockquote><p>â€œåˆå§‹åŒ–è¡¨è¾¾å¼â€éƒ¨åˆ†ä»…åœ¨è¿›å…¥å¾ªç¯å‰æ‰§è¡Œä¸€æ¬¡ã€‚ é€šå¸¸ï¼Œåœ¨è¯¥éƒ¨åˆ†ä¸­å£°æ˜å¹¶åˆå§‹åŒ–å±€éƒ¨å¾ªç¯å˜é‡ã€‚ ä¸èƒ½ä» for è¯­å¥å¤–éƒ¨è®¿é—®å£°æ˜çš„å˜é‡ã€‚</p></blockquote><p>ä¸Šä¾‹ä¸­çš„â€œåˆå§‹åŒ–è¡¨è¾¾å¼â€éƒ¨åˆ†å£°æ˜å¹¶åˆå§‹åŒ–æ•´æ•°è®¡æ•°å™¨å˜é‡ï¼š</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> i = <span class="number">0</span></span><br></pre></td></tr></table></figure><blockquote><p>â€œæ¡ä»¶â€éƒ¨åˆ†ç¡®å®šæ˜¯å¦åº”æ‰§è¡Œå¾ªç¯ä¸­çš„ä¸‹ä¸€ä¸ªè¿­ä»£ã€‚ å¦‚æœè®¡ç®—ç»“æœä¸º true æˆ–ä¸å­˜åœ¨ï¼Œåˆ™æ‰§è¡Œä¸‹ä¸€ä¸ªè¿­ä»£ï¼›å¦åˆ™é€€å‡ºå¾ªç¯ã€‚ â€œæ¡ä»¶â€éƒ¨åˆ†å¿…é¡»ä¸ºå¸ƒå°”è¡¨è¾¾å¼ã€‚</p></blockquote><p>ä¸Šä¾‹ä¸­çš„â€œæ¡ä»¶â€æ¡ä»¶éƒ¨åˆ†æ£€æŸ¥è®¡æ•°å™¨å€¼æ˜¯å¦å°äº 10ï¼š</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">i&lt;<span class="number">10</span></span><br></pre></td></tr></table></figure><blockquote><p>â€œè¿­ä»£å™¨â€éƒ¨åˆ†å®šä¹‰å¾ªç¯ä¸»ä½“çš„æ¯æ¬¡æ‰§è¡Œåå°†æ‰§è¡Œçš„æ“ä½œã€‚</p></blockquote><p>ä¸Šä¾‹ä¸­çš„â€œè¿­ä»£å™¨â€éƒ¨åˆ†å¢åŠ è®¡æ•°å™¨ï¼š</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">i++</span><br></pre></td></tr></table></figure><blockquote><p>å¾ªç¯ä½“ï¼Œå¿…é¡»æ˜¯ä¸€ä¸ªè¯­å¥æˆ–ä¸€ä¸ªè¯­å¥å—ã€‚</p></blockquote><h2 id="ç”¨forå¾ªç¯è¿›è¡Œç®€å•çš„è®¡ç®—"><a href="#ç”¨forå¾ªç¯è¿›è¡Œç®€å•çš„è®¡ç®—" class="headerlink" title="ç”¨forå¾ªç¯è¿›è¡Œç®€å•çš„è®¡ç®—"></a><font size="7">ç”¨forå¾ªç¯è¿›è¡Œç®€å•çš„è®¡ç®—</font></h2><p><font size="5"><b>1.è¿›è¡Œè®¡ç®—æ•´æ•°1-100çš„å’Œ<font></b></p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">1</span>;i&lt;<span class="number">101</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line">    sum += i; </span><br><span class="line">&#125;</span><br><span class="line">Console.WriteLine(sum);</span><br><span class="line">                          </span><br></pre></td></tr></table></figure><p><font size="5"></b>2.æ±‚1-100çš„å¶æ•°</font></b></p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">1</span>;i&lt;<span class="number">101</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (i % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><font size="5"><b>3.è¾“å…¥ä¿©ä¸ªæ•´æ•°nå’Œmï¼Œè®¡ç®—nå’Œmï¼ˆåŒ…æ‹¬nå’Œm)æ‰€æœ‰èƒ½è¢«17æ•´é™¤çš„æ•°çš„å’Œï¼Œå¹¶è¾“å‡ºå’Œã€‚</font></b> </p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> n=Convert.ToInt32(Console.ReadLine());</span><br><span class="line"><span class="built_in">int</span> m=Convert.ToInt32(Console.ReadLine());</span><br><span class="line"><span class="built_in">int</span> sum = <span class="number">0</span>;</span><br><span class="line"> <span class="keyword">for</span>(<span class="built_in">int</span> i = n; i &lt;= m; i++)</span><br><span class="line"> &#123;</span><br><span class="line">     <span class="keyword">if</span> (i % <span class="number">17</span> == <span class="number">0</span>)</span><br><span class="line">     &#123;</span><br><span class="line">         sum += i;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> Console.WriteLine(sum);</span><br></pre></td></tr></table></figure><p> <font size="5"><b>4.è¾“å…¥ä¿©ä¸ªæ•´æ•°nå’Œmï¼Œåˆ©ç”¨forå¾ªç¯æ‰“å°å‡ºnå’Œmä¹‹é—´ï¼ˆåŒ…å«nå’Œmï¼‰ï¼Œæ‰€ç”¨çš„å¥‡æ•°å’Œæ‰€ç”¨çš„å¶æ•°ã€‚<br> å¥‡æ•°æ”¾ä¸€è¡Œï¼Œç”¨ç©ºæ ¼åˆ†å‰²ã€‚å¶æ•°æ”¾ä¸€è¡Œï¼Œç”¨ç©ºæ ¼åˆ†å‰²ã€‚</font></b></p><blockquote><p>åº”ä¸ºè¦åŒæ—¶è¾“å‡ºå¥‡æ•°å’Œå¶æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå®šä¹‰ä¿©ä¸ªå­—ç¬¦ä¸²(string)è¿›è¡Œå­˜å‚¨ã€‚<br> <figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"> <span class="built_in">int</span> n=Convert.ToInt32(Console.ReadLine());</span><br><span class="line"><span class="built_in">int</span> m=Convert.ToInt32(Console.ReadLine());</span><br><span class="line"><span class="built_in">string</span> oddNumbers = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="built_in">string</span> numbered = <span class="string">&quot;&quot;</span>;</span><br><span class="line"> <span class="keyword">for</span>(<span class="built_in">int</span> i = n; i &lt;= m; i++)</span><br><span class="line"> &#123;</span><br><span class="line">     <span class="keyword">if</span> (i % <span class="number">2</span> == <span class="number">1</span>)</span><br><span class="line">     &#123;</span><br><span class="line">         oddNumbers += i+<span class="string">&quot; &quot;</span>;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">else</span></span><br><span class="line">     &#123;</span><br><span class="line">         numbered += i+<span class="string">&quot; &quot;</span>;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> Console.WriteLine(oddNumbers);</span><br><span class="line"> Console.WriteLine(numbered);</span><br></pre></td></tr></table></figure></p></blockquote><h2 id="breakè¯­å¥"><a href="#breakè¯­å¥" class="headerlink" title="breakè¯­å¥"></a><font size="8"><b>breakè¯­å¥</font></b></h2><blockquote><p>break è¯­å¥ï¼šå°†ç»ˆæ­¢æœ€æ¥è¿‘çš„å°é—­è¿­ä»£è¯­å¥ï¼ˆå³ forã€foreachã€while æˆ– do å¾ªç¯ï¼‰æˆ– switch è¯­å¥ã€‚ break è¯­å¥å°†æ§åˆ¶æƒè½¬äº¤ç»™å·²ç»ˆæ­¢è¯­å¥åé¢çš„è¯­å¥</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> ( ; ; )</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine( i );</span><br><span class="line">    i++;</span><br><span class="line">    <span class="keyword">if</span> (i &gt; <span class="number">10</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Csharp </tag>
            
            <tag> Visual Studio 2022 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>whileå¾ªç¯è¯­å¥</title>
      <link href="/2024/11/10/while%E8%AF%AD%E5%8F%A5/"/>
      <url>/2024/11/10/while%E8%AF%AD%E5%8F%A5/</url>
      
        <content type="html"><![CDATA[<h1 id="whileå¾ªç¯è¯­å¥"><a href="#whileå¾ªç¯è¯­å¥" class="headerlink" title="whileå¾ªç¯è¯­å¥"></a><font size="8"></b>whileå¾ªç¯è¯­å¥</font></b></h1><blockquote><p>åœ¨æŒ‡å®šçš„å¸ƒå°”è¡¨è¾¾å¼çš„è®¡ç®—ç»“æœä¸º true æ—¶ï¼Œwhile è¯­å¥ä¼šæ‰§è¡Œä¸€æ¡è¯­å¥æˆ–ä¸€ä¸ªè¯­å¥å—ã€‚ ç”±äºåœ¨æ¯æ¬¡æ‰§è¡Œå¾ªç¯ä¹‹å‰éƒ½ä¼šè®¡ç®—æ­¤è¡¨è¾¾å¼ï¼Œæ‰€ä»¥ while å¾ªç¯ä¼šæ‰§è¡Œé›¶æ¬¡æˆ–å¤šæ¬¡ã€‚</p></blockquote><h2 id="whileè¯­å¥åŸºæœ¬ç»“æ„"><a href="#whileè¯­å¥åŸºæœ¬ç»“æ„" class="headerlink" title="whileè¯­å¥åŸºæœ¬ç»“æ„"></a><font size="5"><b>whileè¯­å¥åŸºæœ¬ç»“æ„</font></b></h2><p><img src="/img%5Cyouxin%5Cwhile1.png"><br><b>1.whileè¯­å¥åŸºæœ¬ç”¨æ³•</b></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">int x = 1;</span><br><span class="line">while (x&lt;10)    //æ¡ä»¶åˆ¤æ–­</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(x);</span><br><span class="line">    x++;</span><br><span class="line">&#125;</span><br><span class="line">Console.WriteLine(&quot;x&gt;10&quot;);   //æ¡ä»¶ä¸æ»¡è¶³ï¼Œæ‰§è¡Œä»£ç </span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="whileå¾ªç¯æ±‚å’Œ"><a href="#whileå¾ªç¯æ±‚å’Œ" class="headerlink" title="whileå¾ªç¯æ±‚å’Œ"></a><font size="5"><b>whileå¾ªç¯æ±‚å’Œ</font></b></h2><p><b>1.æ§åˆ¶å¾ªç¯æ¬¡æ•°ï¼Ÿå¾ªç¯1-100ã€‚</b></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">int x=1;</span><br><span class="line">while(x&lt;100)</span><br><span class="line">&#123;</span><br><span class="line">    Console.WriteLine(x);</span><br><span class="line">    x++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><b>2.ç”¨whileå°±1-100çš„æ•´æ•°å’Œ</b><br> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"> //ç¬¬ä¸€ç§æ–¹å¼//å±€é™æ€§ã€å›ºå®šçš„å¾ªç¯æ¬¡æ•°</span><br><span class="line"> int a = 1;</span><br><span class="line">int sum = 0;    //å­˜æ”¾å’Œ</span><br><span class="line">while (a &lt; 101)</span><br><span class="line">&#123;</span><br><span class="line">    sum += a;  //sun=sum+a</span><br><span class="line">    a++;</span><br><span class="line">&#125;</span><br><span class="line">Console.WriteLine(sum);</span><br><span class="line"></span><br><span class="line">//ç¬¬äºŒç§æ–¹å¼//å¯ä»¥è®¾ç½®ä½ åƒè¾“å‡ºçš„å¾ªç¯æ¬¡æ•°</span><br><span class="line"> int n=Convert.ToInt32(Console.ReadLine());</span><br><span class="line"> int a = 1;</span><br><span class="line"> int sum = 0;</span><br><span class="line"> while (a &lt; n+1)</span><br><span class="line"> &#123;</span><br><span class="line">     sum += a;</span><br><span class="line">     a++;</span><br><span class="line"> &#125;</span><br><span class="line"> Console.WriteLine(sum);</span><br></pre></td></tr></table></figure><br><b>3.è¾“å‡º1-100çš„å¶æ•°</b></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">int n = Convert.ToInt32(Console.ReadLine());</span><br><span class="line">int a = 1;</span><br><span class="line">while (a &lt; n+1)</span><br><span class="line">&#123;</span><br><span class="line">    if (a % 2 == 0)</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(a);</span><br><span class="line">    &#125;</span><br><span class="line">    a++;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><b>4.è¾“å…¥ä¿©ä¸ªæ•´æ•°n1,n2,è¾“å‡ºn1-n2ä¹‹é—´æ‰€æœ‰çš„å¶æ•°</b></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">int n1=Convert.ToInt32(Console.ReadLine());</span><br><span class="line">int n2=Convert.ToInt32(Console.ReadLine());</span><br><span class="line">while (n1 &lt; n2 + 1)</span><br><span class="line">&#123;</span><br><span class="line">    if (n1 % 2 == 0)</span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(n1);</span><br><span class="line">    &#125;</span><br><span class="line">    n1++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><b>5.3n+1:å¯¹äºä»»æ„å¤§äº1çš„è‡ªç„¶æ•°nï¼Œè‹¥nä¸ºå¥‡æ•°ï¼Œå°†nç¼–ç¨‹3n+1ï¼Œå¦åˆ™å˜æˆnçš„ä¸€åŠã€‚ç»è¿‡è‹¥å¹²æ¬¡è¿™æ ·çš„å˜åŒ–ï¼Œnä¸€å®šä¼šæœ€ç»ˆå˜æˆ1ï¼Œæ¯”å¦‚ï¼Œ7â†’22â†’11â†’34â†’17â†’52â†’26â†’13â†’40â†’20â†’10â†’5â†’16â†’8â†’4â†’2â†’1<br>è¾“å…¥nï¼Œè¾“å‡ºå˜åŒ–æ¬¡æ•°ã€‚</b></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">int num = Convert.ToInt32(Console.ReadLine());</span><br><span class="line">int a = 0;</span><br><span class="line">while (num != 1)</span><br><span class="line">&#123;</span><br><span class="line">    if (num % 2 == 1)</span><br><span class="line">    &#123;</span><br><span class="line">        num = 3 * num + 1;</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line">        num /= 2;</span><br><span class="line">    &#125;</span><br><span class="line">    a++;</span><br><span class="line">    Console.WriteLine(&quot;å˜æ¢åçš„å€¼&quot;+num);</span><br><span class="line">&#125; Console.WriteLine(&quot;å˜æ¢çš„æ¬¡æ•°&quot;+a);</span><br></pre></td></tr></table></figure><h1 id="do-whileå¾ªç¯å­¦ä¹ ç¬”è®°"><a href="#do-whileå¾ªç¯å­¦ä¹ ç¬”è®°" class="headerlink" title="do-whileå¾ªç¯å­¦ä¹ ç¬”è®°"></a><font size="8"><b>do-whileå¾ªç¯å­¦ä¹ ç¬”è®°</font></b></h1><h2 id="do-whileçš„åŸºæœ¬ç»“æ„"><a href="#do-whileçš„åŸºæœ¬ç»“æ„" class="headerlink" title="do-whileçš„åŸºæœ¬ç»“æ„"></a><font size="6"><b>do-whileçš„åŸºæœ¬ç»“æ„</font></b></h2><blockquote><p>åœ¨æŒ‡å®šçš„å¸ƒå°”è¡¨è¾¾å¼çš„è®¡ç®—ç»“æœä¸º true æ—¶ï¼Œdo è¯­å¥ä¼šæ‰§è¡Œä¸€æ¡è¯­å¥æˆ–ä¸€ä¸ªè¯­å¥å—ã€‚ ç”±äºåœ¨æ¯æ¬¡æ‰§è¡Œå¾ªç¯ä¹‹åéƒ½ä¼šè®¡ç®—æ­¤è¡¨è¾¾å¼ï¼Œæ‰€ä»¥ do å¾ªç¯ä¼šæ‰§è¡Œä¸€æ¬¡æˆ–å¤šæ¬¡ã€‚ do å¾ªç¯ä¸åŒäº while å¾ªç¯ï¼ˆè¯¥å¾ªç¯æ‰§è¡Œé›¶æ¬¡æˆ–å¤šæ¬¡ï¼‰ã€‚</p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> n = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">    Console.Write(n);</span><br><span class="line">    n++;</span><br><span class="line">&#125; <span class="keyword">while</span> (n &lt; <span class="number">5</span>);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Csharp </tag>
            
            <tag> Visual Studio 2022 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å®‰è£…AEæ’ä»¶</title>
      <link href="/2024/11/06/%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6/"/>
      <url>/2024/11/06/%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="AEæ’ä»¶çš„å®‰è£…"><a href="#AEæ’ä»¶çš„å®‰è£…" class="headerlink" title="AEæ’ä»¶çš„å®‰è£…"></a><font size="8">AEæ’ä»¶çš„å®‰è£…</font></h1><blockquote><p>å­¦å‰ªè¾‘æƒ³è¦æœ‰ç”µå½±é‚£æ ·çš„å¥½çœ‹ç‰¹æ•ˆå°±å°‘ä¸äº†æ’ä»¶çš„å¸®åŠ©ï¼Œè¿™æœŸæ•™å¤§å®¶ä¸‹è½½æ’ä»¶</p></blockquote><h2 id="æ’ä»¶åœ¨å“ªä¸‹è½½å‘¢ï¼Ÿ"><a href="#æ’ä»¶åœ¨å“ªä¸‹è½½å‘¢ï¼Ÿ" class="headerlink" title="æ’ä»¶åœ¨å“ªä¸‹è½½å‘¢ï¼Ÿ"></a><font size="6">æ’ä»¶åœ¨å“ªä¸‹è½½å‘¢ï¼Ÿ</font></h2><p><font size="4"><b>1.è¿˜æ˜¯æœ‰å¾ˆå¤šäººä¸çŸ¥é“æ’ä»¶åœ¨å“ªä¸‹è½½ï¼Œæœ‰å¾ˆå¤šäººåœ¨bç«™æœAEæ’ä»¶å®‰è£…ï¼ŒåŸºæœ¬éƒ½æ˜¯éƒ½æ˜¯åŠ å¾®ä¿¡ï¼Œäº¤é’±è¿›ç¾¤å•¥çš„ï¼æµªè´¹æ—¶é—´å’Œé’±æ’ä»¶è¿˜æ²¡æ‹¿åˆ°ã€‚</font></b></p><blockquote><p>è¿™é‡Œæˆ‘åˆ†äº«æœ€å…¨çš„ä¸‹æ’ä»¶ç½‘ç«™ï¼š<a href="https://www.lookae.com/">https://www.lookae.com/</a></p></blockquote><h2 id="å®‰è£…æ­¥éª¤"><a href="#å®‰è£…æ­¥éª¤" class="headerlink" title="å®‰è£…æ­¥éª¤"></a><font size="6">å®‰è£…æ­¥éª¤</font></h2><p><font size="4"><b>1.æ‰“å¼€looke.aeè¿™ä¸ªç½‘ç«™ï¼Œåœ¨æœç´¢æ¡†ä¸­è¾“å…¥ä½ è¦å®‰è£…çš„æ’ä»¶ï¼Œåšä¸»å°±ç”¨<font color="red">Magic Bullet Suite v2023.2.1ï¼ˆçº¢å·¨äººï¼‰</font>è¿™ä¸ªæ’ä»¶æ¥æ•™å¤§å®¶å®‰è£…ï¼š</font></b></p><blockquote><p>è¿™ä¸ªä¹Ÿæ˜¯åšå‰ªè¾‘å¸¸ç”¨çš„è°ƒè‰²æ’ä»¶</p></blockquote><p><font size="4"><b>2.ç¬¬ä¸€æ­¥ï¼Œæ‰¾åˆ°è¦ä¸‹è½½çš„æ’ä»¶å¹¶çœ‹å®ƒæ˜¯å¦æ”¯æŒä½ çš„AEçš„ç‰ˆæœ¬ï¼Œé€‰æ‹©ä¸‹è½½æ–¹å¼ã€‚</font></b></p><blockquote><p>ä¸‹é¢ä¸­æ–‡æ±‰åŒ–æ˜¯éœ€è¦ä»˜è´¹çš„ä¸”æ›´æ–°æ²¡æœ‰è‹±æ–‡çš„å¿«ï¼ˆæ¨èè‹±æ–‡ç‰ˆï¼‰</p></blockquote><p><img src="/img%5Cyouxin%5CMan.png"><br><font size="4"><b>3.å°†æˆ‘ä»¬ä¸‹è½½çš„æ–‡ä»¶è¿›è¡Œè§£å‹ï¼ˆæ¨èBandizipè¿™ä¸ªè§£å‹è½¯ä»¶ï¼Œç”µè„‘è‡ªå¸¦çš„å¾®è½¯å•†åº—å°±å¯ä»¥ä¸‹è½½åˆ°.ï¼‰</font></b><br><img src="/img%5Cyouxin%5CMan1.png"></p><h2 id="æŒ‰ç…§æ­¥éª¤å³å¯"><a href="#æŒ‰ç…§æ­¥éª¤å³å¯" class="headerlink" title="æŒ‰ç…§æ­¥éª¤å³å¯"></a>æŒ‰ç…§æ­¥éª¤å³å¯</h2><p><font size="4"><b>4. 1..Maxon_App_2023.2.2_Win.exeï¼Œä¸è¦ç™»å½•ï¼Œå®‰è£…å®Œæˆä¹‹åå…³é—­å³å¯<br>2.å®‰è£…Magic Bullet Suite Installer.exeï¼Œå®‰è£…å®Œæˆä¹‹åå…³é—­å³å¯<br>3.å®‰è£…Unlocker 2023.2.1.exeï¼Œå³å¯å®Œæˆæ¿€æ´»ã€‚</font></b></p>]]></content>
      
      
      <categories>
          
          <category> AE </category>
          
          <category> æ’ä»¶ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ç´ æè¡¥å¸§ã€4k</title>
      <link href="/2024/11/04/%E7%B4%A0%E6%9D%90%E8%A1%A5%E5%B8%A7%EF%BC%8C4k/"/>
      <url>/2024/11/04/%E7%B4%A0%E6%9D%90%E8%A1%A5%E5%B8%A7%EF%BC%8C4k/</url>
      
        <content type="html"><![CDATA[<h1 id="ç»™ç´ æè¡¥å¸§è®©è§†é¢‘å˜å¾—ä¸æ»‘"><a href="#ç»™ç´ æè¡¥å¸§è®©è§†é¢‘å˜å¾—ä¸æ»‘" class="headerlink" title="ç»™ç´ æè¡¥å¸§è®©è§†é¢‘å˜å¾—ä¸æ»‘"></a>ç»™ç´ æè¡¥å¸§è®©è§†é¢‘å˜å¾—ä¸æ»‘</h1><h2 id="å‰æ"><a href="#å‰æ" class="headerlink" title="å‰æ"></a>å‰æ</h2><blockquote><p>ç»™è§†é¢‘è¡¥å¸§ï¼Œå…ˆç»™è§†é¢‘è¿›è¡ŒæŠ½å¸§åœ¨è¡¥å¸§æ•ˆæœæ›´å¥½ï¼Œä¸‹é¢æ˜¯æ“ä½œæ­¥éª¤ï¼š</p></blockquote><p>1.å°†è§†é¢‘å¯¼å…¥AE,æŠ½å¸§å°±æ˜¯ä»¥ä½ è¦è¡¥å¸§çš„äººç‰©ï¼ˆä¸»ä½“ï¼‰ä¸ºç¬¬ä¸€è¦ç´ ï¼Œç¬¬ä¸€è¦ç´ åŠ¨äº†å°±è£å‰ªä¸€æ¬¡ï¼š</p><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;border-radius: 12px">    <iframe src="//player.bilibili.com/player.html?isOutside=true&aid=113429784298208&bvid=BV1uTDhYTEBV&cid=26627605593&p=1" page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position:absolute; height: 80%; width: 100%;border-radius: 12px"> </iframe></div>2.å°†è§†é¢‘ç”¨Meå¯¼å‡ºæ¥ï¼ˆä¹Ÿæ˜¯looked.aeä¸‹è½½ï¼‰ï¼Œåœ¨è¿›è¡Œè¡¥å¸§ã€‚<blockquote><p>1.æˆ‘åœ¨è¿™é‡Œåˆ†äº«ä¸¤ä¸ªå¥½ç”¨çš„è¡¥å¸§è½¯ä»¶ï¼Œè®©ä½ çš„è§†é¢‘ä¸æ»‘æ— æ¯”ã€‚</p></blockquote><h2 id="ç¬¬ä¸€ä¸ªï¼šFlowframes"><a href="#ç¬¬ä¸€ä¸ªï¼šFlowframes" class="headerlink" title="ç¬¬ä¸€ä¸ªï¼šFlowframes"></a>ç¬¬ä¸€ä¸ªï¼š<font color="blue">Flowframes</font></h2><p>2.ç¬¬ä¸€æ­¥æ‰“å¼€flow,å¦‚å›¾ï¼šâ†“<br><img src="/img%5Cflow.png"><br>3.ç‚¹å‡»Browse(Video)ï¼Œé€‰æ‹©è¦è¡¥å¸§çš„ç‰‡æ®µï¼Œåœ¨é€‰æ‹©ä½ è¦è¡¥çš„å¸§æ•°æŒ‰interpolateå¼€å§‹è¡¥å¸§ã€‚</p><h2 id="ç¬¬äºŒä¸ªï¼šSVFI"><a href="#ç¬¬äºŒä¸ªï¼šSVFI" class="headerlink" title="ç¬¬äºŒä¸ªï¼šSVFI"></a>ç¬¬äºŒä¸ªï¼š<font color="blue">SVFI</font></h2><p>1.è¿™ä¸ªè¡¥å¸§è½¯ä»¶æ˜¯æˆ‘ç”¨è¿‡æœ€å¥½çš„ï¼Œå”¯ä¸€çš„ç¼ºç‚¹å°±æ˜¯è¦é’±ä½†åªè¡¥å¸§çš„è¯åªéœ€ä¹°ç¤¾åŒºæœ43å…ƒï¼ˆsteamä¸Šé¢è´­ä¹°ï¼‰ï¼Œè¿™ä¸ªè½¯ä»¶è¿˜å¯ä»¥è¡¥4Kã€8kã€è¶…åˆ†ã€‚ï¼ˆä½†è¦ä¹°ä¸“ä¸šç‰ˆ328ï¼‰<br>æˆ‘è¿™æœ‰å¹³æ›¿ï¼Œä»–å°±æ˜¯ï¼š<font size="5">VideoAIportable</font></p><h2 id="ç¬¬äºŒä¸ªï¼šSVFI-1"><a href="#ç¬¬äºŒä¸ªï¼šSVFI-1" class="headerlink" title="ç¬¬äºŒä¸ªï¼šSVFI"></a>ç¬¬äºŒä¸ªï¼š<font color="blue">SVFI</font></h2><p>1.è¿™ä¸ªè¡¥å¸§è½¯ä»¶æ˜¯æˆ‘ç”¨è¿‡æœ€å¥½çš„ï¼Œå”¯ä¸€çš„ç¼ºç‚¹å°±æ˜¯è¦é’±ä½†åªè¡¥å¸§çš„è¯åªéœ€ä¹°ç¤¾åŒºæœ43å…ƒï¼ˆsteamä¸Šé¢è´­ä¹°ï¼‰ï¼Œè¿™ä¸ªè½¯ä»¶è¿˜å¯ä»¥è¡¥4Kã€8kã€è¶…åˆ†ã€‚ï¼ˆä½†è¦ä¹°ä¸“ä¸šç‰ˆ328ï¼‰<br>æˆ‘è¿™æœ‰å¹³æ›¿ï¼Œä»–å°±æ˜¯ï¼š<font size="5">Topaz VideoAIportable</font></p><p>2.å…ˆç”¨SVFIè¿›è¡Œè¡¥å¸§ã€‚æ‰“å¼€SVFIçš„é«˜çº§è®¾ç½®å…ˆè¿›è¡Œè°ƒè¯•ï¼Œå¯ä»¥å‚è€ƒæˆ‘çš„æ¥ï¼š<br>ä¸€.<img src="/img%5Cyouxin%5Csvfi.png"><br>äºŒ.<img src="/img%5Cyouxin%5Csvfi1.png"><br>ä¸‰.<img src="/img%5Cyouxin%5Csvfi2.png"><br>å››.<img src="/img%5Cyouxin%5Csvfi3.png"></p><h2 id="è§†é¢‘è¡¥4K"><a href="#è§†é¢‘è¡¥4K" class="headerlink" title="è§†é¢‘è¡¥4K"></a>è§†é¢‘è¡¥4K</h2><p>æ²¡æœ‰ <font size="4">Topaz VideoAIportable</font> çš„åœ¨looke.aeä¹Ÿå¯ä»¥ä¸‹è½½çš„ã€‚</p><p>1.æ‰“å¼€<font size="4">Topaz VideoAIportable</font>å¯¼å…¥ç´ æå¯ä»¥æŒ‰ç…§æˆ‘è¿™æ ·è®¾ç½®ï¼š<br><img src="/img%5Cyouxin%5CTopaz.png"><br><font size="4">è¯·çœ‹å¯¹æ¯”</font></p><p><img src="/img%5Cyouxin%5CTopaz1.png"><br>2.å¯¼å‡ºå³å¯</p>]]></content>
      
      
      <categories>
          
          <category> AE </category>
          
          <category> SVFI </category>
          
          <category> Topaz VideoAIportable </category>
          
          <category> Flowframes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>AEç´ æè·å–</title>
      <link href="/2024/10/30/AE%E7%B4%A0%E6%9D%90%E6%8F%90%E7%BA%AF/"/>
      <url>/2024/10/30/AE%E7%B4%A0%E6%9D%90%E6%8F%90%E7%BA%AF/</url>
      
        <content type="html"><![CDATA[<h1 id="å­¦ä¹ æ¼«å‰ªç¬¬ä¸€æ­¥ï¼šè·å–ç´ æ"><a href="#å­¦ä¹ æ¼«å‰ªç¬¬ä¸€æ­¥ï¼šè·å–ç´ æ" class="headerlink" title="å­¦ä¹ æ¼«å‰ªç¬¬ä¸€æ­¥ï¼šè·å–ç´ æ"></a><b>å­¦ä¹ æ¼«å‰ªç¬¬ä¸€æ­¥ï¼šè·å–ç´ æ</b></h1><blockquote><p>æˆ‘ä»¬ä¸‹å¥½è½¯ä»¶ä¹‹å’Œå°±æ˜¯å»å¯»æ‰¾ç´ æï¼Œå¾ˆå¤šäººéƒ½ä¸çŸ¥é“æˆ–æ˜¯ç”¨å½•é¢‘è½¯ä»¶å»å½•åˆ¶å¸¦å­—å¹•çš„è§†é¢‘ï¼Œè¿™é‡Œæˆ‘åˆ†äº«èµ„æºå¤šå¯ä»¥ä¸‹è½½ç”Ÿè‚‰çš„ç½‘ç«™ã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://mikanime.tv/</span><br></pre></td></tr></table></figure><p>1.è¿™ä¸ªç½‘ç«™åªèƒ½ä¸‹è½½ç§å­åˆ°è¿…é›·æŠŠè§†é¢‘ä¸‹è½½ä¸‹æ¥ã€‚</p><blockquote><p>çœ‹åˆ°è¿™å°±æœ‰äººé—®åšä¸»åšä¸»ç½‘ä¸Šä¸æ˜¯æœ‰å¾ˆå¤šå…è´¹bitä¸‹è½½è½¯ä»¶ï¼Œåšä¸»ä¸ºå•¥è¿˜æ˜¯æ¨èè¿…é›·å‘¢ï¼Ÿ<br>å› ä¸ºè¿…é›·ä¸å……é’±ä¹Ÿæ¯”è¿™äº›å…è´¹bitä¸‹è½½é€Ÿåº¦å¿«ã€‚</p></blockquote><p>2.ä¸‹é¢æ˜¯å›¾ç‰‡æè¿°ï¼š<br><img src="/img/mingan.png" alt="å›¾ç‰‡æè¿°"><br>3.ç„¶åæœç´¢ä½ è¦ä¸‹è½½çš„åŠ¨æ¼«ç§å­ï¼Œç‚¹å‡»ç§å­è‡ªåŠ¨è·³è½¬è¿…é›·ä¸‹è½½æ‰€é€‰æ‹©çš„ç›˜ã€‚<br><img src="/img/mangan1.png" alt="å›¾ç‰‡æè¿°"><br>4.<b>åšä¸»å‰æœŸå‡ºä¸€äº›æ“ä½œç®€å•ï¼Œå†…å®¹ä¸ä¼šå¾ˆå¤šä¸”å¥½ç†è§£çš„æ•™ç¨‹ã€‚</b></p>]]></content>
      
      
      <categories>
          
          <category> AE </category>
          
      </categories>
      
      
        <tags>
            
            <tag> èœœæŸ‘è®¡åˆ’ </tag>
            
            <tag> è¿…é›· </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ—¥å¸¸</title>
      <link href="/2024/10/30/YOUXIANDEYU/"/>
      <url>/2024/10/30/YOUXIANDEYU/</url>
      
        <content type="html"><![CDATA[<h1 id="åšä¸»çš„éšå¿ƒæ—¥å¸¸"><a href="#åšä¸»çš„éšå¿ƒæ—¥å¸¸" class="headerlink" title="åšä¸»çš„éšå¿ƒæ—¥å¸¸"></a></b><em>åšä¸»çš„éšå¿ƒæ—¥å¸¸</em></b></h1><h2 id="2024å¹´"><a href="#2024å¹´" class="headerlink" title="2024å¹´"></a>2024å¹´</h2><h3 id="11æœˆ1æ—¥"><a href="#11æœˆ1æ—¥" class="headerlink" title="11æœˆ1æ—¥"></a>11æœˆ1æ—¥</h3><!-- <div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;border-radius: 12px">    <iframe src="//player.bilibili.com/player.html?isOutside=true&aid=113316101884629&bvid=BV1TRmAYSE94&cid=26314608616&p=1" page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position:absolute; height: 80%; width: 100%;border-radius: 12px"> </iframe></div> --><blockquote><p>ä»Šå¤©æ˜æ—¥æ–¹èˆŸæ›´æ–°5.5å‘¨å¹´äº†ï¼ˆæœ‰æ²¡æœ‰å’Œåšä¸»ç©ä¸€æ ·çš„æ¸¸æˆå•Šï¼‰ï¼Œæ”’äº†70æŠ½å¼€å¼€å¿ƒå¿ƒä¸Šçº¿æŠ½å¡ï¼Œå‡ºäº†ä¿©ä¸ªé‡‘ï¼Œæ­ªäº†ä¸ªå”å”æ½œèƒ½+1ã€‚ç»™æˆ‘å‡ºä¸ªæ²¡æœ‰çš„éƒ½å¥½å•Šï¼<br>è¯´è¯´æˆ‘å¯¹è¿™æ¸¸æˆçš„è¯„ä»·å§ï¼Œ21å¹´é‚£ä¼šå„¿æˆ‘æ˜¯è¢«åŒå­¦å¸¦å…¥å‘çš„é‚£æ—¶ç¬¬ä¸€æ¬¡æ¥è§¦è¿™ç§ç±»å‹çš„æ¸¸æˆæ„Ÿè§‰å¾ˆå¥½ç©å¾ˆæ–°é¢–ï¼Œåé¢ä¹Ÿç©è¿‡å¾ˆå¤šè¿™ç§ç±»å‹çš„äºŒæ¸¸ä½†è¿˜æ˜¯æ˜æ—¥æ–¹èˆŸæ›´å¥½ï¼Œå°½ç®¡ç°åœ¨ä¸æ€ä¹ˆç©äº†ã€‚<br>å¯èƒ½æ˜¯æ–°é²œæ„Ÿè¿‡äº†å§ã€‚å…³å¡å‡ºçš„æ²¡æ„æ€ï¼ŒæŠ½å¡ä¸€ç›´æ˜¯éé…‹ã€‚å¦‚ä»Šæ¯å¤©ä¸Šçº¿å°±æ˜¯åˆ·ä½“åŠ›å®Œæˆæ¯æ—¥å°±ä¸‹äº†ã€‚<br>ç°åœ¨å”¯ä¸€å¥½ç©çš„çš„å°±æ˜¯å®ƒå‡ºçš„å±æœºåˆçº¦äº†ã€‚ğŸ¥±ğŸ¥±ğŸ¥±</p></blockquote><div style="position: relative; width: 100%; height: 0; padding-bottom: 75%;border-radius: 12px"><iframe src="//player.bilibili.com/player.html?isOutside=true&aid=113407286052207&bvid=BV1NgSRYbEAQ&cid=26564363331&p=1" page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position:absolute; height: 80%; width: 100%;border-radius: 12px"> </iframe></div><blockquote><p>æ–°å‡ºçš„å¡‘å¿ƒçš®è‚¤è¿˜æ˜¯å¾ˆå¥½çœ‹çš„ã€‚å–œæ¬¢ğŸ˜ğŸ˜ğŸ˜</p></blockquote><p><img src="/img/youxin/%E5%A1%91%E5%BF%83.jpg"><br><img src="/img/youxin/%E5%A1%91%E5%BF%831.jpg"></p><h3 id="11æœˆ3æ—¥"><a href="#11æœˆ3æ—¥" class="headerlink" title="11æœˆ3æ—¥"></a>11æœˆ3æ—¥</h3><blockquote><p>çœ‹å®ŒCS,2024BLASTå…¨çƒæ€»å†³èµ›ã€‚<br>æ­å–œG2å¤ºå† </p></blockquote><p><img src="/img/youxin/G2.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> æ—¥è®° </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>C# ifã€swatchå­¦ä¹ ç¬”è®°</title>
      <link href="/2024/10/30/%E5%AD%A6%E4%B9%A0%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"/>
      <url>/2024/10/30/%E5%AD%A6%E4%B9%A0%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/</url>
      
        <content type="html"><![CDATA[<blockquote><p>æœ¬äººæ˜¯ä¸€ååˆå­¦è€…ï¼Œæ¬¢è¿å„ä½å¤§ä½¬æŒ‡æ­£ã€‚<br>è®°å½•è‡ªå·±å­¦ä¹ c#è¿‡ç¨‹ä¸­çš„å¿ƒå¾—ä½“ä¼šã€‚</p></blockquote><p><font size="6"> C# ifã€switchçš„åŸºæœ¬å…³ç³»ä¸ä½¿ç”¨ </font><br></p><blockquote><p>1.ifè¯­å¥æœ‰ä¸¤ç§è¡¨è¾¾æ–¹å¼ï¼Œç¬¬1ç§æ˜¯åŒ…å« else éƒ¨åˆ†çš„ if è¯­å¥æ ¹æ®å¸ƒå°”è¡¨è¾¾å¼çš„å€¼é€‰æ‹©ä¸¤ä¸ªè¯­å¥ä¸­çš„ä¸€ä¸ªæ¥æ‰§è¡Œï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹æ‰€ç¤ºï¼š</p></blockquote><figure class="highlight c#"><figcaption><span>if else...</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="keyword">using</span> System.Threading.Tasks;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">ConsoleApp1</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">int</span> number=Convert.ToInt32(Console.ReadLine()); <span class="comment">//å®šä¹‰ä¸€ä¸ªæ•´æ•°</span></span><br><span class="line">           <span class="keyword">if</span> (number &gt;= <span class="number">0</span>)  <span class="comment">//æ¡ä»¶</span></span><br><span class="line">           &#123;</span><br><span class="line">                  Console.WriteLine(<span class="string">&quot;åšä¸»å¥½å¸…&quot;</span>); <span class="comment">// æ»¡è¶³æ¡ä»¶è¾“å‡º</span></span><br><span class="line">            &#125;</span><br><span class="line">             <span class="keyword">else</span>  </span><br><span class="line">             &#123;</span><br><span class="line">                  Console.WriteLine(<span class="string">&quot;åšä¸»æœ€å¸…&quot;</span>); <span class="comment">//ä¸æ»¡è¶³æ¡ä»¶è¾“å‡º</span></span><br><span class="line">              &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>2.ç¬¬äºŒç§æ˜¯elseåµŒå¥—ifè¯­å¥å¯ä»¥åˆ¤æ–­å¤šä¸ªæ¡ä»¶ï¼š</p></blockquote><figure class="highlight c#"><figcaption><span>else-if...</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="keyword">using</span> System.Threading.Tasks;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">ConsoleApp1</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">int</span> number=Convert.ToInt32(Console.ReadLine());  <span class="comment">//å®šä¹‰ä¸€ä¸ªæ•´æ•°</span></span><br><span class="line">            <span class="keyword">if</span> (number == <span class="number">0</span>)  <span class="comment">//æ¡ä»¶1</span></span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;YOU&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (number &gt; <span class="number">0</span>)  <span class="comment">//æ¡ä»¶2</span></span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;XIAN&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (number &lt; <span class="number">0</span>)  <span class="comment">//æ¡ä»¶3</span></span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;YU&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (number != <span class="number">0</span>)  <span class="comment">//æ¡ä»¶4</span></span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;YOUXIANYU&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;XX&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>3.switchè¯­å¥æ˜¯æ ¹æ®ä¸åŒ¹é…è¡¨è¾¾å¼åŒ¹é…çš„æ¨¡å¼æ¥é€‰æ‹©è¦æ‰§è¡Œçš„è¯­å¥åˆ—è¡¨ï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹æ‰€ç¤ºï¼š</p></blockquote><figure class="highlight c#"><figcaption><span>è¾“å…¥4ä¸ªæ•´æ•°ï¼Œåˆ¤æ–­æœ€å¤§å€¼å’Œæœ€å°å€¼</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="keyword">using</span> System.Threading.Tasks;</span><br><span class="line"><span class="keyword">using</span> System.Xml.Schema;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">switch</span>è¯­å¥2</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="built_in">int</span> a = Convert.ToInt32(Console.ReadLine());  <span class="comment">//å®šä¹‰ä¸€ä¸ªæ•´æ•°</span></span><br><span class="line">            <span class="built_in">int</span> b = Convert.ToInt32(Console.ReadLine());</span><br><span class="line">            <span class="built_in">int</span> c = Convert.ToInt32(Console.ReadLine());</span><br><span class="line">            <span class="built_in">int</span> d = Convert.ToInt32(Console.ReadLine());</span><br><span class="line"></span><br><span class="line">            <span class="built_in">int</span> max = a, min = a;  <span class="comment">//èµ‹å€¼</span></span><br><span class="line">            <span class="keyword">if</span> (max &lt; b)  </span><br><span class="line">            &#123;</span><br><span class="line">                max = b;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (max &lt; c)</span><br><span class="line">            &#123;</span><br><span class="line">                max = c;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (max &lt; d)</span><br><span class="line">            &#123;</span><br><span class="line">                max = d;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (min &gt; b)</span><br><span class="line">            &#123;</span><br><span class="line">                min = b;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (min &gt; c)</span><br><span class="line">            &#123;</span><br><span class="line">                min = c;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (min &gt; d)</span><br><span class="line">            &#123;</span><br><span class="line">                min = d;</span><br><span class="line">            &#125;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;æœ€å¤§çš„å€¼&#123;0&#125;ï¼Œæœ€å°çš„å€¼&#123;1&#125;.&quot;</span>, max, min);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;     </span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line">  </span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Csharpç¼–ç¨‹åŸºç¡€ </category>
          
          <category> Visual Studio 2022 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Csharp </tag>
            
            <tag> Visual Studio 2022 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•å®‰è£…Adobe AfterEffects 2022</title>
      <link href="/2024/10/29/%E6%BC%AB%E5%89%AA/"/>
      <url>/2024/10/29/%E6%BC%AB%E5%89%AA/</url>
      
        <content type="html"><![CDATA[<blockquote><p>è¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡å†™åšå®¢,å°±å†™ä¸€ä¸ªè‡ªå·±çƒ­çˆ±çš„æ¼«å‰ªã€‚<br>1.æ‰€ä»¥å°±ä»å®‰è£…Adobe AfterEffects 2022å¼€å§‹ï¼Œåˆ†äº«ä¸€ä¸‹è½¯ä»¶çš„å®‰è£…æ•™ç¨‹å§ï¼<br>åç»­è¿˜ä¼šæœ‰æ›´å¤šçš„æ•™ç¨‹åˆ†äº«ï¼</p></blockquote><h1 id="Adobe-AfterEffects-2022-å®‰è£…æ•™ç¨‹"><a href="#Adobe-AfterEffects-2022-å®‰è£…æ•™ç¨‹" class="headerlink" title="Adobe AfterEffects 2022 å®‰è£…æ•™ç¨‹"></a><em><strong>Adobe AfterEffects 2022 å®‰è£…æ•™ç¨‹</strong></em></h1><h2 id="1-ä¸‹è½½å®‰è£…åŒ…"><a href="#1-ä¸‹è½½å®‰è£…åŒ…" class="headerlink" title="1.ä¸‹è½½å®‰è£…åŒ…"></a>1.ä¸‹è½½å®‰è£…åŒ…</h2><blockquote><p>2.é¦–å…ˆï¼Œä½ éœ€è¦åˆ°Adobeå®˜ç½‘ä¸‹è½½å®‰è£…åŒ…ï¼Œåœ°å€ä¸ºï¼š</p></blockquote><p> <a href="https://www.adobe.com/products/aftereffects.html">https://www.adobe.com/products/aftereffects.html</a></p><blockquote><p>å“ˆå“ˆï¼Œä¸Šé¢æ˜¯æ­£ç‰ˆAdobeè½¯ä»¶ï¼Œä¸»è¦æ˜¯ç»™å…¬å¸ã€å’Œå›¢é˜Ÿä½¿ç”¨ï¼ˆå¦‚æœä¸ä½¿ç”¨æ­£ç‰ˆæ‡‚å¾—æ‡‚å¾—ğŸ˜œğŸ˜œğŸ˜œï¼‰<br>ä¸ªäººä½¿ç”¨å°±ç”¨æ±‰åŒ–ç‰ˆçš„å°±è¡Œå•¦â†“<br><a href="https://www.rjctx.com/">https://www.rjctx.com/</a> </p></blockquote><p> 1.ç¬¬ä¸€æ­¥è¿›å…¥ç½‘ç«™ï¼Œåœ¨æœç´¢æ¡†é‡Œè¾“å…¥<b>Adobe After Efects</b>, é€‰æ‹©ä½ å–œæ¬¢çš„ç‰ˆæœ¬ä¸‹è½½ã€‚</p><blockquote><p><b>æ¸©é¦¨æç¤ºï¼šç‰ˆæœ¬ä¸Šçš„ä¸åŒè½¯ä»¶ä¸Šä¼šæœ‰ä¸€å®šä¸Šçš„åŒºåˆ«ï¼Œè¿˜æœ‰å°±æ˜¯åç»­çš„æ•™å­¦ä¼šä½¿ç”¨åˆ°æ’ä»¶å¦‚æœç‰ˆæœ¬å¤ªé«˜æˆ–å¤ªä½å°±ä¼šå‡ºç°æ’ä»¶ä¸Šæˆ‘æœ‰çš„æ•ˆæœä½ æ²¡æœ‰å’Œæ•ˆæœä¸ä¸€æ ·ã€‚</p></blockquote><p><img src="https://s2.loli.net/2024/10/31/WboNGvH9trF7xnQ.png" alt="AE.png"></p><p>2.éšä¾¿é€‰ä¸€ä¸ªä½ å–œæ¬¢çš„æ–¹å¼ä¸‹è½½ï¼š<br>    <img src="https://s2.loli.net/2024/10/31/xFQiIahM61ly2SC.png" alt="AE.png"></p><blockquote><p><b>æ¸©é¦¨æç¤º2ï¼šä¸‹å¥½çš„å®‰è£…åŒ…å¯ä»¥æ”¾åœ¨é™¤Cç›˜çš„ä»»æ„ç›˜ä¸­ä½†å®‰è£…è·¯å¾„é»˜è®¤Cç›˜å°±è¡Œï¼Œäº†è§£è¿‡AEçš„éƒ½çŸ¥é“ç»å¸¸ä¼šå´©æºƒæ”¾åœ¨Cç›˜ä¼šå‡å°‘è¿™ç§äº‹æƒ…çš„å‘ç”Ÿï¼ˆç”µè„‘å¥½å°±ä¸å¿…ç†ä¼šï¼‰</b></p></blockquote><p>3.ç­‰å®ƒå®‰è£…å¥½å°±å¯ä»¥ä½¿ç”¨å•¦ï¼ï¼ï¼ğŸ˜ŠğŸ˜ŠğŸ˜Š</p>]]></content>
      
      
      <categories>
          
          <category> AE </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Adobe After Effects 2022 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
